Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:09:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11012.489582 
iter  10 value 8898.181859
iter  10 value 8898.181859
final  value 8898.181859 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4060.404 mgc: 143.102 ustep: 1 
iter: 2  value: 3579.994 mgc: 50.81758 ustep: 1 
iter: 3  value: 3420.303 mgc: 43.94525 ustep: 1 
iter: 4  value: 3417.343 mgc: 6.30331 ustep: 1 
iter: 5  value: 3417.323 mgc: 0.5998764 ustep: 1 
iter: 6  value: 3417.323 mgc: 0.008278722 ustep: 1 
iter: 7  value: 3417.323 mgc: 1.649224e-06 ustep: 1 
iter: 8  mgc: 3.697043e-14 
iter: 1  mgc: 3.697043e-14 
Matching hessian patterns... Done
outer mgc:  1118.123 
iter: 1  value: 2554.802 mgc: 34.32168 ustep: 1 
iter: 2  value: 2544.634 mgc: 8.912731 ustep: 1 
iter: 3  value: 2544.622 mgc: 0.545203 ustep: 1 
iter: 4  value: 2544.622 mgc: 0.002720125 ustep: 1 
iter: 5  value: 2544.622 mgc: 7.159604e-08 ustep: 1 
mgc: 3.852474e-14 
iter: 1  value: 2273.942 mgc: 37.03878 ustep: 1 
iter: 2  value: 2257.267 mgc: 9.999511 ustep: 1 
iter: 3  value: 2257.241 mgc: 0.4611027 ustep: 1 
iter: 4  value: 2257.241 mgc: 0.00309467 ustep: 1 
iter: 5  value: 2257.241 mgc: 2.409158e-07 ustep: 1 
iter: 6  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  774.0269 
iter: 1  value: 1828.701 mgc: 68.71425 ustep: 1 
iter: 2  value: 1816.513 mgc: 7.434767 ustep: 1 
iter: 3  value: 1816.474 mgc: 0.7184558 ustep: 1 
iter: 4  value: 1816.474 mgc: 0.009430007 ustep: 1 
iter: 5  value: 1816.474 mgc: 1.694071e-06 ustep: 1 
iter: 6  mgc: 4.707346e-14 
iter: 1  mgc: 4.707346e-14 
outer mgc:  801.3829 
iter: 1  value: 3806.041 mgc: 78.82806 ustep: 0.4367355 
iter: 2  value: 1456.068 mgc: 115.8648 ustep: 0.6608936 
iter: 3  value: 1375.308 mgc: 38.84649 ustep: 0.8129723 
iter: 4  value: 1372.613 mgc: 11.59572 ustep: 0.9016596 
iter: 5  value: 1372.61 mgc: 0.3561335 ustep: 0.9495626 
iter: 6  value: 1372.61 mgc: 0.001479948 ustep: 0.9744576 
iter: 7  value: 1372.61 mgc: 1.321244e-05 ustep: 0.9871475 
iter: 8  value: 1372.61 mgc: 1.744226e-07 ustep: 0.9935536 
iter: 9  mgc: 1.189059e-09 
iter: 1  mgc: 1.189059e-09 
outer mgc:  571.9222 
iter: 1  value: 5275.015 mgc: 109.1172 ustep: 0.4367355 
iter: 2  value: 2284.083 mgc: 109.3286 ustep: 0.6608936 
iter: 3  value: 2231.425 mgc: 43.82919 ustep: 0.8129723 
iter: 4  value: 2230.396 mgc: 8.473736 ustep: 0.9016596 
iter: 5  value: 2230.396 mgc: 0.1161545 ustep: 0.9495626 
iter: 6  value: 2230.396 mgc: 0.0002662299 ustep: 0.9744576 
iter: 7  value: 2230.396 mgc: 4.919133e-07 ustep: 0.9871475 
iter: 8  mgc: 5.580771e-10 
iter: 1  value: 1129.103 mgc: 54.14528 ustep: 1 
iter: 2  value: 1114.927 mgc: 12.06736 ustep: 1 
iter: 3  value: 1114.909 mgc: 0.4539942 ustep: 1 
iter: 4  value: 1114.909 mgc: 0.003819017 ustep: 1 
iter: 5  value: 1114.909 mgc: 2.777921e-07 ustep: 1 
iter: 6  mgc: 4.207745e-14 
iter: 1  mgc: 4.207745e-14 
outer mgc:  252.6496 
iter: 1  value: 1988.481 mgc: 60.51321 ustep: 1 
iter: 2  value: 1021.114 mgc: 59.18054 ustep: 1 
iter: 3  value: 1006.422 mgc: 9.154592 ustep: 1 
iter: 4  value: 1006.333 mgc: 1.086198 ustep: 1 
iter: 5  value: 1006.333 mgc: 0.02285553 ustep: 1 
iter: 6  value: 1006.333 mgc: 1.081466e-05 ustep: 1 
iter: 7  mgc: 2.42012e-12 
iter: 1  mgc: 2.42012e-12 
outer mgc:  56.49482 
iter: 1  value: 977.0638 mgc: 16.7135 ustep: 1 
iter: 2  value: 976.6258 mgc: 1.190953 ustep: 1 
iter: 3  value: 976.6253 mgc: 0.04625414 ustep: 1 
iter: 4  value: 976.6253 mgc: 0.0002250461 ustep: 1 
iter: 5  mgc: 6.134417e-09 
iter: 1  mgc: 6.134417e-09 
outer mgc:  49.13198 
iter: 1  value: 1000.148 mgc: 37.19234 ustep: 1 
iter: 2  value: 968.2016 mgc: 9.395434 ustep: 1 
iter: 3  value: 968.1524 mgc: 0.5134745 ustep: 1 
iter: 4  value: 968.1524 mgc: 0.002171027 ustep: 1 
iter: 5  value: 968.1524 mgc: 5.806625e-08 ustep: 1 
mgc: 4.318768e-14 
iter: 1  mgc: 4.318768e-14 
outer mgc:  115.768 
iter: 1  value: 1077.184 mgc: 46.10559 ustep: 1 
iter: 2  value: 1075.511 mgc: 5.162213 ustep: 1 
iter: 3  value: 1075.508 mgc: 0.2643644 ustep: 1 
iter: 4  value: 1075.508 mgc: 0.0007170882 ustep: 1 
iter: 5  mgc: 5.650566e-09 
iter: 1  value: 954.1234 mgc: 6.409505 ustep: 1 
iter: 2  value: 954.1138 mgc: 0.2014484 ustep: 1 
iter: 3  value: 954.1138 mgc: 0.0003371224 ustep: 1 
iter: 4  mgc: 1.848759e-09 
iter: 1  mgc: 1.848759e-09 
outer mgc:  64.99969 
iter: 1  value: 948.5509 mgc: 21.14206 ustep: 1 
iter: 2  value: 948.1826 mgc: 0.9906427 ustep: 1 
iter: 3  value: 948.1826 mgc: 0.01192868 ustep: 1 
iter: 4  value: 948.1826 mgc: 2.294135e-06 ustep: 1 
iter: 5  mgc: 8.748557e-14 
iter: 1  mgc: 8.748557e-14 
outer mgc:  58.06565 
iter: 1  value: 939.9513 mgc: 8.720419 ustep: 1 
iter: 2  value: 939.9364 mgc: 0.2555236 ustep: 1 
iter: 3  value: 939.9364 mgc: 0.000344528 ustep: 1 
iter: 4  mgc: 1.1226e-09 
iter: 1  mgc: 1.1226e-09 
outer mgc:  18.0529 
iter: 1  value: 958.0559 mgc: 23.10331 ustep: 1 
iter: 2  value: 957.7754 mgc: 1.433329 ustep: 1 
iter: 3  value: 957.7754 mgc: 0.01428697 ustep: 1 
iter: 4  value: 957.7754 mgc: 1.536387e-06 ustep: 1 
iter: 5  mgc: 4.640732e-14 
iter: 1  value: 937.8804 mgc: 7.293941 ustep: 1 
iter: 2  value: 937.8747 mgc: 0.1737267 ustep: 1 
iter: 3  value: 937.8747 mgc: 0.0001992136 ustep: 1 
iter: 4  mgc: 2.772749e-10 
iter: 1  mgc: 2.772749e-10 
outer mgc:  20.62867 
iter: 1  value: 936.7487 mgc: 1.76073 ustep: 1 
iter: 2  value: 936.7487 mgc: 0.0132769 ustep: 1 
iter: 3  value: 936.7487 mgc: 1.177032e-06 ustep: 1 
iter: 4  mgc: 5.084821e-14 
iter: 1  mgc: 5.084821e-14 
outer mgc:  19.62266 
iter: 1  value: 935.4528 mgc: 1.656679 ustep: 1 
iter: 2  value: 935.4526 mgc: 0.01701544 ustep: 1 
iter: 3  value: 935.4526 mgc: 2.777661e-06 ustep: 1 
iter: 4  mgc: 1.856293e-13 
iter: 1  mgc: 1.856293e-13 
outer mgc:  8.736319 
iter: 1  value: 935.4296 mgc: 2.317985 ustep: 1 
iter: 2  value: 935.4295 mgc: 0.01480246 ustep: 1 
iter: 3  value: 935.4295 mgc: 1.493832e-06 ustep: 1 
iter: 4  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  10.87135 
iter: 1  value: 934.7597 mgc: 3.859445 ustep: 1 
iter: 2  value: 934.7592 mgc: 0.03661454 ustep: 1 
iter: 3  value: 934.7592 mgc: 7.622094e-06 ustep: 1 
iter: 4  mgc: 5.053735e-13 
iter: 1  mgc: 5.053735e-13 
outer mgc:  9.228338 
iter: 1  value: 934.027 mgc: 2.271386 ustep: 1 
iter: 2  value: 934.0267 mgc: 0.04344779 ustep: 1 
iter: 3  value: 934.0267 mgc: 2.154207e-05 ustep: 1 
iter: 4  mgc: 5.298872e-12 
iter: 1  mgc: 5.298872e-12 
outer mgc:  4.199922 
iter: 1  value: 935.2322 mgc: 1.666049 ustep: 1 
iter: 2  value: 935.2321 mgc: 0.02630704 ustep: 1 
iter: 3  value: 935.2321 mgc: 3.220591e-05 ustep: 1 
iter: 4  mgc: 9.993339e-11 
iter: 1  value: 934.3329 mgc: 1.802393 ustep: 1 
iter: 2  value: 934.3329 mgc: 0.01274259 ustep: 1 
iter: 3  value: 934.3329 mgc: 1.787443e-06 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  13.009 
iter: 1  value: 934.4168 mgc: 1.877793 ustep: 1 
iter: 2  value: 934.4168 mgc: 0.009139134 ustep: 1 
iter: 3  value: 934.4168 mgc: 3.894108e-07 ustep: 1 
iter: 4  mgc: 3.58602e-14 
iter: 1  mgc: 3.58602e-14 
outer mgc:  3.989926 
iter: 1  value: 934.2328 mgc: 1.148524 ustep: 1 
iter: 2  value: 934.2328 mgc: 0.006320535 ustep: 1 
iter: 3  value: 934.2328 mgc: 9.156207e-07 ustep: 1 
iter: 4  mgc: 5.195844e-14 
iter: 1  mgc: 5.195844e-14 
outer mgc:  2.478972 
iter: 1  value: 934.4113 mgc: 0.7513948 ustep: 1 
iter: 2  value: 934.4113 mgc: 0.002984257 ustep: 1 
iter: 3  value: 934.4113 mgc: 1.404498e-07 ustep: 1 
iter: 4  mgc: 3.774758e-14 
iter: 1  value: 934.2766 mgc: 0.5437138 ustep: 1 
iter: 2  value: 934.2766 mgc: 0.001487989 ustep: 1 
iter: 3  value: 934.2766 mgc: 2.328551e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  value: 934.2319 mgc: 0.224981 ustep: 1 
iter: 2  value: 934.2319 mgc: 0.0002556545 ustep: 1 
iter: 3  mgc: 6.940049e-10 
iter: 1  mgc: 6.940049e-10 
outer mgc:  1.387286 
iter: 1  value: 934.2382 mgc: 0.2626749 ustep: 1 
iter: 2  value: 934.2382 mgc: 0.0001985785 ustep: 1 
iter: 3  mgc: 3.694653e-10 
iter: 1  mgc: 3.694653e-10 
outer mgc:  1.391976 
iter: 1  value: 934.2377 mgc: 0.1452492 ustep: 1 
iter: 2  value: 934.2377 mgc: 6.531365e-05 ustep: 1 
iter: 3  mgc: 8.561329e-11 
iter: 1  value: 934.2407 mgc: 0.05999548 ustep: 1 
iter: 2  value: 934.2407 mgc: 8.068012e-05 ustep: 1 
iter: 3  mgc: 3.578449e-10 
iter: 1  value: 934.2626 mgc: 0.1260562 ustep: 1 
iter: 2  value: 934.2626 mgc: 0.0003525916 ustep: 1 
iter: 3  mgc: 6.883019e-09 
iter: 1  mgc: 6.883019e-09 
outer mgc:  1.624634 
iter: 1  value: 934.2614 mgc: 1.639333 ustep: 1 
iter: 2  value: 934.2613 mgc: 0.01050983 ustep: 1 
iter: 3  value: 934.2613 mgc: 1.726881e-06 ustep: 1 
iter: 4  mgc: 6.57252e-14 
iter: 1  value: 934.2384 mgc: 0.6970636 ustep: 1 
iter: 2  value: 934.2384 mgc: 0.001851803 ustep: 1 
iter: 3  value: 934.2384 mgc: 5.342498e-08 ustep: 1 
iter: 4  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  1.309913 
iter: 1  value: 934.1388 mgc: 0.7114309 ustep: 1 
iter: 2  value: 934.1388 mgc: 0.001239455 ustep: 1 
iter: 3  value: 934.1388 mgc: 1.476973e-08 ustep: 1 
mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  2.163373 
iter: 1  value: 934.1671 mgc: 0.3738312 ustep: 1 
iter: 2  value: 934.1671 mgc: 0.0005188871 ustep: 1 
iter: 3  mgc: 1.725951e-09 
iter: 1  mgc: 1.725951e-09 
outer mgc:  0.5651261 
iter: 1  value: 934.1679 mgc: 0.06762376 ustep: 1 
iter: 2  value: 934.1679 mgc: 3.874817e-05 ustep: 1 
iter: 3  mgc: 5.604228e-11 
iter: 1  mgc: 5.604228e-11 
outer mgc:  0.5117927 
iter: 1  value: 934.1912 mgc: 0.3234332 ustep: 1 
iter: 2  value: 934.1912 mgc: 0.0009406493 ustep: 1 
iter: 3  value: 934.1912 mgc: 1.065229e-08 ustep: 1 
mgc: 5.861978e-14 
iter: 1  value: 934.1764 mgc: 0.1611987 ustep: 1 
iter: 2  value: 934.1764 mgc: 0.0002216833 ustep: 1 
iter: 3  mgc: 6.43932e-10 
iter: 1  mgc: 6.43932e-10 
outer mgc:  0.37493 
iter: 1  value: 934.1561 mgc: 0.05970579 ustep: 1 
iter: 2  value: 934.1561 mgc: 2.588373e-05 ustep: 1 
iter: 3  mgc: 6.805223e-12 
iter: 1  mgc: 6.805223e-12 
outer mgc:  0.1446601 
iter: 1  value: 934.1701 mgc: 0.03516601 ustep: 1 
iter: 2  value: 934.1701 mgc: 1.12657e-05 ustep: 1 
iter: 3  mgc: 7.305406e-13 
iter: 1  mgc: 7.305406e-13 
outer mgc:  0.07042162 
iter: 1  value: 934.1518 mgc: 0.04521112 ustep: 1 
iter: 2  value: 934.1518 mgc: 1.231828e-05 ustep: 1 
iter: 3  mgc: 1.254996e-12 
iter: 1  value: 934.1651 mgc: 0.01571482 ustep: 1 
iter: 2  value: 934.1651 mgc: 1.44242e-06 ustep: 1 
iter: 3  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  0.02142945 
iter: 1  value: 934.1642 mgc: 0.005566146 ustep: 1 
iter: 2  value: 934.1642 mgc: 1.248688e-07 ustep: 1 
iter: 3  mgc: 5.151435e-14 
iter: 1  mgc: 5.151435e-14 
outer mgc:  0.0005217316 
iter: 1  value: 934.1642 mgc: 0.0001597701 ustep: 1 
iter: 2  mgc: 1.043876e-10 
iter: 1  mgc: 1.043876e-10 
outer mgc:  0.0002597222 
iter: 1  mgc: 1.043876e-10 
iter: 1  mgc: 1.043876e-10 
outer mgc:  0.0002597222 
iter: 1  value: 934.1633 mgc: 0.04923256 ustep: 1 
iter: 2  value: 934.1633 mgc: 7.224708e-06 ustep: 1 
iter: 3  mgc: 3.295142e-13 
outer mgc:  0.2091138 
iter: 1  value: 934.1654 mgc: 0.04922046 ustep: 1 
iter: 2  value: 934.1654 mgc: 7.235626e-06 ustep: 1 
iter: 3  mgc: 3.250733e-13 
outer mgc:  0.2092237 
iter: 1  value: 934.1656 mgc: 0.03137104 ustep: 1 
iter: 2  value: 934.1656 mgc: 3.476251e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
outer mgc:  0.4822885 
iter: 1  value: 934.1634 mgc: 0.03136313 ustep: 1 
iter: 2  value: 934.1634 mgc: 3.478889e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  0.4827255 
iter: 1  value: 934.1664 mgc: 0.05351811 ustep: 1 
iter: 2  value: 934.1664 mgc: 6.957275e-06 ustep: 1 
iter: 3  mgc: 2.842171e-13 
outer mgc:  0.2629528 
iter: 1  value: 934.1623 mgc: 0.05352685 ustep: 1 
iter: 2  value: 934.1623 mgc: 6.949716e-06 ustep: 1 
iter: 3  mgc: 2.797762e-13 
outer mgc:  0.2628431 
iter: 1  value: 934.1651 mgc: 0.03184523 ustep: 1 
iter: 2  value: 934.1651 mgc: 2.967233e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  0.5610617 
iter: 1  value: 934.1639 mgc: 0.0318523 ustep: 1 
iter: 2  value: 934.1639 mgc: 2.963041e-06 ustep: 1 
iter: 3  mgc: 7.638334e-14 
outer mgc:  0.5605469 
iter: 1  value: 934.1614 mgc: 0.003935512 ustep: 1 
iter: 2  value: 934.1614 mgc: 1.324076e-07 ustep: 1 
mgc: 2.862988e-14 
outer mgc:  0.01401083 
iter: 1  value: 934.1671 mgc: 0.003933715 ustep: 1 
iter: 2  value: 934.1671 mgc: 1.323544e-07 ustep: 1 
mgc: 4.174439e-14 
outer mgc:  0.01397147 
iter: 1  value: 934.1698 mgc: 0.01303137 ustep: 1 
iter: 2  value: 934.1698 mgc: 1.929962e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.2606384 
iter: 1  value: 934.1589 mgc: 0.01306231 ustep: 1 
iter: 2  value: 934.1589 mgc: 1.936725e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.2610471 
iter: 1  value: 934.1709 mgc: 0.01874233 ustep: 1 
iter: 2  value: 934.1709 mgc: 4.61391e-06 ustep: 1 
iter: 3  mgc: 1.430855e-12 
outer mgc:  0.2481329 
iter: 1  value: 934.1579 mgc: 0.01878847 ustep: 1 
iter: 2  value: 934.1579 mgc: 4.64049e-06 ustep: 1 
iter: 3  mgc: 1.440625e-12 
outer mgc:  0.248487 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:09:54 2021]
Finished job 0.
1 of 1 steps (100%) done

DM_areas2_GR <- as(DM_areas2, "GRanges")
head(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
head(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
colnames(DM_areas2)[1] <- 'seqname'
DM_areas2$seqname <- gsub(" ", "", DM_areas2$seqname)
DM_areas2$seqname
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
head(DM_areas2)
colnames(DM_areas2)[1] <- 'seqname'
gsub(" ", "", DM_areas2$seqname)
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
colnames(DM_areas2)[1] <- 'seqname'
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
DM_areas2 <- read.table("~/Desktop/DME2.txt", sep = "\t", stringsAsFactors = F)
DM_areas2 <- matrix(unlist(DM_areas2[,1]), ncol=6, byrow=T)
DM_areas2 <- data.frame(DM_areas2)
colnames(DM_areas2) <- DM_areas2[1,]; DM_areas2 <- DM_areas2[-1,]
View(DM_areas2)
colnames(DM_areas2)[1] <- 'seqname'
DM_areas2$seqname <- gsub(" ", "", DM_areas2$seqname)
DM_areas2$start <- as.numeric(DM_areas2$start)
DM_areas2$end <- as.numeric(DM_areas2$end)
DM_areas2$seqname <- gtools::mixedsort(DM_areas2$seqname)
DM_areas2_GR <- as(DM_areas2, "GRanges")
disjoined_GR2_genes <- disjoin(c(grch38_genes, DM_areas2_GR), with.revmap=T, ignore.strand=T)
revmap_second2 <- sapply(disjoined_GR2_genes$revmap, function(i) i[i > length(grch38_genes)])
revmap_second_idx2 <- sapply(revmap_second2, function(i) i-length(grch38_genes))
revmap_second_idx2[sapply(revmap_second_idx2, length) == 0] <- NA
revmap_second_idx2 <- (unlist(revmap_second_idx2))
length(revmap_second_idx2)
disjoined_GR2_genes$value_DM = as.numeric(DM_areas2$value[revmap_second_idx2])
disjoined_GR2_genes$value_DM[is.na(disjoined_GR2_genes$value_DM )] = 0
disjoined_GR2_genes$pval_DM = DM_areas2$`p-value`[revmap_second_idx2]
revmap_uniq2 <- unique(unlist(revmap_second2))
length(revmap_uniq2)
length(DM_areas2_GR)
min((revmap_second_idx2), na.rm = T)
max((revmap_second_idx2), na.rm = T)
disjoined_GR2_genes_df <- as(disjoined_GR2_genes, 'data.frame')
disjoined_GR2_genes_merged <- unlist(reduce(split(disjoined_GR2_genes, ~value_DM)))
disjoined_GR2_genes_merged$value_DM <- as.numeric(names(disjoined_GR2_genes_merged))
disjoined_GR2_genes_merged_df <- as(disjoined_GR_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(1:21, 'X', 'Y') ,]
dim(disjoined_GR2_genes_merged_df)
ggplot(disjoined_GR2_genes_merged_df[1:100,])+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
head(disjoined_GR2_genes_merged_df)
ggplot(disjoined_GR2_genes_merged_df[1:1000,])+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged
dim(disjoined_GR2_genes_merged)
length(disjoined_GR2_genes_merged)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged
disjoined_GR2_genes_merged <- unlist(reduce(split(disjoined_GR2_genes, ~value_DM)))
disjoined_GR2_genes_merged$value_DM <- as.numeric(names(disjoined_GR2_genes_merged))
names(disjoined_GR2_genes_merged) <- NULL
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(1:21, 'X', 'Y') ,]
ggplot(disjoined_GR2_genes_merged_df[1:1000,])+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
length(disjoined_GR2_genes_merged_df)
dim(disjoined_GR2_genes_merged_df)
dim(disjoined_GR_genes_merged_df)
ggplot(disjoined_GR2_genes_merged_df[1:1000,])+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$value_DM
table(disjoined_GR2_genes_merged_df$value_DM)
disjoined_GR2_genes$value_DM
table(disjoined_GR2_genes$value_DM)
disjoined_GR2_genes
disjoined_GR2_genes_merged <- unlist(reduce(split(disjoined_GR2_genes, ~value_DM)))
disjoined_GR2_genes_merged
as.numeric(names(disjoined_GR2_genes_merged))
max()
max(as.numeric(names(disjoined_GR2_genes_merged)))
disjoined_GR2_genes_merged$value_DM <- as.numeric(names(disjoined_GR2_genes_merged))
names(disjoined_GR2_genes_merged) <- NULL
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df$value_DM
max(disjoined_GR2_genes_merged_df$value_DM)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(1:21, 'X', 'Y') ,]
max(disjoined_GR2_genes_merged_df$value_DM)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df$seqnames <- paste0('chr', genes_of_interest_df$seqnames)
genes_of_interest_df <- as(genes_of_interest, 'data.frame')
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
genes_of_interest_df_chr$seqnames
dev.off()
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
ggplot(disjoined_GR_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
evels(disjoined_GR2_genes_merged_df$seqnames)
gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
unique(factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames))))
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
genes_of_interest_df_chr$seqnames
levels(disjoined_GR2_genes_merged_df$seqnames )
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
levels(disjoined_GR2_genes_merged_df$seqnames)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames))))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
unique(disjoined_GR2_genes_merged_df$seqnames)
levels(disjoined_GR2_genes_merged_df$seqnames)
gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames)))
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
levels(disjoined_GR2_genes_merged_df$seqnames) <- gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
levels(disjoined_GR2_genes_merged_df$seqnames)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
levels(disjoined_GR2_genes_merged_df$seqnames) <- as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
droplevels(disjoined_GR2_genes_merged_df)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df <- droplevels(disjoined_GR2_genes_merged_df)
levels(disjoined_GR2_genes_merged_df$seqnames) <- as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
levels(genes_of_interest_df_chr$seqnames)
levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
genes_of_interest_df_chr$seqnames
genes_of_interest_df_chr$seqnames <- factor(genes_of_interest_df_chr$seqnames,
levels=levels(disjoined_GR2_genes_merged_df$seqnames ))
genes_of_interest_df_chr$seqnames
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
genes_of_interest_df_chr
cn <- readRDS("/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/output_GRCh37/joint_counts_CN_subset.RDS")
cn
head(cn)
cn[(cn$CN.gene_name == 'TRIP13'),]
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()
library(ggplot2)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()+theme_bw()
library(ggrepel)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
flder <- "/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/all_CN_states_per_gene/"
fles <- list.files(flder, full.names = T)
fles <- fles[grepl('RDS', fles)]
length(fles)
gene_CN <- lapply(fles, readRDS)
gene_CN
cn <- lapply(gene_CN, `[`, 2)
all_cn <- (do.call('cbind', cn))
head(all_cn)
View(all_cn)
dim(all_cn)
fles
basename(fles)
length(basename(fles))
dim(all_cn)
colnames(all_cn) <- (basename(fles))
cn[[1]]
gene_CN[[1]]
gene_CN[[1]][,1]
rownames(all_cn) <- gene_CN[[1]][,1]
rownames(all_cn) <- make.names(gene_CN[[1]][,1], unique = T, allow_ = T)
all_cn['TRIP13',]
plot(density(all_cn['TRIP13',]))
all_cn['TRIP13',]
as.null(all_cn['TRIP13',])
as.numeric()
as.numeric(all_cn['TRIP13',])
plot(density(as.numeric(all_cn['TRIP13',])))
plot(density(as.numeric(all_cn['TRIP13',]))); abline(v=2)
(all_cn['TRIP13',]
)
head((all_cn['TRIP13',])-
)
head((all_cn['TRIP13',]))
head(data.frame(all_cn['TRIP13',]))
head(data.frame(t(all_cn['TRIP13',])))
TRIP13_cn <- (data.frame(t(all_cn['TRIP13',])))
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline()+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13))+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.2)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.02)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
system("mkdir /Users/morril01/Documents/PhD/other_repos/trip13/")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
system("mkdir /Users/morril01/Documents/PhD/other_repos/trip13/results")
system("open /Users/morril01/Documents/PhD/other_repos/trip13/results")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.1)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.2)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.05)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
cn_orgs <- readRDS("/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/output_GRCh37/joint_counts_CN_subset.RDS")
ggplot(cn_orgs[(cn_orgs$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(cn_orgs[(cn_orgs$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/organoids_cn_rnaseq_cor.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.05)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
rm(list = ls())
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
library(pheatmap)
library(ComplexHeatmap)
x <- read.table("../../../../data/cosmic/active_signatures_PCAWGpaper.txt")
x2 <- read.table("../../../../data/restricted/pcawg/PCAWG_sigProfiler_SBS_signatures_in_samples.csv", sep = ",", hea=T) ## for the name of the cancer types in correct upper/lower case
x2 <- x2$Cancer.Types
for(i in 1:nrow(x)){
cat((x2[match(x[i,1], toupper(x2))]), '&', paste0(names(x[i,-1])[which(x[i,-1] == 1)], collapse = ", "), "\\\\\n")
}
rownames(x) <- x2[match(x[,1], toupper(x2))]
x <- x[,-1]
x2 <- read.table("../../../../data/restricted/pcawg/PCAWG_sigProfiler_SBS_signatures_in_samples.csv", sep = ",", hea=T) ## for the name of the cancer types in correct upper/lower case
rm(list = ls())
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
library(pheatmap)
library(ComplexHeatmap)
x <- read.table("../../../../data/cosmic/active_signatures_PCAWGpaper.txt")
x <- read.table("../../../data/cosmic/active_signatures_PCAWGpaper.txt")
x2 <- read.table("../../../data/restricted/pcawg/PCAWG_sigProfiler_SBS_signatures_in_samples.csv", sep = ",", hea=T) ## for the name of the cancer types in correct upper/lower case
x2 <- x2$Cancer.Types
for(i in 1:nrow(x)){
cat((x2[match(x[i,1], toupper(x2))]), '&', paste0(names(x[i,-1])[which(x[i,-1] == 1)], collapse = ", "), "\\\\\n")
}
rownames(x) <- x2[match(x[,1], toupper(x2))]
x <- x[,-1]
pheatmap::pheatmap(x)
ht <- ComplexHeatmap::Heatmap(as(x, 'matrix'), cluster_columns = F, cluster_rows = F, col=c('#e7feff', '#f08080'),
name='Signature active', heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm"),
nrow=1
))
x
i=1
j=2
x[,i] & x[,j]
x[,i]
x[,j]
sum(x[,i] & x[,j])/(sum(sum(x[,i] & x[,j]) + sum(x[,i] & !x[,j]) ))
## co-occurrence
co_oc <- outer(1:ncol(x), 1:ncol(x), function(i, j){
sum(x[,i] & x[,j])/(sum(sum(x[,i] & x[,j]) + sum(x[,i] & !x[,j]) ))
})
## co-occurrence
co_oc <- outer(1:ncol(x), 1:ncol(x), Vectorize(function(i, j){
sum(x[,i] & x[,j])/(sum(sum(x[,i] & x[,j]) + sum(x[,i] & !x[,j]) ))
}))
colnames(co_oc) <- rownames(co_oc) <- colnames(x)
pheatmap(co_oc)
pdf("../../../results/exploratory/about_cosmic_sigs/active_sigs_in_PCAWG_co_occurrence.pdf", width = 10)
pheatmap(co_oc)
dev.off()
system("open ../../../results/exploratory/about_cosmic_sigs/")
pdf("../../../results/exploratory/about_cosmic_sigs/active_sigs_in_PCAWG_co_occurrence.pdf", width = 10, height = 10)
pheatmap(co_oc)
dev.off()
x[,c('SBS8', 'SBS39')]
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
library(reshape2)
library(ggplot2)
library(dplyr)
flder <- "../../../data/restricted/pcawg/consensus_subclonal_reconstruction_mutccf_20170325/"
metadata <- read.table("../../../data/restricted/pcawg/pcawg.wg11.final_sample_list_MARCH2019.txt", head=T)
enough_samples = read.table("../../../data/restricted/pcawg/CT_sufficient_samples.txt", comment.char='#')[,1]
input_files <- list.files(flder, full.names = T)
file_name <- input_files
a <- sapply(file_name, function(i) gsub(".txt", ".RDS", gsub(".consensus_subclonal_reconstruction_mutccf_20170325/", "/var_annotation_with_ccf", i)))
read_annotation <- lapply(a, function(j) try(readRDS(j)))
read_annotation <- read_annotation[sapply(read_annotation, typeof) != "character"]
# kegg_pathway_name <- 'KEGG HRD'
# kegg_pathway_name <- 'KEGG MMR'
# kegg_pathway_name <- 'KEGG BER'
# kegg_pathway_name <- 'KEGG NER'
# kegg_pathway_name <- 'KEGG NHEJ'
kegg_pathway_name <- 'TP53'
read_annotation
read_annotation[[1]]
read_annotation[[1]]
dev.off()
read_annotation[[1]]
GOI <- lapply(read_annotation, function(i) i[i$gene_symbol %in% c('MUYTH'),])
GOI

geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
genes_of_interest_df_chr$seqnames
dev.off()
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
ggplot(disjoined_GR_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
evels(disjoined_GR2_genes_merged_df$seqnames)
gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
unique(factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames))))
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
genes_of_interest_df_chr$seqnames
levels(disjoined_GR2_genes_merged_df$seqnames )
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
levels(disjoined_GR2_genes_merged_df$seqnames)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df$seqnames <- factor(disjoined_GR2_genes_merged_df$seqnames,
levels=gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames))))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
unique(disjoined_GR2_genes_merged_df$seqnames)
levels(disjoined_GR2_genes_merged_df$seqnames)
gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames)))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
gtools::mixedsort(levels(unique(disjoined_GR2_genes_merged_df$seqnames)))
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
levels(disjoined_GR2_genes_merged_df$seqnames) <- gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
levels(disjoined_GR2_genes_merged_df$seqnames)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames))
as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
levels(disjoined_GR2_genes_merged_df$seqnames) <- as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
droplevels(disjoined_GR2_genes_merged_df)
disjoined_GR2_genes_merged_df <- as(disjoined_GR2_genes_merged, 'data.frame')
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[with(disjoined_GR2_genes_merged_df, order(seqnames, start)), ]
disjoined_GR2_genes_merged_df <- disjoined_GR2_genes_merged_df[disjoined_GR2_genes_merged_df$seqnames %in% c(paste0('chr', c(1:21, 'X', 'Y'))) ,]
disjoined_GR2_genes_merged_df <- droplevels(disjoined_GR2_genes_merged_df)
levels(disjoined_GR2_genes_merged_df$seqnames) <- as.character(gtools::mixedsort(unique(disjoined_GR2_genes_merged_df$seqnames)))
genes_of_interest_df_chr <- genes_of_interest_df
genes_of_interest_df_chr$seqnames <- paste0('chr', genes_of_interest_df_chr$seqnames)
levels(genes_of_interest_df_chr$seqnames) <- levels(disjoined_GR2_genes_merged_df$seqnames )
levels(genes_of_interest_df_chr$seqnames)
levels(disjoined_GR2_genes_merged_df$seqnames )
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
disjoined_GR2_genes_merged_df$seqnames
genes_of_interest_df_chr$seqnames
genes_of_interest_df_chr$seqnames <- factor(genes_of_interest_df_chr$seqnames,
levels=levels(disjoined_GR2_genes_merged_df$seqnames ))
genes_of_interest_df_chr$seqnames
ggplot(disjoined_GR2_genes_merged_df)+
geom_segment(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_line(aes(x=start, xend=end, y=value_DM, yend=value_DM))+
geom_label_repel(data=genes_of_interest_df_chr, aes(x=start, y= 0, label=gene_name), size=3)+
geom_point(col='red', data=genes_of_interest_df_chr, aes(x=start, y= 0))+
facet_wrap(~seqnames, scales = "free")+theme_bw()
ggsave("~/Desktop/differential_methylation_HGSOC_relapse.pdf", height = 10, width = 10)
genes_of_interest_df_chr
cn <- readRDS("/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/output_GRCh37/joint_counts_CN_subset.RDS")
cn
head(cn)
cn[(cn$CN.gene_name == 'TRIP13'),]
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()
library(ggplot2)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count))+
geom_point()+theme_bw()
library(ggrepel)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
flder <- "/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/all_CN_states_per_gene/"
fles <- list.files(flder, full.names = T)
fles <- fles[grepl('RDS', fles)]
length(fles)
gene_CN <- lapply(fles, readRDS)
gene_CN
cn <- lapply(gene_CN, `[`, 2)
all_cn <- (do.call('cbind', cn))
head(all_cn)
View(all_cn)
dim(all_cn)
fles
basename(fles)
length(basename(fles))
dim(all_cn)
colnames(all_cn) <- (basename(fles))
cn[[1]]
gene_CN[[1]]
gene_CN[[1]][,1]
rownames(all_cn) <- gene_CN[[1]][,1]
rownames(all_cn) <- make.names(gene_CN[[1]][,1], unique = T, allow_ = T)
all_cn['TRIP13',]
plot(density(all_cn['TRIP13',]))
all_cn['TRIP13',]
as.null(all_cn['TRIP13',])
as.numeric()
as.numeric(all_cn['TRIP13',])
plot(density(as.numeric(all_cn['TRIP13',])))
plot(density(as.numeric(all_cn['TRIP13',]))); abline(v=2)
(all_cn['TRIP13',]
)
head((all_cn['TRIP13',])-
)
head((all_cn['TRIP13',]))
head(data.frame(all_cn['TRIP13',]))
head(data.frame(t(all_cn['TRIP13',])))
TRIP13_cn <- (data.frame(t(all_cn['TRIP13',])))
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline()+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13))+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.2)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.02)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
system("mkdir /Users/morril01/Documents/PhD/other_repos/trip13/")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
system("mkdir /Users/morril01/Documents/PhD/other_repos/trip13/results")
system("open /Users/morril01/Documents/PhD/other_repos/trip13/results")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.01)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf")
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.1)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.2)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.05)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggplot(cn[(cn$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
cn_orgs <- readRDS("/Users/morril01/Documents/PhD/other_repos/Vias_Brenton/RNASeq_and_CN/20191218_ViasM_BJ_orgaBrs/output/output_GRCh37/joint_counts_CN_subset.RDS")
ggplot(cn_orgs[(cn_orgs$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
ggplot(cn_orgs[(cn_orgs$CN.gene_name == 'TRIP13'),], aes(x=CN.value, y=DESeq.count, label=PDO))+
geom_point()+theme_bw()+geom_label_repel()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/organoids_cn_rnaseq_cor.pdf", height = 3)
ggplot(TRIP13_cn, aes(x=TRIP13))+geom_density()+geom_vline(aes(xintercept=TRIP13), alpha=0.05)+theme_bw()
ggsave("/Users/morril01/Documents/PhD/other_repos/trip13/results/density_CN_britroc_tcga_icgc.pdf", height = 3)
rm(list=ls())
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
source("recover_COSMIC_signatures.R")
source("../../2_inference_TMB/helper_TMB.R")
library(reshape2)
library(ggplot2)
library(ggrepel)
library(dplyr)
v <- 'v2'
if(v == 'v1'){
vec_sigs <- c("SBS1",   "SBS2",   "SBS3",   "SBS5",   "SBS9",   "SBS13",  "SBS15",  "SBS17a", "SBS17b", "SBS18",
"SBS20",  "SBS21",  "SBS26",  "SBS28",  "SBS40" , "SBS41",  "SBS43",  "SBS44",  "SBS51",  "SBS58")
add=''
}else if(v == 'v2'){
sigs_cosmic <- read.table(paste0( "../../../data/cosmic/sigProfiler_SBS_signatures_2019_05_22.csv"),
stringsAsFactors = FALSE, sep = ',', header = TRUE)
vec_sigs <- colnames(sigs_cosmic)[-c(1,2)]
add = '_allsigs'
}
bleedingAUC <- lapply(vec_sigs, function(i) readRDS(paste0("../../../results/exploratory/bleeding_signatures/", i, add, "_AUC.RDS")))
names(bleedingAUC) <- vec_sigs
bleedingAUC
do.call('rbind', bleedingAUC)
pheatmap::pheatmap(do.call('rbind', bleedingAUC))
pheatmap::pheatmap(do.call('rbind', bleedingAUC), cluster_cols = F, cluster_rows = F)
bleedingAUCrbind <- do.call('rbind', bleedingAUC)
bleedingAUCrbind_nodiag <- bleedingAUCrbind
diag(bleedingAUCrbind) <- NA
bleedingAUCrbind
pheatmap::pheatmap(bleedingAUCrbind, cluster_cols = F, cluster_rows = F)
head(melt(bleedingAUCrbind))
ggplot(melt(bleedingAUCrbind), aes(x=Var1, y=value))+geom_density()
ggplot(melt(bleedingAUCrbind), aes(x=value, col=Var1))+geom_density()
ggplot(melt(bleedingAUCrbind), aes(x=value, col=Var1, label=Var1))+geom_density()+geom_label()+
guides(col='none')
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label()+
guides(col='none')
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label(aes(x=0))+
guides(col='none')
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label(aes(x=0))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label(aes(x=max(Var1)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_y_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()#+scale_y_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
bleedingAUCrbind
ggplot(melt(bleedingAUCrbind), aes(y=value+0.01, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()#+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(y=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()#+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()#+scale_x_continuous(trans = "log2")
ggplot(melt(bleedingAUCrbind), aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")
bleedingAUCrbind
rowSums(bleedingAUCrbind)
rowSums(bleedingAUCrbind, na.rm = T)
hist(rowSums(bleedingAUCrbind, na.rm = T))
head(bleedingAUCrbind)
bleedingAUCrbindm <- melt(bleedingAUCrbind)
bleedingAUCrbindm$grouped <- rowSums(bleedingAUCrbind, na.rm = T)
ggplot(bleedingAUCrbindm, aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")+
facet_wrap(.~grouped)
bleedingAUCrbindm$grouped <- (rowSums(bleedingAUCrbind, na.rm = T)) > 0.6
ggplot(bleedingAUCrbindm, aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")+
facet_wrap(.~grouped)
bleedingAUCrbindm
rowSums(bleedingAUCrbindm)
bleedingAUCrbindm
rowSums(bleedingAUCrbind)
rowSums(bleedingAUCrbind, na.rm = T)
head(melt(rowSums(bleedingAUCrbind, na.rm = T)))
rownames_as_col <- function(i) cbind.data.frame(sig=rownames(i), i)
rownames_as_col(head(melt(rowSums(bleedingAUCrbind, na.rm = T))))
ggplot(rownames_as_col(melt(rowSums(bleedingAUCrbind, na.rm = T))), aes(x=sig, y=value))+
geom_bar(stat = "identity")
ggplot(rownames_as_col(melt(rowSums(bleedingAUCrbind, na.rm = T))),
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")
ggplot(rownames_as_col(melt(rowSums(bleedingAUCrbind, na.rm = T))),
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
head(bleedingAUCrbind)
rowSums(bleedingAUCrbind, na.rm = T)
cbind.data.frame(rowSums(bleedingAUCrbind, na.rm = T),
apply(bleedingAUCrbind, 1, sd na.rm = T))
cbind.data.frame(rowSums(bleedingAUCrbind, na.rm = T),
apply(bleedingAUCrbind, 1, sd, na.rm = T))
cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T))
rownames(bleedingAUCrbind)
head(melt(bleedingAUCrbind))
bleedingAUCrbindm
head(bleedingAUCrbindm)
ggplot(bleedingAUCrbindm, aes(x=Var1, y=value))+geom_boxplot()
bleedingAUCrbindmsum <- rownames_as_col(melt(rowSums(bleedingAUCrbind, na.rm = T)))
ggplot(bleedingAUCrbindmsum,
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindmsum$sig
bleedingAUCrbindmsum <- factor(bleedingAUCrbindmsum$sig, levels=bleedingAUCrbindmsum$sig[order(bleedingAUCrbindmsum$value)])
bleedingAUCrbindmsum$sig
bleedingAUCrbindmsum
levels()
levels(bleedingAUCrbindmsum)
bleedingAUCrbindmsum <- rownames_as_col(melt(rowSums(bleedingAUCrbind, na.rm = T)))
bleedingAUCrbindmsum$sig <- factor(bleedingAUCrbindmsum$sig, levels=bleedingAUCrbindmsum$sig[order(bleedingAUCrbindmsum$value)])
bleedingAUCrbindmsum$sig
levels(bleedingAUCrbindmsum$sig)
ggplot(bleedingAUCrbindm, aes(x=factor(sig, levels=slevels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()
ggplot(bleedingAUCrbindm, aes(x=factor(sig, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()
head(bleedingAUCrbindm)
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()+scale_y_continuous(trans = "log2")
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindmsum <- rownames_as_col(melt(apply(bleedingAUCrbind, 1, median, na.rm = T)))
bleedingAUCrbindmsum$sig <- factor(bleedingAUCrbindmsum$sig, levels=bleedingAUCrbindmsum$sig[order(bleedingAUCrbindmsum$value)])
ggplot(bleedingAUCrbindmsum,
aes(x=, y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindmsum
ggplot(bleedingAUCrbindmsum,
aes(x=, y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
ggplot(bleedingAUCrbindmsum,
aes(x=sig, y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
head(bleedingAUCrbindm)
ggplot(cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T),
sig=rownames(bleedingAUCrbind)),
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")+
geom_errorbar(aes())
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindm$equality <- bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
head(bleedingAUCrbindm)
bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
bleedingAUCrbindm$equality <- bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
table(bleedingAUCrbindm$equality)
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
table(bleedingAUCrbindm$equality )
bleedingAUCrbindm[bleedingAUCrbindm$equality,]
bleedingAUCrbindm <- melt(bleedingAUCrbind)
bleedingAUCrbindm2 <- melt(bleedingAUCrbind_nodiag)
bleedingAUCrbindm$grouped <- (rowSums(bleedingAUCrbind, na.rm = T)) > 0.6
ggplot(bleedingAUCrbindm, aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")+
facet_wrap(.~grouped)
rownames_as_col <- function(i) cbind.data.frame(sig=rownames(i), i)
cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T),
sig=rownames(bleedingAUCrbind))
bleedingAUCrbindmsum <- rownames_as_col(melt(apply(bleedingAUCrbind, 1, median, na.rm = T)))
bleedingAUCrbindmsum$sig <- factor(bleedingAUCrbindmsum$sig, levels=bleedingAUCrbindmsum$sig[order(bleedingAUCrbindmsum$value)])
ggplot(bleedingAUCrbindmsum,
aes(x=sig, y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
head(bleedingAUCrbindm)
ggplot(cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T),
sig=rownames(bleedingAUCrbind)),
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")+
geom_errorbar(aes())
bleedingAUCrbindm$equality <- bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindm[bleedingAUCrbindm$equality,]
bleedingAUC <- lapply(vec_sigs, function(i) readRDS(paste0("../../../results/exploratory/bleeding_signatures/", i, add, "_AUC.RDS")))
names(bleedingAUC) <- vec_sigs
bleedingAUCrbind <- do.call('rbind', bleedingAUC)
pheatmap::pheatmap()
pheatmap::pheatmap(bleedingAUCrbind, cluster_cols = F, cluster_rows = F)
bleedingAUCrbind_nodiag <- bleedingAUCrbind
diag(bleedingAUCrbind_nodiag) <- NA
pheatmap::pheatmap(bleedingAUCrbind, cluster_cols = F, cluster_rows = F)
bleedingAUCrbindm <- melt(bleedingAUCrbind)
bleedingAUCrbindm2 <- melt(bleedingAUCrbind_nodiag)
bleedingAUCrbindm$grouped <- (rowSums(bleedingAUCrbind, na.rm = T)) > 0.6
ggplot(bleedingAUCrbindm, aes(x=value, col=Var1, label=Var1))+geom_density()+
#geom_label(aes(x=max(value)))+
guides(col='none')+theme_bw()+scale_x_continuous(trans = "log2")+
facet_wrap(.~grouped)
rownames_as_col <- function(i) cbind.data.frame(sig=rownames(i), i)
cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T),
sig=rownames(bleedingAUCrbind))
bleedingAUCrbindmsum <- rownames_as_col(melt(apply(bleedingAUCrbind, 1, median, na.rm = T)))
bleedingAUCrbindmsum$sig <- factor(bleedingAUCrbindmsum$sig, levels=bleedingAUCrbindmsum$sig[order(bleedingAUCrbindmsum$value)])
ggplot(bleedingAUCrbindmsum,
aes(x=sig, y=value))+
geom_bar(stat = "identity")+
theme(axis.text.x=element_text(angle = 45, hjust = 1))
head(bleedingAUCrbindm)
ggplot(cbind.data.frame(mean=rowSums(bleedingAUCrbind, na.rm = T),
sd=apply(bleedingAUCrbind, 1, sd, na.rm = T),
sig=rownames(bleedingAUCrbind)),
aes(x=factor(sig, levels=sig[order(value)]), y=value))+
geom_bar(stat = "identity")+
geom_errorbar(aes())
bleedingAUCrbindm$equality <- bleedingAUCrbindm$Var1 == bleedingAUCrbindm$Var2
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindm[bleedingAUCrbindm$equality,]
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+#scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))
bleedingAUCrbindm[bleedingAUCrbindm$equality,]+labs(x='Signatures', y='AUC exposures')
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+#scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))+labs(x='Signatures', y='AUC exposures')
ggplot(bleedingAUCrbindm, aes(x=factor(Var1, levels=levels(bleedingAUCrbindmsum$sig)),
y=value, col=equality))+geom_boxplot()+#scale_y_continuous(trans = "log2")+
theme_bw()+  theme(axis.text.x=element_text(angle = 45, hjust = 1))+labs(x='Signatures', y='AUC exposures')+
guides(col='none')
ggsave(paste0("../../../results/exploratory/bleeding_signatures/all_signatures_AUC_boxplots.pdf"),
height = 2.5, width = 6)
system("open ../../../results/exploratory/bleeding_signatures/")
system("open ../../../results/exploratory/bleeding_signatures/")
ggsave(paste0("../../../results/exploratory/bleeding_signatures/all_signatures_AUC_boxplots.pdf"),
height = 2.5, width = 7)
ggsave(paste0("../../../results/exploratory/bleeding_signatures/all_signatures_AUC_boxplots.pdf"),
height = 2.5, width = 8.5)
ggsave(paste0("../../../results/exploratory/bleeding_signatures/all_signatures_AUC_boxplots.pdf"),
height = 2.5, width = 9.5)
ggsave(paste0("../../../results/exploratory/bleeding_signatures/all_signatures_AUC_boxplots.pdf"),
height = 2.5, width = 10.5)

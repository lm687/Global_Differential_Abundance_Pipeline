Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:31:06 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22122.755657 
final  value 20505.754117 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 20653.78 mgc: 3.918704 ustep: 0.6827823 
iter: 2  value: 20620.04 mgc: 2.496218 ustep: 0.8263238 
iter: 3  value: 20616.1 mgc: 2.913513 ustep: 0.6983222 
iter: 4  value: 20612.49 mgc: 2.221532 ustep: 0.8356732 
iter: 5  value: 20609.85 mgc: 1.903735 ustep: 0.706945 
iter: 6  value: 20609.5 mgc: 0.6752507 ustep: 0.8408161 
iter: 7  value: 20609.5 mgc: 0.05618087 ustep: 0.9169686 
iter: 8  value: 20609.5 mgc: 0.003662941 ustep: 0.957589 
iter: 9  value: 20609.5 mgc: 0.0001203592 ustep: 0.9785669 
iter: 10  value: 20609.5 mgc: 1.967295e-06 ustep: 0.9892265 
iter: 11  value: 20609.5 mgc: 1.602262e-08 ustep: 0.9945992 
iter: 12  mgc: 6.513751e-11 
iter: 1  mgc: 6.513751e-11 
Matching hessian patterns... Done
outer mgc:  146.5851 
iter: 1  value: 20386.14 mgc: 0.6160499 ustep: 1 
iter: 2  value: 20386.14 mgc: 0.03475585 ustep: 1 
iter: 3  value: 20386.14 mgc: 0.0001174459 ustep: 1 
iter: 4  mgc: 2.509117e-09 
iter: 1  value: 20056.12 mgc: 12.28137 ustep: 1 
iter: 2  value: 20056.03 mgc: 1.052972 ustep: 1 
iter: 3  value: 20056.03 mgc: 0.007601793 ustep: 1 
iter: 4  value: 20056.03 mgc: 3.773712e-07 ustep: 1 
iter: 5  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  392.1294 
iter: 1  value: 24564.46 mgc: 1214.336 ustep: 0.05686287 
iter: 2  value: 23206.93 mgc: 120.5164 ustep: 0.04938044 
iter: 3  value: 22657.3 mgc: 113.0668 ustep: 0.04394666 
iter: 4  value: 22523.5 mgc: 53.13187 ustep: 0.2097136 
iter: 5  value: 22505.87 mgc: 35.29851 ustep: 0.4579992 
iter: 6  value: 22505.72 mgc: 2.962871 ustep: 0.6767887 
iter: 7  value: 22505.72 mgc: 0.03909095 ustep: 0.8226894 
iter: 8  value: 22505.72 mgc: 0.0007034953 ustep: 0.9070316 
iter: 9  value: 22505.72 mgc: 5.723363e-06 ustep: 0.9523868 
iter: 10  value: 22505.72 mgc: 2.281928e-08 ustep: 0.9759055 
mgc: 5.090461e-11 
iter: 1  value: 20026.25 mgc: 11.09989 ustep: 1 
iter: 2  value: 20023.08 mgc: 2.016015 ustep: 1 
iter: 3  value: 20023.08 mgc: 0.03602485 ustep: 1 
iter: 4  value: 20023.08 mgc: 2.339407e-05 ustep: 1 
iter: 5  mgc: 9.938717e-12 
iter: 1  mgc: 9.938717e-12 
outer mgc:  398.0069 
iter: 1  value: 19919.97 mgc: 7.998019 ustep: 1 
iter: 2  value: 19919.66 mgc: 1.065294 ustep: 1 
iter: 3  value: 19919.66 mgc: 0.01078482 ustep: 1 
iter: 4  value: 19919.66 mgc: 1.12171e-06 ustep: 1 
iter: 5  mgc: 2.581269e-14 
iter: 1  mgc: 2.581269e-14 
outer mgc:  101.5295 
iter: 1  value: 19848.17 mgc: 9.861686 ustep: 1 
iter: 2  value: 19843.97 mgc: 1.790859 ustep: 1 
iter: 3  value: 19843.97 mgc: 0.05086471 ustep: 1 
iter: 4  value: 19843.97 mgc: 5.089472e-05 ustep: 1 
iter: 5  mgc: 5.153078e-11 
iter: 1  mgc: 5.153078e-11 
outer mgc:  105.7265 
iter: 1  value: 19783.97 mgc: 9.210777 ustep: 1 
iter: 2  value: 19783.91 mgc: 0.4873299 ustep: 1 
iter: 3  value: 19783.91 mgc: 0.001609584 ustep: 1 
iter: 4  value: 19783.91 mgc: 1.792815e-08 ustep: 1 
mgc: 7.860379e-14 
iter: 1  mgc: 7.860379e-14 
outer mgc:  107.2339 
iter: 1  value: 19886.65 mgc: 20.10872 ustep: 1 
iter: 2  value: 19886.38 mgc: 1.374614 ustep: 1 
iter: 3  value: 19886.38 mgc: 0.006641883 ustep: 1 
iter: 4  value: 19886.38 mgc: 1.855923e-07 ustep: 1 
iter: 5  mgc: 4.884981e-14 
iter: 1  value: 19776.79 mgc: 4.363141 ustep: 1 
iter: 2  value: 19776.78 mgc: 0.04590127 ustep: 1 
iter: 3  value: 19776.78 mgc: 1.330012e-05 ustep: 1 
iter: 4  mgc: 2.153056e-12 
iter: 1  mgc: 2.153056e-12 
outer mgc:  76.81809 
iter: 1  value: 19773.57 mgc: 3.62404 ustep: 1 
iter: 2  value: 19773.57 mgc: 0.04295843 ustep: 1 
iter: 3  value: 19773.57 mgc: 9.77112e-06 ustep: 1 
iter: 4  mgc: 3.006484e-13 
iter: 1  mgc: 3.006484e-13 
outer mgc:  15.47128 
iter: 1  value: 19768.52 mgc: 4.251078 ustep: 1 
iter: 2  value: 19768.52 mgc: 0.0512713 ustep: 1 
iter: 3  value: 19768.52 mgc: 2.001253e-05 ustep: 1 
iter: 4  mgc: 3.293366e-12 
iter: 1  mgc: 3.293366e-12 
outer mgc:  13.02517 
iter: 1  value: 19769.86 mgc: 3.165763 ustep: 1 
iter: 2  value: 19769.86 mgc: 0.03577647 ustep: 1 
iter: 3  value: 19769.86 mgc: 1.38169e-05 ustep: 1 
iter: 4  mgc: 2.558842e-12 
iter: 1  value: 19768.18 mgc: 1.06769 ustep: 1 
iter: 2  value: 19768.18 mgc: 0.003990773 ustep: 1 
iter: 3  value: 19768.18 mgc: 1.557882e-07 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  19.74722 
iter: 1  value: 19768.09 mgc: 1.337823 ustep: 1 
iter: 2  value: 19768.09 mgc: 0.00304505 ustep: 1 
iter: 3  value: 19768.09 mgc: 4.259624e-08 ustep: 1 
mgc: 7.81597e-14 
iter: 1  mgc: 7.81597e-14 
outer mgc:  18.55327 
iter: 1  value: 19767.19 mgc: 0.4682239 ustep: 1 
iter: 2  value: 19767.19 mgc: 0.0007163966 ustep: 1 
iter: 3  mgc: 6.25302e-09 
iter: 1  mgc: 6.25302e-09 
outer mgc:  4.060094 
iter: 1  value: 19766.18 mgc: 0.3641627 ustep: 1 
iter: 2  value: 19766.18 mgc: 0.0003722319 ustep: 1 
iter: 3  mgc: 9.428556e-10 
iter: 1  value: 19764.88 mgc: 0.3004047 ustep: 1 
iter: 2  value: 19764.88 mgc: 0.0002721822 ustep: 1 
iter: 3  mgc: 2.312808e-10 
iter: 1  value: 19760.75 mgc: 1.011913 ustep: 1 
iter: 2  value: 19760.75 mgc: 0.002817325 ustep: 1 
iter: 3  value: 19760.75 mgc: 2.353468e-08 ustep: 1 
mgc: 7.971401e-14 
iter: 1  mgc: 7.971401e-14 
outer mgc:  6.315724 
iter: 1  value: 19760.23 mgc: 1.2752 ustep: 1 
iter: 2  value: 19760.23 mgc: 0.01226333 ustep: 1 
iter: 3  value: 19760.23 mgc: 1.496507e-06 ustep: 1 
iter: 4  mgc: 6.794565e-14 
iter: 1  mgc: 6.794565e-14 
outer mgc:  14.75503 
iter: 1  value: 19758.1 mgc: 1.03625 ustep: 1 
iter: 2  value: 19758.1 mgc: 0.003479226 ustep: 1 
iter: 3  value: 19758.1 mgc: 8.517204e-08 ustep: 1 
mgc: 5.961898e-14 
iter: 1  mgc: 5.961898e-14 
outer mgc:  19.50415 
iter: 1  value: 19754 mgc: 2.030477 ustep: 1 
iter: 2  value: 19754 mgc: 0.009894278 ustep: 1 
iter: 3  value: 19754 mgc: 4.20144e-07 ustep: 1 
iter: 4  mgc: 6.750156e-14 
iter: 1  value: 19757.72 mgc: 1.043371 ustep: 1 
iter: 2  value: 19757.72 mgc: 0.002007866 ustep: 1 
iter: 3  value: 19757.72 mgc: 4.022469e-08 ustep: 1 
mgc: 6.417089e-14 
iter: 1  value: 19757.73 mgc: 0.3647887 ustep: 1 
iter: 2  value: 19757.73 mgc: 0.0002793631 ustep: 1 
iter: 3  mgc: 7.59854e-10 
iter: 1  mgc: 7.59854e-10 
outer mgc:  8.735302 
iter: 1  value: 19757.39 mgc: 0.4471884 ustep: 1 
iter: 2  value: 19757.39 mgc: 0.000259572 ustep: 1 
iter: 3  mgc: 2.275851e-10 
iter: 1  mgc: 2.275851e-10 
outer mgc:  10.07201 
iter: 1  value: 19755.78 mgc: 0.5482875 ustep: 1 
iter: 2  value: 19755.78 mgc: 0.0006675907 ustep: 1 
iter: 3  mgc: 2.509982e-09 
iter: 1  mgc: 2.509982e-09 
outer mgc:  5.732226 
iter: 1  value: 19754.76 mgc: 0.3277465 ustep: 1 
iter: 2  value: 19754.76 mgc: 0.0002987344 ustep: 1 
iter: 3  mgc: 7.353296e-10 
iter: 1  mgc: 7.353296e-10 
outer mgc:  5.236573 
iter: 1  value: 19754.76 mgc: 0.2621553 ustep: 1 
iter: 2  value: 19754.76 mgc: 8.817091e-05 ustep: 1 
iter: 3  mgc: 2.574474e-11 
iter: 1  mgc: 2.574474e-11 
outer mgc:  4.086762 
iter: 1  value: 19752.75 mgc: 0.7293962 ustep: 1 
iter: 2  value: 19752.75 mgc: 0.0008510099 ustep: 1 
iter: 3  mgc: 6.032362e-09 
iter: 1  mgc: 6.032362e-09 
outer mgc:  3.551572 
iter: 1  value: 19750.62 mgc: 0.9173076 ustep: 1 
iter: 2  value: 19750.62 mgc: 0.002533389 ustep: 1 
iter: 3  value: 19750.62 mgc: 4.033623e-08 ustep: 1 
mgc: 5.839773e-14 
iter: 1  mgc: 5.839773e-14 
outer mgc:  8.288346 
iter: 1  value: 19749.99 mgc: 0.5409467 ustep: 1 
iter: 2  value: 19749.99 mgc: 0.0008043971 ustep: 1 
iter: 3  mgc: 2.408555e-09 
iter: 1  mgc: 2.408555e-09 
outer mgc:  7.159962 
iter: 1  value: 19750.41 mgc: 0.4187332 ustep: 1 
iter: 2  value: 19750.41 mgc: 0.0001680609 ustep: 1 
iter: 3  mgc: 2.877032e-10 
iter: 1  mgc: 2.877032e-10 
outer mgc:  5.99895 
iter: 1  value: 19748.52 mgc: 0.4716689 ustep: 1 
iter: 2  value: 19748.52 mgc: 0.0004018229 ustep: 1 
iter: 3  mgc: 8.050138e-10 
iter: 1  value: 19746.41 mgc: 0.4566634 ustep: 1 
iter: 2  value: 19746.41 mgc: 0.0005100008 ustep: 1 
iter: 3  mgc: 8.885035e-10 
iter: 1  mgc: 8.885035e-10 
outer mgc:  3.932312 
iter: 1  value: 19744.53 mgc: 1.010275 ustep: 1 
iter: 2  value: 19744.53 mgc: 0.0008260371 ustep: 1 
iter: 3  mgc: 8.590901e-09 
iter: 1  mgc: 8.590901e-09 
outer mgc:  7.075966 
iter: 1  value: 19742.85 mgc: 0.6440997 ustep: 1 
iter: 2  value: 19742.85 mgc: 0.002739909 ustep: 1 
iter: 3  value: 19742.85 mgc: 7.243168e-08 ustep: 1 
mgc: 4.241052e-14 
iter: 1  mgc: 4.241052e-14 
outer mgc:  4.694331 
iter: 1  value: 19739.56 mgc: 0.9767259 ustep: 1 
iter: 2  value: 19739.56 mgc: 0.005297618 ustep: 1 
iter: 3  value: 19739.56 mgc: 5.262385e-07 ustep: 1 
iter: 4  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  11.51377 
iter: 1  value: 19737.17 mgc: 0.9408326 ustep: 1 
iter: 2  value: 19737.17 mgc: 0.001253289 ustep: 1 
iter: 3  mgc: 5.918504e-09 
iter: 1  mgc: 5.918504e-09 
outer mgc:  12.28549 
iter: 1  value: 19734.47 mgc: 1.123348 ustep: 1 
iter: 2  value: 19734.47 mgc: 0.001404153 ustep: 1 
iter: 3  value: 19734.47 mgc: 2.023342e-08 ustep: 1 
mgc: 5.395684e-14 
iter: 1  mgc: 5.395684e-14 
outer mgc:  4.689328 
iter: 1  value: 19735.25 mgc: 0.3745157 ustep: 1 
iter: 2  value: 19735.25 mgc: 0.0007662766 ustep: 1 
iter: 3  mgc: 5.751707e-09 
iter: 1  mgc: 5.751707e-09 
outer mgc:  4.498334 
iter: 1  value: 19734.23 mgc: 0.5570144 ustep: 1 
iter: 2  value: 19734.23 mgc: 0.0003885362 ustep: 1 
iter: 3  mgc: 4.347953e-10 
iter: 1  mgc: 4.347953e-10 
outer mgc:  0.8451319 
iter: 1  value: 19732.69 mgc: 0.5093088 ustep: 1 
iter: 2  value: 19732.69 mgc: 0.0001742799 ustep: 1 
iter: 3  mgc: 3.349685e-10 
iter: 1  mgc: 3.349685e-10 
outer mgc:  3.557742 
iter: 1  value: 19731.43 mgc: 0.2898034 ustep: 1 
iter: 2  value: 19731.43 mgc: 0.0001022198 ustep: 1 
iter: 3  mgc: 3.437073e-11 
iter: 1  value: 19727.76 mgc: 0.9251166 ustep: 1 
iter: 2  value: 19727.76 mgc: 0.0007932933 ustep: 1 
iter: 3  mgc: 2.319638e-09 
iter: 1  mgc: 2.319638e-09 
outer mgc:  2.785332 
iter: 1  value: 19722.68 mgc: 1.327223 ustep: 1 
iter: 2  value: 19722.68 mgc: 0.001122873 ustep: 1 
iter: 3  mgc: 5.32615e-09 
iter: 1  mgc: 5.32615e-09 
outer mgc:  1.288984 
iter: 1  value: 19714.17 mgc: 1.92887 ustep: 1 
iter: 2  value: 19714.17 mgc: 0.001371883 ustep: 1 
iter: 3  mgc: 9.027248e-09 
iter: 1  mgc: 9.027248e-09 
outer mgc:  0.7270629 
iter: 1  value: 19709 mgc: 1.342924 ustep: 1 
iter: 2  value: 19709 mgc: 0.000770995 ustep: 1 
iter: 3  mgc: 1.87649e-09 
iter: 1  mgc: 1.87649e-09 
outer mgc:  0.3095162 
iter: 1  value: 19706.84 mgc: 0.4589886 ustep: 1 
iter: 2  value: 19706.84 mgc: 7.483164e-05 ustep: 1 
iter: 3  mgc: 1.948131e-11 
iter: 1  mgc: 1.948131e-11 
outer mgc:  0.09504604 
iter: 1  value: 19705.05 mgc: 0.3874323 ustep: 1 
iter: 2  value: 19705.05 mgc: 4.256e-05 ustep: 1 
iter: 3  mgc: 7.268852e-12 
iter: 1  mgc: 7.268852e-12 
outer mgc:  0.03335267 
iter: 1  value: 19704.55 mgc: 0.1121071 ustep: 1 
iter: 2  value: 19704.55 mgc: 4.674403e-06 ustep: 1 
iter: 3  mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  0.009664012 
iter: 1  value: 19704.49 mgc: 0.01496036 ustep: 1 
iter: 2  value: 19704.49 mgc: 3.597619e-08 ustep: 1 
mgc: 6.450396e-14 
iter: 1  mgc: 6.450396e-14 
outer mgc:  0.00315304 
iter: 1  mgc: 6.450396e-14 
iter: 1  mgc: 6.450396e-14 
outer mgc:  0.00315304 
iter: 1  value: 19704.48 mgc: 0.02072924 ustep: 1 
iter: 2  value: 19704.48 mgc: 9.241608e-07 ustep: 1 
iter: 3  mgc: 5.018208e-14 
outer mgc:  1.085623 
iter: 1  value: 19704.49 mgc: 0.02071945 ustep: 1 
iter: 2  value: 19704.49 mgc: 9.233314e-07 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  1.083799 
iter: 1  value: 19704.49 mgc: 0.009481742 ustep: 1 
iter: 2  value: 19704.49 mgc: 1.333575e-07 ustep: 1 
iter: 3  mgc: 8.903989e-14 
outer mgc:  0.5862339 
iter: 1  value: 19704.49 mgc: 0.009475176 ustep: 1 
iter: 2  value: 19704.49 mgc: 1.332023e-07 ustep: 1 
iter: 3  mgc: 7.638334e-14 
outer mgc:  0.5907168 
iter: 1  value: 19704.49 mgc: 0.02319389 ustep: 1 
iter: 2  value: 19704.49 mgc: 9.737486e-07 ustep: 1 
iter: 3  mgc: 5.839773e-14 
outer mgc:  1.133538 
iter: 1  value: 19704.49 mgc: 0.0231883 ustep: 1 
iter: 2  value: 19704.49 mgc: 9.734918e-07 ustep: 1 
iter: 3  mgc: 6.020184e-14 
outer mgc:  1.139806 
iter: 1  value: 19704.49 mgc: 0.01292009 ustep: 1 
iter: 2  value: 19704.49 mgc: 4.568619e-07 ustep: 1 
iter: 3  mgc: 6.150636e-14 
outer mgc:  0.8045992 
iter: 1  value: 19704.48 mgc: 0.01291791 ustep: 1 
iter: 2  value: 19704.48 mgc: 4.567237e-07 ustep: 1 
iter: 3  mgc: 5.551115e-14 
outer mgc:  0.8068785 
iter: 1  value: 19704.54 mgc: 0.137178 ustep: 1 
iter: 2  value: 19704.54 mgc: 4.704503e-06 ustep: 1 
iter: 3  mgc: 1.003642e-13 
outer mgc:  0.2688047 
iter: 1  value: 19704.43 mgc: 0.1375838 ustep: 1 
iter: 2  value: 19704.43 mgc: 4.717815e-06 ustep: 1 
iter: 3  mgc: 9.725554e-14 
outer mgc:  0.2642798 
iter: 1  value: 19704.54 mgc: 0.1364733 ustep: 1 
iter: 2  value: 19704.54 mgc: 2.643274e-06 ustep: 1 
iter: 3  mgc: 1.301181e-13 
outer mgc:  0.2755301 
iter: 1  value: 19704.44 mgc: 0.1368803 ustep: 1 
iter: 2  value: 19704.44 mgc: 2.647166e-06 ustep: 1 
iter: 3  mgc: 8.593126e-14 
outer mgc:  0.2783775 
iter: 1  value: 19704.47 mgc: 0.003464286 ustep: 1 
iter: 2  mgc: 3.553906e-09 
outer mgc:  0.003173741 
iter: 1  value: 19704.5 mgc: 0.003463628 ustep: 1 
iter: 2  mgc: 3.557238e-09 
outer mgc:  0.003132336 
iter: 1  value: 19704.46 mgc: 0.005445196 ustep: 1 
iter: 2  value: 19704.46 mgc: 3.802539e-08 ustep: 1 
mgc: 5.684342e-14 
outer mgc:  0.03873921 
iter: 1  value: 19704.51 mgc: 0.005444271 ustep: 1 
iter: 2  value: 19704.51 mgc: 3.805289e-08 ustep: 1 
mgc: 5.417888e-14 
outer mgc:  0.03889245 
[Sun Aug 15 22:31:10 2021]
Finished job 0.
1 of 1 steps (100%) done

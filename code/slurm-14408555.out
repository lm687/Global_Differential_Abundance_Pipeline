Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:13:44 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.8_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_0.8_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.8_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10931.192272 
final  value 10591.474022 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2387.816 mgc: 84.69084 ustep: 1 
iter: 2  value: 2256.711 mgc: 50.2773 ustep: 0.4367355 
iter: 3  value: 1871.249 mgc: 130.3581 ustep: 0.6608936 
iter: 4  value: 1863.496 mgc: 34.79432 ustep: 0.3423004 
iter: 5  value: 1787.404 mgc: 64.65533 ustep: 0.585106 
iter: 6  value: 1786.356 mgc: 4.553455 ustep: 0.7649457 
iter: 7  value: 1786.353 mgc: 0.3648851 ustep: 0.8746243 
iter: 8  value: 1786.353 mgc: 0.005291814 ustep: 0.93522 
iter: 9  value: 1786.353 mgc: 1.991332e-05 ustep: 0.967071 
iter: 10  value: 1786.353 mgc: 9.51048e-08 ustep: 0.9833993 
iter: 11  mgc: 7.058202e-10 
iter: 1  mgc: 7.058202e-10 
Matching hessian patterns... Done
outer mgc:  887.8201 
iter: 1  value: 1180.956 mgc: 34.95093 ustep: 1 
iter: 2  value: 1173.136 mgc: 8.854257 ustep: 1 
iter: 3  value: 1173.127 mgc: 0.4149599 ustep: 1 
iter: 4  value: 1173.127 mgc: 0.001960264 ustep: 1 
iter: 5  value: 1173.127 mgc: 4.451629e-08 ustep: 1 
mgc: 2.914335e-14 
iter: 1  mgc: 2.914335e-14 
outer mgc:  263.5923 
iter: 1  value: 1064.114 mgc: 22.48929 ustep: 1 
iter: 2  value: 1063.595 mgc: 1.590059 ustep: 1 
iter: 3  value: 1063.595 mgc: 0.01993184 ustep: 1 
iter: 4  value: 1063.595 mgc: 4.208475e-06 ustep: 1 
iter: 5  mgc: 5.082601e-13 
iter: 1  mgc: 5.082601e-13 
outer mgc:  133.0728 
iter: 1  value: 1120.291 mgc: 33.06225 ustep: 1 
iter: 2  value: 1116.987 mgc: 4.132722 ustep: 1 
iter: 3  value: 1116.986 mgc: 0.07798226 ustep: 1 
iter: 4  value: 1116.986 mgc: 3.140746e-05 ustep: 1 
iter: 5  mgc: 5.174305e-12 
iter: 1  value: 1043.568 mgc: 14.60699 ustep: 1 
iter: 2  value: 1043.43 mgc: 0.7214499 ustep: 1 
iter: 3  value: 1043.43 mgc: 0.002718947 ustep: 1 
iter: 4  value: 1043.43 mgc: 4.731833e-08 ustep: 1 
mgc: 3.125278e-14 
iter: 1  mgc: 3.125278e-14 
outer mgc:  88.55272 
iter: 1  value: 1019.199 mgc: 5.556787 ustep: 1 
iter: 2  value: 1019.195 mgc: 0.109634 ustep: 1 
iter: 3  value: 1019.195 mgc: 0.0003179571 ustep: 1 
iter: 4  mgc: 3.353268e-09 
iter: 1  mgc: 3.353268e-09 
outer mgc:  30.44737 
iter: 1  value: 1007.013 mgc: 16.79046 ustep: 1 
iter: 2  value: 1006.812 mgc: 1.147619 ustep: 1 
iter: 3  value: 1006.812 mgc: 0.005722683 ustep: 1 
iter: 4  value: 1006.812 mgc: 2.387447e-07 ustep: 1 
iter: 5  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  110.849 
iter: 1  value: 1102.675 mgc: 45.65045 ustep: 1 
iter: 2  value: 1076.691 mgc: 10.99338 ustep: 1 
iter: 3  value: 1076.664 mgc: 0.6406271 ustep: 1 
iter: 4  value: 1076.664 mgc: 0.003246334 ustep: 1 
iter: 5  value: 1076.664 mgc: 8.473369e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  value: 995.2421 mgc: 8.726859 ustep: 1 
iter: 2  value: 995.2283 mgc: 0.2309927 ustep: 1 
iter: 3  value: 995.2283 mgc: 0.0003475201 ustep: 1 
iter: 4  mgc: 1.047817e-09 
iter: 1  mgc: 1.047817e-09 
outer mgc:  7.947586 
iter: 1  value: 995.3377 mgc: 1.769535 ustep: 1 
iter: 2  value: 995.3376 mgc: 0.0337246 ustep: 1 
iter: 3  value: 995.3376 mgc: 2.062922e-05 ustep: 1 
iter: 4  mgc: 7.750245e-12 
iter: 1  value: 994.6818 mgc: 0.7262276 ustep: 1 
iter: 2  value: 994.6818 mgc: 0.005467812 ustep: 1 
iter: 3  value: 994.6818 mgc: 5.706268e-07 ustep: 1 
iter: 4  mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  9.516766 
iter: 1  value: 994.6037 mgc: 2.530682 ustep: 1 
iter: 2  value: 994.6036 mgc: 0.02087639 ustep: 1 
iter: 3  value: 994.6036 mgc: 2.522153e-06 ustep: 1 
iter: 4  mgc: 5.77316e-14 
iter: 1  mgc: 5.77316e-14 
outer mgc:  17.97321 
iter: 1  value: 993.8792 mgc: 2.873866 ustep: 1 
iter: 2  value: 993.8791 mgc: 0.02454159 ustep: 1 
iter: 3  value: 993.8791 mgc: 3.981064e-06 ustep: 1 
iter: 4  mgc: 1.350031e-13 
iter: 1  mgc: 1.350031e-13 
outer mgc:  4.975601 
iter: 1  value: 993.6084 mgc: 2.293215 ustep: 1 
iter: 2  value: 993.6083 mgc: 0.0206285 ustep: 1 
iter: 3  value: 993.6083 mgc: 7.070117e-06 ustep: 1 
iter: 4  mgc: 8.397727e-13 
iter: 1  mgc: 8.397727e-13 
outer mgc:  7.95658 
iter: 1  value: 993.2878 mgc: 1.205937 ustep: 1 
iter: 2  value: 993.2878 mgc: 0.009164367 ustep: 1 
iter: 3  value: 993.2878 mgc: 6.531323e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  5.06399 
iter: 1  value: 993.2517 mgc: 1.81767 ustep: 1 
iter: 2  value: 993.2517 mgc: 0.007200922 ustep: 1 
iter: 3  value: 993.2517 mgc: 2.6642e-07 ustep: 1 
iter: 4  mgc: 3.13638e-14 
iter: 1  mgc: 3.13638e-14 
outer mgc:  6.351001 
iter: 1  value: 992.9245 mgc: 1.439637 ustep: 1 
iter: 2  value: 992.9245 mgc: 0.008237555 ustep: 1 
iter: 3  value: 992.9245 mgc: 5.525397e-07 ustep: 1 
iter: 4  mgc: 2.864375e-14 
iter: 1  mgc: 2.864375e-14 
outer mgc:  1.936515 
iter: 1  value: 992.9621 mgc: 0.8817643 ustep: 1 
iter: 2  value: 992.9621 mgc: 0.002597175 ustep: 1 
iter: 3  value: 992.9621 mgc: 3.84934e-08 ustep: 1 
mgc: 3.619327e-14 
iter: 1  value: 992.9063 mgc: 0.2410852 ustep: 1 
iter: 2  value: 992.9063 mgc: 0.0002373643 ustep: 1 
iter: 3  mgc: 4.463629e-10 
iter: 1  mgc: 4.463629e-10 
outer mgc:  5.161203 
iter: 1  value: 992.8467 mgc: 0.4803829 ustep: 1 
iter: 2  value: 992.8467 mgc: 0.0004793212 ustep: 1 
iter: 3  mgc: 1.184456e-09 
iter: 1  mgc: 1.184456e-09 
outer mgc:  1.803761 
iter: 1  value: 992.8299 mgc: 0.532567 ustep: 1 
iter: 2  value: 992.8299 mgc: 0.0008570828 ustep: 1 
iter: 3  mgc: 5.945308e-09 
iter: 1  mgc: 5.945308e-09 
outer mgc:  1.642714 
iter: 1  value: 992.7982 mgc: 0.2527382 ustep: 1 
iter: 2  value: 992.7982 mgc: 0.00017922 ustep: 1 
iter: 3  mgc: 1.567431e-10 
iter: 1  mgc: 1.567431e-10 
outer mgc:  1.366759 
iter: 1  value: 992.7751 mgc: 0.0480806 ustep: 1 
iter: 2  value: 992.7751 mgc: 1.961533e-05 ustep: 1 
iter: 3  mgc: 3.584222e-11 
iter: 1  mgc: 3.584222e-11 
outer mgc:  1.495897 
iter: 1  value: 992.7196 mgc: 0.230284 ustep: 1 
iter: 2  value: 992.7196 mgc: 0.0003557281 ustep: 1 
iter: 3  mgc: 2.178447e-09 
iter: 1  mgc: 2.178447e-09 
outer mgc:  1.169269 
iter: 1  value: 992.6661 mgc: 0.6881506 ustep: 1 
iter: 2  value: 992.6661 mgc: 0.0008604707 ustep: 1 
iter: 3  mgc: 4.462196e-09 
iter: 1  mgc: 4.462196e-09 
outer mgc:  1.853649 
iter: 1  value: 992.6583 mgc: 0.8629225 ustep: 1 
iter: 2  value: 992.6583 mgc: 0.001924108 ustep: 1 
iter: 3  value: 992.6583 mgc: 2.796073e-08 ustep: 1 
mgc: 3.094747e-14 
iter: 1  mgc: 3.094747e-14 
outer mgc:  2.981677 
iter: 1  value: 992.6246 mgc: 0.3801759 ustep: 1 
iter: 2  value: 992.6246 mgc: 0.0004115182 ustep: 1 
iter: 3  mgc: 9.685701e-10 
iter: 1  mgc: 9.685701e-10 
outer mgc:  1.844 
iter: 1  value: 992.5935 mgc: 0.4299509 ustep: 1 
iter: 2  value: 992.5935 mgc: 0.0009492846 ustep: 1 
iter: 3  mgc: 5.89005e-09 
iter: 1  mgc: 5.89005e-09 
outer mgc:  1.234373 
iter: 1  value: 992.569 mgc: 0.2463588 ustep: 1 
iter: 2  value: 992.569 mgc: 0.0002534401 ustep: 1 
iter: 3  mgc: 5.877026e-10 
iter: 1  mgc: 5.877026e-10 
outer mgc:  1.122018 
iter: 1  value: 992.4974 mgc: 0.5768629 ustep: 1 
iter: 2  value: 992.4974 mgc: 0.001713158 ustep: 1 
iter: 3  value: 992.4974 mgc: 2.551624e-08 ustep: 1 
mgc: 2.520206e-14 
iter: 1  mgc: 2.520206e-14 
outer mgc:  1.055041 
iter: 1  value: 992.5356 mgc: 0.2977336 ustep: 1 
iter: 2  value: 992.5356 mgc: 0.0001907378 ustep: 1 
iter: 3  mgc: 1.945319e-10 
iter: 1  mgc: 1.945319e-10 
outer mgc:  0.4979985 
iter: 1  value: 992.5238 mgc: 0.2780203 ustep: 1 
iter: 2  value: 992.5238 mgc: 0.0003256367 ustep: 1 
iter: 3  mgc: 9.445831e-10 
iter: 1  mgc: 9.445831e-10 
outer mgc:  0.9991346 
iter: 1  value: 992.5129 mgc: 0.2174451 ustep: 1 
iter: 2  value: 992.5129 mgc: 0.0002064424 ustep: 1 
iter: 3  mgc: 3.291014e-10 
iter: 1  mgc: 3.291014e-10 
outer mgc:  0.6061993 
iter: 1  value: 992.5317 mgc: 0.310852 ustep: 1 
iter: 2  value: 992.5317 mgc: 0.0003751193 ustep: 1 
iter: 3  mgc: 2.407318e-09 
iter: 1  mgc: 2.407318e-09 
outer mgc:  0.5509909 
iter: 1  value: 992.5048 mgc: 0.1582671 ustep: 1 
iter: 2  value: 992.5048 mgc: 0.0001046558 ustep: 1 
iter: 3  mgc: 1.106342e-10 
iter: 1  mgc: 1.106342e-10 
outer mgc:  0.120586 
iter: 1  value: 992.5183 mgc: 0.0761052 ustep: 1 
iter: 2  value: 992.5183 mgc: 3.68918e-05 ustep: 1 
iter: 3  mgc: 2.386358e-11 
iter: 1  value: 992.5123 mgc: 0.02919219 ustep: 1 
iter: 2  value: 992.5123 mgc: 8.125106e-06 ustep: 1 
iter: 3  mgc: 8.002488e-13 
iter: 1  mgc: 8.002488e-13 
outer mgc:  0.1230784 
iter: 1  value: 992.5155 mgc: 0.06875924 ustep: 1 
iter: 2  value: 992.5155 mgc: 2.507601e-05 ustep: 1 
iter: 3  mgc: 6.075584e-12 
iter: 1  mgc: 6.075584e-12 
outer mgc:  0.1252372 
iter: 1  value: 992.5152 mgc: 0.02710907 ustep: 1 
iter: 2  value: 992.5152 mgc: 2.160077e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.02374503 
iter: 1  value: 992.5148 mgc: 0.009975529 ustep: 1 
iter: 2  value: 992.5148 mgc: 4.224242e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.01333001 
iter: 1  value: 992.5148 mgc: 0.003820959 ustep: 1 
iter: 2  value: 992.5148 mgc: 6.666763e-08 ustep: 1 
iter: 3  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  0.001110239 
iter: 1  value: 992.5149 mgc: 8.467602e-05 ustep: 1 
iter: 2  mgc: 1.082956e-10 
iter: 1  mgc: 1.082956e-10 
outer mgc:  0.0002952651 
iter: 1  mgc: 1.082956e-10 
iter: 1  mgc: 1.082956e-10 
outer mgc:  0.0002952651 
iter: 1  value: 992.5145 mgc: 0.05795128 ustep: 1 
iter: 2  value: 992.5145 mgc: 8.486087e-06 ustep: 1 
iter: 3  mgc: 4.689582e-13 
outer mgc:  0.1928226 
iter: 1  value: 992.5154 mgc: 0.05794358 ustep: 1 
iter: 2  value: 992.5154 mgc: 8.494802e-06 ustep: 1 
iter: 3  mgc: 4.645173e-13 
outer mgc:  0.1927013 
iter: 1  value: 992.5147 mgc: 0.0293638 ustep: 1 
iter: 2  value: 992.5147 mgc: 2.98855e-06 ustep: 1 
iter: 3  mgc: 4.818368e-14 
outer mgc:  0.5318807 
iter: 1  value: 992.5155 mgc: 0.02935952 ustep: 1 
iter: 2  value: 992.5155 mgc: 2.989433e-06 ustep: 1 
iter: 3  mgc: 4.596323e-14 
outer mgc:  0.5312554 
iter: 1  value: 992.5157 mgc: 0.05347202 ustep: 1 
iter: 2  value: 992.5157 mgc: 6.907583e-06 ustep: 1 
iter: 3  mgc: 3.050615e-13 
outer mgc:  0.2049184 
iter: 1  value: 992.5143 mgc: 0.05345846 ustep: 1 
iter: 2  value: 992.5143 mgc: 6.916986e-06 ustep: 1 
iter: 3  mgc: 2.979561e-13 
outer mgc:  0.2049706 
iter: 1  value: 992.5176 mgc: 0.03026337 ustep: 1 
iter: 2  value: 992.5176 mgc: 3.067299e-06 ustep: 1 
iter: 3  mgc: 6.977752e-14 
outer mgc:  0.5927159 
iter: 1  value: 992.5127 mgc: 0.0302607 ustep: 1 
iter: 2  value: 992.5127 mgc: 3.071147e-06 ustep: 1 
iter: 3  mgc: 6.261658e-14 
outer mgc:  0.5930111 
iter: 1  value: 992.5121 mgc: 0.005007606 ustep: 1 
iter: 2  value: 992.5121 mgc: 3.66703e-07 ustep: 1 
iter: 3  mgc: 2.725771e-14 
outer mgc:  0.01570789 
iter: 1  value: 992.5177 mgc: 0.005005225 ustep: 1 
iter: 2  value: 992.5177 mgc: 3.665951e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.01549564 
iter: 1  value: 992.5203 mgc: 0.01316232 ustep: 1 
iter: 2  value: 992.5203 mgc: 2.734471e-06 ustep: 1 
iter: 3  mgc: 1.163514e-13 
outer mgc:  0.2512536 
iter: 1  value: 992.5097 mgc: 0.01319376 ustep: 1 
iter: 2  value: 992.5097 mgc: 2.741297e-06 ustep: 1 
iter: 3  mgc: 1.190159e-13 
outer mgc:  0.251308 
iter: 1  value: 992.5195 mgc: 0.01380074 ustep: 1 
iter: 2  value: 992.5195 mgc: 1.007327e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.2610349 
iter: 1  value: 992.5104 mgc: 0.01383513 ustep: 1 
iter: 2  value: 992.5104 mgc: 1.01376e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.2617278 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:13:46 2021]
Finished job 0.
1 of 1 steps (100%) done

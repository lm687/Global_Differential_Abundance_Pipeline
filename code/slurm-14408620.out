Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:17:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22094.191737 
final  value 21657.551666 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6051.923 mgc: 80.94223 ustep: 1 
iter: 2  value: 4470.959 mgc: 63.70471 ustep: 0.2494656 
iter: 3  value: 3496.516 mgc: 158.4338 ustep: 0.4995153 
iter: 4  value: 2720.484 mgc: 59.41699 ustep: 0.1421311 
iter: 5  value: 2599.273 mgc: 105.5287 ustep: 0.3770651 
iter: 6  value: 2515.769 mgc: 76.88086 ustep: 0.6140949 
iter: 7  value: 2507.886 mgc: 16.29151 ustep: 0.7836637 
iter: 8  value: 2507.758 mgc: 2.301313 ustep: 0.8852593 
iter: 9  value: 2507.758 mgc: 0.1023829 ustep: 0.9408881 
iter: 10  value: 2507.758 mgc: 0.0005157672 ustep: 0.9699969 
iter: 11  value: 2507.758 mgc: 8.054566e-07 ustep: 0.9848857 
iter: 12  mgc: 6.346648e-10 
iter: 1  mgc: 6.346648e-10 
Matching hessian patterns... Done
outer mgc:  661.1509 
iter: 1  value: 2236.384 mgc: 23.99809 ustep: 1 
iter: 2  value: 2233.618 mgc: 3.118283 ustep: 1 
iter: 3  value: 2233.618 mgc: 0.0784203 ustep: 1 
iter: 4  value: 2233.618 mgc: 5.513086e-05 ustep: 1 
iter: 5  mgc: 2.730866e-11 
iter: 1  mgc: 2.730866e-11 
outer mgc:  424.9905 
iter: 1  value: 2342.599 mgc: 32.64794 ustep: 1 
iter: 2  value: 2322.619 mgc: 6.651644 ustep: 1 
iter: 3  value: 2322.601 mgc: 0.2891205 ustep: 1 
iter: 4  value: 2322.601 mgc: 0.000885219 ustep: 1 
iter: 5  value: 2322.601 mgc: 1.954544e-08 ustep: 1 
mgc: 4.185541e-14 
iter: 1  value: 2132.473 mgc: 16.06152 ustep: 1 
iter: 2  value: 2131.79 mgc: 1.228724 ustep: 1 
iter: 3  value: 2131.79 mgc: 0.01201492 ustep: 1 
iter: 4  value: 2131.79 mgc: 2.113439e-06 ustep: 1 
iter: 5  mgc: 7.771561e-14 
iter: 1  mgc: 7.771561e-14 
outer mgc:  144.0137 
iter: 1  value: 2111.795 mgc: 5.893225 ustep: 1 
iter: 2  value: 2111.787 mgc: 0.127744 ustep: 1 
iter: 3  value: 2111.787 mgc: 0.0001423594 ustep: 1 
iter: 4  mgc: 2.691632e-10 
iter: 1  mgc: 2.691632e-10 
outer mgc:  221.7382 
iter: 1  value: 2020.712 mgc: 31.26484 ustep: 1 
iter: 2  value: 2012.553 mgc: 4.297442 ustep: 1 
iter: 3  value: 2012.548 mgc: 0.1510972 ustep: 1 
iter: 4  value: 2012.548 mgc: 0.0003665576 ustep: 1 
iter: 5  mgc: 3.945475e-09 
iter: 1  mgc: 3.945475e-09 
outer mgc:  112.4272 
iter: 1  value: 2033.435 mgc: 12.8761 ustep: 1 
iter: 2  value: 2033.352 mgc: 0.9213043 ustep: 1 
iter: 3  value: 2033.352 mgc: 0.01196042 ustep: 1 
iter: 4  value: 2033.352 mgc: 2.035104e-06 ustep: 1 
iter: 5  mgc: 6.306067e-14 
iter: 1  value: 1997.962 mgc: 3.562941 ustep: 1 
iter: 2  value: 1997.962 mgc: 0.03390608 ustep: 1 
iter: 3  value: 1997.962 mgc: 2.759061e-05 ustep: 1 
iter: 4  mgc: 1.877609e-11 
iter: 1  mgc: 1.877609e-11 
outer mgc:  111.4286 
iter: 1  value: 1997.131 mgc: 13.85128 ustep: 1 
iter: 2  value: 1996.837 mgc: 0.7026653 ustep: 1 
iter: 3  value: 1996.837 mgc: 0.004810114 ustep: 1 
iter: 4  value: 1996.837 mgc: 4.183287e-07 ustep: 1 
iter: 5  mgc: 3.319567e-14 
iter: 1  value: 1991.041 mgc: 7.320496 ustep: 1 
iter: 2  value: 1991.024 mgc: 0.1729659 ustep: 1 
iter: 3  value: 1991.024 mgc: 0.0002402687 ustep: 1 
iter: 4  mgc: 6.982734e-10 
iter: 1  mgc: 6.982734e-10 
outer mgc:  68.17833 
iter: 1  value: 1988.117 mgc: 8.855167 ustep: 1 
iter: 2  value: 1988.096 mgc: 0.2439973 ustep: 1 
iter: 3  value: 1988.096 mgc: 0.000243926 ustep: 1 
iter: 4  mgc: 4.270766e-10 
iter: 1  mgc: 4.270766e-10 
outer mgc:  30.20301 
iter: 1  value: 1986.801 mgc: 7.727436 ustep: 1 
iter: 2  value: 1986.78 mgc: 0.1813586 ustep: 1 
iter: 3  value: 1986.78 mgc: 0.0002494284 ustep: 1 
iter: 4  mgc: 5.424976e-10 
iter: 1  mgc: 5.424976e-10 
outer mgc:  22.25605 
iter: 1  value: 1987.242 mgc: 4.130258 ustep: 1 
iter: 2  value: 1987.241 mgc: 0.04037967 ustep: 1 
iter: 3  value: 1987.241 mgc: 1.030351e-05 ustep: 1 
iter: 4  mgc: 9.10827e-13 
iter: 1  value: 1985.702 mgc: 2.119386 ustep: 1 
iter: 2  value: 1985.702 mgc: 0.01219289 ustep: 1 
iter: 3  value: 1985.702 mgc: 1.083998e-06 ustep: 1 
iter: 4  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  14.92723 
iter: 1  value: 1986.792 mgc: 3.058032 ustep: 1 
iter: 2  value: 1986.791 mgc: 0.02203786 ustep: 1 
iter: 3  value: 1986.791 mgc: 2.593287e-06 ustep: 1 
iter: 4  mgc: 5.995204e-14 
iter: 1  value: 1985.482 mgc: 0.7484324 ustep: 1 
iter: 2  value: 1985.482 mgc: 0.001359576 ustep: 1 
iter: 3  mgc: 9.953412e-09 
iter: 1  mgc: 9.953412e-09 
outer mgc:  5.014976 
iter: 1  value: 1985.292 mgc: 0.1719892 ustep: 1 
iter: 2  value: 1985.292 mgc: 0.000169566 ustep: 1 
iter: 3  mgc: 6.481589e-10 
iter: 1  mgc: 6.481589e-10 
outer mgc:  4.136604 
iter: 1  value: 1985.163 mgc: 0.5277564 ustep: 1 
iter: 2  value: 1985.163 mgc: 0.000827618 ustep: 1 
iter: 3  mgc: 4.440696e-09 
iter: 1  mgc: 4.440696e-09 
outer mgc:  10.93899 
iter: 1  value: 1985.102 mgc: 0.5971386 ustep: 1 
iter: 2  value: 1985.102 mgc: 0.0008383501 ustep: 1 
iter: 3  mgc: 3.640886e-09 
iter: 1  mgc: 3.640886e-09 
outer mgc:  3.843123 
iter: 1  value: 1985.162 mgc: 0.3599112 ustep: 1 
iter: 2  value: 1985.162 mgc: 0.0003609464 ustep: 1 
iter: 3  mgc: 1.548611e-09 
iter: 1  mgc: 1.548611e-09 
outer mgc:  5.429552 
iter: 1  value: 1985.047 mgc: 0.2258345 ustep: 1 
iter: 2  value: 1985.047 mgc: 0.0003392029 ustep: 1 
iter: 3  mgc: 2.57822e-09 
iter: 1  mgc: 2.57822e-09 
outer mgc:  2.177986 
iter: 1  value: 1985.072 mgc: 0.5788093 ustep: 1 
iter: 2  value: 1985.072 mgc: 0.0008684974 ustep: 1 
iter: 3  mgc: 4.080092e-09 
iter: 1  value: 1985.005 mgc: 0.1976236 ustep: 1 
iter: 2  value: 1985.005 mgc: 8.262549e-05 ustep: 1 
iter: 3  mgc: 3.669387e-11 
iter: 1  mgc: 3.669387e-11 
outer mgc:  4.14152 
iter: 1  value: 1985.001 mgc: 0.212738 ustep: 1 
iter: 2  value: 1985.001 mgc: 0.0001015081 ustep: 1 
iter: 3  mgc: 5.359091e-11 
iter: 1  mgc: 5.359091e-11 
outer mgc:  1.052063 
iter: 1  value: 1984.992 mgc: 0.1133765 ustep: 1 
iter: 2  value: 1984.992 mgc: 4.148979e-05 ustep: 1 
iter: 3  mgc: 1.5421e-11 
iter: 1  mgc: 1.5421e-11 
outer mgc:  1.547415 
iter: 1  value: 1985.032 mgc: 0.1752322 ustep: 1 
iter: 2  value: 1985.032 mgc: 7.257871e-05 ustep: 1 
iter: 3  mgc: 3.883843e-11 
iter: 1  mgc: 3.883843e-11 
outer mgc:  1.430309 
iter: 1  value: 1984.937 mgc: 0.3895915 ustep: 1 
iter: 2  value: 1984.937 mgc: 0.0005249156 ustep: 1 
iter: 3  mgc: 1.758942e-09 
iter: 1  value: 1984.983 mgc: 0.07335998 ustep: 1 
iter: 2  value: 1984.983 mgc: 2.517619e-05 ustep: 1 
iter: 3  mgc: 1.569944e-11 
iter: 1  mgc: 1.569944e-11 
outer mgc:  0.9831638 
iter: 1  value: 1984.971 mgc: 0.09734283 ustep: 1 
iter: 2  value: 1984.971 mgc: 2.732217e-05 ustep: 1 
iter: 3  mgc: 4.427569e-12 
iter: 1  mgc: 4.427569e-12 
outer mgc:  1.440396 
iter: 1  value: 1984.952 mgc: 0.03854196 ustep: 1 
iter: 2  value: 1984.952 mgc: 8.87141e-06 ustep: 1 
iter: 3  mgc: 1.115219e-12 
iter: 1  mgc: 1.115219e-12 
outer mgc:  0.4325502 
iter: 1  value: 1984.95 mgc: 0.0961782 ustep: 1 
iter: 2  value: 1984.95 mgc: 2.964254e-05 ustep: 1 
iter: 3  mgc: 8.260503e-12 
iter: 1  mgc: 8.260503e-12 
outer mgc:  0.8939416 
iter: 1  value: 1984.957 mgc: 0.1820662 ustep: 1 
iter: 2  value: 1984.957 mgc: 0.0001287047 ustep: 1 
iter: 3  mgc: 1.556502e-10 
iter: 1  mgc: 1.556502e-10 
outer mgc:  0.5059603 
iter: 1  value: 1984.966 mgc: 0.1754162 ustep: 1 
iter: 2  value: 1984.966 mgc: 9.417241e-05 ustep: 1 
iter: 3  mgc: 7.673406e-11 
iter: 1  value: 1984.958 mgc: 0.05794729 ustep: 1 
iter: 2  value: 1984.958 mgc: 9.818104e-06 ustep: 1 
iter: 3  mgc: 6.430412e-13 
iter: 1  mgc: 6.430412e-13 
outer mgc:  0.8243837 
iter: 1  value: 1984.956 mgc: 0.02887326 ustep: 1 
iter: 2  value: 1984.956 mgc: 1.819653e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
iter: 1  mgc: 4.218847e-14 
outer mgc:  0.2715412 
iter: 1  value: 1984.954 mgc: 0.02620926 ustep: 1 
iter: 2  value: 1984.954 mgc: 2.215042e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
iter: 1  value: 1984.952 mgc: 0.03202028 ustep: 1 
iter: 2  value: 1984.952 mgc: 3.306088e-06 ustep: 1 
iter: 3  mgc: 7.727152e-14 
iter: 1  mgc: 7.727152e-14 
outer mgc:  0.8145892 
iter: 1  value: 1984.976 mgc: 0.143917 ustep: 1 
iter: 2  value: 1984.976 mgc: 6.633482e-05 ustep: 1 
iter: 3  mgc: 5.726974e-11 
iter: 1  value: 1984.961 mgc: 0.05718614 ustep: 1 
iter: 2  value: 1984.961 mgc: 1.294692e-05 ustep: 1 
iter: 3  mgc: 1.678879e-12 
iter: 1  mgc: 1.678879e-12 
outer mgc:  0.2987551 
iter: 1  value: 1984.969 mgc: 0.04660973 ustep: 1 
iter: 2  value: 1984.969 mgc: 9.429647e-06 ustep: 1 
iter: 3  mgc: 6.554757e-13 
iter: 1  mgc: 6.554757e-13 
outer mgc:  0.1678817 
iter: 1  value: 1984.951 mgc: 0.06489741 ustep: 1 
iter: 2  value: 1984.951 mgc: 1.099838e-05 ustep: 1 
iter: 3  mgc: 6.714629e-13 
iter: 1  value: 1984.96 mgc: 0.02914004 ustep: 1 
iter: 2  value: 1984.96 mgc: 2.218755e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
iter: 1  mgc: 5.284662e-14 
outer mgc:  0.2511149 
iter: 1  value: 1984.961 mgc: 0.01887862 ustep: 1 
iter: 2  value: 1984.961 mgc: 7.799286e-07 ustep: 1 
iter: 3  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.1914351 
iter: 1  value: 1984.966 mgc: 0.02293323 ustep: 1 
iter: 2  value: 1984.966 mgc: 1.289619e-06 ustep: 1 
iter: 3  mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  0.095243 
iter: 1  value: 1984.963 mgc: 0.03234935 ustep: 1 
iter: 2  value: 1984.963 mgc: 2.17867e-06 ustep: 1 
iter: 3  mgc: 3.830269e-14 
iter: 1  mgc: 3.830269e-14 
outer mgc:  0.1528636 
iter: 1  value: 1984.961 mgc: 0.01575215 ustep: 1 
iter: 2  value: 1984.961 mgc: 8.20699e-07 ustep: 1 
iter: 3  mgc: 4.485301e-14 
iter: 1  mgc: 4.485301e-14 
outer mgc:  0.07310186 
iter: 1  value: 1984.964 mgc: 0.0126719 ustep: 1 
iter: 2  value: 1984.964 mgc: 5.67447e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  0.2394238 
iter: 1  value: 1984.965 mgc: 0.007978376 ustep: 1 
iter: 2  value: 1984.965 mgc: 2.012103e-07 ustep: 1 
iter: 3  mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  0.04532369 
iter: 1  value: 1984.966 mgc: 0.01652186 ustep: 1 
iter: 2  value: 1984.966 mgc: 6.968784e-07 ustep: 1 
iter: 3  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.06823036 
iter: 1  value: 1984.963 mgc: 0.01059441 ustep: 1 
iter: 2  value: 1984.963 mgc: 5.132793e-07 ustep: 1 
iter: 3  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  0.02747475 
iter: 1  value: 1984.967 mgc: 0.009244185 ustep: 1 
iter: 2  value: 1984.967 mgc: 1.885848e-07 ustep: 1 
iter: 3  mgc: 3.03646e-14 
iter: 1  mgc: 3.03646e-14 
outer mgc:  0.01989058 
iter: 1  value: 1984.965 mgc: 0.003590355 ustep: 1 
iter: 2  value: 1984.965 mgc: 1.543677e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  0.01700474 
iter: 1  value: 1984.965 mgc: 0.003981768 ustep: 1 
iter: 2  value: 1984.965 mgc: 8.990638e-08 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.008825335 
iter: 1  value: 1984.965 mgc: 0.001968674 ustep: 1 
iter: 2  value: 1984.965 mgc: 1.030032e-08 ustep: 1 
mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  0.003306936 
iter: 1  value: 1984.965 mgc: 0.0003273975 ustep: 1 
iter: 2  mgc: 4.049197e-10 
iter: 1  mgc: 4.049197e-10 
outer mgc:  0.0003865827 
iter: 1  mgc: 4.049197e-10 
iter: 1  mgc: 4.049197e-10 
outer mgc:  0.0003865827 
iter: 1  value: 1984.964 mgc: 0.05643949 ustep: 1 
iter: 2  value: 1984.964 mgc: 9.259045e-06 ustep: 1 
iter: 3  mgc: 5.901946e-13 
outer mgc:  0.3171291 
iter: 1  value: 1984.966 mgc: 0.05643628 ustep: 1 
iter: 2  value: 1984.966 mgc: 9.267679e-06 ustep: 1 
iter: 3  mgc: 5.973e-13 
outer mgc:  0.3173367 
iter: 1  value: 1984.964 mgc: 0.02703459 ustep: 1 
iter: 2  value: 1984.964 mgc: 2.275298e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.9467789 
iter: 1  value: 1984.967 mgc: 0.02702798 ustep: 1 
iter: 2  value: 1984.967 mgc: 2.274991e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.9474425 
iter: 1  value: 1984.967 mgc: 0.05721383 ustep: 1 
iter: 2  value: 1984.967 mgc: 8.504951e-06 ustep: 1 
iter: 3  mgc: 4.565237e-13 
outer mgc:  0.3830129 
iter: 1  value: 1984.964 mgc: 0.05720681 ustep: 1 
iter: 2  value: 1984.964 mgc: 8.516593e-06 ustep: 1 
iter: 3  mgc: 4.47864e-13 
outer mgc:  0.3830809 
iter: 1  value: 1984.965 mgc: 0.02845703 ustep: 1 
iter: 2  value: 1984.965 mgc: 2.421379e-06 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  1.200062 
iter: 1  value: 1984.966 mgc: 0.02845813 ustep: 1 
iter: 2  value: 1984.966 mgc: 2.422177e-06 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  1.200312 
iter: 1  value: 1984.959 mgc: 0.005528843 ustep: 1 
iter: 2  value: 1984.959 mgc: 4.724203e-07 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.04859202 
iter: 1  value: 1984.972 mgc: 0.005524827 ustep: 1 
iter: 2  value: 1984.972 mgc: 4.720267e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.04849474 
iter: 1  value: 1984.975 mgc: 0.01121292 ustep: 1 
iter: 2  value: 1984.975 mgc: 2.824299e-06 ustep: 1 
iter: 3  mgc: 1.79412e-13 
outer mgc:  0.2797898 
iter: 1  value: 1984.955 mgc: 0.01123688 ustep: 1 
iter: 2  value: 1984.955 mgc: 2.83199e-06 ustep: 1 
iter: 3  mgc: 1.803002e-13 
outer mgc:  0.2802905 
iter: 1  value: 1984.974 mgc: 0.01057905 ustep: 1 
iter: 2  value: 1984.974 mgc: 1.039754e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.2921578 
iter: 1  value: 1984.957 mgc: 0.0106042 ustep: 1 
iter: 2  value: 1984.957 mgc: 1.043737e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.2925773 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:17:29 2021]
Finished job 0.
1 of 1 steps (100%) done

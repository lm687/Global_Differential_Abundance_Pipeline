Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:27:35 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10931.192272 
final  value 9453.230487 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 9852.072 mgc: 1.997457 ustep: 1 
iter: 2  value: 9851.835 mgc: 0.2853087 ustep: 1 
iter: 3  value: 9851.835 mgc: 0.01866992 ustep: 1 
iter: 4  value: 9851.835 mgc: 2.945556e-05 ustep: 1 
iter: 5  mgc: 4.721244e-10 
iter: 1  mgc: 4.721244e-10 
Matching hessian patterns... Done
outer mgc:  47.58754 
iter: 1  value: 9756.287 mgc: 0.9224216 ustep: 1 
iter: 2  value: 9756.283 mgc: 0.03071423 ustep: 1 
iter: 3  value: 9756.283 mgc: 0.0001694116 ustep: 1 
iter: 4  mgc: 2.509094e-09 
iter: 1  value: 9789.868 mgc: 11.10856 ustep: 1 
iter: 2  value: 9784.749 mgc: 2.714174 ustep: 1 
iter: 3  value: 9784.745 mgc: 0.1951832 ustep: 1 
iter: 4  value: 9784.745 mgc: 0.0004469174 ustep: 1 
iter: 5  mgc: 2.056803e-09 
iter: 1  mgc: 2.509094e-09 
outer mgc:  49.68311 
iter: 1  value: 9674.344 mgc: 1.911925 ustep: 1 
iter: 2  value: 9674.218 mgc: 0.2039064 ustep: 1 
iter: 3  value: 9674.218 mgc: 0.00238813 ustep: 1 
iter: 4  value: 9674.218 mgc: 6.603384e-07 ustep: 1 
iter: 5  mgc: 2.997602e-14 
iter: 1  value: 9554.542 mgc: 81.18083 ustep: 1 
iter: 2  value: 9546.875 mgc: 2.058351 ustep: 1 
iter: 3  value: 9546.873 mgc: 0.2540997 ustep: 1 
iter: 4  value: 9546.873 mgc: 7.447591e-05 ustep: 1 
iter: 5  mgc: 7.094658e-11 
iter: 1  mgc: 7.094658e-11 
outer mgc:  124.2376 
iter: 1  value: 10338.04 mgc: 90.70685 ustep: 1 
iter: 2  value: 10298.06 mgc: 6.305027 ustep: 1 
iter: 3  value: 10297.94 mgc: 0.3935512 ustep: 1 
iter: 4  value: 10297.94 mgc: 0.002762135 ustep: 1 
iter: 5  value: 10297.94 mgc: 1.38992e-07 ustep: 1 
iter: 6  mgc: 1.021405e-13 
iter: 1  value: 9489.426 mgc: 6.470102 ustep: 1 
iter: 2  value: 9488.401 mgc: 1.015768 ustep: 1 
iter: 3  value: 9488.401 mgc: 0.0182231 ustep: 1 
iter: 4  value: 9488.401 mgc: 1.095885e-05 ustep: 1 
iter: 5  mgc: 3.856748e-12 
iter: 1  mgc: 3.856748e-12 
outer mgc:  105.647 
iter: 1  value: 9462.004 mgc: 7.914458 ustep: 1 
iter: 2  value: 9461.978 mgc: 0.3042933 ustep: 1 
iter: 3  value: 9461.978 mgc: 0.001339725 ustep: 1 
iter: 4  mgc: 2.068927e-09 
iter: 1  mgc: 2.068927e-09 
outer mgc:  82.51072 
iter: 1  value: 9416.434 mgc: 7.819492 ustep: 1 
iter: 2  value: 9414.632 mgc: 1.310468 ustep: 1 
iter: 3  value: 9414.632 mgc: 0.01872971 ustep: 1 
iter: 4  value: 9414.632 mgc: 9.575609e-06 ustep: 1 
iter: 5  mgc: 2.350009e-12 
iter: 1  mgc: 2.350009e-12 
outer mgc:  72.15292 
iter: 1  value: 9371.405 mgc: 5.931818 ustep: 1 
iter: 2  value: 9371.405 mgc: 0.0453037 ustep: 1 
iter: 3  value: 9371.405 mgc: 3.751628e-06 ustep: 1 
iter: 4  mgc: 1.985079e-13 
iter: 1  mgc: 1.985079e-13 
outer mgc:  51.41583 
iter: 1  value: 9373.33 mgc: 5.160204 ustep: 1 
iter: 2  value: 9373.33 mgc: 0.01318592 ustep: 1 
iter: 3  value: 9373.33 mgc: 1.267139e-06 ustep: 1 
iter: 4  mgc: 4.72955e-14 
iter: 1  value: 9361.81 mgc: 4.74418 ustep: 1 
iter: 2  value: 9361.81 mgc: 0.04616897 ustep: 1 
iter: 3  value: 9361.81 mgc: 2.042357e-05 ustep: 1 
iter: 4  mgc: 5.778267e-12 
iter: 1  mgc: 5.778267e-12 
outer mgc:  64.83182 
iter: 1  value: 9357.608 mgc: 5.217754 ustep: 1 
iter: 2  value: 9357.604 mgc: 0.1645934 ustep: 1 
iter: 3  value: 9357.604 mgc: 4.254976e-05 ustep: 1 
iter: 4  mgc: 2.892397e-11 
iter: 1  mgc: 2.892397e-11 
outer mgc:  40.58216 
iter: 1  value: 9347.134 mgc: 8.022879 ustep: 1 
iter: 2  value: 9347.133 mgc: 0.05834693 ustep: 1 
iter: 3  value: 9347.133 mgc: 2.545436e-05 ustep: 1 
iter: 4  mgc: 1.049516e-11 
iter: 1  mgc: 1.049516e-11 
outer mgc:  30.49642 
iter: 1  value: 9345.772 mgc: 15.03697 ustep: 1 
iter: 2  value: 9345.772 mgc: 0.03183743 ustep: 1 
iter: 3  value: 9345.772 mgc: 7.302535e-06 ustep: 1 
iter: 4  mgc: 6.790124e-13 
iter: 1  mgc: 6.790124e-13 
outer mgc:  84.31179 
iter: 1  value: 9363.746 mgc: 5.605972 ustep: 1 
iter: 2  value: 9363.746 mgc: 0.04286157 ustep: 1 
iter: 3  value: 9363.746 mgc: 2.884497e-06 ustep: 1 
iter: 4  mgc: 1.261213e-13 
iter: 1  value: 9342.299 mgc: 4.343251 ustep: 1 
iter: 2  value: 9342.299 mgc: 0.01062149 ustep: 1 
iter: 3  value: 9342.299 mgc: 4.259747e-07 ustep: 1 
iter: 4  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  69.78471 
iter: 1  value: 9334.36 mgc: 2.391244 ustep: 1 
iter: 2  value: 9334.36 mgc: 0.005378578 ustep: 1 
iter: 3  value: 9334.36 mgc: 2.861624e-07 ustep: 1 
iter: 4  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  16.84393 
iter: 1  value: 9328.766 mgc: 2.342875 ustep: 1 
iter: 2  value: 9328.766 mgc: 0.001440547 ustep: 1 
iter: 3  mgc: 8.513631e-09 
iter: 1  mgc: 8.513631e-09 
outer mgc:  55.24593 
iter: 1  value: 9320.11 mgc: 2.330378 ustep: 1 
iter: 2  value: 9320.11 mgc: 0.001550567 ustep: 1 
iter: 3  value: 9320.11 mgc: 1.471466e-08 ustep: 1 
mgc: 8.65974e-14 
iter: 1  mgc: 8.65974e-14 
outer mgc:  13.92995 
iter: 1  value: 9309.282 mgc: 5.588631 ustep: 1 
iter: 2  value: 9309.282 mgc: 0.01409062 ustep: 1 
iter: 3  value: 9309.282 mgc: 9.252802e-07 ustep: 1 
iter: 4  mgc: 6.750156e-14 
iter: 1  mgc: 6.750156e-14 
outer mgc:  13.70663 
iter: 1  value: 9303.964 mgc: 6.929654 ustep: 1 
iter: 2  value: 9303.964 mgc: 0.01080439 ustep: 1 
iter: 3  value: 9303.964 mgc: 9.868536e-07 ustep: 1 
iter: 4  mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  33.52932 
iter: 1  value: 9299.246 mgc: 3.656778 ustep: 1 
iter: 2  value: 9299.246 mgc: 0.003156993 ustep: 1 
iter: 3  value: 9299.246 mgc: 5.226449e-08 ustep: 1 
mgc: 6.128431e-14 
iter: 1  value: 9303.204 mgc: 2.464561 ustep: 1 
iter: 2  value: 9303.204 mgc: 0.0004419888 ustep: 1 
iter: 3  mgc: 4.751113e-10 
iter: 1  value: 9303.111 mgc: 1.097503 ustep: 1 
iter: 2  value: 9303.111 mgc: 8.014094e-05 ustep: 1 
iter: 3  mgc: 4.004708e-11 
iter: 1  mgc: 4.004708e-11 
outer mgc:  24.99488 
iter: 1  value: 9301.6 mgc: 0.9870814 ustep: 1 
iter: 2  value: 9301.6 mgc: 0.0001386019 ustep: 1 
iter: 3  mgc: 2.770767e-11 
iter: 1  mgc: 2.770767e-11 
outer mgc:  17.64273 
iter: 1  value: 9297.761 mgc: 1.383894 ustep: 1 
iter: 2  value: 9297.761 mgc: 0.001656775 ustep: 1 
iter: 3  value: 9297.761 mgc: 1.279409e-08 ustep: 1 
mgc: 8.348877e-14 
iter: 1  mgc: 8.348877e-14 
outer mgc:  12.02462 
iter: 1  value: 9293.733 mgc: 2.102921 ustep: 1 
iter: 2  value: 9293.733 mgc: 0.001255521 ustep: 1 
iter: 3  mgc: 3.146646e-09 
iter: 1  mgc: 3.146646e-09 
outer mgc:  7.386294 
iter: 1  value: 9290.369 mgc: 1.10432 ustep: 1 
iter: 2  value: 9290.369 mgc: 0.0004746028 ustep: 1 
iter: 3  mgc: 1.216693e-09 
iter: 1  value: 9286.377 mgc: 1.52591 ustep: 1 
iter: 2  value: 9286.377 mgc: 0.0006894553 ustep: 1 
iter: 3  mgc: 2.041872e-09 
iter: 1  mgc: 2.041872e-09 
outer mgc:  9.133095 
iter: 1  value: 9277.391 mgc: 3.445609 ustep: 1 
iter: 2  value: 9277.391 mgc: 0.004386296 ustep: 1 
iter: 3  value: 9277.391 mgc: 9.00198e-08 ustep: 1 
mgc: 6.972201e-14 
iter: 1  mgc: 6.972201e-14 
outer mgc:  9.563365 
iter: 1  value: 9260.573 mgc: 4.680166 ustep: 1 
iter: 2  value: 9260.573 mgc: 0.005441611 ustep: 1 
iter: 3  value: 9260.573 mgc: 5.120327e-08 ustep: 1 
mgc: 1.012523e-13 
iter: 1  mgc: 1.012523e-13 
outer mgc:  4.469218 
iter: 1  value: 9245.13 mgc: 10.63297 ustep: 1 
iter: 2  value: 9245.13 mgc: 0.007375016 ustep: 1 
iter: 3  value: 9245.13 mgc: 1.08586e-07 ustep: 1 
mgc: 5.151435e-14 
iter: 1  value: 9254.116 mgc: 3.63469 ustep: 1 
iter: 2  value: 9254.116 mgc: 0.00150677 ustep: 1 
iter: 3  mgc: 6.057097e-09 
iter: 1  mgc: 6.057097e-09 
outer mgc:  10.59815 
iter: 1  value: 9246.039 mgc: 1.912394 ustep: 1 
iter: 2  value: 9246.039 mgc: 0.001426702 ustep: 1 
iter: 3  mgc: 3.014979e-09 
iter: 1  mgc: 3.014979e-09 
outer mgc:  2.56772 
iter: 1  value: 9238.643 mgc: 2.570956 ustep: 1 
iter: 2  value: 9238.643 mgc: 0.0005218798 ustep: 1 
iter: 3  mgc: 4.235217e-10 
iter: 1  mgc: 4.235217e-10 
outer mgc:  2.73534 
iter: 1  value: 9230.632 mgc: 2.097017 ustep: 1 
iter: 2  value: 9230.632 mgc: 0.0008124307 ustep: 1 
iter: 3  mgc: 6.009113e-10 
iter: 1  value: 9206.694 mgc: 7.180165 ustep: 1 
iter: 2  value: 9206.694 mgc: 0.004176101 ustep: 1 
iter: 3  mgc: 6.608338e-09 
iter: 1  mgc: 6.608338e-09 
outer mgc:  3.432861 
iter: 1  value: 9187.729 mgc: 20.05104 ustep: 1 
iter: 2  value: 9187.729 mgc: 0.0008513929 ustep: 1 
iter: 3  mgc: 2.13479e-10 
iter: 1  mgc: 2.13479e-10 
outer mgc:  3.798445 
iter: 1  value: 9166.716 mgc: 6.267833 ustep: 1 
iter: 2  value: 9166.716 mgc: 0.0008147454 ustep: 1 
iter: 3  mgc: 4.156853e-11 
iter: 1  mgc: 4.156853e-11 
outer mgc:  2.165901 
iter: 1  value: 9145.666 mgc: 5.608214 ustep: 1 
iter: 2  value: 9145.666 mgc: 0.0003630877 ustep: 1 
iter: 3  mgc: 4.404477e-12 
iter: 1  mgc: 4.404477e-12 
outer mgc:  0.6982214 
iter: 1  value: 9124.6 mgc: 6.116287 ustep: 1 
iter: 2  value: 9124.6 mgc: 0.0001615754 ustep: 1 
iter: 3  mgc: 4.050094e-13 
iter: 1  mgc: 4.050094e-13 
outer mgc:  0.4661677 
iter: 1  value: 9091.54 mgc: 12.47171 ustep: 1 
iter: 2  value: 9091.54 mgc: 0.0001496598 ustep: 1 
iter: 3  mgc: 1.083578e-13 
iter: 1  mgc: 1.083578e-13 
outer mgc:  0.305706 
iter: 1  value: 9060.165 mgc: 12.42291 ustep: 1 
iter: 2  value: 9060.165 mgc: 4.159631e-05 ustep: 1 
iter: 3  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  0.1599657 
iter: 1  value: 9028.822 mgc: 12.27978 ustep: 1 
iter: 2  value: 9028.822 mgc: 1.347264e-05 ustep: 1 
mgc: 6.683543e-14 
iter: 1  mgc: 6.683543e-14 
outer mgc:  0.0315663 
iter: 1  value: 8997.548 mgc: 12.47077 ustep: 1 
iter: 2  value: 8997.548 mgc: 4.301445e-06 ustep: 1 
mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.06386753 
iter: 1  value: 8966.324 mgc: 12.22767 ustep: 1 
iter: 2  value: 8966.324 mgc: 1.38554e-06 ustep: 1 
mgc: 9.25926e-14 
iter: 1  mgc: 9.25926e-14 
outer mgc:  0.0582411 
iter: 1  value: 8935.186 mgc: 12.74307 ustep: 1 
iter: 2  value: 8935.186 mgc: 4.38039e-07 ustep: 1 
mgc: 7.871481e-14 
iter: 1  mgc: 7.871481e-14 
outer mgc:  0.02770818 
iter: 1  value: 8904.102 mgc: 12.65724 ustep: 1 
iter: 2  value: 8904.102 mgc: 1.405748e-07 ustep: 1 
mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  0.01823926 
iter: 1  value: 8873.098 mgc: 13.84731 ustep: 1 
iter: 2  value: 8873.098 mgc: 4.448817e-08 ustep: 1 
mgc: 7.371881e-14 
iter: 1  mgc: 7.371881e-14 
outer mgc:  0.01883828 
iter: 1  value: 8842.151 mgc: 14.4444 ustep: 1 
iter: 2  value: 8842.151 mgc: 1.42266e-08 ustep: 1 
mgc: 9.769963e-14 
iter: 1  mgc: 9.769963e-14 
outer mgc:  0.006331455 
iter: 1  value: 8803.3 mgc: 22.80078 ustep: 1 
iter: 2  mgc: 6.282065e-09 
iter: 1  mgc: 6.282065e-09 
outer mgc:  0.003907819 
iter: 1  value: 8767.217 mgc: 21.70694 ustep: 1 
iter: 2  mgc: 1.351078e-09 
iter: 1  mgc: 1.351078e-09 
outer mgc:  0.00258689 
iter: 1  value: 8731.207 mgc: 23.43023 ustep: 1 
iter: 2  mgc: 3.541043e-10 
iter: 1  mgc: 3.541043e-10 
outer mgc:  0.001312284 
iter: 1  value: 8695.263 mgc: 25.17209 ustep: 1 
iter: 2  mgc: 9.314238e-11 
iter: 1  mgc: 9.314238e-11 
outer mgc:  0.0005519271 
iter: 1  value: 8659.381 mgc: 27.08283 ustep: 1 
iter: 2  mgc: 2.451195e-11 
iter: 1  mgc: 2.451195e-11 
outer mgc:  0.0002912268 
iter: 1  value: 8623.558 mgc: 29.08758 ustep: 1 
iter: 2  mgc: 6.592948e-12 
iter: 1  mgc: 6.592948e-12 
outer mgc:  0.0002355904 
iter: 1  value: 8587.789 mgc: 31.22052 ustep: 1 
iter: 2  mgc: 1.687539e-12 
iter: 1  mgc: 1.687539e-12 
outer mgc:  0.0001161978 
iter: 1  value: 8552.072 mgc: 33.47274 ustep: 1 
iter: 2  mgc: 6.377121e-13 
iter: 1  mgc: 6.377121e-13 
outer mgc:  5.784598e-05 
iter: 1  mgc: 6.377121e-13 
iter: 1  mgc: 6.377121e-13 
outer mgc:  5.784598e-05 
iter: 1  value: 8552.073 mgc: 0.02666233 ustep: 1 
mgc: 1.083578e-13 
outer mgc:  1.230999 
iter: 1  value: 8552.073 mgc: 0.02666742 ustep: 1 
mgc: 1.163514e-13 
outer mgc:  1.231209 
iter: 1  value: 8552.072 mgc: 0.0136389 ustep: 1 
mgc: 2.229328e-13 
outer mgc:  0.621342 
iter: 1  value: 8552.072 mgc: 0.01364177 ustep: 1 
mgc: 2.113865e-13 
outer mgc:  0.6214648 
iter: 1  value: 8552.073 mgc: 0.02338434 ustep: 1 
mgc: 1.0969e-13 
outer mgc:  1.061139 
iter: 1  value: 8552.073 mgc: 0.02337423 ustep: 1 
mgc: 1.652012e-13 
outer mgc:  1.060648 
iter: 1  value: 8552.072 mgc: 0.01331809 ustep: 1 
mgc: 9.592327e-14 
outer mgc:  0.600594 
iter: 1  value: 8552.072 mgc: 0.01331398 ustep: 1 
mgc: 1.110223e-13 
outer mgc:  0.6004405 
iter: 1  value: 8552.122 mgc: 0.6089817 ustep: 1 
mgc: 1.580958e-13 
outer mgc:  5.784527e-05 
iter: 1  value: 8552.022 mgc: 0.6108023 ustep: 1 
mgc: 1.714184e-13 
outer mgc:  5.784669e-05 
iter: 1  value: 8552.122 mgc: 0.6005388 ustep: 1 
mgc: 1.065814e-13 
outer mgc:  5.785227e-05 
iter: 1  value: 8552.022 mgc: 0.6011396 ustep: 1 
mgc: 1.429967e-13 
outer mgc:  5.78397e-05 
iter: 1  value: 8552.065 mgc: 0.003553982 ustep: 1 
mgc: 1.039169e-13 
outer mgc:  5.784596e-05 
iter: 1  value: 8552.079 mgc: 0.003553457 ustep: 1 
mgc: 9.414691e-14 
outer mgc:  5.784599e-05 
iter: 1  value: 8552.072 mgc: 0.004751359 ustep: 1 
mgc: 1.29452e-13 
outer mgc:  0.0252919 
iter: 1  value: 8552.072 mgc: 0.004751524 ustep: 1 
mgc: 1.119105e-13 
outer mgc:  0.02532965 
[Fri Aug 13 11:27:38 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:05:31 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4408.731114 
iter  10 value 2990.327422
final  value 2990.305317 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1393.848 mgc: 82.8813 ustep: 1 
iter: 2  value: 1243.472 mgc: 42.05399 ustep: 1 
iter: 3  value: 1229.058 mgc: 6.598263 ustep: 1 
iter: 4  value: 1226.751 mgc: 1.918323 ustep: 1 
iter: 5  value: 1226.535 mgc: 0.4886635 ustep: 1 
iter: 6  value: 1226.531 mgc: 0.0624944 ustep: 1 
iter: 7  value: 1226.531 mgc: 0.001421948 ustep: 1 
iter: 8  value: 1226.531 mgc: 7.788797e-07 ustep: 1 
iter: 9  mgc: 2.331468e-13 
iter: 1  mgc: 2.331468e-13 
Matching hessian patterns... Done
outer mgc:  170.6833 
iter: 1  value: 1012.463 mgc: 13.7204 ustep: 1 
iter: 2  value: 1010.038 mgc: 2.492919 ustep: 1 
iter: 3  value: 1010.033 mgc: 0.1063655 ustep: 1 
iter: 4  value: 1010.033 mgc: 0.000458059 ustep: 1 
iter: 5  value: 1010.033 mgc: 2.334549e-08 ustep: 1 
mgc: 4.574119e-14 
iter: 1  value: 701.308 mgc: 25.35118 ustep: 0.8994163 
iter: 2  value: 558.5933 mgc: 24.26619 ustep: 0.9483808 
iter: 3  value: 551.1034 mgc: 4.11446 ustep: 0.973851 
iter: 4  value: 550.9909 mgc: 0.509685 ustep: 0.9868402 
iter: 5  value: 550.9908 mgc: 0.01927266 ustep: 0.993399 
iter: 6  value: 550.9908 mgc: 0.0001071518 ustep: 0.9966944 
iter: 7  value: 550.9908 mgc: 1.329739e-07 ustep: 0.998346 
iter: 8  mgc: 8.28082e-11 
iter: 1  mgc: 8.28082e-11 
outer mgc:  108.1193 
iter: 1  value: 677.0154 mgc: 51.43008 ustep: 1 
iter: 2  value: 671.207 mgc: 11.30995 ustep: 1 
iter: 3  value: 671.2038 mgc: 0.2190767 ustep: 1 
iter: 4  value: 671.2038 mgc: 0.0003633777 ustep: 1 
iter: 5  value: 671.2038 mgc: 1.443894e-08 ustep: 1 
mgc: 3.98015e-14 
iter: 1  value: 449.2288 mgc: 19.52706 ustep: 1 
iter: 2  value: 449.0792 mgc: 1.491793 ustep: 1 
iter: 3  value: 449.0791 mgc: 0.007169878 ustep: 1 
iter: 4  value: 449.0791 mgc: 6.568303e-06 ustep: 1 
iter: 5  mgc: 6.561862e-12 
iter: 1  mgc: 6.561862e-12 
outer mgc:  127.1574 
iter: 1  value: 476.9512 mgc: 29.54909 ustep: 1 
iter: 2  value: 476.7912 mgc: 1.193665 ustep: 1 
iter: 3  value: 476.7912 mgc: 0.007196722 ustep: 1 
iter: 4  value: 476.7912 mgc: 5.333928e-07 ustep: 1 
iter: 5  mgc: 4.385381e-14 
iter: 1  value: 414.4502 mgc: 16.91977 ustep: 1 
iter: 2  value: 414.4218 mgc: 0.4089616 ustep: 1 
iter: 3  value: 414.4218 mgc: 0.001331188 ustep: 1 
iter: 4  value: 414.4218 mgc: 1.754401e-08 ustep: 1 
mgc: 3.008704e-14 
iter: 1  mgc: 3.008704e-14 
outer mgc:  74.17757 
iter: 1  value: 387.6479 mgc: 15.35479 ustep: 1 
iter: 2  value: 387.6229 mgc: 0.640003 ustep: 1 
iter: 3  value: 387.6229 mgc: 0.002283596 ustep: 1 
iter: 4  value: 387.6229 mgc: 3.082247e-08 ustep: 1 
iter: 5  mgc: 6.872281e-14 
iter: 1  mgc: 6.872281e-14 
outer mgc:  69.10108 
iter: 1  value: 361.9891 mgc: 13.65878 ustep: 1 
iter: 2  value: 361.5755 mgc: 0.5590798 ustep: 1 
iter: 3  value: 361.5714 mgc: 0.06211935 ustep: 1 
iter: 4  value: 361.5714 mgc: 0.001201923 ustep: 1 
iter: 5  value: 361.5714 mgc: 4.709177e-07 ustep: 1 
iter: 6  mgc: 7.827072e-14 
iter: 1  mgc: 7.827072e-14 
outer mgc:  61.92497 
iter: 1  value: 427.2996 mgc: 41.65463 ustep: 1 
iter: 2  value: 409.4701 mgc: 13.65845 ustep: 1 
iter: 3  value: 409.0007 mgc: 1.663404 ustep: 1 
iter: 4  value: 408.9999 mgc: 0.08637733 ustep: 1 
iter: 5  value: 408.9999 mgc: 0.0001779524 ustep: 1 
iter: 6  mgc: 9.070309e-10 
iter: 1  value: 344.6563 mgc: 16.87121 ustep: 1 
iter: 2  value: 344.5825 mgc: 0.8238106 ustep: 1 
iter: 3  value: 344.5825 mgc: 0.004020864 ustep: 1 
iter: 4  value: 344.5825 mgc: 2.052867e-07 ustep: 1 
iter: 5  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  29.49218 
iter: 1  value: 339.0928 mgc: 3.932914 ustep: 1 
iter: 2  value: 339.0677 mgc: 0.2714867 ustep: 1 
iter: 3  value: 339.0677 mgc: 0.001999132 ustep: 1 
iter: 4  value: 339.0677 mgc: 1.152241e-07 ustep: 1 
iter: 5  mgc: 2.364775e-14 
iter: 1  mgc: 2.364775e-14 
outer mgc:  29.77287 
iter: 1  value: 338.5738 mgc: 10.21202 ustep: 1 
iter: 2  value: 338.5558 mgc: 0.3568752 ustep: 1 
iter: 3  value: 338.5558 mgc: 0.0008999383 ustep: 1 
iter: 4  value: 338.5558 mgc: 8.487858e-08 ustep: 1 
iter: 5  mgc: 4.046763e-14 
iter: 1  mgc: 4.046763e-14 
outer mgc:  34.19367 
iter: 1  value: 334.0756 mgc: 3.335547 ustep: 1 
iter: 2  value: 334.0756 mgc: 0.02038219 ustep: 1 
iter: 3  value: 334.0756 mgc: 2.06265e-06 ustep: 1 
iter: 4  mgc: 7.993606e-14 
iter: 1  mgc: 7.993606e-14 
outer mgc:  17.13914 
iter: 1  value: 334.1162 mgc: 13.57197 ustep: 1 
iter: 2  value: 334.0685 mgc: 0.6480178 ustep: 1 
iter: 3  value: 334.0684 mgc: 0.007802909 ustep: 1 
iter: 4  value: 334.0684 mgc: 1.413515e-05 ustep: 1 
iter: 5  mgc: 4.561329e-11 
iter: 1  value: 332.4171 mgc: 6.327148 ustep: 1 
iter: 2  value: 332.4155 mgc: 0.1591187 ustep: 1 
iter: 3  value: 332.4155 mgc: 0.0001415185 ustep: 1 
iter: 4  mgc: 4.866425e-10 
iter: 1  mgc: 4.866425e-10 
outer mgc:  24.10536 
iter: 1  value: 329.7038 mgc: 4.182125 ustep: 1 
iter: 2  value: 329.7034 mgc: 0.04014793 ustep: 1 
iter: 3  value: 329.7034 mgc: 2.201077e-05 ustep: 1 
iter: 4  mgc: 2.010047e-10 
iter: 1  mgc: 2.010047e-10 
outer mgc:  13.37232 
iter: 1  value: 327.7596 mgc: 4.073037 ustep: 1 
iter: 2  value: 327.7586 mgc: 0.07101067 ustep: 1 
iter: 3  value: 327.7586 mgc: 2.796443e-05 ustep: 1 
iter: 4  mgc: 1.437647e-10 
iter: 1  mgc: 1.437647e-10 
outer mgc:  16.90712 
iter: 1  value: 324.5958 mgc: 6.877456 ustep: 1 
iter: 2  value: 324.5291 mgc: 0.3504463 ustep: 1 
iter: 3  value: 324.5291 mgc: 0.002415966 ustep: 1 
iter: 4  value: 324.5291 mgc: 3.612984e-07 ustep: 1 
iter: 5  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  8.234575 
iter: 1  value: 323.3881 mgc: 16.229 ustep: 1 
iter: 2  value: 323.3087 mgc: 0.6870459 ustep: 1 
iter: 3  value: 323.3086 mgc: 0.003056973 ustep: 1 
iter: 4  value: 323.3086 mgc: 3.37154e-07 ustep: 1 
iter: 5  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  11.42753 
iter: 1  value: 321.3091 mgc: 11.07943 ustep: 1 
iter: 2  value: 321.2903 mgc: 0.3831845 ustep: 1 
iter: 3  value: 321.2903 mgc: 0.001239751 ustep: 1 
iter: 4  value: 321.2903 mgc: 1.322847e-08 ustep: 1 
mgc: 3.874678e-14 
iter: 1  mgc: 3.874678e-14 
outer mgc:  5.543417 
iter: 1  value: 321.3744 mgc: 6.161222 ustep: 1 
iter: 2  value: 321.3321 mgc: 0.3395632 ustep: 1 
iter: 3  value: 321.332 mgc: 0.01448896 ustep: 1 
iter: 4  value: 321.332 mgc: 3.059689e-05 ustep: 1 
iter: 5  mgc: 1.366187e-10 
iter: 1  value: 320.4339 mgc: 2.170124 ustep: 1 
iter: 2  value: 320.4337 mgc: 0.02326885 ustep: 1 
iter: 3  value: 320.4337 mgc: 8.439848e-05 ustep: 1 
iter: 4  mgc: 1.60548e-09 
iter: 1  mgc: 1.60548e-09 
outer mgc:  5.619953 
iter: 1  value: 319.8488 mgc: 2.273426 ustep: 1 
iter: 2  value: 319.8488 mgc: 0.0175434 ustep: 1 
iter: 3  value: 319.8488 mgc: 1.189903e-05 ustep: 1 
iter: 4  mgc: 1.406564e-11 
iter: 1  mgc: 1.406564e-11 
outer mgc:  3.285792 
iter: 1  value: 319.4681 mgc: 2.347326 ustep: 1 
iter: 2  value: 319.468 mgc: 0.02732261 ustep: 1 
iter: 3  value: 319.468 mgc: 3.726122e-06 ustep: 1 
iter: 4  mgc: 1.775913e-12 
iter: 1  mgc: 1.775913e-12 
outer mgc:  5.363299 
iter: 1  value: 319.682 mgc: 0.9608106 ustep: 1 
iter: 2  value: 319.682 mgc: 0.007340398 ustep: 1 
iter: 3  value: 319.682 mgc: 1.197504e-06 ustep: 1 
iter: 4  mgc: 6.217249e-14 
iter: 1  value: 319.5833 mgc: 1.874976 ustep: 1 
iter: 2  value: 319.5833 mgc: 0.01240737 ustep: 1 
iter: 3  value: 319.5833 mgc: 7.854443e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  value: 319.4221 mgc: 0.8439996 ustep: 1 
iter: 2  value: 319.4221 mgc: 0.002459485 ustep: 1 
iter: 3  value: 319.4221 mgc: 3.092388e-08 ustep: 1 
mgc: 2.68674e-14 
iter: 1  mgc: 2.68674e-14 
outer mgc:  2.723805 
iter: 1  value: 319.3214 mgc: 0.5533486 ustep: 1 
iter: 2  value: 319.3214 mgc: 0.001304578 ustep: 1 
iter: 3  mgc: 9.398627e-09 
iter: 1  mgc: 9.398627e-09 
outer mgc:  3.110207 
iter: 1  value: 319.2382 mgc: 0.2442731 ustep: 1 
iter: 2  value: 319.2382 mgc: 0.0003685717 ustep: 1 
iter: 3  mgc: 2.847587e-09 
iter: 1  value: 319.1588 mgc: 1.341847 ustep: 1 
iter: 2  value: 319.1588 mgc: 0.006480354 ustep: 1 
iter: 3  value: 319.1588 mgc: 2.456357e-07 ustep: 1 
iter: 4  mgc: 3.597123e-14 
iter: 1  value: 319.1246 mgc: 1.83035 ustep: 1 
iter: 2  value: 319.1246 mgc: 0.01177047 ustep: 1 
iter: 3  value: 319.1246 mgc: 1.054088e-06 ustep: 1 
iter: 4  mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  3.466032 
iter: 1  value: 318.995 mgc: 4.89142 ustep: 1 
iter: 2  value: 318.9941 mgc: 0.1009259 ustep: 1 
iter: 3  value: 318.9941 mgc: 8.640532e-05 ustep: 1 
iter: 4  mgc: 6.401213e-11 
iter: 1  mgc: 6.401213e-11 
outer mgc:  2.573075 
iter: 1  value: 318.9221 mgc: 2.85912 ustep: 1 
iter: 2  value: 318.9218 mgc: 0.03545559 ustep: 1 
iter: 3  value: 318.9218 mgc: 1.52609e-05 ustep: 1 
iter: 4  mgc: 8.060885e-12 
iter: 1  mgc: 8.060885e-12 
outer mgc:  1.463773 
iter: 1  value: 318.8793 mgc: 1.678644 ustep: 1 
iter: 2  value: 318.8787 mgc: 0.03375071 ustep: 1 
iter: 3  value: 318.8787 mgc: 2.438174e-05 ustep: 1 
iter: 4  mgc: 5.149747e-11 
iter: 1  mgc: 5.149747e-11 
outer mgc:  1.072409 
iter: 1  value: 318.9572 mgc: 1.259019 ustep: 1 
iter: 2  value: 318.9572 mgc: 0.009656827 ustep: 1 
iter: 3  value: 318.9572 mgc: 1.258002e-06 ustep: 1 
iter: 4  mgc: 6.972201e-14 
iter: 1  mgc: 6.972201e-14 
outer mgc:  0.8473687 
iter: 1  value: 318.8395 mgc: 0.5135891 ustep: 1 
iter: 2  value: 318.8395 mgc: 0.003837349 ustep: 1 
iter: 3  value: 318.8395 mgc: 3.180212e-06 ustep: 1 
iter: 4  mgc: 2.176037e-12 
iter: 1  value: 318.8986 mgc: 0.1952859 ustep: 1 
iter: 2  value: 318.8986 mgc: 0.000717055 ustep: 1 
iter: 3  value: 318.8986 mgc: 1.171553e-07 ustep: 1 
iter: 4  mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  0.2761694 
iter: 1  value: 318.8746 mgc: 0.3412021 ustep: 1 
iter: 2  value: 318.8746 mgc: 0.0008941325 ustep: 1 
iter: 3  value: 318.8746 mgc: 1.870964e-08 ustep: 1 
mgc: 4.107825e-14 
iter: 1  mgc: 4.107825e-14 
outer mgc:  0.103384 
iter: 1  value: 318.8782 mgc: 0.1288629 ustep: 1 
iter: 2  value: 318.8782 mgc: 5.897355e-05 ustep: 1 
iter: 3  mgc: 3.717204e-11 
iter: 1  mgc: 3.717204e-11 
outer mgc:  0.05398481 
iter: 1  value: 318.8757 mgc: 0.04119469 ustep: 1 
iter: 2  value: 318.8757 mgc: 7.076358e-06 ustep: 1 
iter: 3  mgc: 7.314149e-13 
iter: 1  mgc: 7.314149e-13 
outer mgc:  0.006911879 
iter: 1  value: 318.8761 mgc: 0.004060303 ustep: 1 
iter: 2  value: 318.8761 mgc: 4.761965e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.002372513 
iter: 1  value: 318.876 mgc: 0.001330091 ustep: 1 
iter: 2  mgc: 4.179297e-09 
iter: 1  mgc: 4.179297e-09 
outer mgc:  5.497301e-05 
iter: 1  value: 318.876 mgc: 2.815486e-05 ustep: 1 
iter: 2  mgc: 1.321476e-11 
iter: 1  mgc: 1.321476e-11 
outer mgc:  8.988331e-06 
iter: 1  value: 318.876 mgc: 6.683554e-06 ustep: 1 
iter: 2  mgc: 3.260725e-13 
iter: 1  mgc: 3.260725e-13 
outer mgc:  2.269044e-07 
iter: 1  value: 318.876 mgc: 2.386415e-07 ustep: 1 
iter: 2  mgc: 3.4861e-14 
iter: 1  mgc: 3.4861e-14 
outer mgc:  7.616227e-09 
iter: 1  mgc: 7.965416e-09 
iter: 1  mgc: 7.965416e-09 
outer mgc:  7.467011e-10 
iter: 1  mgc: 7.888724e-09 
iter: 1  mgc: 7.888724e-09 
outer mgc:  1.628653e-11 
iter: 1  mgc: 7.884585e-09 
iter: 1  mgc: 7.888724e-09 
iter: 1  mgc: 7.888724e-09 
outer mgc:  1.628653e-11 
iter: 1  value: 318.8765 mgc: 0.04238761 ustep: 1 
iter: 2  value: 318.8765 mgc: 5.598484e-06 ustep: 1 
iter: 3  mgc: 2.633449e-13 
outer mgc:  0.04860595 
iter: 1  value: 318.8754 mgc: 0.04238544 ustep: 1 
iter: 2  value: 318.8754 mgc: 5.593086e-06 ustep: 1 
iter: 3  mgc: 2.584599e-13 
outer mgc:  0.04860605 
iter: 1  value: 318.8775 mgc: 0.02077398 ustep: 1 
iter: 2  value: 318.8775 mgc: 1.71219e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.1481531 
iter: 1  value: 318.8746 mgc: 0.02078207 ustep: 1 
iter: 2  value: 318.8746 mgc: 1.711678e-06 ustep: 1 
iter: 3  mgc: 5.173639e-14 
outer mgc:  0.1482002 
iter: 1  value: 318.8759 mgc: 0.04802946 ustep: 1 
iter: 2  value: 318.8759 mgc: 8.361849e-06 ustep: 1 
iter: 3  mgc: 4.884981e-13 
outer mgc:  0.04563678 
iter: 1  value: 318.876 mgc: 0.0480254 ustep: 1 
iter: 2  value: 318.876 mgc: 8.371234e-06 ustep: 1 
iter: 3  mgc: 4.807266e-13 
outer mgc:  0.04563667 
iter: 1  value: 318.8747 mgc: 0.02072181 ustep: 1 
iter: 2  value: 318.8747 mgc: 1.84982e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.144825 
iter: 1  value: 318.8774 mgc: 0.02071368 ustep: 1 
iter: 2  value: 318.8774 mgc: 1.849977e-06 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.1447806 
iter: 1  value: 318.8753 mgc: 0.002502103 ustep: 1 
iter: 2  value: 318.8753 mgc: 7.015564e-08 ustep: 1 
mgc: 2.789435e-14 
outer mgc:  0.007494831 
iter: 1  value: 318.8766 mgc: 0.002500717 ustep: 1 
iter: 2  value: 318.8766 mgc: 7.010187e-08 ustep: 1 
mgc: 2.753353e-14 
outer mgc:  0.007492138 
iter: 1  value: 318.8785 mgc: 0.009054535 ustep: 1 
iter: 2  value: 318.8785 mgc: 1.667029e-06 ustep: 1 
iter: 3  mgc: 4.356515e-13 
outer mgc:  0.0832259 
iter: 1  value: 318.8735 mgc: 0.009076714 ustep: 1 
iter: 2  value: 318.8735 mgc: 1.678165e-06 ustep: 1 
iter: 3  mgc: 4.685141e-13 
outer mgc:  0.08330163 
iter: 1  value: 318.8782 mgc: 0.006790849 ustep: 1 
iter: 2  value: 318.8782 mgc: 6.682447e-07 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.08850463 
iter: 1  value: 318.8738 mgc: 0.006805683 ustep: 1 
iter: 2  value: 318.8738 mgc: 6.705388e-07 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.08864703 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:05:33 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 10:36:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_diagREDM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0_ModeldiagREDM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_diagREDM_NA_NA_NA_dataset1.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4397.744992 
final  value 3777.609059 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4046.68 mgc: 120.5527 ustep: 1 
iter: 2  value: 3982.178 mgc: 72.37076 ustep: 0.09205185 
iter: 3  value: 3722.941 mgc: 72.99192 ustep: 0.03938035 
iter: 4  value: 3676.417 mgc: 50.8257 ustep: 0.198525 
iter: 5  value: 3672.895 mgc: 14.15244 ustep: 0.4456169 
iter: 6  value: 3672.873 mgc: 0.4981369 ustep: 0.6675787 
iter: 7  value: 3672.873 mgc: 0.03071108 ustep: 0.8170732 
iter: 8  value: 3672.873 mgc: 0.0006916919 ustep: 0.9039306 
iter: 9  value: 3672.873 mgc: 7.477403e-06 ustep: 0.9507576 
iter: 10  value: 3672.873 mgc: 5.924342e-08 ustep: 0.9750705 
iter: 11  mgc: 2.329104e-10 
iter: 1  mgc: 2.329104e-10 
Matching hessian patterns... Done
outer mgc:  42.49736 
iter: 1  value: 3774.067 mgc: 35.00219 ustep: 1 
iter: 2  value: 3751.619 mgc: 11.54147 ustep: 1 
iter: 3  value: 3751.506 mgc: 1.049978 ustep: 1 
iter: 4  value: 3751.506 mgc: 0.01428456 ustep: 1 
iter: 5  value: 3751.506 mgc: 2.792935e-06 ustep: 1 
iter: 6  mgc: 8.505835e-12 
iter: 1  value: 3667.299 mgc: 9.000197 ustep: 1 
iter: 2  value: 3667.265 mgc: 0.4245725 ustep: 1 
iter: 3  value: 3667.265 mgc: 0.002167087 ustep: 1 
iter: 4  value: 3667.265 mgc: 5.790278e-08 ustep: 1 
mgc: 7.631284e-12 
iter: 1  mgc: 7.631284e-12 
outer mgc:  12.82557 
iter: 1  value: 3665.081 mgc: 5.260114 ustep: 1 
iter: 2  value: 3665.073 mgc: 0.1895241 ustep: 1 
iter: 3  value: 3665.073 mgc: 0.0003395257 ustep: 1 
iter: 4  mgc: 2.404646e-09 
iter: 1  mgc: 2.404646e-09 
outer mgc:  13.51359 
iter: 1  value: 3663.011 mgc: 22.43504 ustep: 1 
iter: 2  value: 3660.443 mgc: 3.928903 ustep: 1 
iter: 3  value: 3660.441 mgc: 0.1412449 ustep: 1 
iter: 4  value: 3660.441 mgc: 0.0002813322 ustep: 1 
iter: 5  mgc: 1.7777e-09 
iter: 1  mgc: 1.7777e-09 
outer mgc:  17.82218 
iter: 1  value: 3655.665 mgc: 15.94547 ustep: 1 
iter: 2  value: 3655.332 mgc: 1.423682 ustep: 1 
iter: 3  value: 3655.332 mgc: 0.01971841 ustep: 1 
iter: 4  value: 3655.332 mgc: 8.385165e-06 ustep: 1 
iter: 5  mgc: 8.316486e-12 
iter: 1  value: 3653.433 mgc: 23.13163 ustep: 1 
iter: 2  value: 3651.514 mgc: 3.471794 ustep: 1 
iter: 3  value: 3651.512 mgc: 0.1091441 ustep: 1 
iter: 4  value: 3651.512 mgc: 0.0002008317 ustep: 1 
iter: 5  mgc: 8.973618e-10 
iter: 1  mgc: 8.973618e-10 
outer mgc:  12.71324 
iter: 1  value: 3651.119 mgc: 17.65773 ustep: 1 
iter: 2  value: 3649.319 mgc: 2.978335 ustep: 1 
iter: 3  value: 3649.318 mgc: 0.07018647 ustep: 1 
iter: 4  value: 3649.318 mgc: 8.650262e-05 ustep: 1 
iter: 5  mgc: 2.538119e-10 
iter: 1  mgc: 2.538119e-10 
outer mgc:  21.3087 
iter: 1  value: 3638.873 mgc: 15.46793 ustep: 1 
iter: 2  value: 3638.703 mgc: 1.079342 ustep: 1 
iter: 3  value: 3638.703 mgc: 0.01105202 ustep: 1 
iter: 4  value: 3638.703 mgc: 2.357065e-06 ustep: 1 
iter: 5  mgc: 5.033994e-12 
iter: 1  mgc: 5.033994e-12 
outer mgc:  15.69296 
iter: 1  value: 3636.548 mgc: 16.37801 ustep: 1 
iter: 2  value: 3636.517 mgc: 0.488808 ustep: 1 
iter: 3  value: 3636.517 mgc: 0.001795018 ustep: 1 
iter: 4  value: 3636.517 mgc: 3.875752e-08 ustep: 1 
mgc: 2.685629e-12 
iter: 1  mgc: 2.685629e-12 
outer mgc:  28.59078 
iter: 1  value: 3631.335 mgc: 6.983979 ustep: 1 
iter: 2  value: 3631.304 mgc: 0.4506652 ustep: 1 
iter: 3  value: 3631.304 mgc: 0.000875407 ustep: 1 
iter: 4  value: 3631.304 mgc: 1.185444e-08 ustep: 1 
mgc: 1.689315e-12 
iter: 1  mgc: 1.689315e-12 
outer mgc:  13.80931 
iter: 1  value: 3691.281 mgc: 24.86363 ustep: 1 
iter: 2  value: 3683.456 mgc: 7.071643 ustep: 1 
iter: 3  value: 3683.44 mgc: 0.3499023 ustep: 1 
iter: 4  value: 3683.44 mgc: 0.002002814 ustep: 1 
iter: 5  value: 3683.44 mgc: 6.730036e-08 ustep: 1 
mgc: 6.776801e-13 
iter: 1  value: 3630.393 mgc: 4.880508 ustep: 1 
iter: 2  value: 3630.389 mgc: 0.1259116 ustep: 1 
iter: 3  value: 3630.389 mgc: 0.0001751447 ustep: 1 
iter: 4  mgc: 3.618084e-10 
iter: 1  mgc: 3.618084e-10 
outer mgc:  11.7476 
iter: 1  value: 3629.102 mgc: 2.169919 ustep: 1 
iter: 2  value: 3629.102 mgc: 0.0150641 ustep: 1 
iter: 3  value: 3629.102 mgc: 1.721273e-06 ustep: 1 
iter: 4  mgc: 1.314282e-12 
iter: 1  mgc: 1.314282e-12 
outer mgc:  6.56159 
iter: 1  value: 3626.953 mgc: 2.670461 ustep: 1 
iter: 2  value: 3626.953 mgc: 0.03910937 ustep: 1 
iter: 3  value: 3626.953 mgc: 1.606681e-05 ustep: 1 
iter: 4  mgc: 3.378409e-12 
iter: 1  value: 3618.476 mgc: 3.002182 ustep: 1 
iter: 2  value: 3618.476 mgc: 0.08368814 ustep: 1 
iter: 3  value: 3618.476 mgc: 7.549929e-05 ustep: 1 
iter: 4  mgc: 6.093484e-11 
iter: 1  value: 3545.239 mgc: 9.611527 ustep: 1 
iter: 2  value: 3545.092 mgc: 1.169086 ustep: 1 
iter: 3  value: 3545.092 mgc: 0.03176062 ustep: 1 
iter: 4  value: 3545.092 mgc: 2.598229e-05 ustep: 1 
iter: 5  mgc: 1.744382e-11 
iter: 1  mgc: 1.744382e-11 
outer mgc:  32.08342 
iter: 1  value: 3639.314 mgc: 11.53735 ustep: 1 
iter: 2  value: 3639.292 mgc: 0.4544472 ustep: 1 
iter: 3  value: 3639.292 mgc: 0.0002978344 ustep: 1 
iter: 4  mgc: 3.933383e-10 
iter: 1  value: 3494.228 mgc: 6.027272 ustep: 1 
iter: 2  value: 3494.144 mgc: 1.019911 ustep: 1 
iter: 3  value: 3494.144 mgc: 0.00692051 ustep: 1 
iter: 4  value: 3494.144 mgc: 6.512107e-07 ustep: 1 
iter: 5  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  17.58741 
iter: 1  value: 3606.818 mgc: 9.347851 ustep: 1 
iter: 2  value: 3606.614 mgc: 1.148343 ustep: 1 
iter: 3  value: 3606.614 mgc: 0.01853162 ustep: 1 
iter: 4  value: 3606.614 mgc: 5.386466e-06 ustep: 1 
iter: 5  mgc: 4.538592e-13 
iter: 1  value: 3486.923 mgc: 1.823282 ustep: 1 
iter: 2  value: 3486.917 mgc: 0.09553956 ustep: 1 
iter: 3  value: 3486.917 mgc: 0.0002590178 ustep: 1 
iter: 4  mgc: 1.852141e-09 
iter: 1  mgc: 1.852141e-09 
outer mgc:  6.903844 
iter: 1  value: 3485.127 mgc: 2.988895 ustep: 1 
iter: 2  value: 3485.126 mgc: 0.0695654 ustep: 1 
iter: 3  value: 3485.126 mgc: 8.65216e-05 ustep: 1 
iter: 4  mgc: 1.925167e-10 
iter: 1  mgc: 1.925167e-10 
outer mgc:  15.76302 
iter: 1  value: 3482.85 mgc: 1.883889 ustep: 1 
iter: 2  value: 3482.847 mgc: 0.05824068 ustep: 1 
iter: 3  value: 3482.847 mgc: 9.249179e-05 ustep: 1 
iter: 4  mgc: 2.413919e-10 
iter: 1  mgc: 2.413919e-10 
outer mgc:  3.085975 
iter: 1  value: 3480.631 mgc: 1.253422 ustep: 1 
iter: 2  value: 3480.631 mgc: 0.03530997 ustep: 1 
iter: 3  value: 3480.631 mgc: 3.189336e-05 ustep: 1 
iter: 4  mgc: 2.646283e-11 
iter: 1  mgc: 2.646283e-11 
outer mgc:  2.813633 
iter: 1  value: 3477.591 mgc: 0.4954783 ustep: 1 
iter: 2  value: 3477.591 mgc: 0.002955754 ustep: 1 
iter: 3  value: 3477.591 mgc: 1.405422e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  2.315065 
iter: 1  value: 3474.459 mgc: 0.9096374 ustep: 1 
iter: 2  value: 3474.459 mgc: 0.01317276 ustep: 1 
iter: 3  value: 3474.459 mgc: 2.645094e-06 ustep: 1 
iter: 4  mgc: 1.152411e-13 
iter: 1  mgc: 1.152411e-13 
outer mgc:  4.600213 
iter: 1  value: 3471.268 mgc: 0.99379 ustep: 1 
iter: 2  value: 3471.268 mgc: 0.005296854 ustep: 1 
iter: 3  value: 3471.268 mgc: 2.98544e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  value: 3468.034 mgc: 0.6512288 ustep: 1 
iter: 2  value: 3468.034 mgc: 0.003592418 ustep: 1 
iter: 3  value: 3468.034 mgc: 1.148074e-07 ustep: 1 
mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  3.760877 
iter: 1  value: 3461.096 mgc: 1.516878 ustep: 1 
iter: 2  value: 3461.096 mgc: 0.00603204 ustep: 1 
iter: 3  value: 3461.096 mgc: 1.873835e-07 ustep: 1 
mgc: 3.774758e-15 
iter: 1  mgc: 3.774758e-15 
outer mgc:  0.7216786 
iter: 1  value: 3453.936 mgc: 1.648319 ustep: 1 
iter: 2  value: 3453.936 mgc: 0.004015514 ustep: 1 
iter: 3  value: 3453.936 mgc: 4.650462e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.5789517 
iter: 1  value: 3440.198 mgc: 3.885735 ustep: 1 
iter: 2  value: 3440.198 mgc: 0.00811661 ustep: 1 
iter: 3  value: 3440.198 mgc: 4.636946e-08 ustep: 1 
mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  1.128554 
iter: 1  value: 3429.193 mgc: 2.531206 ustep: 1 
iter: 2  value: 3429.193 mgc: 0.0009482411 ustep: 1 
iter: 3  mgc: 2.39595e-10 
iter: 1  mgc: 2.39595e-10 
outer mgc:  1.844547 
iter: 1  value: 3421.228 mgc: 2.539886 ustep: 1 
iter: 2  value: 3421.228 mgc: 0.0003191771 ustep: 1 
iter: 3  mgc: 1.406386e-11 
iter: 1  mgc: 1.406386e-11 
outer mgc:  0.7065079 
iter: 1  value: 3413.206 mgc: 2.226379 ustep: 1 
iter: 2  value: 3413.206 mgc: 0.0001448328 ustep: 1 
iter: 3  mgc: 1.25544e-12 
iter: 1  mgc: 1.25544e-12 
outer mgc:  0.5180843 
iter: 1  value: 3405.164 mgc: 2.143364 ustep: 1 
iter: 2  value: 3405.164 mgc: 6.178226e-05 ustep: 1 
iter: 3  mgc: 1.034728e-13 
iter: 1  mgc: 1.034728e-13 
outer mgc:  0.4862567 
iter: 1  value: 3397.083 mgc: 2.189827 ustep: 1 
iter: 2  value: 3397.083 mgc: 2.572107e-05 ustep: 1 
iter: 3  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  0.1740228 
iter: 1  value: 3388.989 mgc: 2.11872 ustep: 1 
iter: 2  value: 3388.989 mgc: 1.177748e-05 ustep: 1 
iter: 3  mgc: 6.328271e-15 
iter: 1  mgc: 6.328271e-15 
outer mgc:  0.155663 
iter: 1  value: 3380.882 mgc: 2.146567 ustep: 1 
iter: 2  value: 3380.882 mgc: 5.361241e-06 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.1455944 
iter: 1  value: 3366.953 mgc: 4.228673 ustep: 1 
iter: 2  value: 3366.953 mgc: 5.505551e-06 ustep: 1 
mgc: 4.996004e-15 
iter: 1  mgc: 4.996004e-15 
outer mgc:  0.1045583 
iter: 1  value: 3353.012 mgc: 4.276994 ustep: 1 
iter: 2  value: 3353.012 mgc: 1.409897e-06 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.07305944 
iter: 1  value: 3340.114 mgc: 3.820751 ustep: 1 
iter: 2  value: 3340.114 mgc: 3.293318e-07 ustep: 1 
mgc: 4.773959e-15 
iter: 1  mgc: 4.773959e-15 
outer mgc:  0.05629422 
iter: 1  value: 3329.434 mgc: 3.025642 ustep: 1 
iter: 2  value: 3329.434 mgc: 7.185973e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.0313305 
iter: 1  value: 3318.753 mgc: 3.015305 ustep: 1 
iter: 2  value: 3318.753 mgc: 2.580946e-08 ustep: 1 
mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  0.03531366 
iter: 1  value: 3303.558 mgc: 4.828305 ustep: 1 
iter: 2  value: 3303.558 mgc: 1.548189e-08 ustep: 1 
mgc: 5.440093e-15 
iter: 1  mgc: 5.440093e-15 
outer mgc:  0.01276654 
iter: 1  value: 3290.584 mgc: 3.891429 ustep: 1 
iter: 2  mgc: 2.904433e-09 
iter: 1  mgc: 2.904433e-09 
outer mgc:  0.001010769 
iter: 1  value: 3278.641 mgc: 3.488876 ustep: 1 
iter: 2  mgc: 7.467937e-10 
iter: 1  mgc: 7.467937e-10 
outer mgc:  0.007214933 
iter: 1  value: 3266.699 mgc: 3.487352 ustep: 1 
iter: 2  mgc: 2.396119e-10 
iter: 1  mgc: 2.396119e-10 
outer mgc:  0.006808079 
iter: 1  value: 3251.935 mgc: 4.634186 ustep: 1 
iter: 2  mgc: 1.044413e-10 
iter: 1  mgc: 1.044413e-10 
outer mgc:  0.003011711 
iter: 1  value: 3238.395 mgc: 4.117552 ustep: 1 
iter: 2  mgc: 2.280665e-11 
iter: 1  mgc: 2.280665e-11 
outer mgc:  0.0002418662 
iter: 1  value: 3225.577 mgc: 3.827029 ustep: 1 
iter: 2  mgc: 5.852208e-12 
iter: 1  mgc: 5.852208e-12 
outer mgc:  0.001580294 
iter: 1  value: 3212.759 mgc: 3.827402 ustep: 1 
iter: 2  mgc: 1.740386e-12 
iter: 1  mgc: 1.740386e-12 
outer mgc:  0.001487431 
iter: 1  value: 3199.941 mgc: 3.827607 ustep: 1 
iter: 2  mgc: 5.231371e-13 
iter: 1  mgc: 5.231371e-13 
outer mgc:  0.0007559967 
iter: 1  value: 3187.122 mgc: 3.827639 ustep: 1 
iter: 2  mgc: 1.589839e-13 
iter: 1  mgc: 1.589839e-13 
outer mgc:  6.187558e-05 
iter: 1  value: 3173.259 mgc: 4.252203 ustep: 1 
iter: 2  mgc: 5.195844e-14 
iter: 1  mgc: 5.195844e-14 
outer mgc:  0.0003254822 
iter: 1  value: 3159.786 mgc: 4.091055 ustep: 1 
iter: 2  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  0.0003438472 
iter: 1  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  0.0003438472 
iter: 1  value: 3159.787 mgc: 0.004695781 ustep: 1 
mgc: 3.108624e-15 
outer mgc:  0.06721729 
iter: 1  value: 3159.787 mgc: 0.004692866 ustep: 1 
mgc: 5.356826e-15 
outer mgc:  0.06702292 
iter: 1  value: 3159.786 mgc: 0.002486997 ustep: 1 
mgc: 5.301315e-15 
outer mgc:  0.03531517 
iter: 1  value: 3159.786 mgc: 0.002485257 ustep: 1 
mgc: 7.549517e-15 
outer mgc:  0.03555913 
iter: 1  value: 3159.787 mgc: 0.005656073 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.09972851 
iter: 1  value: 3159.787 mgc: 0.005655322 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.09966963 
iter: 1  value: 3159.787 mgc: 0.003222637 ustep: 1 
mgc: 7.771561e-15 
outer mgc:  0.05326513 
iter: 1  value: 3159.787 mgc: 0.003221676 ustep: 1 
mgc: 4.218847e-15 
outer mgc:  0.05331754 
iter: 1  value: 3159.796 mgc: 0.002662893 ustep: 1 
mgc: 6.106227e-15 
outer mgc:  0.0003438471 
iter: 1  value: 3159.776 mgc: 0.002665557 ustep: 1 
mgc: 5.440093e-15 
outer mgc:  0.0003438472 
iter: 1  value: 3159.796 mgc: 0.004681695 ustep: 1 
mgc: 4.32987e-15 
outer mgc:  0.0003438469 
iter: 1  value: 3159.776 mgc: 0.004686379 ustep: 1 
mgc: 5.440093e-15 
outer mgc:  0.0003438475 
iter: 1  value: 3159.786 mgc: 0.00356687 ustep: 1 
mgc: 6.439294e-15 
outer mgc:  0.01904197 
iter: 1  value: 3159.786 mgc: 0.003564802 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.01875074 
iter: 1  value: 3159.786 mgc: 0.003693719 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.01775568 
iter: 1  value: 3159.786 mgc: 0.003691495 ustep: 1 
mgc: 4.218847e-15 
outer mgc:  0.01754736 
[Fri Aug 13 10:36:49 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:40:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11095.984116 
final  value 10391.818228 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2486.552 mgc: 124.4806 ustep: 1 
iter: 2  value: 1959.593 mgc: 50.61134 ustep: 0.2494656 
iter: 3  value: 1782.953 mgc: 57.69326 ustep: 0.4995153 
iter: 4  value: 1775.987 mgc: 8.146644 ustep: 0.7067933 
iter: 5  value: 1775.902 mgc: 0.9272258 ustep: 0.8407259 
iter: 6  value: 1775.901 mgc: 0.03369942 ustep: 0.9169194 
iter: 7  value: 1775.901 mgc: 0.001379193 ustep: 0.9575633 
iter: 8  value: 1775.901 mgc: 2.501123e-05 ustep: 0.9785538 
iter: 9  value: 1775.901 mgc: 3.262989e-07 ustep: 0.9892199 
iter: 10  mgc: 2.557945e-09 
iter: 1  mgc: 2.557945e-09 
Matching hessian patterns... Done
outer mgc:  773.4073 
iter: 1  value: 1266.182 mgc: 34.73493 ustep: 1 
iter: 2  value: 1265.173 mgc: 2.556054 ustep: 1 
iter: 3  value: 1265.173 mgc: 0.04549122 ustep: 1 
iter: 4  value: 1265.173 mgc: 4.408331e-05 ustep: 1 
iter: 5  mgc: 4.333062e-11 
iter: 1  mgc: 4.333062e-11 
outer mgc:  251.1069 
iter: 1  value: 1158.082 mgc: 27.55845 ustep: 1 
iter: 2  value: 1156.499 mgc: 2.049328 ustep: 1 
iter: 3  value: 1156.499 mgc: 0.08068047 ustep: 1 
iter: 4  value: 1156.499 mgc: 0.0001411267 ustep: 1 
iter: 5  mgc: 4.340445e-10 
iter: 1  mgc: 4.340445e-10 
outer mgc:  126.8489 
iter: 1  value: 1225.993 mgc: 25.9958 ustep: 1 
iter: 2  value: 1224.002 mgc: 2.715138 ustep: 1 
iter: 3  value: 1224.002 mgc: 0.08618421 ustep: 1 
iter: 4  value: 1224.002 mgc: 9.825865e-05 ustep: 1 
iter: 5  mgc: 1.67138e-10 
iter: 1  value: 1123.261 mgc: 10.59949 ustep: 1 
iter: 2  value: 1123.219 mgc: 0.4085851 ustep: 1 
iter: 3  value: 1123.219 mgc: 0.002189782 ustep: 1 
iter: 4  value: 1123.219 mgc: 8.013602e-08 ustep: 1 
mgc: 2.564615e-14 
iter: 1  mgc: 2.564615e-14 
outer mgc:  42.06215 
iter: 1  value: 1114.632 mgc: 10.39446 ustep: 1 
iter: 2  value: 1114.596 mgc: 0.2626305 ustep: 1 
iter: 3  value: 1114.596 mgc: 0.0007626761 ustep: 1 
iter: 4  value: 1114.596 mgc: 2.377558e-08 ustep: 1 
mgc: 2.53686e-14 
iter: 1  mgc: 2.53686e-14 
outer mgc:  72.16464 
iter: 1  value: 1096.135 mgc: 8.723211 ustep: 1 
iter: 2  value: 1095.83 mgc: 1.142041 ustep: 1 
iter: 3  value: 1095.829 mgc: 0.05726074 ustep: 1 
iter: 4  value: 1095.829 mgc: 0.0002189183 ustep: 1 
iter: 5  mgc: 3.23009e-09 
iter: 1  mgc: 3.23009e-09 
outer mgc:  59.5195 
iter: 1  value: 1094.242 mgc: 18.07717 ustep: 1 
iter: 2  value: 1089.616 mgc: 4.801526 ustep: 1 
iter: 3  value: 1089.587 mgc: 0.5530802 ustep: 1 
iter: 4  value: 1089.587 mgc: 0.009600675 ustep: 1 
iter: 5  value: 1089.587 mgc: 3.006845e-06 ustep: 1 
iter: 6  mgc: 2.957634e-13 
iter: 1  mgc: 2.957634e-13 
outer mgc:  66.8146 
iter: 1  value: 1096.344 mgc: 28.27252 ustep: 1 
iter: 2  value: 1089.382 mgc: 4.780338 ustep: 1 
iter: 3  value: 1089.378 mgc: 0.1216188 ustep: 1 
iter: 4  value: 1089.378 mgc: 0.0001451835 ustep: 1 
iter: 5  mgc: 2.08249e-10 
iter: 1  mgc: 2.08249e-10 
outer mgc:  69.71263 
iter: 1  value: 1084.839 mgc: 22.97305 ustep: 1 
iter: 2  value: 1084.087 mgc: 1.643547 ustep: 1 
iter: 3  value: 1084.087 mgc: 0.01149838 ustep: 1 
iter: 4  value: 1084.087 mgc: 1.354815e-06 ustep: 1 
iter: 5  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  94.20607 
iter: 1  value: 1075.744 mgc: 5.375663 ustep: 1 
iter: 2  value: 1075.736 mgc: 0.1651429 ustep: 1 
iter: 3  value: 1075.736 mgc: 0.0002644103 ustep: 1 
iter: 4  mgc: 6.740009e-10 
iter: 1  mgc: 6.740009e-10 
outer mgc:  33.48653 
iter: 1  value: 1075.985 mgc: 7.853677 ustep: 1 
iter: 2  value: 1075.881 mgc: 0.608996 ustep: 1 
iter: 3  value: 1075.881 mgc: 0.01525735 ustep: 1 
iter: 4  value: 1075.881 mgc: 1.007567e-05 ustep: 1 
iter: 5  mgc: 4.41025e-12 
iter: 1  value: 1072.603 mgc: 1.840352 ustep: 1 
iter: 2  value: 1072.601 mgc: 0.1029747 ustep: 1 
iter: 3  value: 1072.601 mgc: 0.0005740385 ustep: 1 
iter: 4  value: 1072.601 mgc: 1.811202e-08 ustep: 1 
mgc: 2.58682e-14 
iter: 1  mgc: 2.58682e-14 
outer mgc:  8.880974 
iter: 1  value: 1073.827 mgc: 1.9465 ustep: 1 
iter: 2  value: 1073.826 mgc: 0.04731354 ustep: 1 
iter: 3  value: 1073.826 mgc: 3.01694e-05 ustep: 1 
iter: 4  mgc: 3.754108e-11 
iter: 1  value: 1072.236 mgc: 0.4498498 ustep: 1 
iter: 2  value: 1072.236 mgc: 0.002516989 ustep: 1 
iter: 3  value: 1072.236 mgc: 8.87151e-08 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  5.762734 
iter: 1  value: 1072.163 mgc: 1.437412 ustep: 1 
iter: 2  value: 1072.163 mgc: 0.00614009 ustep: 1 
iter: 3  value: 1072.163 mgc: 2.930771e-07 ustep: 1 
iter: 4  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  9.792603 
iter: 1  value: 1071.859 mgc: 1.245005 ustep: 1 
iter: 2  value: 1071.859 mgc: 0.00492818 ustep: 1 
iter: 3  value: 1071.859 mgc: 3.359512e-07 ustep: 1 
iter: 4  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  2.258781 
iter: 1  value: 1071.811 mgc: 0.5637181 ustep: 1 
iter: 2  value: 1071.811 mgc: 0.001492772 ustep: 1 
iter: 3  value: 1071.811 mgc: 2.791635e-08 ustep: 1 
mgc: 2.509104e-14 
iter: 1  mgc: 2.509104e-14 
outer mgc:  3.128303 
iter: 1  value: 1071.831 mgc: 0.7524532 ustep: 1 
iter: 2  value: 1071.831 mgc: 0.002026114 ustep: 1 
iter: 3  value: 1071.831 mgc: 7.744466e-08 ustep: 1 
mgc: 2.287059e-14 
iter: 1  mgc: 2.287059e-14 
outer mgc:  2.209979 
iter: 1  value: 1072.328 mgc: 0.6970923 ustep: 1 
iter: 2  value: 1072.328 mgc: 0.005248241 ustep: 1 
iter: 3  value: 1072.328 mgc: 4.331818e-07 ustep: 1 
iter: 4  mgc: 2.753353e-14 
iter: 1  value: 1071.819 mgc: 0.2394707 ustep: 1 
iter: 2  value: 1071.819 mgc: 0.000165853 ustep: 1 
iter: 3  mgc: 4.083875e-10 
iter: 1  mgc: 4.083875e-10 
outer mgc:  1.350964 
iter: 1  value: 1071.819 mgc: 0.3163622 ustep: 1 
iter: 2  value: 1071.819 mgc: 0.0001935789 ustep: 1 
iter: 3  mgc: 2.632984e-10 
iter: 1  value: 1071.791 mgc: 0.2536274 ustep: 1 
iter: 2  value: 1071.791 mgc: 0.000143074 ustep: 1 
iter: 3  mgc: 1.923071e-10 
iter: 1  mgc: 1.923071e-10 
outer mgc:  1.471944 
iter: 1  value: 1071.787 mgc: 0.1695667 ustep: 1 
iter: 2  value: 1071.787 mgc: 0.0001114712 ustep: 1 
iter: 3  mgc: 1.472573e-10 
iter: 1  mgc: 1.472573e-10 
outer mgc:  0.3762187 
iter: 1  value: 1071.761 mgc: 0.1409421 ustep: 1 
iter: 2  value: 1071.761 mgc: 7.655064e-05 ustep: 1 
iter: 3  mgc: 8.869794e-11 
iter: 1  mgc: 8.869794e-11 
outer mgc:  1.119657 
iter: 1  value: 1071.782 mgc: 0.2206083 ustep: 1 
iter: 2  value: 1071.782 mgc: 0.0001721484 ustep: 1 
iter: 3  mgc: 4.042651e-10 
iter: 1  mgc: 4.042651e-10 
outer mgc:  0.3115805 
iter: 1  value: 1071.779 mgc: 0.1924901 ustep: 1 
iter: 2  value: 1071.779 mgc: 0.0001272451 ustep: 1 
iter: 3  mgc: 1.019247e-09 
iter: 1  value: 1071.778 mgc: 0.05158043 ustep: 1 
iter: 2  value: 1071.778 mgc: 9.108827e-06 ustep: 1 
iter: 3  mgc: 5.248246e-12 
iter: 1  mgc: 5.248246e-12 
outer mgc:  0.492527 
iter: 1  value: 1071.781 mgc: 0.1118095 ustep: 1 
iter: 2  value: 1071.781 mgc: 3.624669e-05 ustep: 1 
iter: 3  mgc: 1.497313e-11 
iter: 1  mgc: 1.497313e-11 
outer mgc:  0.2336764 
iter: 1  value: 1071.788 mgc: 0.0997768 ustep: 1 
iter: 2  value: 1071.788 mgc: 4.239287e-05 ustep: 1 
iter: 3  mgc: 1.693756e-11 
iter: 1  mgc: 1.693756e-11 
outer mgc:  0.400353 
iter: 1  value: 1071.795 mgc: 0.09709477 ustep: 1 
iter: 2  value: 1071.795 mgc: 5.661159e-05 ustep: 1 
iter: 3  mgc: 4.016143e-11 
iter: 1  mgc: 4.016143e-11 
outer mgc:  0.1891165 
iter: 1  value: 1071.772 mgc: 0.2099996 ustep: 1 
iter: 2  value: 1071.772 mgc: 9.092715e-05 ustep: 1 
iter: 3  mgc: 5.426104e-11 
iter: 1  value: 1071.784 mgc: 0.09547758 ustep: 1 
iter: 2  value: 1071.784 mgc: 1.882916e-05 ustep: 1 
iter: 3  mgc: 2.309264e-12 
iter: 1  mgc: 2.309264e-12 
outer mgc:  0.2278332 
iter: 1  value: 1071.789 mgc: 0.04822986 ustep: 1 
iter: 2  value: 1071.789 mgc: 7.96156e-06 ustep: 1 
iter: 3  mgc: 7.41629e-13 
iter: 1  mgc: 7.41629e-13 
outer mgc:  0.147574 
iter: 1  value: 1071.809 mgc: 0.03592771 ustep: 1 
iter: 2  value: 1071.809 mgc: 1.966588e-05 ustep: 1 
iter: 3  mgc: 1.63114e-11 
iter: 1  mgc: 1.63114e-11 
outer mgc:  0.2095145 
iter: 1  value: 1071.794 mgc: 0.01505261 ustep: 1 
iter: 2  value: 1071.794 mgc: 7.703208e-06 ustep: 1 
iter: 3  mgc: 3.563372e-12 
iter: 1  mgc: 3.563372e-12 
outer mgc:  0.2492828 
iter: 1  value: 1071.803 mgc: 0.1641983 ustep: 1 
iter: 2  value: 1071.803 mgc: 0.0001104858 ustep: 1 
iter: 3  mgc: 1.506969e-10 
iter: 1  value: 1071.799 mgc: 0.07738948 ustep: 1 
iter: 2  value: 1071.799 mgc: 2.589254e-05 ustep: 1 
iter: 3  mgc: 8.075207e-12 
iter: 1  mgc: 8.075207e-12 
outer mgc:  0.1138566 
iter: 1  value: 1071.795 mgc: 0.06077963 ustep: 1 
iter: 2  value: 1071.795 mgc: 1.450378e-05 ustep: 1 
iter: 3  mgc: 4.074519e-12 
iter: 1  value: 1071.799 mgc: 0.01238616 ustep: 1 
iter: 2  value: 1071.799 mgc: 9.061467e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  0.0417553 
iter: 1  value: 1071.801 mgc: 0.01072315 ustep: 1 
iter: 2  value: 1071.801 mgc: 6.826249e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  0.0224081 
iter: 1  value: 1071.801 mgc: 0.01364667 ustep: 1 
iter: 2  value: 1071.801 mgc: 9.171308e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.01690867 
iter: 1  value: 1071.801 mgc: 0.001719864 ustep: 1 
iter: 2  value: 1071.801 mgc: 1.384483e-08 ustep: 1 
mgc: 2.337019e-14 
iter: 1  mgc: 2.337019e-14 
outer mgc:  0.001164146 
iter: 1  value: 1071.801 mgc: 0.0001562742 ustep: 1 
iter: 2  mgc: 1.171117e-10 
iter: 1  mgc: 1.171117e-10 
outer mgc:  0.0004799543 
iter: 1  mgc: 1.171117e-10 
iter: 1  mgc: 1.171117e-10 
outer mgc:  0.0004799543 
iter: 1  value: 1071.802 mgc: 0.0551514 ustep: 1 
iter: 2  value: 1071.802 mgc: 7.652605e-06 ustep: 1 
iter: 3  mgc: 5.582201e-13 
outer mgc:  0.1460904 
iter: 1  value: 1071.8 mgc: 0.0551437 ustep: 1 
iter: 2  value: 1071.8 mgc: 7.662092e-06 ustep: 1 
iter: 3  mgc: 5.551115e-13 
outer mgc:  0.1463377 
iter: 1  value: 1071.803 mgc: 0.03247378 ustep: 1 
iter: 2  value: 1071.803 mgc: 3.006473e-06 ustep: 1 
iter: 3  mgc: 1.247891e-13 
outer mgc:  0.5307992 
iter: 1  value: 1071.799 mgc: 0.0324747 ustep: 1 
iter: 2  value: 1071.799 mgc: 3.007009e-06 ustep: 1 
iter: 3  mgc: 1.278977e-13 
outer mgc:  0.5305706 
iter: 1  value: 1071.8 mgc: 0.05145816 ustep: 1 
iter: 2  value: 1071.8 mgc: 9.507817e-06 ustep: 1 
iter: 3  mgc: 6.648015e-13 
outer mgc:  0.1049073 
iter: 1  value: 1071.802 mgc: 0.05144321 ustep: 1 
iter: 2  value: 1071.802 mgc: 9.519297e-06 ustep: 1 
iter: 3  mgc: 6.650236e-13 
outer mgc:  0.1047126 
iter: 1  value: 1071.8 mgc: 0.02306517 ustep: 1 
iter: 2  value: 1071.8 mgc: 2.147332e-06 ustep: 1 
iter: 3  mgc: 3.230749e-14 
outer mgc:  0.3783809 
iter: 1  value: 1071.802 mgc: 0.02305509 ustep: 1 
iter: 2  value: 1071.802 mgc: 2.146704e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.3789781 
iter: 1  value: 1071.797 mgc: 0.005292706 ustep: 1 
iter: 2  value: 1071.797 mgc: 7.685784e-07 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.01790645 
iter: 1  value: 1071.804 mgc: 0.005289314 ustep: 1 
iter: 2  value: 1071.804 mgc: 7.681833e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.01832494 
iter: 1  value: 1071.805 mgc: 0.009268802 ustep: 1 
iter: 2  value: 1071.805 mgc: 1.159781e-06 ustep: 1 
iter: 3  mgc: 4.174439e-14 
outer mgc:  0.16721 
iter: 1  value: 1071.797 mgc: 0.00929096 ustep: 1 
iter: 2  value: 1071.797 mgc: 1.164287e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.1665571 
iter: 1  value: 1071.806 mgc: 0.01037159 ustep: 1 
iter: 2  value: 1071.806 mgc: 5.174959e-06 ustep: 1 
iter: 3  mgc: 1.48459e-12 
outer mgc:  0.1448719 
iter: 1  value: 1071.795 mgc: 0.01039682 ustep: 1 
iter: 2  value: 1071.795 mgc: 5.188447e-06 ustep: 1 
iter: 3  mgc: 1.488587e-12 
outer mgc:  0.145514 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:40:49 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:43:34 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4501.014547 
final  value 4312.374898 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 817.9142 mgc: 107.361 ustep: 1 
iter: 2  value: 751.5958 mgc: 39.7739 ustep: 0.4367355 
iter: 3  value: 560.5006 mgc: 94.08286 ustep: 0.6608936 
iter: 4  value: 558.56 mgc: 8.436771 ustep: 0.8129723 
iter: 5  value: 558.5492 mgc: 0.688309 ustep: 0.9016596 
iter: 6  value: 558.5492 mgc: 0.008731793 ustep: 0.9495626 
iter: 7  value: 558.5492 mgc: 1.900452e-05 ustep: 0.9744576 
iter: 8  value: 558.5492 mgc: 1.996262e-08 ustep: 0.9871475 
mgc: 1.079151e-11 
iter: 1  mgc: 1.079151e-11 
Matching hessian patterns... Done
outer mgc:  125.1669 
iter: 1  value: 482.2714 mgc: 22.82785 ustep: 1 
iter: 2  value: 480.5415 mgc: 3.464129 ustep: 1 
iter: 3  value: 480.5403 mgc: 0.1189399 ustep: 1 
iter: 4  value: 480.5403 mgc: 0.0002306636 ustep: 1 
iter: 5  mgc: 8.728907e-10 
iter: 1  mgc: 8.728907e-10 
outer mgc:  43.50287 
iter: 1  value: 512.6694 mgc: 15.48449 ustep: 1 
iter: 2  value: 512.6187 mgc: 0.7697339 ustep: 1 
iter: 3  value: 512.6187 mgc: 0.002769376 ustep: 1 
iter: 4  value: 512.6187 mgc: 9.180306e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  value: 472.9848 mgc: 5.288037 ustep: 1 
iter: 2  value: 472.9841 mgc: 0.08001339 ustep: 1 
iter: 3  value: 472.9841 mgc: 5.714937e-05 ustep: 1 
iter: 4  mgc: 4.136971e-11 
iter: 1  mgc: 4.136971e-11 
outer mgc:  21.2645 
iter: 1  value: 467.7787 mgc: 11.49266 ustep: 1 
iter: 2  value: 467.7356 mgc: 0.5166726 ustep: 1 
iter: 3  value: 467.7356 mgc: 0.001727859 ustep: 1 
iter: 4  value: 467.7356 mgc: 3.955148e-08 ustep: 1 
mgc: 2.101097e-14 
iter: 1  mgc: 2.101097e-14 
outer mgc:  24.01947 
iter: 1  value: 452.8629 mgc: 12.66599 ustep: 1 
iter: 2  value: 452.804 mgc: 0.5429943 ustep: 1 
iter: 3  value: 452.804 mgc: 0.003953874 ustep: 1 
iter: 4  value: 452.804 mgc: 3.561618e-07 ustep: 1 
iter: 5  mgc: 2.153833e-14 
iter: 1  value: 440.3702 mgc: 24.12627 ustep: 1 
iter: 2  value: 439.9071 mgc: 1.818606 ustep: 1 
iter: 3  value: 439.9071 mgc: 0.02609768 ustep: 1 
iter: 4  value: 439.9071 mgc: 8.801122e-06 ustep: 1 
iter: 5  mgc: 1.008527e-12 
iter: 1  mgc: 1.008527e-12 
outer mgc:  8.055666 
iter: 1  value: 631.304 mgc: 66.49185 ustep: 1 
iter: 2  value: 623.154 mgc: 10.32904 ustep: 1 
iter: 3  value: 623.1521 mgc: 0.2259116 ustep: 1 
iter: 4  value: 623.1521 mgc: 0.0001795941 ustep: 1 
iter: 5  mgc: 1.09627e-10 
iter: 1  value: 438.7899 mgc: 6.787798 ustep: 1 
iter: 2  value: 438.7872 mgc: 0.1067762 ustep: 1 
iter: 3  value: 438.7872 mgc: 7.267887e-05 ustep: 1 
iter: 4  mgc: 2.016987e-11 
iter: 1  mgc: 2.016987e-11 
outer mgc:  5.740785 
iter: 1  value: 438.2491 mgc: 5.030797 ustep: 1 
iter: 2  value: 438.2489 mgc: 0.03863065 ustep: 1 
iter: 3  value: 438.2489 mgc: 1.00484e-05 ustep: 1 
iter: 4  mgc: 1.142642e-12 
iter: 1  mgc: 1.142642e-12 
outer mgc:  11.22268 
iter: 1  value: 437.6471 mgc: 4.601276 ustep: 1 
iter: 2  value: 437.6469 mgc: 0.04392427 ustep: 1 
iter: 3  value: 437.6469 mgc: 1.162789e-05 ustep: 1 
iter: 4  mgc: 8.615331e-13 
iter: 1  mgc: 8.615331e-13 
outer mgc:  4.690523 
iter: 1  value: 437.593 mgc: 2.960526 ustep: 1 
iter: 2  value: 437.5929 mgc: 0.03698781 ustep: 1 
iter: 3  value: 437.5929 mgc: 2.5312e-05 ustep: 1 
iter: 4  mgc: 1.182432e-11 
iter: 1  value: 437.4367 mgc: 2.779638 ustep: 1 
iter: 2  value: 437.4367 mgc: 0.01054753 ustep: 1 
iter: 3  value: 437.4367 mgc: 5.698076e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  3.430941 
iter: 1  value: 438.6898 mgc: 3.577644 ustep: 1 
iter: 2  value: 438.6895 mgc: 0.063837 ustep: 1 
iter: 3  value: 438.6895 mgc: 2.724429e-05 ustep: 1 
iter: 4  mgc: 7.446044e-12 
iter: 1  value: 437.3978 mgc: 0.9642629 ustep: 1 
iter: 2  value: 437.3978 mgc: 0.00175731 ustep: 1 
iter: 3  value: 437.3978 mgc: 1.84337e-08 ustep: 1 
mgc: 1.676437e-14 
iter: 1  mgc: 1.676437e-14 
outer mgc:  1.21591 
iter: 1  value: 437.3959 mgc: 0.7250642 ustep: 1 
iter: 2  value: 437.3959 mgc: 0.001423793 ustep: 1 
iter: 3  mgc: 9.375374e-09 
iter: 1  mgc: 9.375374e-09 
outer mgc:  0.7900804 
iter: 1  value: 437.3985 mgc: 0.2641746 ustep: 1 
iter: 2  value: 437.3985 mgc: 0.0001903894 ustep: 1 
iter: 3  mgc: 1.930063e-10 
iter: 1  mgc: 1.930063e-10 
outer mgc:  0.2443576 
iter: 1  value: 437.4282 mgc: 0.2625183 ustep: 1 
iter: 2  value: 437.4282 mgc: 0.0004029311 ustep: 1 
iter: 3  mgc: 1.143856e-09 
iter: 1  value: 437.4127 mgc: 0.1169953 ustep: 1 
iter: 2  value: 437.4127 mgc: 7.634597e-05 ustep: 1 
iter: 3  mgc: 4.129364e-11 
iter: 1  mgc: 4.129364e-11 
outer mgc:  0.2587465 
iter: 1  value: 437.4165 mgc: 0.1482739 ustep: 1 
iter: 2  value: 437.4165 mgc: 9.172098e-05 ustep: 1 
iter: 3  mgc: 9.226619e-11 
iter: 1  mgc: 9.226619e-11 
outer mgc:  0.1306128 
iter: 1  value: 437.4258 mgc: 0.09213626 ustep: 1 
iter: 2  value: 437.4258 mgc: 4.586851e-05 ustep: 1 
iter: 3  mgc: 1.588152e-11 
iter: 1  mgc: 1.588152e-11 
outer mgc:  0.08836862 
iter: 1  value: 437.4347 mgc: 0.1121409 ustep: 1 
iter: 2  value: 437.4347 mgc: 4.584387e-05 ustep: 1 
iter: 3  mgc: 2.180744e-11 
iter: 1  value: 437.428 mgc: 0.06505363 ustep: 1 
iter: 2  value: 437.428 mgc: 1.054321e-05 ustep: 1 
iter: 3  mgc: 6.306067e-13 
iter: 1  value: 437.4262 mgc: 0.03699372 ustep: 1 
iter: 2  value: 437.4262 mgc: 2.798802e-06 ustep: 1 
iter: 3  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  0.0720598 
iter: 1  value: 437.4271 mgc: 0.02136839 ustep: 1 
iter: 2  value: 437.4271 mgc: 1.743361e-06 ustep: 1 
iter: 3  mgc: 3.430589e-14 
iter: 1  mgc: 3.430589e-14 
outer mgc:  0.02060151 
iter: 1  value: 437.4266 mgc: 0.02899761 ustep: 1 
iter: 2  value: 437.4266 mgc: 3.410287e-06 ustep: 1 
iter: 3  mgc: 7.682743e-14 
iter: 1  mgc: 7.682743e-14 
outer mgc:  0.009275865 
iter: 1  value: 437.4285 mgc: 0.02591397 ustep: 1 
iter: 2  value: 437.4285 mgc: 5.098158e-06 ustep: 1 
iter: 3  mgc: 4.907186e-13 
iter: 1  value: 437.4266 mgc: 0.01184054 ustep: 1 
iter: 2  value: 437.4266 mgc: 3.690976e-07 ustep: 1 
iter: 3  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  0.01678849 
iter: 1  value: 437.4267 mgc: 0.005726868 ustep: 1 
iter: 2  value: 437.4267 mgc: 4.857187e-08 ustep: 1 
mgc: 1.870726e-14 
iter: 1  mgc: 1.870726e-14 
outer mgc:  0.00896944 
iter: 1  value: 437.4271 mgc: 0.002163671 ustep: 1 
iter: 2  value: 437.4271 mgc: 2.719273e-08 ustep: 1 
mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  0.002226535 
iter: 1  value: 437.4268 mgc: 0.001803078 ustep: 1 
iter: 2  value: 437.4268 mgc: 1.018511e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.002852508 
iter: 1  value: 437.4267 mgc: 0.001597765 ustep: 1 
iter: 2  value: 437.4267 mgc: 1.647478e-08 ustep: 1 
mgc: 2.070566e-14 
iter: 1  mgc: 2.070566e-14 
outer mgc:  0.001744869 
iter: 1  value: 437.4268 mgc: 0.001100501 ustep: 1 
iter: 2  value: 437.4268 mgc: 1.777297e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.0007981603 
iter: 1  value: 437.4268 mgc: 0.0002659564 ustep: 1 
iter: 2  mgc: 1.177115e-09 
iter: 1  mgc: 1.177115e-09 
outer mgc:  0.0001513636 
iter: 1  mgc: 1.177115e-09 
iter: 1  mgc: 1.177115e-09 
outer mgc:  0.0001513636 
iter: 1  value: 437.4272 mgc: 0.05470471 ustep: 1 
iter: 2  value: 437.4272 mgc: 7.008442e-06 ustep: 1 
iter: 3  mgc: 2.895462e-13 
outer mgc:  0.1289182 
iter: 1  value: 437.4265 mgc: 0.05469301 ustep: 1 
iter: 2  value: 437.4265 mgc: 7.013058e-06 ustep: 1 
iter: 3  mgc: 2.957634e-13 
outer mgc:  0.1287515 
iter: 1  value: 437.4267 mgc: 0.02963026 ustep: 1 
iter: 2  value: 437.4267 mgc: 1.536463e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.2420177 
iter: 1  value: 437.4271 mgc: 0.02962181 ustep: 1 
iter: 2  value: 437.4271 mgc: 1.536836e-06 ustep: 1 
iter: 3  mgc: 1.654232e-14 
outer mgc:  0.2421317 
iter: 1  value: 437.4264 mgc: 0.05100582 ustep: 1 
iter: 2  value: 437.4264 mgc: 8.527899e-06 ustep: 1 
iter: 3  mgc: 4.356515e-13 
outer mgc:  0.08691154 
iter: 1  value: 437.4273 mgc: 0.05099854 ustep: 1 
iter: 2  value: 437.4273 mgc: 8.537819e-06 ustep: 1 
iter: 3  mgc: 4.463097e-13 
outer mgc:  0.08698587 
iter: 1  value: 437.4265 mgc: 0.02618271 ustep: 1 
iter: 2  value: 437.4265 mgc: 2.412023e-06 ustep: 1 
iter: 3  mgc: 3.98015e-14 
outer mgc:  0.1787644 
iter: 1  value: 437.4273 mgc: 0.02617752 ustep: 1 
iter: 2  value: 437.4273 mgc: 2.412752e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.1790398 
iter: 1  value: 437.4248 mgc: 0.00473396 ustep: 1 
iter: 2  value: 437.4248 mgc: 1.29406e-07 ustep: 1 
mgc: 1.465494e-14 
outer mgc:  0.006397458 
iter: 1  value: 437.4288 mgc: 0.004730976 ustep: 1 
iter: 2  value: 437.4288 mgc: 1.293562e-07 ustep: 1 
mgc: 3.197442e-14 
outer mgc:  0.006407239 
iter: 1  value: 437.4295 mgc: 0.01309128 ustep: 1 
iter: 2  value: 437.4295 mgc: 1.066522e-06 ustep: 1 
iter: 3  mgc: 1.765255e-14 
outer mgc:  0.06353771 
iter: 1  value: 437.4242 mgc: 0.01312309 ustep: 1 
iter: 2  value: 437.4242 mgc: 1.070194e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
outer mgc:  0.06332926 
iter: 1  value: 437.4295 mgc: 0.01257015 ustep: 1 
iter: 2  value: 437.4295 mgc: 2.527606e-06 ustep: 1 
iter: 3  mgc: 1.101341e-13 
outer mgc:  0.06213121 
iter: 1  value: 437.4242 mgc: 0.01260042 ustep: 1 
iter: 2  value: 437.4242 mgc: 2.535059e-06 ustep: 1 
iter: 3  mgc: 1.154632e-13 
outer mgc:  0.06222125 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:43:36 2021]
Finished job 0.
1 of 1 steps (100%) done

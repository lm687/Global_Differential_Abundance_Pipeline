Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:57:29 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2238.971844 
iter  10 value 1992.514072
iter  10 value 1992.514072
final  value 1992.514072 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 618.875 mgc: 27.23676 ustep: 1 
iter: 2  value: 617.8882 mgc: 2.548458 ustep: 1 
iter: 3  value: 617.887 mgc: 0.1096456 ustep: 1 
iter: 4  value: 617.887 mgc: 0.0003698457 ustep: 1 
iter: 5  mgc: 3.674831e-09 
iter: 1  mgc: 3.674831e-09 
Matching hessian patterns... Done
outer mgc:  291.7356 
iter: 1  value: 355.1995 mgc: 25.73291 ustep: 1 
iter: 2  value: 354.9815 mgc: 1.630121 ustep: 1 
iter: 3  value: 354.9815 mgc: 0.01421443 ustep: 1 
iter: 4  value: 354.9815 mgc: 2.795543e-06 ustep: 1 
iter: 5  mgc: 1.154077e-13 
iter: 1  value: 265.7638 mgc: 42.35672 ustep: 1 
iter: 2  value: 264.5282 mgc: 3.159836 ustep: 1 
iter: 3  value: 264.5275 mgc: 0.05655827 ustep: 1 
iter: 4  value: 264.5275 mgc: 5.671534e-05 ustep: 1 
iter: 5  mgc: 7.935863e-11 
iter: 1  mgc: 7.935863e-11 
outer mgc:  118.5988 
iter: 1  value: 195.2065 mgc: 52.33589 ustep: 1 
iter: 2  value: 191.1063 mgc: 8.413657 ustep: 1 
iter: 3  value: 191.106 mgc: 0.1058981 ustep: 1 
iter: 4  value: 191.106 mgc: 6.415995e-05 ustep: 1 
iter: 5  mgc: 2.34415e-11 
iter: 1  mgc: 2.34415e-11 
outer mgc:  97.17442 
iter: 1  value: 203.0382 mgc: 40.81673 ustep: 1 
iter: 2  value: 202.7015 mgc: 1.616037 ustep: 1 
iter: 3  value: 202.7014 mgc: 0.009677102 ustep: 1 
iter: 4  value: 202.7014 mgc: 1.525505e-06 ustep: 1 
iter: 5  mgc: 4.662937e-14 
iter: 1  value: 161.5045 mgc: 37.29269 ustep: 1 
iter: 2  value: 160.0371 mgc: 5.342364 ustep: 1 
iter: 3  value: 160.0365 mgc: 0.0838563 ustep: 1 
iter: 4  value: 160.0365 mgc: 3.90899e-05 ustep: 1 
iter: 5  mgc: 2.454026e-11 
iter: 1  mgc: 2.454026e-11 
outer mgc:  61.65253 
iter: 1  value: 141.9834 mgc: 47.46509 ustep: 1 
iter: 2  value: 130.6533 mgc: 12.27237 ustep: 1 
iter: 3  value: 130.6418 mgc: 0.4954161 ustep: 1 
iter: 4  value: 130.6418 mgc: 0.001139505 ustep: 1 
iter: 5  mgc: 6.016664e-09 
iter: 1  mgc: 6.016664e-09 
outer mgc:  8.711307 
iter: 1  value: 121.6453 mgc: 18.64379 ustep: 1 
iter: 2  value: 121.631 mgc: 0.5715312 ustep: 1 
iter: 3  value: 121.631 mgc: 0.0004837252 ustep: 1 
iter: 4  mgc: 6.311266e-09 
iter: 1  mgc: 6.311266e-09 
outer mgc:  16.34434 
iter: 1  value: 150.6812 mgc: 50.01228 ustep: 1 
iter: 2  value: 150.0455 mgc: 3.869535 ustep: 1 
iter: 3  value: 150.0454 mgc: 0.02511465 ustep: 1 
iter: 4  value: 150.0454 mgc: 8.340339e-06 ustep: 1 
iter: 5  mgc: 5.062617e-13 
iter: 1  value: 118.6581 mgc: 1.276572 ustep: 1 
iter: 2  value: 118.6581 mgc: 0.01205507 ustep: 1 
iter: 3  value: 118.6581 mgc: 1.498343e-06 ustep: 1 
iter: 4  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  13.84285 
iter: 1  value: 118.8588 mgc: 13.59125 ustep: 1 
iter: 2  value: 118.8553 mgc: 0.2430781 ustep: 1 
iter: 3  value: 118.8553 mgc: 0.0001645369 ustep: 1 
iter: 4  mgc: 7.921545e-11 
iter: 1  value: 117.8523 mgc: 6.13892 ustep: 1 
iter: 2  value: 117.8522 mgc: 0.04358502 ustep: 1 
iter: 3  value: 117.8522 mgc: 5.394073e-06 ustep: 1 
iter: 4  mgc: 8.304468e-14 
iter: 1  mgc: 8.304468e-14 
outer mgc:  6.095124 
iter: 1  value: 117.2378 mgc: 2.518387 ustep: 1 
iter: 2  value: 117.2378 mgc: 0.01730222 ustep: 1 
iter: 3  value: 117.2378 mgc: 8.366457e-07 ustep: 1 
iter: 4  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  9.421197 
iter: 1  value: 115.9016 mgc: 8.317565 ustep: 1 
iter: 2  value: 115.9014 mgc: 0.07146065 ustep: 1 
iter: 3  value: 115.9014 mgc: 9.057102e-06 ustep: 1 
iter: 4  mgc: 1.411316e-12 
iter: 1  mgc: 1.411316e-12 
outer mgc:  10.02145 
iter: 1  value: 114.4119 mgc: 5.188397 ustep: 1 
iter: 2  value: 114.4116 mgc: 0.06214964 ustep: 1 
iter: 3  value: 114.4116 mgc: 5.225366e-06 ustep: 1 
iter: 4  mgc: 6.004086e-13 
iter: 1  mgc: 6.004086e-13 
outer mgc:  5.382555 
iter: 1  value: 113.2328 mgc: 5.077418 ustep: 1 
iter: 2  value: 113.2325 mgc: 0.04021892 ustep: 1 
iter: 3  value: 113.2325 mgc: 1.373865e-05 ustep: 1 
iter: 4  mgc: 2.089662e-12 
iter: 1  mgc: 2.089662e-12 
outer mgc:  6.923653 
iter: 1  value: 112.1637 mgc: 4.59569 ustep: 1 
iter: 2  value: 112.1637 mgc: 0.02106769 ustep: 1 
iter: 3  value: 112.1637 mgc: 5.372681e-07 ustep: 1 
iter: 4  mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  5.196729 
iter: 1  value: 111.6335 mgc: 4.232909 ustep: 1 
iter: 2  value: 111.6335 mgc: 0.01257862 ustep: 1 
iter: 3  value: 111.6335 mgc: 3.815261e-07 ustep: 1 
iter: 4  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  4.650797 
iter: 1  value: 111.6299 mgc: 3.035764 ustep: 1 
iter: 2  value: 111.6299 mgc: 0.008315752 ustep: 1 
iter: 3  value: 111.6299 mgc: 1.617197e-07 ustep: 1 
mgc: 2.753353e-14 
iter: 1  value: 111.2587 mgc: 1.316081 ustep: 1 
iter: 2  value: 111.2587 mgc: 0.001639135 ustep: 1 
iter: 3  mgc: 6.468476e-09 
iter: 1  mgc: 6.468476e-09 
outer mgc:  1.284608 
iter: 1  value: 110.9499 mgc: 2.344955 ustep: 1 
iter: 2  value: 110.9499 mgc: 0.005561071 ustep: 1 
iter: 3  value: 110.9499 mgc: 2.324608e-07 ustep: 1 
iter: 4  mgc: 2.942091e-14 
iter: 1  mgc: 2.942091e-14 
outer mgc:  1.313669 
iter: 1  value: 110.746 mgc: 0.9551016 ustep: 1 
iter: 2  value: 110.746 mgc: 0.0005912123 ustep: 1 
iter: 3  mgc: 1.030799e-09 
iter: 1  mgc: 1.030799e-09 
outer mgc:  1.111521 
iter: 1  value: 110.5772 mgc: 1.267498 ustep: 1 
iter: 2  value: 110.5772 mgc: 0.0018422 ustep: 1 
iter: 3  mgc: 6.444078e-09 
iter: 1  mgc: 6.444078e-09 
outer mgc:  4.249211 
iter: 1  value: 110.3569 mgc: 1.243179 ustep: 1 
iter: 2  value: 110.3569 mgc: 0.0003428678 ustep: 1 
iter: 3  mgc: 1.317436e-09 
iter: 1  mgc: 1.317436e-09 
outer mgc:  0.9444166 
iter: 1  value: 110.2287 mgc: 0.7689159 ustep: 1 
iter: 2  value: 110.2287 mgc: 0.0008787174 ustep: 1 
iter: 3  mgc: 3.470384e-10 
iter: 1  value: 110.0441 mgc: 1.003231 ustep: 1 
iter: 2  value: 110.0441 mgc: 0.001598656 ustep: 1 
iter: 3  mgc: 4.379781e-09 
iter: 1  value: 109.82 mgc: 1.937272 ustep: 1 
iter: 2  value: 109.82 mgc: 0.007570254 ustep: 1 
iter: 3  value: 109.82 mgc: 4.559387e-08 ustep: 1 
mgc: 2.808864e-14 
iter: 1  mgc: 2.808864e-14 
outer mgc:  2.181039 
iter: 1  value: 108.5288 mgc: 6.123003 ustep: 1 
iter: 2  value: 108.5287 mgc: 0.03255068 ustep: 1 
iter: 3  value: 108.5287 mgc: 5.103661e-06 ustep: 1 
iter: 4  mgc: 3.03757e-13 
iter: 1  mgc: 3.03757e-13 
outer mgc:  2.667515 
iter: 1  value: 107.157 mgc: 4.249997 ustep: 1 
iter: 2  value: 107.157 mgc: 0.002939166 ustep: 1 
iter: 3  value: 107.157 mgc: 1.629546e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  1.390343 
iter: 1  value: 106.1074 mgc: 3.414278 ustep: 1 
iter: 2  value: 106.1074 mgc: 0.006519114 ustep: 1 
iter: 3  value: 106.1074 mgc: 6.435305e-08 ustep: 1 
iter: 4  mgc: 3.974598e-14 
iter: 1  mgc: 3.974598e-14 
outer mgc:  1.135011 
iter: 1  value: 105.8155 mgc: 1.997202 ustep: 1 
iter: 2  value: 105.8155 mgc: 0.005917751 ustep: 1 
iter: 3  value: 105.8155 mgc: 1.835745e-07 ustep: 1 
iter: 4  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  1.869307 
iter: 1  value: 105.2059 mgc: 4.017338 ustep: 1 
iter: 2  value: 105.2059 mgc: 0.00637116 ustep: 1 
iter: 3  value: 105.2059 mgc: 3.378442e-07 ustep: 1 
iter: 4  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  3.230298 
iter: 1  value: 104.6964 mgc: 2.838081 ustep: 1 
iter: 2  value: 104.6964 mgc: 0.002072931 ustep: 1 
iter: 3  mgc: 4.3583e-09 
iter: 1  mgc: 4.3583e-09 
outer mgc:  0.6520692 
iter: 1  value: 104.513 mgc: 0.4577826 ustep: 1 
iter: 2  value: 104.513 mgc: 8.701497e-05 ustep: 1 
iter: 3  mgc: 1.089295e-11 
iter: 1  value: 104.2172 mgc: 0.7508311 ustep: 1 
iter: 2  value: 104.2172 mgc: 0.0002274667 ustep: 1 
iter: 3  mgc: 8.065129e-11 
iter: 1  mgc: 8.065129e-11 
outer mgc:  0.2763829 
iter: 1  value: 103.3882 mgc: 2.246015 ustep: 1 
iter: 2  value: 103.3882 mgc: 0.0004894709 ustep: 1 
iter: 3  mgc: 9.72662e-11 
iter: 1  mgc: 9.72662e-11 
outer mgc:  0.1694301 
iter: 1  value: 102.6026 mgc: 2.101173 ustep: 1 
iter: 2  value: 102.6026 mgc: 0.0002690396 ustep: 1 
iter: 3  mgc: 7.541878e-11 
iter: 1  mgc: 7.541878e-11 
outer mgc:  0.08712043 
iter: 1  value: 101.8898 mgc: 1.982211 ustep: 1 
iter: 2  value: 101.8898 mgc: 0.0001569381 ustep: 1 
iter: 3  mgc: 3.048228e-11 
iter: 1  mgc: 3.048228e-11 
outer mgc:  0.09361333 
iter: 1  value: 101.2399 mgc: 1.696686 ustep: 1 
iter: 2  value: 101.2399 mgc: 0.0001227615 ustep: 1 
iter: 3  mgc: 4.630962e-12 
iter: 1  mgc: 4.630962e-12 
outer mgc:  0.1099154 
iter: 1  value: 100.8807 mgc: 0.9780144 ustep: 1 
iter: 2  value: 100.8807 mgc: 2.40014e-05 ustep: 1 
iter: 3  mgc: 9.627854e-13 
iter: 1  mgc: 9.627854e-13 
outer mgc:  0.009469864 
iter: 1  value: 100.7098 mgc: 0.4391089 ustep: 1 
iter: 2  value: 100.7098 mgc: 6.346955e-06 ustep: 1 
iter: 3  mgc: 8.615331e-14 
iter: 1  mgc: 8.615331e-14 
outer mgc:  0.001498808 
iter: 1  value: 100.6604 mgc: 0.1249744 ustep: 1 
iter: 2  value: 100.6604 mgc: 4.838124e-07 ustep: 1 
mgc: 4.796163e-14 
iter: 1  mgc: 4.796163e-14 
outer mgc:  0.0005166869 
iter: 1  value: 100.6552 mgc: 0.01325427 ustep: 1 
iter: 2  mgc: 4.253268e-09 
iter: 1  mgc: 4.253268e-09 
outer mgc:  9.083692e-05 
iter: 1  value: 100.6551 mgc: 0.0003765809 ustep: 1 
iter: 2  mgc: 1.131362e-11 
iter: 1  mgc: 1.131362e-11 
outer mgc:  2.260877e-05 
iter: 1  mgc: 1.131362e-11 
iter: 1  mgc: 1.131362e-11 
outer mgc:  2.260877e-05 
iter: 1  value: 100.6552 mgc: 0.05755328 ustep: 1 
iter: 2  value: 100.6552 mgc: 1.782748e-06 ustep: 1 
iter: 3  mgc: 2.016165e-13 
outer mgc:  0.3310648 
iter: 1  value: 100.6553 mgc: 0.05755063 ustep: 1 
iter: 2  value: 100.6553 mgc: 1.783123e-06 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  0.3310736 
iter: 1  value: 100.6553 mgc: 0.02824755 ustep: 1 
iter: 2  value: 100.6553 mgc: 2.092118e-07 ustep: 1 
iter: 3  mgc: 1.216804e-13 
outer mgc:  0.2302712 
iter: 1  value: 100.655 mgc: 0.02824728 ustep: 1 
iter: 2  value: 100.655 mgc: 2.092911e-07 ustep: 1 
iter: 3  mgc: 5.062617e-14 
outer mgc:  0.230231 
iter: 1  value: 100.6556 mgc: 0.04647785 ustep: 1 
iter: 2  value: 100.6556 mgc: 3.969727e-07 ustep: 1 
iter: 3  mgc: 8.371082e-14 
outer mgc:  0.3615453 
iter: 1  value: 100.6549 mgc: 0.04646234 ustep: 1 
iter: 2  value: 100.6549 mgc: 3.966298e-07 ustep: 1 
iter: 3  mgc: 1.277867e-13 
outer mgc:  0.3614871 
iter: 1  value: 100.6555 mgc: 0.02760069 ustep: 1 
iter: 2  value: 100.6555 mgc: 8.516285e-08 ustep: 1 
mgc: 9.503509e-14 
outer mgc:  0.2310104 
iter: 1  value: 100.6549 mgc: 0.0275965 ustep: 1 
iter: 2  value: 100.6549 mgc: 8.518079e-08 ustep: 1 
mgc: 1.101341e-13 
outer mgc:  0.2310213 
iter: 1  value: 100.6541 mgc: 0.00256807 ustep: 1 
iter: 2  mgc: 1.811191e-10 
outer mgc:  6.403053e-05 
iter: 1  value: 100.6561 mgc: 0.002567787 ustep: 1 
iter: 2  mgc: 1.81215e-10 
outer mgc:  6.110128e-05 
iter: 1  value: 100.6583 mgc: 0.4497841 ustep: 1 
iter: 2  value: 100.6583 mgc: 3.796883e-06 ustep: 1 
iter: 3  mgc: 2.007838e-13 
outer mgc:  0.06162076 
iter: 1  value: 100.6519 mgc: 0.4502341 ustep: 1 
iter: 2  value: 100.6519 mgc: 3.790021e-06 ustep: 1 
iter: 3  mgc: 7.01661e-14 
outer mgc:  0.0616216 
iter: 1  value: 100.6626 mgc: 0.4595197 ustep: 1 
iter: 2  value: 100.6626 mgc: 5.700114e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.05477352 
iter: 1  value: 100.6476 mgc: 0.4608901 ustep: 1 
iter: 2  value: 100.6476 mgc: 5.702272e-06 ustep: 1 
iter: 3  mgc: 5.967449e-14 
outer mgc:  0.05472019 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:57:31 2021]
Finished job 0.
1 of 1 steps (100%) done

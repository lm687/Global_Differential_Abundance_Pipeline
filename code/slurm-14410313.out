Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:10:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21937.090180 
final  value 19004.726254 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5016.188 mgc: 87.88429 ustep: 1 
iter: 2  value: 4873.016 mgc: 14.60633 ustep: 1 
iter: 3  value: 4871.586 mgc: 2.689527 ustep: 1 
iter: 4  value: 4871.583 mgc: 0.2098204 ustep: 1 
iter: 5  value: 4871.583 mgc: 0.001620897 ustep: 1 
iter: 6  value: 4871.583 mgc: 9.898418e-08 ustep: 1 
mgc: 4.490852e-14 
iter: 1  mgc: 4.490852e-14 
Matching hessian patterns... Done
outer mgc:  2154.703 
iter: 1  value: 3198.175 mgc: 28.65846 ustep: 1 
iter: 2  value: 3186.756 mgc: 4.384939 ustep: 1 
iter: 3  value: 3186.743 mgc: 0.1806093 ustep: 1 
iter: 4  value: 3186.743 mgc: 0.0006391289 ustep: 1 
iter: 5  mgc: 7.708634e-09 
iter: 1  value: 2481.9 mgc: 33.56541 ustep: 1 
iter: 2  value: 2468.896 mgc: 3.586147 ustep: 1 
iter: 3  value: 2468.885 mgc: 0.1678248 ustep: 1 
iter: 4  value: 2468.885 mgc: 0.0005293183 ustep: 1 
iter: 5  mgc: 4.98485e-09 
iter: 1  mgc: 4.98485e-09 
outer mgc:  934.0042 
iter: 1  value: 2005.325 mgc: 44.60702 ustep: 1 
iter: 2  value: 1985.238 mgc: 4.656519 ustep: 1 
iter: 3  value: 1985.212 mgc: 0.2578047 ustep: 1 
iter: 4  value: 1985.212 mgc: 0.0009817761 ustep: 1 
iter: 5  value: 1985.212 mgc: 1.444185e-08 ustep: 1 
mgc: 4.019007e-14 
iter: 1  mgc: 4.019007e-14 
outer mgc:  1088.797 
iter: 1  value: 3088.984 mgc: 61.47268 ustep: 1 
iter: 2  value: 1942.463 mgc: 47.2355 ustep: 1 
iter: 3  value: 1921.577 mgc: 5.890957 ustep: 1 
iter: 4  value: 1921.543 mgc: 0.3943047 ustep: 1 
iter: 5  value: 1921.543 mgc: 0.002221435 ustep: 1 
iter: 6  value: 1921.543 mgc: 7.182655e-08 ustep: 1 
mgc: 3.663736e-14 
iter: 1  mgc: 3.663736e-14 
outer mgc:  1008.303 
iter: 1  value: 1372.005 mgc: 36.64681 ustep: 1 
iter: 2  value: 1366.947 mgc: 4.70081 ustep: 1 
iter: 3  value: 1366.947 mgc: 0.04780439 ustep: 1 
iter: 4  value: 1366.947 mgc: 5.308382e-06 ustep: 1 
iter: 5  mgc: 1.20487e-13 
iter: 1  mgc: 1.20487e-13 
outer mgc:  173.401 
iter: 1  value: 1528.158 mgc: 36.83611 ustep: 1 
iter: 2  value: 1415.511 mgc: 13.62928 ustep: 1 
iter: 3  value: 1415.124 mgc: 0.8446386 ustep: 1 
iter: 4  value: 1415.124 mgc: 0.004842731 ustep: 1 
iter: 5  value: 1415.124 mgc: 2.096865e-07 ustep: 1 
iter: 6  mgc: 3.153033e-14 
iter: 1  value: 1309.392 mgc: 18.33805 ustep: 1 
iter: 2  value: 1306.737 mgc: 1.993092 ustep: 1 
iter: 3  value: 1306.737 mgc: 0.0233993 ustep: 1 
iter: 4  value: 1306.737 mgc: 3.684255e-06 ustep: 1 
iter: 5  mgc: 1.141309e-13 
iter: 1  mgc: 1.141309e-13 
outer mgc:  166.0061 
iter: 1  value: 1361.252 mgc: 20.5571 ustep: 1 
iter: 2  value: 1360.706 mgc: 0.8842952 ustep: 1 
iter: 3  value: 1360.706 mgc: 0.004501524 ustep: 1 
iter: 4  value: 1360.706 mgc: 1.211634e-07 ustep: 1 
mgc: 2.842171e-14 
iter: 1  value: 1289.719 mgc: 5.990161 ustep: 1 
iter: 2  value: 1289.714 mgc: 0.09077443 ustep: 1 
iter: 3  value: 1289.714 mgc: 5.197921e-05 ustep: 1 
iter: 4  mgc: 1.71872e-11 
iter: 1  mgc: 1.71872e-11 
outer mgc:  55.70575 
iter: 1  value: 1279.5 mgc: 2.095026 ustep: 1 
iter: 2  value: 1279.5 mgc: 0.02652259 ustep: 1 
iter: 3  value: 1279.5 mgc: 8.710968e-06 ustep: 1 
iter: 4  mgc: 9.583445e-13 
iter: 1  mgc: 9.583445e-13 
outer mgc:  51.06478 
iter: 1  value: 1283.219 mgc: 10.36675 ustep: 1 
iter: 2  value: 1283.195 mgc: 0.2035392 ustep: 1 
iter: 3  value: 1283.195 mgc: 0.0002214884 ustep: 1 
iter: 4  mgc: 2.680078e-10 
iter: 1  value: 1273.596 mgc: 3.736742 ustep: 1 
iter: 2  value: 1273.596 mgc: 0.03167773 ustep: 1 
iter: 3  value: 1273.596 mgc: 5.843233e-06 ustep: 1 
iter: 4  mgc: 2.130483e-13 
iter: 1  mgc: 2.130483e-13 
outer mgc:  42.72309 
iter: 1  value: 1269.518 mgc: 3.45653 ustep: 1 
iter: 2  value: 1269.517 mgc: 0.04554471 ustep: 1 
iter: 3  value: 1269.517 mgc: 1.424097e-05 ustep: 1 
iter: 4  mgc: 2.073897e-12 
iter: 1  mgc: 2.073897e-12 
outer mgc:  50.12599 
iter: 1  value: 1258.733 mgc: 3.94549 ustep: 1 
iter: 2  value: 1258.732 mgc: 0.0316441 ustep: 1 
iter: 3  value: 1258.732 mgc: 7.177746e-06 ustep: 1 
iter: 4  mgc: 5.808687e-13 
iter: 1  mgc: 5.808687e-13 
outer mgc:  38.8317 
iter: 1  value: 1257.369 mgc: 3.181242 ustep: 1 
iter: 2  value: 1257.369 mgc: 0.04336274 ustep: 1 
iter: 3  value: 1257.369 mgc: 2.377238e-05 ustep: 1 
iter: 4  mgc: 6.800782e-12 
iter: 1  mgc: 6.800782e-12 
outer mgc:  43.43504 
iter: 1  value: 1252.584 mgc: 2.511729 ustep: 1 
iter: 2  value: 1252.584 mgc: 0.03911041 ustep: 1 
iter: 3  value: 1252.584 mgc: 1.723044e-05 ustep: 1 
iter: 4  mgc: 3.177014e-12 
iter: 1  mgc: 3.177014e-12 
outer mgc:  14.3512 
iter: 1  value: 1252.73 mgc: 5.295501 ustep: 1 
iter: 2  value: 1252.728 mgc: 0.06573646 ustep: 1 
iter: 3  value: 1252.728 mgc: 1.570413e-05 ustep: 1 
iter: 4  mgc: 9.970913e-13 
iter: 1  value: 1251.617 mgc: 1.286135 ustep: 1 
iter: 2  value: 1251.617 mgc: 0.004290956 ustep: 1 
iter: 3  value: 1251.617 mgc: 6.896204e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  14.09365 
iter: 1  value: 1251.2 mgc: 0.96636 ustep: 1 
iter: 2  value: 1251.2 mgc: 0.002377512 ustep: 1 
iter: 3  value: 1251.2 mgc: 3.447273e-08 ustep: 1 
mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  15.45539 
iter: 1  value: 1249.711 mgc: 1.181082 ustep: 1 
iter: 2  value: 1249.711 mgc: 0.003916319 ustep: 1 
iter: 3  value: 1249.711 mgc: 7.272243e-08 ustep: 1 
mgc: 2.925438e-14 
iter: 1  mgc: 2.925438e-14 
outer mgc:  12.57246 
iter: 1  value: 1247.92 mgc: 1.30623 ustep: 1 
iter: 2  value: 1247.92 mgc: 0.004735342 ustep: 1 
iter: 3  value: 1247.92 mgc: 1.617763e-07 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  16.17736 
iter: 1  value: 1246.79 mgc: 3.456357 ustep: 1 
iter: 2  value: 1246.79 mgc: 0.02765961 ustep: 1 
iter: 3  value: 1246.79 mgc: 1.249715e-05 ustep: 1 
iter: 4  mgc: 2.561507e-12 
iter: 1  mgc: 2.561507e-12 
outer mgc:  23.13808 
iter: 1  value: 1244.979 mgc: 3.205876 ustep: 1 
iter: 2  value: 1244.979 mgc: 0.02174757 ustep: 1 
iter: 3  value: 1244.979 mgc: 1.490072e-06 ustep: 1 
iter: 4  mgc: 4.726775e-14 
iter: 1  mgc: 4.726775e-14 
outer mgc:  18.535 
iter: 1  value: 1243.133 mgc: 2.046758 ustep: 1 
iter: 2  value: 1243.133 mgc: 0.02342464 ustep: 1 
iter: 3  value: 1243.133 mgc: 2.733538e-06 ustep: 1 
iter: 4  mgc: 1.429967e-13 
iter: 1  mgc: 1.429967e-13 
outer mgc:  22.31458 
iter: 1  value: 1242.246 mgc: 2.424194 ustep: 1 
iter: 2  value: 1242.246 mgc: 0.0065512 ustep: 1 
iter: 3  value: 1242.246 mgc: 1.845105e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  value: 1242.672 mgc: 1.446586 ustep: 1 
iter: 2  value: 1242.672 mgc: 0.003185226 ustep: 1 
iter: 3  value: 1242.672 mgc: 4.059299e-08 ustep: 1 
mgc: 3.597123e-14 
iter: 1  value: 1242.631 mgc: 0.5831312 ustep: 1 
iter: 2  value: 1242.631 mgc: 0.0005529309 ustep: 1 
iter: 3  mgc: 1.235363e-09 
iter: 1  mgc: 1.235363e-09 
outer mgc:  11.04691 
iter: 1  value: 1242.527 mgc: 0.8070172 ustep: 1 
iter: 2  value: 1242.527 mgc: 0.001843996 ustep: 1 
iter: 3  value: 1242.527 mgc: 1.551475e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  11.91567 
iter: 1  value: 1242.117 mgc: 0.6709375 ustep: 1 
iter: 2  value: 1242.117 mgc: 0.0005040539 ustep: 1 
iter: 3  mgc: 7.084308e-10 
iter: 1  mgc: 7.084308e-10 
outer mgc:  6.458969 
iter: 1  value: 1241.672 mgc: 0.3766017 ustep: 1 
iter: 2  value: 1241.672 mgc: 0.0007767463 ustep: 1 
iter: 3  mgc: 3.55577e-09 
iter: 1  mgc: 3.55577e-09 
outer mgc:  8.49476 
iter: 1  value: 1241.097 mgc: 0.5828974 ustep: 1 
iter: 2  value: 1241.097 mgc: 0.001222974 ustep: 1 
iter: 3  mgc: 6.671534e-09 
iter: 1  mgc: 6.671534e-09 
outer mgc:  7.004827 
iter: 1  value: 1239.875 mgc: 1.193748 ustep: 1 
iter: 2  value: 1239.875 mgc: 0.002121676 ustep: 1 
iter: 3  value: 1239.875 mgc: 4.66313e-08 ustep: 1 
iter: 4  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  9.349053 
iter: 1  value: 1238.31 mgc: 1.154839 ustep: 1 
iter: 2  value: 1238.31 mgc: 0.004943581 ustep: 1 
iter: 3  value: 1238.31 mgc: 1.31823e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  3.871366 
iter: 1  value: 1238.498 mgc: 0.786213 ustep: 1 
iter: 2  value: 1238.498 mgc: 0.001955341 ustep: 1 
iter: 3  value: 1238.498 mgc: 1.63196e-08 ustep: 1 
mgc: 2.978173e-14 
iter: 1  mgc: 2.978173e-14 
outer mgc:  16.95615 
iter: 1  value: 1238.244 mgc: 0.9872872 ustep: 1 
iter: 2  value: 1238.244 mgc: 0.001479156 ustep: 1 
iter: 3  mgc: 7.125251e-09 
iter: 1  mgc: 7.125251e-09 
outer mgc:  12.31721 
iter: 1  value: 1237.018 mgc: 0.5599462 ustep: 1 
iter: 2  value: 1237.018 mgc: 0.001380373 ustep: 1 
iter: 3  mgc: 9.796068e-09 
iter: 1  mgc: 9.796068e-09 
outer mgc:  8.29791 
iter: 1  value: 1235.577 mgc: 1.297612 ustep: 1 
iter: 2  value: 1235.577 mgc: 0.001948279 ustep: 1 
iter: 3  value: 1235.577 mgc: 4.120363e-08 ustep: 1 
iter: 4  mgc: 3.974598e-14 
iter: 1  mgc: 3.974598e-14 
outer mgc:  8.881382 
iter: 1  value: 1234.877 mgc: 0.5145499 ustep: 1 
iter: 2  value: 1234.877 mgc: 0.0005154718 ustep: 1 
iter: 3  mgc: 8.102097e-10 
iter: 1  value: 1234.123 mgc: 0.5528592 ustep: 1 
iter: 2  value: 1234.123 mgc: 0.0007086705 ustep: 1 
iter: 3  mgc: 3.41062e-09 
iter: 1  mgc: 3.41062e-09 
outer mgc:  8.457203 
iter: 1  value: 1232.134 mgc: 1.128877 ustep: 1 
iter: 2  value: 1232.134 mgc: 0.001776059 ustep: 1 
iter: 3  value: 1232.134 mgc: 1.338566e-08 ustep: 1 
mgc: 3.642919e-14 
iter: 1  mgc: 3.642919e-14 
outer mgc:  4.580599 
iter: 1  value: 1231.923 mgc: 0.4133207 ustep: 1 
iter: 2  value: 1231.923 mgc: 0.0006034156 ustep: 1 
iter: 3  mgc: 8.416734e-10 
iter: 1  mgc: 8.416734e-10 
outer mgc:  2.856392 
iter: 1  value: 1230.904 mgc: 0.6218796 ustep: 1 
iter: 2  value: 1230.904 mgc: 0.0009874831 ustep: 1 
iter: 3  mgc: 2.875154e-09 
iter: 1  mgc: 2.875154e-09 
outer mgc:  2.196463 
iter: 1  value: 1231.373 mgc: 0.2560156 ustep: 1 
iter: 2  value: 1231.373 mgc: 0.0001085468 ustep: 1 
iter: 3  mgc: 1.255627e-10 
iter: 1  mgc: 1.255627e-10 
outer mgc:  2.389231 
iter: 1  value: 1231.58 mgc: 0.1053391 ustep: 1 
iter: 2  value: 1231.58 mgc: 4.315031e-05 ustep: 1 
iter: 3  mgc: 1.088019e-11 
iter: 1  mgc: 1.088019e-11 
outer mgc:  0.9003922 
iter: 1  value: 1231.335 mgc: 0.1172992 ustep: 1 
iter: 2  value: 1231.335 mgc: 4.005893e-05 ustep: 1 
iter: 3  mgc: 6.583178e-12 
iter: 1  mgc: 6.583178e-12 
outer mgc:  0.2912843 
iter: 1  value: 1231.381 mgc: 0.0258067 ustep: 1 
iter: 2  value: 1231.381 mgc: 1.531807e-06 ustep: 1 
iter: 3  mgc: 3.221035e-14 
iter: 1  mgc: 3.221035e-14 
outer mgc:  0.04879361 
iter: 1  value: 1231.379 mgc: 0.001684165 ustep: 1 
iter: 2  mgc: 9.952387e-09 
iter: 1  mgc: 9.952387e-09 
outer mgc:  0.002224819 
iter: 1  value: 1231.379 mgc: 0.0005236928 ustep: 1 
iter: 2  mgc: 1.419519e-09 
iter: 1  mgc: 1.419519e-09 
outer mgc:  0.001543235 
iter: 1  mgc: 1.419519e-09 
iter: 1  mgc: 1.419519e-09 
outer mgc:  0.001543235 
iter: 1  value: 1231.386 mgc: 0.05129369 ustep: 1 
iter: 2  value: 1231.386 mgc: 2.709907e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  1.282742 
iter: 1  value: 1231.373 mgc: 0.05130048 ustep: 1 
iter: 2  value: 1231.373 mgc: 2.704588e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  1.281868 
iter: 1  value: 1231.389 mgc: 0.02783935 ustep: 1 
iter: 2  value: 1231.389 mgc: 6.88203e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  1.38773 
iter: 1  value: 1231.37 mgc: 0.02784358 ustep: 1 
iter: 2  value: 1231.37 mgc: 6.901181e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  1.384922 
iter: 1  value: 1231.374 mgc: 0.04291037 ustep: 1 
iter: 2  value: 1231.374 mgc: 4.283697e-06 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  1.189901 
iter: 1  value: 1231.385 mgc: 0.0428942 ustep: 1 
iter: 2  value: 1231.385 mgc: 4.286155e-06 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  1.187777 
iter: 1  value: 1231.376 mgc: 0.01769392 ustep: 1 
iter: 2  value: 1231.376 mgc: 9.091022e-07 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.955389 
iter: 1  value: 1231.383 mgc: 0.01768425 ustep: 1 
iter: 2  value: 1231.383 mgc: 9.084302e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.9554885 
iter: 1  value: 1231.365 mgc: 0.006613316 ustep: 1 
iter: 2  value: 1231.365 mgc: 1.487371e-07 ustep: 1 
mgc: 3.108624e-14 
outer mgc:  0.01173933 
iter: 1  value: 1231.393 mgc: 0.006611088 ustep: 1 
iter: 2  value: 1231.393 mgc: 1.488164e-07 ustep: 1 
mgc: 3.108624e-14 
outer mgc:  0.01088628 
iter: 1  value: 1231.399 mgc: 0.03338477 ustep: 1 
iter: 2  value: 1231.399 mgc: 2.233126e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.5757824 
iter: 1  value: 1231.36 mgc: 0.03348269 ustep: 1 
iter: 2  value: 1231.36 mgc: 2.234573e-06 ustep: 1 
iter: 3  mgc: 3.053113e-14 
outer mgc:  0.5773605 
iter: 1  value: 1231.413 mgc: 0.03675343 ustep: 1 
iter: 2  value: 1231.413 mgc: 5.904611e-06 ustep: 1 
iter: 3  mgc: 1.918465e-13 
outer mgc:  0.5334632 
iter: 1  value: 1231.345 mgc: 0.03685069 ustep: 1 
iter: 2  value: 1231.345 mgc: 5.913516e-06 ustep: 1 
iter: 3  mgc: 1.89182e-13 
outer mgc:  0.532206 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:10:59 2021]
Finished job 0.
1 of 1 steps (100%) done

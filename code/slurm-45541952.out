Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 02:06:03 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10855.388024 
iter  10 value 6648.408095
iter  10 value 6648.408089
final  value 6648.408089 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 11493.31 mgc: 147.0299 ustep: 1 
iter: 2  value: 10646 mgc: 115.3692 ustep: 0.1336527 
iter: 3  value: 9766.814 mgc: 105.6717 ustep: 0.1075309 
iter: 4  value: 8577.16 mgc: 107.2536 ustep: 0.09457213 
iter: 5  value: 7705.886 mgc: 96.20979 ustep: 0.08778208 
iter: 6  value: 7458.815 mgc: 86.4081 ustep: 0.2963508 
iter: 7  value: 7445.02 mgc: 85.14897 ustep: 0.3250058 
iter: 8  value: 7440.073 mgc: 89.56704 ustep: 0.1902435 
iter: 9  value: 7380.028 mgc: 87.62926 ustep: 0.1334567 
iter: 10  value: 7326.735 mgc: 77.06398 ustep: 0.3653808 
iter: 11  value: 7292.428 mgc: 54.38327 ustep: 0.6045069 
iter: 12  value: 7290.221 mgc: 14.40013 ustep: 0.7775227 
iter: 13  value: 7290.221 mgc: 0.1034617 ustep: 0.8817843 
iter: 14  value: 7290.221 mgc: 0.001186517 ustep: 0.9390398 
iter: 15  value: 7290.221 mgc: 9.969689e-06 ustep: 0.9690438 
iter: 16  value: 7290.221 mgc: 4.148308e-08 ustep: 0.9844018 
mgc: 8.571677e-11 
iter: 1  mgc: 8.571677e-11 
Matching hessian patterns... Done
outer mgc:  2254.899 
iter: 1  value: 5070.342 mgc: 32.18343 ustep: 1 
iter: 2  value: 4954.379 mgc: 19.39085 ustep: 1 
iter: 3  value: 4952.544 mgc: 2.321088 ustep: 1 
iter: 4  value: 4952.541 mgc: 0.1023389 ustep: 1 
iter: 5  value: 4952.541 mgc: 0.0007415766 ustep: 1 
iter: 6  value: 4952.541 mgc: 3.976394e-08 ustep: 1 
mgc: 3.4861e-14 
iter: 1  value: 1737.081 mgc: 60.73878 ustep: 0.1336527 
iter: 2  value: 1091.938 mgc: 73.99435 ustep: 0.3656489 
iter: 3  value: 1080.679 mgc: 7.407015 ustep: 0.6047286 
iter: 4  value: 1080.623 mgc: 0.5339268 ustep: 0.7776652 
iter: 5  value: 1080.623 mgc: 0.01148654 ustep: 0.8818651 
iter: 6  value: 1080.623 mgc: 0.0005797815 ustep: 0.9390828 
iter: 7  value: 1080.623 mgc: 1.490911e-05 ustep: 0.969066 
iter: 8  value: 1080.623 mgc: 1.915864e-07 ustep: 0.984413 
iter: 9  mgc: 1.229137e-09 
iter: 1  mgc: 1.229137e-09 
outer mgc:  402.0365 
iter: 1  value: 1206.448 mgc: 351.6939 ustep: 1 
iter: 2  value: 1186.532 mgc: 27.20682 ustep: 1 
iter: 3  value: 1186.53 mgc: 0.2607235 ustep: 1 
iter: 4  value: 1186.53 mgc: 4.038129e-05 ustep: 1 
iter: 5  mgc: 1.318057e-12 
iter: 1  value: 781.422 mgc: 13.67596 ustep: 1 
iter: 2  value: 780.3953 mgc: 2.191704 ustep: 1 
iter: 3  value: 780.39 mgc: 0.2181256 ustep: 1 
iter: 4  value: 780.39 mgc: 0.00276127 ustep: 1 
iter: 5  value: 780.39 mgc: 4.562772e-07 ustep: 1 
iter: 6  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  75.98211 
iter: 1  value: 1009.219 mgc: 26.82091 ustep: 1 
iter: 2  value: 990.7164 mgc: 7.002658 ustep: 1 
iter: 3  value: 990.6727 mgc: 0.4083779 ustep: 1 
iter: 4  value: 990.6727 mgc: 0.002883518 ustep: 1 
iter: 5  value: 990.6727 mgc: 1.47999e-07 ustep: 1 
iter: 6  mgc: 4.477321e-14 
iter: 1  value: 766.1034 mgc: 5.494453 ustep: 1 
iter: 2  value: 766.0956 mgc: 0.1517879 ustep: 1 
iter: 3  value: 766.0956 mgc: 0.0001801995 ustep: 1 
iter: 4  mgc: 5.29617e-10 
iter: 1  mgc: 5.29617e-10 
outer mgc:  28.48797 
iter: 1  value: 757.2462 mgc: 4.247407 ustep: 1 
iter: 2  value: 757.2443 mgc: 0.08615203 ustep: 1 
iter: 3  value: 757.2443 mgc: 0.0001196419 ustep: 1 
iter: 4  mgc: 2.135032e-10 
iter: 1  mgc: 2.135032e-10 
outer mgc:  18.11982 
iter: 1  value: 756.3986 mgc: 6.210054 ustep: 1 
iter: 2  value: 756.3742 mgc: 0.2387504 ustep: 1 
iter: 3  value: 756.3742 mgc: 0.000532399 ustep: 1 
iter: 4  mgc: 4.79051e-09 
iter: 1  mgc: 4.79051e-09 
outer mgc:  26.29634 
iter: 1  value: 748.6219 mgc: 5.473463 ustep: 1 
iter: 2  value: 748.5991 mgc: 0.1924679 ustep: 1 
iter: 3  value: 748.5991 mgc: 0.001219105 ustep: 1 
iter: 4  value: 748.5991 mgc: 9.747493e-08 ustep: 1 
iter: 5  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  16.5376 
iter: 1  value: 748.0912 mgc: 4.491572 ustep: 1 
iter: 2  value: 748.0792 mgc: 0.1585589 ustep: 1 
iter: 3  value: 748.0792 mgc: 0.0004466154 ustep: 1 
iter: 4  mgc: 4.12844e-09 
iter: 1  mgc: 4.12844e-09 
outer mgc:  25.03947 
iter: 1  value: 743.2825 mgc: 5.04775 ustep: 1 
iter: 2  value: 743.2761 mgc: 0.1124402 ustep: 1 
iter: 3  value: 743.2761 mgc: 0.0001167012 ustep: 1 
iter: 4  mgc: 6.317431e-10 
iter: 1  mgc: 6.317431e-10 
outer mgc:  12.31099 
iter: 1  value: 745.596 mgc: 7.665449 ustep: 1 
iter: 2  value: 745.5051 mgc: 0.443452 ustep: 1 
iter: 3  value: 745.505 mgc: 0.00334268 ustep: 1 
iter: 4  value: 745.505 mgc: 2.808356e-07 ustep: 1 
iter: 5  mgc: 4.041212e-14 
iter: 1  value: 743.1317 mgc: 2.283652 ustep: 1 
iter: 2  value: 743.1311 mgc: 0.04160715 ustep: 1 
iter: 3  value: 743.1311 mgc: 4.52594e-05 ustep: 1 
iter: 4  mgc: 1.221994e-10 
iter: 1  mgc: 1.221994e-10 
outer mgc:  5.721526 
iter: 1  value: 743.0678 mgc: 1.759471 ustep: 1 
iter: 2  value: 743.0676 mgc: 0.0134656 ustep: 1 
iter: 3  value: 743.0676 mgc: 3.873374e-06 ustep: 1 
iter: 4  mgc: 5.939693e-13 
iter: 1  mgc: 5.939693e-13 
outer mgc:  9.408692 
iter: 1  value: 742.9201 mgc: 1.70494 ustep: 1 
iter: 2  value: 742.92 mgc: 0.0213142 ustep: 1 
iter: 3  value: 742.92 mgc: 8.048996e-06 ustep: 1 
iter: 4  mgc: 1.38467e-12 
iter: 1  mgc: 1.38467e-12 
outer mgc:  5.54334 
iter: 1  value: 742.693 mgc: 2.201413 ustep: 1 
iter: 2  value: 742.6916 mgc: 0.04013522 ustep: 1 
iter: 3  value: 742.6916 mgc: 7.52546e-05 ustep: 1 
iter: 4  mgc: 3.436682e-10 
iter: 1  value: 742.5668 mgc: 0.4827837 ustep: 1 
iter: 2  value: 742.5668 mgc: 0.001337413 ustep: 1 
iter: 3  value: 742.5668 mgc: 1.304532e-08 ustep: 1 
mgc: 2.853273e-14 
iter: 1  mgc: 2.853273e-14 
outer mgc:  1.386097 
iter: 1  value: 742.6485 mgc: 0.8661205 ustep: 1 
iter: 2  value: 742.6485 mgc: 0.004735807 ustep: 1 
iter: 3  value: 742.6485 mgc: 7.36099e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 742.5766 mgc: 0.2249943 ustep: 1 
iter: 2  value: 742.5766 mgc: 0.0003469586 ustep: 1 
iter: 3  mgc: 4.978084e-09 
iter: 1  mgc: 4.978084e-09 
outer mgc:  0.9125151 
iter: 1  value: 742.5269 mgc: 0.1139134 ustep: 1 
iter: 2  value: 742.5269 mgc: 0.000172236 ustep: 1 
iter: 3  mgc: 5.204321e-10 
iter: 1  mgc: 5.204321e-10 
outer mgc:  0.8860792 
iter: 1  value: 742.5757 mgc: 0.2472386 ustep: 1 
iter: 2  value: 742.5757 mgc: 0.0002534544 ustep: 1 
iter: 3  mgc: 5.531073e-10 
iter: 1  mgc: 5.531073e-10 
outer mgc:  0.5104269 
iter: 1  value: 742.5724 mgc: 0.3635884 ustep: 1 
iter: 2  value: 742.5724 mgc: 0.0007411279 ustep: 1 
iter: 3  mgc: 7.51023e-09 
iter: 1  value: 742.5536 mgc: 0.1249467 ustep: 1 
iter: 2  value: 742.5536 mgc: 0.0001099946 ustep: 1 
iter: 3  mgc: 2.01088e-10 
iter: 1  mgc: 2.01088e-10 
outer mgc:  0.2319241 
iter: 1  value: 742.567 mgc: 0.07987639 ustep: 1 
iter: 2  value: 742.567 mgc: 4.152112e-05 ustep: 1 
iter: 3  mgc: 2.89504e-11 
iter: 1  value: 742.5594 mgc: 0.02969504 ustep: 1 
iter: 2  value: 742.5594 mgc: 5.947185e-06 ustep: 1 
iter: 3  mgc: 5.988543e-13 
iter: 1  mgc: 5.988543e-13 
outer mgc:  0.2067975 
iter: 1  value: 742.5546 mgc: 0.05244846 ustep: 1 
iter: 2  value: 742.5546 mgc: 1.164664e-05 ustep: 1 
iter: 3  mgc: 1.36513e-12 
iter: 1  mgc: 1.36513e-12 
outer mgc:  0.1730447 
iter: 1  value: 742.561 mgc: 0.07328227 ustep: 1 
iter: 2  value: 742.561 mgc: 3.043561e-05 ustep: 1 
iter: 3  mgc: 1.615263e-11 
iter: 1  mgc: 1.615263e-11 
outer mgc:  0.09087989 
iter: 1  value: 742.5529 mgc: 0.01856712 ustep: 1 
iter: 2  value: 742.5529 mgc: 1.398263e-06 ustep: 1 
iter: 3  mgc: 3.483325e-14 
iter: 1  mgc: 3.483325e-14 
outer mgc:  0.05268038 
iter: 1  value: 742.563 mgc: 0.02367354 ustep: 1 
iter: 2  value: 742.563 mgc: 3.819066e-06 ustep: 1 
iter: 3  mgc: 6.861178e-13 
iter: 1  mgc: 6.861178e-13 
outer mgc:  0.04743445 
iter: 1  value: 742.5594 mgc: 0.03073511 ustep: 1 
iter: 2  value: 742.5594 mgc: 5.325503e-06 ustep: 1 
iter: 3  mgc: 7.358558e-13 
iter: 1  mgc: 7.358558e-13 
outer mgc:  0.06784512 
iter: 1  value: 742.5576 mgc: 0.02328168 ustep: 1 
iter: 2  value: 742.5576 mgc: 2.204328e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
iter: 1  mgc: 5.506706e-14 
outer mgc:  0.04547725 
iter: 1  value: 742.5606 mgc: 0.01268247 ustep: 1 
iter: 2  value: 742.5606 mgc: 1.388635e-06 ustep: 1 
iter: 3  mgc: 7.860379e-14 
iter: 1  value: 742.5599 mgc: 0.003698873 ustep: 1 
iter: 2  value: 742.5599 mgc: 1.275694e-07 ustep: 1 
iter: 3  mgc: 3.530509e-14 
iter: 1  mgc: 3.530509e-14 
outer mgc:  0.027857 
iter: 1  value: 742.5606 mgc: 0.008692314 ustep: 1 
iter: 2  value: 742.5606 mgc: 4.358937e-07 ustep: 1 
iter: 3  mgc: 3.724798e-14 
iter: 1  mgc: 3.724798e-14 
outer mgc:  0.01165241 
iter: 1  value: 742.5581 mgc: 0.009683324 ustep: 1 
iter: 2  value: 742.5581 mgc: 4.19162e-07 ustep: 1 
iter: 3  mgc: 2.881029e-14 
iter: 1  mgc: 2.881029e-14 
outer mgc:  0.01191022 
iter: 1  value: 742.5587 mgc: 0.009151743 ustep: 1 
iter: 2  value: 742.5587 mgc: 5.266236e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
iter: 1  value: 742.5591 mgc: 0.006396671 ustep: 1 
iter: 2  value: 742.5591 mgc: 2.050422e-07 ustep: 1 
iter: 3  mgc: 3.662348e-14 
iter: 1  mgc: 3.662348e-14 
outer mgc:  0.01049757 
iter: 1  value: 742.5594 mgc: 0.001258033 ustep: 1 
iter: 2  value: 742.5594 mgc: 1.222211e-08 ustep: 1 
mgc: 3.885781e-14 
iter: 1  mgc: 3.885781e-14 
outer mgc:  0.004522894 
iter: 1  value: 742.559 mgc: 0.001487403 ustep: 1 
iter: 2  mgc: 7.078442e-09 
iter: 1  value: 742.5592 mgc: 0.0008717905 ustep: 1 
iter: 2  mgc: 3.326734e-09 
iter: 1  mgc: 3.326734e-09 
outer mgc:  0.005179716 
iter: 1  value: 742.5593 mgc: 0.0004699763 ustep: 1 
iter: 2  mgc: 1.200465e-09 
iter: 1  mgc: 1.200465e-09 
outer mgc:  0.0007071918 
iter: 1  value: 742.5592 mgc: 7.293145e-05 ustep: 1 
iter: 2  mgc: 2.237139e-10 
iter: 1  mgc: 2.237139e-10 
outer mgc:  0.0008556559 
iter: 1  mgc: 2.237139e-10 
iter: 1  mgc: 2.237139e-10 
outer mgc:  0.0008556559 
iter: 1  value: 742.5582 mgc: 0.03363317 ustep: 1 
iter: 2  value: 742.5582 mgc: 6.194999e-06 ustep: 1 
iter: 3  mgc: 5.618839e-13 
outer mgc:  0.06271948 
iter: 1  value: 742.5604 mgc: 0.03362077 ustep: 1 
iter: 2  value: 742.5604 mgc: 6.203026e-06 ustep: 1 
iter: 3  mgc: 5.612177e-13 
outer mgc:  0.062947 
iter: 1  value: 742.5571 mgc: 0.009090654 ustep: 1 
iter: 2  value: 742.5571 mgc: 4.949151e-07 ustep: 1 
iter: 3  mgc: 3.208545e-14 
outer mgc:  0.1120232 
iter: 1  value: 742.5615 mgc: 0.009083253 ustep: 1 
iter: 2  value: 742.5615 mgc: 4.940763e-07 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.1117393 
iter: 1  value: 742.5605 mgc: 0.03088604 ustep: 1 
iter: 2  value: 742.5605 mgc: 3.699371e-06 ustep: 1 
iter: 3  mgc: 1.030287e-13 
outer mgc:  0.09047295 
iter: 1  value: 742.5581 mgc: 0.03089075 ustep: 1 
iter: 2  value: 742.5581 mgc: 3.693283e-06 ustep: 1 
iter: 3  mgc: 1.092459e-13 
outer mgc:  0.09012323 
iter: 1  value: 742.564 mgc: 0.01120412 ustep: 1 
iter: 2  value: 742.564 mgc: 4.30364e-07 ustep: 1 
iter: 3  mgc: 4.619916e-14 
outer mgc:  0.1848224 
iter: 1  value: 742.5547 mgc: 0.01121245 ustep: 1 
iter: 2  value: 742.5547 mgc: 4.310592e-07 ustep: 1 
iter: 3  mgc: 3.599204e-14 
outer mgc:  0.1853012 
iter: 1  value: 742.5561 mgc: 0.003418829 ustep: 1 
iter: 2  value: 742.5561 mgc: 3.719648e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.02924313 
iter: 1  value: 742.5624 mgc: 0.003415634 ustep: 1 
iter: 2  value: 742.5624 mgc: 3.715214e-07 ustep: 1 
iter: 3  mgc: 2.996908e-14 
outer mgc:  0.02979978 
iter: 1  value: 742.5651 mgc: 0.005308754 ustep: 1 
iter: 2  value: 742.5651 mgc: 1.84639e-06 ustep: 1 
iter: 3  mgc: 2.251532e-13 
outer mgc:  0.1179712 
iter: 1  value: 742.5535 mgc: 0.005320719 ustep: 1 
iter: 2  value: 742.5535 mgc: 1.851966e-06 ustep: 1 
iter: 3  mgc: 2.253753e-13 
outer mgc:  0.1198707 
iter: 1  value: 742.5628 mgc: 0.005754989 ustep: 1 
iter: 2  value: 742.5628 mgc: 2.835228e-07 ustep: 1 
iter: 3  mgc: 4.474199e-14 
outer mgc:  0.1297518 
iter: 1  value: 742.5557 mgc: 0.005767546 ustep: 1 
iter: 2  value: 742.5557 mgc: 2.838592e-07 ustep: 1 
iter: 3  mgc: 4.685141e-14 
outer mgc:  0.128893 
[Sat Aug 14 02:06:05 2021]
Finished job 0.
1 of 1 steps (100%) done

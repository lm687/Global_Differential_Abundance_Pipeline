Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:09:45 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21804.158093 
iter  10 value 11596.969030
final  value 11595.718979 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 27973.88 mgc: 127.2507 ustep: 1 
iter: 2  value: 26509.15 mgc: 57.91648 ustep: 0.4367355 
iter: 3  value: 24946.9 mgc: 115.5804 ustep: 0.6608936 
iter: 4  value: 24924.84 mgc: 49.64763 ustep: 0.3423004 
iter: 5  value: 24788.04 mgc: 110.0985 ustep: 0.585106 
iter: 6  value: 24773.29 mgc: 32.12945 ustep: 0.7649457 
iter: 7  value: 24770.19 mgc: 16.3298 ustep: 0.8746243 
iter: 8  value: 24770.19 mgc: 0.8289446 ustep: 0.93522 
iter: 9  value: 24770.19 mgc: 0.005198132 ustep: 0.967071 
iter: 10  value: 24770.19 mgc: 8.537665e-06 ustep: 0.9833993 
iter: 11  value: 24770.19 mgc: 8.359861e-08 ustep: 0.9916658 
iter: 12  mgc: 5.228178e-10 
iter: 1  mgc: 5.228178e-10 
Matching hessian patterns... Done
outer mgc:  5025.408 
iter: 1  value: 20011.06 mgc: 30.44497 ustep: 1 
iter: 2  value: 19964.36 mgc: 9.396636 ustep: 1 
iter: 3  value: 19964.09 mgc: 0.8323856 ustep: 1 
iter: 4  value: 19964.09 mgc: 0.02234295 ustep: 1 
iter: 5  value: 19964.09 mgc: 1.739043e-05 ustep: 1 
iter: 6  mgc: 1.057404e-11 
iter: 1  value: 10871.02 mgc: 67.2559 ustep: 0.2494656 
iter: 2  value: 8554.482 mgc: 91.16876 ustep: 0.4995153 
iter: 3  value: 8510.607 mgc: 19.43566 ustep: 0.7067933 
iter: 4  value: 8510.384 mgc: 1.712789 ustep: 0.8407259 
iter: 5  value: 8510.383 mgc: 0.05601725 ustep: 0.9169194 
iter: 6  value: 8510.383 mgc: 0.0008685363 ustep: 0.9575633 
iter: 7  value: 8510.383 mgc: 2.360424e-05 ustep: 0.9785538 
iter: 8  value: 8510.383 mgc: 3.197365e-07 ustep: 0.9892199 
iter: 9  mgc: 2.167726e-09 
iter: 1  value: 4091.224 mgc: 60.54519 ustep: 1 
iter: 2  value: 2920.654 mgc: 57.6459 ustep: 1 
iter: 3  value: 2838.317 mgc: 27.24343 ustep: 0.4367355 
iter: 4  value: 2820.79 mgc: 60.48423 ustep: 0.6608936 
iter: 5  value: 2696.644 mgc: 31.8459 ustep: 0.3423004 
iter: 6  value: 2677.668 mgc: 14.47623 ustep: 0.585106 
iter: 7  value: 2674.549 mgc: 5.166903 ustep: 0.7649457 
iter: 8  value: 2674.481 mgc: 1.235193 ustep: 0.8746243 
iter: 9  value: 2674.481 mgc: 0.04345544 ustep: 0.93522 
iter: 10  value: 2674.481 mgc: 0.0003788782 ustep: 0.967071 
iter: 11  value: 2674.481 mgc: 2.842209e-06 ustep: 0.9833993 
iter: 12  mgc: 9.733876e-09 
iter: 1  mgc: 9.733876e-09 
outer mgc:  199.8346 
iter: 1  value: 3055.851 mgc: 4585.382 ustep: 1 
iter: 2  value: 3020.896 mgc: 26.38677 ustep: 1 
iter: 3  value: 3020.713 mgc: 1.12888 ustep: 1 
iter: 4  value: 3020.713 mgc: 0.02617416 ustep: 1 
iter: 5  value: 3020.713 mgc: 1.469559e-05 ustep: 1 
iter: 6  mgc: 4.648726e-12 
iter: 1  value: 2078.246 mgc: 31.35467 ustep: 1 
iter: 2  value: 2074.054 mgc: 6.201458 ustep: 1 
iter: 3  value: 2074.049 mgc: 0.265567 ustep: 1 
iter: 4  value: 2074.049 mgc: 0.0004129021 ustep: 1 
iter: 5  value: 2074.049 mgc: 1.032733e-08 ustep: 1 
mgc: 2.187139e-14 
iter: 1  mgc: 2.187139e-14 
outer mgc:  645.7316 
iter: 1  value: 2121.147 mgc: 59.74229 ustep: 1 
iter: 2  value: 2076.694 mgc: 31.36756 ustep: 1 
iter: 3  value: 2076.363 mgc: 3.804641 ustep: 1 
iter: 4  value: 2076.363 mgc: 0.08494261 ustep: 1 
iter: 5  value: 2076.363 mgc: 4.435607e-05 ustep: 1 
iter: 6  mgc: 1.200817e-11 
iter: 1  value: 1782.118 mgc: 29.44021 ustep: 1 
iter: 2  value: 1757.629 mgc: 13.22466 ustep: 1 
iter: 3  value: 1757.477 mgc: 1.830462 ustep: 1 
iter: 4  value: 1757.477 mgc: 0.05529736 ustep: 1 
iter: 5  value: 1757.477 mgc: 5.481983e-05 ustep: 1 
iter: 6  mgc: 5.401901e-11 
iter: 1  mgc: 5.401901e-11 
outer mgc:  507.8097 
iter: 1  value: 1408.897 mgc: 24.58618 ustep: 1 
iter: 2  value: 1399.919 mgc: 3.458525 ustep: 1 
iter: 3  value: 1399.871 mgc: 0.2659795 ustep: 1 
iter: 4  value: 1399.871 mgc: 0.01569438 ustep: 1 
iter: 5  value: 1399.871 mgc: 6.266649e-05 ustep: 1 
iter: 6  mgc: 1.008243e-09 
iter: 1  mgc: 1.008243e-09 
outer mgc:  97.9667 
iter: 1  value: 1284.046 mgc: 9.483973 ustep: 1 
iter: 2  value: 1280.85 mgc: 6.41754 ustep: 1 
iter: 3  value: 1280.774 mgc: 0.9310138 ustep: 1 
iter: 4  value: 1280.774 mgc: 0.02794445 ustep: 1 
iter: 5  value: 1280.774 mgc: 2.701487e-05 ustep: 1 
iter: 6  mgc: 2.531397e-11 
iter: 1  mgc: 2.531397e-11 
outer mgc:  99.68065 
iter: 1  value: 1678.436 mgc: 28.7563 ustep: 1 
iter: 2  value: 1676.066 mgc: 2.575474 ustep: 1 
iter: 3  value: 1676.064 mgc: 0.08762795 ustep: 1 
iter: 4  value: 1676.064 mgc: 0.0003194742 ustep: 1 
iter: 5  mgc: 6.413355e-09 
iter: 1  value: 1256.127 mgc: 4.713231 ustep: 1 
iter: 2  value: 1256.124 mgc: 0.1183459 ustep: 1 
iter: 3  value: 1256.124 mgc: 0.0003310054 ustep: 1 
iter: 4  mgc: 5.423319e-09 
iter: 1  mgc: 5.423319e-09 
outer mgc:  36.31301 
iter: 1  value: 1254.4 mgc: 5.935644 ustep: 1 
iter: 2  value: 1254.371 mgc: 0.3668532 ustep: 1 
iter: 3  value: 1254.371 mgc: 0.002634289 ustep: 1 
iter: 4  value: 1254.371 mgc: 6.184693e-07 ustep: 1 
iter: 5  mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  27.13397 
iter: 1  value: 1248.188 mgc: 3.780293 ustep: 1 
iter: 2  value: 1248.179 mgc: 0.1510935 ustep: 1 
iter: 3  value: 1248.179 mgc: 0.0004917312 ustep: 1 
iter: 4  value: 1248.179 mgc: 1.823712e-08 ustep: 1 
mgc: 3.58602e-14 
iter: 1  mgc: 3.58602e-14 
outer mgc:  42.4593 
iter: 1  value: 1251.289 mgc: 4.36399 ustep: 1 
iter: 2  value: 1251.281 mgc: 0.3310782 ustep: 1 
iter: 3  value: 1251.281 mgc: 0.001674938 ustep: 1 
iter: 4  value: 1251.281 mgc: 4.930946e-08 ustep: 1 
mgc: 3.053113e-14 
iter: 1  mgc: 3.053113e-14 
outer mgc:  31.18191 
iter: 1  value: 1245.667 mgc: 2.788623 ustep: 1 
iter: 2  value: 1245.666 mgc: 0.09585419 ustep: 1 
iter: 3  value: 1245.666 mgc: 0.0001810994 ustep: 1 
iter: 4  mgc: 2.339255e-09 
iter: 1  mgc: 2.339255e-09 
outer mgc:  5.898413 
iter: 1  value: 1244.813 mgc: 3.452566 ustep: 1 
iter: 2  value: 1244.808 mgc: 0.07520999 ustep: 1 
iter: 3  value: 1244.808 mgc: 0.0001311163 ustep: 1 
iter: 4  mgc: 4.005447e-10 
iter: 1  mgc: 4.005447e-10 
outer mgc:  11.34478 
iter: 1  value: 1244.507 mgc: 2.507429 ustep: 1 
iter: 2  value: 1244.507 mgc: 0.0378982 ustep: 1 
iter: 3  value: 1244.507 mgc: 2.684927e-05 ustep: 1 
iter: 4  mgc: 1.697376e-11 
iter: 1  mgc: 1.697376e-11 
outer mgc:  7.033448 
iter: 1  value: 1245.439 mgc: 0.6269988 ustep: 1 
iter: 2  value: 1245.439 mgc: 0.00371058 ustep: 1 
iter: 3  value: 1245.439 mgc: 1.088586e-06 ustep: 1 
iter: 4  mgc: 9.547918e-14 
iter: 1  value: 1244.671 mgc: 0.4251327 ustep: 1 
iter: 2  value: 1244.671 mgc: 0.00256847 ustep: 1 
iter: 3  value: 1244.671 mgc: 9.237631e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  3.152142 
iter: 1  value: 1244.552 mgc: 0.3323917 ustep: 1 
iter: 2  value: 1244.552 mgc: 0.001157781 ustep: 1 
iter: 3  value: 1244.552 mgc: 1.53536e-08 ustep: 1 
mgc: 3.4861e-14 
iter: 1  mgc: 3.4861e-14 
outer mgc:  3.400469 
iter: 1  value: 1244.519 mgc: 0.3892555 ustep: 1 
iter: 2  value: 1244.519 mgc: 0.002852263 ustep: 1 
iter: 3  value: 1244.519 mgc: 1.702803e-07 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  2.307567 
iter: 1  value: 1244.988 mgc: 1.426812 ustep: 1 
iter: 2  value: 1244.988 mgc: 0.01707387 ustep: 1 
iter: 3  value: 1244.988 mgc: 6.029657e-06 ustep: 1 
iter: 4  mgc: 2.704281e-12 
iter: 1  value: 1244.545 mgc: 0.2103303 ustep: 1 
iter: 2  value: 1244.545 mgc: 0.000415647 ustep: 1 
iter: 3  mgc: 5.210785e-09 
iter: 1  mgc: 5.210785e-09 
outer mgc:  0.9001785 
iter: 1  value: 1244.744 mgc: 0.1473209 ustep: 1 
iter: 2  value: 1244.744 mgc: 0.0003960084 ustep: 1 
iter: 3  value: 1244.744 mgc: 1.193777e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.8203347 
iter: 1  value: 1244.659 mgc: 0.1629193 ustep: 1 
iter: 2  value: 1244.659 mgc: 0.0003545019 ustep: 1 
iter: 3  mgc: 9.363748e-09 
iter: 1  mgc: 9.363748e-09 
outer mgc:  0.3665513 
iter: 1  value: 1244.604 mgc: 0.2131912 ustep: 1 
iter: 2  value: 1244.604 mgc: 0.0003365378 ustep: 1 
iter: 3  mgc: 1.215145e-09 
iter: 1  value: 1244.671 mgc: 0.03553751 ustep: 1 
iter: 2  value: 1244.671 mgc: 3.024373e-05 ustep: 1 
iter: 3  mgc: 7.148149e-11 
iter: 1  mgc: 7.148149e-11 
outer mgc:  0.3510034 
iter: 1  value: 1244.664 mgc: 0.04019213 ustep: 1 
iter: 2  value: 1244.664 mgc: 2.14842e-05 ustep: 1 
iter: 3  mgc: 1.139444e-11 
iter: 1  mgc: 1.139444e-11 
outer mgc:  0.2900903 
iter: 1  value: 1244.65 mgc: 0.04654868 ustep: 1 
iter: 2  value: 1244.65 mgc: 1.728038e-05 ustep: 1 
iter: 3  mgc: 1.712519e-11 
iter: 1  mgc: 1.712519e-11 
outer mgc:  0.2494363 
iter: 1  value: 1244.682 mgc: 0.0185649 ustep: 1 
iter: 2  value: 1244.682 mgc: 1.241e-05 ustep: 1 
iter: 3  mgc: 1.001932e-11 
iter: 1  mgc: 1.001932e-11 
outer mgc:  0.2302362 
iter: 1  value: 1244.67 mgc: 0.07858029 ustep: 1 
iter: 2  value: 1244.67 mgc: 4.840622e-05 ustep: 1 
iter: 3  mgc: 3.545098e-11 
iter: 1  value: 1244.667 mgc: 0.01103591 ustep: 1 
iter: 2  value: 1244.667 mgc: 9.590963e-06 ustep: 1 
iter: 3  mgc: 7.119194e-12 
iter: 1  mgc: 7.119194e-12 
outer mgc:  0.1653558 
iter: 1  value: 1244.676 mgc: 0.02110968 ustep: 1 
iter: 2  value: 1244.676 mgc: 3.239615e-06 ustep: 1 
iter: 3  mgc: 1.758593e-13 
iter: 1  mgc: 1.758593e-13 
outer mgc:  0.03137373 
iter: 1  value: 1244.666 mgc: 0.02040466 ustep: 1 
iter: 2  value: 1244.666 mgc: 3.527676e-06 ustep: 1 
iter: 3  mgc: 1.241229e-13 
iter: 1  value: 1244.674 mgc: 0.0009491379 ustep: 1 
iter: 2  value: 1244.674 mgc: 5.466528e-08 ustep: 1 
iter: 3  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  0.01227197 
iter: 1  value: 1244.673 mgc: 0.005811767 ustep: 1 
iter: 2  value: 1244.673 mgc: 1.827165e-07 ustep: 1 
iter: 3  mgc: 3.264056e-14 
iter: 1  value: 1244.672 mgc: 0.0006533902 ustep: 1 
iter: 2  value: 1244.672 mgc: 1.762835e-08 ustep: 1 
mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  0.002839834 
iter: 1  value: 1244.672 mgc: 0.001965754 ustep: 1 
iter: 2  value: 1244.672 mgc: 2.578864e-08 ustep: 1 
mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.007163197 
iter: 1  value: 1244.672 mgc: 0.002864061 ustep: 1 
iter: 2  value: 1244.672 mgc: 5.498124e-08 ustep: 1 
iter: 3  mgc: 3.319567e-14 
iter: 1  mgc: 3.319567e-14 
outer mgc:  0.00582012 
iter: 1  value: 1244.673 mgc: 0.001379055 ustep: 1 
iter: 2  value: 1244.673 mgc: 2.504704e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.005544934 
iter: 1  value: 1244.672 mgc: 0.001511885 ustep: 1 
iter: 2  value: 1244.672 mgc: 1.979583e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  value: 1244.672 mgc: 0.0004340641 ustep: 1 
iter: 2  mgc: 2.573711e-09 
iter: 1  mgc: 2.573711e-09 
outer mgc:  0.0026744 
iter: 1  value: 1244.672 mgc: 0.0009093926 ustep: 1 
iter: 2  mgc: 5.855466e-09 
iter: 1  mgc: 5.855466e-09 
outer mgc:  0.002532006 
iter: 1  mgc: 5.855466e-09 
iter: 1  mgc: 5.855466e-09 
outer mgc:  0.002532006 
iter: 1  value: 1244.672 mgc: 0.02787907 ustep: 1 
iter: 2  value: 1244.672 mgc: 4.171471e-06 ustep: 1 
iter: 3  mgc: 2.664535e-13 
outer mgc:  0.1232176 
iter: 1  value: 1244.672 mgc: 0.02787371 ustep: 1 
iter: 2  value: 1244.672 mgc: 4.175414e-06 ustep: 1 
iter: 3  mgc: 2.671197e-13 
outer mgc:  0.1202701 
iter: 1  value: 1244.681 mgc: 0.01257571 ustep: 1 
iter: 2  value: 1244.681 mgc: 2.167063e-06 ustep: 1 
iter: 3  mgc: 6.439294e-14 
outer mgc:  0.1741873 
iter: 1  value: 1244.663 mgc: 0.01258444 ustep: 1 
iter: 2  value: 1244.663 mgc: 2.166309e-06 ustep: 1 
iter: 3  mgc: 7.194245e-14 
outer mgc:  0.1732052 
iter: 1  value: 1244.671 mgc: 0.03181401 ustep: 1 
iter: 2  value: 1244.671 mgc: 7.593572e-06 ustep: 1 
iter: 3  mgc: 5.084821e-13 
outer mgc:  0.1203423 
iter: 1  value: 1244.673 mgc: 0.03179737 ustep: 1 
iter: 2  value: 1244.673 mgc: 7.602183e-06 ustep: 1 
iter: 3  mgc: 5.109246e-13 
outer mgc:  0.123432 
iter: 1  value: 1244.666 mgc: 0.009622604 ustep: 1 
iter: 2  value: 1244.666 mgc: 1.318879e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.1428511 
iter: 1  value: 1244.678 mgc: 0.00961512 ustep: 1 
iter: 2  value: 1244.678 mgc: 1.318122e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.1448555 
iter: 1  value: 1244.666 mgc: 0.003422342 ustep: 1 
iter: 2  value: 1244.666 mgc: 6.267734e-07 ustep: 1 
iter: 3  mgc: 3.408385e-14 
outer mgc:  0.06611393 
iter: 1  value: 1244.678 mgc: 0.003419428 ustep: 1 
iter: 2  value: 1244.678 mgc: 6.257965e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.06475006 
iter: 1  value: 1244.68 mgc: 0.006609289 ustep: 1 
iter: 2  value: 1244.68 mgc: 6.528245e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.231622 
iter: 1  value: 1244.664 mgc: 0.006622818 ustep: 1 
iter: 2  value: 1244.664 mgc: 6.549038e-07 ustep: 1 
iter: 3  mgc: 2.9865e-14 
outer mgc:  0.2305203 
iter: 1  value: 1244.682 mgc: 0.006969353 ustep: 1 
iter: 2  value: 1244.682 mgc: 3.606713e-06 ustep: 1 
iter: 3  mgc: 1.008527e-12 
outer mgc:  0.2069621 
iter: 1  value: 1244.662 mgc: 0.00698367 ustep: 1 
iter: 2  value: 1244.662 mgc: 3.61664e-06 ustep: 1 
iter: 3  mgc: 1.011191e-12 
outer mgc:  0.2123533 
[Sun Aug 15 22:09:47 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:27:36 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11009.193745 
final  value 10177.137395 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3172.967 mgc: 106.3275 ustep: 1 
iter: 2  value: 2405.809 mgc: 48.72306 ustep: 1 
iter: 3  value: 1504.675 mgc: 122.429 ustep: 1 
iter: 4  value: 1199.053 mgc: 37.99498 ustep: 0.1336527 
iter: 5  value: 1188.77 mgc: 17.99462 ustep: 0.3656489 
iter: 6  value: 1182.484 mgc: 19.50662 ustep: 0.6047286 
iter: 7  value: 1182.263 mgc: 3.18 ustep: 0.7776652 
iter: 8  value: 1182.262 mgc: 0.1790142 ustep: 0.8818651 
iter: 9  value: 1182.262 mgc: 0.001650579 ustep: 0.9390828 
iter: 10  value: 1182.262 mgc: 5.263839e-06 ustep: 0.969066 
iter: 11  mgc: 8.518235e-09 
iter: 1  mgc: 8.518235e-09 
Matching hessian patterns... Done
outer mgc:  637.315 
iter: 1  value: 795.3648 mgc: 29.41742 ustep: 1 
iter: 2  value: 794.1811 mgc: 1.939997 ustep: 1 
iter: 3  value: 794.181 mgc: 0.02958385 ustep: 1 
iter: 4  value: 794.181 mgc: 1.161499e-05 ustep: 1 
iter: 5  mgc: 1.793093e-12 
iter: 1  mgc: 1.793093e-12 
outer mgc:  134.4419 
iter: 1  value: 736.7298 mgc: 17.46645 ustep: 1 
iter: 2  value: 736.4349 mgc: 0.9217498 ustep: 1 
iter: 3  value: 736.4349 mgc: 0.00571242 ustep: 1 
iter: 4  value: 736.4349 mgc: 4.079864e-07 ustep: 1 
iter: 5  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  115.4159 
iter: 1  value: 683.3835 mgc: 12.11787 ustep: 1 
iter: 2  value: 683.2832 mgc: 0.9143286 ustep: 1 
iter: 3  value: 683.2832 mgc: 0.007842944 ustep: 1 
iter: 4  value: 683.2832 mgc: 5.958269e-07 ustep: 1 
iter: 5  mgc: 1.409983e-14 
iter: 1  mgc: 1.409983e-14 
outer mgc:  99.79344 
iter: 1  value: 689.7402 mgc: 15.90109 ustep: 1 
iter: 2  value: 688.1994 mgc: 1.890368 ustep: 1 
iter: 3  value: 688.1992 mgc: 0.03022921 ustep: 1 
iter: 4  value: 688.1992 mgc: 9.640916e-06 ustep: 1 
iter: 5  mgc: 9.923173e-13 
iter: 1  value: 680.4988 mgc: 8.766459 ustep: 1 
iter: 2  value: 680.4194 mgc: 0.4165935 ustep: 1 
iter: 3  value: 680.4194 mgc: 0.001394823 ustep: 1 
iter: 4  value: 680.4194 mgc: 2.324713e-08 ustep: 1 
mgc: 2.600697e-14 
iter: 1  mgc: 2.600697e-14 
outer mgc:  121.8016 
iter: 1  value: 660.7492 mgc: 9.005563 ustep: 1 
iter: 2  value: 660.7105 mgc: 0.3405034 ustep: 1 
iter: 3  value: 660.7105 mgc: 0.0004755591 ustep: 1 
iter: 4  mgc: 1.729611e-09 
iter: 1  mgc: 1.729611e-09 
outer mgc:  30.29947 
iter: 1  value: 651.6705 mgc: 5.343984 ustep: 1 
iter: 2  value: 651.6588 mgc: 0.144526 ustep: 1 
iter: 3  value: 651.6588 mgc: 0.0002156895 ustep: 1 
iter: 4  mgc: 5.452776e-10 
iter: 1  value: 648.0026 mgc: 5.953411 ustep: 1 
iter: 2  value: 647.9849 mgc: 0.1822609 ustep: 1 
iter: 3  value: 647.9849 mgc: 0.0003377175 ustep: 1 
iter: 4  mgc: 1.330943e-09 
iter: 1  mgc: 1.330943e-09 
outer mgc:  94.12269 
iter: 1  value: 621.9497 mgc: 13.67605 ustep: 1 
iter: 2  value: 621.8339 mgc: 0.7642862 ustep: 1 
iter: 3  value: 621.8339 mgc: 0.003002007 ustep: 1 
iter: 4  value: 621.8339 mgc: 4.636273e-08 ustep: 1 
mgc: 1.569578e-14 
iter: 1  mgc: 1.569578e-14 
outer mgc:  50.56644 
iter: 1  value: 604.9357 mgc: 14.97646 ustep: 1 
iter: 2  value: 603.9968 mgc: 1.428117 ustep: 1 
iter: 3  value: 603.9968 mgc: 0.01674126 ustep: 1 
iter: 4  value: 603.9968 mgc: 2.401537e-06 ustep: 1 
iter: 5  mgc: 5.107026e-14 
iter: 1  mgc: 5.107026e-14 
outer mgc:  77.09003 
iter: 1  value: 579.8543 mgc: 9.035402 ustep: 1 
iter: 2  value: 579.684 mgc: 0.7700784 ustep: 1 
iter: 3  value: 579.684 mgc: 0.004120818 ustep: 1 
iter: 4  value: 579.684 mgc: 1.330191e-07 ustep: 1 
mgc: 1.554312e-14 
iter: 1  mgc: 1.554312e-14 
outer mgc:  29.40278 
iter: 1  value: 592.3665 mgc: 14.05764 ustep: 1 
iter: 2  value: 592.3519 mgc: 0.244694 ustep: 1 
iter: 3  value: 592.3519 mgc: 0.0003475828 ustep: 1 
iter: 4  mgc: 5.258984e-10 
iter: 1  value: 575.4524 mgc: 4.172672 ustep: 1 
iter: 2  value: 575.4522 mgc: 0.01900187 ustep: 1 
iter: 3  value: 575.4522 mgc: 2.376385e-06 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  50.18781 
iter: 1  value: 570.371 mgc: 5.517178 ustep: 1 
iter: 2  value: 570.3705 mgc: 0.04969383 ustep: 1 
iter: 3  value: 570.3705 mgc: 4.882189e-06 ustep: 1 
iter: 4  mgc: 5.861978e-14 
iter: 1  mgc: 5.861978e-14 
outer mgc:  40.71256 
iter: 1  value: 563.8517 mgc: 3.777617 ustep: 1 
iter: 2  value: 563.8511 mgc: 0.05951498 ustep: 1 
iter: 3  value: 563.8511 mgc: 1.862576e-05 ustep: 1 
iter: 4  mgc: 1.641354e-12 
iter: 1  mgc: 1.641354e-12 
outer mgc:  21.37405 
iter: 1  value: 553.3813 mgc: 5.35367 ustep: 1 
iter: 2  value: 553.3811 mgc: 0.05366197 ustep: 1 
iter: 3  value: 553.3811 mgc: 9.942123e-06 ustep: 1 
iter: 4  mgc: 3.836931e-13 
iter: 1  mgc: 3.836931e-13 
outer mgc:  32.82959 
iter: 1  value: 546.7248 mgc: 6.515394 ustep: 1 
iter: 2  value: 546.7247 mgc: 0.03540308 ustep: 1 
iter: 3  value: 546.7247 mgc: 2.77951e-06 ustep: 1 
iter: 4  mgc: 1.554312e-14 
iter: 1  mgc: 1.554312e-14 
outer mgc:  47.49918 
iter: 1  value: 546.6739 mgc: 4.212846 ustep: 1 
iter: 2  value: 546.6739 mgc: 0.03591909 ustep: 1 
iter: 3  value: 546.6739 mgc: 3.742555e-06 ustep: 1 
iter: 4  mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  19.53637 
iter: 1  value: 548.1049 mgc: 4.141952 ustep: 1 
iter: 2  value: 548.1049 mgc: 0.02574101 ustep: 1 
iter: 3  value: 548.1049 mgc: 1.092375e-06 ustep: 1 
iter: 4  mgc: 1.509903e-14 
iter: 1  value: 545.3162 mgc: 1.664193 ustep: 1 
iter: 2  value: 545.3162 mgc: 0.005250008 ustep: 1 
iter: 3  value: 545.3162 mgc: 5.738883e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  15.92406 
iter: 1  value: 544.745 mgc: 2.645858 ustep: 1 
iter: 2  value: 544.745 mgc: 0.01419516 ustep: 1 
iter: 3  value: 544.745 mgc: 3.947499e-07 ustep: 1 
iter: 4  mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  21.35216 
iter: 1  value: 544.2561 mgc: 2.303562 ustep: 1 
iter: 2  value: 544.2561 mgc: 0.006758496 ustep: 1 
iter: 3  value: 544.2561 mgc: 7.981651e-08 ustep: 1 
mgc: 1.84297e-14 
iter: 1  mgc: 1.84297e-14 
outer mgc:  29.29152 
iter: 1  value: 542.9417 mgc: 2.191801 ustep: 1 
iter: 2  value: 542.9417 mgc: 0.004867741 ustep: 1 
iter: 3  value: 542.9417 mgc: 4.103897e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  8.964796 
iter: 1  value: 542.9917 mgc: 2.098962 ustep: 1 
iter: 2  value: 542.9917 mgc: 0.004671561 ustep: 1 
iter: 3  value: 542.9917 mgc: 1.94851e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  23.97895 
iter: 1  value: 543.4327 mgc: 2.362613 ustep: 1 
iter: 2  value: 543.4327 mgc: 0.005307409 ustep: 1 
iter: 3  value: 543.4327 mgc: 1.076067e-07 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  22.72563 
iter: 1  value: 542.6122 mgc: 1.55089 ustep: 1 
iter: 2  value: 542.6122 mgc: 0.005771552 ustep: 1 
iter: 3  value: 542.6122 mgc: 8.219468e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  5.554151 
iter: 1  value: 542.6975 mgc: 1.067012 ustep: 1 
iter: 2  value: 542.6975 mgc: 0.003203625 ustep: 1 
iter: 3  value: 542.6975 mgc: 3.449893e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  value: 542.9331 mgc: 1.189398 ustep: 1 
iter: 2  value: 542.9331 mgc: 0.004541582 ustep: 1 
iter: 3  value: 542.9331 mgc: 6.965321e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  7.517 
iter: 1  value: 546.1621 mgc: 3.739402 ustep: 1 
iter: 2  value: 546.1621 mgc: 0.02716448 ustep: 1 
iter: 3  value: 546.1621 mgc: 2.596512e-06 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  value: 543.97 mgc: 1.791863 ustep: 1 
iter: 2  value: 543.97 mgc: 0.003995869 ustep: 1 
iter: 3  value: 543.97 mgc: 2.952054e-08 ustep: 1 
mgc: 1.398881e-14 
iter: 1  mgc: 1.398881e-14 
outer mgc:  6.133283 
iter: 1  value: 544.3998 mgc: 2.233147 ustep: 1 
iter: 2  value: 544.3998 mgc: 0.01257117 ustep: 1 
iter: 3  value: 544.3998 mgc: 3.924551e-07 ustep: 1 
mgc: 1.781908e-14 
iter: 1  mgc: 1.781908e-14 
outer mgc:  5.138589 
iter: 1  value: 542.0189 mgc: 1.890834 ustep: 1 
iter: 2  value: 542.0189 mgc: 0.008151161 ustep: 1 
iter: 3  value: 542.0189 mgc: 1.45204e-07 ustep: 1 
mgc: 1.421085e-14 
iter: 1  value: 543.5247 mgc: 1.070697 ustep: 1 
iter: 2  value: 543.5247 mgc: 0.002603551 ustep: 1 
iter: 3  value: 543.5247 mgc: 1.646601e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  8.159386 
iter: 1  value: 543.0622 mgc: 1.04926 ustep: 1 
iter: 2  value: 543.0622 mgc: 0.001193156 ustep: 1 
iter: 3  mgc: 2.796035e-09 
iter: 1  mgc: 2.796035e-09 
outer mgc:  5.62973 
iter: 1  value: 542.9856 mgc: 0.6910558 ustep: 1 
iter: 2  value: 542.9856 mgc: 0.001597518 ustep: 1 
iter: 3  mgc: 9.531518e-09 
iter: 1  mgc: 9.531518e-09 
outer mgc:  3.135544 
iter: 1  value: 543.0733 mgc: 0.4496258 ustep: 1 
iter: 2  value: 543.0733 mgc: 0.0006582628 ustep: 1 
iter: 3  mgc: 1.348917e-09 
iter: 1  value: 543.0161 mgc: 0.266562 ustep: 1 
iter: 2  value: 543.0161 mgc: 0.0002310415 ustep: 1 
iter: 3  mgc: 1.653162e-10 
iter: 1  mgc: 1.653162e-10 
outer mgc:  0.821447 
iter: 1  value: 542.649 mgc: 0.279412 ustep: 1 
iter: 2  value: 542.649 mgc: 0.0003133722 ustep: 1 
iter: 3  mgc: 3.755094e-10 
iter: 1  mgc: 3.755094e-10 
outer mgc:  1.317933 
iter: 1  value: 542.6373 mgc: 0.205045 ustep: 1 
iter: 2  value: 542.6373 mgc: 9.835203e-05 ustep: 1 
iter: 3  mgc: 2.212541e-11 
iter: 1  mgc: 2.212541e-11 
outer mgc:  0.4760159 
iter: 1  value: 542.8681 mgc: 0.1200243 ustep: 1 
iter: 2  value: 542.8681 mgc: 3.716093e-05 ustep: 1 
iter: 3  mgc: 5.071499e-12 
iter: 1  mgc: 5.071499e-12 
outer mgc:  0.4192566 
iter: 1  value: 542.7478 mgc: 0.161647 ustep: 1 
iter: 2  value: 542.7478 mgc: 6.00901e-05 ustep: 1 
iter: 3  mgc: 8.132162e-12 
iter: 1  mgc: 8.132162e-12 
outer mgc:  0.1481482 
iter: 1  value: 542.7748 mgc: 0.05844853 ustep: 1 
iter: 2  value: 542.7748 mgc: 7.870983e-06 ustep: 1 
iter: 3  mgc: 1.350031e-13 
iter: 1  mgc: 1.350031e-13 
outer mgc:  0.03752318 
iter: 1  value: 542.7757 mgc: 0.004014784 ustep: 1 
iter: 2  value: 542.7757 mgc: 5.991897e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  0.01583342 
iter: 1  value: 542.7752 mgc: 0.001190403 ustep: 1 
iter: 2  mgc: 4.98115e-09 
iter: 1  mgc: 4.98115e-09 
outer mgc:  0.000475319 
iter: 1  value: 542.7752 mgc: 0.000117421 ustep: 1 
iter: 2  mgc: 5.488765e-11 
iter: 1  mgc: 5.488765e-11 
outer mgc:  0.0001873304 
iter: 1  mgc: 5.488765e-11 
iter: 1  mgc: 5.488765e-11 
outer mgc:  0.0001873304 
iter: 1  value: 542.7753 mgc: 0.04704937 ustep: 1 
iter: 2  value: 542.7753 mgc: 3.257329e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.8632663 
iter: 1  value: 542.776 mgc: 0.04703407 ustep: 1 
iter: 2  value: 542.776 mgc: 3.260275e-06 ustep: 1 
iter: 3  mgc: 2.496441e-14 
outer mgc:  0.86294 
iter: 1  value: 542.7763 mgc: 0.02817327 ustep: 1 
iter: 2  value: 542.7763 mgc: 1.177185e-06 ustep: 1 
iter: 3  mgc: 1.987299e-14 
outer mgc:  0.7662364 
iter: 1  value: 542.7749 mgc: 0.02816548 ustep: 1 
iter: 2  value: 542.7749 mgc: 1.178077e-06 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.7663499 
iter: 1  value: 542.7734 mgc: 0.04220036 ustep: 1 
iter: 2  value: 542.7734 mgc: 4.400567e-06 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  0.6468392 
iter: 1  value: 542.7777 mgc: 0.04218075 ustep: 1 
iter: 2  value: 542.7777 mgc: 4.403175e-06 ustep: 1 
iter: 3  mgc: 5.57332e-14 
outer mgc:  0.6471518 
iter: 1  value: 542.7741 mgc: 0.02011373 ustep: 1 
iter: 2  value: 542.7741 mgc: 1.073313e-06 ustep: 1 
iter: 3  mgc: 2.364775e-14 
outer mgc:  0.520838 
iter: 1  value: 542.7768 mgc: 0.020102 ustep: 1 
iter: 2  value: 542.7768 mgc: 1.072813e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.5208255 
iter: 1  value: 542.7649 mgc: 0.01079525 ustep: 1 
iter: 2  value: 542.7649 mgc: 2.993007e-07 ustep: 1 
iter: 3  mgc: 1.865175e-14 
outer mgc:  0.0147827 
iter: 1  value: 542.7856 mgc: 0.01078649 ustep: 1 
iter: 2  value: 542.7856 mgc: 2.995196e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.01483608 
iter: 1  value: 542.7964 mgc: 0.0258779 ustep: 1 
iter: 2  value: 542.7964 mgc: 1.547395e-06 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.03669655 
iter: 1  value: 542.754 mgc: 0.0259307 ustep: 1 
iter: 2  value: 542.754 mgc: 1.547598e-06 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.03662519 
iter: 1  value: 542.7949 mgc: 0.0155753 ustep: 1 
iter: 2  value: 542.7949 mgc: 7.208871e-07 ustep: 1 
iter: 3  mgc: 1.776357e-14 
outer mgc:  0.04185833 
iter: 1  value: 542.7555 mgc: 0.01560763 ustep: 1 
iter: 2  value: 542.7555 mgc: 7.21291e-07 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.04189928 
[Fri Aug 13 11:27:38 2021]
Finished job 0.
1 of 1 steps (100%) done

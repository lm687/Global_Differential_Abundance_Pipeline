Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 00:12:01 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.005_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0.005_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.005_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4337.321316 
final  value 3975.951491 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3702.875 mgc: 5.238981 ustep: 0.6827823 
iter: 2  value: 3659.361 mgc: 2.859295 ustep: 0.8263238 
iter: 3  value: 3649.422 mgc: 2.872841 ustep: 0.4507029 
iter: 4  value: 3647.698 mgc: 1.271213 ustep: 0.671377 
iter: 5  value: 3647.632 mgc: 0.2406138 ustep: 0.819394 
iter: 6  value: 3647.631 mgc: 0.03415069 ustep: 0.9052133 
iter: 7  value: 3647.631 mgc: 0.002366949 ustep: 0.9514319 
iter: 8  value: 3647.631 mgc: 9.571427e-05 ustep: 0.9754161 
iter: 9  value: 3647.631 mgc: 1.926327e-06 ustep: 0.9876328 
iter: 10  value: 3647.631 mgc: 1.935755e-08 ustep: 0.9937978 
iter: 11  mgc: 9.723217e-11 
iter: 1  mgc: 9.723217e-11 
Matching hessian patterns... Done
outer mgc:  21.46994 
iter: 1  value: 3613.438 mgc: 1.302479 ustep: 1 
iter: 2  value: 3613.424 mgc: 0.1091649 ustep: 1 
iter: 3  value: 3613.424 mgc: 0.000812319 ustep: 1 
iter: 4  value: 3613.424 mgc: 5.205172e-08 ustep: 1 
iter: 5  mgc: 2.692291e-15 
iter: 1  value: 3603.633 mgc: 3.281393 ustep: 1 
iter: 2  value: 3603.619 mgc: 0.2166152 ustep: 1 
iter: 3  value: 3603.619 mgc: 0.002840201 ustep: 1 
iter: 4  value: 3603.619 mgc: 7.227858e-07 ustep: 1 
iter: 5  mgc: 4.840572e-14 
iter: 1  mgc: 2.692291e-15 
outer mgc:  10.14061 
iter: 1  value: 3593.994 mgc: 2.973084 ustep: 1 
iter: 2  value: 3593.938 mgc: 0.4508792 ustep: 1 
iter: 3  value: 3593.938 mgc: 0.01288403 ustep: 1 
iter: 4  value: 3593.938 mgc: 1.094403e-05 ustep: 1 
iter: 5  mgc: 8.246293e-12 
iter: 1  mgc: 8.246293e-12 
outer mgc:  17.27583 
iter: 1  value: 3594.138 mgc: 5.814155 ustep: 1 
iter: 2  value: 3593.975 mgc: 0.9687162 ustep: 1 
iter: 3  value: 3593.975 mgc: 0.01266141 ustep: 1 
iter: 4  value: 3593.975 mgc: 2.109865e-06 ustep: 1 
iter: 5  mgc: 7.01661e-14 
iter: 1  value: 3592.148 mgc: 1.361493 ustep: 1 
iter: 2  value: 3592.144 mgc: 0.1214659 ustep: 1 
iter: 3  value: 3592.144 mgc: 0.0006852255 ustep: 1 
iter: 4  value: 3592.144 mgc: 2.111966e-08 ustep: 1 
mgc: 3.053113e-15 
iter: 1  mgc: 3.053113e-15 
outer mgc:  15.59327 
iter: 1  value: 3586.575 mgc: 1.563711 ustep: 1 
iter: 2  value: 3586.567 mgc: 0.1166813 ustep: 1 
iter: 3  value: 3586.567 mgc: 0.00042968 ustep: 1 
iter: 4  mgc: 8.271312e-09 
iter: 1  mgc: 8.271312e-09 
outer mgc:  8.715311 
iter: 1  value: 3580.22 mgc: 1.76876 ustep: 1 
iter: 2  value: 3580.217 mgc: 0.1079883 ustep: 1 
iter: 3  value: 3580.217 mgc: 0.0003817731 ustep: 1 
iter: 4  mgc: 4.384482e-09 
iter: 1  mgc: 4.384482e-09 
outer mgc:  12.3784 
iter: 1  value: 3564.576 mgc: 5.62643 ustep: 1 
iter: 2  value: 3564.553 mgc: 0.3346689 ustep: 1 
iter: 3  value: 3564.553 mgc: 0.001343885 ustep: 1 
iter: 4  value: 3564.553 mgc: 1.838235e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  13.73244 
iter: 1  value: 3553.129 mgc: 14.33577 ustep: 1 
iter: 2  value: 3553.128 mgc: 0.167826 ustep: 1 
iter: 3  value: 3553.128 mgc: 1.834492e-05 ustep: 1 
iter: 4  mgc: 5.503376e-13 
iter: 1  mgc: 5.503376e-13 
outer mgc:  8.39203 
iter: 1  value: 3543.654 mgc: 3.560127 ustep: 1 
iter: 2  value: 3543.654 mgc: 0.06045272 ustep: 1 
iter: 3  value: 3543.654 mgc: 7.411525e-06 ustep: 1 
iter: 4  mgc: 3.106404e-13 
iter: 1  value: 3548.085 mgc: 0.9977445 ustep: 1 
iter: 2  value: 3548.085 mgc: 0.00939141 ustep: 1 
iter: 3  value: 3548.085 mgc: 6.711429e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  3.295395 
iter: 1  value: 3542.29 mgc: 1.899215 ustep: 1 
iter: 2  value: 3542.29 mgc: 0.0007535142 ustep: 1 
iter: 3  mgc: 2.027403e-09 
iter: 1  value: 3546.211 mgc: 0.6117387 ustep: 1 
iter: 2  value: 3546.211 mgc: 0.0001462968 ustep: 1 
iter: 3  mgc: 7.230505e-11 
iter: 1  mgc: 7.230505e-11 
outer mgc:  3.2717 
iter: 1  value: 3544.226 mgc: 0.8794764 ustep: 1 
iter: 2  value: 3544.226 mgc: 0.00410777 ustep: 1 
iter: 3  value: 3544.226 mgc: 9.655306e-08 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  1.277622 
iter: 1  value: 3541.441 mgc: 0.8132343 ustep: 1 
iter: 2  value: 3541.441 mgc: 0.003907094 ustep: 1 
iter: 3  value: 3541.441 mgc: 8.652173e-08 ustep: 1 
mgc: 2.664535e-15 
iter: 1  mgc: 2.664535e-15 
outer mgc:  0.6937768 
iter: 1  value: 3538.778 mgc: 0.3997294 ustep: 1 
iter: 2  value: 3538.778 mgc: 0.0002858206 ustep: 1 
iter: 3  mgc: 2.387717e-10 
iter: 1  mgc: 2.387717e-10 
outer mgc:  2.117013 
iter: 1  value: 3536.341 mgc: 1.142631 ustep: 1 
iter: 2  value: 3536.341 mgc: 0.001289203 ustep: 1 
iter: 3  mgc: 8.275867e-09 
iter: 1  mgc: 8.275867e-09 
outer mgc:  0.6481505 
iter: 1  value: 3534.945 mgc: 0.4656555 ustep: 1 
iter: 2  value: 3534.945 mgc: 0.0003631971 ustep: 1 
iter: 3  mgc: 5.857017e-10 
iter: 1  value: 3535.654 mgc: 0.2102069 ustep: 1 
iter: 2  value: 3535.654 mgc: 8.087901e-05 ustep: 1 
iter: 3  mgc: 3.140199e-11 
iter: 1  mgc: 3.140199e-11 
outer mgc:  0.7468963 
iter: 1  value: 3534.302 mgc: 0.4915702 ustep: 1 
iter: 2  value: 3534.302 mgc: 0.0001553502 ustep: 1 
iter: 3  mgc: 1.092615e-10 
iter: 1  mgc: 1.092615e-10 
outer mgc:  0.511227 
iter: 1  value: 3532.835 mgc: 0.7520695 ustep: 1 
iter: 2  value: 3532.835 mgc: 4.769486e-05 ustep: 1 
iter: 3  mgc: 1.667777e-11 
iter: 1  value: 3530.904 mgc: 1.147328 ustep: 1 
iter: 2  value: 3530.904 mgc: 7.88883e-05 ustep: 1 
iter: 3  mgc: 4.499734e-11 
iter: 1  mgc: 4.499734e-11 
outer mgc:  1.275011 
iter: 1  value: 3527.28 mgc: 1.767852 ustep: 1 
iter: 2  value: 3527.28 mgc: 0.0003767028 ustep: 1 
iter: 3  mgc: 6.288845e-10 
iter: 1  value: 3523.357 mgc: 2.043355 ustep: 1 
iter: 2  value: 3523.357 mgc: 0.0004590826 ustep: 1 
iter: 3  mgc: 7.370158e-10 
iter: 1  mgc: 7.370158e-10 
outer mgc:  0.4518752 
iter: 1  value: 3515.973 mgc: 4.482632 ustep: 1 
iter: 2  value: 3515.973 mgc: 0.001189282 ustep: 1 
iter: 3  mgc: 3.348838e-09 
iter: 1  value: 3520.341 mgc: 1.408427 ustep: 1 
iter: 2  value: 3520.341 mgc: 0.0002117968 ustep: 1 
iter: 3  mgc: 1.329523e-10 
iter: 1  mgc: 1.329523e-10 
outer mgc:  0.3204131 
iter: 1  value: 3517.166 mgc: 1.902182 ustep: 1 
iter: 2  value: 3517.166 mgc: 0.0001613656 ustep: 1 
iter: 3  mgc: 7.143885e-11 
iter: 1  mgc: 7.143885e-11 
outer mgc:  0.1309377 
iter: 1  value: 3514.017 mgc: 2.348227 ustep: 1 
iter: 2  value: 3514.017 mgc: 0.0001205149 ustep: 1 
iter: 3  mgc: 3.667777e-11 
iter: 1  mgc: 3.667777e-11 
outer mgc:  0.04858073 
iter: 1  value: 3509.318 mgc: 4.534105 ustep: 1 
iter: 2  value: 3509.318 mgc: 0.0001550379 ustep: 1 
iter: 3  mgc: 5.479972e-11 
iter: 1  mgc: 5.479972e-11 
outer mgc:  0.02311413 
iter: 1  value: 3506.844 mgc: 2.785531 ustep: 1 
iter: 2  value: 3506.844 mgc: 1.367867e-05 ustep: 1 
iter: 3  mgc: 4.507505e-13 
iter: 1  mgc: 4.507505e-13 
outer mgc:  0.01766671 
iter: 1  value: 3504.949 mgc: 2.693808 ustep: 1 
iter: 2  value: 3504.949 mgc: 7.837697e-06 ustep: 1 
iter: 3  mgc: 4.62963e-14 
iter: 1  mgc: 4.62963e-14 
outer mgc:  0.01471752 
iter: 1  value: 3503.804 mgc: 2.18685 ustep: 1 
iter: 2  value: 3503.804 mgc: 1.631131e-05 ustep: 1 
iter: 3  mgc: 5.671019e-13 
iter: 1  mgc: 5.671019e-13 
outer mgc:  0.008352004 
iter: 1  value: 3503.433 mgc: 1.262605 ustep: 1 
iter: 2  value: 3503.433 mgc: 2.55353e-05 ustep: 1 
iter: 3  mgc: 1.41398e-12 
iter: 1  mgc: 1.41398e-12 
outer mgc:  0.005536817 
iter: 1  value: 3503.703 mgc: 0.07497903 ustep: 1 
iter: 2  value: 3503.703 mgc: 1.384026e-05 ustep: 1 
iter: 3  mgc: 4.556355e-13 
iter: 1  mgc: 4.556355e-13 
outer mgc:  0.005543689 
iter: 1  value: 3504.102 mgc: 0.4791827 ustep: 1 
iter: 2  value: 3504.102 mgc: 5.240411e-06 ustep: 1 
iter: 3  mgc: 6.439294e-14 
iter: 1  mgc: 6.439294e-14 
outer mgc:  0.007780799 
iter: 1  value: 3505.137 mgc: 1.654338 ustep: 1 
iter: 2  value: 3505.137 mgc: 2.138366e-05 ustep: 1 
iter: 3  mgc: 1.187939e-12 
iter: 1  mgc: 1.187939e-12 
outer mgc:  0.01242082 
iter: 1  value: 3505.575 mgc: 1.305832 ustep: 1 
iter: 2  value: 3505.575 mgc: 4.317156e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
iter: 1  mgc: 5.284662e-14 
outer mgc:  0.0137261 
iter: 1  value: 3505.679 mgc: 3.160564 ustep: 1 
iter: 2  value: 3505.679 mgc: 1.23169e-05 ustep: 1 
iter: 3  mgc: 2.93543e-13 
iter: 1  mgc: 2.93543e-13 
outer mgc:  0.01401136 
iter: 1  value: 3504.047 mgc: 3.092651 ustep: 1 
iter: 2  value: 3504.047 mgc: 7.653983e-06 ustep: 1 
iter: 3  mgc: 1.182388e-13 
iter: 1  mgc: 1.182388e-13 
outer mgc:  0.01147931 
iter: 1  value: 3499.467 mgc: 2.019864 ustep: 1 
iter: 2  value: 3499.467 mgc: 1.173915e-05 ustep: 1 
iter: 3  mgc: 3.246292e-13 
iter: 1  mgc: 3.246292e-13 
outer mgc:  0.006151598 
iter: 1  value: 3495.173 mgc: 2.335736 ustep: 1 
iter: 2  value: 3495.173 mgc: 9.823026e-06 ustep: 1 
iter: 3  mgc: 2.269296e-13 
iter: 1  mgc: 2.269296e-13 
outer mgc:  0.004080378 
iter: 1  value: 3491.79 mgc: 1.50851 ustep: 1 
iter: 2  value: 3491.79 mgc: 2.35814e-06 ustep: 1 
iter: 3  mgc: 3.671369e-14 
iter: 1  mgc: 3.671369e-14 
outer mgc:  0.00243566 
iter: 1  value: 3487.514 mgc: 1.870377 ustep: 1 
iter: 2  value: 3487.514 mgc: 5.093836e-07 ustep: 1 
iter: 3  mgc: 5.373479e-14 
iter: 1  mgc: 5.373479e-14 
outer mgc:  0.001134256 
iter: 1  value: 3484.255 mgc: 3.409547 ustep: 1 
iter: 2  value: 3484.255 mgc: 2.287526e-07 ustep: 1 
iter: 3  mgc: 5.768996e-14 
iter: 1  mgc: 5.768996e-14 
outer mgc:  0.000948139 
iter: 1  value: 3480.274 mgc: 7.558987 ustep: 1 
iter: 2  value: 3480.274 mgc: 1.212192e-06 ustep: 1 
iter: 3  mgc: 5.995204e-14 
iter: 1  mgc: 5.995204e-14 
outer mgc:  0.0004755014 
iter: 1  value: 3476.937 mgc: 6.738059 ustep: 1 
iter: 2  value: 3476.937 mgc: 5.141194e-07 ustep: 1 
iter: 3  mgc: 1.603162e-13 
iter: 1  mgc: 1.603162e-13 
outer mgc:  0.0005824322 
iter: 1  value: 3473.026 mgc: 5.580644 ustep: 1 
iter: 2  value: 3473.026 mgc: 1.093875e-07 ustep: 1 
mgc: 3.428369e-13 
iter: 1  mgc: 3.428369e-13 
outer mgc:  0.0006786355 
iter: 1  value: 3469.655 mgc: 1.415723 ustep: 1 
iter: 2  mgc: 9.426901e-09 
iter: 1  mgc: 9.426901e-09 
outer mgc:  0.0005265133 
iter: 1  value: 3465.328 mgc: 4.431965 ustep: 1 
iter: 2  value: 3465.328 mgc: 8.703296e-08 ustep: 1 
mgc: 5.784262e-13 
iter: 1  mgc: 5.784262e-13 
outer mgc:  0.0001971209 
iter: 1  value: 3461.777 mgc: 3.782126 ustep: 1 
iter: 2  value: 3461.777 mgc: 3.411453e-08 ustep: 1 
mgc: 7.058798e-13 
iter: 1  mgc: 7.058798e-13 
outer mgc:  6.618165e-05 
iter: 1  value: 3457.641 mgc: 1.9149 ustep: 1 
iter: 2  mgc: 4.534674e-09 
iter: 1  mgc: 4.534674e-09 
outer mgc:  0.000135941 
iter: 1  value: 3454.242 mgc: 5.019763 ustep: 1 
iter: 2  mgc: 2.462477e-09 
iter: 1  mgc: 2.462477e-09 
outer mgc:  0.0001004746 
iter: 1  value: 3450.046 mgc: 11.75749 ustep: 1 
iter: 2  value: 3450.046 mgc: 1.096304e-08 ustep: 1 
mgc: 1.854961e-12 
iter: 1  mgc: 1.854961e-12 
outer mgc:  2.335732e-05 
iter: 1  value: 3446.577 mgc: 9.660251 ustep: 1 
iter: 2  mgc: 3.781732e-09 
iter: 1  mgc: 3.781732e-09 
outer mgc:  4.148716e-05 
iter: 1  value: 3442.423 mgc: 7.050334 ustep: 1 
iter: 2  mgc: 5.840866e-10 
iter: 1  mgc: 5.840866e-10 
outer mgc:  5.926308e-05 
iter: 1  value: 3438.977 mgc: 2.429459 ustep: 1 
iter: 2  mgc: 1.872462e-10 
iter: 1  mgc: 1.872462e-10 
outer mgc:  4.224157e-05 
iter: 1  value: 3434.764 mgc: 10.74109 ustep: 1 
iter: 2  mgc: 8.750769e-10 
iter: 1  mgc: 8.750769e-10 
outer mgc:  1.027953e-05 
iter: 1  value: 3431.287 mgc: 8.533614 ustep: 1 
iter: 2  mgc: 2.849214e-10 
iter: 1  mgc: 2.849214e-10 
outer mgc:  7.93635e-06 
iter: 1  mgc: 2.849214e-10 
iter: 1  mgc: 2.849214e-10 
outer mgc:  7.93635e-06 
iter: 1  value: 3431.288 mgc: 0.004084531 ustep: 1 
iter: 2  mgc: 7.263186e-10 
outer mgc:  0.06006859 
iter: 1  value: 3431.287 mgc: 0.004082629 ustep: 1 
iter: 2  mgc: 7.242524e-10 
outer mgc:  0.0600064 
iter: 1  value: 3431.287 mgc: 0.002400411 ustep: 1 
iter: 2  mgc: 4.614522e-10 
outer mgc:  0.03263077 
iter: 1  value: 3431.287 mgc: 0.002399876 ustep: 1 
iter: 2  mgc: 4.62955e-10 
outer mgc:  0.03259293 
iter: 1  value: 3431.286 mgc: 0.003595997 ustep: 1 
iter: 2  value: 3431.286 mgc: 2.275791e-08 ustep: 1 
mgc: 1.616967e-11 
outer mgc:  0.04944214 
iter: 1  value: 3431.288 mgc: 0.003593772 ustep: 1 
iter: 2  value: 3431.288 mgc: 2.275479e-08 ustep: 1 
mgc: 1.958256e-11 
outer mgc:  0.04940659 
iter: 1  value: 3431.287 mgc: 0.002298704 ustep: 1 
iter: 2  mgc: 8.238009e-09 
outer mgc:  0.02294444 
iter: 1  value: 3431.287 mgc: 0.002297699 ustep: 1 
iter: 2  mgc: 8.236084e-09 
outer mgc:  0.02292551 
iter: 1  value: 3431.307 mgc: 75.71835 ustep: 1 
iter: 2  mgc: 2.121796e-09 
outer mgc:  7.685332e-05 
iter: 1  value: 3431.267 mgc: 75.94584 ustep: 1 
iter: 2  mgc: 2.117982e-09 
outer mgc:  7.403581e-05 
iter: 1  value: 3431.305 mgc: 75.79176 ustep: 1 
iter: 2  value: 3431.305 mgc: 8.813325e-08 ustep: 1 
mgc: 2.173439e-11 
outer mgc:  0.002083511 
iter: 1  value: 3431.269 mgc: 75.86759 ustep: 1 
iter: 2  value: 3431.269 mgc: 8.784981e-08 ustep: 1 
mgc: 1.562306e-11 
outer mgc:  0.002079322 
iter: 1  value: 3431.287 mgc: 0.0001487093 ustep: 1 
mgc: 9.580559e-12 
outer mgc:  7.936372e-06 
iter: 1  value: 3431.287 mgc: 0.0001487074 ustep: 1 
mgc: 1.454481e-11 
outer mgc:  7.936331e-06 
iter: 1  value: 3431.286 mgc: 0.003091373 ustep: 1 
iter: 2  value: 3431.286 mgc: 1.347877e-08 ustep: 1 
mgc: 1.497735e-11 
outer mgc:  0.03668414 
iter: 1  value: 3431.288 mgc: 0.003088603 ustep: 1 
iter: 2  value: 3431.288 mgc: 1.343383e-08 ustep: 1 
mgc: 2.54396e-11 
outer mgc:  0.03667168 
[Mon Aug 16 00:12:03 2021]
Finished job 0.
1 of 1 steps (100%) done

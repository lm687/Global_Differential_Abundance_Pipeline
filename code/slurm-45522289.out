Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:16:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22186.475170 
iter  10 value 20324.513249
iter  10 value 20324.513249
final  value 20324.513249 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8079.4 mgc: 116.0965 ustep: 1 
iter: 2  value: 7976.508 mgc: 79.74566 ustep: 0.2494656 
iter: 3  value: 4436.207 mgc: 160.1269 ustep: 0.08285847 
iter: 4  value: 3064.238 mgc: 165.3784 ustep: 0.08137205 
iter: 5  value: 2784.984 mgc: 85.20765 ustep: 0.2853293 
iter: 6  value: 2774.1 mgc: 15.27144 ustep: 0.5342089 
iter: 7  value: 2774.006 mgc: 1.952052 ustep: 0.7309228 
iter: 8  value: 2774.006 mgc: 0.08779802 ustep: 0.8549548 
iter: 9  value: 2774.006 mgc: 0.0008213995 ustep: 0.9246452 
iter: 10  value: 2774.006 mgc: 3.238685e-06 ustep: 0.9615886 
iter: 11  value: 2774.006 mgc: 3.082482e-08 ustep: 0.9806082 
iter: 12  mgc: 1.601528e-10 
iter: 1  mgc: 1.601528e-10 
Matching hessian patterns... Done
outer mgc:  791.9048 
iter: 1  value: 2505.273 mgc: 28.75673 ustep: 1 
iter: 2  value: 2470.451 mgc: 6.635605 ustep: 1 
iter: 3  value: 2470.368 mgc: 0.4283905 ustep: 1 
iter: 4  value: 2470.368 mgc: 0.002722446 ustep: 1 
iter: 5  value: 2470.368 mgc: 1.636706e-07 ustep: 1 
iter: 6  mgc: 3.291811e-14 
iter: 1  mgc: 3.291811e-14 
outer mgc:  509.3665 
iter: 1  value: 2361.087 mgc: 18.18899 ustep: 1 
iter: 2  value: 2360.174 mgc: 2.041971 ustep: 1 
iter: 3  value: 2360.174 mgc: 0.02754224 ustep: 1 
iter: 4  value: 2360.174 mgc: 5.319272e-06 ustep: 1 
iter: 5  mgc: 1.954964e-13 
iter: 1  mgc: 1.954964e-13 
outer mgc:  384.0651 
iter: 1  value: 2245.405 mgc: 34.28848 ustep: 1 
iter: 2  value: 2213.664 mgc: 7.930281 ustep: 1 
iter: 3  value: 2213.591 mgc: 0.5144207 ustep: 1 
iter: 4  value: 2213.591 mgc: 0.004777209 ustep: 1 
iter: 5  value: 2213.591 mgc: 5.09143e-07 ustep: 1 
iter: 6  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  143.5302 
iter: 1  value: 2188.486 mgc: 13.78956 ustep: 1 
iter: 2  value: 2187.601 mgc: 1.866604 ustep: 1 
iter: 3  value: 2187.601 mgc: 0.04275486 ustep: 1 
iter: 4  value: 2187.601 mgc: 2.398305e-05 ustep: 1 
iter: 5  mgc: 7.548628e-12 
iter: 1  mgc: 7.548628e-12 
outer mgc:  176.6471 
iter: 1  value: 2170.632 mgc: 25.92791 ustep: 1 
iter: 2  value: 2168.424 mgc: 3.267641 ustep: 1 
iter: 3  value: 2168.424 mgc: 0.07392194 ustep: 1 
iter: 4  value: 2168.424 mgc: 6.003317e-05 ustep: 1 
iter: 5  mgc: 3.895018e-11 
iter: 1  value: 2153.157 mgc: 9.719952 ustep: 1 
iter: 2  value: 2153.047 mgc: 0.5646933 ustep: 1 
iter: 3  value: 2153.047 mgc: 0.004131131 ustep: 1 
iter: 4  value: 2153.047 mgc: 4.143519e-07 ustep: 1 
iter: 5  mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  139.9605 
iter: 1  value: 2161.158 mgc: 10.83633 ustep: 1 
iter: 2  value: 2160.926 mgc: 0.5402828 ustep: 1 
iter: 3  value: 2160.926 mgc: 0.001766515 ustep: 1 
iter: 4  value: 2160.926 mgc: 4.676021e-08 ustep: 1 
mgc: 3.763656e-14 
iter: 1  value: 2149.184 mgc: 5.129539 ustep: 1 
iter: 2  value: 2149.181 mgc: 0.1033054 ustep: 1 
iter: 3  value: 2149.181 mgc: 5.655584e-05 ustep: 1 
iter: 4  mgc: 1.722711e-11 
iter: 1  mgc: 1.722711e-11 
outer mgc:  136.815 
iter: 1  value: 2146.788 mgc: 12.05142 ustep: 1 
iter: 2  value: 2146.622 mgc: 0.5200726 ustep: 1 
iter: 3  value: 2146.622 mgc: 0.00151767 ustep: 1 
iter: 4  value: 2146.622 mgc: 1.361174e-08 ustep: 1 
mgc: 4.818368e-14 
iter: 1  mgc: 4.818368e-14 
outer mgc:  65.68406 
iter: 1  value: 2138.604 mgc: 9.566115 ustep: 1 
iter: 2  value: 2138.574 mgc: 0.2612435 ustep: 1 
iter: 3  value: 2138.574 mgc: 0.0004555675 ustep: 1 
iter: 4  mgc: 2.988727e-09 
iter: 1  mgc: 2.988727e-09 
outer mgc:  19.7267 
iter: 1  value: 2136.553 mgc: 4.552961 ustep: 1 
iter: 2  value: 2136.544 mgc: 0.1230783 ustep: 1 
iter: 3  value: 2136.544 mgc: 0.0002027874 ustep: 1 
iter: 4  mgc: 6.347198e-10 
iter: 1  mgc: 6.347198e-10 
outer mgc:  39.22313 
iter: 1  value: 2135.194 mgc: 1.923183 ustep: 1 
iter: 2  value: 2135.194 mgc: 0.04583056 ustep: 1 
iter: 3  value: 2135.194 mgc: 1.89569e-05 ustep: 1 
iter: 4  mgc: 4.111378e-12 
iter: 1  mgc: 4.111378e-12 
outer mgc:  87.86275 
iter: 1  value: 2133.008 mgc: 4.669347 ustep: 1 
iter: 2  value: 2133.006 mgc: 0.08970852 ustep: 1 
iter: 3  value: 2133.006 mgc: 7.926734e-05 ustep: 1 
iter: 4  mgc: 9.907275e-11 
iter: 1  mgc: 9.907275e-11 
outer mgc:  51.80505 
iter: 1  value: 2131.489 mgc: 5.093462 ustep: 1 
iter: 2  value: 2131.482 mgc: 0.124756 ustep: 1 
iter: 3  value: 2131.482 mgc: 0.0001747226 ustep: 1 
iter: 4  mgc: 3.448384e-10 
iter: 1  mgc: 3.448384e-10 
outer mgc:  20.55956 
iter: 1  value: 2134.781 mgc: 8.081735 ustep: 1 
iter: 2  value: 2134.749 mgc: 0.2369073 ustep: 1 
iter: 3  value: 2134.749 mgc: 0.000310494 ustep: 1 
iter: 4  mgc: 1.081441e-09 
iter: 1  value: 2130.789 mgc: 2.718073 ustep: 1 
iter: 2  value: 2130.789 mgc: 0.02662855 ustep: 1 
iter: 3  value: 2130.789 mgc: 4.446546e-06 ustep: 1 
iter: 4  mgc: 2.269296e-13 
iter: 1  mgc: 2.269296e-13 
outer mgc:  11.4295 
iter: 1  value: 2131.284 mgc: 0.9442757 ustep: 1 
iter: 2  value: 2131.284 mgc: 0.005110531 ustep: 1 
iter: 3  value: 2131.284 mgc: 3.346169e-07 ustep: 1 
iter: 4  mgc: 3.597123e-14 
iter: 1  value: 2130.584 mgc: 0.3353331 ustep: 1 
iter: 2  value: 2130.584 mgc: 0.0006405344 ustep: 1 
iter: 3  mgc: 5.303503e-09 
iter: 1  mgc: 5.303503e-09 
outer mgc:  7.526837 
iter: 1  value: 2130.824 mgc: 1.162027 ustep: 1 
iter: 2  value: 2130.824 mgc: 0.003810753 ustep: 1 
iter: 3  value: 2130.824 mgc: 7.573052e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  value: 2130.573 mgc: 0.4409598 ustep: 1 
iter: 2  value: 2130.573 mgc: 0.0005525604 ustep: 1 
iter: 3  mgc: 1.594087e-09 
iter: 1  mgc: 1.594087e-09 
outer mgc:  3.76298 
iter: 1  value: 2130.519 mgc: 0.2944102 ustep: 1 
iter: 2  value: 2130.519 mgc: 0.0002593949 ustep: 1 
iter: 3  mgc: 5.212715e-10 
iter: 1  mgc: 5.212715e-10 
outer mgc:  3.731659 
iter: 1  value: 2130.46 mgc: 0.2186773 ustep: 1 
iter: 2  value: 2130.46 mgc: 0.0002519112 ustep: 1 
iter: 3  mgc: 9.40017e-10 
iter: 1  mgc: 9.40017e-10 
outer mgc:  5.694411 
iter: 1  value: 2130.556 mgc: 0.5241409 ustep: 1 
iter: 2  value: 2130.556 mgc: 0.001871514 ustep: 1 
iter: 3  value: 2130.556 mgc: 7.275042e-08 ustep: 1 
mgc: 4.246603e-14 
iter: 1  mgc: 4.246603e-14 
outer mgc:  4.918195 
iter: 1  value: 2130.939 mgc: 2.163581 ustep: 1 
iter: 2  value: 2130.939 mgc: 0.01305419 ustep: 1 
iter: 3  value: 2130.939 mgc: 1.086583e-06 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 2130.59 mgc: 0.6933537 ustep: 1 
iter: 2  value: 2130.59 mgc: 0.001344778 ustep: 1 
iter: 3  mgc: 8.731309e-09 
iter: 1  mgc: 8.731309e-09 
outer mgc:  5.416345 
iter: 1  value: 2130.398 mgc: 0.3648438 ustep: 1 
iter: 2  value: 2130.398 mgc: 0.0003356587 ustep: 1 
iter: 3  mgc: 5.098324e-10 
iter: 1  mgc: 5.098324e-10 
outer mgc:  2.606625 
iter: 1  value: 2130.556 mgc: 0.09811459 ustep: 1 
iter: 2  value: 2130.556 mgc: 0.0001583439 ustep: 1 
iter: 3  mgc: 4.144871e-10 
iter: 1  mgc: 4.144871e-10 
outer mgc:  2.125248 
iter: 1  value: 2130.53 mgc: 0.2842221 ustep: 1 
iter: 2  value: 2130.53 mgc: 0.0004100057 ustep: 1 
iter: 3  mgc: 8.73253e-10 
iter: 1  mgc: 8.73253e-10 
outer mgc:  1.360975 
iter: 1  value: 2130.41 mgc: 0.2329915 ustep: 1 
iter: 2  value: 2130.41 mgc: 0.000379724 ustep: 1 
iter: 3  mgc: 1.459446e-09 
iter: 1  mgc: 1.459446e-09 
outer mgc:  1.681018 
iter: 1  value: 2130.43 mgc: 0.3025009 ustep: 1 
iter: 2  value: 2130.43 mgc: 0.0002842294 ustep: 1 
iter: 3  mgc: 6.575345e-10 
iter: 1  value: 2130.412 mgc: 0.1065069 ustep: 1 
iter: 2  value: 2130.412 mgc: 3.528951e-05 ustep: 1 
iter: 3  mgc: 1.014477e-11 
iter: 1  mgc: 1.014477e-11 
outer mgc:  0.8140625 
iter: 1  value: 2130.439 mgc: 0.03138222 ustep: 1 
iter: 2  value: 2130.439 mgc: 4.724436e-06 ustep: 1 
iter: 3  mgc: 5.107026e-13 
iter: 1  mgc: 5.107026e-13 
outer mgc:  0.8849171 
iter: 1  value: 2130.506 mgc: 0.03576408 ustep: 1 
iter: 2  value: 2130.506 mgc: 2.046022e-05 ustep: 1 
iter: 3  mgc: 6.886935e-12 
iter: 1  mgc: 6.886935e-12 
outer mgc:  0.9687879 
iter: 1  value: 2130.469 mgc: 0.1107685 ustep: 1 
iter: 2  value: 2130.469 mgc: 5.969673e-05 ustep: 1 
iter: 3  mgc: 3.08642e-11 
iter: 1  mgc: 3.08642e-11 
outer mgc:  0.5474132 
iter: 1  value: 2130.519 mgc: 0.2356938 ustep: 1 
iter: 2  value: 2130.519 mgc: 0.0001535215 ustep: 1 
iter: 3  mgc: 2.01937e-10 
iter: 1  value: 2130.477 mgc: 0.04532629 ustep: 1 
iter: 2  value: 2130.477 mgc: 5.695615e-06 ustep: 1 
iter: 3  mgc: 2.805256e-13 
iter: 1  mgc: 2.805256e-13 
outer mgc:  0.317257 
iter: 1  value: 2130.482 mgc: 0.006969014 ustep: 1 
iter: 2  value: 2130.482 mgc: 5.197514e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.4368337 
iter: 1  value: 2130.489 mgc: 0.01134436 ustep: 1 
iter: 2  value: 2130.489 mgc: 1.857151e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  0.1422626 
iter: 1  value: 2130.511 mgc: 0.07268602 ustep: 1 
iter: 2  value: 2130.511 mgc: 1.673573e-05 ustep: 1 
iter: 3  mgc: 1.561612e-12 
iter: 1  value: 2130.497 mgc: 0.02687064 ustep: 1 
iter: 2  value: 2130.497 mgc: 2.288693e-06 ustep: 1 
iter: 3  mgc: 6.483702e-14 
iter: 1  mgc: 6.483702e-14 
outer mgc:  0.1912793 
iter: 1  value: 2130.502 mgc: 0.008108446 ustep: 1 
iter: 2  value: 2130.502 mgc: 4.843575e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.0588387 
iter: 1  value: 2130.506 mgc: 0.01378509 ustep: 1 
iter: 2  value: 2130.506 mgc: 6.936659e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.1617683 
iter: 1  value: 2130.508 mgc: 0.005296595 ustep: 1 
iter: 2  value: 2130.508 mgc: 4.026983e-07 ustep: 1 
iter: 3  mgc: 3.33622e-14 
iter: 1  mgc: 3.33622e-14 
outer mgc:  0.06685 
iter: 1  value: 2130.508 mgc: 0.004525523 ustep: 1 
iter: 2  value: 2130.508 mgc: 3.14025e-07 ustep: 1 
iter: 3  mgc: 3.708145e-14 
iter: 1  mgc: 3.708145e-14 
outer mgc:  0.04513974 
iter: 1  value: 2130.511 mgc: 0.001994244 ustep: 1 
iter: 2  value: 2130.511 mgc: 6.46541e-08 ustep: 1 
mgc: 4.796163e-14 
iter: 1  mgc: 4.796163e-14 
outer mgc:  0.01925347 
iter: 1  value: 2130.509 mgc: 0.0009532671 ustep: 1 
iter: 2  value: 2130.509 mgc: 1.485592e-08 ustep: 1 
mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.01435866 
iter: 1  value: 2130.509 mgc: 0.00066194 ustep: 1 
iter: 2  mgc: 5.294565e-09 
iter: 1  value: 2130.509 mgc: 0.0003361017 ustep: 1 
iter: 2  mgc: 7.903038e-10 
iter: 1  mgc: 7.903038e-10 
outer mgc:  0.005518867 
iter: 1  value: 2130.509 mgc: 0.0001695007 ustep: 1 
iter: 2  mgc: 1.573301e-10 
iter: 1  mgc: 1.573301e-10 
outer mgc:  0.0006910933 
iter: 1  mgc: 1.573301e-10 
iter: 1  mgc: 1.573301e-10 
outer mgc:  0.0006910933 
iter: 1  value: 2130.507 mgc: 0.04903644 ustep: 1 
iter: 2  value: 2130.507 mgc: 8.292083e-06 ustep: 1 
iter: 3  mgc: 4.467537e-13 
outer mgc:  0.3993035 
iter: 1  value: 2130.512 mgc: 0.04902688 ustep: 1 
iter: 2  value: 2130.512 mgc: 8.302141e-06 ustep: 1 
iter: 3  mgc: 4.392042e-13 
outer mgc:  0.3994878 
iter: 1  value: 2130.507 mgc: 0.02317874 ustep: 1 
iter: 2  value: 2130.507 mgc: 1.59984e-06 ustep: 1 
iter: 3  mgc: 4.884981e-14 
outer mgc:  0.7615746 
iter: 1  value: 2130.512 mgc: 0.0231711 ustep: 1 
iter: 2  value: 2130.512 mgc: 1.598893e-06 ustep: 1 
iter: 3  mgc: 4.840572e-14 
outer mgc:  0.7615315 
iter: 1  value: 2130.512 mgc: 0.05555101 ustep: 1 
iter: 2  value: 2130.512 mgc: 8.527858e-06 ustep: 1 
iter: 3  mgc: 4.272138e-13 
outer mgc:  0.372074 
iter: 1  value: 2130.507 mgc: 0.05554857 ustep: 1 
iter: 2  value: 2130.507 mgc: 8.51906e-06 ustep: 1 
iter: 3  mgc: 4.352074e-13 
outer mgc:  0.3727183 
iter: 1  value: 2130.513 mgc: 0.02886066 ustep: 1 
iter: 2  value: 2130.513 mgc: 2.415214e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  1.243606 
iter: 1  value: 2130.506 mgc: 0.02885865 ustep: 1 
iter: 2  value: 2130.506 mgc: 2.416684e-06 ustep: 1 
iter: 3  mgc: 4.568568e-14 
outer mgc:  1.245038 
iter: 1  value: 2130.503 mgc: 0.006874488 ustep: 1 
iter: 2  value: 2130.503 mgc: 4.848944e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.07024916 
iter: 1  value: 2130.515 mgc: 0.006866036 ustep: 1 
iter: 2  value: 2130.515 mgc: 4.842137e-07 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.07050369 
iter: 1  value: 2130.526 mgc: 0.01124705 ustep: 1 
iter: 2  value: 2130.526 mgc: 2.07909e-06 ustep: 1 
iter: 3  mgc: 7.638334e-14 
outer mgc:  0.1613162 
iter: 1  value: 2130.492 mgc: 0.01127158 ustep: 1 
iter: 2  value: 2130.492 mgc: 2.084511e-06 ustep: 1 
iter: 3  mgc: 7.283063e-14 
outer mgc:  0.1623194 
iter: 1  value: 2130.518 mgc: 0.01346464 ustep: 1 
iter: 2  value: 2130.518 mgc: 1.844723e-06 ustep: 1 
iter: 3  mgc: 5.062617e-14 
outer mgc:  0.1948099 
iter: 1  value: 2130.501 mgc: 0.01349373 ustep: 1 
iter: 2  value: 2130.501 mgc: 1.851645e-06 ustep: 1 
iter: 3  mgc: 5.151435e-14 
outer mgc:  0.1936967 
[Fri Aug 13 12:16:50 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:42:40 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2238.971844 
iter  10 value 1440.887610
final  value 1440.824745 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1356.02 mgc: 4.071676 ustep: 0.3130298 
iter: 2  value: 1351.872 mgc: 1.659831 ustep: 0.5595347 
iter: 3  value: 1351.431 mgc: 0.3486082 ustep: 0.7480457 
iter: 4  value: 1351.396 mgc: 0.0895591 ustep: 0.8649099 
iter: 5  value: 1351.395 mgc: 0.01760109 ustep: 0.9300123 
iter: 6  value: 1351.395 mgc: 0.001993686 ustep: 0.964375 
iter: 7  value: 1351.395 mgc: 0.0001143173 ustep: 0.9820278 
iter: 8  value: 1351.395 mgc: 3.226815e-06 ustep: 0.990974 
iter: 9  value: 1351.395 mgc: 4.527759e-08 ustep: 0.9954772 
iter: 10  mgc: 3.178787e-10 
iter: 1  mgc: 3.178787e-10 
Matching hessian patterns... Done
outer mgc:  15.34882 
iter: 1  value: 1341.76 mgc: 0.8446413 ustep: 1 
iter: 2  value: 1341.751 mgc: 0.08084231 ustep: 1 
iter: 3  value: 1341.751 mgc: 0.0007459892 ustep: 1 
iter: 4  value: 1341.751 mgc: 8.434011e-08 ustep: 1 
iter: 5  mgc: 1.512679e-15 
iter: 1  mgc: 1.512679e-15 
outer mgc:  7.431163 
iter: 1  value: 1327.681 mgc: 0.7185789 ustep: 1 
iter: 2  value: 1327.68 mgc: 0.03838594 ustep: 1 
iter: 3  value: 1327.68 mgc: 6.896549e-05 ustep: 1 
iter: 4  mgc: 3.572453e-10 
iter: 1  mgc: 3.572453e-10 
outer mgc:  6.0985 
iter: 1  value: 1318.359 mgc: 2.719044 ustep: 1 
iter: 2  value: 1317.277 mgc: 1.359896 ustep: 1 
iter: 3  value: 1317.274 mgc: 0.06771087 ustep: 1 
iter: 4  value: 1317.274 mgc: 0.000654625 ustep: 1 
iter: 5  value: 1317.274 mgc: 7.901466e-08 ustep: 1 
iter: 6  mgc: 2.969847e-15 
iter: 1  mgc: 2.969847e-15 
outer mgc:  6.824813 
iter: 1  value: 1309.319 mgc: 2.308347 ustep: 1 
iter: 2  value: 1309.258 mgc: 0.3453329 ustep: 1 
iter: 3  value: 1309.258 mgc: 0.01014123 ustep: 1 
iter: 4  value: 1309.258 mgc: 1.24317e-05 ustep: 1 
iter: 5  mgc: 1.973688e-11 
iter: 1  mgc: 1.973688e-11 
outer mgc:  5.617647 
iter: 1  value: 1305.847 mgc: 4.384937 ustep: 1 
iter: 2  value: 1302.312 mgc: 2.701529 ustep: 1 
iter: 3  value: 1302.293 mgc: 0.2249049 ustep: 1 
iter: 4  value: 1302.293 mgc: 0.005908365 ustep: 1 
iter: 5  value: 1302.293 mgc: 4.440253e-06 ustep: 1 
iter: 6  mgc: 2.508882e-12 
iter: 1  mgc: 2.508882e-12 
outer mgc:  6.283683 
iter: 1  value: 1312.843 mgc: 8.467066 ustep: 1 
iter: 2  value: 1293.511 mgc: 6.920125 ustep: 1 
iter: 3  value: 1293.378 mgc: 0.5732771 ustep: 1 
iter: 4  value: 1293.378 mgc: 0.01618199 ustep: 1 
iter: 5  value: 1293.378 mgc: 1.489137e-05 ustep: 1 
iter: 6  mgc: 1.256595e-11 
iter: 1  mgc: 1.256595e-11 
outer mgc:  8.717025 
iter: 1  value: 1320.459 mgc: 23.50491 ustep: 1 
iter: 2  value: 1320.241 mgc: 1.273 ustep: 1 
iter: 3  value: 1320.24 mgc: 0.05332816 ustep: 1 
iter: 4  value: 1320.24 mgc: 0.0002120217 ustep: 1 
iter: 5  mgc: 3.364763e-09 
iter: 1  value: 1290.591 mgc: 1.588782 ustep: 1 
iter: 2  value: 1290.59 mgc: 0.05523054 ustep: 1 
iter: 3  value: 1290.59 mgc: 0.0001392913 ustep: 1 
iter: 4  mgc: 9.388834e-10 
iter: 1  mgc: 9.388834e-10 
outer mgc:  3.628792 
iter: 1  value: 1289.208 mgc: 1.936691 ustep: 1 
iter: 2  value: 1289.207 mgc: 0.03888381 ustep: 1 
iter: 3  value: 1289.207 mgc: 4.791282e-05 ustep: 1 
iter: 4  mgc: 8.119594e-11 
iter: 1  mgc: 8.119594e-11 
outer mgc:  2.624036 
iter: 1  value: 1288.62 mgc: 1.111477 ustep: 1 
iter: 2  value: 1288.62 mgc: 0.02394909 ustep: 1 
iter: 3  value: 1288.62 mgc: 1.84279e-05 ustep: 1 
iter: 4  mgc: 1.260347e-11 
iter: 1  mgc: 1.260347e-11 
outer mgc:  2.240105 
iter: 1  value: 1286.833 mgc: 1.080785 ustep: 1 
iter: 2  value: 1286.833 mgc: 0.01541546 ustep: 1 
iter: 3  value: 1286.833 mgc: 7.781949e-06 ustep: 1 
iter: 4  mgc: 1.942045e-12 
iter: 1  mgc: 1.942045e-12 
outer mgc:  1.042006 
iter: 1  value: 1284.885 mgc: 1.693686 ustep: 1 
iter: 2  value: 1284.885 mgc: 0.01441032 ustep: 1 
iter: 3  value: 1284.885 mgc: 6.373046e-06 ustep: 1 
iter: 4  mgc: 1.138201e-12 
iter: 1  mgc: 1.138201e-12 
outer mgc:  0.6750125 
iter: 1  value: 1282.428 mgc: 1.104099 ustep: 1 
iter: 2  value: 1282.428 mgc: 0.005027544 ustep: 1 
iter: 3  value: 1282.428 mgc: 5.625295e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  value: 1284.266 mgc: 0.3869329 ustep: 1 
iter: 2  value: 1284.266 mgc: 0.002609376 ustep: 1 
iter: 3  value: 1284.266 mgc: 1.636085e-07 ustep: 1 
iter: 4  mgc: 5.218048e-15 
iter: 1  mgc: 5.218048e-15 
outer mgc:  0.4250472 
iter: 1  value: 1283.264 mgc: 0.5451858 ustep: 1 
iter: 2  value: 1283.264 mgc: 0.002211428 ustep: 1 
iter: 3  value: 1283.264 mgc: 1.18859e-07 ustep: 1 
iter: 4  mgc: 3.302913e-15 
iter: 1  mgc: 3.302913e-15 
outer mgc:  0.3471138 
iter: 1  value: 1282.369 mgc: 0.955903 ustep: 1 
iter: 2  value: 1282.369 mgc: 0.0002251992 ustep: 1 
iter: 3  mgc: 3.7583e-10 
iter: 1  mgc: 3.7583e-10 
outer mgc:  0.234373 
iter: 1  value: 1281.292 mgc: 0.9531465 ustep: 1 
iter: 2  value: 1281.292 mgc: 0.0002189078 ustep: 1 
iter: 3  mgc: 2.027396e-10 
iter: 1  mgc: 2.027396e-10 
outer mgc:  0.1833683 
iter: 1  value: 1278.897 mgc: 2.933911 ustep: 1 
iter: 2  value: 1278.897 mgc: 0.00151154 ustep: 1 
iter: 3  value: 1278.897 mgc: 4.040769e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.3301316 
iter: 1  value: 1276.875 mgc: 3.313067 ustep: 1 
iter: 2  value: 1276.875 mgc: 0.0007855612 ustep: 1 
iter: 3  mgc: 2.952493e-09 
iter: 1  mgc: 2.952493e-09 
outer mgc:  0.09192791 
iter: 1  value: 1276.314 mgc: 1.021715 ustep: 1 
iter: 2  value: 1276.314 mgc: 0.0001705109 ustep: 1 
iter: 3  mgc: 2.846825e-10 
iter: 1  mgc: 2.846825e-10 
outer mgc:  0.06296032 
iter: 1  value: 1275.776 mgc: 0.4853926 ustep: 1 
iter: 2  value: 1275.776 mgc: 6.435424e-06 ustep: 1 
iter: 3  mgc: 4.671818e-13 
iter: 1  mgc: 4.671818e-13 
outer mgc:  0.07852616 
iter: 1  value: 1274.564 mgc: 0.5001397 ustep: 1 
iter: 2  value: 1274.564 mgc: 1.000875e-05 ustep: 1 
iter: 3  mgc: 1.391776e-12 
iter: 1  mgc: 1.391776e-12 
outer mgc:  0.08999977 
iter: 1  value: 1273.251 mgc: 2.583453 ustep: 1 
iter: 2  value: 1273.251 mgc: 5.436232e-05 ustep: 1 
iter: 3  mgc: 1.74678e-11 
iter: 1  mgc: 1.74678e-11 
outer mgc:  0.08712099 
iter: 1  value: 1271.785 mgc: 11.19802 ustep: 1 
iter: 2  value: 1271.785 mgc: 0.0004298984 ustep: 1 
iter: 3  mgc: 1.482964e-09 
iter: 1  mgc: 1.482964e-09 
outer mgc:  0.07699693 
iter: 1  value: 1270.735 mgc: 20.69859 ustep: 1 
iter: 2  value: 1270.735 mgc: 0.001023447 ustep: 1 
iter: 3  mgc: 9.018665e-09 
iter: 1  mgc: 9.018665e-09 
outer mgc:  0.02932311 
iter: 1  value: 1269.925 mgc: 4.465747 ustep: 1 
iter: 2  value: 1269.925 mgc: 5.339462e-05 ustep: 1 
iter: 3  mgc: 3.955325e-11 
iter: 1  mgc: 3.955325e-11 
outer mgc:  0.0165243 
iter: 1  value: 1268.956 mgc: 0.7223071 ustep: 1 
iter: 2  value: 1268.956 mgc: 2.022957e-06 ustep: 1 
iter: 3  mgc: 7.149836e-14 
iter: 1  mgc: 7.149836e-14 
outer mgc:  0.03607469 
iter: 1  value: 1266.771 mgc: 1.390386 ustep: 1 
iter: 2  value: 1266.771 mgc: 2.62359e-06 ustep: 1 
iter: 3  mgc: 1.865175e-13 
iter: 1  mgc: 1.865175e-13 
outer mgc:  0.03880356 
iter: 1  value: 1264.961 mgc: 2.355479 ustep: 1 
iter: 2  value: 1264.961 mgc: 4.08671e-06 ustep: 1 
iter: 3  mgc: 2.73559e-13 
iter: 1  mgc: 2.73559e-13 
outer mgc:  0.01844017 
iter: 1  value: 1262.852 mgc: 3.641236 ustep: 1 
iter: 2  value: 1262.852 mgc: 2.790885e-06 ustep: 1 
iter: 3  mgc: 1.733058e-13 
iter: 1  mgc: 1.733058e-13 
outer mgc:  0.005440109 
iter: 1  value: 1261.141 mgc: 1.00566 ustep: 1 
iter: 2  value: 1261.141 mgc: 2.695351e-07 ustep: 1 
iter: 3  mgc: 2.111644e-13 
iter: 1  mgc: 2.111644e-13 
outer mgc:  0.01357661 
iter: 1  value: 1259.2 mgc: 3.211521 ustep: 1 
iter: 2  value: 1259.2 mgc: 2.925144e-07 ustep: 1 
iter: 3  mgc: 3.762546e-13 
iter: 1  mgc: 3.762546e-13 
outer mgc:  0.01306526 
iter: 1  value: 1257.59 mgc: 6.432316 ustep: 1 
iter: 2  value: 1257.59 mgc: 6.364034e-07 ustep: 1 
iter: 3  mgc: 4.044542e-13 
iter: 1  mgc: 4.044542e-13 
outer mgc:  0.007468655 
iter: 1  value: 1255.49 mgc: 11.92732 ustep: 1 
iter: 2  value: 1255.49 mgc: 9.689137e-07 ustep: 1 
iter: 3  mgc: 9.205969e-13 
iter: 1  mgc: 9.205969e-13 
outer mgc:  0.0005230895 
iter: 1  value: 1253.747 mgc: 7.666318 ustep: 1 
iter: 2  value: 1253.747 mgc: 1.934457e-07 ustep: 1 
iter: 3  mgc: 1.142253e-12 
iter: 1  mgc: 1.142253e-12 
outer mgc:  0.004119642 
iter: 1  value: 1251.753 mgc: 3.035865 ustep: 1 
iter: 2  value: 1251.753 mgc: 1.084892e-08 ustep: 1 
mgc: 1.026956e-12 
iter: 1  mgc: 1.026956e-12 
outer mgc:  0.004408286 
iter: 1  value: 1250.085 mgc: 3.7247 ustep: 1 
iter: 2  value: 1250.085 mgc: 1.791295e-08 ustep: 1 
mgc: 1.817824e-12 
iter: 1  mgc: 1.817824e-12 
outer mgc:  0.002665758 
iter: 1  value: 1247.952 mgc: 10.73063 ustep: 1 
iter: 2  value: 1247.952 mgc: 5.167493e-08 ustep: 1 
mgc: 5.039746e-12 
iter: 1  mgc: 5.039746e-12 
outer mgc:  0.0001033059 
iter: 1  value: 1246.197 mgc: 7.033976 ustep: 1 
iter: 2  value: 1246.197 mgc: 1.15097e-08 ustep: 1 
mgc: 3.810063e-12 
iter: 1  mgc: 3.810063e-12 
outer mgc:  0.001320552 
iter: 1  value: 1244.158 mgc: 0.8740243 ustep: 1 
iter: 2  mgc: 9.524845e-11 
iter: 1  mgc: 9.524845e-11 
outer mgc:  0.001545847 
iter: 1  value: 1242.468 mgc: 10.66562 ustep: 1 
iter: 2  mgc: 4.357683e-09 
iter: 1  mgc: 4.357683e-09 
outer mgc:  0.0009820806 
iter: 1  value: 1240.355 mgc: 24.14968 ustep: 1 
iter: 2  value: 1240.355 mgc: 1.022744e-08 ustep: 1 
mgc: 1.273059e-11 
iter: 1  mgc: 1.273059e-11 
outer mgc:  6.967799e-05 
iter: 1  value: 1238.611 mgc: 17.92283 ustep: 1 
iter: 2  mgc: 2.781281e-09 
iter: 1  mgc: 2.781281e-09 
outer mgc:  0.0004069168 
iter: 1  value: 1236.55 mgc: 8.876405 ustep: 1 
iter: 2  mgc: 2.905969e-10 
iter: 1  mgc: 2.905969e-10 
outer mgc:  0.0005289615 
iter: 1  value: 1234.84 mgc: 9.97964 ustep: 1 
iter: 2  mgc: 2.344605e-10 
iter: 1  mgc: 2.344605e-10 
outer mgc:  0.0003568967 
iter: 1  value: 1232.73 mgc: 30.44268 ustep: 1 
iter: 2  mgc: 8.67705e-10 
iter: 1  mgc: 8.67705e-10 
outer mgc:  4.599061e-05 
iter: 1  value: 1230.989 mgc: 23.9372 ustep: 1 
iter: 2  mgc: 2.549214e-10 
iter: 1  mgc: 2.549214e-10 
outer mgc:  0.0001255675 
iter: 1  mgc: 2.549214e-10 
iter: 1  mgc: 2.549214e-10 
outer mgc:  0.0001255675 
iter: 1  value: 1230.989 mgc: 0.005671388 ustep: 1 
iter: 2  value: 1230.989 mgc: 5.827455e-07 ustep: 1 
iter: 3  mgc: 3.977951e-11 
outer mgc:  0.02336811 
iter: 1  value: 1230.988 mgc: 0.005674848 ustep: 1 
iter: 2  value: 1230.988 mgc: 5.817976e-07 ustep: 1 
iter: 3  mgc: 1.059319e-10 
outer mgc:  0.02362306 
iter: 1  value: 1230.989 mgc: 0.002731104 ustep: 1 
iter: 2  value: 1230.989 mgc: 1.281937e-07 ustep: 1 
iter: 3  mgc: 3.114514e-11 
outer mgc:  0.01579058 
iter: 1  value: 1230.988 mgc: 0.002733097 ustep: 1 
iter: 2  value: 1230.988 mgc: 1.283035e-07 ustep: 1 
iter: 3  mgc: 6.699852e-11 
outer mgc:  0.01586183 
iter: 1  value: 1230.989 mgc: 0.003465655 ustep: 1 
iter: 2  value: 1230.989 mgc: 4.638835e-08 ustep: 1 
mgc: 5.993517e-11 
outer mgc:  0.02045612 
iter: 1  value: 1230.989 mgc: 0.003462885 ustep: 1 
iter: 2  value: 1230.989 mgc: 4.634617e-08 ustep: 1 
mgc: 3.720668e-11 
outer mgc:  0.02029329 
iter: 1  value: 1230.989 mgc: 0.001897217 ustep: 1 
iter: 2  value: 1230.989 mgc: 1.550622e-08 ustep: 1 
mgc: 1.179226e-10 
outer mgc:  0.008886927 
iter: 1  value: 1230.989 mgc: 0.001895787 ustep: 1 
iter: 2  value: 1230.989 mgc: 1.550671e-08 ustep: 1 
mgc: 1.025816e-10 
outer mgc:  0.008650241 
iter: 1  value: 1230.993 mgc: 458.0413 ustep: 1 
iter: 2  value: 1230.993 mgc: 6.969665e-07 ustep: 1 
iter: 3  mgc: 5.23076e-11 
outer mgc:  0.007198545 
iter: 1  value: 1230.985 mgc: 458.4995 ustep: 1 
iter: 2  value: 1230.985 mgc: 6.972184e-07 ustep: 1 
iter: 3  mgc: 7.760625e-11 
outer mgc:  0.007086458 
iter: 1  value: 1230.999 mgc: 457.5828 ustep: 1 
iter: 2  value: 1230.999 mgc: 7.144747e-08 ustep: 1 
mgc: 1.116148e-10 
outer mgc:  0.0008854592 
iter: 1  value: 1230.978 mgc: 458.9576 ustep: 1 
iter: 2  value: 1230.978 mgc: 7.134113e-08 ustep: 1 
mgc: 1.161554e-10 
outer mgc:  0.0009865582 
iter: 1  value: 1230.989 mgc: 3.160647e-05 ustep: 1 
mgc: 3.489831e-11 
outer mgc:  0.0001255675 
iter: 1  value: 1230.989 mgc: 3.16068e-05 ustep: 1 
mgc: 7.732759e-11 
outer mgc:  0.0001255676 
iter: 1  value: 1230.987 mgc: 0.002730583 ustep: 1 
iter: 2  value: 1230.987 mgc: 1.140461e-07 ustep: 1 
iter: 3  mgc: 4.014278e-11 
outer mgc:  0.01245199 
iter: 1  value: 1230.991 mgc: 0.002729134 ustep: 1 
iter: 2  value: 1230.991 mgc: 1.139434e-07 ustep: 1 
iter: 3  mgc: 8.177953e-11 
outer mgc:  0.01260894 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:42:42 2021]
Finished job 0.
1 of 1 steps (100%) done

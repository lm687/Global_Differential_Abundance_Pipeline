Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:03:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11103.674402 
iter  10 value 8616.793902
final  value 8565.203877 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4393.174 mgc: 51.02879 ustep: 1 
iter: 2  value: 4277.074 mgc: 20.17166 ustep: 1 
iter: 3  value: 4274.829 mgc: 2.299538 ustep: 1 
iter: 4  value: 4274.821 mgc: 0.2450647 ustep: 1 
iter: 5  value: 4274.821 mgc: 0.003112853 ustep: 1 
iter: 6  value: 4274.821 mgc: 5.173023e-07 ustep: 1 
iter: 7  mgc: 3.519407e-14 
iter: 1  mgc: 3.519407e-14 
Matching hessian patterns... Done
outer mgc:  1218.362 
iter: 1  value: 3151.01 mgc: 16.93711 ustep: 1 
iter: 2  value: 3151 mgc: 0.2885096 ustep: 1 
iter: 3  value: 3151 mgc: 0.001122783 ustep: 1 
iter: 4  value: 3151 mgc: 5.157098e-08 ustep: 1 
mgc: 4.019007e-14 
iter: 1  value: 3214.218 mgc: 81.19461 ustep: 1 
iter: 2  value: 3184.438 mgc: 22.35625 ustep: 1 
iter: 3  value: 3184.35 mgc: 1.816044 ustep: 1 
iter: 4  value: 3184.35 mgc: 0.005632592 ustep: 1 
iter: 5  value: 3184.35 mgc: 3.296561e-08 ustep: 1 
mgc: 3.352874e-14 
iter: 1  mgc: 4.019007e-14 
outer mgc:  952.0039 
iter: 1  value: 2113.126 mgc: 49.31097 ustep: 1 
iter: 2  value: 2110.584 mgc: 3.493699 ustep: 1 
iter: 3  value: 2110.583 mgc: 0.1103807 ustep: 1 
iter: 4  value: 2110.583 mgc: 0.0001438549 ustep: 1 
iter: 5  mgc: 2.45491e-10 
iter: 1  mgc: 2.45491e-10 
outer mgc:  741.0189 
iter: 1  value: 1754.704 mgc: 42.90186 ustep: 1 
iter: 2  value: 1668.412 mgc: 13.70452 ustep: 1 
iter: 3  value: 1667.164 mgc: 1.338095 ustep: 1 
iter: 4  value: 1667.163 mgc: 0.0511222 ustep: 1 
iter: 5  value: 1667.163 mgc: 0.0001039203 ustep: 1 
iter: 6  mgc: 5.206093e-10 
iter: 1  mgc: 5.206093e-10 
outer mgc:  757.4763 
iter: 1  value: 1098.71 mgc: 53.30132 ustep: 1 
iter: 2  value: 1093.073 mgc: 6.648795 ustep: 1 
iter: 3  value: 1093.069 mgc: 0.2015221 ustep: 1 
iter: 4  value: 1093.069 mgc: 0.0004630781 ustep: 1 
iter: 5  mgc: 2.468136e-09 
iter: 1  mgc: 2.468136e-09 
outer mgc:  546.2894 
iter: 1  value: 756.8833 mgc: 35.57058 ustep: 1 
iter: 2  value: 750.1356 mgc: 5.172588 ustep: 1 
iter: 3  value: 750.1339 mgc: 0.1613914 ustep: 1 
iter: 4  value: 750.1339 mgc: 0.0002650812 ustep: 1 
iter: 5  mgc: 7.206835e-10 
iter: 1  mgc: 7.206835e-10 
outer mgc:  291.7261 
iter: 1  value: 1129.353 mgc: 70.98044 ustep: 1 
iter: 2  value: 1073.834 mgc: 13.81234 ustep: 1 
iter: 3  value: 1073.778 mgc: 1.398244 ustep: 1 
iter: 4  value: 1073.778 mgc: 0.00239516 ustep: 1 
iter: 5  value: 1073.778 mgc: 5.278252e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  value: 685.5735 mgc: 20.01712 ustep: 1 
iter: 2  value: 685.2619 mgc: 1.003562 ustep: 1 
iter: 3  value: 685.2619 mgc: 0.008266482 ustep: 1 
iter: 4  value: 685.2619 mgc: 6.951552e-07 ustep: 1 
iter: 5  mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  139.3397 
iter: 1  value: 645.9278 mgc: 11.48084 ustep: 1 
iter: 2  value: 645.8683 mgc: 0.4455893 ustep: 1 
iter: 3  value: 645.8683 mgc: 0.0008524601 ustep: 1 
iter: 4  value: 645.8683 mgc: 4.621545e-08 ustep: 1 
iter: 5  mgc: 3.740064e-14 
iter: 1  mgc: 3.740064e-14 
outer mgc:  79.27919 
iter: 1  value: 622.5763 mgc: 20.51012 ustep: 1 
iter: 2  value: 619.9283 mgc: 2.146374 ustep: 1 
iter: 3  value: 619.9274 mgc: 0.05823841 ustep: 1 
iter: 4  value: 619.9274 mgc: 0.0001125276 ustep: 1 
iter: 5  mgc: 3.489067e-10 
iter: 1  mgc: 3.489067e-10 
outer mgc:  224.2459 
iter: 1  value: 569.9278 mgc: 38.44743 ustep: 1 
iter: 2  value: 569.3907 mgc: 2.234056 ustep: 1 
iter: 3  value: 569.3907 mgc: 0.008823893 ustep: 1 
iter: 4  value: 569.3907 mgc: 1.243559e-06 ustep: 1 
iter: 5  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  227.1135 
iter: 1  value: 621.3977 mgc: 52.21951 ustep: 1 
iter: 2  value: 621.2282 mgc: 1.262236 ustep: 1 
iter: 3  value: 621.2282 mgc: 0.01276186 ustep: 1 
iter: 4  value: 621.2282 mgc: 2.364474e-06 ustep: 1 
iter: 5  mgc: 5.240253e-14 
iter: 1  value: 555.6329 mgc: 24.98142 ustep: 1 
iter: 2  value: 555.509 mgc: 0.6786641 ustep: 1 
iter: 3  value: 555.509 mgc: 0.001654896 ustep: 1 
iter: 4  mgc: 3.612484e-09 
iter: 1  mgc: 3.612484e-09 
outer mgc:  162.8611 
iter: 1  value: 548.1956 mgc: 13.81282 ustep: 1 
iter: 2  value: 548.1004 mgc: 0.6230023 ustep: 1 
iter: 3  value: 548.1004 mgc: 0.001013567 ustep: 1 
iter: 4  mgc: 4.379483e-09 
iter: 1  mgc: 4.379483e-09 
outer mgc:  86.7007 
iter: 1  value: 528.9844 mgc: 4.773442 ustep: 1 
iter: 2  value: 528.9826 mgc: 0.08173488 ustep: 1 
iter: 3  value: 528.9826 mgc: 0.0001386966 ustep: 1 
iter: 4  mgc: 3.987148e-10 
iter: 1  mgc: 3.987148e-10 
outer mgc:  41.65188 
iter: 1  value: 567.7312 mgc: 20.25691 ustep: 1 
iter: 2  value: 567.6925 mgc: 0.3928284 ustep: 1 
iter: 3  value: 567.6925 mgc: 0.0004467302 ustep: 1 
iter: 4  mgc: 1.430234e-10 
iter: 1  value: 526.327 mgc: 3.330423 ustep: 1 
iter: 2  value: 526.327 mgc: 0.01528841 ustep: 1 
iter: 3  value: 526.327 mgc: 6.842497e-07 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  42.89502 
iter: 1  value: 524.8129 mgc: 2.529462 ustep: 1 
iter: 2  value: 524.8128 mgc: 0.01392583 ustep: 1 
iter: 3  value: 524.8128 mgc: 6.831805e-07 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  39.21716 
iter: 1  value: 519.7164 mgc: 3.824583 ustep: 1 
iter: 2  value: 519.7164 mgc: 0.01625155 ustep: 1 
iter: 3  value: 519.7164 mgc: 3.483931e-07 ustep: 1 
iter: 4  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  29.938 
iter: 1  value: 511.5099 mgc: 5.510657 ustep: 1 
iter: 2  value: 511.5098 mgc: 0.01941659 ustep: 1 
iter: 3  value: 511.5098 mgc: 1.888631e-06 ustep: 1 
iter: 4  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  35.85688 
iter: 1  value: 512.8726 mgc: 6.157512 ustep: 1 
iter: 2  value: 512.8576 mgc: 0.2229899 ustep: 1 
iter: 3  value: 512.8576 mgc: 0.0001412583 ustep: 1 
iter: 4  mgc: 2.959935e-10 
iter: 1  value: 508.6887 mgc: 3.860505 ustep: 1 
iter: 2  value: 508.6882 mgc: 0.05078423 ustep: 1 
iter: 3  value: 508.6882 mgc: 3.64983e-06 ustep: 1 
iter: 4  mgc: 2.842171e-13 
iter: 1  mgc: 2.842171e-13 
outer mgc:  26.28235 
iter: 1  value: 507.8114 mgc: 5.079626 ustep: 1 
iter: 2  value: 507.8112 mgc: 0.0679586 ustep: 1 
iter: 3  value: 507.8112 mgc: 7.002841e-06 ustep: 1 
iter: 4  mgc: 1.49214e-13 
iter: 1  mgc: 1.49214e-13 
outer mgc:  30.14697 
iter: 1  value: 507.3754 mgc: 3.941445 ustep: 1 
iter: 2  value: 507.3752 mgc: 0.01277767 ustep: 1 
iter: 3  value: 507.3752 mgc: 1.905027e-06 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  50.78333 
iter: 1  value: 504.6684 mgc: 6.659674 ustep: 1 
iter: 2  value: 504.6682 mgc: 0.03841114 ustep: 1 
iter: 3  value: 504.6682 mgc: 2.884891e-06 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  21.48193 
iter: 1  value: 498.8029 mgc: 4.272155 ustep: 1 
iter: 2  value: 498.8028 mgc: 0.03621408 ustep: 1 
iter: 3  value: 498.8028 mgc: 2.221175e-06 ustep: 1 
iter: 4  mgc: 1.030287e-13 
iter: 1  mgc: 1.030287e-13 
outer mgc:  12.29073 
iter: 1  value: 494.1164 mgc: 4.133996 ustep: 1 
iter: 2  value: 494.1164 mgc: 0.04545402 ustep: 1 
iter: 3  value: 494.1164 mgc: 2.41882e-06 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  13.78645 
iter: 1  value: 492.9398 mgc: 2.544144 ustep: 1 
iter: 2  value: 492.9398 mgc: 0.01198918 ustep: 1 
iter: 3  value: 492.9398 mgc: 3.179697e-07 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  30.01531 
iter: 1  value: 492.0558 mgc: 1.689922 ustep: 1 
iter: 2  value: 492.0558 mgc: 0.0006126429 ustep: 1 
iter: 3  mgc: 4.51183e-09 
iter: 1  mgc: 4.51183e-09 
outer mgc:  8.694002 
iter: 1  value: 484.1945 mgc: 4.801939 ustep: 1 
iter: 2  value: 484.1945 mgc: 0.008390491 ustep: 1 
iter: 3  value: 484.1945 mgc: 7.630609e-07 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  8.512855 
iter: 1  value: 482.7924 mgc: 2.032987 ustep: 1 
iter: 2  value: 482.7924 mgc: 0.007306955 ustep: 1 
iter: 3  value: 482.7924 mgc: 1.819585e-08 ustep: 1 
mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  6.596857 
iter: 1  value: 480.4842 mgc: 2.379965 ustep: 1 
iter: 2  value: 480.4842 mgc: 0.00325279 ustep: 1 
iter: 3  value: 480.4842 mgc: 2.797105e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  2.822913 
iter: 1  value: 479.2129 mgc: 2.241758 ustep: 1 
iter: 2  value: 479.2129 mgc: 0.001265361 ustep: 1 
iter: 3  mgc: 4.08496e-09 
iter: 1  mgc: 4.08496e-09 
outer mgc:  1.595555 
iter: 1  value: 479.4791 mgc: 0.8630202 ustep: 1 
iter: 2  value: 479.4791 mgc: 0.0001868168 ustep: 1 
iter: 3  mgc: 7.161072e-11 
iter: 1  mgc: 7.161072e-11 
outer mgc:  0.4532057 
iter: 1  value: 479.4645 mgc: 0.1990512 ustep: 1 
iter: 2  value: 479.4645 mgc: 3.185878e-05 ustep: 1 
iter: 3  mgc: 1.957545e-12 
iter: 1  mgc: 1.957545e-12 
outer mgc:  0.2890295 
iter: 1  value: 479.4079 mgc: 0.07307882 ustep: 1 
iter: 2  value: 479.4079 mgc: 7.338658e-06 ustep: 1 
iter: 3  mgc: 2.948752e-13 
iter: 1  mgc: 2.948752e-13 
outer mgc:  0.05346561 
iter: 1  value: 479.4107 mgc: 0.006534382 ustep: 1 
iter: 2  value: 479.4107 mgc: 1.628952e-08 ustep: 1 
mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.00757574 
iter: 1  value: 479.4083 mgc: 0.001971998 ustep: 1 
iter: 2  mgc: 1.056804e-09 
iter: 1  mgc: 1.056804e-09 
outer mgc:  0.0002635541 
iter: 1  value: 479.4076 mgc: 0.0004865648 ustep: 1 
iter: 2  mgc: 7.819367e-11 
iter: 1  mgc: 7.819367e-11 
outer mgc:  0.0001182339 
iter: 1  mgc: 7.819367e-11 
iter: 1  mgc: 7.819367e-11 
outer mgc:  0.0001182339 
iter: 1  value: 479.4136 mgc: 0.0524609 ustep: 1 
iter: 2  value: 479.4136 mgc: 1.656229e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  1.436461 
iter: 1  value: 479.403 mgc: 0.05247015 ustep: 1 
iter: 2  value: 479.403 mgc: 1.654138e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  1.43641 
iter: 1  value: 479.41 mgc: 0.02456277 ustep: 1 
iter: 2  value: 479.41 mgc: 7.175318e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.7663283 
iter: 1  value: 479.4059 mgc: 0.02457079 ustep: 1 
iter: 2  value: 479.4059 mgc: 7.174574e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.7667109 
iter: 1  value: 479.4058 mgc: 0.04959552 ustep: 1 
iter: 2  value: 479.4058 mgc: 3.448226e-06 ustep: 1 
iter: 3  mgc: 4.618528e-14 
outer mgc:  0.9329211 
iter: 1  value: 479.4103 mgc: 0.04958125 ustep: 1 
iter: 2  value: 479.4103 mgc: 3.450375e-06 ustep: 1 
iter: 3  mgc: 3.785861e-14 
outer mgc:  0.932906 
iter: 1  value: 479.4061 mgc: 0.02439947 ustep: 1 
iter: 2  value: 479.4061 mgc: 7.449741e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.7485282 
iter: 1  value: 479.4098 mgc: 0.02439127 ustep: 1 
iter: 2  value: 479.4098 mgc: 7.450243e-07 ustep: 1 
iter: 3  mgc: 4.685141e-14 
outer mgc:  0.7481179 
iter: 1  value: 479.3927 mgc: 0.02023005 ustep: 1 
iter: 2  value: 479.3927 mgc: 1.744691e-07 ustep: 1 
mgc: 3.635287e-14 
outer mgc:  0.008168034 
iter: 1  value: 479.4224 mgc: 0.02021624 ustep: 1 
iter: 2  value: 479.4224 mgc: 1.74701e-07 ustep: 1 
mgc: 4.263256e-14 
outer mgc:  0.008162213 
iter: 1  value: 479.4481 mgc: 0.03548342 ustep: 1 
iter: 2  value: 479.4481 mgc: 3.396683e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.0186672 
iter: 1  value: 479.367 mgc: 0.03557339 ustep: 1 
iter: 2  value: 479.367 mgc: 3.390093e-07 ustep: 1 
iter: 3  mgc: 3.397282e-14 
outer mgc:  0.01864138 
iter: 1  value: 479.4234 mgc: 0.02733893 ustep: 1 
iter: 2  value: 479.4234 mgc: 1.826301e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.0606368 
iter: 1  value: 479.3917 mgc: 0.02739422 ustep: 1 
iter: 2  value: 479.3917 mgc: 1.826552e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.06056256 
[Fri Aug 13 12:03:16 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:20:22 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21932.695731 
final  value 19902.781966 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13652.3 mgc: 127.5931 ustep: 1 
iter: 2  value: 6138.888 mgc: 62.58816 ustep: 0.1336527 
iter: 3  value: 4459.988 mgc: 125.8303 ustep: 0.3656489 
iter: 4  value: 4401.22 mgc: 58.36331 ustep: 0.3712568 
iter: 5  value: 4264.222 mgc: 109.1245 ustep: 0.1108163 
iter: 6  value: 4176.748 mgc: 61.07318 ustep: 0.09625091 
iter: 7  value: 4145.248 mgc: 52.58517 ustep: 0.3103123 
iter: 8  value: 4145.23 mgc: 0.3633844 ustep: 0.5571011 
iter: 9  value: 4145.23 mgc: 0.02449061 ustep: 0.7464174 
iter: 10  value: 4145.23 mgc: 0.001225948 ustep: 0.8639681 
iter: 11  value: 4145.23 mgc: 4.982601e-05 ustep: 0.9295059 
iter: 12  value: 4145.23 mgc: 1.005221e-06 ustep: 0.9641125 
iter: 13  value: 4145.23 mgc: 1.007482e-08 ustep: 0.9818941 
mgc: 5.029432e-11 
iter: 1  mgc: 5.029432e-11 
Matching hessian patterns... Done
outer mgc:  1663.521 
iter: 1  value: 2688.839 mgc: 31.53126 ustep: 1 
iter: 2  value: 2677.091 mgc: 8.996949 ustep: 1 
iter: 3  value: 2677.079 mgc: 0.5745219 ustep: 1 
iter: 4  value: 2677.079 mgc: 0.003598309 ustep: 1 
iter: 5  value: 2677.079 mgc: 1.443485e-07 ustep: 1 
mgc: 2.745026e-14 
iter: 1  mgc: 2.745026e-14 
outer mgc:  764.4609 
iter: 1  value: 2258.692 mgc: 20.86872 ustep: 1 
iter: 2  value: 2257.927 mgc: 1.562742 ustep: 1 
iter: 3  value: 2257.927 mgc: 0.02332841 ustep: 1 
iter: 4  value: 2257.927 mgc: 5.494579e-06 ustep: 1 
iter: 5  mgc: 2.997602e-13 
iter: 1  mgc: 2.997602e-13 
outer mgc:  64.97917 
iter: 1  value: 2251.924 mgc: 11.97892 ustep: 1 
iter: 2  value: 2251.649 mgc: 0.9479658 ustep: 1 
iter: 3  value: 2251.649 mgc: 0.033759 ustep: 1 
iter: 4  value: 2251.649 mgc: 4.645951e-05 ustep: 1 
iter: 5  mgc: 8.836265e-11 
iter: 1  value: 2228.513 mgc: 5.392791 ustep: 1 
iter: 2  value: 2228.5 mgc: 0.1724835 ustep: 1 
iter: 3  value: 2228.5 mgc: 0.00164098 ustep: 1 
iter: 4  value: 2228.5 mgc: 1.516148e-07 ustep: 1 
iter: 5  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  83.90587 
iter: 1  value: 2246.113 mgc: 19.97866 ustep: 1 
iter: 2  value: 2243.887 mgc: 1.650749 ustep: 1 
iter: 3  value: 2243.887 mgc: 0.03522633 ustep: 1 
iter: 4  value: 2243.887 mgc: 5.255116e-05 ustep: 1 
iter: 5  mgc: 1.173923e-10 
iter: 1  value: 2220.338 mgc: 7.365672 ustep: 1 
iter: 2  value: 2220.305 mgc: 0.1956223 ustep: 1 
iter: 3  value: 2220.305 mgc: 0.0004461405 ustep: 1 
iter: 4  value: 2220.305 mgc: 1.031865e-08 ustep: 1 
mgc: 2.459144e-14 
iter: 1  mgc: 2.459144e-14 
outer mgc:  51.63269 
iter: 1  value: 2213.79 mgc: 3.472423 ustep: 1 
iter: 2  value: 2213.789 mgc: 0.04554048 ustep: 1 
iter: 3  value: 2213.789 mgc: 0.000128815 ustep: 1 
iter: 4  mgc: 1.013528e-09 
iter: 1  mgc: 1.013528e-09 
outer mgc:  47.44913 
iter: 1  value: 2205.033 mgc: 9.795177 ustep: 1 
iter: 2  value: 2204.925 mgc: 0.3669346 ustep: 1 
iter: 3  value: 2204.925 mgc: 0.001256253 ustep: 1 
iter: 4  value: 2204.925 mgc: 2.605283e-08 ustep: 1 
mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  36.20228 
iter: 1  value: 2192.1 mgc: 8.939146 ustep: 1 
iter: 2  value: 2191.894 mgc: 0.5300844 ustep: 1 
iter: 3  value: 2191.894 mgc: 0.007550646 ustep: 1 
iter: 4  value: 2191.894 mgc: 2.550047e-06 ustep: 1 
iter: 5  mgc: 2.882139e-13 
iter: 1  mgc: 2.882139e-13 
outer mgc:  32.07365 
iter: 1  value: 2192.881 mgc: 20.37765 ustep: 1 
iter: 2  value: 2189.272 mgc: 2.188074 ustep: 1 
iter: 3  value: 2189.271 mgc: 0.1139025 ustep: 1 
iter: 4  value: 2189.271 mgc: 0.0003565105 ustep: 1 
iter: 5  mgc: 3.56164e-09 
iter: 1  mgc: 3.56164e-09 
outer mgc:  70.54914 
iter: 1  value: 2178.88 mgc: 3.72423 ustep: 1 
iter: 2  value: 2178.859 mgc: 0.2572914 ustep: 1 
iter: 3  value: 2178.859 mgc: 0.003083625 ustep: 1 
iter: 4  value: 2178.859 mgc: 4.442498e-07 ustep: 1 
iter: 5  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  74.98911 
iter: 1  value: 2183.831 mgc: 5.465173 ustep: 1 
iter: 2  value: 2183.829 mgc: 0.08087486 ustep: 1 
iter: 3  value: 2183.829 mgc: 5.861979e-05 ustep: 1 
iter: 4  mgc: 4.802025e-11 
iter: 1  value: 2176.865 mgc: 5.042295 ustep: 1 
iter: 2  value: 2176.863 mgc: 0.05850629 ustep: 1 
iter: 3  value: 2176.863 mgc: 2.786135e-05 ustep: 1 
iter: 4  mgc: 2.5834e-11 
iter: 1  mgc: 2.5834e-11 
outer mgc:  54.03195 
iter: 1  value: 2173.774 mgc: 5.472986 ustep: 1 
iter: 2  value: 2173.768 mgc: 0.09348955 ustep: 1 
iter: 3  value: 2173.768 mgc: 7.091406e-05 ustep: 1 
iter: 4  mgc: 7.092801e-11 
iter: 1  mgc: 7.092801e-11 
outer mgc:  29.8215 
iter: 1  value: 2173.658 mgc: 2.041858 ustep: 1 
iter: 2  value: 2173.658 mgc: 0.02279178 ustep: 1 
iter: 3  value: 2173.658 mgc: 8.314295e-06 ustep: 1 
iter: 4  mgc: 2.234435e-12 
iter: 1  mgc: 2.234435e-12 
outer mgc:  9.3372 
iter: 1  value: 2172.924 mgc: 1.775824 ustep: 1 
iter: 2  value: 2172.924 mgc: 0.01487118 ustep: 1 
iter: 3  value: 2172.924 mgc: 6.989343e-06 ustep: 1 
iter: 4  mgc: 1.546763e-12 
iter: 1  value: 2172.989 mgc: 0.6549686 ustep: 1 
iter: 2  value: 2172.989 mgc: 0.004914051 ustep: 1 
iter: 3  value: 2172.989 mgc: 1.063357e-06 ustep: 1 
iter: 4  mgc: 4.707346e-14 
iter: 1  mgc: 4.707346e-14 
outer mgc:  7.384659 
iter: 1  value: 2173.305 mgc: 3.469097 ustep: 1 
iter: 2  value: 2173.304 mgc: 0.03771806 ustep: 1 
iter: 3  value: 2173.304 mgc: 1.290458e-05 ustep: 1 
iter: 4  mgc: 1.531664e-12 
iter: 1  value: 2172.999 mgc: 0.6715437 ustep: 1 
iter: 2  value: 2172.999 mgc: 0.001621908 ustep: 1 
iter: 3  value: 2172.999 mgc: 2.516645e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  5.05272 
iter: 1  value: 2173.022 mgc: 0.5450208 ustep: 1 
iter: 2  value: 2173.022 mgc: 0.0007907183 ustep: 1 
iter: 3  mgc: 5.185838e-09 
iter: 1  mgc: 5.185838e-09 
outer mgc:  3.954746 
iter: 1  value: 2173.043 mgc: 0.2110339 ustep: 1 
iter: 2  value: 2173.043 mgc: 0.0002019285 ustep: 1 
iter: 3  mgc: 4.724852e-10 
iter: 1  mgc: 4.724852e-10 
outer mgc:  1.514159 
iter: 1  value: 2172.995 mgc: 0.5883359 ustep: 1 
iter: 2  value: 2172.995 mgc: 0.0009486147 ustep: 1 
iter: 3  mgc: 6.723035e-09 
iter: 1  mgc: 6.723035e-09 
outer mgc:  1.99939 
iter: 1  value: 2173.025 mgc: 0.2776952 ustep: 1 
iter: 2  value: 2173.025 mgc: 0.0002658922 ustep: 1 
iter: 3  mgc: 6.277059e-10 
iter: 1  mgc: 6.277059e-10 
outer mgc:  1.603718 
iter: 1  value: 2173.048 mgc: 0.3888074 ustep: 1 
iter: 2  value: 2173.048 mgc: 0.0003579463 ustep: 1 
iter: 3  mgc: 9.597603e-10 
iter: 1  value: 2173.022 mgc: 0.08841467 ustep: 1 
iter: 2  value: 2173.022 mgc: 2.555273e-05 ustep: 1 
iter: 3  mgc: 4.662049e-12 
iter: 1  mgc: 4.662049e-12 
outer mgc:  0.4004882 
iter: 1  value: 2173.038 mgc: 0.04306567 ustep: 1 
iter: 2  value: 2173.038 mgc: 1.082444e-05 ustep: 1 
iter: 3  mgc: 3.774758e-12 
iter: 1  mgc: 3.774758e-12 
outer mgc:  0.5265797 
iter: 1  value: 2173.04 mgc: 0.04444078 ustep: 1 
iter: 2  value: 2173.04 mgc: 1.103817e-05 ustep: 1 
iter: 3  mgc: 2.704503e-12 
iter: 1  mgc: 2.704503e-12 
outer mgc:  0.340895 
iter: 1  value: 2173.044 mgc: 0.07132151 ustep: 1 
iter: 2  value: 2173.044 mgc: 2.553373e-05 ustep: 1 
iter: 3  mgc: 8.296475e-12 
iter: 1  mgc: 8.296475e-12 
outer mgc:  0.4803315 
iter: 1  value: 2173.057 mgc: 0.03207041 ustep: 1 
iter: 2  value: 2173.057 mgc: 1.081033e-05 ustep: 1 
iter: 3  mgc: 3.788081e-12 
iter: 1  mgc: 3.788081e-12 
outer mgc:  0.2780799 
iter: 1  value: 2173.059 mgc: 0.07579894 ustep: 1 
iter: 2  value: 2173.059 mgc: 1.977476e-05 ustep: 1 
iter: 3  mgc: 3.21787e-12 
iter: 1  mgc: 3.21787e-12 
outer mgc:  0.307817 
iter: 1  value: 2173.054 mgc: 0.06491772 ustep: 1 
iter: 2  value: 2173.054 mgc: 1.790613e-05 ustep: 1 
iter: 3  mgc: 3.03052e-12 
iter: 1  value: 2173.058 mgc: 0.03061001 ustep: 1 
iter: 2  value: 2173.058 mgc: 2.973079e-06 ustep: 1 
iter: 3  mgc: 6.661338e-14 
iter: 1  mgc: 6.661338e-14 
outer mgc:  0.2264771 
iter: 1  value: 2173.064 mgc: 0.01042083 ustep: 1 
iter: 2  value: 2173.064 mgc: 4.160436e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.07572129 
iter: 1  value: 2173.062 mgc: 0.03519416 ustep: 1 
iter: 2  value: 2173.062 mgc: 3.313235e-06 ustep: 1 
iter: 3  mgc: 9.636736e-14 
iter: 1  value: 2173.063 mgc: 0.01712318 ustep: 1 
iter: 2  value: 2173.063 mgc: 7.844163e-07 ustep: 1 
iter: 3  mgc: 4.13003e-14 
iter: 1  mgc: 4.13003e-14 
outer mgc:  0.02476487 
iter: 1  value: 2173.061 mgc: 0.009461568 ustep: 1 
iter: 2  value: 2173.061 mgc: 3.253026e-07 ustep: 1 
iter: 3  mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  0.05472349 
iter: 1  value: 2173.063 mgc: 0.00457747 ustep: 1 
iter: 2  value: 2173.063 mgc: 9.889406e-08 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.01497015 
iter: 1  value: 2173.065 mgc: 0.007329508 ustep: 1 
iter: 2  value: 2173.065 mgc: 1.945144e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
iter: 1  value: 2173.063 mgc: 0.001528585 ustep: 1 
iter: 2  mgc: 8.460694e-09 
iter: 1  mgc: 8.460694e-09 
outer mgc:  0.01663715 
iter: 1  value: 2173.064 mgc: 0.001523127 ustep: 1 
iter: 2  mgc: 7.903112e-09 
iter: 1  mgc: 7.903112e-09 
outer mgc:  0.01417359 
iter: 1  value: 2173.064 mgc: 0.002058149 ustep: 1 
iter: 2  value: 2173.064 mgc: 1.493035e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  value: 2173.064 mgc: 0.001398866 ustep: 1 
iter: 2  mgc: 9.15132e-09 
iter: 1  mgc: 9.15132e-09 
outer mgc:  0.02026263 
iter: 1  value: 2173.064 mgc: 0.0009354298 ustep: 1 
iter: 2  mgc: 7.947953e-09 
iter: 1  mgc: 7.947953e-09 
outer mgc:  0.007349683 
iter: 1  value: 2173.064 mgc: 0.0008454027 ustep: 1 
iter: 2  mgc: 5.956204e-09 
iter: 1  mgc: 5.956204e-09 
outer mgc:  0.005234727 
iter: 1  value: 2173.065 mgc: 0.0006858523 ustep: 1 
iter: 2  value: 2173.065 mgc: 1.204794e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.004262023 
iter: 1  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.004262023 
iter: 1  value: 2173.064 mgc: 0.05406605 ustep: 1 
iter: 2  value: 2173.064 mgc: 9.713123e-06 ustep: 1 
iter: 3  mgc: 7.247536e-13 
outer mgc:  0.2293094 
iter: 1  value: 2173.066 mgc: 0.05406624 ustep: 1 
iter: 2  value: 2173.066 mgc: 9.722614e-06 ustep: 1 
iter: 3  mgc: 7.204237e-13 
outer mgc:  0.2285181 
iter: 1  value: 2173.065 mgc: 0.03241419 ustep: 1 
iter: 2  value: 2173.065 mgc: 2.883043e-06 ustep: 1 
iter: 3  mgc: 8.060219e-14 
outer mgc:  0.8299106 
iter: 1  value: 2173.065 mgc: 0.03241585 ustep: 1 
iter: 2  value: 2173.065 mgc: 2.883356e-06 ustep: 1 
iter: 3  mgc: 7.627232e-14 
outer mgc:  0.8284519 
iter: 1  value: 2173.065 mgc: 0.05095116 ustep: 1 
iter: 2  value: 2173.065 mgc: 7.204063e-06 ustep: 1 
iter: 3  mgc: 4.47864e-13 
outer mgc:  0.2467191 
iter: 1  value: 2173.065 mgc: 0.05094808 ustep: 1 
iter: 2  value: 2173.065 mgc: 7.210729e-06 ustep: 1 
iter: 3  mgc: 4.43201e-13 
outer mgc:  0.2460694 
iter: 1  value: 2173.06 mgc: 0.02569563 ustep: 1 
iter: 2  value: 2173.06 mgc: 1.109488e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.7869237 
iter: 1  value: 2173.07 mgc: 0.02568614 ustep: 1 
iter: 2  value: 2173.07 mgc: 1.108316e-06 ustep: 1 
iter: 3  mgc: 3.663736e-14 
outer mgc:  0.7781717 
iter: 1  value: 2173.058 mgc: 0.004844165 ustep: 1 
iter: 2  value: 2173.058 mgc: 6.334592e-07 ustep: 1 
iter: 3  mgc: 2.470246e-14 
outer mgc:  0.0447131 
iter: 1  value: 2173.072 mgc: 0.004840572 ustep: 1 
iter: 2  value: 2173.072 mgc: 6.329442e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.0489966 
iter: 1  value: 2173.075 mgc: 0.009874666 ustep: 1 
iter: 2  value: 2173.075 mgc: 3.15117e-06 ustep: 1 
iter: 3  mgc: 4.214407e-13 
outer mgc:  0.2684621 
iter: 1  value: 2173.055 mgc: 0.009898143 ustep: 1 
iter: 2  value: 2173.055 mgc: 3.160741e-06 ustep: 1 
iter: 3  mgc: 4.192202e-13 
outer mgc:  0.2659224 
iter: 1  value: 2173.073 mgc: 0.009214649 ustep: 1 
iter: 2  value: 2173.073 mgc: 1.904762e-06 ustep: 1 
iter: 3  mgc: 1.323386e-13 
outer mgc:  0.2840744 
iter: 1  value: 2173.056 mgc: 0.009237286 ustep: 1 
iter: 2  value: 2173.056 mgc: 1.91201e-06 ustep: 1 
iter: 3  mgc: 1.361133e-13 
outer mgc:  0.2797687 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:20:25 2021]
Finished job 0.
1 of 1 steps (100%) done

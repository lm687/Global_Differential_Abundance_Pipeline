Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 02:00:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_0.8_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_4_0.8_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=4, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_0.8_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2796.155726 
iter  10 value 2046.789407
iter  20 value 2021.893292
final  value 2021.511659 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1434.231 mgc: 102.6983 ustep: 1 
iter: 2  value: 1249.196 mgc: 53.31401 ustep: 1 
iter: 3  value: 1196.756 mgc: 36.99294 ustep: 1 
iter: 4  value: 1196.19 mgc: 3.465867 ustep: 1 
iter: 5  value: 1196.19 mgc: 0.08212586 ustep: 1 
iter: 6  value: 1196.19 mgc: 4.349785e-05 ustep: 1 
iter: 7  mgc: 1.98267e-11 
iter: 1  mgc: 1.98267e-11 
Matching hessian patterns... Done
outer mgc:  387.3634 
iter: 1  value: 825.1171 mgc: 28.95479 ustep: 1 
iter: 2  value: 822.2726 mgc: 5.140494 ustep: 1 
iter: 3  value: 822.2632 mgc: 0.2685116 ustep: 1 
iter: 4  value: 822.2632 mgc: 0.001851539 ustep: 1 
iter: 5  value: 822.2632 mgc: 9.001696e-08 ustep: 1 
mgc: 3.774758e-14 
iter: 1  value: 611.4943 mgc: 51.61388 ustep: 1 
iter: 2  value: 501.8507 mgc: 28.51916 ustep: 1 
iter: 3  value: 498.7728 mgc: 3.564271 ustep: 1 
iter: 4  value: 498.7607 mgc: 0.3101617 ustep: 1 
iter: 5  value: 498.7607 mgc: 0.001817142 ustep: 1 
iter: 6  value: 498.7607 mgc: 1.859547e-07 ustep: 1 
iter: 7  mgc: 2.68674e-14 
iter: 1  mgc: 2.68674e-14 
outer mgc:  134.1172 
iter: 1  value: 350.1989 mgc: 60.68176 ustep: 1 
iter: 2  value: 338.6545 mgc: 9.988979 ustep: 1 
iter: 3  value: 338.4057 mgc: 1.357893 ustep: 1 
iter: 4  value: 338.4049 mgc: 0.06119015 ustep: 1 
iter: 5  value: 338.4049 mgc: 0.0002890821 ustep: 1 
iter: 6  mgc: 6.142442e-09 
iter: 1  mgc: 6.142442e-09 
outer mgc:  156.7362 
iter: 1  value: 345.5386 mgc: 52.12846 ustep: 1 
iter: 2  value: 311.1072 mgc: 17.53633 ustep: 1 
iter: 3  value: 310.8689 mgc: 2.02848 ustep: 1 
iter: 4  value: 310.8689 mgc: 0.0105106 ustep: 1 
iter: 5  value: 310.8689 mgc: 7.9357e-06 ustep: 1 
iter: 6  mgc: 5.488943e-12 
iter: 1  mgc: 5.488943e-12 
outer mgc:  112.5092 
iter: 1  value: 192.6425 mgc: 48.08118 ustep: 1 
iter: 2  value: 191.2308 mgc: 4.565859 ustep: 1 
iter: 3  value: 191.2299 mgc: 0.1743043 ustep: 1 
iter: 4  value: 191.2299 mgc: 0.0002966184 ustep: 1 
iter: 5  mgc: 8.906291e-10 
iter: 1  mgc: 8.906291e-10 
outer mgc:  11.0271 
iter: 1  value: 187.7093 mgc: 27.80097 ustep: 1 
iter: 2  value: 186.9344 mgc: 2.60953 ustep: 1 
iter: 3  value: 186.934 mgc: 0.03515994 ustep: 1 
iter: 4  value: 186.934 mgc: 6.693485e-05 ustep: 1 
iter: 5  mgc: 3.256811e-10 
iter: 1  mgc: 3.256811e-10 
outer mgc:  32.39639 
iter: 1  value: 173.6507 mgc: 40.42185 ustep: 1 
iter: 2  value: 172.4516 mgc: 3.606195 ustep: 1 
iter: 3  value: 172.4513 mgc: 0.08976484 ustep: 1 
iter: 4  value: 172.4513 mgc: 7.092814e-05 ustep: 1 
iter: 5  mgc: 4.367395e-11 
iter: 1  mgc: 4.367395e-11 
outer mgc:  13.66913 
iter: 1  value: 173.4001 mgc: 28.22543 ustep: 1 
iter: 2  value: 172.2495 mgc: 4.120336 ustep: 1 
iter: 3  value: 172.2493 mgc: 0.06025137 ustep: 1 
iter: 4  value: 172.2493 mgc: 3.242835e-05 ustep: 1 
iter: 5  mgc: 9.396095e-12 
iter: 1  mgc: 9.396095e-12 
outer mgc:  22.27482 
iter: 1  value: 186.7179 mgc: 40.90961 ustep: 1 
iter: 2  value: 185.9412 mgc: 3.142347 ustep: 1 
iter: 3  value: 185.9409 mgc: 0.07684771 ustep: 1 
iter: 4  value: 185.9409 mgc: 4.863355e-05 ustep: 1 
iter: 5  mgc: 1.984435e-11 
iter: 1  value: 169.1046 mgc: 11.4228 ustep: 1 
iter: 2  value: 169.0932 mgc: 0.3793293 ustep: 1 
iter: 3  value: 169.0932 mgc: 0.001378545 ustep: 1 
iter: 4  value: 169.0932 mgc: 1.823661e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  12.92065 
iter: 1  value: 167.328 mgc: 6.891044 ustep: 1 
iter: 2  value: 167.3268 mgc: 0.07086427 ustep: 1 
iter: 3  value: 167.3268 mgc: 6.607542e-05 ustep: 1 
iter: 4  mgc: 7.674661e-11 
iter: 1  mgc: 7.674661e-11 
outer mgc:  15.51747 
iter: 1  value: 162.5213 mgc: 21.67032 ustep: 1 
iter: 2  value: 162.4319 mgc: 1.03671 ustep: 1 
iter: 3  value: 162.4319 mgc: 0.007768448 ustep: 1 
iter: 4  value: 162.4319 mgc: 4.877331e-07 ustep: 1 
iter: 5  mgc: 3.141931e-14 
iter: 1  mgc: 3.141931e-14 
outer mgc:  12.21129 
iter: 1  value: 158.8351 mgc: 3.463826 ustep: 1 
iter: 2  value: 158.835 mgc: 0.05157008 ustep: 1 
iter: 3  value: 158.835 mgc: 1.148699e-05 ustep: 1 
iter: 4  mgc: 8.673062e-13 
iter: 1  mgc: 8.673062e-13 
outer mgc:  7.803741 
iter: 1  value: 158.5581 mgc: 12.72256 ustep: 1 
iter: 2  value: 158.5543 mgc: 0.2212372 ustep: 1 
iter: 3  value: 158.5543 mgc: 0.0002093002 ustep: 1 
iter: 4  mgc: 8.961931e-11 
iter: 1  value: 157.7654 mgc: 5.831754 ustep: 1 
iter: 2  value: 157.7652 mgc: 0.03792773 ustep: 1 
iter: 3  value: 157.7652 mgc: 7.734863e-06 ustep: 1 
iter: 4  mgc: 3.698153e-13 
iter: 1  mgc: 3.698153e-13 
outer mgc:  5.606275 
iter: 1  value: 156.2667 mgc: 3.111431 ustep: 1 
iter: 2  value: 156.2667 mgc: 0.00577646 ustep: 1 
iter: 3  value: 156.2667 mgc: 1.147463e-06 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  5.109663 
iter: 1  value: 155.6419 mgc: 4.190566 ustep: 1 
iter: 2  value: 155.6419 mgc: 0.01038672 ustep: 1 
iter: 3  value: 155.6419 mgc: 7.859027e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  12.05322 
iter: 1  value: 154.4431 mgc: 5.925096 ustep: 1 
iter: 2  value: 154.4426 mgc: 0.08759399 ustep: 1 
iter: 3  value: 154.4426 mgc: 2.8783e-05 ustep: 1 
iter: 4  mgc: 2.539302e-12 
iter: 1  mgc: 2.539302e-12 
outer mgc:  9.781285 
iter: 1  value: 153.8371 mgc: 3.395967 ustep: 1 
iter: 2  value: 153.8371 mgc: 0.01771361 ustep: 1 
iter: 3  value: 153.8371 mgc: 7.128167e-06 ustep: 1 
iter: 4  mgc: 1.168843e-12 
iter: 1  mgc: 1.168843e-12 
outer mgc:  1.586149 
iter: 1  value: 153.3872 mgc: 6.084054 ustep: 1 
iter: 2  value: 153.3871 mgc: 0.05567012 ustep: 1 
iter: 3  value: 153.3871 mgc: 6.561862e-06 ustep: 1 
iter: 4  mgc: 5.107581e-13 
iter: 1  value: 153.504 mgc: 2.967563 ustep: 1 
iter: 2  value: 153.504 mgc: 0.01475255 ustep: 1 
iter: 3  value: 153.504 mgc: 3.55336e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  3.583099 
iter: 1  value: 153.0101 mgc: 1.703568 ustep: 1 
iter: 2  value: 153.0101 mgc: 0.004994525 ustep: 1 
iter: 3  value: 153.0101 mgc: 9.214563e-08 ustep: 1 
mgc: 2.375877e-14 
iter: 1  mgc: 2.375877e-14 
outer mgc:  1.356862 
iter: 1  value: 152.0908 mgc: 3.038101 ustep: 1 
iter: 2  value: 152.0908 mgc: 0.006887803 ustep: 1 
iter: 3  value: 152.0908 mgc: 5.974884e-07 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  5.623032 
iter: 1  value: 151.6328 mgc: 2.178699 ustep: 1 
iter: 2  value: 151.6328 mgc: 0.01327807 ustep: 1 
iter: 3  value: 151.6328 mgc: 4.177986e-06 ustep: 1 
iter: 4  mgc: 4.23217e-13 
iter: 1  mgc: 4.23217e-13 
outer mgc:  1.420643 
iter: 1  value: 151.6038 mgc: 1.673715 ustep: 1 
iter: 2  value: 151.6037 mgc: 0.02426238 ustep: 1 
iter: 3  value: 151.6037 mgc: 3.130543e-06 ustep: 1 
iter: 4  mgc: 6.683543e-14 
iter: 1  value: 151.5752 mgc: 1.048006 ustep: 1 
iter: 2  value: 151.5752 mgc: 0.004806265 ustep: 1 
iter: 3  value: 151.5752 mgc: 2.070305e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.972956 
iter: 1  value: 151.2893 mgc: 1.048769 ustep: 1 
iter: 2  value: 151.2893 mgc: 0.002819751 ustep: 1 
iter: 3  value: 151.2893 mgc: 4.338553e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  0.2662698 
iter: 1  value: 150.8923 mgc: 0.9815494 ustep: 1 
iter: 2  value: 150.8923 mgc: 0.004131995 ustep: 1 
iter: 3  value: 150.8923 mgc: 1.572331e-07 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.38768 
iter: 1  value: 150.9815 mgc: 0.728755 ustep: 1 
iter: 2  value: 150.9815 mgc: 0.002661599 ustep: 1 
iter: 3  value: 150.9815 mgc: 8.893534e-08 ustep: 1 
mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  0.3342107 
iter: 1  value: 150.9644 mgc: 0.1855788 ustep: 1 
iter: 2  value: 150.9644 mgc: 0.0001332744 ustep: 1 
iter: 3  mgc: 2.180293e-10 
iter: 1  mgc: 2.180293e-10 
outer mgc:  0.3023112 
iter: 1  value: 150.9785 mgc: 0.5535356 ustep: 1 
iter: 2  value: 150.9785 mgc: 0.001346326 ustep: 1 
iter: 3  value: 150.9785 mgc: 1.212969e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  value: 150.9661 mgc: 0.1749521 ustep: 1 
iter: 2  value: 150.9661 mgc: 0.0001361923 ustep: 1 
iter: 3  mgc: 1.21482e-10 
iter: 1  mgc: 1.21482e-10 
outer mgc:  0.1083066 
iter: 1  value: 150.9852 mgc: 0.1313141 ustep: 1 
iter: 2  value: 150.9852 mgc: 9.388948e-05 ustep: 1 
iter: 3  mgc: 6.737655e-11 
iter: 1  mgc: 6.737655e-11 
outer mgc:  0.1058906 
iter: 1  value: 150.9612 mgc: 0.1417274 ustep: 1 
iter: 2  value: 150.9612 mgc: 4.479467e-05 ustep: 1 
iter: 3  mgc: 2.311884e-11 
iter: 1  mgc: 2.311884e-11 
outer mgc:  0.08415308 
iter: 1  value: 150.9544 mgc: 0.0602209 ustep: 1 
iter: 2  value: 150.9544 mgc: 1.616851e-05 ustep: 1 
iter: 3  mgc: 4.349854e-12 
iter: 1  mgc: 4.349854e-12 
outer mgc:  0.01830867 
iter: 1  value: 150.9657 mgc: 0.05040824 ustep: 1 
iter: 2  value: 150.9657 mgc: 1.093217e-05 ustep: 1 
iter: 3  mgc: 2.868816e-13 
iter: 1  value: 150.9597 mgc: 0.02459694 ustep: 1 
iter: 2  value: 150.9597 mgc: 2.927786e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  0.02785042 
iter: 1  value: 150.9568 mgc: 0.02212835 ustep: 1 
iter: 2  value: 150.9568 mgc: 7.007484e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.006588904 
iter: 1  value: 150.9561 mgc: 0.008503868 ustep: 1 
iter: 2  value: 150.9561 mgc: 1.396436e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.001660114 
iter: 1  value: 150.9548 mgc: 0.008410167 ustep: 1 
iter: 2  value: 150.9548 mgc: 3.455421e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.0006146446 
iter: 1  value: 150.9551 mgc: 0.0006843209 ustep: 1 
iter: 2  mgc: 4.029528e-09 
iter: 1  mgc: 4.029528e-09 
outer mgc:  0.0001765682 
iter: 1  value: 150.9551 mgc: 0.0001402968 ustep: 1 
iter: 2  mgc: 5.117751e-11 
iter: 1  mgc: 5.117751e-11 
outer mgc:  4.902977e-05 
iter: 1  mgc: 5.117751e-11 
iter: 1  mgc: 5.117751e-11 
outer mgc:  4.902977e-05 
iter: 1  value: 150.9567 mgc: 0.04771872 ustep: 1 
iter: 2  value: 150.9567 mgc: 1.465042e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.1929825 
iter: 1  value: 150.9536 mgc: 0.0477181 ustep: 1 
iter: 2  value: 150.9536 mgc: 1.462173e-06 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.1929945 
iter: 1  value: 150.9561 mgc: 0.02415836 ustep: 1 
iter: 2  value: 150.9561 mgc: 7.747122e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.1389182 
iter: 1  value: 150.9542 mgc: 0.02416587 ustep: 1 
iter: 2  value: 150.9542 mgc: 7.748541e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.1390512 
iter: 1  value: 150.9548 mgc: 0.02653123 ustep: 1 
iter: 2  value: 150.9548 mgc: 3.801264e-06 ustep: 1 
iter: 3  mgc: 1.39444e-13 
outer mgc:  0.03467142 
iter: 1  value: 150.9554 mgc: 0.02652066 ustep: 1 
iter: 2  value: 150.9554 mgc: 3.806458e-06 ustep: 1 
iter: 3  mgc: 1.407763e-13 
outer mgc:  0.03468788 
iter: 1  value: 150.955 mgc: 0.002079711 ustep: 1 
iter: 2  value: 150.955 mgc: 3.179943e-08 ustep: 1 
mgc: 2.531308e-14 
outer mgc:  0.009313616 
iter: 1  value: 150.9552 mgc: 0.002077712 ustep: 1 
iter: 2  value: 150.9552 mgc: 3.173432e-08 ustep: 1 
mgc: 2.309264e-14 
outer mgc:  0.009285656 
iter: 1  value: 150.9544 mgc: 0.04904052 ustep: 1 
iter: 2  value: 150.9544 mgc: 4.94571e-06 ustep: 1 
iter: 3  mgc: 8.038015e-14 
outer mgc:  0.1277085 
iter: 1  value: 150.9558 mgc: 0.04902726 ustep: 1 
iter: 2  value: 150.9558 mgc: 4.949138e-06 ustep: 1 
iter: 3  mgc: 8.171241e-14 
outer mgc:  0.1276993 
iter: 1  value: 150.9545 mgc: 0.02322015 ustep: 1 
iter: 2  value: 150.9545 mgc: 1.066441e-06 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.1211358 
iter: 1  value: 150.9557 mgc: 0.02321171 ustep: 1 
iter: 2  value: 150.9557 mgc: 1.065845e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.1210616 
iter: 1  value: 150.9559 mgc: 0.004328414 ustep: 1 
iter: 2  value: 150.9559 mgc: 2.709237e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.00501753 
iter: 1  value: 150.9542 mgc: 0.004326103 ustep: 1 
iter: 2  value: 150.9542 mgc: 2.703329e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.004998442 
iter: 1  value: 150.9533 mgc: 0.008644317 ustep: 1 
iter: 2  value: 150.9533 mgc: 2.378023e-08 ustep: 1 
mgc: 2.264855e-14 
outer mgc:  0.002376639 
iter: 1  value: 150.9569 mgc: 0.008640484 ustep: 1 
iter: 2  value: 150.9569 mgc: 2.379348e-08 ustep: 1 
mgc: 1.953993e-14 
outer mgc:  0.002395732 
iter: 1  value: 150.9551 mgc: 0.009249083 ustep: 1 
iter: 2  value: 150.9551 mgc: 1.733142e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.003792301 
iter: 1  value: 150.955 mgc: 0.009248928 ustep: 1 
iter: 2  value: 150.955 mgc: 1.734006e-07 ustep: 1 
iter: 3  mgc: 3.574918e-14 
outer mgc:  0.003784832 
iter: 1  value: 150.9607 mgc: 0.0282763 ustep: 1 
iter: 2  value: 150.9607 mgc: 3.676639e-07 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.02208066 
iter: 1  value: 150.9494 mgc: 0.02835412 ustep: 1 
iter: 2  value: 150.9494 mgc: 3.66973e-07 ustep: 1 
iter: 3  mgc: 2.431388e-14 
outer mgc:  0.02207853 
iter: 1  value: 150.9587 mgc: 0.00772195 ustep: 1 
iter: 2  value: 150.9587 mgc: 3.414098e-07 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.008503794 
iter: 1  value: 150.9514 mgc: 0.007737684 ustep: 1 
iter: 2  value: 150.9514 mgc: 3.421454e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.008498211 
iter: 1  value: 150.9564 mgc: 0.02145281 ustep: 1 
iter: 2  value: 150.9564 mgc: 9.397237e-07 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.03434962 
iter: 1  value: 150.9538 mgc: 0.02147427 ustep: 1 
iter: 2  value: 150.9538 mgc: 9.438246e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.03435662 
[Mon Aug 16 02:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:57:33 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.1_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.1_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_80_3_0.1_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.1, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.1_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.1_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.1_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.1_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.1_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21662.437108 
iter  10 value 20643.802000
iter  10 value 20643.801970
final  value 20643.801970 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1809.821 mgc: 86.46527 ustep: 1 
iter: 2  value: 1616.179 mgc: 24.74296 ustep: 1 
iter: 3  value: 1608.924 mgc: 16.61441 ustep: 1 
iter: 4  value: 1608.881 mgc: 1.610385 ustep: 1 
iter: 5  value: 1608.881 mgc: 0.02379876 ustep: 1 
iter: 6  value: 1608.881 mgc: 5.497871e-06 ustep: 1 
iter: 7  mgc: 2.948475e-13 
iter: 1  mgc: 2.948475e-13 
Matching hessian patterns... Done
outer mgc:  416.1185 
iter: 1  value: 1759.096 mgc: 33.25901 ustep: 1 
iter: 2  value: 1739.395 mgc: 5.729405 ustep: 1 
iter: 3  value: 1739.378 mgc: 0.2208446 ustep: 1 
iter: 4  value: 1739.378 mgc: 0.0005470922 ustep: 1 
iter: 5  mgc: 3.392745e-09 
iter: 1  value: 1498.029 mgc: 14.42236 ustep: 1 
iter: 2  value: 1497.461 mgc: 0.9412873 ustep: 1 
iter: 3  value: 1497.461 mgc: 0.007591469 ustep: 1 
iter: 4  value: 1497.461 mgc: 5.995289e-07 ustep: 1 
iter: 5  mgc: 3.025358e-14 
iter: 1  mgc: 3.025358e-14 
outer mgc:  89.14464 
iter: 1  value: 1455.292 mgc: 5.306379 ustep: 1 
iter: 2  value: 1455.264 mgc: 0.1701562 ustep: 1 
iter: 3  value: 1455.264 mgc: 0.0003594053 ustep: 1 
iter: 4  mgc: 3.188785e-09 
iter: 1  value: 1438.733 mgc: 5.908798 ustep: 1 
iter: 2  value: 1438.686 mgc: 0.2198144 ustep: 1 
iter: 3  value: 1438.686 mgc: 0.0008130599 ustep: 1 
iter: 4  value: 1438.686 mgc: 1.458334e-08 ustep: 1 
mgc: 3.452794e-14 
iter: 1  mgc: 3.452794e-14 
outer mgc:  301.6639 
iter: 1  value: 1491.934 mgc: 60.25162 ustep: 1 
iter: 2  value: 1411.002 mgc: 18.72064 ustep: 1 
iter: 3  value: 1410.945 mgc: 0.5899632 ustep: 1 
iter: 4  value: 1410.945 mgc: 0.003896794 ustep: 1 
iter: 5  value: 1410.945 mgc: 1.966238e-07 ustep: 1 
iter: 6  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  490.1911 
iter: 1  value: 1417.027 mgc: 40.20279 ustep: 1 
iter: 2  value: 1400.872 mgc: 3.543756 ustep: 1 
iter: 3  value: 1400.868 mgc: 0.1017581 ustep: 1 
iter: 4  value: 1400.868 mgc: 0.0001261268 ustep: 1 
iter: 5  mgc: 1.857599e-10 
iter: 1  mgc: 1.857599e-10 
outer mgc:  466.5264 
iter: 1  value: 1268.548 mgc: 23.6067 ustep: 1 
iter: 2  value: 1265.75 mgc: 2.334331 ustep: 1 
iter: 3  value: 1265.749 mgc: 0.0257085 ustep: 1 
iter: 4  value: 1265.749 mgc: 4.765897e-06 ustep: 1 
iter: 5  mgc: 1.632028e-13 
iter: 1  mgc: 1.632028e-13 
outer mgc:  132.1008 
iter: 1  value: 1260.009 mgc: 4.735677 ustep: 1 
iter: 2  value: 1260.009 mgc: 0.06245887 ustep: 1 
iter: 3  value: 1260.009 mgc: 7.055565e-05 ustep: 1 
iter: 4  mgc: 8.178402e-11 
iter: 1  mgc: 8.178402e-11 
outer mgc:  189.3297 
iter: 1  value: 1251.758 mgc: 15.82025 ustep: 1 
iter: 2  value: 1251.699 mgc: 0.5000267 ustep: 1 
iter: 3  value: 1251.699 mgc: 0.001024334 ustep: 1 
iter: 4  value: 1251.699 mgc: 1.988161e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  208.7393 
iter: 1  value: 1226.143 mgc: 14.16516 ustep: 1 
iter: 2  value: 1226.111 mgc: 0.2787445 ustep: 1 
iter: 3  value: 1226.111 mgc: 0.0003160229 ustep: 1 
iter: 4  mgc: 2.497037e-10 
iter: 1  mgc: 2.497037e-10 
outer mgc:  69.98208 
iter: 1  value: 1228.284 mgc: 5.89555 ustep: 1 
iter: 2  value: 1228.278 mgc: 0.2089411 ustep: 1 
iter: 3  value: 1228.278 mgc: 0.0003567118 ustep: 1 
iter: 4  mgc: 9.706347e-10 
iter: 1  value: 1222.645 mgc: 3.504385 ustep: 1 
iter: 2  value: 1222.644 mgc: 0.03247259 ustep: 1 
iter: 3  value: 1222.644 mgc: 9.077798e-06 ustep: 1 
iter: 4  mgc: 8.331114e-13 
iter: 1  mgc: 8.331114e-13 
outer mgc:  27.59874 
iter: 1  value: 1219.061 mgc: 1.087985 ustep: 1 
iter: 2  value: 1219.061 mgc: 0.002926323 ustep: 1 
iter: 3  value: 1219.061 mgc: 4.255959e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  10.14967 
iter: 1  value: 1217.543 mgc: 1.639143 ustep: 1 
iter: 2  value: 1217.543 mgc: 0.008206615 ustep: 1 
iter: 3  value: 1217.543 mgc: 2.87846e-07 ustep: 1 
iter: 4  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  20.76063 
iter: 1  value: 1216.282 mgc: 0.8007318 ustep: 1 
iter: 2  value: 1216.282 mgc: 0.0009934344 ustep: 1 
iter: 3  mgc: 4.723151e-09 
iter: 1  mgc: 4.723151e-09 
outer mgc:  28.87997 
iter: 1  value: 1216.28 mgc: 3.271882 ustep: 1 
iter: 2  value: 1216.28 mgc: 0.01460882 ustep: 1 
iter: 3  value: 1216.28 mgc: 5.420995e-07 ustep: 1 
iter: 4  mgc: 3.433365e-14 
iter: 1  value: 1216.289 mgc: 2.315017 ustep: 1 
iter: 2  value: 1216.289 mgc: 0.006744538 ustep: 1 
iter: 3  value: 1216.289 mgc: 1.477279e-07 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  28.2024 
iter: 1  value: 1215.55 mgc: 1.296273 ustep: 1 
iter: 2  value: 1215.55 mgc: 0.002707229 ustep: 1 
iter: 3  value: 1215.55 mgc: 3.004533e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  7.215618 
iter: 1  value: 1215.148 mgc: 0.5325103 ustep: 1 
iter: 2  value: 1215.148 mgc: 0.0003770774 ustep: 1 
iter: 3  mgc: 3.498064e-10 
iter: 1  mgc: 3.498064e-10 
outer mgc:  13.48923 
iter: 1  value: 1214.506 mgc: 0.5438403 ustep: 1 
iter: 2  value: 1214.506 mgc: 0.0007977551 ustep: 1 
iter: 3  mgc: 2.911054e-09 
iter: 1  mgc: 2.911054e-09 
outer mgc:  6.41044 
iter: 1  value: 1214.067 mgc: 0.5802684 ustep: 1 
iter: 2  value: 1214.067 mgc: 0.001295632 ustep: 1 
iter: 3  mgc: 7.20692e-09 
iter: 1  mgc: 7.20692e-09 
outer mgc:  7.942988 
iter: 1  value: 1213.025 mgc: 0.9132415 ustep: 1 
iter: 2  value: 1213.025 mgc: 0.002152232 ustep: 1 
iter: 3  value: 1213.025 mgc: 1.576377e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  6.23671 
iter: 1  value: 1212.478 mgc: 1.001565 ustep: 1 
iter: 2  value: 1212.478 mgc: 0.003380938 ustep: 1 
iter: 3  value: 1212.478 mgc: 1.037269e-07 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  6.419589 
iter: 1  value: 1212.293 mgc: 0.9505117 ustep: 1 
iter: 2  value: 1212.293 mgc: 0.00238632 ustep: 1 
iter: 3  value: 1212.293 mgc: 3.291407e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  19.73657 
iter: 1  value: 1211.884 mgc: 1.407387 ustep: 1 
iter: 2  value: 1211.884 mgc: 0.002094314 ustep: 1 
iter: 3  mgc: 9.96714e-09 
iter: 1  mgc: 9.96714e-09 
outer mgc:  13.04286 
iter: 1  value: 1210.68 mgc: 1.1819 ustep: 1 
iter: 2  value: 1210.68 mgc: 0.002216262 ustep: 1 
iter: 3  value: 1210.68 mgc: 5.668601e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  3.755544 
iter: 1  value: 1210.799 mgc: 1.262155 ustep: 1 
iter: 2  value: 1210.799 mgc: 0.004623082 ustep: 1 
iter: 3  value: 1210.799 mgc: 6.211312e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  value: 1210.625 mgc: 0.3590162 ustep: 1 
iter: 2  value: 1210.625 mgc: 0.0003698412 ustep: 1 
iter: 3  mgc: 3.966919e-10 
iter: 1  mgc: 3.966919e-10 
outer mgc:  5.169407 
iter: 1  value: 1210.48 mgc: 0.3726883 ustep: 1 
iter: 2  value: 1210.48 mgc: 0.0001868635 ustep: 1 
iter: 3  mgc: 3.74218e-10 
iter: 1  mgc: 3.74218e-10 
outer mgc:  3.572158 
iter: 1  value: 1210.434 mgc: 0.1930074 ustep: 1 
iter: 2  value: 1210.434 mgc: 0.0001224993 ustep: 1 
iter: 3  mgc: 5.726175e-11 
iter: 1  mgc: 5.726175e-11 
outer mgc:  3.498176 
iter: 1  value: 1210.367 mgc: 0.17009 ustep: 1 
iter: 2  value: 1210.367 mgc: 8.39979e-05 ustep: 1 
iter: 3  mgc: 3.380851e-11 
iter: 1  mgc: 3.380851e-11 
outer mgc:  3.458136 
iter: 1  value: 1209.891 mgc: 0.2280064 ustep: 1 
iter: 2  value: 1209.891 mgc: 0.0001724834 ustep: 1 
iter: 3  mgc: 1.619078e-10 
iter: 1  value: 1208.897 mgc: 0.4417411 ustep: 1 
iter: 2  value: 1208.897 mgc: 0.0004297751 ustep: 1 
iter: 3  mgc: 9.307932e-10 
iter: 1  value: 1207.31 mgc: 0.7455565 ustep: 1 
iter: 2  value: 1207.31 mgc: 0.001258064 ustep: 1 
iter: 3  mgc: 7.448405e-09 
iter: 1  mgc: 7.448405e-09 
outer mgc:  8.553629 
iter: 1  value: 1207.129 mgc: 0.9483871 ustep: 1 
iter: 2  value: 1207.129 mgc: 0.002827053 ustep: 1 
iter: 3  value: 1207.129 mgc: 4.481371e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  6.500622 
iter: 1  value: 1202.915 mgc: 3.313452 ustep: 1 
iter: 2  value: 1202.915 mgc: 0.02366351 ustep: 1 
iter: 3  value: 1202.915 mgc: 2.434415e-06 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  value: 1206.485 mgc: 0.5330088 ustep: 1 
iter: 2  value: 1206.485 mgc: 0.0004633822 ustep: 1 
iter: 3  mgc: 6.51561e-10 
iter: 1  mgc: 6.51561e-10 
outer mgc:  3.06883 
iter: 1  value: 1205.788 mgc: 0.4067767 ustep: 1 
iter: 2  value: 1205.788 mgc: 0.0006697711 ustep: 1 
iter: 3  mgc: 1.706637e-09 
iter: 1  mgc: 1.706637e-09 
outer mgc:  1.47058 
iter: 1  value: 1205.715 mgc: 0.4169044 ustep: 1 
iter: 2  value: 1205.715 mgc: 0.0003494008 ustep: 1 
iter: 3  mgc: 7.279368e-10 
iter: 1  mgc: 7.279368e-10 
outer mgc:  6.342793 
iter: 1  value: 1205.388 mgc: 0.2701875 ustep: 1 
iter: 2  value: 1205.388 mgc: 0.0001721936 ustep: 1 
iter: 3  mgc: 7.302603e-11 
iter: 1  mgc: 7.302603e-11 
outer mgc:  1.987695 
iter: 1  value: 1204.9 mgc: 0.2867827 ustep: 1 
iter: 2  value: 1204.9 mgc: 0.0002487306 ustep: 1 
iter: 3  mgc: 3.617671e-10 
iter: 1  mgc: 3.617671e-10 
outer mgc:  2.161077 
iter: 1  value: 1204.46 mgc: 0.2717838 ustep: 1 
iter: 2  value: 1204.46 mgc: 0.0002826958 ustep: 1 
iter: 3  mgc: 3.379483e-10 
iter: 1  mgc: 3.379483e-10 
outer mgc:  2.100216 
iter: 1  value: 1203.849 mgc: 0.3562338 ustep: 1 
iter: 2  value: 1203.849 mgc: 0.0003322543 ustep: 1 
iter: 3  mgc: 5.165148e-10 
iter: 1  value: 1204.205 mgc: 0.1578312 ustep: 1 
iter: 2  value: 1204.205 mgc: 6.382023e-05 ustep: 1 
iter: 3  mgc: 1.570122e-11 
iter: 1  mgc: 1.570122e-11 
outer mgc:  1.332829 
iter: 1  value: 1204.142 mgc: 0.1424312 ustep: 1 
iter: 2  value: 1204.142 mgc: 3.70307e-05 ustep: 1 
iter: 3  mgc: 1.908074e-11 
iter: 1  value: 1204.182 mgc: 0.09685982 ustep: 1 
iter: 2  value: 1204.182 mgc: 1.099167e-05 ustep: 1 
iter: 3  mgc: 7.762679e-13 
iter: 1  value: 1204.198 mgc: 0.05016879 ustep: 1 
iter: 2  value: 1204.198 mgc: 2.382734e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
iter: 1  mgc: 4.796163e-14 
outer mgc:  0.9993265 
iter: 1  value: 1204.19 mgc: 0.03300694 ustep: 1 
iter: 2  value: 1204.19 mgc: 1.632521e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.1830733 
iter: 1  value: 1204.176 mgc: 0.01130833 ustep: 1 
iter: 2  value: 1204.176 mgc: 1.74594e-07 ustep: 1 
iter: 3  mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  0.139782 
iter: 1  value: 1204.159 mgc: 0.01241991 ustep: 1 
iter: 2  value: 1204.159 mgc: 2.588209e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.1106643 
iter: 1  value: 1204.143 mgc: 0.008536424 ustep: 1 
iter: 2  value: 1204.143 mgc: 1.198931e-07 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.03406762 
iter: 1  value: 1204.131 mgc: 0.007068781 ustep: 1 
iter: 2  value: 1204.131 mgc: 9.284959e-08 ustep: 1 
iter: 3  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.004067608 
iter: 1  value: 1204.13 mgc: 0.001196146 ustep: 1 
iter: 2  mgc: 7.132049e-09 
iter: 1  mgc: 7.132049e-09 
outer mgc:  0.003262179 
iter: 1  value: 1204.131 mgc: 0.0006257591 ustep: 1 
iter: 2  mgc: 1.35076e-09 
iter: 1  mgc: 1.35076e-09 
outer mgc:  2.784177e-05 
iter: 1  mgc: 1.35076e-09 
iter: 1  mgc: 1.35076e-09 
outer mgc:  2.784177e-05 
iter: 1  value: 1204.136 mgc: 0.05889668 ustep: 1 
iter: 2  value: 1204.136 mgc: 4.839024e-06 ustep: 1 
iter: 3  mgc: 1.150191e-13 
outer mgc:  1.359138 
iter: 1  value: 1204.127 mgc: 0.05889449 ustep: 1 
iter: 2  value: 1204.127 mgc: 4.844527e-06 ustep: 1 
iter: 3  mgc: 1.207923e-13 
outer mgc:  1.359248 
iter: 1  value: 1204.134 mgc: 0.03198842 ustep: 1 
iter: 2  value: 1204.134 mgc: 1.307308e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  1.499874 
iter: 1  value: 1204.129 mgc: 0.03198781 ustep: 1 
iter: 2  value: 1204.129 mgc: 1.306827e-06 ustep: 1 
iter: 3  mgc: 3.042011e-14 
outer mgc:  1.499879 
iter: 1  value: 1204.127 mgc: 0.04334697 ustep: 1 
iter: 2  value: 1204.127 mgc: 4.408085e-06 ustep: 1 
iter: 3  mgc: 5.995204e-14 
outer mgc:  1.279078 
iter: 1  value: 1204.136 mgc: 0.04332661 ustep: 1 
iter: 2  value: 1204.136 mgc: 4.411514e-06 ustep: 1 
iter: 3  mgc: 5.240253e-14 
outer mgc:  1.278957 
iter: 1  value: 1204.129 mgc: 0.02032911 ustep: 1 
iter: 2  value: 1204.129 mgc: 1.059616e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  1.041967 
iter: 1  value: 1204.134 mgc: 0.02031847 ustep: 1 
iter: 2  value: 1204.134 mgc: 1.059113e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  1.041607 
iter: 1  value: 1204.115 mgc: 0.00647961 ustep: 1 
iter: 2  value: 1204.115 mgc: 9.293054e-08 ustep: 1 
mgc: 3.219647e-14 
outer mgc:  0.01280724 
iter: 1  value: 1204.147 mgc: 0.006477159 ustep: 1 
iter: 2  value: 1204.147 mgc: 9.296783e-08 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.01286886 
iter: 1  value: 1204.151 mgc: 0.04005003 ustep: 1 
iter: 2  value: 1204.151 mgc: 2.733488e-06 ustep: 1 
iter: 3  mgc: 6.306067e-14 
outer mgc:  0.452024 
iter: 1  value: 1204.111 mgc: 0.04016502 ustep: 1 
iter: 2  value: 1204.111 mgc: 2.731602e-06 ustep: 1 
iter: 3  mgc: 7.061018e-14 
outer mgc:  0.4525012 
iter: 1  value: 1204.167 mgc: 0.03898376 ustep: 1 
iter: 2  value: 1204.167 mgc: 4.942919e-06 ustep: 1 
iter: 3  mgc: 1.496581e-13 
outer mgc:  0.3953337 
iter: 1  value: 1204.095 mgc: 0.03909645 ustep: 1 
iter: 2  value: 1204.095 mgc: 4.953983e-06 ustep: 1 
iter: 3  mgc: 1.49214e-13 
outer mgc:  0.3954885 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:57:35 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:35:38 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22008.499979 
final  value 21083.629016 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19569.08 mgc: 4.405617 ustep: 0.6827823 
iter: 2  value: 19530.29 mgc: 2.270624 ustep: 0.8263238 
iter: 3  value: 19526.34 mgc: 2.128083 ustep: 0.6983222 
iter: 4  value: 19522.93 mgc: 2.298497 ustep: 0.8356732 
iter: 5  value: 19517.95 mgc: 2.117395 ustep: 0.4586086 
iter: 6  value: 19516.34 mgc: 1.426686 ustep: 0.6772387 
iter: 7  value: 19516.34 mgc: 0.06696816 ustep: 0.8229629 
iter: 8  value: 19516.34 mgc: 0.007858196 ustep: 0.9071823 
iter: 9  value: 19516.34 mgc: 0.0004792254 ustep: 0.9524659 
iter: 10  value: 19516.34 mgc: 1.529529e-05 ustep: 0.975946 
iter: 11  value: 19516.34 mgc: 2.519362e-07 ustep: 0.987901 
iter: 12  mgc: 2.109601e-09 
iter: 1  mgc: 2.109601e-09 
Matching hessian patterns... Done
outer mgc:  144.5527 
iter: 1  value: 19311.85 mgc: 0.8434107 ustep: 1 
iter: 2  value: 19311.84 mgc: 0.07853316 ustep: 1 
iter: 3  value: 19311.84 mgc: 0.0007387384 ustep: 1 
iter: 4  value: 19311.84 mgc: 9.695722e-08 ustep: 1 
iter: 5  mgc: 3.497203e-15 
iter: 1  value: 19155.38 mgc: 3.379565 ustep: 1 
iter: 2  value: 19155.36 mgc: 0.2207686 ustep: 1 
iter: 3  value: 19155.36 mgc: 0.001685798 ustep: 1 
iter: 4  value: 19155.36 mgc: 9.200038e-08 ustep: 1 
iter: 5  mgc: 1.287859e-14 
iter: 1  mgc: 1.287859e-14 
outer mgc:  70.37148 
iter: 1  value: 19920.22 mgc: 12.07072 ustep: 0.4367355 
iter: 2  value: 19263.94 mgc: 12.16598 ustep: 0.2368445 
iter: 3  value: 19216.8 mgc: 8.316061 ustep: 0.486718 
iter: 4  value: 19213.68 mgc: 6.054662 ustep: 0.4501205 
iter: 5  value: 19202.06 mgc: 11.42412 ustep: 0.2425608 
iter: 6  value: 19201.59 mgc: 3.193065 ustep: 0.4925553 
iter: 7  value: 19201.58 mgc: 0.2635297 ustep: 0.7018527 
iter: 8  value: 19201.58 mgc: 0.01037151 ustep: 0.8377827 
iter: 9  value: 19201.58 mgc: 0.0002459412 ustep: 0.9153132 
iter: 10  value: 19201.58 mgc: 3.87328e-06 ustep: 0.9567243 
iter: 11  value: 19201.58 mgc: 3.881582e-08 ustep: 0.9781251 
iter: 12  mgc: 1.896121e-10 
iter: 1  value: 19171.51 mgc: 3.167697 ustep: 1 
iter: 2  value: 19168.47 mgc: 1.202197 ustep: 1 
iter: 3  value: 19168.47 mgc: 0.07042433 ustep: 1 
iter: 4  value: 19168.47 mgc: 0.0002850722 ustep: 1 
iter: 5  mgc: 4.563885e-09 
iter: 1  mgc: 4.563885e-09 
outer mgc:  64.3739 
iter: 1  value: 19215.95 mgc: 14.89839 ustep: 1 
iter: 2  value: 19213.96 mgc: 1.914505 ustep: 1 
iter: 3  value: 19213.96 mgc: 0.07973207 ustep: 1 
iter: 4  value: 19213.96 mgc: 0.0001643016 ustep: 1 
iter: 5  mgc: 7.564798e-10 
iter: 1  value: 19136.39 mgc: 3.146524 ustep: 1 
iter: 2  value: 19136.37 mgc: 0.2027017 ustep: 1 
iter: 3  value: 19136.37 mgc: 0.001183599 ustep: 1 
iter: 4  value: 19136.37 mgc: 4.284791e-08 ustep: 1 
mgc: 8.65974e-15 
iter: 1  mgc: 8.65974e-15 
outer mgc:  33.98748 
iter: 1  value: 19108.68 mgc: 3.083724 ustep: 1 
iter: 2  value: 19108.66 mgc: 0.1127118 ustep: 1 
iter: 3  value: 19108.66 mgc: 0.0003968969 ustep: 1 
iter: 4  value: 19108.66 mgc: 1.111448e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  57.59878 
iter: 1  value: 19089.72 mgc: 3.069264 ustep: 1 
iter: 2  value: 19089.7 mgc: 0.1354808 ustep: 1 
iter: 3  value: 19089.7 mgc: 0.0003334898 ustep: 1 
iter: 4  mgc: 7.002359e-10 
iter: 1  mgc: 7.002359e-10 
outer mgc:  57.35856 
iter: 1  value: 19074.62 mgc: 3.68351 ustep: 1 
iter: 2  value: 19074.6 mgc: 0.2136031 ustep: 1 
iter: 3  value: 19074.6 mgc: 0.0005657603 ustep: 1 
iter: 4  mgc: 3.912093e-09 
iter: 1  mgc: 3.912093e-09 
outer mgc:  18.65376 
iter: 1  value: 19056.76 mgc: 6.841451 ustep: 1 
iter: 2  value: 19056.75 mgc: 0.2978171 ustep: 1 
iter: 3  value: 19056.75 mgc: 0.0007330146 ustep: 1 
iter: 4  mgc: 4.434535e-09 
iter: 1  value: 19065.49 mgc: 2.103629 ustep: 1 
iter: 2  value: 19065.49 mgc: 0.0377839 ustep: 1 
iter: 3  value: 19065.49 mgc: 1.593269e-05 ustep: 1 
iter: 4  mgc: 3.197886e-12 
iter: 1  mgc: 3.197886e-12 
outer mgc:  11.9535 
iter: 1  value: 19056.35 mgc: 1.514357 ustep: 1 
iter: 2  value: 19056.35 mgc: 0.01359922 ustep: 1 
iter: 3  value: 19056.35 mgc: 3.183591e-06 ustep: 1 
iter: 4  mgc: 1.661865e-13 
iter: 1  value: 19061.46 mgc: 0.93812 ustep: 1 
iter: 2  value: 19061.46 mgc: 0.005220606 ustep: 1 
iter: 3  value: 19061.46 mgc: 4.253921e-07 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  12.63112 
iter: 1  value: 19059.13 mgc: 1.81301 ustep: 1 
iter: 2  value: 19059.13 mgc: 0.006918668 ustep: 1 
iter: 3  value: 19059.13 mgc: 1.092388e-06 ustep: 1 
iter: 4  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  10.17355 
iter: 1  value: 19056.03 mgc: 1.126449 ustep: 1 
iter: 2  value: 19056.03 mgc: 0.010464 ustep: 1 
iter: 3  value: 19056.03 mgc: 1.283277e-06 ustep: 1 
iter: 4  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  2.360131 
iter: 1  value: 19051.61 mgc: 0.742084 ustep: 1 
iter: 2  value: 19051.61 mgc: 0.004871716 ustep: 1 
iter: 3  value: 19051.61 mgc: 1.666886e-07 ustep: 1 
iter: 4  mgc: 6.550316e-15 
iter: 1  value: 19053.76 mgc: 0.3076098 ustep: 1 
iter: 2  value: 19053.76 mgc: 0.0008492357 ustep: 1 
iter: 3  mgc: 5.828594e-09 
iter: 1  mgc: 5.828594e-09 
outer mgc:  4.322325 
iter: 1  value: 19053.14 mgc: 0.2628964 ustep: 1 
iter: 2  value: 19053.14 mgc: 0.0002452029 ustep: 1 
iter: 3  mgc: 4.815419e-10 
iter: 1  value: 19053.52 mgc: 0.122375 ustep: 1 
iter: 2  value: 19053.52 mgc: 9.680461e-05 ustep: 1 
iter: 3  mgc: 8.391332e-11 
iter: 1  mgc: 8.391332e-11 
outer mgc:  2.795662 
iter: 1  value: 19053.34 mgc: 0.08297076 ustep: 1 
iter: 2  value: 19053.34 mgc: 2.948825e-05 ustep: 1 
iter: 3  mgc: 1.594147e-11 
iter: 1  mgc: 1.594147e-11 
outer mgc:  1.091007 
iter: 1  value: 19051.97 mgc: 0.1821155 ustep: 1 
iter: 2  value: 19051.97 mgc: 0.0001614395 ustep: 1 
iter: 3  mgc: 2.275624e-10 
iter: 1  mgc: 2.275624e-10 
outer mgc:  2.447686 
iter: 1  value: 19050.01 mgc: 0.3009423 ustep: 1 
iter: 2  value: 19050.01 mgc: 0.0009105596 ustep: 1 
iter: 3  mgc: 8.239722e-09 
iter: 1  mgc: 8.239722e-09 
outer mgc:  1.183687 
iter: 1  value: 19048.29 mgc: 0.4040953 ustep: 1 
iter: 2  value: 19048.29 mgc: 0.001035291 ustep: 1 
iter: 3  mgc: 5.738245e-09 
iter: 1  value: 19049.79 mgc: 0.04256201 ustep: 1 
iter: 2  value: 19049.79 mgc: 1.164028e-05 ustep: 1 
iter: 3  mgc: 7.491785e-13 
iter: 1  mgc: 7.491785e-13 
outer mgc:  1.296011 
iter: 1  value: 19049.59 mgc: 0.03860343 ustep: 1 
iter: 2  value: 19049.59 mgc: 6.947257e-06 ustep: 1 
iter: 3  mgc: 1.29996e-12 
iter: 1  mgc: 1.29996e-12 
outer mgc:  0.9097395 
iter: 1  value: 19049.33 mgc: 0.04273396 ustep: 1 
iter: 2  value: 19049.33 mgc: 1.468873e-05 ustep: 1 
iter: 3  mgc: 5.595524e-13 
iter: 1  value: 19049.11 mgc: 0.02901449 ustep: 1 
iter: 2  value: 19049.11 mgc: 1.452896e-05 ustep: 1 
iter: 3  mgc: 3.217981e-12 
iter: 1  value: 19048.55 mgc: 0.07588677 ustep: 1 
iter: 2  value: 19048.55 mgc: 9.909947e-05 ustep: 1 
iter: 3  mgc: 1.54314e-10 
iter: 1  mgc: 1.54314e-10 
outer mgc:  1.041319 
iter: 1  value: 19047.89 mgc: 0.2260352 ustep: 1 
iter: 2  value: 19047.89 mgc: 0.0002146017 ustep: 1 
iter: 3  mgc: 9.951147e-10 
iter: 1  mgc: 9.951147e-10 
outer mgc:  1.698978 
iter: 1  value: 19046.22 mgc: 0.2901064 ustep: 1 
iter: 2  value: 19046.22 mgc: 0.000347629 ustep: 1 
iter: 3  mgc: 1.327513e-09 
iter: 1  mgc: 1.327513e-09 
outer mgc:  2.403028 
iter: 1  value: 19042.65 mgc: 0.3824583 ustep: 1 
iter: 2  value: 19042.65 mgc: 0.0005177627 ustep: 1 
iter: 3  mgc: 4.74131e-09 
iter: 1  mgc: 4.74131e-09 
outer mgc:  2.487182 
iter: 1  value: 19039.83 mgc: 0.3029472 ustep: 1 
iter: 2  value: 19039.83 mgc: 0.0007120298 ustep: 1 
iter: 3  mgc: 3.170745e-09 
iter: 1  mgc: 3.170745e-09 
outer mgc:  1.793864 
iter: 1  value: 19038.68 mgc: 0.2766662 ustep: 1 
iter: 2  value: 19038.68 mgc: 0.0003581761 ustep: 1 
iter: 3  mgc: 1.438034e-09 
iter: 1  mgc: 1.438034e-09 
outer mgc:  1.336969 
iter: 1  value: 19037.75 mgc: 0.1862322 ustep: 1 
iter: 2  value: 19037.75 mgc: 0.0001065895 ustep: 1 
iter: 3  mgc: 1.556764e-10 
iter: 1  mgc: 1.556764e-10 
outer mgc:  1.35487 
iter: 1  value: 19036.82 mgc: 0.6678916 ustep: 1 
iter: 2  value: 19036.82 mgc: 0.001634302 ustep: 1 
iter: 3  value: 19036.82 mgc: 1.670569e-08 ustep: 1 
mgc: 9.547918e-15 
iter: 1  mgc: 9.547918e-15 
outer mgc:  1.346018 
iter: 1  value: 19034.89 mgc: 0.4731417 ustep: 1 
iter: 2  value: 19034.89 mgc: 0.0005860277 ustep: 1 
iter: 3  mgc: 5.082567e-09 
iter: 1  mgc: 5.082567e-09 
outer mgc:  1.676536 
iter: 1  value: 19032.7 mgc: 0.2711954 ustep: 1 
iter: 2  value: 19032.7 mgc: 0.0003834118 ustep: 1 
iter: 3  mgc: 9.102399e-10 
iter: 1  mgc: 9.102399e-10 
outer mgc:  0.6302439 
iter: 1  value: 19030.67 mgc: 0.252952 ustep: 1 
iter: 2  value: 19030.67 mgc: 0.0002468863 ustep: 1 
iter: 3  mgc: 5.973853e-10 
iter: 1  value: 19028.5 mgc: 0.2647062 ustep: 1 
iter: 2  value: 19028.5 mgc: 0.0002573063 ustep: 1 
iter: 3  mgc: 5.766294e-10 
iter: 1  mgc: 5.766294e-10 
outer mgc:  0.4930603 
iter: 1  value: 19025.57 mgc: 0.3089711 ustep: 1 
iter: 2  value: 19025.57 mgc: 0.0002025136 ustep: 1 
iter: 3  mgc: 4.291318e-10 
iter: 1  mgc: 4.291318e-10 
outer mgc:  0.3660618 
iter: 1  value: 19021.73 mgc: 0.434478 ustep: 1 
iter: 2  value: 19021.73 mgc: 0.0004923207 ustep: 1 
iter: 3  mgc: 2.157389e-09 
iter: 1  mgc: 2.157389e-09 
outer mgc:  0.1857239 
iter: 1  value: 19020.92 mgc: 0.07837718 ustep: 1 
iter: 2  value: 19020.92 mgc: 1.267831e-05 ustep: 1 
iter: 3  mgc: 1.755041e-12 
iter: 1  mgc: 1.755041e-12 
outer mgc:  0.03514645 
iter: 1  value: 19020.76 mgc: 0.02638703 ustep: 1 
iter: 2  value: 19020.76 mgc: 1.897385e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.03214908 
iter: 1  value: 19020.74 mgc: 0.008429308 ustep: 1 
iter: 2  value: 19020.74 mgc: 1.123729e-07 ustep: 1 
iter: 3  mgc: 8.770762e-15 
iter: 1  mgc: 8.770762e-15 
outer mgc:  0.004510214 
iter: 1  value: 19020.73 mgc: 0.001500287 ustep: 1 
iter: 2  mgc: 7.79902e-09 
iter: 1  mgc: 7.79902e-09 
outer mgc:  0.00115168 
iter: 1  mgc: 7.79902e-09 
iter: 1  mgc: 7.79902e-09 
outer mgc:  0.00115168 
iter: 1  value: 19020.73 mgc: 0.005779853 ustep: 1 
iter: 2  value: 19020.73 mgc: 1.909019e-07 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.3063933 
iter: 1  value: 19020.73 mgc: 0.005776262 ustep: 1 
iter: 2  value: 19020.73 mgc: 1.906481e-07 ustep: 1 
iter: 3  mgc: 9.436896e-15 
outer mgc:  0.3049691 
iter: 1  value: 19020.73 mgc: 0.003252244 ustep: 1 
iter: 2  value: 19020.73 mgc: 5.520264e-08 ustep: 1 
iter: 3  mgc: 1.032507e-14 
outer mgc:  0.1710658 
iter: 1  value: 19020.73 mgc: 0.003250715 ustep: 1 
iter: 2  value: 19020.73 mgc: 5.515593e-08 ustep: 1 
iter: 3  mgc: 9.492407e-15 
outer mgc:  0.1714576 
iter: 1  value: 19020.74 mgc: 0.006313799 ustep: 1 
iter: 2  value: 19020.74 mgc: 2.351324e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.3488793 
iter: 1  value: 19020.73 mgc: 0.006311905 ustep: 1 
iter: 2  value: 19020.73 mgc: 2.355631e-07 ustep: 1 
iter: 3  mgc: 9.992007e-15 
outer mgc:  0.3499742 
iter: 1  value: 19020.73 mgc: 0.003451456 ustep: 1 
iter: 2  value: 19020.73 mgc: 7.773477e-08 ustep: 1 
iter: 3  mgc: 8.65974e-15 
outer mgc:  0.2201583 
iter: 1  value: 19020.73 mgc: 0.003450721 ustep: 1 
iter: 2  value: 19020.73 mgc: 7.751903e-08 ustep: 1 
iter: 3  mgc: 9.103829e-15 
outer mgc:  0.2193003 
iter: 1  value: 19020.8 mgc: 0.03571159 ustep: 1 
iter: 2  value: 19020.8 mgc: 3.715463e-06 ustep: 1 
iter: 3  mgc: 4.174439e-14 
outer mgc:  0.07719381 
iter: 1  value: 19020.66 mgc: 0.03581049 ustep: 1 
iter: 2  value: 19020.66 mgc: 3.709758e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.07806851 
iter: 1  value: 19020.79 mgc: 0.03773112 ustep: 1 
iter: 2  value: 19020.79 mgc: 1.377005e-06 ustep: 1 
iter: 3  mgc: 2.098322e-14 
outer mgc:  0.1014435 
iter: 1  value: 19020.68 mgc: 0.0378359 ustep: 1 
iter: 2  value: 19020.68 mgc: 1.375406e-06 ustep: 1 
iter: 3  mgc: 2.164935e-14 
outer mgc:  0.1026666 
iter: 1  value: 19020.7 mgc: 0.002722721 ustep: 1 
iter: 2  value: 19020.7 mgc: 1.55102e-08 ustep: 1 
mgc: 1.054712e-14 
outer mgc:  0.003880418 
iter: 1  value: 19020.76 mgc: 0.002721799 ustep: 1 
iter: 2  value: 19020.76 mgc: 1.553463e-08 ustep: 1 
mgc: 8.21565e-15 
outer mgc:  0.001578787 
iter: 1  value: 19020.7 mgc: 0.004248898 ustep: 1 
iter: 2  value: 19020.7 mgc: 2.133111e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.1262903 
iter: 1  value: 19020.76 mgc: 0.004245973 ustep: 1 
iter: 2  value: 19020.76 mgc: 2.130562e-07 ustep: 1 
iter: 3  mgc: 1.176836e-14 
outer mgc:  0.1239658 
[Sun Aug 15 21:35:42 2021]
Finished job 0.
1 of 1 steps (100%) done

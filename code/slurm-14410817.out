Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:26:16 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4384.561644 
iter  10 value 2902.156842
final  value 2895.751722 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3014.423 mgc: 4.235228 ustep: 0.8994163 
iter: 2  value: 3010.048 mgc: 2.540454 ustep: 0.9483808 
iter: 3  value: 3003.588 mgc: 2.911268 ustep: 0.5176473 
iter: 4  value: 2998.953 mgc: 1.561919 ustep: 0.7195052 
iter: 5  value: 2998.704 mgc: 0.6153119 ustep: 0.8482517 
iter: 6  value: 2998.703 mgc: 0.03856896 ustep: 0.9210137 
iter: 7  value: 2998.703 mgc: 0.003177486 ustep: 0.9596986 
iter: 8  value: 2998.703 mgc: 0.0001351517 ustep: 0.9796441 
iter: 9  value: 2998.703 mgc: 2.991263e-06 ustep: 0.9897708 
iter: 10  value: 2998.703 mgc: 3.39967e-08 ustep: 0.9948727 
iter: 11  mgc: 1.960223e-10 
iter: 1  mgc: 1.960223e-10 
Matching hessian patterns... Done
outer mgc:  103.0652 
iter: 1  value: 2942.456 mgc: 0.4283776 ustep: 1 
iter: 2  value: 2942.453 mgc: 0.03905856 ustep: 1 
iter: 3  value: 2942.453 mgc: 0.0006293149 ustep: 1 
iter: 4  value: 2942.453 mgc: 1.709967e-07 ustep: 1 
iter: 5  mgc: 1.365574e-14 
iter: 1  mgc: 1.365574e-14 
outer mgc:  20.26393 
iter: 1  value: 2910.994 mgc: 1.299553 ustep: 1 
iter: 2  value: 2910.991 mgc: 0.07035708 ustep: 1 
iter: 3  value: 2910.991 mgc: 0.0001691549 ustep: 1 
iter: 4  mgc: 1.00701e-09 
iter: 1  value: 2855.735 mgc: 5.027395 ustep: 1 
iter: 2  value: 2855.734 mgc: 0.08140918 ustep: 1 
iter: 3  value: 2855.734 mgc: 2.240036e-05 ustep: 1 
iter: 4  mgc: 1.699418e-12 
iter: 1  mgc: 1.699418e-12 
outer mgc:  19.62551 
iter: 1  value: 2776.213 mgc: 2.268139 ustep: 1 
iter: 2  value: 2776.213 mgc: 0.01008256 ustep: 1 
iter: 3  value: 2776.213 mgc: 1.659215e-06 ustep: 1 
iter: 4  mgc: 3.708145e-14 
iter: 1  value: 2859.521 mgc: 220.8396 ustep: 1 
iter: 2  value: 2859.521 mgc: 0.006184166 ustep: 1 
iter: 3  value: 2859.521 mgc: 3.838655e-07 ustep: 1 
iter: 4  mgc: 5.662137e-15 
iter: 1  mgc: 3.708145e-14 
outer mgc:  24.55372 
iter: 1  value: 2883.568 mgc: 5.34861 ustep: 1 
iter: 2  value: 2883.568 mgc: 0.007255192 ustep: 1 
iter: 3  value: 2883.568 mgc: 5.779309e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  value: 2766.704 mgc: 3.338615 ustep: 1 
iter: 2  value: 2766.704 mgc: 0.01630083 ustep: 1 
iter: 3  value: 2766.704 mgc: 5.80999e-07 ustep: 1 
iter: 4  mgc: 3.330669e-15 
iter: 1  mgc: 3.330669e-15 
outer mgc:  30.17101 
iter: 1  value: 2732.611 mgc: 4.277283 ustep: 1 
iter: 2  value: 2732.611 mgc: 0.02526754 ustep: 1 
iter: 3  value: 2732.611 mgc: 1.379306e-06 ustep: 1 
iter: 4  mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
outer mgc:  13.53304 
iter: 1  value: 2726.419 mgc: 3.072208 ustep: 1 
iter: 2  value: 2726.419 mgc: 0.06358506 ustep: 1 
iter: 3  value: 2726.419 mgc: 5.822951e-05 ustep: 1 
iter: 4  mgc: 2.36875e-11 
iter: 1  mgc: 2.36875e-11 
outer mgc:  24.48212 
iter: 1  value: 2703.12 mgc: 3.8256 ustep: 1 
iter: 2  value: 2703.12 mgc: 0.06697213 ustep: 1 
iter: 3  value: 2703.12 mgc: 1.812545e-05 ustep: 1 
iter: 4  mgc: 1.94933e-12 
iter: 1  mgc: 1.94933e-12 
outer mgc:  9.744273 
iter: 1  value: 2791.34 mgc: 11.79235 ustep: 1 
iter: 2  value: 2791.319 mgc: 0.2454437 ustep: 1 
iter: 3  value: 2791.319 mgc: 0.0006021788 ustep: 1 
iter: 4  mgc: 7.203393e-10 
iter: 1  value: 2700.82 mgc: 0.609497 ustep: 1 
iter: 2  value: 2700.82 mgc: 0.001622097 ustep: 1 
iter: 3  value: 2700.82 mgc: 1.40808e-08 ustep: 1 
mgc: 2.359224e-15 
iter: 1  mgc: 2.359224e-15 
outer mgc:  6.502634 
iter: 1  value: 2698.935 mgc: 0.2148825 ustep: 1 
iter: 2  value: 2698.935 mgc: 0.0002072197 ustep: 1 
iter: 3  mgc: 8.276675e-10 
iter: 1  value: 2694.618 mgc: 0.7597493 ustep: 1 
iter: 2  value: 2694.618 mgc: 0.002545191 ustep: 1 
iter: 3  value: 2694.618 mgc: 1.105502e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  5.116335 
iter: 1  value: 2691.145 mgc: 1.648769 ustep: 1 
iter: 2  value: 2691.145 mgc: 0.006999541 ustep: 1 
iter: 3  value: 2691.145 mgc: 3.187922e-07 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  11.08973 
iter: 1  value: 2684.383 mgc: 6.067616 ustep: 1 
iter: 2  value: 2684.381 mgc: 0.1830078 ustep: 1 
iter: 3  value: 2684.381 mgc: 0.0003792406 ustep: 1 
iter: 4  mgc: 1.368779e-09 
iter: 1  mgc: 1.368779e-09 
outer mgc:  4.455619 
iter: 1  value: 2687.769 mgc: 17.83266 ustep: 1 
iter: 2  value: 2687.759 mgc: 0.452717 ustep: 1 
iter: 3  value: 2687.759 mgc: 0.0004428536 ustep: 1 
iter: 4  mgc: 5.204717e-10 
iter: 1  value: 2689.01 mgc: 6.604493 ustep: 1 
iter: 2  value: 2689.01 mgc: 0.05558454 ustep: 1 
iter: 3  value: 2689.01 mgc: 2.931414e-05 ustep: 1 
iter: 4  mgc: 3.042899e-12 
iter: 1  mgc: 3.042899e-12 
outer mgc:  10.07535 
iter: 1  value: 2688.91 mgc: 4.835538 ustep: 1 
iter: 2  value: 2688.91 mgc: 0.0198822 ustep: 1 
iter: 3  value: 2688.91 mgc: 3.720159e-06 ustep: 1 
iter: 4  mgc: 1.731948e-13 
iter: 1  mgc: 1.731948e-13 
outer mgc:  4.120544 
iter: 1  value: 2691.594 mgc: 5.340028 ustep: 1 
iter: 2  value: 2691.587 mgc: 0.2422447 ustep: 1 
iter: 3  value: 2691.587 mgc: 0.0007287052 ustep: 1 
iter: 4  value: 2691.587 mgc: 1.00783e-08 ustep: 1 
mgc: 8.826273e-15 
iter: 1  mgc: 8.826273e-15 
outer mgc:  8.27979 
iter: 1  value: 2692.471 mgc: 2.794787 ustep: 1 
iter: 2  value: 2692.47 mgc: 0.01784248 ustep: 1 
iter: 3  value: 2692.47 mgc: 1.9534e-05 ustep: 1 
iter: 4  mgc: 1.65068e-12 
iter: 1  mgc: 1.65068e-12 
outer mgc:  3.336006 
iter: 1  value: 2693.167 mgc: 4.099217 ustep: 1 
iter: 2  value: 2693.167 mgc: 0.01619834 ustep: 1 
iter: 3  value: 2693.167 mgc: 1.209236e-05 ustep: 1 
iter: 4  mgc: 2.075007e-12 
iter: 1  mgc: 2.075007e-12 
outer mgc:  1.455417 
iter: 1  value: 2692.323 mgc: 0.4947269 ustep: 1 
iter: 2  value: 2692.323 mgc: 0.001309106 ustep: 1 
iter: 3  value: 2692.323 mgc: 1.28675e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  value: 2691.631 mgc: 0.523835 ustep: 1 
iter: 2  value: 2691.631 mgc: 0.001377247 ustep: 1 
iter: 3  value: 2691.631 mgc: 1.424699e-07 ustep: 1 
iter: 4  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  1.224781 
iter: 1  value: 2691.182 mgc: 1.842089 ustep: 1 
iter: 2  value: 2691.181 mgc: 0.03381314 ustep: 1 
iter: 3  value: 2691.181 mgc: 1.004203e-05 ustep: 1 
iter: 4  mgc: 2.349898e-12 
iter: 1  value: 2691.523 mgc: 0.4342057 ustep: 1 
iter: 2  value: 2691.523 mgc: 0.001775722 ustep: 1 
iter: 3  value: 2691.523 mgc: 2.966368e-08 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  1.661188 
iter: 1  value: 2690.902 mgc: 0.4544397 ustep: 1 
iter: 2  value: 2690.902 mgc: 0.0003577361 ustep: 1 
iter: 3  value: 2690.902 mgc: 1.422111e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.2892286 
iter: 1  value: 2691.362 mgc: 0.2716302 ustep: 1 
iter: 2  value: 2691.362 mgc: 0.0005594636 ustep: 1 
iter: 3  value: 2691.362 mgc: 2.282142e-08 ustep: 1 
mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  0.3104975 
iter: 1  value: 2691.121 mgc: 0.1804945 ustep: 1 
iter: 2  value: 2691.121 mgc: 2.123484e-05 ustep: 1 
iter: 3  mgc: 5.150325e-11 
iter: 1  mgc: 5.150325e-11 
outer mgc:  0.08388738 
iter: 1  value: 2691.018 mgc: 0.09644874 ustep: 1 
iter: 2  value: 2691.018 mgc: 6.050377e-05 ustep: 1 
iter: 3  mgc: 4.307532e-11 
iter: 1  mgc: 4.307532e-11 
outer mgc:  0.04913106 
iter: 1  value: 2690.921 mgc: 0.06976108 ustep: 1 
iter: 2  value: 2690.921 mgc: 1.652362e-05 ustep: 1 
iter: 3  mgc: 5.569767e-12 
iter: 1  value: 2690.776 mgc: 0.1044384 ustep: 1 
iter: 2  value: 2690.776 mgc: 3.57144e-05 ustep: 1 
iter: 3  mgc: 2.579448e-11 
iter: 1  mgc: 2.579448e-11 
outer mgc:  0.08723229 
iter: 1  value: 2690.123 mgc: 0.5144487 ustep: 1 
iter: 2  value: 2690.123 mgc: 0.0004757616 ustep: 1 
iter: 3  mgc: 5.118336e-09 
iter: 1  mgc: 5.118336e-09 
outer mgc:  0.06036418 
iter: 1  value: 2689.753 mgc: 0.2663625 ustep: 1 
iter: 2  value: 2689.753 mgc: 0.000205081 ustep: 1 
iter: 3  mgc: 7.88873e-10 
iter: 1  mgc: 7.88873e-10 
outer mgc:  0.02613949 
iter: 1  value: 2689.697 mgc: 0.04312225 ustep: 1 
iter: 2  value: 2689.697 mgc: 5.012492e-06 ustep: 1 
iter: 3  mgc: 4.822809e-13 
iter: 1  mgc: 4.822809e-13 
outer mgc:  0.002626084 
iter: 1  value: 2689.694 mgc: 0.001685897 ustep: 1 
iter: 2  value: 2689.694 mgc: 1.058806e-08 ustep: 1 
mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.0002324462 
iter: 1  mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.0002324462 
iter: 1  value: 2689.692 mgc: 0.006836779 ustep: 1 
iter: 2  value: 2689.692 mgc: 4.921369e-07 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.06672988 
iter: 1  value: 2689.696 mgc: 0.006832058 ustep: 1 
iter: 2  value: 2689.696 mgc: 4.91813e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.06676165 
iter: 1  value: 2689.693 mgc: 0.002954175 ustep: 1 
iter: 2  value: 2689.693 mgc: 5.834166e-08 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.03467311 
iter: 1  value: 2689.695 mgc: 0.002951898 ustep: 1 
iter: 2  value: 2689.695 mgc: 5.826788e-08 ustep: 1 
iter: 3  mgc: 1.332268e-14 
outer mgc:  0.03469806 
iter: 1  value: 2689.696 mgc: 0.007692743 ustep: 1 
iter: 2  value: 2689.696 mgc: 7.541898e-08 ustep: 1 
iter: 3  mgc: 7.771561e-15 
outer mgc:  0.09399376 
iter: 1  value: 2689.691 mgc: 0.007694372 ustep: 1 
iter: 2  value: 2689.691 mgc: 7.534492e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.09398688 
iter: 1  value: 2689.695 mgc: 0.003001469 ustep: 1 
iter: 2  value: 2689.695 mgc: 5.527158e-08 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.03709728 
iter: 1  value: 2689.693 mgc: 0.003003752 ustep: 1 
iter: 2  value: 2689.693 mgc: 5.534031e-08 ustep: 1 
iter: 3  mgc: 1.088019e-14 
outer mgc:  0.03715439 
iter: 1  value: 2689.703 mgc: 0.03244361 ustep: 1 
iter: 2  value: 2689.703 mgc: 2.878448e-06 ustep: 1 
iter: 3  mgc: 9.836576e-14 
outer mgc:  0.04160867 
iter: 1  value: 2689.685 mgc: 0.03247607 ustep: 1 
iter: 2  value: 2689.685 mgc: 2.886976e-06 ustep: 1 
iter: 3  mgc: 9.614531e-14 
outer mgc:  0.04111272 
iter: 1  value: 2689.708 mgc: 0.03526081 ustep: 1 
iter: 2  value: 2689.708 mgc: 7.008238e-07 ustep: 1 
iter: 3  mgc: 1.332268e-14 
outer mgc:  0.03024616 
iter: 1  value: 2689.68 mgc: 0.0353639 ustep: 1 
iter: 2  value: 2689.68 mgc: 6.966115e-07 ustep: 1 
iter: 3  mgc: 9.992007e-15 
outer mgc:  0.03039371 
iter: 1  value: 2689.689 mgc: 0.002635628 ustep: 1 
iter: 2  value: 2689.689 mgc: 1.915622e-08 ustep: 1 
mgc: 7.355228e-15 
outer mgc:  0.0007003992 
iter: 1  value: 2689.698 mgc: 0.002634815 ustep: 1 
iter: 2  value: 2689.698 mgc: 1.918297e-08 ustep: 1 
mgc: 8.104628e-15 
outer mgc:  0.0007894825 
iter: 1  value: 2689.688 mgc: 0.003854359 ustep: 1 
iter: 2  value: 2689.688 mgc: 9.643281e-08 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.01476593 
iter: 1  value: 2689.7 mgc: 0.003851793 ustep: 1 
iter: 2  value: 2689.7 mgc: 9.642342e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.01485721 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:26:18 2021]
Finished job 0.
1 of 1 steps (100%) done

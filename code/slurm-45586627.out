Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:40:30 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21817.341441 
final  value 19869.276406 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18466.98 mgc: 5.791962 ustep: 0.6827823 
iter: 2  value: 18443.29 mgc: 5.666048 ustep: 0.8263238 
iter: 3  value: 18434.17 mgc: 4.252077 ustep: 0.6983222 
iter: 4  value: 18418.6 mgc: 4.453842 ustep: 0.5945681 
iter: 5  value: 18415.76 mgc: 2.704357 ustep: 0.7711053 
iter: 6  value: 18415.61 mgc: 0.6614455 ustep: 0.8781382 
iter: 7  value: 18415.61 mgc: 0.04512427 ustep: 0.9370966 
iter: 8  value: 18415.61 mgc: 0.004010179 ustep: 0.9680407 
iter: 9  value: 18415.61 mgc: 0.0001884703 ustep: 0.9838922 
iter: 10  value: 18415.61 mgc: 4.639578e-06 ustep: 0.9919142 
iter: 11  value: 18415.61 mgc: 5.593599e-08 ustep: 0.9959493 
iter: 12  mgc: 3.363655e-10 
iter: 1  mgc: 3.363655e-10 
Matching hessian patterns... Done
outer mgc:  127.8458 
iter: 1  value: 18225.31 mgc: 1.603272 ustep: 1 
iter: 2  value: 18225.28 mgc: 0.1539979 ustep: 1 
iter: 3  value: 18225.28 mgc: 0.002527384 ustep: 1 
iter: 4  value: 18225.28 mgc: 7.765049e-07 ustep: 1 
iter: 5  mgc: 7.155387e-14 
iter: 1  value: 18116.83 mgc: 10.97376 ustep: 1 
iter: 2  value: 18114.86 mgc: 1.928365 ustep: 1 
iter: 3  value: 18114.86 mgc: 0.1569632 ustep: 1 
iter: 4  value: 18114.86 mgc: 0.001430759 ustep: 1 
iter: 5  value: 18114.86 mgc: 1.170553e-07 ustep: 1 
iter: 6  mgc: 1.295491e-14 
iter: 1  mgc: 7.155387e-14 
outer mgc:  69.65313 
iter: 1  value: 18105.63 mgc: 3.863254 ustep: 1 
iter: 2  value: 18105.05 mgc: 0.5580998 ustep: 1 
iter: 3  value: 18105.05 mgc: 0.02412518 ustep: 1 
iter: 4  value: 18105.05 mgc: 6.125954e-05 ustep: 1 
iter: 5  mgc: 4.028132e-10 
iter: 1  mgc: 4.028132e-10 
outer mgc:  74.08021 
iter: 1  value: 18131.19 mgc: 7.877396 ustep: 1 
iter: 2  value: 18130.59 mgc: 1.054904 ustep: 1 
iter: 3  value: 18130.59 mgc: 0.03140833 ustep: 1 
iter: 4  value: 18130.59 mgc: 0.0001096584 ustep: 1 
iter: 5  mgc: 5.778888e-10 
iter: 1  value: 18082.36 mgc: 1.199577 ustep: 1 
iter: 2  value: 18082.35 mgc: 0.08592078 ustep: 1 
iter: 3  value: 18082.35 mgc: 0.0003783407 ustep: 1 
iter: 4  mgc: 7.343773e-09 
iter: 1  mgc: 7.343773e-09 
outer mgc:  58.5351 
iter: 1  value: 18060.99 mgc: 2.537883 ustep: 1 
iter: 2  value: 18060.91 mgc: 0.2500327 ustep: 1 
iter: 3  value: 18060.91 mgc: 0.003053468 ustep: 1 
iter: 4  value: 18060.91 mgc: 7.401262e-07 ustep: 1 
iter: 5  mgc: 5.351275e-14 
iter: 1  mgc: 5.351275e-14 
outer mgc:  53.89681 
iter: 1  value: 18016.07 mgc: 6.859364 ustep: 1 
iter: 2  value: 18015.58 mgc: 0.942167 ustep: 1 
iter: 3  value: 18015.58 mgc: 0.0201868 ustep: 1 
iter: 4  value: 18015.58 mgc: 4.11905e-05 ustep: 1 
iter: 5  mgc: 1.02971e-10 
iter: 1  mgc: 1.02971e-10 
outer mgc:  58.5569 
iter: 1  value: 18088.94 mgc: 10.90324 ustep: 1 
iter: 2  value: 18083.82 mgc: 1.241931 ustep: 1 
iter: 3  value: 18083.81 mgc: 0.04687985 ustep: 1 
iter: 4  value: 18083.81 mgc: 7.547654e-05 ustep: 1 
iter: 5  mgc: 1.96962e-10 
iter: 1  value: 18012.82 mgc: 2.44495 ustep: 1 
iter: 2  value: 18012.8 mgc: 0.07531047 ustep: 1 
iter: 3  value: 18012.8 mgc: 0.0003402172 ustep: 1 
iter: 4  mgc: 6.204485e-09 
iter: 1  mgc: 6.204485e-09 
outer mgc:  57.51756 
iter: 1  value: 18000.16 mgc: 1.235395 ustep: 1 
iter: 2  value: 18000.16 mgc: 0.01297396 ustep: 1 
iter: 3  value: 18000.16 mgc: 2.352946e-06 ustep: 1 
iter: 4  mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  16.99163 
iter: 1  value: 17978.55 mgc: 2.389491 ustep: 1 
iter: 2  value: 17978.55 mgc: 0.05949579 ustep: 1 
iter: 3  value: 17978.55 mgc: 0.0002337984 ustep: 1 
iter: 4  mgc: 2.160188e-09 
iter: 1  mgc: 2.160188e-09 
outer mgc:  28.6159 
iter: 1  value: 17968.17 mgc: 4.984572 ustep: 1 
iter: 2  value: 17968.15 mgc: 0.3346971 ustep: 1 
iter: 3  value: 17968.15 mgc: 0.0006719255 ustep: 1 
iter: 4  value: 17968.15 mgc: 1.339763e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  value: 17976.28 mgc: 2.025431 ustep: 1 
iter: 2  value: 17976.28 mgc: 0.07002512 ustep: 1 
iter: 3  value: 17976.28 mgc: 5.152123e-05 ustep: 1 
iter: 4  mgc: 1.439682e-10 
iter: 1  value: 17977.66 mgc: 1.059518 ustep: 1 
iter: 2  value: 17977.66 mgc: 0.007584607 ustep: 1 
iter: 3  value: 17977.66 mgc: 2.630262e-06 ustep: 1 
iter: 4  mgc: 2.526868e-13 
iter: 1  mgc: 2.526868e-13 
outer mgc:  23.93952 
iter: 1  value: 17970.59 mgc: 1.23239 ustep: 1 
iter: 2  value: 17970.59 mgc: 0.02212312 ustep: 1 
iter: 3  value: 17970.59 mgc: 7.789046e-06 ustep: 1 
iter: 4  mgc: 9.610091e-13 
iter: 1  mgc: 9.610091e-13 
outer mgc:  8.213206 
iter: 1  value: 17963.43 mgc: 1.050869 ustep: 1 
iter: 2  value: 17963.43 mgc: 0.01080093 ustep: 1 
iter: 3  value: 17963.43 mgc: 2.322039e-06 ustep: 1 
iter: 4  mgc: 1.763034e-13 
iter: 1  mgc: 1.763034e-13 
outer mgc:  15.26437 
iter: 1  value: 17948.59 mgc: 3.361008 ustep: 1 
iter: 2  value: 17948.59 mgc: 0.07627028 ustep: 1 
iter: 3  value: 17948.59 mgc: 4.048881e-05 ustep: 1 
iter: 4  mgc: 1.176392e-11 
iter: 1  mgc: 1.176392e-11 
outer mgc:  8.62435 
iter: 1  value: 17943.7 mgc: 2.674315 ustep: 1 
iter: 2  value: 17943.7 mgc: 0.02341164 ustep: 1 
iter: 3  value: 17943.7 mgc: 2.562106e-05 ustep: 1 
iter: 4  mgc: 1.700862e-11 
iter: 1  value: 17947.4 mgc: 1.308217 ustep: 1 
iter: 2  value: 17947.4 mgc: 0.004818138 ustep: 1 
iter: 3  value: 17947.4 mgc: 7.683134e-07 ustep: 1 
iter: 4  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  7.029881 
iter: 1  value: 17938.39 mgc: 2.613945 ustep: 1 
iter: 2  value: 17938.39 mgc: 0.01286332 ustep: 1 
iter: 3  value: 17938.39 mgc: 1.449303e-06 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  value: 17946.56 mgc: 0.5589458 ustep: 1 
iter: 2  value: 17946.56 mgc: 0.0006004732 ustep: 1 
iter: 3  value: 17946.56 mgc: 1.63419e-08 ustep: 1 
mgc: 6.77236e-15 
iter: 1  value: 17946.87 mgc: 0.258415 ustep: 1 
iter: 2  value: 17946.87 mgc: 0.0001393694 ustep: 1 
iter: 3  mgc: 8.191261e-10 
iter: 1  mgc: 8.191261e-10 
outer mgc:  3.107412 
iter: 1  value: 17946.41 mgc: 0.4247209 ustep: 1 
iter: 2  value: 17946.41 mgc: 0.0003854427 ustep: 1 
iter: 3  mgc: 1.404168e-09 
iter: 1  mgc: 1.404168e-09 
outer mgc:  2.772271 
iter: 1  value: 17944.1 mgc: 0.4927276 ustep: 1 
iter: 2  value: 17944.1 mgc: 0.0006504797 ustep: 1 
iter: 3  mgc: 4.89105e-09 
iter: 1  mgc: 4.89105e-09 
outer mgc:  5.040859 
iter: 1  value: 17942.11 mgc: 0.3688154 ustep: 1 
iter: 2  value: 17942.11 mgc: 0.0009710675 ustep: 1 
iter: 3  mgc: 2.289206e-09 
iter: 1  mgc: 2.289206e-09 
outer mgc:  1.471225 
iter: 1  value: 17941.1 mgc: 0.2678009 ustep: 1 
iter: 2  value: 17941.1 mgc: 0.0003011422 ustep: 1 
iter: 3  mgc: 4.817244e-10 
iter: 1  mgc: 4.817244e-10 
outer mgc:  2.239327 
iter: 1  value: 17940.84 mgc: 0.4335084 ustep: 1 
iter: 2  value: 17940.84 mgc: 0.0007044009 ustep: 1 
iter: 3  mgc: 2.435996e-09 
iter: 1  mgc: 2.435996e-09 
outer mgc:  1.177746 
iter: 1  value: 17939.26 mgc: 0.2652277 ustep: 1 
iter: 2  value: 17939.26 mgc: 0.0003831035 ustep: 1 
iter: 3  mgc: 8.776615e-10 
iter: 1  mgc: 8.776615e-10 
outer mgc:  1.609756 
iter: 1  value: 17937.07 mgc: 0.1895328 ustep: 1 
iter: 2  value: 17937.07 mgc: 9.818378e-05 ustep: 1 
iter: 3  mgc: 6.84186e-11 
iter: 1  mgc: 6.84186e-11 
outer mgc:  1.22399 
iter: 1  value: 17936.1 mgc: 0.2113185 ustep: 1 
iter: 2  value: 17936.1 mgc: 0.0001048981 ustep: 1 
iter: 3  mgc: 1.100959e-10 
iter: 1  mgc: 1.100959e-10 
outer mgc:  2.790036 
iter: 1  value: 17935.97 mgc: 0.1361916 ustep: 1 
iter: 2  value: 17935.97 mgc: 0.0002158512 ustep: 1 
iter: 3  mgc: 7.956644e-10 
iter: 1  mgc: 7.956644e-10 
outer mgc:  1.722988 
iter: 1  value: 17934.16 mgc: 0.1841932 ustep: 1 
iter: 2  value: 17934.16 mgc: 0.0001070155 ustep: 1 
iter: 3  mgc: 1.648093e-10 
iter: 1  mgc: 1.648093e-10 
outer mgc:  1.082883 
iter: 1  value: 17932.5 mgc: 0.2944854 ustep: 1 
iter: 2  value: 17932.5 mgc: 0.0003245191 ustep: 1 
iter: 3  mgc: 4.28638e-10 
iter: 1  mgc: 4.28638e-10 
outer mgc:  2.63517 
iter: 1  value: 17930.79 mgc: 0.1919691 ustep: 1 
iter: 2  value: 17930.79 mgc: 0.0001266115 ustep: 1 
iter: 3  mgc: 8.226597e-11 
iter: 1  mgc: 8.226597e-11 
outer mgc:  2.187531 
iter: 1  value: 17929.5 mgc: 0.1843567 ustep: 1 
iter: 2  value: 17929.5 mgc: 9.525405e-05 ustep: 1 
iter: 3  mgc: 5.332246e-11 
iter: 1  mgc: 5.332246e-11 
outer mgc:  0.6614902 
iter: 1  value: 17927.59 mgc: 0.2257674 ustep: 1 
iter: 2  value: 17927.59 mgc: 9.002901e-05 ustep: 1 
iter: 3  mgc: 5.626699e-11 
iter: 1  mgc: 5.626699e-11 
outer mgc:  1.098796 
iter: 1  value: 17926.23 mgc: 0.1518003 ustep: 1 
iter: 2  value: 17926.23 mgc: 4.394202e-05 ustep: 1 
iter: 3  mgc: 1.123457e-11 
iter: 1  value: 17922.37 mgc: 0.478552 ustep: 1 
iter: 2  value: 17922.37 mgc: 0.0003368886 ustep: 1 
iter: 3  mgc: 5.997043e-10 
iter: 1  mgc: 5.997043e-10 
outer mgc:  1.120141 
iter: 1  value: 17904.99 mgc: 2.471572 ustep: 1 
iter: 2  value: 17904.99 mgc: 0.008691628 ustep: 1 
iter: 3  value: 17904.99 mgc: 8.234176e-08 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  1.653795 
iter: 1  value: 17894.67 mgc: 3.839583 ustep: 1 
iter: 2  value: 17894.67 mgc: 0.005707863 ustep: 1 
iter: 3  value: 17894.67 mgc: 1.113521e-07 ustep: 1 
iter: 4  mgc: 1.776357e-14 
iter: 1  value: 17901.66 mgc: 1.346101 ustep: 1 
iter: 2  value: 17901.66 mgc: 0.001425674 ustep: 1 
iter: 3  mgc: 6.215794e-09 
iter: 1  mgc: 6.215794e-09 
outer mgc:  1.358869 
iter: 1  value: 17903.77 mgc: 0.3759926 ustep: 1 
iter: 2  value: 17903.77 mgc: 0.001302137 ustep: 1 
iter: 3  value: 17903.77 mgc: 5.384952e-08 ustep: 1 
iter: 4  mgc: 8.416878e-15 
iter: 1  mgc: 8.416878e-15 
outer mgc:  0.8786341 
iter: 1  value: 17899.47 mgc: 0.5532681 ustep: 1 
iter: 2  value: 17899.47 mgc: 0.0002621172 ustep: 1 
iter: 3  mgc: 1.336253e-09 
iter: 1  mgc: 1.336253e-09 
outer mgc:  0.5939009 
iter: 1  value: 17895.07 mgc: 0.6104951 ustep: 1 
iter: 2  value: 17895.07 mgc: 0.0003419626 ustep: 1 
iter: 3  mgc: 1.132783e-10 
iter: 1  mgc: 1.132783e-10 
outer mgc:  0.4766244 
iter: 1  value: 17892.26 mgc: 0.4055484 ustep: 1 
iter: 2  value: 17892.26 mgc: 5.884755e-05 ustep: 1 
iter: 3  mgc: 2.07967e-11 
iter: 1  mgc: 2.07967e-11 
outer mgc:  0.2046928 
iter: 1  value: 17889.3 mgc: 0.3381012 ustep: 1 
iter: 2  value: 17889.3 mgc: 3.615903e-05 ustep: 1 
iter: 3  mgc: 1.097611e-11 
iter: 1  mgc: 1.097611e-11 
outer mgc:  0.06500317 
iter: 1  value: 17886.37 mgc: 0.3122654 ustep: 1 
iter: 2  value: 17886.37 mgc: 3.164724e-05 ustep: 1 
iter: 3  mgc: 7.281287e-12 
iter: 1  mgc: 7.281287e-12 
outer mgc:  0.05566625 
iter: 1  value: 17882.59 mgc: 0.4048329 ustep: 1 
iter: 2  value: 17882.59 mgc: 5.462371e-05 ustep: 1 
iter: 3  mgc: 1.420464e-11 
iter: 1  mgc: 1.420464e-11 
outer mgc:  0.03712946 
iter: 1  value: 17881.33 mgc: 0.1305458 ustep: 1 
iter: 2  value: 17881.33 mgc: 4.921446e-06 ustep: 1 
iter: 3  mgc: 1.456613e-13 
iter: 1  mgc: 1.456613e-13 
outer mgc:  0.003600202 
iter: 1  value: 17880.98 mgc: 0.03570305 ustep: 1 
iter: 2  value: 17880.98 mgc: 4.236124e-07 ustep: 1 
iter: 3  mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  0.001251395 
iter: 1  value: 17880.96 mgc: 0.002331169 ustep: 1 
iter: 2  mgc: 1.378485e-09 
iter: 1  mgc: 1.378485e-09 
outer mgc:  0.0002347174 
iter: 1  mgc: 1.378485e-09 
iter: 1  mgc: 1.378485e-09 
outer mgc:  0.0002347174 
iter: 1  value: 17880.97 mgc: 0.005821829 ustep: 1 
iter: 2  value: 17880.97 mgc: 2.824582e-07 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.3663638 
iter: 1  value: 17880.96 mgc: 0.005821436 ustep: 1 
iter: 2  value: 17880.96 mgc: 2.817275e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.3662741 
iter: 1  value: 17880.97 mgc: 0.003007447 ustep: 1 
iter: 2  value: 17880.97 mgc: 8.679682e-08 ustep: 1 
iter: 3  mgc: 1.29341e-14 
outer mgc:  0.2146797 
iter: 1  value: 17880.96 mgc: 0.003006688 ustep: 1 
iter: 2  value: 17880.96 mgc: 8.674519e-08 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.2145042 
iter: 1  value: 17880.97 mgc: 0.005318562 ustep: 1 
iter: 2  value: 17880.97 mgc: 6.355125e-08 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.2976124 
iter: 1  value: 17880.96 mgc: 0.005316067 ustep: 1 
iter: 2  value: 17880.96 mgc: 6.34676e-08 ustep: 1 
iter: 3  mgc: 1.798561e-14 
outer mgc:  0.2972726 
iter: 1  value: 17880.96 mgc: 0.002680521 ustep: 1 
iter: 2  value: 17880.96 mgc: 2.186999e-08 ustep: 1 
iter: 3  mgc: 1.465494e-14 
outer mgc:  0.1505818 
iter: 1  value: 17880.96 mgc: 0.00267932 ustep: 1 
iter: 2  value: 17880.96 mgc: 2.183602e-08 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.1504558 
iter: 1  value: 17881.02 mgc: 0.06030963 ustep: 1 
iter: 2  value: 17881.02 mgc: 1.106182e-06 ustep: 1 
iter: 3  mgc: 1.287859e-14 
outer mgc:  0.0614986 
iter: 1  value: 17880.9 mgc: 0.06048564 ustep: 1 
iter: 2  value: 17880.9 mgc: 1.108877e-06 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.06141486 
iter: 1  value: 17881.05 mgc: 0.06206469 ustep: 1 
iter: 2  value: 17881.05 mgc: 1.6429e-06 ustep: 1 
iter: 3  mgc: 1.64313e-14 
outer mgc:  0.0326768 
iter: 1  value: 17880.88 mgc: 0.06224769 ustep: 1 
iter: 2  value: 17880.88 mgc: 1.639598e-06 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.03258872 
iter: 1  value: 17880.94 mgc: 0.002763277 ustep: 1 
iter: 2  mgc: 1.769199e-09 
outer mgc:  0.00128504 
iter: 1  value: 17880.99 mgc: 0.002762529 ustep: 1 
iter: 2  mgc: 1.771771e-09 
outer mgc:  0.000816308 
iter: 1  value: 17880.94 mgc: 0.005518077 ustep: 1 
iter: 2  value: 17880.94 mgc: 1.398091e-07 ustep: 1 
iter: 3  mgc: 1.376677e-14 
outer mgc:  0.1467708 
iter: 1  value: 17880.98 mgc: 0.005514893 ustep: 1 
iter: 2  value: 17880.98 mgc: 1.396307e-07 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.1462707 
[Sun Aug 15 21:40:34 2021]
Finished job 0.
1 of 1 steps (100%) done

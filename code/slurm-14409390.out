Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:43:29 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4392.251930 
iter  10 value 3402.372338
final  value 3402.372180 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3046.341 mgc: 120.2554 ustep: 1 
iter: 2  value: 2415.835 mgc: 87.42186 ustep: 1 
iter: 3  value: 2119.513 mgc: 96.19069 ustep: 0.1336527 
iter: 4  value: 1966.303 mgc: 155.2149 ustep: 0.1075309 
iter: 5  value: 1682.637 mgc: 98.75662 ustep: 0.09457213 
iter: 6  value: 1538.052 mgc: 87.67086 ustep: 0.08778208 
iter: 7  value: 1484.948 mgc: 64.71509 ustep: 0.2963508 
iter: 8  value: 1473.837 mgc: 23.95966 ustep: 0.5444267 
iter: 9  value: 1473.579 mgc: 3.173689 ustep: 0.737879 
iter: 10  value: 1473.578 mgc: 0.1805418 ustep: 0.8590129 
iter: 11  value: 1473.578 mgc: 0.001928751 ustep: 0.9268368 
iter: 12  value: 1473.578 mgc: 8.062543e-06 ustep: 0.9627274 
iter: 13  value: 1473.578 mgc: 1.757664e-08 ustep: 0.9811886 
mgc: 1.955658e-11 
iter: 1  mgc: 1.955658e-11 
Matching hessian patterns... Done
outer mgc:  715.0875 
iter: 1  value: 853.4296 mgc: 32.49793 ustep: 1 
iter: 2  value: 843.4017 mgc: 9.501422 ustep: 1 
iter: 3  value: 843.3615 mgc: 0.7751723 ustep: 1 
iter: 4  value: 843.3615 mgc: 0.008828234 ustep: 1 
iter: 5  value: 843.3615 mgc: 1.190655e-06 ustep: 1 
iter: 6  mgc: 2.470246e-14 
iter: 1  value: 452.0315 mgc: 51.06608 ustep: 1 
iter: 2  value: 379.4639 mgc: 22.45557 ustep: 1 
iter: 3  value: 378.4507 mgc: 2.970667 ustep: 1 
iter: 4  value: 378.45 mgc: 0.1110628 ustep: 1 
iter: 5  value: 378.45 mgc: 0.0001804345 ustep: 1 
iter: 6  mgc: 4.769187e-10 
iter: 1  mgc: 4.769187e-10 
outer mgc:  121.9721 
iter: 1  value: 420.8055 mgc: 54.24419 ustep: 1 
iter: 2  value: 408.9203 mgc: 7.714034 ustep: 1 
iter: 3  value: 408.8668 mgc: 0.5956439 ustep: 1 
iter: 4  value: 408.8668 mgc: 0.005365262 ustep: 1 
iter: 5  value: 408.8668 mgc: 8.101801e-07 ustep: 1 
iter: 6  mgc: 3.597123e-14 
iter: 1  value: 336.8697 mgc: 30.33884 ustep: 1 
iter: 2  value: 334.2669 mgc: 3.65057 ustep: 1 
iter: 3  value: 334.2638 mgc: 0.168164 ustep: 1 
iter: 4  value: 334.2638 mgc: 0.0004178292 ustep: 1 
iter: 5  mgc: 2.606825e-09 
iter: 1  mgc: 2.606825e-09 
outer mgc:  143.9866 
iter: 1  value: 312.706 mgc: 29.74091 ustep: 1 
iter: 2  value: 302.3626 mgc: 7.908569 ustep: 1 
iter: 3  value: 302.3204 mgc: 0.5346742 ustep: 1 
iter: 4  value: 302.3204 mgc: 0.004213947 ustep: 1 
iter: 5  value: 302.3204 mgc: 2.684728e-07 ustep: 1 
iter: 6  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  98.42026 
iter: 1  value: 366.5673 mgc: 37.34503 ustep: 1 
iter: 2  value: 365.7806 mgc: 1.934654 ustep: 1 
iter: 3  value: 365.7804 mgc: 0.04393411 ustep: 1 
iter: 4  value: 365.7804 mgc: 4.10119e-05 ustep: 1 
iter: 5  mgc: 3.308598e-11 
iter: 1  value: 275.1077 mgc: 13.89933 ustep: 1 
iter: 2  value: 275.0298 mgc: 0.6350005 ustep: 1 
iter: 3  value: 275.0298 mgc: 0.005060463 ustep: 1 
iter: 4  value: 275.0298 mgc: 3.771205e-07 ustep: 1 
iter: 5  mgc: 2.775558e-14 
iter: 1  mgc: 2.775558e-14 
outer mgc:  20.44327 
iter: 1  value: 270.375 mgc: 9.087334 ustep: 1 
iter: 2  value: 270.3726 mgc: 0.1063512 ustep: 1 
iter: 3  value: 270.3726 mgc: 9.895706e-05 ustep: 1 
iter: 4  mgc: 2.033833e-10 
iter: 1  mgc: 2.033833e-10 
outer mgc:  28.81041 
iter: 1  value: 259.5825 mgc: 14.66872 ustep: 1 
iter: 2  value: 257.7448 mgc: 2.755409 ustep: 1 
iter: 3  value: 257.7435 mgc: 0.07258584 ustep: 1 
iter: 4  value: 257.7435 mgc: 8.259263e-05 ustep: 1 
iter: 5  mgc: 1.621971e-10 
iter: 1  mgc: 1.621971e-10 
outer mgc:  22.66429 
iter: 1  value: 253.4673 mgc: 10.57724 ustep: 1 
iter: 2  value: 253.2912 mgc: 1.218196 ustep: 1 
iter: 3  value: 253.2912 mgc: 0.01123623 ustep: 1 
iter: 4  value: 253.2912 mgc: 2.699676e-06 ustep: 1 
iter: 5  mgc: 2.664535e-13 
iter: 1  mgc: 2.664535e-13 
outer mgc:  41.30122 
iter: 1  value: 243.3626 mgc: 17.76747 ustep: 1 
iter: 2  value: 241.5473 mgc: 3.093143 ustep: 1 
iter: 3  value: 241.5466 mgc: 0.06229786 ustep: 1 
iter: 4  value: 241.5466 mgc: 2.926876e-05 ustep: 1 
iter: 5  mgc: 6.456169e-12 
iter: 1  mgc: 6.456169e-12 
outer mgc:  29.08014 
iter: 1  value: 283.1042 mgc: 40.28544 ustep: 1 
iter: 2  value: 282.603 mgc: 1.319242 ustep: 1 
iter: 3  value: 282.603 mgc: 0.02245512 ustep: 1 
iter: 4  value: 282.603 mgc: 6.723048e-06 ustep: 1 
iter: 5  mgc: 6.181722e-13 
iter: 1  value: 236.9108 mgc: 9.382022 ustep: 1 
iter: 2  value: 236.9016 mgc: 0.2400271 ustep: 1 
iter: 3  value: 236.9016 mgc: 0.0003699328 ustep: 1 
iter: 4  mgc: 8.677565e-10 
iter: 1  mgc: 8.677565e-10 
outer mgc:  15.09035 
iter: 1  value: 234.745 mgc: 3.371456 ustep: 1 
iter: 2  value: 234.7448 mgc: 0.05865139 ustep: 1 
iter: 3  value: 234.7448 mgc: 1.824088e-05 ustep: 1 
iter: 4  mgc: 2.435829e-12 
iter: 1  mgc: 2.435829e-12 
outer mgc:  9.641026 
iter: 1  value: 231.031 mgc: 9.340399 ustep: 1 
iter: 2  value: 231.0299 mgc: 0.08637478 ustep: 1 
iter: 3  value: 231.0299 mgc: 2.873117e-05 ustep: 1 
iter: 4  mgc: 4.144241e-12 
iter: 1  mgc: 4.144241e-12 
outer mgc:  17.5522 
iter: 1  value: 228.6716 mgc: 9.50798 ustep: 1 
iter: 2  value: 228.6676 mgc: 0.3069213 ustep: 1 
iter: 3  value: 228.6676 mgc: 0.0009359497 ustep: 1 
iter: 4  value: 228.6676 mgc: 1.649914e-08 ustep: 1 
mgc: 2.908784e-14 
iter: 1  value: 229.5318 mgc: 5.635963 ustep: 1 
iter: 2  value: 229.5316 mgc: 0.06300223 ustep: 1 
iter: 3  value: 229.5316 mgc: 2.587341e-05 ustep: 1 
iter: 4  mgc: 1.43201e-11 
iter: 1  mgc: 1.43201e-11 
outer mgc:  11.98367 
iter: 1  value: 228.8332 mgc: 2.729283 ustep: 1 
iter: 2  value: 228.8329 mgc: 0.04175273 ustep: 1 
iter: 3  value: 228.8329 mgc: 2.548429e-05 ustep: 1 
iter: 4  mgc: 7.299938e-12 
iter: 1  mgc: 7.299938e-12 
outer mgc:  9.062492 
iter: 1  value: 230.3122 mgc: 7.871254 ustep: 1 
iter: 2  value: 230.3119 mgc: 0.09318712 ustep: 1 
iter: 3  value: 230.3119 mgc: 2.603158e-05 ustep: 1 
iter: 4  mgc: 2.143175e-12 
iter: 1  value: 228.5528 mgc: 1.750509 ustep: 1 
iter: 2  value: 228.5528 mgc: 0.005216182 ustep: 1 
iter: 3  value: 228.5528 mgc: 8.499554e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  5.403623 
iter: 1  value: 228.5284 mgc: 1.231979 ustep: 1 
iter: 2  value: 228.5284 mgc: 0.005596197 ustep: 1 
iter: 3  value: 228.5284 mgc: 8.349649e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  4.830939 
iter: 1  value: 228.2684 mgc: 1.130188 ustep: 1 
iter: 2  value: 228.2684 mgc: 0.001727705 ustep: 1 
iter: 3  value: 228.2684 mgc: 3.916287e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  2.540198 
iter: 1  value: 227.9437 mgc: 0.7881699 ustep: 1 
iter: 2  value: 227.9437 mgc: 0.002902338 ustep: 1 
iter: 3  value: 227.9437 mgc: 4.130681e-08 ustep: 1 
mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  3.016449 
iter: 1  value: 227.8118 mgc: 0.6061986 ustep: 1 
iter: 2  value: 227.8118 mgc: 0.0003894464 ustep: 1 
iter: 3  mgc: 2.957978e-09 
iter: 1  mgc: 2.957978e-09 
outer mgc:  1.524054 
iter: 1  value: 227.7433 mgc: 0.8634586 ustep: 1 
iter: 2  value: 227.7433 mgc: 0.003909746 ustep: 1 
iter: 3  value: 227.7433 mgc: 3.421071e-08 ustep: 1 
mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  1.83498 
iter: 1  value: 227.3623 mgc: 0.7489434 ustep: 1 
iter: 2  value: 227.3623 mgc: 0.001249426 ustep: 1 
iter: 3  mgc: 5.691164e-09 
iter: 1  value: 226.8692 mgc: 0.9221259 ustep: 1 
iter: 2  value: 226.8692 mgc: 0.003113541 ustep: 1 
iter: 3  value: 226.8692 mgc: 3.969064e-08 ustep: 1 
mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  2.842072 
iter: 1  value: 226.3052 mgc: 0.990692 ustep: 1 
iter: 2  value: 226.3052 mgc: 0.001842902 ustep: 1 
iter: 3  mgc: 9.542867e-09 
iter: 1  mgc: 9.542867e-09 
outer mgc:  2.460766 
iter: 1  value: 225.5447 mgc: 1.530793 ustep: 1 
iter: 2  value: 225.5447 mgc: 0.002220021 ustep: 1 
iter: 3  value: 225.5447 mgc: 1.278691e-08 ustep: 1 
mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  1.33895 
iter: 1  value: 225.3775 mgc: 0.6620978 ustep: 1 
iter: 2  value: 225.3775 mgc: 0.0006190018 ustep: 1 
iter: 3  mgc: 9.42605e-09 
iter: 1  value: 225.4816 mgc: 0.2246236 ustep: 1 
iter: 2  value: 225.4816 mgc: 5.854827e-05 ustep: 1 
iter: 3  mgc: 7.732726e-11 
iter: 1  mgc: 7.732726e-11 
outer mgc:  0.9036527 
iter: 1  value: 225.2246 mgc: 0.5546886 ustep: 1 
iter: 2  value: 225.2246 mgc: 0.0007277491 ustep: 1 
iter: 3  mgc: 1.648706e-09 
iter: 1  mgc: 1.648706e-09 
outer mgc:  0.8712424 
iter: 1  value: 225.0801 mgc: 0.1917602 ustep: 1 
iter: 2  value: 225.0801 mgc: 0.0001364026 ustep: 1 
iter: 3  mgc: 2.824496e-10 
iter: 1  mgc: 2.824496e-10 
outer mgc:  0.3332459 
iter: 1  value: 225.1693 mgc: 0.1585324 ustep: 1 
iter: 2  value: 225.1693 mgc: 6.966947e-05 ustep: 1 
iter: 3  mgc: 2.805312e-11 
iter: 1  mgc: 2.805312e-11 
outer mgc:  0.3906587 
iter: 1  value: 225.1264 mgc: 0.08648669 ustep: 1 
iter: 2  value: 225.1264 mgc: 1.959273e-05 ustep: 1 
iter: 3  mgc: 1.163514e-12 
iter: 1  mgc: 1.163514e-12 
outer mgc:  0.01352554 
iter: 1  value: 225.1229 mgc: 0.004571264 ustep: 1 
iter: 2  value: 225.1229 mgc: 4.083761e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.0005599503 
iter: 1  value: 225.1225 mgc: 0.0007246046 ustep: 1 
iter: 2  mgc: 6.065655e-10 
iter: 1  mgc: 6.065655e-10 
outer mgc:  6.235052e-05 
iter: 1  mgc: 6.065655e-10 
iter: 1  mgc: 6.065655e-10 
outer mgc:  6.235052e-05 
iter: 1  value: 225.1211 mgc: 0.03171849 ustep: 1 
iter: 2  value: 225.1211 mgc: 2.271326e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.2695144 
iter: 1  value: 225.1241 mgc: 0.03170057 ustep: 1 
iter: 2  value: 225.1241 mgc: 2.270273e-06 ustep: 1 
iter: 3  mgc: 4.346523e-14 
outer mgc:  0.2693775 
iter: 1  value: 225.1219 mgc: 0.01510243 ustep: 1 
iter: 2  value: 225.1219 mgc: 5.726914e-07 ustep: 1 
iter: 3  mgc: 2.198242e-14 
outer mgc:  0.1837104 
iter: 1  value: 225.1233 mgc: 0.01509174 ustep: 1 
iter: 2  value: 225.1233 mgc: 5.720807e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.1835095 
iter: 1  value: 225.1244 mgc: 0.04572912 ustep: 1 
iter: 2  value: 225.1244 mgc: 2.111648e-06 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  0.3209173 
iter: 1  value: 225.1209 mgc: 0.04573279 ustep: 1 
iter: 2  value: 225.1209 mgc: 2.108267e-06 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  0.3210929 
iter: 1  value: 225.1246 mgc: 0.02277023 ustep: 1 
iter: 2  value: 225.1246 mgc: 2.559356e-07 ustep: 1 
iter: 3  mgc: 3.841372e-14 
outer mgc:  0.27109 
iter: 1  value: 225.1206 mgc: 0.02278155 ustep: 1 
iter: 2  value: 225.1206 mgc: 2.561898e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.2711361 
iter: 1  value: 225.1188 mgc: 0.005376824 ustep: 1 
iter: 2  value: 225.1188 mgc: 5.9774e-08 ustep: 1 
mgc: 2.620126e-14 
outer mgc:  0.001331001 
iter: 1  value: 225.1262 mgc: 0.005375061 ustep: 1 
iter: 2  value: 225.1262 mgc: 5.982739e-08 ustep: 1 
mgc: 2.353673e-14 
outer mgc:  0.001259598 
iter: 1  value: 225.1321 mgc: 0.05617036 ustep: 1 
iter: 2  value: 225.1321 mgc: 6.626482e-06 ustep: 1 
iter: 3  mgc: 9.85878e-14 
outer mgc:  0.08098197 
iter: 1  value: 225.113 mgc: 0.05632843 ustep: 1 
iter: 2  value: 225.113 mgc: 6.637039e-06 ustep: 1 
iter: 3  mgc: 9.681145e-14 
outer mgc:  0.08089834 
iter: 1  value: 225.1275 mgc: 0.05054549 ustep: 1 
iter: 2  value: 225.1275 mgc: 3.714008e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.09041471 
iter: 1  value: 225.1175 mgc: 0.05069804 ustep: 1 
iter: 2  value: 225.1175 mgc: 3.711095e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.09054422 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:43:30 2021]
Finished job 0.
1 of 1 steps (100%) done

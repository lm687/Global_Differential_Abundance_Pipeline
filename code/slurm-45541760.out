Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 01:52:00 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_0.8_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_80_3_0.8_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_0.8_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2214.802374 
final  value 2071.548605 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 311.3587 mgc: 104.1374 ustep: 1 
iter: 2  value: 243.6647 mgc: 37.64943 ustep: 1 
iter: 3  value: 219.2731 mgc: 44.23893 ustep: 1 
iter: 4  value: 219.145 mgc: 3.114279 ustep: 1 
iter: 5  value: 219.145 mgc: 0.0498977 ustep: 1 
iter: 6  value: 219.145 mgc: 1.397776e-05 ustep: 1 
iter: 7  mgc: 1.090517e-12 
iter: 1  mgc: 1.090517e-12 
Matching hessian patterns... Done
outer mgc:  101.0265 
iter: 1  value: 156.5351 mgc: 28.53103 ustep: 1 
iter: 2  value: 155.3087 mgc: 4.138449 ustep: 1 
iter: 3  value: 155.308 mgc: 0.113041 ustep: 1 
iter: 4  value: 155.308 mgc: 0.000123152 ustep: 1 
iter: 5  mgc: 1.775851e-10 
iter: 1  mgc: 1.775851e-10 
outer mgc:  9.886002 
iter: 1  value: 150.5988 mgc: 11.87243 ustep: 1 
iter: 2  value: 150.4509 mgc: 1.057342 ustep: 1 
iter: 3  value: 150.4509 mgc: 0.01273998 ustep: 1 
iter: 4  value: 150.4509 mgc: 2.923684e-06 ustep: 1 
iter: 5  mgc: 1.673106e-13 
iter: 1  mgc: 1.673106e-13 
outer mgc:  31.64634 
iter: 1  value: 132.5961 mgc: 29.22964 ustep: 1 
iter: 2  value: 132.3233 mgc: 1.363136 ustep: 1 
iter: 3  value: 132.3233 mgc: 0.01631057 ustep: 1 
iter: 4  value: 132.3233 mgc: 2.529549e-06 ustep: 1 
iter: 5  mgc: 6.117329e-14 
iter: 1  mgc: 6.117329e-14 
outer mgc:  8.711295 
iter: 1  value: 129.6139 mgc: 21.6236 ustep: 1 
iter: 2  value: 129.5919 mgc: 0.920508 ustep: 1 
iter: 3  value: 129.5919 mgc: 0.001192283 ustep: 1 
iter: 4  mgc: 2.634823e-09 
iter: 1  mgc: 2.634823e-09 
outer mgc:  40.14052 
iter: 1  value: 127.7024 mgc: 26.63424 ustep: 1 
iter: 2  value: 127.5983 mgc: 1.258328 ustep: 1 
iter: 3  value: 127.5983 mgc: 0.007004319 ustep: 1 
iter: 4  value: 127.5983 mgc: 1.628099e-07 ustep: 1 
mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  60.35973 
iter: 1  value: 119.5754 mgc: 14.03517 ustep: 1 
iter: 2  value: 119.5733 mgc: 0.1931629 ustep: 1 
iter: 3  value: 119.5733 mgc: 4.952078e-05 ustep: 1 
iter: 4  mgc: 1.456346e-11 
iter: 1  mgc: 1.456346e-11 
outer mgc:  10.63778 
iter: 1  value: 119.775 mgc: 4.091848 ustep: 1 
iter: 2  value: 119.7747 mgc: 0.07422127 ustep: 1 
iter: 3  value: 119.7747 mgc: 2.07314e-05 ustep: 1 
iter: 4  mgc: 2.208012e-12 
iter: 1  value: 119.0048 mgc: 2.989949 ustep: 1 
iter: 2  value: 119.0048 mgc: 0.02745633 ustep: 1 
iter: 3  value: 119.0048 mgc: 3.21294e-06 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  10.59391 
iter: 1  value: 117.9848 mgc: 4.932908 ustep: 1 
iter: 2  value: 117.9848 mgc: 0.03439564 ustep: 1 
iter: 3  value: 117.9848 mgc: 1.762723e-06 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  4.879039 
iter: 1  value: 117.1503 mgc: 2.463941 ustep: 1 
iter: 2  value: 117.1503 mgc: 0.02149376 ustep: 1 
iter: 3  value: 117.1503 mgc: 2.13561e-06 ustep: 1 
iter: 4  mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  4.233881 
iter: 1  value: 116.2615 mgc: 2.250006 ustep: 1 
iter: 2  value: 116.2615 mgc: 0.01526428 ustep: 1 
iter: 3  value: 116.2615 mgc: 7.560308e-07 ustep: 1 
iter: 4  mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  1.663277 
iter: 1  value: 115.7178 mgc: 2.591548 ustep: 1 
iter: 2  value: 115.7178 mgc: 0.0179836 ustep: 1 
iter: 3  value: 115.7178 mgc: 1.69869e-06 ustep: 1 
iter: 4  mgc: 1.465494e-14 
iter: 1  mgc: 1.465494e-14 
outer mgc:  1.227257 
iter: 1  value: 116.2813 mgc: 6.704443 ustep: 1 
iter: 2  value: 116.2813 mgc: 0.02724057 ustep: 1 
iter: 3  value: 116.2813 mgc: 2.530309e-06 ustep: 1 
iter: 4  mgc: 1.065814e-14 
iter: 1  value: 115.6791 mgc: 0.8410296 ustep: 1 
iter: 2  value: 115.6791 mgc: 0.0003799403 ustep: 1 
iter: 3  mgc: 5.801595e-10 
iter: 1  mgc: 5.801595e-10 
outer mgc:  2.043624 
iter: 1  value: 115.603 mgc: 0.7293668 ustep: 1 
iter: 2  value: 115.603 mgc: 0.00041342 ustep: 1 
iter: 3  mgc: 1.507638e-10 
iter: 1  mgc: 1.507638e-10 
outer mgc:  0.8944091 
iter: 1  value: 115.4715 mgc: 0.8139 ustep: 1 
iter: 2  value: 115.4715 mgc: 0.0005315864 ustep: 1 
iter: 3  mgc: 1.219123e-09 
iter: 1  mgc: 1.219123e-09 
outer mgc:  1.293694 
iter: 1  value: 115.2561 mgc: 0.5533535 ustep: 1 
iter: 2  value: 115.2561 mgc: 0.0001519431 ustep: 1 
iter: 3  mgc: 1.130793e-10 
iter: 1  value: 114.7568 mgc: 1.213814 ustep: 1 
iter: 2  value: 114.7568 mgc: 0.0004241709 ustep: 1 
iter: 3  mgc: 3.939276e-10 
iter: 1  value: 113.5663 mgc: 2.705687 ustep: 1 
iter: 2  value: 113.5663 mgc: 0.00240579 ustep: 1 
iter: 3  value: 113.5663 mgc: 2.111774e-08 ustep: 1 
mgc: 1.354472e-14 
iter: 1  mgc: 1.354472e-14 
outer mgc:  2.464716 
iter: 1  value: 112.5538 mgc: 3.516237 ustep: 1 
iter: 2  value: 112.5538 mgc: 0.006927059 ustep: 1 
iter: 3  value: 112.5538 mgc: 9.70148e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  3.248266 
iter: 1  value: 111.7308 mgc: 2.026767 ustep: 1 
iter: 2  value: 111.7308 mgc: 0.001913118 ustep: 1 
iter: 3  value: 111.7308 mgc: 1.537232e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  0.4673789 
iter: 1  value: 110.4945 mgc: 6.756211 ustep: 1 
iter: 2  value: 110.4945 mgc: 0.01244419 ustep: 1 
iter: 3  value: 110.4945 mgc: 2.706345e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  value: 111.3131 mgc: 1.794757 ustep: 1 
iter: 2  value: 111.3131 mgc: 0.00121556 ustep: 1 
iter: 3  mgc: 2.625533e-09 
iter: 1  mgc: 2.625533e-09 
outer mgc:  1.027649 
iter: 1  value: 110.9434 mgc: 1.020238 ustep: 1 
iter: 2  value: 110.9434 mgc: 0.0005529247 ustep: 1 
iter: 3  mgc: 4.154499e-10 
iter: 1  value: 110.5032 mgc: 0.9877027 ustep: 1 
iter: 2  value: 110.5032 mgc: 0.0007114371 ustep: 1 
iter: 3  mgc: 7.699859e-10 
iter: 1  mgc: 7.699859e-10 
outer mgc:  0.8772449 
iter: 1  value: 109.9276 mgc: 1.249077 ustep: 1 
iter: 2  value: 109.9276 mgc: 7.597425e-05 ustep: 1 
iter: 3  mgc: 3.037215e-11 
iter: 1  value: 109.0447 mgc: 2.022822 ustep: 1 
iter: 2  value: 109.0447 mgc: 0.0001520824 ustep: 1 
iter: 3  mgc: 9.983658e-11 
iter: 1  mgc: 9.983658e-11 
outer mgc:  0.6705527 
iter: 1  value: 107.9755 mgc: 2.9994 ustep: 1 
iter: 2  value: 107.9755 mgc: 0.0003376347 ustep: 1 
iter: 3  mgc: 3.266294e-10 
iter: 1  mgc: 3.266294e-10 
outer mgc:  0.5173016 
iter: 1  value: 106.8435 mgc: 2.765879 ustep: 1 
iter: 2  value: 106.8435 mgc: 0.0002200081 ustep: 1 
iter: 3  mgc: 1.488587e-10 
iter: 1  mgc: 1.488587e-10 
outer mgc:  0.05870318 
iter: 1  value: 105.1041 mgc: 4.30651 ustep: 1 
iter: 2  value: 105.1041 mgc: 0.0002798218 ustep: 1 
iter: 3  mgc: 2.640217e-10 
iter: 1  mgc: 2.640217e-10 
outer mgc:  0.1400257 
iter: 1  value: 103.6017 mgc: 3.843973 ustep: 1 
iter: 2  value: 103.6017 mgc: 8.945912e-05 ustep: 1 
iter: 3  mgc: 3.733902e-11 
iter: 1  mgc: 3.733902e-11 
outer mgc:  0.1491701 
iter: 1  value: 101.7867 mgc: 4.648752 ustep: 1 
iter: 2  value: 101.7867 mgc: 4.192907e-05 ustep: 1 
iter: 3  mgc: 7.553069e-12 
iter: 1  mgc: 7.553069e-12 
outer mgc:  0.1030701 
iter: 1  value: 100.2464 mgc: 4.155506 ustep: 1 
iter: 2  value: 100.2464 mgc: 3.028045e-05 ustep: 1 
iter: 3  mgc: 3.856471e-12 
iter: 1  mgc: 3.856471e-12 
outer mgc:  0.0511777 
iter: 1  value: 98.31308 mgc: 5.057282 ustep: 1 
iter: 2  value: 98.31308 mgc: 1.119607e-05 ustep: 1 
iter: 3  mgc: 8.348877e-13 
iter: 1  mgc: 8.348877e-13 
outer mgc:  0.06443162 
iter: 1  value: 96.68853 mgc: 4.774795 ustep: 1 
iter: 2  value: 96.68853 mgc: 7.128143e-06 ustep: 1 
iter: 3  mgc: 1.945111e-13 
iter: 1  mgc: 1.945111e-13 
outer mgc:  0.02152623 
iter: 1  value: 94.68263 mgc: 5.420798 ustep: 1 
iter: 2  value: 94.68263 mgc: 3.256294e-06 ustep: 1 
iter: 3  mgc: 7.052137e-13 
iter: 1  mgc: 7.052137e-13 
outer mgc:  0.01793209 
iter: 1  value: 93.00797 mgc: 5.604216 ustep: 1 
iter: 2  value: 93.00797 mgc: 2.589738e-06 ustep: 1 
iter: 3  mgc: 5.222489e-13 
iter: 1  mgc: 5.222489e-13 
outer mgc:  0.006957061 
iter: 1  value: 90.93645 mgc: 7.658389 ustep: 1 
iter: 2  value: 90.93645 mgc: 2.897173e-06 ustep: 1 
iter: 3  mgc: 9.334755e-13 
iter: 1  mgc: 9.334755e-13 
outer mgc:  0.01672898 
iter: 1  value: 89.2186 mgc: 7.935872 ustep: 1 
iter: 2  value: 89.2186 mgc: 1.519251e-06 ustep: 1 
iter: 3  mgc: 2.141842e-12 
iter: 1  mgc: 2.141842e-12 
outer mgc:  0.01394514 
iter: 1  value: 87.11584 mgc: 9.339275 ustep: 1 
iter: 2  value: 87.11584 mgc: 1.125494e-06 ustep: 1 
iter: 3  mgc: 2.234657e-12 
iter: 1  mgc: 2.234657e-12 
outer mgc:  0.01662407 
iter: 1  value: 85.37801 mgc: 7.682532 ustep: 1 
iter: 2  value: 85.37801 mgc: 3.170565e-07 ustep: 1 
iter: 3  mgc: 2.898126e-12 
iter: 1  mgc: 2.898126e-12 
outer mgc:  0.006704538 
iter: 1  value: 83.29055 mgc: 6.33214 ustep: 1 
iter: 2  value: 83.29055 mgc: 7.852233e-08 ustep: 1 
mgc: 5.578205e-12 
iter: 1  mgc: 5.578205e-12 
outer mgc:  0.006524808 
iter: 1  value: 81.56406 mgc: 5.388074 ustep: 1 
iter: 2  value: 81.56406 mgc: 2.79285e-08 ustep: 1 
mgc: 3.335998e-12 
iter: 1  mgc: 3.335998e-12 
outer mgc:  0.001536692 
iter: 1  value: 79.47144 mgc: 5.501929 ustep: 1 
iter: 2  mgc: 8.727133e-09 
iter: 1  mgc: 8.727133e-09 
outer mgc:  0.00201101 
iter: 1  value: 77.74173 mgc: 4.752743 ustep: 1 
iter: 2  mgc: 3.689354e-09 
iter: 1  mgc: 3.689354e-09 
outer mgc:  0.000384853 
iter: 1  value: 75.64691 mgc: 5.582278 ustep: 1 
iter: 2  mgc: 1.729562e-09 
iter: 1  mgc: 1.729562e-09 
outer mgc:  0.0006082311 
iter: 1  value: 73.91577 mgc: 4.546504 ustep: 1 
iter: 2  mgc: 6.279075e-10 
iter: 1  mgc: 6.279075e-10 
outer mgc:  9.058859e-05 
iter: 1  value: 71.81952 mgc: 5.66448 ustep: 1 
iter: 2  mgc: 3.554543e-10 
iter: 1  mgc: 3.554543e-10 
outer mgc:  0.0001972841 
iter: 1  value: 70.08742 mgc: 4.49034 ustep: 1 
iter: 2  mgc: 1.265246e-10 
iter: 1  mgc: 1.265246e-10 
outer mgc:  4.205284e-05 
iter: 1  value: 67.99055 mgc: 5.675642 ustep: 1 
iter: 2  mgc: 1.228089e-10 
iter: 1  mgc: 1.228089e-10 
outer mgc:  6.542777e-05 
iter: 1  value: 66.25805 mgc: 4.482369 ustep: 1 
iter: 2  mgc: 2.05302e-10 
iter: 1  mgc: 2.05302e-10 
outer mgc:  1.969327e-05 
iter: 1  value: 64.16085 mgc: 5.672936 ustep: 1 
iter: 2  mgc: 1.187446e-10 
iter: 1  mgc: 1.187446e-10 
outer mgc:  2.219292e-05 
iter: 1  value: 62.42814 mgc: 4.489005 ustep: 1 
iter: 2  mgc: 4.190459e-10 
iter: 1  mgc: 4.190459e-10 
outer mgc:  9.160294e-06 
iter: 1  value: 60.33089 mgc: 5.667153 ustep: 1 
iter: 2  mgc: 3.363543e-10 
iter: 1  mgc: 3.363543e-10 
outer mgc:  8.108386e-06 
iter: 1  value: 58.59813 mgc: 4.495621 ustep: 1 
iter: 2  mgc: 9.557479e-10 
iter: 1  mgc: 9.557479e-10 
outer mgc:  4.263838e-06 
iter: 1  mgc: 9.557479e-10 
iter: 1  mgc: 9.557479e-10 
outer mgc:  4.263838e-06 
iter: 1  value: 58.59959 mgc: 0.05076152 ustep: 1 
iter: 2  value: 58.59959 mgc: 1.487515e-06 ustep: 1 
iter: 3  mgc: 9.494308e-10 
outer mgc:  0.3984599 
iter: 1  value: 58.59708 mgc: 0.05075057 ustep: 1 
iter: 2  value: 58.59708 mgc: 1.487448e-06 ustep: 1 
iter: 3  mgc: 1.136979e-09 
outer mgc:  0.3984242 
iter: 1  value: 58.59878 mgc: 0.02889585 ustep: 1 
iter: 2  value: 58.59878 mgc: 4.6601e-07 ustep: 1 
iter: 3  mgc: 1.051689e-09 
outer mgc:  0.213724 
iter: 1  value: 58.5977 mgc: 0.0288903 ustep: 1 
iter: 2  value: 58.5977 mgc: 4.656464e-07 ustep: 1 
iter: 3  mgc: 4.111744e-10 
outer mgc:  0.2136947 
iter: 1  value: 58.59741 mgc: 0.03821968 ustep: 1 
iter: 2  value: 58.59741 mgc: 2.785525e-06 ustep: 1 
iter: 3  mgc: 1.037682e-09 
outer mgc:  0.2170774 
iter: 1  value: 58.59901 mgc: 0.0382008 ustep: 1 
iter: 2  value: 58.59901 mgc: 2.783898e-06 ustep: 1 
iter: 3  mgc: 7.124861e-10 
outer mgc:  0.2170691 
iter: 1  value: 58.59775 mgc: 0.01585307 ustep: 1 
iter: 2  value: 58.59775 mgc: 5.262465e-07 ustep: 1 
mgc: 7.956498e-10 
outer mgc:  0.09433818 
iter: 1  value: 58.59861 mgc: 0.01584295 ustep: 1 
iter: 2  value: 58.59861 mgc: 5.25719e-07 ustep: 1 
mgc: 1.014232e-09 
outer mgc:  0.09429242 
iter: 1  value: 58.59812 mgc: 2.81284e-05 ustep: 1 
mgc: 1.322119e-09 
outer mgc:  4.263783e-06 
iter: 1  value: 58.59815 mgc: 2.812523e-05 ustep: 1 
mgc: 6.952823e-10 
outer mgc:  4.263867e-06 
iter: 1  value: 58.60576 mgc: 4622.683 ustep: 1 
iter: 2  value: 58.60576 mgc: 1.381358e-06 ustep: 1 
iter: 3  mgc: 4.877809e-10 
outer mgc:  0.02443095 
iter: 1  value: 58.59053 mgc: 4636.572 ustep: 1 
iter: 2  value: 58.59053 mgc: 1.381492e-06 ustep: 1 
iter: 3  mgc: 1.173528e-09 
outer mgc:  0.02439831 
iter: 1  value: 58.60199 mgc: 4627.301 ustep: 1 
iter: 2  value: 58.60199 mgc: 2.441009e-06 ustep: 1 
iter: 3  mgc: 5.695666e-10 
outer mgc:  0.02964033 
iter: 1  value: 58.5943 mgc: 4631.931 ustep: 1 
iter: 2  value: 58.5943 mgc: 2.445865e-06 ustep: 1 
iter: 3  mgc: 5.129972e-10 
outer mgc:  0.02963094 
[Sat Aug 14 01:52:02 2021]
Finished job 0.
1 of 1 steps (100%) done

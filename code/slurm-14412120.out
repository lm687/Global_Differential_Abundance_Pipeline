Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:02:53 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2146.688412 
final  value 1999.645206 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 291.0625 mgc: 88.98716 ustep: 1 
iter: 2  value: 251.7957 mgc: 25.48553 ustep: 1 
iter: 3  value: 249.739 mgc: 9.879021 ustep: 1 
iter: 4  value: 249.7362 mgc: 0.3872965 ustep: 1 
iter: 5  value: 249.7362 mgc: 0.0008693808 ustep: 1 
iter: 6  mgc: 4.430659e-09 
iter: 1  mgc: 4.430659e-09 
Matching hessian patterns... Done
outer mgc:  71.32805 
iter: 1  value: 222.3471 mgc: 24.1752 ustep: 1 
iter: 2  value: 221.846 mgc: 1.997035 ustep: 1 
iter: 3  value: 221.8459 mgc: 0.04265224 ustep: 1 
iter: 4  value: 221.8459 mgc: 2.565352e-05 ustep: 1 
iter: 5  mgc: 9.315104e-12 
iter: 1  mgc: 9.315104e-12 
outer mgc:  39.90559 
iter: 1  value: 217.1185 mgc: 37.58919 ustep: 1 
iter: 2  value: 214.4834 mgc: 7.382926 ustep: 1 
iter: 3  value: 214.4803 mgc: 0.2602942 ustep: 1 
iter: 4  value: 214.4803 mgc: 0.0009406865 ustep: 1 
iter: 5  value: 214.4803 mgc: 1.243786e-08 ustep: 1 
mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  17.18993 
iter: 1  value: 214.8941 mgc: 24.83298 ustep: 1 
iter: 2  value: 205.4615 mgc: 8.560567 ustep: 1 
iter: 3  value: 205.4031 mgc: 0.6979053 ustep: 1 
iter: 4  value: 205.4031 mgc: 0.01101209 ustep: 1 
iter: 5  value: 205.4031 mgc: 4.318992e-06 ustep: 1 
iter: 6  mgc: 6.628031e-13 
iter: 1  mgc: 6.628031e-13 
outer mgc:  12.29797 
iter: 1  value: 194.977 mgc: 24.61135 ustep: 1 
iter: 2  value: 194.6601 mgc: 2.415345 ustep: 1 
iter: 3  value: 194.66 mgc: 0.0308056 ustep: 1 
iter: 4  value: 194.66 mgc: 1.126134e-05 ustep: 1 
iter: 5  mgc: 1.511125e-12 
iter: 1  mgc: 1.511125e-12 
outer mgc:  5.52917 
iter: 1  value: 196.3488 mgc: 32.61537 ustep: 1 
iter: 2  value: 195.94 mgc: 3.740893 ustep: 1 
iter: 3  value: 195.94 mgc: 0.02865275 ustep: 1 
iter: 4  value: 195.94 mgc: 6.019029e-06 ustep: 1 
iter: 5  mgc: 3.395062e-13 
iter: 1  value: 192.0825 mgc: 12.64984 ustep: 1 
iter: 2  value: 192.0731 mgc: 0.4959571 ustep: 1 
iter: 3  value: 192.0731 mgc: 0.000804901 ustep: 1 
iter: 4  mgc: 6.750658e-09 
iter: 1  mgc: 6.750658e-09 
outer mgc:  7.489483 
iter: 1  value: 195.604 mgc: 17.99827 ustep: 1 
iter: 2  value: 195.5737 mgc: 0.9245739 ustep: 1 
iter: 3  value: 195.5737 mgc: 0.002473921 ustep: 1 
iter: 4  value: 195.5737 mgc: 1.986585e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  value: 191.6302 mgc: 4.31416 ustep: 1 
iter: 2  value: 191.6301 mgc: 0.0528131 ustep: 1 
iter: 3  value: 191.6301 mgc: 1.374343e-05 ustep: 1 
iter: 4  mgc: 1.434297e-12 
iter: 1  mgc: 1.434297e-12 
outer mgc:  4.311878 
iter: 1  value: 191.1207 mgc: 3.097102 ustep: 1 
iter: 2  value: 191.1205 mgc: 0.04693995 ustep: 1 
iter: 3  value: 191.1205 mgc: 1.969694e-05 ustep: 1 
iter: 4  mgc: 4.576062e-12 
iter: 1  mgc: 4.576062e-12 
outer mgc:  3.766099 
iter: 1  value: 190.252 mgc: 6.051079 ustep: 1 
iter: 2  value: 190.2511 mgc: 0.1103827 ustep: 1 
iter: 3  value: 190.2511 mgc: 7.024539e-05 ustep: 1 
iter: 4  mgc: 6.687961e-11 
iter: 1  mgc: 6.687961e-11 
outer mgc:  3.428583 
iter: 1  value: 189.8856 mgc: 6.661663 ustep: 1 
iter: 2  value: 189.8826 mgc: 0.1822739 ustep: 1 
iter: 3  value: 189.8826 mgc: 0.0002447661 ustep: 1 
iter: 4  mgc: 5.560143e-10 
iter: 1  mgc: 5.560143e-10 
outer mgc:  6.175262 
iter: 1  value: 189.3402 mgc: 5.468275 ustep: 1 
iter: 2  value: 189.3399 mgc: 0.08798382 ustep: 1 
iter: 3  value: 189.3399 mgc: 3.499248e-05 ustep: 1 
iter: 4  mgc: 5.385026e-12 
iter: 1  mgc: 5.385026e-12 
outer mgc:  4.116608 
iter: 1  value: 191.1889 mgc: 7.337733 ustep: 1 
iter: 2  value: 191.1858 mgc: 0.2271907 ustep: 1 
iter: 3  value: 191.1858 mgc: 0.0003411199 ustep: 1 
iter: 4  mgc: 9.525656e-10 
iter: 1  value: 189.2564 mgc: 1.397195 ustep: 1 
iter: 2  value: 189.2564 mgc: 0.006559755 ustep: 1 
iter: 3  value: 189.2564 mgc: 2.811493e-07 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  1.252386 
iter: 1  value: 189.1908 mgc: 1.335881 ustep: 1 
iter: 2  value: 189.1908 mgc: 0.003078676 ustep: 1 
iter: 3  value: 189.1908 mgc: 5.728895e-08 ustep: 1 
mgc: 2.731149e-14 
iter: 1  mgc: 2.731149e-14 
outer mgc:  1.389377 
iter: 1  value: 189.1329 mgc: 0.5973684 ustep: 1 
iter: 2  value: 189.1329 mgc: 0.002086815 ustep: 1 
iter: 3  value: 189.1329 mgc: 3.8194e-08 ustep: 1 
mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.951172 
iter: 1  value: 189.0228 mgc: 0.9632517 ustep: 1 
iter: 2  value: 189.0228 mgc: 0.001978353 ustep: 1 
iter: 3  value: 189.0228 mgc: 3.568637e-08 ustep: 1 
mgc: 2.209344e-14 
iter: 1  value: 188.9049 mgc: 0.7014422 ustep: 1 
iter: 2  value: 188.9049 mgc: 0.006044677 ustep: 1 
iter: 3  value: 188.9049 mgc: 2.904364e-07 ustep: 1 
iter: 4  mgc: 1.44329e-14 
iter: 1  mgc: 1.44329e-14 
outer mgc:  0.8302355 
iter: 1  value: 188.8521 mgc: 2.366177 ustep: 1 
iter: 2  value: 188.8521 mgc: 0.01487794 ustep: 1 
iter: 3  value: 188.8521 mgc: 3.754917e-06 ustep: 1 
iter: 4  mgc: 2.211564e-13 
iter: 1  mgc: 2.211564e-13 
outer mgc:  1.935634 
iter: 1  value: 188.6128 mgc: 3.164893 ustep: 1 
iter: 2  value: 188.6126 mgc: 0.07022813 ustep: 1 
iter: 3  value: 188.6126 mgc: 1.134784e-05 ustep: 1 
iter: 4  mgc: 1.035616e-12 
iter: 1  mgc: 1.035616e-12 
outer mgc:  2.235277 
iter: 1  value: 188.2989 mgc: 2.701174 ustep: 1 
iter: 2  value: 188.2988 mgc: 0.05638039 ustep: 1 
iter: 3  value: 188.2988 mgc: 4.014004e-05 ustep: 1 
iter: 4  mgc: 1.85616e-11 
iter: 1  value: 188.457 mgc: 0.7440218 ustep: 1 
iter: 2  value: 188.457 mgc: 0.00890848 ustep: 1 
iter: 3  value: 188.457 mgc: 1.104484e-06 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  1.253987 
iter: 1  value: 188.5315 mgc: 0.5881235 ustep: 1 
iter: 2  value: 188.5315 mgc: 0.002756422 ustep: 1 
iter: 3  value: 188.5315 mgc: 7.276926e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.8504489 
iter: 1  value: 188.4559 mgc: 0.7719658 ustep: 1 
iter: 2  value: 188.4559 mgc: 0.004478271 ustep: 1 
iter: 3  value: 188.4559 mgc: 6.580186e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.4884149 
iter: 1  value: 188.4342 mgc: 0.3449678 ustep: 1 
iter: 2  value: 188.4342 mgc: 0.0008622747 ustep: 1 
iter: 3  mgc: 2.677919e-09 
iter: 1  mgc: 2.677919e-09 
outer mgc:  0.06271986 
iter: 1  value: 188.4292 mgc: 0.0939096 ustep: 1 
iter: 2  value: 188.4292 mgc: 3.118153e-05 ustep: 1 
iter: 3  mgc: 3.893552e-12 
iter: 1  mgc: 3.893552e-12 
outer mgc:  0.02507061 
iter: 1  value: 188.429 mgc: 0.03005787 ustep: 1 
iter: 2  value: 188.429 mgc: 2.937566e-06 ustep: 1 
iter: 3  mgc: 1.176836e-13 
iter: 1  mgc: 1.176836e-13 
outer mgc:  0.00124693 
iter: 1  value: 188.4287 mgc: 0.002609808 ustep: 1 
iter: 2  value: 188.4287 mgc: 1.590123e-08 ustep: 1 
mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.0004901292 
iter: 1  value: 188.4287 mgc: 0.0004210716 ustep: 1 
iter: 2  mgc: 4.444614e-10 
iter: 1  mgc: 4.444614e-10 
outer mgc:  2.797173e-05 
iter: 1  mgc: 4.444614e-10 
iter: 1  mgc: 4.444614e-10 
outer mgc:  2.797173e-05 
iter: 1  value: 188.4293 mgc: 0.05243916 ustep: 1 
iter: 2  value: 188.4293 mgc: 6.011084e-06 ustep: 1 
iter: 3  mgc: 1.558753e-13 
outer mgc:  0.08104491 
iter: 1  value: 188.4282 mgc: 0.05243601 ustep: 1 
iter: 2  value: 188.4282 mgc: 6.017874e-06 ustep: 1 
iter: 3  mgc: 1.49214e-13 
outer mgc:  0.08105764 
iter: 1  value: 188.429 mgc: 0.02650465 ustep: 1 
iter: 2  value: 188.429 mgc: 2.017901e-06 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.1347866 
iter: 1  value: 188.4285 mgc: 0.0264996 ustep: 1 
iter: 2  value: 188.4285 mgc: 2.018451e-06 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.1347723 
iter: 1  value: 188.4283 mgc: 0.03803649 ustep: 1 
iter: 2  value: 188.4283 mgc: 6.370622e-06 ustep: 1 
iter: 3  mgc: 1.900702e-13 
outer mgc:  0.06374153 
iter: 1  value: 188.4292 mgc: 0.03801835 ustep: 1 
iter: 2  value: 188.4292 mgc: 6.37662e-06 ustep: 1 
iter: 3  mgc: 1.874056e-13 
outer mgc:  0.06372864 
iter: 1  value: 188.4286 mgc: 0.0209821 ustep: 1 
iter: 2  value: 188.4286 mgc: 1.909772e-06 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.08712334 
iter: 1  value: 188.4289 mgc: 0.02097415 ustep: 1 
iter: 2  value: 188.4289 mgc: 1.909533e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.08717204 
iter: 1  value: 188.4276 mgc: 0.003182551 ustep: 1 
iter: 2  value: 188.4276 mgc: 5.391224e-08 ustep: 1 
mgc: 1.287859e-14 
outer mgc:  0.002277616 
iter: 1  value: 188.4298 mgc: 0.003181197 ustep: 1 
iter: 2  value: 188.4298 mgc: 5.391137e-08 ustep: 1 
mgc: 2.087219e-14 
outer mgc:  0.002260074 
iter: 1  value: 188.43 mgc: 0.01419995 ustep: 1 
iter: 2  value: 188.43 mgc: 1.340408e-06 ustep: 1 
iter: 3  mgc: 1.998401e-14 
outer mgc:  0.05133787 
iter: 1  value: 188.4274 mgc: 0.01423289 ustep: 1 
iter: 2  value: 188.4274 mgc: 1.341348e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.05144202 
iter: 1  value: 188.4309 mgc: 0.0178433 ustep: 1 
iter: 2  value: 188.4309 mgc: 3.493197e-06 ustep: 1 
iter: 3  mgc: 1.714184e-13 
outer mgc:  0.04614663 
iter: 1  value: 188.4266 mgc: 0.01789071 ustep: 1 
iter: 2  value: 188.4266 mgc: 3.50256e-06 ustep: 1 
iter: 3  mgc: 1.656453e-13 
outer mgc:  0.04617499 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:02:55 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:43:21 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4370.279684 
final  value 4097.953630 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2138.661 mgc: 79.26163 ustep: 1 
iter: 2  value: 1133.132 mgc: 62.58501 ustep: 0.1336527 
iter: 3  value: 839.5215 mgc: 96.62663 ustep: 0.3656489 
iter: 4  value: 833.407 mgc: 47.30483 ustep: 0.6047286 
iter: 5  value: 785.7931 mgc: 64.32324 ustep: 0.7776652 
iter: 6  value: 785.0994 mgc: 6.949019 ustep: 0.8818651 
iter: 7  value: 785.099 mgc: 0.1859844 ustep: 0.9390828 
iter: 8  value: 785.099 mgc: 0.0004240734 ustep: 0.969066 
iter: 9  value: 785.099 mgc: 3.254593e-07 ustep: 0.984413 
iter: 10  mgc: 3.069854e-10 
iter: 1  mgc: 3.069854e-10 
Matching hessian patterns... Done
outer mgc:  371.3689 
iter: 1  value: 463.1697 mgc: 34.03803 ustep: 1 
iter: 2  value: 458.2244 mgc: 6.356094 ustep: 1 
iter: 3  value: 458.2171 mgc: 0.3711686 ustep: 1 
iter: 4  value: 458.2171 mgc: 0.002053786 ustep: 1 
iter: 5  value: 458.2171 mgc: 6.402234e-08 ustep: 1 
mgc: 3.948231e-14 
iter: 1  mgc: 3.948231e-14 
outer mgc:  161.422 
iter: 1  value: 374.0003 mgc: 11.64827 ustep: 1 
iter: 2  value: 373.9545 mgc: 0.6304514 ustep: 1 
iter: 3  value: 373.9545 mgc: 0.006527741 ustep: 1 
iter: 4  value: 373.9545 mgc: 2.110239e-06 ustep: 1 
iter: 5  mgc: 2.384759e-13 
iter: 1  mgc: 2.384759e-13 
outer mgc:  10.74865 
iter: 1  value: 384.5117 mgc: 24.47127 ustep: 1 
iter: 2  value: 383.3655 mgc: 2.808603 ustep: 1 
iter: 3  value: 383.365 mgc: 0.08531953 ustep: 1 
iter: 4  value: 383.365 mgc: 0.0001179747 ustep: 1 
iter: 5  mgc: 2.266056e-10 
iter: 1  value: 370.7644 mgc: 6.903126 ustep: 1 
iter: 2  value: 370.7603 mgc: 0.1744662 ustep: 1 
iter: 3  value: 370.7603 mgc: 0.0003660228 ustep: 1 
iter: 4  mgc: 2.234586e-09 
iter: 1  mgc: 2.234586e-09 
outer mgc:  16.87158 
iter: 1  value: 368.3432 mgc: 16.57757 ustep: 1 
iter: 2  value: 368.2321 mgc: 1.115024 ustep: 1 
iter: 3  value: 368.232 mgc: 0.009008859 ustep: 1 
iter: 4  value: 368.232 mgc: 1.289642e-06 ustep: 1 
iter: 5  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  21.0607 
iter: 1  value: 364.1391 mgc: 4.33575 ustep: 1 
iter: 2  value: 364.1375 mgc: 0.1254982 ustep: 1 
iter: 3  value: 364.1375 mgc: 0.0002219358 ustep: 1 
iter: 4  mgc: 6.992327e-10 
iter: 1  mgc: 6.992327e-10 
outer mgc:  12.11444 
iter: 1  value: 361.6274 mgc: 15.73411 ustep: 1 
iter: 2  value: 361.4593 mgc: 1.17537 ustep: 1 
iter: 3  value: 361.4593 mgc: 0.01370866 ustep: 1 
iter: 4  value: 361.4593 mgc: 2.649722e-06 ustep: 1 
iter: 5  mgc: 9.992007e-14 
iter: 1  mgc: 9.992007e-14 
outer mgc:  9.480861 
iter: 1  value: 359.044 mgc: 9.77596 ustep: 1 
iter: 2  value: 359.0202 mgc: 0.4081571 ustep: 1 
iter: 3  value: 359.0202 mgc: 0.001383752 ustep: 1 
iter: 4  value: 359.0202 mgc: 3.588832e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  6.264897 
iter: 1  value: 357.3563 mgc: 6.579753 ustep: 1 
iter: 2  value: 357.3474 mgc: 0.1956977 ustep: 1 
iter: 3  value: 357.3474 mgc: 0.0007711896 ustep: 1 
iter: 4  value: 357.3474 mgc: 1.674875e-08 ustep: 1 
mgc: 2.076117e-14 
iter: 1  mgc: 2.076117e-14 
outer mgc:  9.366446 
iter: 1  value: 357.2281 mgc: 6.492252 ustep: 1 
iter: 2  value: 357.2231 mgc: 0.2414996 ustep: 1 
iter: 3  value: 357.2231 mgc: 0.0004862644 ustep: 1 
iter: 4  mgc: 4.018728e-09 
iter: 1  mgc: 4.018728e-09 
outer mgc:  12.76778 
iter: 1  value: 356.9333 mgc: 8.189784 ustep: 1 
iter: 2  value: 356.9194 mgc: 0.4162834 ustep: 1 
iter: 3  value: 356.9194 mgc: 0.001877027 ustep: 1 
iter: 4  value: 356.9194 mgc: 3.838541e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  9.589219 
iter: 1  value: 356.8437 mgc: 4.519445 ustep: 1 
iter: 2  value: 356.8427 mgc: 0.08628373 ustep: 1 
iter: 3  value: 356.8427 mgc: 0.0001735596 ustep: 1 
iter: 4  mgc: 1.004548e-09 
iter: 1  value: 356.4041 mgc: 3.378948 ustep: 1 
iter: 2  value: 356.4039 mgc: 0.03969538 ustep: 1 
iter: 3  value: 356.4039 mgc: 1.288319e-05 ustep: 1 
iter: 4  mgc: 1.742828e-12 
iter: 1  mgc: 1.742828e-12 
outer mgc:  4.268906 
iter: 1  value: 356.3139 mgc: 1.593707 ustep: 1 
iter: 2  value: 356.3138 mgc: 0.01793444 ustep: 1 
iter: 3  value: 356.3138 mgc: 1.002274e-05 ustep: 1 
iter: 4  mgc: 3.077538e-12 
iter: 1  value: 356.3003 mgc: 1.90292 ustep: 1 
iter: 2  value: 356.3003 mgc: 0.008955034 ustep: 1 
iter: 3  value: 356.3003 mgc: 5.216635e-07 ustep: 1 
iter: 4  mgc: 1.709743e-14 
iter: 1  mgc: 1.709743e-14 
outer mgc:  5.160688 
iter: 1  value: 356.2369 mgc: 2.559 ustep: 1 
iter: 2  value: 356.2368 mgc: 0.01652121 ustep: 1 
iter: 3  value: 356.2368 mgc: 2.853232e-06 ustep: 1 
iter: 4  mgc: 2.615685e-13 
iter: 1  mgc: 2.615685e-13 
outer mgc:  1.645233 
iter: 1  value: 356.1869 mgc: 2.360332 ustep: 1 
iter: 2  value: 356.1868 mgc: 0.01894498 ustep: 1 
iter: 3  value: 356.1868 mgc: 3.152637e-06 ustep: 1 
iter: 4  mgc: 1.751932e-13 
iter: 1  mgc: 1.751932e-13 
outer mgc:  1.625884 
iter: 1  value: 356.1436 mgc: 0.7597543 ustep: 1 
iter: 2  value: 356.1436 mgc: 0.002266356 ustep: 1 
iter: 3  value: 356.1436 mgc: 6.292611e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  value: 356.1645 mgc: 0.1988822 ustep: 1 
iter: 2  value: 356.1645 mgc: 0.0001902726 ustep: 1 
iter: 3  mgc: 3.991367e-10 
iter: 1  mgc: 3.991367e-10 
outer mgc:  0.8960493 
iter: 1  value: 356.1573 mgc: 0.4941088 ustep: 1 
iter: 2  value: 356.1573 mgc: 0.0005444566 ustep: 1 
iter: 3  mgc: 3.275022e-09 
iter: 1  mgc: 3.275022e-09 
outer mgc:  0.4272493 
iter: 1  value: 356.1783 mgc: 0.2464064 ustep: 1 
iter: 2  value: 356.1783 mgc: 0.0001895058 ustep: 1 
iter: 3  mgc: 2.447514e-10 
iter: 1  value: 356.1614 mgc: 0.03095626 ustep: 1 
iter: 2  value: 356.1614 mgc: 8.520122e-06 ustep: 1 
iter: 3  mgc: 2.180256e-12 
iter: 1  mgc: 2.180256e-12 
outer mgc:  0.03632671 
iter: 1  value: 356.1606 mgc: 0.04538728 ustep: 1 
iter: 2  value: 356.1606 mgc: 7.208563e-06 ustep: 1 
iter: 3  mgc: 5.586642e-13 
iter: 1  mgc: 5.586642e-13 
outer mgc:  0.05550855 
iter: 1  value: 356.1624 mgc: 0.08031675 ustep: 1 
iter: 2  value: 356.1624 mgc: 2.258344e-05 ustep: 1 
iter: 3  mgc: 3.879785e-12 
iter: 1  value: 356.1614 mgc: 0.03163141 ustep: 1 
iter: 2  value: 356.1614 mgc: 3.135308e-06 ustep: 1 
iter: 3  mgc: 8.415491e-14 
iter: 1  mgc: 8.415491e-14 
outer mgc:  0.03077646 
iter: 1  value: 356.1604 mgc: 0.007324439 ustep: 1 
iter: 2  value: 356.1604 mgc: 2.436229e-07 ustep: 1 
iter: 3  mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  0.01226892 
iter: 1  value: 356.1611 mgc: 0.01222758 ustep: 1 
iter: 2  value: 356.1611 mgc: 5.390369e-07 ustep: 1 
iter: 3  mgc: 3.219647e-14 
iter: 1  mgc: 3.219647e-14 
outer mgc:  0.01034141 
iter: 1  value: 356.1609 mgc: 0.01418797 ustep: 1 
iter: 2  value: 356.1609 mgc: 6.480422e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  0.003896332 
iter: 1  value: 356.1608 mgc: 0.01004923 ustep: 1 
iter: 2  value: 356.1608 mgc: 3.834553e-07 ustep: 1 
iter: 3  mgc: 2.198242e-14 
iter: 1  mgc: 2.198242e-14 
outer mgc:  0.002603456 
iter: 1  value: 356.1606 mgc: 0.006292528 ustep: 1 
iter: 2  value: 356.1606 mgc: 1.323025e-07 ustep: 1 
iter: 3  mgc: 3.042011e-14 
iter: 1  value: 356.1607 mgc: 0.002796688 ustep: 1 
iter: 2  value: 356.1607 mgc: 2.352941e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.002830914 
iter: 1  value: 356.1608 mgc: 0.002433734 ustep: 1 
iter: 2  value: 356.1608 mgc: 2.903578e-08 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.00177418 
iter: 1  value: 356.1608 mgc: 0.0001982088 ustep: 1 
iter: 2  mgc: 5.870513e-10 
iter: 1  mgc: 5.870513e-10 
outer mgc:  0.0007547132 
iter: 1  mgc: 5.870513e-10 
iter: 1  mgc: 5.870513e-10 
outer mgc:  0.0007547132 
iter: 1  value: 356.1606 mgc: 0.0513166 ustep: 1 
iter: 2  value: 356.1606 mgc: 8.461157e-06 ustep: 1 
iter: 3  mgc: 6.583623e-13 
outer mgc:  0.04546377 
iter: 1  value: 356.161 mgc: 0.05130814 ustep: 1 
iter: 2  value: 356.161 mgc: 8.471477e-06 ustep: 1 
iter: 3  mgc: 6.576961e-13 
outer mgc:  0.04528886 
iter: 1  value: 356.1605 mgc: 0.02484502 ustep: 1 
iter: 2  value: 356.1605 mgc: 2.394645e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.1689488 
iter: 1  value: 356.1613 mgc: 0.02483927 ustep: 1 
iter: 2  value: 356.1613 mgc: 2.395114e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.1674166 
iter: 1  value: 356.161 mgc: 0.04679427 ustep: 1 
iter: 2  value: 356.161 mgc: 7.175182e-06 ustep: 1 
iter: 3  mgc: 4.352074e-13 
outer mgc:  0.04894699 
iter: 1  value: 356.1607 mgc: 0.04679346 ustep: 1 
iter: 2  value: 356.1607 mgc: 7.182605e-06 ustep: 1 
iter: 3  mgc: 4.396483e-13 
outer mgc:  0.04900903 
iter: 1  value: 356.1621 mgc: 0.02724936 ustep: 1 
iter: 2  value: 356.1621 mgc: 3.433771e-06 ustep: 1 
iter: 3  mgc: 1.474376e-13 
outer mgc:  0.1971752 
iter: 1  value: 356.1596 mgc: 0.02724948 ustep: 1 
iter: 2  value: 356.1596 mgc: 3.435126e-06 ustep: 1 
iter: 3  mgc: 1.509903e-13 
outer mgc:  0.1981032 
iter: 1  value: 356.1596 mgc: 0.003878091 ustep: 1 
iter: 2  value: 356.1596 mgc: 3.641818e-07 ustep: 1 
iter: 3  mgc: 1.931788e-14 
outer mgc:  0.01066101 
iter: 1  value: 356.162 mgc: 0.003875183 ustep: 1 
iter: 2  value: 356.162 mgc: 3.637947e-07 ustep: 1 
iter: 3  mgc: 3.352874e-14 
outer mgc:  0.01069238 
iter: 1  value: 356.1627 mgc: 0.008639378 ustep: 1 
iter: 2  value: 356.1627 mgc: 2.377696e-06 ustep: 1 
iter: 3  mgc: 1.803002e-13 
outer mgc:  0.05070769 
iter: 1  value: 356.159 mgc: 0.008657595 ustep: 1 
iter: 2  value: 356.159 mgc: 2.384434e-06 ustep: 1 
iter: 3  mgc: 1.820766e-13 
outer mgc:  0.05101586 
iter: 1  value: 356.1622 mgc: 0.00769298 ustep: 1 
iter: 2  value: 356.1622 mgc: 7.495315e-07 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.05521216 
iter: 1  value: 356.1594 mgc: 0.007708979 ustep: 1 
iter: 2  value: 356.1594 mgc: 7.520622e-07 ustep: 1 
iter: 3  mgc: 2.597922e-14 
outer mgc:  0.05498618 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:43:23 2021]
Finished job 0.
1 of 1 steps (100%) done

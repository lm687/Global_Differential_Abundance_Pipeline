Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:06:37 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.005_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.005_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_80_3_0.005_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.005_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.005_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.005_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.005_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.005_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11105.871626 
iter  10 value 9577.649021
iter  10 value 9577.649008
final  value 9577.649008 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5680.925 mgc: 101.0715 ustep: 0.2494656 
iter: 2  value: 4159.988 mgc: 78.34881 ustep: 0.1588666 
iter: 3  value: 4123.052 mgc: 144.8901 ustep: 0.2245041 
iter: 4  value: 3472.389 mgc: 85.56963 ustep: 0.1482958 
iter: 5  value: 1937.11 mgc: 158.0018 ustep: 0.05896806 
iter: 6  value: 1669.799 mgc: 73.32075 ustep: 0.06718961 
iter: 7  value: 1650.215 mgc: 38.14813 ustep: 0.2592837 
iter: 8  value: 1649.803 mgc: 3.689039 ustep: 0.5092481 
iter: 9  value: 1649.8 mgc: 0.1951472 ustep: 0.7136449 
iter: 10  value: 1649.8 mgc: 0.006498851 ustep: 0.8447906 
iter: 11  value: 1649.8 mgc: 0.0001516727 ustep: 0.919133 
iter: 12  value: 1649.8 mgc: 2.270042e-06 ustep: 0.9587184 
iter: 13  value: 1649.8 mgc: 1.675423e-08 ustep: 0.9791437 
mgc: 6.139156e-11 
iter: 1  mgc: 6.139156e-11 
Matching hessian patterns... Done
outer mgc:  689.3529 
iter: 1  value: 1146.749 mgc: 21.20053 ustep: 1 
iter: 2  value: 1099.477 mgc: 9.227404 ustep: 1 
iter: 3  value: 1099.064 mgc: 0.9339788 ustep: 1 
iter: 4  value: 1099.064 mgc: 0.01745921 ustep: 1 
iter: 5  value: 1099.064 mgc: 8.553534e-06 ustep: 1 
iter: 6  mgc: 2.093548e-12 
iter: 1  mgc: 2.093548e-12 
outer mgc:  390.7896 
iter: 1  value: 819.5945 mgc: 11.8602 ustep: 1 
iter: 2  value: 816.4025 mgc: 2.517946 ustep: 1 
iter: 3  value: 816.3988 mgc: 0.1499188 ustep: 1 
iter: 4  value: 816.3988 mgc: 0.0006378384 ustep: 1 
iter: 5  value: 816.3988 mgc: 1.169129e-08 ustep: 1 
mgc: 3.325812e-14 
iter: 1  mgc: 3.325812e-14 
outer mgc:  147.522 
iter: 1  value: 724.6422 mgc: 18.51694 ustep: 1 
iter: 2  value: 724.3264 mgc: 1.76372 ustep: 1 
iter: 3  value: 724.3263 mgc: 0.03490151 ustep: 1 
iter: 4  value: 724.3263 mgc: 1.503351e-05 ustep: 1 
iter: 5  mgc: 2.795097e-12 
iter: 1  mgc: 2.795097e-12 
outer mgc:  125.0266 
iter: 1  value: 827.2683 mgc: 22.63491 ustep: 1 
iter: 2  value: 827.1278 mgc: 1.346598 ustep: 1 
iter: 3  value: 827.1277 mgc: 0.01745384 ustep: 1 
iter: 4  value: 827.1277 mgc: 3.092197e-06 ustep: 1 
iter: 5  mgc: 1.04361e-13 
iter: 1  value: 703.7405 mgc: 7.07803 ustep: 1 
iter: 2  value: 703.7373 mgc: 0.1655963 ustep: 1 
iter: 3  value: 703.7373 mgc: 0.0002968843 ustep: 1 
iter: 4  mgc: 1.043021e-09 
iter: 1  mgc: 1.043021e-09 
outer mgc:  37.1719 
iter: 1  value: 690.6637 mgc: 6.871598 ustep: 1 
iter: 2  value: 690.657 mgc: 0.2231329 ustep: 1 
iter: 3  value: 690.657 mgc: 0.0005674152 ustep: 1 
iter: 4  mgc: 3.706781e-09 
iter: 1  mgc: 3.706781e-09 
outer mgc:  48.44738 
iter: 1  value: 671.3035 mgc: 5.346224 ustep: 1 
iter: 2  value: 671.2326 mgc: 0.314943 ustep: 1 
iter: 3  value: 671.2326 mgc: 0.003753376 ustep: 1 
iter: 4  value: 671.2326 mgc: 5.487292e-07 ustep: 1 
iter: 5  mgc: 3.474998e-14 
iter: 1  mgc: 3.474998e-14 
outer mgc:  83.89758 
iter: 1  value: 655.7545 mgc: 22.08931 ustep: 1 
iter: 2  value: 655.1706 mgc: 1.686657 ustep: 1 
iter: 3  value: 655.1706 mgc: 0.01620464 ustep: 1 
iter: 4  value: 655.1706 mgc: 4.086878e-06 ustep: 1 
iter: 5  mgc: 3.339551e-13 
iter: 1  mgc: 3.339551e-13 
outer mgc:  87.44909 
iter: 1  value: 631.2067 mgc: 12.47805 ustep: 1 
iter: 2  value: 629.8677 mgc: 1.629494 ustep: 1 
iter: 3  value: 629.8675 mgc: 0.02032824 ustep: 1 
iter: 4  value: 629.8675 mgc: 3.890222e-06 ustep: 1 
iter: 5  mgc: 1.458833e-13 
iter: 1  mgc: 1.458833e-13 
outer mgc:  33.81236 
iter: 1  value: 612.3617 mgc: 15.91559 ustep: 1 
iter: 2  value: 612.2321 mgc: 0.7475282 ustep: 1 
iter: 3  value: 612.2321 mgc: 0.004233861 ustep: 1 
iter: 4  value: 612.2321 mgc: 1.370095e-07 ustep: 1 
mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  46.49584 
iter: 1  value: 606.054 mgc: 11.2512 ustep: 1 
iter: 2  value: 605.9764 mgc: 0.9550243 ustep: 1 
iter: 3  value: 605.9764 mgc: 0.005554724 ustep: 1 
iter: 4  value: 605.9764 mgc: 1.78509e-07 ustep: 1 
mgc: 2.58682e-14 
iter: 1  value: 607.5264 mgc: 3.330088 ustep: 1 
iter: 2  value: 607.5251 mgc: 0.0761578 ustep: 1 
iter: 3  value: 607.5251 mgc: 5.910826e-05 ustep: 1 
iter: 4  mgc: 3.694733e-11 
iter: 1  mgc: 3.694733e-11 
outer mgc:  72.03905 
iter: 1  value: 603.6499 mgc: 7.368506 ustep: 1 
iter: 2  value: 603.6479 mgc: 0.1669215 ustep: 1 
iter: 3  value: 603.6479 mgc: 0.0002118801 ustep: 1 
iter: 4  mgc: 3.16545e-10 
iter: 1  mgc: 3.16545e-10 
outer mgc:  63.41606 
iter: 1  value: 598.3883 mgc: 12.0764 ustep: 1 
iter: 2  value: 598.3734 mgc: 0.3600805 ustep: 1 
iter: 3  value: 598.3734 mgc: 0.000844443 ustep: 1 
iter: 4  mgc: 4.499375e-09 
iter: 1  mgc: 4.499375e-09 
outer mgc:  61.0002 
iter: 1  value: 591.2177 mgc: 5.921059 ustep: 1 
iter: 2  value: 591.2166 mgc: 0.1142296 ustep: 1 
iter: 3  value: 591.2166 mgc: 7.30202e-05 ustep: 1 
iter: 4  mgc: 2.764544e-11 
iter: 1  mgc: 2.764544e-11 
outer mgc:  31.52101 
iter: 1  value: 605.6888 mgc: 6.554128 ustep: 1 
iter: 2  value: 605.6883 mgc: 0.05970803 ustep: 1 
iter: 3  value: 605.6883 mgc: 1.004507e-05 ustep: 1 
iter: 4  mgc: 8.668621e-13 
iter: 1  value: 590.2311 mgc: 1.442869 ustep: 1 
iter: 2  value: 590.2311 mgc: 0.002928381 ustep: 1 
iter: 3  value: 590.2311 mgc: 2.40435e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  12.27754 
iter: 1  value: 590.0157 mgc: 3.07055 ustep: 1 
iter: 2  value: 590.0156 mgc: 0.02464186 ustep: 1 
iter: 3  value: 590.0156 mgc: 3.780516e-06 ustep: 1 
iter: 4  mgc: 9.325873e-14 
iter: 1  value: 589.8242 mgc: 1.383706 ustep: 1 
iter: 2  value: 589.8242 mgc: 0.00496119 ustep: 1 
iter: 3  value: 589.8242 mgc: 1.565243e-07 ustep: 1 
mgc: 3.728268e-14 
iter: 1  mgc: 3.728268e-14 
outer mgc:  7.650935 
iter: 1  value: 589.6351 mgc: 0.8330119 ustep: 1 
iter: 2  value: 589.6351 mgc: 0.001853906 ustep: 1 
iter: 3  value: 589.6351 mgc: 1.375889e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  7.688649 
iter: 1  value: 588.8651 mgc: 2.369201 ustep: 1 
iter: 2  value: 588.865 mgc: 0.01601058 ustep: 1 
iter: 3  value: 588.865 mgc: 1.562683e-06 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  6.463591 
iter: 1  value: 588.0371 mgc: 1.700931 ustep: 1 
iter: 2  value: 588.037 mgc: 0.00604104 ustep: 1 
iter: 3  value: 588.037 mgc: 2.834424e-07 ustep: 1 
iter: 4  mgc: 4.13003e-14 
iter: 1  mgc: 4.13003e-14 
outer mgc:  2.491052 
iter: 1  value: 587.2417 mgc: 1.160197 ustep: 1 
iter: 2  value: 587.2417 mgc: 0.006794567 ustep: 1 
iter: 3  value: 587.2417 mgc: 2.058668e-07 ustep: 1 
mgc: 3.819167e-14 
iter: 1  value: 587.7575 mgc: 0.613437 ustep: 1 
iter: 2  value: 587.7575 mgc: 0.0006273585 ustep: 1 
iter: 3  mgc: 2.906732e-09 
iter: 1  mgc: 2.906732e-09 
outer mgc:  1.70488 
iter: 1  value: 587.6328 mgc: 0.3554471 ustep: 1 
iter: 2  value: 587.6328 mgc: 0.0004544203 ustep: 1 
iter: 3  mgc: 7.464011e-10 
iter: 1  value: 587.7465 mgc: 0.2640943 ustep: 1 
iter: 2  value: 587.7465 mgc: 0.0001328073 ustep: 1 
iter: 3  mgc: 6.449252e-11 
iter: 1  value: 587.7484 mgc: 0.1236774 ustep: 1 
iter: 2  value: 587.7484 mgc: 2.913591e-05 ustep: 1 
iter: 3  mgc: 3.105849e-12 
iter: 1  mgc: 3.105849e-12 
outer mgc:  0.7767128 
iter: 1  value: 587.7122 mgc: 0.1320971 ustep: 1 
iter: 2  value: 587.7122 mgc: 4.976154e-05 ustep: 1 
iter: 3  mgc: 1.367173e-11 
iter: 1  mgc: 1.367173e-11 
outer mgc:  0.9285208 
iter: 1  value: 587.6906 mgc: 0.09685902 ustep: 1 
iter: 2  value: 587.6906 mgc: 1.209021e-05 ustep: 1 
iter: 3  mgc: 2.806644e-13 
iter: 1  mgc: 2.806644e-13 
outer mgc:  0.4378732 
iter: 1  value: 587.6473 mgc: 0.06754523 ustep: 1 
iter: 2  value: 587.6473 mgc: 7.789918e-06 ustep: 1 
iter: 3  mgc: 3.899103e-13 
iter: 1  mgc: 3.899103e-13 
outer mgc:  0.4239087 
iter: 1  value: 587.5878 mgc: 0.07776214 ustep: 1 
iter: 2  value: 587.5878 mgc: 7.243016e-06 ustep: 1 
iter: 3  mgc: 2.966516e-13 
iter: 1  value: 587.4894 mgc: 0.06451182 ustep: 1 
iter: 2  value: 587.4894 mgc: 1.382892e-05 ustep: 1 
iter: 3  mgc: 9.752199e-13 
iter: 1  value: 587.1433 mgc: 0.230672 ustep: 1 
iter: 2  value: 587.1433 mgc: 0.0001726799 ustep: 1 
iter: 3  mgc: 1.466951e-10 
iter: 1  mgc: 1.466951e-10 
outer mgc:  0.4158074 
iter: 1  value: 586.8796 mgc: 0.5677176 ustep: 1 
iter: 2  value: 586.8796 mgc: 0.001280704 ustep: 1 
iter: 3  mgc: 8.191321e-09 
iter: 1  value: 587.0621 mgc: 0.2574469 ustep: 1 
iter: 2  value: 587.0621 mgc: 0.0002828714 ustep: 1 
iter: 3  mgc: 4.318723e-10 
iter: 1  value: 587.1116 mgc: 0.09462438 ustep: 1 
iter: 2  value: 587.1116 mgc: 3.835545e-05 ustep: 1 
iter: 3  mgc: 7.97673e-12 
iter: 1  mgc: 7.97673e-12 
outer mgc:  0.4160354 
iter: 1  value: 587.0554 mgc: 0.05881849 ustep: 1 
iter: 2  value: 587.0554 mgc: 5.337505e-06 ustep: 1 
iter: 3  mgc: 1.509903e-13 
iter: 1  mgc: 1.509903e-13 
outer mgc:  0.1880958 
iter: 1  value: 586.9893 mgc: 0.04347422 ustep: 1 
iter: 2  value: 586.9893 mgc: 7.918033e-06 ustep: 1 
iter: 3  mgc: 2.824407e-13 
iter: 1  value: 586.8814 mgc: 0.08517194 ustep: 1 
iter: 2  value: 586.8814 mgc: 2.609196e-05 ustep: 1 
iter: 3  mgc: 3.218759e-12 
iter: 1  mgc: 3.218759e-12 
outer mgc:  0.2555407 
iter: 1  value: 586.826 mgc: 0.0653996 ustep: 1 
iter: 2  value: 586.826 mgc: 1.398784e-05 ustep: 1 
iter: 3  mgc: 1.078249e-12 
iter: 1  mgc: 1.078249e-12 
outer mgc:  0.1184328 
iter: 1  value: 586.7376 mgc: 0.1665657 ustep: 1 
iter: 2  value: 586.7376 mgc: 7.442788e-05 ustep: 1 
iter: 3  mgc: 3.913359e-11 
iter: 1  value: 586.7981 mgc: 0.04677768 ustep: 1 
iter: 2  value: 586.7981 mgc: 7.529909e-06 ustep: 1 
iter: 3  mgc: 3.357314e-13 
iter: 1  mgc: 3.357314e-13 
outer mgc:  0.08674847 
iter: 1  value: 586.7757 mgc: 0.02438178 ustep: 1 
iter: 2  value: 586.7757 mgc: 1.50648e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
iter: 1  value: 586.7216 mgc: 0.07533509 ustep: 1 
iter: 2  value: 586.7216 mgc: 7.025902e-06 ustep: 1 
iter: 3  mgc: 1.39444e-13 
iter: 1  mgc: 1.39444e-13 
outer mgc:  0.393659 
iter: 1  value: 586.6073 mgc: 0.08921529 ustep: 1 
iter: 2  value: 586.6073 mgc: 2.405364e-05 ustep: 1 
iter: 3  mgc: 2.476241e-12 
iter: 1  mgc: 2.476241e-12 
outer mgc:  0.1916281 
iter: 1  value: 586.6366 mgc: 0.08624002 ustep: 1 
iter: 2  value: 586.6366 mgc: 2.402715e-05 ustep: 1 
iter: 3  mgc: 3.120615e-12 
iter: 1  value: 586.6149 mgc: 0.02309434 ustep: 1 
iter: 2  value: 586.6149 mgc: 1.481521e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  0.08645307 
iter: 1  value: 586.6259 mgc: 0.01189435 ustep: 1 
iter: 2  value: 586.6259 mgc: 1.667483e-07 ustep: 1 
iter: 3  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  0.02716936 
iter: 1  value: 586.6368 mgc: 0.007584039 ustep: 1 
iter: 2  value: 586.6368 mgc: 1.959885e-07 ustep: 1 
mgc: 2.553513e-14 
iter: 1  value: 586.6509 mgc: 0.009786044 ustep: 1 
iter: 2  value: 586.6509 mgc: 3.26793e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.0006991292 
iter: 1  value: 586.6513 mgc: 0.0002451524 ustep: 1 
iter: 2  mgc: 2.716671e-10 
iter: 1  mgc: 2.716671e-10 
outer mgc:  4.398801e-05 
iter: 1  mgc: 2.716671e-10 
iter: 1  mgc: 2.716671e-10 
outer mgc:  4.398801e-05 
iter: 1  value: 586.6487 mgc: 0.02714832 ustep: 1 
iter: 2  value: 586.6487 mgc: 2.490516e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.5449986 
iter: 1  value: 586.6544 mgc: 0.02713155 ustep: 1 
iter: 2  value: 586.6544 mgc: 2.48986e-06 ustep: 1 
iter: 3  mgc: 3.497203e-14 
outer mgc:  0.5449684 
iter: 1  value: 586.6501 mgc: 0.007338161 ustep: 1 
iter: 2  value: 586.6501 mgc: 1.75799e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.2369286 
iter: 1  value: 586.6527 mgc: 0.00733187 ustep: 1 
iter: 2  value: 586.6527 mgc: 1.754948e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.2366806 
iter: 1  value: 586.6536 mgc: 0.0529651 ustep: 1 
iter: 2  value: 586.6536 mgc: 4.565448e-06 ustep: 1 
iter: 3  mgc: 1.123546e-13 
outer mgc:  0.4458435 
iter: 1  value: 586.6493 mgc: 0.05296805 ustep: 1 
iter: 2  value: 586.6493 mgc: 4.573754e-06 ustep: 1 
iter: 3  mgc: 9.903189e-14 
outer mgc:  0.4458241 
iter: 1  value: 586.6545 mgc: 0.02861222 ustep: 1 
iter: 2  value: 586.6545 mgc: 2.020682e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.6432924 
iter: 1  value: 586.6486 mgc: 0.0286142 ustep: 1 
iter: 2  value: 586.6486 mgc: 2.023525e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.6434013 
iter: 1  value: 586.6397 mgc: 0.007200476 ustep: 1 
iter: 2  value: 586.6397 mgc: 1.877397e-07 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.006671076 
iter: 1  value: 586.6629 mgc: 0.007196334 ustep: 1 
iter: 2  value: 586.6629 mgc: 1.879292e-07 ustep: 1 
mgc: 2.842171e-14 
outer mgc:  0.006736052 
iter: 1  value: 586.6758 mgc: 0.03043319 ustep: 1 
iter: 2  value: 586.6758 mgc: 3.901579e-06 ustep: 1 
iter: 3  mgc: 6.217249e-14 
outer mgc:  0.0900686 
iter: 1  value: 586.6268 mgc: 0.03050444 ustep: 1 
iter: 2  value: 586.6268 mgc: 3.901647e-06 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.09001445 
iter: 1  value: 586.6583 mgc: 0.0295269 ustep: 1 
iter: 2  value: 586.6583 mgc: 2.020367e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.1376563 
iter: 1  value: 586.6444 mgc: 0.029602 ustep: 1 
iter: 2  value: 586.6444 mgc: 2.026525e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.1377778 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:06:39 2021]
Finished job 0.
1 of 1 steps (100%) done

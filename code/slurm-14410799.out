Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:25:40 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.8_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.8_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.8_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4305.461559 
final  value 4030.413757 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1239.071 mgc: 58.8811 ustep: 1 
iter: 2  value: 1203.301 mgc: 20.94277 ustep: 1 
iter: 3  value: 1203.246 mgc: 1.566942 ustep: 1 
iter: 4  value: 1203.246 mgc: 0.006268506 ustep: 1 
iter: 5  value: 1203.246 mgc: 2.438102e-07 ustep: 1 
mgc: 1.779132e-14 
iter: 1  mgc: 1.779132e-14 
Matching hessian patterns... Done
outer mgc:  507.4859 
iter: 1  value: 797.5641 mgc: 27.82145 ustep: 1 
iter: 2  value: 797.0179 mgc: 4.52303 ustep: 1 
iter: 3  value: 797.0178 mgc: 0.0776956 ustep: 1 
iter: 4  value: 797.0178 mgc: 3.697415e-05 ustep: 1 
iter: 5  mgc: 7.186862e-12 
iter: 1  value: 638.6851 mgc: 38.82914 ustep: 1 
iter: 2  value: 637.1872 mgc: 6.448017 ustep: 1 
iter: 3  value: 637.187 mgc: 0.09764551 ustep: 1 
iter: 4  value: 637.187 mgc: 5.613691e-05 ustep: 1 
iter: 5  mgc: 1.864023e-11 
iter: 1  mgc: 1.864023e-11 
outer mgc:  266.6406 
iter: 1  value: 627.5242 mgc: 63.08539 ustep: 1 
iter: 2  value: 609.112 mgc: 15.69813 ustep: 1 
iter: 3  value: 609.0747 mgc: 0.9154299 ustep: 1 
iter: 4  value: 609.0747 mgc: 0.004511596 ustep: 1 
iter: 5  value: 609.0747 mgc: 1.304504e-07 ustep: 1 
mgc: 2.747802e-14 
iter: 1  mgc: 2.747802e-14 
outer mgc:  296.6004 
iter: 1  value: 412.847 mgc: 40.50742 ustep: 1 
iter: 2  value: 387.2706 mgc: 18.60675 ustep: 1 
iter: 3  value: 387.1869 mgc: 1.25409 ustep: 1 
iter: 4  value: 387.1869 mgc: 0.01049669 ustep: 1 
iter: 5  value: 387.1869 mgc: 7.691973e-07 ustep: 1 
iter: 6  mgc: 2.71687e-14 
iter: 1  mgc: 2.71687e-14 
outer mgc:  30.04343 
iter: 1  value: 378.4709 mgc: 17.43448 ustep: 1 
iter: 2  value: 378.3607 mgc: 0.9325961 ustep: 1 
iter: 3  value: 378.3607 mgc: 0.005133135 ustep: 1 
iter: 4  value: 378.3607 mgc: 1.603709e-07 ustep: 1 
mgc: 2.509104e-14 
iter: 1  mgc: 2.509104e-14 
outer mgc:  69.96749 
iter: 1  value: 374.5315 mgc: 18.86421 ustep: 1 
iter: 2  value: 374.0809 mgc: 2.581528 ustep: 1 
iter: 3  value: 374.0809 mgc: 0.03003008 ustep: 1 
iter: 4  value: 374.0809 mgc: 4.35182e-06 ustep: 1 
iter: 5  mgc: 8.970602e-14 
iter: 1  mgc: 8.970602e-14 
outer mgc:  93.32631 
iter: 1  value: 380.3964 mgc: 40.08682 ustep: 1 
iter: 2  value: 378.3338 mgc: 4.944097 ustep: 1 
iter: 3  value: 378.3335 mgc: 0.08099123 ustep: 1 
iter: 4  value: 378.3335 mgc: 2.384054e-05 ustep: 1 
iter: 5  mgc: 2.120082e-12 
iter: 1  value: 355.1267 mgc: 17.18485 ustep: 1 
iter: 2  value: 355.082 mgc: 0.62066 ustep: 1 
iter: 3  value: 355.082 mgc: 0.00131751 ustep: 1 
iter: 4  mgc: 5.923584e-09 
iter: 1  mgc: 5.923584e-09 
outer mgc:  13.01501 
iter: 1  value: 354.5867 mgc: 10.4965 ustep: 1 
iter: 2  value: 354.5752 mgc: 0.3077243 ustep: 1 
iter: 3  value: 354.5752 mgc: 0.0003399885 ustep: 1 
iter: 4  mgc: 6.503216e-10 
iter: 1  mgc: 6.503216e-10 
outer mgc:  26.12152 
iter: 1  value: 354.8441 mgc: 13.54756 ustep: 1 
iter: 2  value: 354.787 mgc: 0.5082012 ustep: 1 
iter: 3  value: 354.787 mgc: 0.002162126 ustep: 1 
iter: 4  value: 354.787 mgc: 1.374993e-07 ustep: 1 
iter: 5  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  29.34379 
iter: 1  value: 352.9184 mgc: 4.673996 ustep: 1 
iter: 2  value: 352.9159 mgc: 0.1403998 ustep: 1 
iter: 3  value: 352.9159 mgc: 0.0001548616 ustep: 1 
iter: 4  mgc: 8.088188e-10 
iter: 1  mgc: 8.088188e-10 
outer mgc:  16.42293 
iter: 1  value: 353.781 mgc: 7.021517 ustep: 1 
iter: 2  value: 353.779 mgc: 0.1404959 ustep: 1 
iter: 3  value: 353.779 mgc: 0.0001064073 ustep: 1 
iter: 4  mgc: 6.684875e-11 
iter: 1  value: 352.224 mgc: 1.78649 ustep: 1 
iter: 2  value: 352.224 mgc: 0.01053574 ustep: 1 
iter: 3  value: 352.224 mgc: 5.762563e-07 ustep: 1 
iter: 4  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  6.914902 
iter: 1  value: 351.8051 mgc: 1.620527 ustep: 1 
iter: 2  value: 351.805 mgc: 0.01345238 ustep: 1 
iter: 3  value: 351.805 mgc: 6.089784e-06 ustep: 1 
iter: 4  mgc: 1.143974e-12 
iter: 1  mgc: 1.143974e-12 
outer mgc:  3.486634 
iter: 1  value: 351.5556 mgc: 1.044614 ustep: 1 
iter: 2  value: 351.5556 mgc: 0.01003818 ustep: 1 
iter: 3  value: 351.5556 mgc: 2.809117e-06 ustep: 1 
iter: 4  mgc: 1.874056e-13 
iter: 1  mgc: 1.874056e-13 
outer mgc:  5.311586 
iter: 1  value: 351.2844 mgc: 0.6349801 ustep: 1 
iter: 2  value: 351.2844 mgc: 0.002094986 ustep: 1 
iter: 3  value: 351.2844 mgc: 2.245432e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  3.328017 
iter: 1  value: 351.4218 mgc: 4.060863 ustep: 1 
iter: 2  value: 351.4214 mgc: 0.04805108 ustep: 1 
iter: 3  value: 351.4214 mgc: 1.063481e-05 ustep: 1 
iter: 4  mgc: 4.116707e-13 
iter: 1  value: 351.2409 mgc: 1.811393 ustep: 1 
iter: 2  value: 351.2409 mgc: 0.009570194 ustep: 1 
iter: 3  value: 351.2409 mgc: 4.656983e-07 ustep: 1 
iter: 4  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  3.75878 
iter: 1  value: 351.2162 mgc: 1.092344 ustep: 1 
iter: 2  value: 351.2162 mgc: 0.003777241 ustep: 1 
iter: 3  value: 351.2162 mgc: 7.5463e-08 ustep: 1 
mgc: 2.021994e-14 
iter: 1  mgc: 2.021994e-14 
outer mgc:  1.179134 
iter: 1  value: 351.2008 mgc: 0.6227451 ustep: 1 
iter: 2  value: 351.2008 mgc: 0.001961994 ustep: 1 
iter: 3  value: 351.2008 mgc: 2.262479e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  2.529117 
iter: 1  value: 351.0984 mgc: 0.5313301 ustep: 1 
iter: 2  value: 351.0984 mgc: 0.001584977 ustep: 1 
iter: 3  value: 351.0984 mgc: 1.080388e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  2.243748 
iter: 1  value: 351.3113 mgc: 3.520591 ustep: 1 
iter: 2  value: 351.3111 mgc: 0.03225543 ustep: 1 
iter: 3  value: 351.3111 mgc: 5.584865e-06 ustep: 1 
iter: 4  mgc: 1.652012e-13 
iter: 1  value: 351.087 mgc: 0.8466706 ustep: 1 
iter: 2  value: 351.087 mgc: 0.0019472 ustep: 1 
iter: 3  value: 351.087 mgc: 2.029917e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  1.420095 
iter: 1  value: 351.0923 mgc: 0.4859493 ustep: 1 
iter: 2  value: 351.0923 mgc: 0.0008152263 ustep: 1 
iter: 3  mgc: 3.067347e-09 
iter: 1  mgc: 3.067347e-09 
outer mgc:  1.053615 
iter: 1  value: 351.1055 mgc: 0.2515014 ustep: 1 
iter: 2  value: 351.1055 mgc: 0.0002824121 ustep: 1 
iter: 3  mgc: 3.392668e-10 
iter: 1  mgc: 3.392668e-10 
outer mgc:  0.6004785 
iter: 1  value: 351.0731 mgc: 0.3318986 ustep: 1 
iter: 2  value: 351.0731 mgc: 0.0002297895 ustep: 1 
iter: 3  mgc: 1.804795e-09 
iter: 1  mgc: 1.804795e-09 
outer mgc:  0.4007196 
iter: 1  value: 351.0684 mgc: 0.2920737 ustep: 1 
iter: 2  value: 351.0684 mgc: 0.000346402 ustep: 1 
iter: 3  mgc: 2.039056e-09 
iter: 1  mgc: 2.039056e-09 
outer mgc:  0.502842 
iter: 1  value: 351.0694 mgc: 0.1517869 ustep: 1 
iter: 2  value: 351.0694 mgc: 0.0001122266 ustep: 1 
iter: 3  mgc: 3.69198e-10 
iter: 1  mgc: 3.69198e-10 
outer mgc:  0.2022347 
iter: 1  value: 351.0716 mgc: 0.06502116 ustep: 1 
iter: 2  value: 351.0716 mgc: 1.80924e-05 ustep: 1 
iter: 3  mgc: 6.763479e-12 
iter: 1  mgc: 6.763479e-12 
outer mgc:  0.0390498 
iter: 1  value: 351.0717 mgc: 0.0435171 ustep: 1 
iter: 2  value: 351.0717 mgc: 5.004021e-06 ustep: 1 
iter: 3  mgc: 1.771916e-13 
iter: 1  value: 351.0715 mgc: 0.0194365 ustep: 1 
iter: 2  value: 351.0715 mgc: 9.073051e-07 ustep: 1 
iter: 3  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  0.02533063 
iter: 1  value: 351.069 mgc: 0.009889484 ustep: 1 
iter: 2  value: 351.069 mgc: 5.299262e-07 ustep: 1 
iter: 3  mgc: 2.420286e-14 
iter: 1  value: 351.0704 mgc: 0.004198118 ustep: 1 
iter: 2  value: 351.0704 mgc: 9.551592e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  0.009874875 
iter: 1  value: 351.0714 mgc: 0.007195626 ustep: 1 
iter: 2  value: 351.0714 mgc: 2.890036e-07 ustep: 1 
iter: 3  mgc: 2.153833e-14 
iter: 1  value: 351.0707 mgc: 0.001364814 ustep: 1 
iter: 2  mgc: 7.179481e-09 
iter: 1  mgc: 7.179481e-09 
outer mgc:  0.004302062 
iter: 1  value: 351.0706 mgc: 0.002698637 ustep: 1 
iter: 2  value: 351.0706 mgc: 2.423322e-08 ustep: 1 
mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  0.00517652 
iter: 1  value: 351.0707 mgc: 0.001144969 ustep: 1 
iter: 2  mgc: 6.558776e-09 
iter: 1  mgc: 6.558776e-09 
outer mgc:  0.0004466752 
iter: 1  value: 351.0707 mgc: 0.0001319595 ustep: 1 
iter: 2  mgc: 5.904699e-11 
iter: 1  mgc: 5.904699e-11 
outer mgc:  5.206383e-05 
iter: 1  mgc: 5.904699e-11 
iter: 1  mgc: 5.904699e-11 
outer mgc:  5.206383e-05 
iter: 1  value: 351.0707 mgc: 0.05034887 ustep: 1 
iter: 2  value: 351.0707 mgc: 7.398605e-06 ustep: 1 
iter: 3  mgc: 2.855494e-13 
outer mgc:  0.08707401 
iter: 1  value: 351.0708 mgc: 0.0503415 ustep: 1 
iter: 2  value: 351.0708 mgc: 7.408744e-06 ustep: 1 
iter: 3  mgc: 2.633449e-13 
outer mgc:  0.08709465 
iter: 1  value: 351.0713 mgc: 0.02696222 ustep: 1 
iter: 2  value: 351.0713 mgc: 2.784383e-06 ustep: 1 
iter: 3  mgc: 5.373479e-14 
outer mgc:  0.2204647 
iter: 1  value: 351.0703 mgc: 0.0269612 ustep: 1 
iter: 2  value: 351.0703 mgc: 2.786358e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.2205612 
iter: 1  value: 351.0709 mgc: 0.05027851 ustep: 1 
iter: 2  value: 351.0709 mgc: 6.299191e-06 ustep: 1 
iter: 3  mgc: 1.825207e-13 
outer mgc:  0.09868055 
iter: 1  value: 351.0706 mgc: 0.05027106 ustep: 1 
iter: 2  value: 351.0706 mgc: 6.30737e-06 ustep: 1 
iter: 3  mgc: 1.767475e-13 
outer mgc:  0.09862236 
iter: 1  value: 351.0715 mgc: 0.02792437 ustep: 1 
iter: 2  value: 351.0715 mgc: 2.211886e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
outer mgc:  0.2303008 
iter: 1  value: 351.0701 mgc: 0.02792736 ustep: 1 
iter: 2  value: 351.0701 mgc: 2.213648e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.2304115 
iter: 1  value: 351.0694 mgc: 0.004375296 ustep: 1 
iter: 2  value: 351.0694 mgc: 8.254321e-08 ustep: 1 
mgc: 2.842171e-14 
outer mgc:  0.009862051 
iter: 1  value: 351.0721 mgc: 0.004372362 ustep: 1 
iter: 2  value: 351.0721 mgc: 8.247885e-08 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.009884456 
iter: 1  value: 351.0728 mgc: 0.01194913 ustep: 1 
iter: 2  value: 351.0728 mgc: 3.447726e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.05709128 
iter: 1  value: 351.0687 mgc: 0.01197564 ustep: 1 
iter: 2  value: 351.0687 mgc: 3.463943e-07 ustep: 1 
iter: 3  mgc: 2.131628e-14 
outer mgc:  0.05717841 
iter: 1  value: 351.0731 mgc: 0.01369394 ustep: 1 
iter: 2  value: 351.0731 mgc: 4.696881e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.05497787 
iter: 1  value: 351.0683 mgc: 0.01372641 ustep: 1 
iter: 2  value: 351.0683 mgc: 4.723372e-07 ustep: 1 
iter: 3  mgc: 1.873501e-14 
outer mgc:  0.05494875 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:25:42 2021]
Finished job 0.
1 of 1 steps (100%) done

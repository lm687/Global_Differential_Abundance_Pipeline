Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:47:36 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4412.026951 
final  value 4317.118402 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 490.6827 mgc: 56.11808 ustep: 1 
iter: 2  value: 449.6129 mgc: 29.89094 ustep: 1 
iter: 3  value: 448.5779 mgc: 7.133746 ustep: 1 
iter: 4  value: 448.5705 mgc: 0.1433463 ustep: 1 
iter: 5  value: 448.5705 mgc: 0.003301282 ustep: 1 
iter: 6  value: 448.5705 mgc: 1.761312e-06 ustep: 1 
iter: 7  mgc: 5.000445e-13 
iter: 1  mgc: 5.000445e-13 
Matching hessian patterns... Done
outer mgc:  61.03328 
iter: 1  value: 493.9287 mgc: 25.00493 ustep: 1 
iter: 2  value: 493.7575 mgc: 1.485322 ustep: 1 
iter: 3  value: 493.7575 mgc: 0.0160376 ustep: 1 
iter: 4  value: 493.7575 mgc: 1.961423e-06 ustep: 1 
iter: 5  mgc: 3.047562e-14 
iter: 1  value: 438.6619 mgc: 7.84696 ustep: 1 
iter: 2  value: 438.6595 mgc: 0.1604838 ustep: 1 
iter: 3  value: 438.6595 mgc: 0.0002050032 ustep: 1 
iter: 4  mgc: 3.442601e-10 
iter: 1  mgc: 3.442601e-10 
outer mgc:  39.74509 
iter: 1  value: 433.068 mgc: 11.35941 ustep: 1 
iter: 2  value: 433.0604 mgc: 0.2322189 ustep: 1 
iter: 3  value: 433.0604 mgc: 0.0006879648 ustep: 1 
iter: 4  mgc: 6.116493e-09 
iter: 1  mgc: 6.116493e-09 
outer mgc:  38.54733 
iter: 1  value: 426.5055 mgc: 5.497232 ustep: 1 
iter: 2  value: 426.505 mgc: 0.07751765 ustep: 1 
iter: 3  value: 426.505 mgc: 4.145045e-05 ustep: 1 
iter: 4  mgc: 1.36442e-11 
iter: 1  mgc: 1.36442e-11 
outer mgc:  26.22752 
iter: 1  value: 419.4211 mgc: 12.19301 ustep: 1 
iter: 2  value: 419.4066 mgc: 0.3387353 ustep: 1 
iter: 3  value: 419.4066 mgc: 0.0008675478 ustep: 1 
iter: 4  mgc: 5.780782e-09 
iter: 1  mgc: 5.780782e-09 
outer mgc:  17.17285 
iter: 1  value: 408.7205 mgc: 8.297625 ustep: 1 
iter: 2  value: 408.7153 mgc: 0.2019745 ustep: 1 
iter: 3  value: 408.7153 mgc: 0.000645202 ustep: 1 
iter: 4  value: 408.7153 mgc: 4.09482e-08 ustep: 1 
iter: 5  mgc: 2.631229e-14 
iter: 1  mgc: 2.631229e-14 
outer mgc:  24.69961 
iter: 1  value: 421.6465 mgc: 40.30005 ustep: 1 
iter: 2  value: 419.1183 mgc: 2.851797 ustep: 1 
iter: 3  value: 419.1102 mgc: 0.2070088 ustep: 1 
iter: 4  value: 419.1102 mgc: 0.001670852 ustep: 1 
iter: 5  value: 419.1102 mgc: 1.152877e-07 ustep: 1 
iter: 6  mgc: 3.241851e-14 
iter: 1  value: 404.6671 mgc: 12.36953 ustep: 1 
iter: 2  value: 404.658 mgc: 0.2730888 ustep: 1 
iter: 3  value: 404.658 mgc: 0.0004845272 ustep: 1 
iter: 4  mgc: 2.396471e-09 
iter: 1  mgc: 2.396471e-09 
outer mgc:  25.88291 
iter: 1  value: 402.5667 mgc: 11.5031 ustep: 1 
iter: 2  value: 402.5346 mgc: 0.3660744 ustep: 1 
iter: 3  value: 402.5346 mgc: 0.0008396184 ustep: 1 
iter: 4  value: 402.5346 mgc: 5.201109e-08 ustep: 1 
iter: 5  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  27.17485 
iter: 1  value: 399.877 mgc: 17.47886 ustep: 1 
iter: 2  value: 399.8264 mgc: 0.9608199 ustep: 1 
iter: 3  value: 399.8264 mgc: 0.008192343 ustep: 1 
iter: 4  value: 399.8264 mgc: 6.139071e-07 ustep: 1 
iter: 5  mgc: 2.68674e-14 
iter: 1  mgc: 2.68674e-14 
outer mgc:  16.81367 
iter: 1  value: 399.3402 mgc: 20.08785 ustep: 1 
iter: 2  value: 399.3207 mgc: 0.38087 ustep: 1 
iter: 3  value: 399.3207 mgc: 0.0006983802 ustep: 1 
iter: 4  mgc: 1.605746e-09 
iter: 1  mgc: 1.605746e-09 
outer mgc:  19.35302 
iter: 1  value: 397.6727 mgc: 14.3689 ustep: 1 
iter: 2  value: 397.6641 mgc: 0.2968936 ustep: 1 
iter: 3  value: 397.6641 mgc: 0.000281181 ustep: 1 
iter: 4  mgc: 3.644247e-10 
iter: 1  mgc: 3.644247e-10 
outer mgc:  16.7753 
iter: 1  value: 399.9032 mgc: 6.31121 ustep: 1 
iter: 2  value: 399.9024 mgc: 0.09319101 ustep: 1 
iter: 3  value: 399.9024 mgc: 3.739024e-05 ustep: 1 
iter: 4  mgc: 5.914824e-12 
iter: 1  value: 397.0808 mgc: 3.976008 ustep: 1 
iter: 2  value: 397.0807 mgc: 0.02265798 ustep: 1 
iter: 3  value: 397.0807 mgc: 2.596975e-06 ustep: 1 
iter: 4  mgc: 4.03011e-14 
iter: 1  mgc: 4.03011e-14 
outer mgc:  4.177922 
iter: 1  value: 396.8311 mgc: 0.7784732 ustep: 1 
iter: 2  value: 396.8311 mgc: 0.001155668 ustep: 1 
iter: 3  mgc: 6.548493e-09 
iter: 1  mgc: 6.548493e-09 
outer mgc:  2.376831 
iter: 1  value: 396.6323 mgc: 0.9800232 ustep: 1 
iter: 2  value: 396.6323 mgc: 0.005911378 ustep: 1 
iter: 3  value: 396.6323 mgc: 2.848382e-07 ustep: 1 
mgc: 1.798561e-14 
iter: 1  mgc: 1.798561e-14 
outer mgc:  2.584772 
iter: 1  value: 396.4803 mgc: 1.218597 ustep: 1 
iter: 2  value: 396.4803 mgc: 0.005875699 ustep: 1 
iter: 3  value: 396.4803 mgc: 1.536085e-07 ustep: 1 
mgc: 2.670086e-14 
iter: 1  mgc: 2.670086e-14 
outer mgc:  1.911326 
iter: 1  value: 396.4152 mgc: 0.7814101 ustep: 1 
iter: 2  value: 396.4152 mgc: 0.001025445 ustep: 1 
iter: 3  mgc: 7.861002e-09 
iter: 1  mgc: 7.861002e-09 
outer mgc:  0.7019974 
iter: 1  value: 396.2916 mgc: 1.220182 ustep: 1 
iter: 2  value: 396.2916 mgc: 0.001568703 ustep: 1 
iter: 3  value: 396.2916 mgc: 1.227889e-08 ustep: 1 
mgc: 3.552714e-14 
iter: 1  value: 396.3534 mgc: 0.4086225 ustep: 1 
iter: 2  value: 396.3534 mgc: 0.0001860181 ustep: 1 
iter: 3  mgc: 1.549825e-10 
iter: 1  mgc: 1.549825e-10 
outer mgc:  0.9642508 
iter: 1  value: 396.3206 mgc: 0.58162 ustep: 1 
iter: 2  value: 396.3206 mgc: 0.0002455585 ustep: 1 
iter: 3  mgc: 2.740523e-10 
iter: 1  mgc: 2.740523e-10 
outer mgc:  1.963907 
iter: 1  value: 396.2873 mgc: 0.2136547 ustep: 1 
iter: 2  value: 396.2873 mgc: 0.0001641545 ustep: 1 
iter: 3  mgc: 1.160245e-10 
iter: 1  mgc: 1.160245e-10 
outer mgc:  0.4496692 
iter: 1  value: 396.2447 mgc: 0.2260391 ustep: 1 
iter: 2  value: 396.2447 mgc: 5.695797e-05 ustep: 1 
iter: 3  mgc: 9.987899e-12 
iter: 1  mgc: 9.987899e-12 
outer mgc:  0.3532714 
iter: 1  value: 396.2254 mgc: 0.48179 ustep: 1 
iter: 2  value: 396.2254 mgc: 0.0002041225 ustep: 1 
iter: 3  mgc: 2.255218e-10 
iter: 1  mgc: 2.255218e-10 
outer mgc:  0.6561213 
iter: 1  value: 396.221 mgc: 0.3829102 ustep: 1 
iter: 2  value: 396.221 mgc: 0.0001472755 ustep: 1 
iter: 3  mgc: 6.759082e-11 
iter: 1  mgc: 6.759082e-11 
outer mgc:  0.3805908 
iter: 1  value: 396.2043 mgc: 0.170833 ustep: 1 
iter: 2  value: 396.2043 mgc: 7.480994e-05 ustep: 1 
iter: 3  mgc: 4.239276e-11 
iter: 1  value: 396.1897 mgc: 0.0883793 ustep: 1 
iter: 2  value: 396.1897 mgc: 9.337563e-05 ustep: 1 
iter: 3  mgc: 1.715569e-10 
iter: 1  mgc: 1.715569e-10 
outer mgc:  0.1922596 
iter: 1  value: 396.1744 mgc: 0.5214005 ustep: 1 
iter: 2  value: 396.1744 mgc: 0.0009345092 ustep: 1 
iter: 3  value: 396.1744 mgc: 1.561659e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  0.4976023 
iter: 1  value: 396.1605 mgc: 0.2445727 ustep: 1 
iter: 2  value: 396.1605 mgc: 0.0002283987 ustep: 1 
iter: 3  mgc: 2.119522e-10 
iter: 1  mgc: 2.119522e-10 
outer mgc:  0.7732529 
iter: 1  value: 396.0983 mgc: 0.3814984 ustep: 1 
iter: 2  value: 396.0983 mgc: 0.001129349 ustep: 1 
iter: 3  mgc: 9.172298e-09 
iter: 1  mgc: 9.172298e-09 
outer mgc:  0.4538622 
iter: 1  value: 396.1382 mgc: 0.2424399 ustep: 1 
iter: 2  value: 396.1382 mgc: 0.0002839025 ustep: 1 
iter: 3  mgc: 1.457101e-10 
iter: 1  mgc: 1.457101e-10 
outer mgc:  0.1231072 
iter: 1  value: 396.1197 mgc: 0.1439381 ustep: 1 
iter: 2  value: 396.1197 mgc: 6.516913e-05 ustep: 1 
iter: 3  mgc: 2.91134e-10 
iter: 1  value: 396.1311 mgc: 0.05787819 ustep: 1 
iter: 2  value: 396.1311 mgc: 9.377949e-06 ustep: 1 
iter: 3  mgc: 5.691225e-12 
iter: 1  mgc: 5.691225e-12 
outer mgc:  0.05279092 
iter: 1  value: 396.1306 mgc: 0.04097196 ustep: 1 
iter: 2  value: 396.1306 mgc: 5.031477e-06 ustep: 1 
iter: 3  mgc: 7.327472e-14 
iter: 1  mgc: 7.327472e-14 
outer mgc:  0.0600682 
iter: 1  value: 396.1299 mgc: 0.02036349 ustep: 1 
iter: 2  value: 396.1299 mgc: 1.140994e-06 ustep: 1 
iter: 3  mgc: 3.275158e-14 
iter: 1  mgc: 3.275158e-14 
outer mgc:  0.001053028 
iter: 1  value: 396.13 mgc: 0.0004693091 ustep: 1 
iter: 2  mgc: 1.861545e-09 
iter: 1  mgc: 1.861545e-09 
outer mgc:  0.0003331362 
iter: 1  mgc: 1.861545e-09 
iter: 1  mgc: 1.861545e-09 
outer mgc:  0.0003331362 
iter: 1  value: 396.1304 mgc: 0.05639929 ustep: 1 
iter: 2  value: 396.1304 mgc: 6.09246e-06 ustep: 1 
iter: 3  mgc: 1.270095e-13 
outer mgc:  0.1640917 
iter: 1  value: 396.1298 mgc: 0.05639423 ustep: 1 
iter: 2  value: 396.1298 mgc: 6.101424e-06 ustep: 1 
iter: 3  mgc: 1.376677e-13 
outer mgc:  0.163699 
iter: 1  value: 396.1305 mgc: 0.02994489 ustep: 1 
iter: 2  value: 396.1305 mgc: 1.800059e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.270254 
iter: 1  value: 396.1298 mgc: 0.02994361 ustep: 1 
iter: 2  value: 396.1298 mgc: 1.801274e-06 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.2695785 
iter: 1  value: 396.13 mgc: 0.0568628 ustep: 1 
iter: 2  value: 396.13 mgc: 6.55998e-06 ustep: 1 
iter: 3  mgc: 3.144152e-13 
outer mgc:  0.1255879 
iter: 1  value: 396.1301 mgc: 0.0568638 ustep: 1 
iter: 2  value: 396.1301 mgc: 6.562972e-06 ustep: 1 
iter: 3  mgc: 3.232969e-13 
outer mgc:  0.1259799 
iter: 1  value: 396.13 mgc: 0.02998066 ustep: 1 
iter: 2  value: 396.13 mgc: 1.726448e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.2584716 
iter: 1  value: 396.1303 mgc: 0.02997989 ustep: 1 
iter: 2  value: 396.1303 mgc: 1.727364e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.2590459 
iter: 1  value: 396.1285 mgc: 0.004663165 ustep: 1 
iter: 2  value: 396.1285 mgc: 8.819336e-08 ustep: 1 
mgc: 4.618528e-14 
outer mgc:  0.004418197 
iter: 1  value: 396.1315 mgc: 0.004661147 ustep: 1 
iter: 2  value: 396.1315 mgc: 8.817724e-08 ustep: 1 
mgc: 2.542411e-14 
outer mgc:  0.004436072 
iter: 1  value: 396.134 mgc: 0.02414645 ustep: 1 
iter: 2  value: 396.134 mgc: 2.060252e-06 ustep: 1 
iter: 3  mgc: 1.652012e-13 
outer mgc:  0.1037314 
iter: 1  value: 396.1261 mgc: 0.02421043 ustep: 1 
iter: 2  value: 396.1261 mgc: 2.076017e-06 ustep: 1 
iter: 3  mgc: 1.720846e-13 
outer mgc:  0.1039191 
iter: 1  value: 396.1316 mgc: 0.01748556 ustep: 1 
iter: 2  value: 396.1316 mgc: 2.034897e-06 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.1129739 
iter: 1  value: 396.1285 mgc: 0.01752975 ustep: 1 
iter: 2  value: 396.1285 mgc: 2.042876e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.1131067 
[Sun Aug 15 23:47:38 2021]
Finished job 0.
1 of 1 steps (100%) done

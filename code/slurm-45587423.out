Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:31:07 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.8_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.8_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.8_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22122.755657 
final  value 20505.754117 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13100.86 mgc: 96.20595 ustep: 1 
iter: 2  value: 3923.956 mgc: 63.13354 ustep: 0.1336527 
iter: 3  value: 2559.323 mgc: 87.04731 ustep: 0.3656489 
iter: 4  value: 2508.229 mgc: 24.55206 ustep: 0.6047286 
iter: 5  value: 2506.179 mgc: 5.642014 ustep: 0.7776652 
iter: 6  value: 2506.152 mgc: 0.7091147 ustep: 0.8818651 
iter: 7  value: 2506.152 mgc: 0.02094529 ustep: 0.9390828 
iter: 8  value: 2506.152 mgc: 0.0001155709 ustep: 0.969066 
iter: 9  value: 2506.152 mgc: 2.834663e-07 ustep: 0.984413 
iter: 10  mgc: 3.481487e-10 
iter: 1  mgc: 3.481487e-10 
Matching hessian patterns... Done
outer mgc:  1263.067 
iter: 1  value: 1647.684 mgc: 27.9605 ustep: 1 
iter: 2  value: 1618.784 mgc: 6.064978 ustep: 1 
iter: 3  value: 1618.742 mgc: 0.2950457 ustep: 1 
iter: 4  value: 1618.742 mgc: 0.001188932 ustep: 1 
iter: 5  value: 1618.742 mgc: 2.62049e-08 ustep: 1 
mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  393.0283 
iter: 1  value: 1510.888 mgc: 14.95839 ustep: 1 
iter: 2  value: 1510.319 mgc: 1.123391 ustep: 1 
iter: 3  value: 1510.319 mgc: 0.02090495 ustep: 1 
iter: 4  value: 1510.319 mgc: 7.760928e-06 ustep: 1 
iter: 5  mgc: 1.075362e-12 
iter: 1  mgc: 1.075362e-12 
outer mgc:  272.0443 
iter: 1  value: 1468.802 mgc: 38.41968 ustep: 1 
iter: 2  value: 1437.668 mgc: 8.18202 ustep: 1 
iter: 3  value: 1437.647 mgc: 0.3677544 ustep: 1 
iter: 4  value: 1437.647 mgc: 0.0009158751 ustep: 1 
iter: 5  mgc: 5.830299e-09 
iter: 1  mgc: 5.830299e-09 
outer mgc:  323.7224 
iter: 1  value: 1359.727 mgc: 8.750306 ustep: 1 
iter: 2  value: 1359.597 mgc: 0.8273102 ustep: 1 
iter: 3  value: 1359.597 mgc: 0.006548002 ustep: 1 
iter: 4  value: 1359.597 mgc: 4.084566e-07 ustep: 1 
iter: 5  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  268.8032 
iter: 1  value: 1307.471 mgc: 35.14747 ustep: 1 
iter: 2  value: 1263.989 mgc: 11.26921 ustep: 1 
iter: 3  value: 1263.934 mgc: 0.7475934 ustep: 1 
iter: 4  value: 1263.934 mgc: 0.004088638 ustep: 1 
iter: 5  value: 1263.934 mgc: 1.251512e-07 ustep: 1 
mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  140.3238 
iter: 1  value: 1539.276 mgc: 45.4915 ustep: 1 
iter: 2  value: 1505.706 mgc: 8.939561 ustep: 1 
iter: 3  value: 1505.691 mgc: 0.2228481 ustep: 1 
iter: 4  value: 1505.691 mgc: 0.000261131 ustep: 1 
iter: 5  mgc: 3.775844e-10 
iter: 1  value: 1246.286 mgc: 10.7079 ustep: 1 
iter: 2  value: 1246.262 mgc: 0.2211815 ustep: 1 
iter: 3  value: 1246.262 mgc: 0.0001587945 ustep: 1 
iter: 4  mgc: 1.144973e-10 
iter: 1  mgc: 1.144973e-10 
outer mgc:  84.73844 
iter: 1  value: 1253.804 mgc: 10.01093 ustep: 1 
iter: 2  value: 1253.755 mgc: 0.2327027 ustep: 1 
iter: 3  value: 1253.755 mgc: 0.0002786876 ustep: 1 
iter: 4  mgc: 3.788827e-10 
iter: 1  value: 1240.642 mgc: 3.873252 ustep: 1 
iter: 2  value: 1240.641 mgc: 0.03421405 ustep: 1 
iter: 3  value: 1240.641 mgc: 6.55219e-06 ustep: 1 
iter: 4  mgc: 1.945111e-13 
iter: 1  mgc: 1.945111e-13 
outer mgc:  42.67584 
iter: 1  value: 1235.808 mgc: 2.811644 ustep: 1 
iter: 2  value: 1235.808 mgc: 0.02451532 ustep: 1 
iter: 3  value: 1235.808 mgc: 2.430102e-06 ustep: 1 
iter: 4  mgc: 6.306067e-14 
iter: 1  mgc: 6.306067e-14 
outer mgc:  42.87785 
iter: 1  value: 1230.771 mgc: 5.846449 ustep: 1 
iter: 2  value: 1230.761 mgc: 0.1318153 ustep: 1 
iter: 3  value: 1230.761 mgc: 0.000105917 ustep: 1 
iter: 4  mgc: 6.828094e-11 
iter: 1  mgc: 6.828094e-11 
outer mgc:  78.92031 
iter: 1  value: 1223.401 mgc: 6.493492 ustep: 1 
iter: 2  value: 1223.388 mgc: 0.1780573 ustep: 1 
iter: 3  value: 1223.388 mgc: 0.0002177683 ustep: 1 
iter: 4  mgc: 3.277032e-10 
iter: 1  mgc: 3.277032e-10 
outer mgc:  45.4301 
iter: 1  value: 1220.862 mgc: 4.6213 ustep: 1 
iter: 2  value: 1220.86 mgc: 0.1215728 ustep: 1 
iter: 3  value: 1220.86 mgc: 0.0001359835 ustep: 1 
iter: 4  mgc: 1.598934e-10 
iter: 1  mgc: 1.598934e-10 
outer mgc:  36.57903 
iter: 1  value: 1218.129 mgc: 2.037528 ustep: 1 
iter: 2  value: 1218.129 mgc: 0.01431029 ustep: 1 
iter: 3  value: 1218.129 mgc: 1.93547e-06 ustep: 1 
iter: 4  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  27.22132 
iter: 1  value: 1220.922 mgc: 4.901177 ustep: 1 
iter: 2  value: 1220.921 mgc: 0.03553711 ustep: 1 
iter: 3  value: 1220.921 mgc: 6.470534e-06 ustep: 1 
iter: 4  mgc: 2.255973e-13 
iter: 1  value: 1217.539 mgc: 1.301801 ustep: 1 
iter: 2  value: 1217.539 mgc: 0.002358877 ustep: 1 
iter: 3  value: 1217.539 mgc: 3.078952e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  13.31644 
iter: 1  value: 1216.821 mgc: 0.7027869 ustep: 1 
iter: 2  value: 1216.821 mgc: 0.002616646 ustep: 1 
iter: 3  value: 1216.821 mgc: 4.834123e-08 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  11.64024 
iter: 1  value: 1215.817 mgc: 1.577904 ustep: 1 
iter: 2  value: 1215.817 mgc: 0.006341334 ustep: 1 
iter: 3  value: 1215.817 mgc: 1.554514e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  24.61455 
iter: 1  value: 1215.137 mgc: 1.260029 ustep: 1 
iter: 2  value: 1215.137 mgc: 0.003036523 ustep: 1 
iter: 3  value: 1215.137 mgc: 2.964682e-08 ustep: 1 
mgc: 3.097522e-14 
iter: 1  mgc: 3.097522e-14 
outer mgc:  7.722651 
iter: 1  value: 1214.522 mgc: 0.4491589 ustep: 1 
iter: 2  value: 1214.522 mgc: 0.0003308473 ustep: 1 
iter: 3  mgc: 6.026175e-10 
iter: 1  mgc: 6.026175e-10 
outer mgc:  5.001617 
iter: 1  value: 1213.801 mgc: 0.7557697 ustep: 1 
iter: 2  value: 1213.801 mgc: 0.001799066 ustep: 1 
iter: 3  value: 1213.801 mgc: 1.107206e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  6.837812 
iter: 1  value: 1212.058 mgc: 1.256707 ustep: 1 
iter: 2  value: 1212.058 mgc: 0.004790995 ustep: 1 
iter: 3  value: 1212.058 mgc: 1.409619e-07 ustep: 1 
iter: 4  mgc: 2.065015e-14 
iter: 1  mgc: 2.065015e-14 
outer mgc:  5.976877 
iter: 1  value: 1212.363 mgc: 2.549338 ustep: 1 
iter: 2  value: 1212.363 mgc: 0.02339117 ustep: 1 
iter: 3  value: 1212.363 mgc: 2.292974e-06 ustep: 1 
iter: 4  mgc: 4.662937e-14 
iter: 1  value: 1211.875 mgc: 0.7063218 ustep: 1 
iter: 2  value: 1211.875 mgc: 0.00172021 ustep: 1 
iter: 3  value: 1211.875 mgc: 1.636074e-08 ustep: 1 
mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  7.193385 
iter: 1  value: 1211.869 mgc: 0.630283 ustep: 1 
iter: 2  value: 1211.869 mgc: 0.0007975218 ustep: 1 
iter: 3  mgc: 1.856276e-09 
iter: 1  mgc: 1.856276e-09 
outer mgc:  8.244117 
iter: 1  value: 1211.876 mgc: 0.4974336 ustep: 1 
iter: 2  value: 1211.876 mgc: 0.0004898213 ustep: 1 
iter: 3  mgc: 7.229719e-10 
iter: 1  mgc: 7.229719e-10 
outer mgc:  4.842352 
iter: 1  value: 1211.537 mgc: 0.3412414 ustep: 1 
iter: 2  value: 1211.537 mgc: 0.0002068499 ustep: 1 
iter: 3  mgc: 1.785283e-10 
iter: 1  mgc: 1.785283e-10 
outer mgc:  2.131423 
iter: 1  value: 1210.792 mgc: 0.3505331 ustep: 1 
iter: 2  value: 1210.792 mgc: 0.000605048 ustep: 1 
iter: 3  mgc: 2.637091e-09 
iter: 1  mgc: 2.637091e-09 
outer mgc:  4.515971 
iter: 1  value: 1210.545 mgc: 0.3189756 ustep: 1 
iter: 2  value: 1210.545 mgc: 0.0002892568 ustep: 1 
iter: 3  mgc: 3.099956e-10 
iter: 1  mgc: 3.099956e-10 
outer mgc:  2.564908 
iter: 1  value: 1210.364 mgc: 0.2906358 ustep: 1 
iter: 2  value: 1210.364 mgc: 0.0001857852 ustep: 1 
iter: 3  mgc: 2.020112e-10 
iter: 1  mgc: 2.020112e-10 
outer mgc:  4.638698 
iter: 1  value: 1210.318 mgc: 0.2043292 ustep: 1 
iter: 2  value: 1210.318 mgc: 6.04122e-05 ustep: 1 
iter: 3  mgc: 1.131184e-11 
iter: 1  mgc: 1.131184e-11 
outer mgc:  1.059766 
iter: 1  value: 1210.25 mgc: 0.1085884 ustep: 1 
iter: 2  value: 1210.25 mgc: 3.53936e-05 ustep: 1 
iter: 3  mgc: 3.908873e-12 
iter: 1  mgc: 3.908873e-12 
outer mgc:  0.9548781 
iter: 1  value: 1209.87 mgc: 0.1729598 ustep: 1 
iter: 2  value: 1209.87 mgc: 0.0001287814 ustep: 1 
iter: 3  mgc: 9.04139e-11 
iter: 1  mgc: 9.04139e-11 
outer mgc:  0.9368797 
iter: 1  value: 1209.75 mgc: 0.1398934 ustep: 1 
iter: 2  value: 1209.75 mgc: 3.576933e-05 ustep: 1 
iter: 3  mgc: 2.406964e-12 
iter: 1  mgc: 2.406964e-12 
outer mgc:  0.7659875 
iter: 1  value: 1209.694 mgc: 0.09299196 ustep: 1 
iter: 2  value: 1209.694 mgc: 2.073724e-05 ustep: 1 
iter: 3  mgc: 3.80207e-12 
iter: 1  value: 1209.727 mgc: 0.06112635 ustep: 1 
iter: 2  value: 1209.727 mgc: 7.615218e-06 ustep: 1 
iter: 3  mgc: 3.943512e-13 
iter: 1  mgc: 3.943512e-13 
outer mgc:  0.5291379 
iter: 1  value: 1209.793 mgc: 0.1122164 ustep: 1 
iter: 2  value: 1209.793 mgc: 3.781787e-05 ustep: 1 
iter: 3  mgc: 1.473732e-11 
iter: 1  value: 1209.752 mgc: 0.04173339 ustep: 1 
iter: 2  value: 1209.752 mgc: 5.452318e-06 ustep: 1 
iter: 3  mgc: 3.366196e-13 
iter: 1  mgc: 3.366196e-13 
outer mgc:  0.2966019 
iter: 1  value: 1209.744 mgc: 0.02118864 ustep: 1 
iter: 2  value: 1209.744 mgc: 1.279525e-06 ustep: 1 
iter: 3  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  0.1720783 
iter: 1  value: 1209.71 mgc: 0.0271964 ustep: 1 
iter: 2  value: 1209.71 mgc: 2.73958e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
iter: 1  mgc: 5.77316e-14 
outer mgc:  0.1560006 
iter: 1  value: 1209.724 mgc: 0.01880527 ustep: 1 
iter: 2  value: 1209.724 mgc: 4.77951e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  0.0877199 
iter: 1  value: 1209.725 mgc: 0.009286733 ustep: 1 
iter: 2  value: 1209.725 mgc: 3.572429e-07 ustep: 1 
iter: 3  mgc: 2.275957e-14 
iter: 1  value: 1209.724 mgc: 0.004080279 ustep: 1 
iter: 2  value: 1209.724 mgc: 6.895983e-08 ustep: 1 
iter: 3  mgc: 3.480549e-14 
iter: 1  mgc: 3.480549e-14 
outer mgc:  0.04146952 
iter: 1  value: 1209.725 mgc: 0.003414445 ustep: 1 
iter: 2  value: 1209.725 mgc: 1.552839e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  0.01494441 
iter: 1  value: 1209.724 mgc: 0.001004006 ustep: 1 
iter: 2  mgc: 1.158281e-09 
iter: 1  mgc: 1.158281e-09 
outer mgc:  0.001064533 
iter: 1  value: 1209.724 mgc: 0.0001363463 ustep: 1 
iter: 2  mgc: 5.057998e-11 
iter: 1  mgc: 5.057998e-11 
outer mgc:  0.0003691744 
iter: 1  mgc: 5.057998e-11 
iter: 1  mgc: 5.057998e-11 
outer mgc:  0.0003691744 
iter: 1  value: 1209.723 mgc: 0.0490499 ustep: 1 
iter: 2  value: 1209.723 mgc: 4.918753e-06 ustep: 1 
iter: 3  mgc: 9.170442e-14 
outer mgc:  1.044456 
iter: 1  value: 1209.727 mgc: 0.04903234 ustep: 1 
iter: 2  value: 1209.727 mgc: 4.922856e-06 ustep: 1 
iter: 3  mgc: 8.570922e-14 
outer mgc:  1.044914 
iter: 1  value: 1209.723 mgc: 0.02258043 ustep: 1 
iter: 2  value: 1209.723 mgc: 1.016349e-06 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.9920602 
iter: 1  value: 1209.727 mgc: 0.02256906 ustep: 1 
iter: 2  value: 1209.727 mgc: 1.016143e-06 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.9922987 
iter: 1  value: 1209.726 mgc: 0.05183605 ustep: 1 
iter: 2  value: 1209.726 mgc: 4.924867e-06 ustep: 1 
iter: 3  mgc: 9.13089e-14 
outer mgc:  1.112957 
iter: 1  value: 1209.724 mgc: 0.05182481 ustep: 1 
iter: 2  value: 1209.724 mgc: 4.931258e-06 ustep: 1 
iter: 3  mgc: 1.14353e-13 
outer mgc:  1.112212 
iter: 1  value: 1209.728 mgc: 0.02967813 ustep: 1 
iter: 2  value: 1209.728 mgc: 1.942852e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  1.275968 
iter: 1  value: 1209.722 mgc: 0.02967666 ustep: 1 
iter: 2  value: 1209.722 mgc: 1.943666e-06 ustep: 1 
iter: 3  mgc: 2.708944e-14 
outer mgc:  1.276089 
iter: 1  value: 1209.707 mgc: 0.007197682 ustep: 1 
iter: 2  value: 1209.707 mgc: 1.004862e-07 ustep: 1 
mgc: 2.664535e-14 
outer mgc:  0.0115513 
iter: 1  value: 1209.742 mgc: 0.007194378 ustep: 1 
iter: 2  value: 1209.742 mgc: 1.005164e-07 ustep: 1 
mgc: 2.575717e-14 
outer mgc:  0.01181683 
iter: 1  value: 1209.752 mgc: 0.02775834 ustep: 1 
iter: 2  value: 1209.752 mgc: 3.404907e-06 ustep: 1 
iter: 3  mgc: 9.05942e-14 
outer mgc:  0.3371679 
iter: 1  value: 1209.697 mgc: 0.02783604 ustep: 1 
iter: 2  value: 1209.697 mgc: 3.412571e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
outer mgc:  0.3375592 
iter: 1  value: 1209.749 mgc: 0.0268939 ustep: 1 
iter: 2  value: 1209.749 mgc: 2.490771e-06 ustep: 1 
iter: 3  mgc: 5.062617e-14 
outer mgc:  0.3470712 
iter: 1  value: 1209.7 mgc: 0.026971 ustep: 1 
iter: 2  value: 1209.7 mgc: 2.495517e-06 ustep: 1 
iter: 3  mgc: 4.840572e-14 
outer mgc:  0.347145 
[Sun Aug 15 22:31:08 2021]
Finished job 0.
1 of 1 steps (100%) done

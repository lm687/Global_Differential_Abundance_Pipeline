Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:40:20 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2197.224577 
iter  10 value 1517.538370
final  value 1517.505669 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1653.805 mgc: 3.962996 ustep: 1 
iter: 2  value: 1650.884 mgc: 2.071261 ustep: 1 
iter: 3  value: 1648.96 mgc: 1.205836 ustep: 1 
iter: 4  value: 1648.956 mgc: 0.05620344 ustep: 1 
iter: 5  value: 1648.956 mgc: 0.0003969046 ustep: 1 
iter: 6  value: 1648.956 mgc: 4.064379e-08 ustep: 1 
iter: 7  mgc: 1.609823e-15 
iter: 1  mgc: 1.609823e-15 
Matching hessian patterns... Done
outer mgc:  25.74532 
iter: 1  value: 1633.093 mgc: 0.4399287 ustep: 1 
iter: 2  value: 1633.091 mgc: 0.02985566 ustep: 1 
iter: 3  value: 1633.091 mgc: 9.390714e-05 ustep: 1 
iter: 4  mgc: 1.228256e-09 
iter: 1  mgc: 1.228256e-09 
outer mgc:  10.63071 
iter: 1  value: 1616.147 mgc: 1.410554 ustep: 1 
iter: 2  value: 1616.144 mgc: 0.05873643 ustep: 1 
iter: 3  value: 1616.144 mgc: 0.0001632502 ustep: 1 
iter: 4  mgc: 1.132162e-09 
iter: 1  value: 1571.66 mgc: 13.91071 ustep: 1 
iter: 2  value: 1570.461 mgc: 1.037296 ustep: 1 
iter: 3  value: 1570.461 mgc: 0.009406354 ustep: 1 
iter: 4  value: 1570.461 mgc: 3.949355e-06 ustep: 1 
iter: 5  mgc: 5.96613e-13 
iter: 1  mgc: 5.96613e-13 
outer mgc:  10.29626 
iter: 1  value: 1536.02 mgc: 25.33525 ustep: 1 
iter: 2  value: 1536.02 mgc: 0.03795952 ustep: 1 
iter: 3  value: 1536.02 mgc: 2.465076e-07 ustep: 1 
iter: 4  mgc: 3.358425e-15 
iter: 1  mgc: 3.358425e-15 
outer mgc:  15.5236 
iter: 1  value: 1531.23 mgc: 63.03637 ustep: 1 
iter: 2  value: 1531.23 mgc: 0.0003836451 ustep: 1 
iter: 3  mgc: 2.193357e-12 
iter: 1  value: 1526.544 mgc: 2.827768 ustep: 1 
iter: 2  value: 1526.544 mgc: 0.002700152 ustep: 1 
iter: 3  mgc: 4.405841e-09 
iter: 1  mgc: 4.405841e-09 
outer mgc:  22.34385 
iter: 1  value: 1543.178 mgc: 5.933842 ustep: 1 
iter: 2  value: 1543.178 mgc: 0.0485129 ustep: 1 
iter: 3  value: 1543.178 mgc: 2.927604e-07 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  value: 1516.627 mgc: 2.30325 ustep: 1 
iter: 2  value: 1516.627 mgc: 0.001832626 ustep: 1 
iter: 3  mgc: 3.430838e-09 
iter: 1  mgc: 3.430838e-09 
outer mgc:  6.769226 
iter: 1  value: 1512.929 mgc: 1.547417 ustep: 1 
iter: 2  value: 1512.929 mgc: 0.001099258 ustep: 1 
iter: 3  mgc: 1.312172e-09 
iter: 1  mgc: 1.312172e-09 
outer mgc:  12.7892 
iter: 1  value: 1502.522 mgc: 2.068878 ustep: 1 
iter: 2  value: 1502.522 mgc: 0.002287508 ustep: 1 
iter: 3  mgc: 6.367152e-09 
iter: 1  value: 1529.695 mgc: 8.189054 ustep: 1 
iter: 2  value: 1529.695 mgc: 0.01395639 ustep: 1 
iter: 3  value: 1529.695 mgc: 6.221929e-08 ustep: 1 
mgc: 9.769963e-15 
iter: 1  mgc: 6.367152e-09 
outer mgc:  6.269556 
iter: 1  value: 1506.935 mgc: 7.927794 ustep: 1 
iter: 2  value: 1506.935 mgc: 0.003141764 ustep: 1 
iter: 3  mgc: 2.783133e-09 
iter: 1  value: 1501.362 mgc: 2.569042 ustep: 1 
iter: 2  value: 1501.362 mgc: 0.0006082267 ustep: 1 
iter: 3  mgc: 4.067746e-10 
iter: 1  mgc: 4.067746e-10 
outer mgc:  13.89788 
iter: 1  value: 1497.225 mgc: 2.080985 ustep: 1 
iter: 2  value: 1497.225 mgc: 0.0007891316 ustep: 1 
iter: 3  mgc: 4.254567e-10 
iter: 1  mgc: 4.254567e-10 
outer mgc:  5.373656 
iter: 1  value: 1492.023 mgc: 1.873612 ustep: 1 
iter: 2  value: 1492.023 mgc: 0.0002944873 ustep: 1 
iter: 3  mgc: 7.821996e-11 
iter: 1  value: 1487.794 mgc: 1.383876 ustep: 1 
iter: 2  value: 1487.794 mgc: 0.000179248 ustep: 1 
iter: 3  mgc: 2.866096e-11 
iter: 1  mgc: 2.866096e-11 
outer mgc:  14.27668 
iter: 1  value: 1493.613 mgc: 3.318937 ustep: 1 
iter: 2  value: 1493.613 mgc: 0.003370165 ustep: 1 
iter: 3  mgc: 7.533516e-09 
iter: 1  value: 1486.073 mgc: 3.178241 ustep: 1 
iter: 2  value: 1486.073 mgc: 0.001296749 ustep: 1 
iter: 3  mgc: 7.325522e-10 
iter: 1  mgc: 7.325522e-10 
outer mgc:  12.86552 
iter: 1  value: 1486.489 mgc: 2.947781 ustep: 1 
iter: 2  value: 1486.489 mgc: 0.0005526573 ustep: 1 
iter: 3  mgc: 4.091483e-11 
iter: 1  value: 1485.444 mgc: 2.429983 ustep: 1 
iter: 2  value: 1485.444 mgc: 0.0003619761 ustep: 1 
iter: 3  mgc: 2.246217e-11 
iter: 1  mgc: 2.246217e-11 
outer mgc:  10.44708 
iter: 1  value: 1484.827 mgc: 1.23137 ustep: 1 
iter: 2  value: 1484.827 mgc: 0.0001898657 ustep: 1 
iter: 3  mgc: 3.267231e-11 
iter: 1  mgc: 3.267231e-11 
outer mgc:  4.180609 
iter: 1  value: 1484.635 mgc: 2.060846 ustep: 1 
iter: 2  value: 1484.635 mgc: 0.0004849385 ustep: 1 
iter: 3  mgc: 2.070137e-10 
iter: 1  mgc: 2.070137e-10 
outer mgc:  12.09618 
iter: 1  value: 1484.077 mgc: 1.96473 ustep: 1 
iter: 2  value: 1484.077 mgc: 0.0003746922 ustep: 1 
iter: 3  mgc: 3.168266e-11 
iter: 1  mgc: 3.168266e-11 
outer mgc:  3.05475 
iter: 1  value: 1484.772 mgc: 3.83949 ustep: 1 
iter: 2  value: 1484.772 mgc: 0.004395769 ustep: 1 
iter: 3  mgc: 2.550942e-09 
iter: 1  value: 1486.771 mgc: 6.341174 ustep: 1 
iter: 2  value: 1486.771 mgc: 0.05254327 ustep: 1 
iter: 3  value: 1486.771 mgc: 3.513454e-06 ustep: 1 
iter: 4  mgc: 8.282264e-14 
iter: 1  mgc: 8.282264e-14 
outer mgc:  9.225521 
iter: 1  value: 1491.69 mgc: 7.097743 ustep: 1 
iter: 2  value: 1491.689 mgc: 0.2331235 ustep: 1 
iter: 3  value: 1491.689 mgc: 7.191052e-05 ustep: 1 
iter: 4  mgc: 3.441336e-11 
iter: 1  mgc: 3.441336e-11 
outer mgc:  10.35978 
iter: 1  value: 1497.6 mgc: 12.17253 ustep: 1 
iter: 2  value: 1497.597 mgc: 0.3171729 ustep: 1 
iter: 3  value: 1497.597 mgc: 0.0003205639 ustep: 1 
iter: 4  mgc: 4.689653e-10 
iter: 1  value: 1491.947 mgc: 7.214078 ustep: 1 
iter: 2  value: 1491.947 mgc: 0.02973617 ustep: 1 
iter: 3  value: 1491.947 mgc: 1.468701e-06 ustep: 1 
iter: 4  mgc: 1.407763e-13 
iter: 1  mgc: 1.407763e-13 
outer mgc:  9.399001 
iter: 1  value: 1493.436 mgc: 3.086302 ustep: 1 
iter: 2  value: 1493.436 mgc: 0.08773515 ustep: 1 
iter: 3  value: 1493.436 mgc: 6.674779e-06 ustep: 1 
iter: 4  mgc: 8.739676e-13 
iter: 1  mgc: 8.739676e-13 
outer mgc:  3.717608 
iter: 1  value: 1493.603 mgc: 9.619026 ustep: 1 
iter: 2  value: 1493.603 mgc: 0.1049669 ustep: 1 
iter: 3  value: 1493.603 mgc: 1.493521e-05 ustep: 1 
iter: 4  mgc: 1.887379e-12 
iter: 1  value: 1493.25 mgc: 5.346991 ustep: 1 
iter: 2  value: 1493.25 mgc: 0.02763733 ustep: 1 
iter: 3  value: 1493.25 mgc: 1.446248e-06 ustep: 1 
iter: 4  mgc: 1.99174e-13 
iter: 1  mgc: 1.99174e-13 
outer mgc:  7.991715 
iter: 1  value: 1491.669 mgc: 4.302465 ustep: 1 
iter: 2  value: 1491.669 mgc: 0.0121895 ustep: 1 
iter: 3  value: 1491.669 mgc: 2.285243e-07 ustep: 1 
iter: 4  mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  2.791978 
iter: 1  value: 1491.098 mgc: 2.686108 ustep: 1 
iter: 2  value: 1491.098 mgc: 0.01151565 ustep: 1 
iter: 3  value: 1491.098 mgc: 2.391959e-06 ustep: 1 
iter: 4  mgc: 1.311173e-13 
iter: 1  mgc: 1.311173e-13 
outer mgc:  3.476046 
iter: 1  value: 1489.442 mgc: 2.084172 ustep: 1 
iter: 2  value: 1489.442 mgc: 0.001481795 ustep: 1 
iter: 3  value: 1489.442 mgc: 1.396866e-08 ustep: 1 
mgc: 2.831069e-13 
iter: 1  mgc: 2.831069e-13 
outer mgc:  1.261236 
iter: 1  value: 1488.082 mgc: 0.8820506 ustep: 1 
iter: 2  value: 1488.082 mgc: 0.0006768509 ustep: 1 
iter: 3  mgc: 1.131129e-09 
iter: 1  value: 1484.956 mgc: 2.867104 ustep: 1 
iter: 2  value: 1484.956 mgc: 0.003800216 ustep: 1 
iter: 3  value: 1484.956 mgc: 3.987396e-08 ustep: 1 
mgc: 3.375078e-13 
iter: 1  mgc: 3.375078e-13 
outer mgc:  4.461162 
iter: 1  value: 1483.388 mgc: 2.466195 ustep: 1 
iter: 2  value: 1483.388 mgc: 0.02306815 ustep: 1 
iter: 3  value: 1483.388 mgc: 2.856371e-06 ustep: 1 
iter: 4  mgc: 4.103384e-13 
iter: 1  mgc: 4.103384e-13 
outer mgc:  2.853176 
iter: 1  value: 1481.837 mgc: 7.745173 ustep: 1 
iter: 2  value: 1481.837 mgc: 0.00277472 ustep: 1 
iter: 3  mgc: 6.681578e-09 
iter: 1  mgc: 6.681578e-09 
outer mgc:  1.851232 
iter: 1  value: 1480.384 mgc: 4.491017 ustep: 1 
iter: 2  value: 1480.384 mgc: 0.001216212 ustep: 1 
iter: 3  mgc: 1.891142e-09 
iter: 1  mgc: 1.891142e-09 
outer mgc:  1.469088 
iter: 1  value: 1478.98 mgc: 2.04753 ustep: 1 
iter: 2  value: 1478.98 mgc: 0.0002467901 ustep: 1 
iter: 3  mgc: 1.16207e-09 
iter: 1  mgc: 1.16207e-09 
outer mgc:  0.4142205 
iter: 1  value: 1477.023 mgc: 3.41171 ustep: 1 
iter: 2  value: 1477.023 mgc: 0.0001561873 ustep: 1 
iter: 3  mgc: 3.507861e-11 
iter: 1  mgc: 3.507861e-11 
outer mgc:  0.0997898 
iter: 1  value: 1475.456 mgc: 6.02131 ustep: 1 
iter: 2  value: 1475.456 mgc: 0.0002276556 ustep: 1 
iter: 3  mgc: 7.918866e-11 
iter: 1  mgc: 7.918866e-11 
outer mgc:  0.3288991 
iter: 1  value: 1474.077 mgc: 8.515679 ustep: 1 
iter: 2  value: 1474.077 mgc: 0.0003122697 ustep: 1 
iter: 3  mgc: 3.840057e-10 
iter: 1  mgc: 3.840057e-10 
outer mgc:  0.165786 
iter: 1  value: 1472.865 mgc: 3.043512 ustep: 1 
iter: 2  value: 1472.865 mgc: 1.635362e-05 ustep: 0.9999 
iter: 3  mgc: 1.047793e-10 
iter: 1  mgc: 1.047793e-10 
outer mgc:  0.07004943 
iter: 1  value: 1470.891 mgc: 3.762228 ustep: 1 
iter: 2  value: 1470.891 mgc: 1.411458e-05 ustep: 1 
iter: 3  mgc: 5.900733e-10 
iter: 1  mgc: 5.900733e-10 
outer mgc:  0.04864006 
iter: 1  value: 1469.21 mgc: 2.892423 ustep: 1 
iter: 2  value: 1469.21 mgc: 4.304276e-06 ustep: 1 
iter: 3  mgc: 2.947748e-09 
iter: 1  mgc: 2.947748e-09 
outer mgc:  0.04249179 
iter: 1  value: 1467.194 mgc: 4.192708 ustep: 1 
iter: 2  value: 1467.194 mgc: 5.338146e-06 ustep: 0.989901 
iter: 3  value: 1467.194 mgc: 5.23235e-08 ustep: 7.851799e-08 
mgc: 3.708044e-08 
iter: 1  value: 1467.194 mgc: 3.708044e-08 ustep: 0.01776843 
mgc: 4.158138e-08 
outer mgc:  0.06092752 
iter: 1  value: 1465.478 mgc: 3.227789 ustep: 1 
iter: 2  value: 1465.478 mgc: 1.438982e-06 ustep: 1 
iter: 3  value: 1465.478 mgc: 6.147333e-07 ustep: 0.9999 
iter: 4  value: 1465.478 mgc: 2.265763e-07 ustep: 0.9152321 
iter: 5  value: 1465.478 mgc: 4.086884e-07 ustep: 0.9566819 
iter: 6  value: 1465.478 mgc: 4.908913e-07 ustep: 0.9781034 
iter: 7  value: 1465.478 mgc: 5.282962e-07 ustep: 0.002195958 
mgc: 4.104309e-07 
iter: 1  value: 1465.478 mgc: 4.104309e-07 ustep: 1.066041e-09 
mgc: 4.104252e-07 
outer mgc:  0.03142922 
iter: 1  value: 1463.42 mgc: 4.340736 ustep: 1 
iter: 2  value: 1463.417 mgc: 1.209963e-05 ustep: 1 
iter: 3  value: 1463.412 mgc: 1.730113e-05 ustep: 0.9999 
iter: 4  value: 1463.412 mgc: 2.658051e-05 ustep: 8.942398e-12 
mgc: 2.65805e-05 
iter: 1  value: 1463.412 mgc: 2.65805e-05 ustep: 0.03522464 
iter: 2  value: 1463.411 mgc: 1.534049e-05 ustep: 1.930991e-10 
mgc: 1.210888e-05 
outer mgc:  0.02602587 
iter: 1  value: 1461.688 mgc: 2.909544 ustep: 1 
iter: 2  value: 1461.607 mgc: 0.000384488 ustep: 0.9999 
iter: 3  value: 1461.601 mgc: 0.0002910489 ustep: 0.0006014944 
iter: 4  value: 1461.601 mgc: 0.0003640162 ustep: 5.786187e-12 
mgc: 0.0003715515 
iter: 1  value: 1461.601 mgc: 0.0003715515 ustep: 1.040016e-12 
mgc: 0.0004624961 
outer mgc:  0.008659745 
iter: 1  value: -55808 mgc: 150.0621 ustep: 0.9999 
iter: 2  value: -84480 mgc: 248.6167 ustep: 0.99995 
iter: 3  value: -120832 mgc: 300.1317 ustep: 0.2807898 
iter: 4  value: -122880 mgc: 732.03 ustep: 1.067812e-14 
mgc: 241.1524 
iter: 1  value: -122880 mgc: 241.1524 ustep: 1.584401e-17 
mgc: 332.8943 
outer mgc:  4116.743 
iter: 1  value: -1.279382e+37 mgc: 1.221456e+47 ustep: 0.9999 
iter: 2  value: -1.279382e+37 mgc: 3.34759e+31 ustep: 0.99995 
mgc: 3.716541e+15 
iter: 1  value: -1.860919e+37 mgc: 3.716541e+15 ustep: 1 
iter: 2  value: -1.860919e+37 mgc: 0.2924553 ustep: 0.9999 
mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  value: -7.809214e+36 mgc: 3.716584e+15 ustep: 0.9999 
mgc: 0.265842 
iter: 1  value: -1.860919e+37 mgc: 3.716541e+15 ustep: 1 
iter: 2  value: -1.860919e+37 mgc: 0.2924553 ustep: 0.9999 
mgc: 4.318188e-12 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  2.068212e-10 
iter: 1  value: -1.860919e+37 mgc: 40.65131 ustep: 0.9999 
mgc: 4.313872e-12 
outer mgc:  6.445866e-11 
iter: 1  value: -1.860919e+37 mgc: 40.77345 ustep: 0.9999 
mgc: 4.322509e-12 
outer mgc:  1.082974e-10 
iter: 1  value: -1.860919e+37 mgc: 40.69198 ustep: 0.9999 
mgc: 4.318188e-12 
outer mgc:  1.088161e-10 
iter: 1  value: -1.860919e+37 mgc: 40.73269 ustep: 0.9999 
mgc: 4.318188e-12 
outer mgc:  7.007905e-11 
iter: 1  value: -1.860919e+37 mgc: 5.413298e-06 ustep: 0.9999 
mgc: 2.159094e-12 
outer mgc:  1.11859e-10 
iter: 1  value: -1.860919e+37 mgc: 5.413294e-06 ustep: 0.9999 
mgc: 4.318188e-12 
outer mgc:  4.977529e-11 
iter: 1  mgc: 4.318188e-12 
outer mgc:  1.36378e-10 
iter: 1  mgc: 4.318188e-12 
outer mgc:  1.36378e-10 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:40:22 2021]
Finished job 0.
1 of 1 steps (100%) done

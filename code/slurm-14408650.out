Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:19:11 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.02_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.02_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.02_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22056.838920 
final  value 21152.613538 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 12546.6 mgc: 83.70546 ustep: 0.8994163 
iter: 2  value: 7792.027 mgc: 84.23402 ustep: 0.1690026 
iter: 3  value: 7110.891 mgc: 160.2869 ustep: 0.4111581 
iter: 4  value: 4007.758 mgc: 90.80067 ustep: 0.1202319 
iter: 5  value: 3327.015 mgc: 113.9018 ustep: 0.1917791 
iter: 6  value: 2638.008 mgc: 131.0881 ustep: 0.06947296 
iter: 7  value: 2484.407 mgc: 67.59149 ustep: 0.07364385 
iter: 8  value: 2466.645 mgc: 40.23817 ustep: 0.2714469 
iter: 9  value: 2466.569 mgc: 2.402709 ustep: 0.5210535 
iter: 10  value: 2466.569 mgc: 0.06337649 ustep: 0.7218682 
iter: 11  value: 2466.569 mgc: 0.000821265 ustep: 0.8496433 
iter: 12  value: 2466.569 mgc: 1.931561e-05 ustep: 0.9217688 
iter: 13  value: 2466.569 mgc: 2.969088e-07 ustep: 0.9600919 
iter: 14  mgc: 2.565727e-09 
iter: 1  mgc: 2.565727e-09 
Matching hessian patterns... Done
outer mgc:  475.0352 
iter: 1  value: 2506.818 mgc: 31.69789 ustep: 1 
iter: 2  value: 2503.162 mgc: 3.743494 ustep: 1 
iter: 3  value: 2503.161 mgc: 0.08841082 ustep: 1 
iter: 4  value: 2503.161 mgc: 0.0001187391 ustep: 1 
iter: 5  mgc: 4.46057e-10 
iter: 1  value: 2352.053 mgc: 15.09932 ustep: 1 
iter: 2  value: 2351.871 mgc: 0.8059315 ustep: 1 
iter: 3  value: 2351.871 mgc: 0.005189879 ustep: 1 
iter: 4  value: 2351.871 mgc: 4.094327e-07 ustep: 1 
iter: 5  mgc: 3.459733e-14 
iter: 1  mgc: 3.459733e-14 
outer mgc:  162.7914 
iter: 1  value: 2323.824 mgc: 9.096613 ustep: 1 
iter: 2  value: 2323.751 mgc: 0.3468708 ustep: 1 
iter: 3  value: 2323.751 mgc: 0.001064819 ustep: 1 
iter: 4  value: 2323.751 mgc: 1.592847e-08 ustep: 1 
mgc: 3.202993e-14 
iter: 1  mgc: 3.202993e-14 
outer mgc:  171.2619 
iter: 1  value: 2288.124 mgc: 14.34128 ustep: 1 
iter: 2  value: 2287.306 mgc: 1.133317 ustep: 1 
iter: 3  value: 2287.306 mgc: 0.01532173 ustep: 1 
iter: 4  value: 2287.306 mgc: 6.736732e-06 ustep: 1 
iter: 5  mgc: 1.696643e-12 
iter: 1  mgc: 1.696643e-12 
outer mgc:  157.1093 
iter: 1  value: 2253.651 mgc: 9.972809 ustep: 1 
iter: 2  value: 2253.523 mgc: 0.5325498 ustep: 1 
iter: 3  value: 2253.523 mgc: 0.003836797 ustep: 1 
iter: 4  value: 2253.523 mgc: 2.696511e-07 ustep: 1 
iter: 5  mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  94.23462 
iter: 1  value: 2232.982 mgc: 17.1172 ustep: 1 
iter: 2  value: 2230.415 mgc: 1.684919 ustep: 1 
iter: 3  value: 2230.414 mgc: 0.02397044 ustep: 1 
iter: 4  value: 2230.414 mgc: 1.058561e-05 ustep: 1 
iter: 5  mgc: 2.429612e-12 
iter: 1  mgc: 2.429612e-12 
outer mgc:  49.92768 
iter: 1  value: 2220.88 mgc: 13.68617 ustep: 1 
iter: 2  value: 2220.574 mgc: 0.6441784 ustep: 1 
iter: 3  value: 2220.574 mgc: 0.008143444 ustep: 1 
iter: 4  value: 2220.574 mgc: 1.753101e-06 ustep: 1 
iter: 5  mgc: 7.727152e-14 
iter: 1  mgc: 7.727152e-14 
outer mgc:  69.6194 
iter: 1  value: 2203.722 mgc: 13.30156 ustep: 1 
iter: 2  value: 2203.171 mgc: 0.9411529 ustep: 1 
iter: 3  value: 2203.171 mgc: 0.007831726 ustep: 1 
iter: 4  value: 2203.171 mgc: 7.46525e-07 ustep: 1 
iter: 5  mgc: 2.464695e-14 
iter: 1  mgc: 2.464695e-14 
outer mgc:  40.06952 
iter: 1  value: 2231.729 mgc: 4.318271 ustep: 1 
iter: 2  value: 2231.727 mgc: 0.09763877 ustep: 1 
iter: 3  value: 2231.727 mgc: 0.0002300605 ustep: 1 
iter: 4  mgc: 1.294947e-09 
iter: 1  value: 2200.051 mgc: 0.6843176 ustep: 1 
iter: 2  value: 2200.051 mgc: 0.005655968 ustep: 1 
iter: 3  value: 2200.051 mgc: 9.72266e-07 ustep: 1 
iter: 4  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  42.30707 
iter: 1  value: 2198.004 mgc: 5.458258 ustep: 1 
iter: 2  value: 2197.999 mgc: 0.09526736 ustep: 1 
iter: 3  value: 2197.999 mgc: 7.484334e-05 ustep: 1 
iter: 4  mgc: 7.126166e-11 
iter: 1  mgc: 7.126166e-11 
outer mgc:  49.26429 
iter: 1  value: 2194.507 mgc: 2.448422 ustep: 1 
iter: 2  value: 2194.506 mgc: 0.03168922 ustep: 1 
iter: 3  value: 2194.506 mgc: 9.660053e-06 ustep: 1 
iter: 4  mgc: 1.303624e-12 
iter: 1  mgc: 1.303624e-12 
outer mgc:  13.54241 
iter: 1  value: 2192.593 mgc: 2.328926 ustep: 1 
iter: 2  value: 2192.593 mgc: 0.02069911 ustep: 1 
iter: 3  value: 2192.593 mgc: 3.87778e-06 ustep: 1 
iter: 4  mgc: 2.255973e-13 
iter: 1  mgc: 2.255973e-13 
outer mgc:  28.90929 
iter: 1  value: 2190.139 mgc: 3.125896 ustep: 1 
iter: 2  value: 2190.137 mgc: 0.05761908 ustep: 1 
iter: 3  value: 2190.137 mgc: 4.129913e-05 ustep: 1 
iter: 4  mgc: 2.311429e-11 
iter: 1  mgc: 2.311429e-11 
outer mgc:  22.47606 
iter: 1  value: 2189.465 mgc: 3.744277 ustep: 1 
iter: 2  value: 2189.463 mgc: 0.0668488 ustep: 1 
iter: 3  value: 2189.463 mgc: 4.965017e-05 ustep: 1 
iter: 4  mgc: 4.033618e-11 
iter: 1  mgc: 4.033618e-11 
outer mgc:  36.83413 
iter: 1  value: 2189.248 mgc: 6.015975 ustep: 1 
iter: 2  value: 2189.242 mgc: 0.1185092 ustep: 1 
iter: 3  value: 2189.242 mgc: 0.0001297522 ustep: 1 
iter: 4  mgc: 2.400866e-10 
iter: 1  mgc: 2.400866e-10 
outer mgc:  18.32856 
iter: 1  value: 2193.125 mgc: 8.929232 ustep: 1 
iter: 2  value: 2193.082 mgc: 0.2555853 ustep: 1 
iter: 3  value: 2193.082 mgc: 0.0004490734 ustep: 1 
iter: 4  mgc: 6.744076e-09 
iter: 1  value: 2188.475 mgc: 3.332396 ustep: 1 
iter: 2  value: 2188.474 mgc: 0.03539218 ustep: 1 
iter: 3  value: 2188.474 mgc: 8.280486e-06 ustep: 1 
iter: 4  mgc: 6.425971e-13 
iter: 1  mgc: 6.425971e-13 
outer mgc:  6.175305 
iter: 1  value: 2189.644 mgc: 1.716891 ustep: 1 
iter: 2  value: 2189.644 mgc: 0.01351779 ustep: 1 
iter: 3  value: 2189.644 mgc: 1.443578e-06 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  value: 2188.428 mgc: 0.3388968 ustep: 1 
iter: 2  value: 2188.428 mgc: 0.0005168226 ustep: 1 
iter: 3  mgc: 2.103791e-09 
iter: 1  mgc: 2.103791e-09 
outer mgc:  4.953795 
iter: 1  value: 2188.371 mgc: 0.5983668 ustep: 1 
iter: 2  value: 2188.371 mgc: 0.001160454 ustep: 1 
iter: 3  value: 2188.371 mgc: 1.393129e-08 ustep: 1 
mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  5.226064 
iter: 1  value: 2188.299 mgc: 0.5214775 ustep: 1 
iter: 2  value: 2188.299 mgc: 0.001523883 ustep: 1 
iter: 3  value: 2188.299 mgc: 2.218456e-08 ustep: 1 
mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  4.796248 
iter: 1  value: 2188.268 mgc: 0.9753398 ustep: 1 
iter: 2  value: 2188.268 mgc: 0.003448381 ustep: 1 
iter: 3  value: 2188.268 mgc: 1.180539e-07 ustep: 1 
iter: 4  mgc: 4.463097e-14 
iter: 1  mgc: 4.463097e-14 
outer mgc:  11.17791 
iter: 1  value: 2188.094 mgc: 0.4452908 ustep: 1 
iter: 2  value: 2188.094 mgc: 0.001076059 ustep: 1 
iter: 3  value: 2188.094 mgc: 1.415037e-08 ustep: 1 
mgc: 3.008704e-14 
iter: 1  mgc: 3.008704e-14 
outer mgc:  2.389772 
iter: 1  value: 2188.028 mgc: 0.6268947 ustep: 1 
iter: 2  value: 2188.028 mgc: 0.001437213 ustep: 1 
iter: 3  value: 2188.028 mgc: 1.338146e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  value: 2188.096 mgc: 0.2922533 ustep: 1 
iter: 2  value: 2188.096 mgc: 0.0002938777 ustep: 1 
iter: 3  mgc: 8.55888e-10 
iter: 1  mgc: 8.55888e-10 
outer mgc:  3.725273 
iter: 1  value: 2188.096 mgc: 0.1354611 ustep: 1 
iter: 2  value: 2188.096 mgc: 5.403098e-05 ustep: 1 
iter: 3  mgc: 3.069667e-11 
iter: 1  mgc: 3.069667e-11 
outer mgc:  0.6756177 
iter: 1  value: 2188.108 mgc: 0.029448 ustep: 1 
iter: 2  value: 2188.108 mgc: 1.33066e-05 ustep: 1 
iter: 3  mgc: 4.968914e-12 
iter: 1  mgc: 4.968914e-12 
outer mgc:  0.6248394 
iter: 1  value: 2188.076 mgc: 0.07122775 ustep: 1 
iter: 2  value: 2188.076 mgc: 1.929378e-05 ustep: 1 
iter: 3  mgc: 3.278267e-12 
iter: 1  mgc: 3.278267e-12 
outer mgc:  0.7647532 
iter: 1  value: 2188.109 mgc: 0.06833828 ustep: 1 
iter: 2  value: 2188.109 mgc: 2.701962e-05 ustep: 1 
iter: 3  mgc: 4.080514e-12 
iter: 1  value: 2188.094 mgc: 0.06603869 ustep: 1 
iter: 2  value: 2188.094 mgc: 1.429396e-05 ustep: 1 
iter: 3  mgc: 1.76148e-12 
iter: 1  mgc: 1.76148e-12 
outer mgc:  0.9403122 
iter: 1  value: 2188.103 mgc: 0.07395222 ustep: 1 
iter: 2  value: 2188.103 mgc: 2.65589e-05 ustep: 1 
iter: 3  mgc: 1.089795e-11 
iter: 1  mgc: 1.089795e-11 
outer mgc:  0.498419 
iter: 1  value: 2188.099 mgc: 0.04314487 ustep: 1 
iter: 2  value: 2188.099 mgc: 9.857502e-06 ustep: 1 
iter: 3  mgc: 1.577405e-12 
iter: 1  mgc: 1.577405e-12 
outer mgc:  0.551183 
iter: 1  value: 2188.071 mgc: 0.05251977 ustep: 1 
iter: 2  value: 2188.071 mgc: 1.03175e-05 ustep: 1 
iter: 3  mgc: 2.676082e-12 
iter: 1  value: 2188.092 mgc: 0.03616996 ustep: 1 
iter: 2  value: 2188.092 mgc: 4.421353e-06 ustep: 1 
iter: 3  mgc: 1.678657e-13 
iter: 1  mgc: 1.678657e-13 
outer mgc:  0.6261599 
iter: 1  value: 2188.089 mgc: 0.02957118 ustep: 1 
iter: 2  value: 2188.089 mgc: 2.817793e-06 ustep: 1 
iter: 3  mgc: 7.138734e-14 
iter: 1  mgc: 7.138734e-14 
outer mgc:  0.08541497 
iter: 1  value: 2188.088 mgc: 0.00653251 ustep: 1 
iter: 2  value: 2188.088 mgc: 1.741508e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
iter: 1  value: 2188.084 mgc: 0.009977962 ustep: 1 
iter: 2  value: 2188.084 mgc: 4.697732e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  0.09083045 
iter: 1  value: 2188.105 mgc: 0.03154224 ustep: 1 
iter: 2  value: 2188.105 mgc: 3.867991e-06 ustep: 1 
iter: 3  mgc: 1.136868e-13 
iter: 1  value: 2188.091 mgc: 0.01972556 ustep: 1 
iter: 2  value: 2188.091 mgc: 1.239611e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.1694841 
iter: 1  value: 2188.1 mgc: 0.02066207 ustep: 1 
iter: 2  value: 2188.1 mgc: 2.385677e-06 ustep: 1 
iter: 3  mgc: 3.541611e-14 
iter: 1  value: 2188.092 mgc: 0.01332401 ustep: 1 
iter: 2  value: 2188.092 mgc: 5.136565e-07 ustep: 1 
iter: 3  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  0.09075131 
iter: 1  value: 2188.09 mgc: 0.003214156 ustep: 1 
iter: 2  value: 2188.09 mgc: 1.485279e-07 ustep: 1 
iter: 3  mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  0.05043796 
iter: 1  value: 2188.091 mgc: 0.001906921 ustep: 1 
iter: 2  value: 2188.091 mgc: 2.390836e-08 ustep: 1 
mgc: 4.085621e-14 
iter: 1  value: 2188.09 mgc: 0.003011777 ustep: 1 
iter: 2  value: 2188.09 mgc: 3.003165e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  value: 2188.09 mgc: 0.001377098 ustep: 1 
iter: 2  mgc: 5.836551e-09 
iter: 1  mgc: 5.836551e-09 
outer mgc:  0.01633365 
iter: 1  value: 2188.089 mgc: 0.003264769 ustep: 1 
iter: 2  value: 2188.089 mgc: 3.240455e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.02594462 
iter: 1  value: 2188.09 mgc: 0.0006968161 ustep: 1 
iter: 2  mgc: 4.530022e-09 
iter: 1  mgc: 4.530022e-09 
outer mgc:  0.009734363 
iter: 1  value: 2188.089 mgc: 0.001375595 ustep: 1 
iter: 2  mgc: 6.662415e-09 
iter: 1  mgc: 6.662415e-09 
outer mgc:  0.004784973 
iter: 1  value: 2188.089 mgc: 0.0006865789 ustep: 1 
iter: 2  mgc: 6.1351e-09 
iter: 1  mgc: 6.1351e-09 
outer mgc:  0.003357716 
iter: 1  value: 2188.089 mgc: 0.001152808 ustep: 1 
iter: 2  mgc: 6.327294e-09 
iter: 1  mgc: 6.327294e-09 
outer mgc:  0.002423107 
iter: 1  mgc: 6.327294e-09 
iter: 1  mgc: 6.327294e-09 
outer mgc:  0.002423107 
iter: 1  value: 2188.088 mgc: 0.04921794 ustep: 1 
iter: 2  value: 2188.088 mgc: 9.008326e-06 ustep: 1 
iter: 3  mgc: 6.503686e-13 
outer mgc:  0.2671241 
iter: 1  value: 2188.091 mgc: 0.0492033 ustep: 1 
iter: 2  value: 2188.091 mgc: 9.019193e-06 ustep: 1 
iter: 3  mgc: 6.432632e-13 
outer mgc:  0.2622761 
iter: 1  value: 2188.089 mgc: 0.02545323 ustep: 1 
iter: 2  value: 2188.089 mgc: 2.974554e-06 ustep: 1 
iter: 3  mgc: 7.005507e-14 
outer mgc:  0.8350188 
iter: 1  value: 2188.09 mgc: 0.02544266 ustep: 1 
iter: 2  value: 2188.09 mgc: 2.974578e-06 ustep: 1 
iter: 3  mgc: 7.349676e-14 
outer mgc:  0.8367592 
iter: 1  value: 2188.09 mgc: 0.05505793 ustep: 1 
iter: 2  value: 2188.09 mgc: 9.382233e-06 ustep: 1 
iter: 3  mgc: 7.36744e-13 
outer mgc:  0.2321325 
iter: 1  value: 2188.088 mgc: 0.05505552 ustep: 1 
iter: 2  value: 2188.088 mgc: 9.392434e-06 ustep: 1 
iter: 3  mgc: 7.438494e-13 
outer mgc:  0.2350567 
iter: 1  value: 2188.091 mgc: 0.03092591 ustep: 1 
iter: 2  value: 2188.091 mgc: 2.993511e-06 ustep: 1 
iter: 3  mgc: 8.482104e-14 
outer mgc:  1.125093 
iter: 1  value: 2188.088 mgc: 0.03092906 ustep: 1 
iter: 2  value: 2188.088 mgc: 2.993825e-06 ustep: 1 
iter: 3  mgc: 7.682743e-14 
outer mgc:  1.120956 
iter: 1  value: 2188.083 mgc: 0.004976894 ustep: 1 
iter: 2  value: 2188.083 mgc: 7.246623e-07 ustep: 1 
iter: 3  mgc: 3.774758e-14 
outer mgc:  0.05947828 
iter: 1  value: 2188.096 mgc: 0.00497188 ustep: 1 
iter: 2  value: 2188.096 mgc: 7.238239e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.0587153 
iter: 1  value: 2188.1 mgc: 0.009516107 ustep: 1 
iter: 2  value: 2188.1 mgc: 2.410863e-06 ustep: 1 
iter: 3  mgc: 1.74083e-13 
outer mgc:  0.231879 
iter: 1  value: 2188.078 mgc: 0.009535453 ustep: 1 
iter: 2  value: 2188.078 mgc: 2.41616e-06 ustep: 1 
iter: 3  mgc: 1.731948e-13 
outer mgc:  0.2328208 
iter: 1  value: 2188.095 mgc: 0.008766771 ustep: 1 
iter: 2  value: 2188.095 mgc: 9.930989e-07 ustep: 1 
iter: 3  mgc: 2.958744e-14 
outer mgc:  0.2569095 
iter: 1  value: 2188.083 mgc: 0.008784857 ustep: 1 
iter: 2  value: 2188.083 mgc: 9.968823e-07 ustep: 1 
iter: 3  mgc: 4.92939e-14 
outer mgc:  0.257657 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:19:13 2021]
Finished job 0.
1 of 1 steps (100%) done

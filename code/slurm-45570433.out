Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 21:31:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.01_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.01_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.01, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.01_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.01_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.01_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.01_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21890.948464 
final  value 21582.825292 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 21634.21 mgc: 2.48926 ustep: 0.6827823 
iter: 2  value: 21628.81 mgc: 1.10405 ustep: 0.8263238 
iter: 3  value: 21628.73 mgc: 0.1111627 ustep: 0.9090326 
iter: 4  value: 21628.73 mgc: 0.00575411 ustep: 0.9534367 
iter: 5  value: 21628.73 mgc: 0.0002118797 ustep: 0.9764432 
iter: 6  value: 21628.73 mgc: 3.884526e-06 ustep: 0.9881526 
iter: 7  value: 21628.73 mgc: 3.564254e-08 ustep: 0.9940592 
iter: 8  mgc: 1.636984e-10 
iter: 1  mgc: 1.636984e-10 
Matching hessian patterns... Done
outer mgc:  177.2786 
iter: 1  value: 21379.59 mgc: 0.6094894 ustep: 1 
iter: 2  value: 21379.59 mgc: 0.03210425 ustep: 1 
iter: 3  value: 21379.59 mgc: 0.0002987665 ustep: 1 
iter: 4  value: 21379.59 mgc: 1.44651e-08 ustep: 1 
iter: 5  mgc: 3.053113e-15 
iter: 1  value: 20908.2 mgc: 4.744006 ustep: 1 
iter: 2  value: 20908.19 mgc: 0.2311283 ustep: 1 
iter: 3  value: 20908.19 mgc: 0.0001938556 ustep: 1 
iter: 4  mgc: 7.695276e-10 
iter: 1  mgc: 7.695276e-10 
outer mgc:  127.1777 
iter: 1  value: 23530.2 mgc: 14.30607 ustep: 1 
iter: 2  value: 23474.6 mgc: 9.037592 ustep: 1 
iter: 3  value: 23474.53 mgc: 0.4261728 ustep: 1 
iter: 4  value: 23474.53 mgc: 0.01780586 ustep: 1 
iter: 5  value: 23474.53 mgc: 3.514011e-05 ustep: 1 
iter: 6  mgc: 1.375451e-10 
iter: 1  value: 20900.13 mgc: 6.657987 ustep: 1 
iter: 2  value: 20899.8 mgc: 0.5643765 ustep: 1 
iter: 3  value: 20899.8 mgc: 0.003497512 ustep: 1 
iter: 4  value: 20899.8 mgc: 1.71165e-07 ustep: 1 
iter: 5  mgc: 5.417888e-14 
iter: 1  mgc: 5.417888e-14 
outer mgc:  173.4444 
iter: 1  value: 20892.84 mgc: 10.86284 ustep: 1 
iter: 2  value: 20892.56 mgc: 0.5295714 ustep: 1 
iter: 3  value: 20892.56 mgc: 0.001450125 ustep: 1 
iter: 4  value: 20892.56 mgc: 1.857573e-08 ustep: 1 
mgc: 4.868328e-14 
iter: 1  mgc: 4.868328e-14 
outer mgc:  153.0224 
iter: 1  value: 20870.32 mgc: 6.943714 ustep: 1 
iter: 2  value: 20870.29 mgc: 0.3204741 ustep: 1 
iter: 3  value: 20870.29 mgc: 0.0005719716 ustep: 1 
iter: 4  mgc: 2.34159e-09 
iter: 1  mgc: 2.34159e-09 
outer mgc:  75.95661 
iter: 1  value: 20859.57 mgc: 8.621124 ustep: 1 
iter: 2  value: 20859.56 mgc: 0.2910988 ustep: 1 
iter: 3  value: 20859.56 mgc: 0.0006105345 ustep: 1 
iter: 4  mgc: 2.841328e-09 
iter: 1  mgc: 2.841328e-09 
outer mgc:  59.8812 
iter: 1  value: 20861.27 mgc: 6.134037 ustep: 1 
iter: 2  value: 20861.27 mgc: 0.1238381 ustep: 1 
iter: 3  value: 20861.27 mgc: 8.305046e-05 ustep: 1 
iter: 4  mgc: 2.025224e-11 
iter: 1  value: 20856.8 mgc: 2.789457 ustep: 1 
iter: 2  value: 20856.8 mgc: 0.03647554 ustep: 1 
iter: 3  value: 20856.8 mgc: 8.788854e-06 ustep: 1 
iter: 4  mgc: 7.078782e-13 
iter: 1  mgc: 7.078782e-13 
outer mgc:  78.25865 
iter: 1  value: 20847.27 mgc: 2.588207 ustep: 1 
iter: 2  value: 20847.27 mgc: 0.02462222 ustep: 1 
iter: 3  value: 20847.27 mgc: 2.86241e-06 ustep: 1 
iter: 4  mgc: 6.017409e-14 
iter: 1  mgc: 6.017409e-14 
outer mgc:  30.69701 
iter: 1  value: 20841.31 mgc: 1.570989 ustep: 1 
iter: 2  value: 20841.31 mgc: 0.01070877 ustep: 1 
iter: 3  value: 20841.31 mgc: 8.15962e-07 ustep: 1 
iter: 4  mgc: 5.417888e-14 
iter: 1  mgc: 5.417888e-14 
outer mgc:  18.23424 
iter: 1  value: 20835.67 mgc: 1.095228 ustep: 1 
iter: 2  value: 20835.67 mgc: 0.005402013 ustep: 1 
iter: 3  value: 20835.67 mgc: 1.958612e-07 ustep: 1 
iter: 4  mgc: 5.684342e-14 
iter: 1  mgc: 5.684342e-14 
outer mgc:  17.60996 
iter: 1  value: 20832.96 mgc: 2.31966 ustep: 1 
iter: 2  value: 20832.96 mgc: 0.02274166 ustep: 1 
iter: 3  value: 20832.96 mgc: 2.764832e-06 ustep: 1 
iter: 4  mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  15.8315 
iter: 1  value: 20834.44 mgc: 3.358584 ustep: 1 
iter: 2  value: 20834.44 mgc: 0.01865478 ustep: 1 
iter: 3  value: 20834.44 mgc: 2.844021e-06 ustep: 1 
iter: 4  mgc: 1.076916e-13 
iter: 1  value: 20832.54 mgc: 1.181624 ustep: 1 
iter: 2  value: 20832.54 mgc: 0.003108083 ustep: 1 
iter: 3  value: 20832.54 mgc: 5.330114e-08 ustep: 1 
mgc: 4.751755e-14 
iter: 1  mgc: 4.751755e-14 
outer mgc:  21.01656 
iter: 1  value: 20831.97 mgc: 0.7147975 ustep: 1 
iter: 2  value: 20831.97 mgc: 0.00218767 ustep: 1 
iter: 3  value: 20831.97 mgc: 3.059419e-08 ustep: 1 
mgc: 5.684342e-14 
iter: 1  mgc: 5.684342e-14 
outer mgc:  9.045752 
iter: 1  value: 20831.46 mgc: 0.4046977 ustep: 1 
iter: 2  value: 20831.46 mgc: 0.0001626628 ustep: 1 
iter: 3  mgc: 1.799253e-10 
iter: 1  mgc: 1.799253e-10 
outer mgc:  6.049761 
iter: 1  value: 20830.75 mgc: 0.2523792 ustep: 1 
iter: 2  value: 20830.75 mgc: 0.0001289873 ustep: 1 
iter: 3  mgc: 1.280585e-10 
iter: 1  mgc: 1.280585e-10 
outer mgc:  5.410551 
iter: 1  value: 20829.06 mgc: 0.5387907 ustep: 1 
iter: 2  value: 20829.06 mgc: 0.0008905917 ustep: 1 
iter: 3  mgc: 5.188316e-09 
iter: 1  value: 20826.66 mgc: 0.8025271 ustep: 1 
iter: 2  value: 20826.66 mgc: 0.001825891 ustep: 1 
iter: 3  value: 20826.66 mgc: 2.170924e-08 ustep: 1 
mgc: 6.594725e-14 
iter: 1  mgc: 6.594725e-14 
outer mgc:  6.192804 
iter: 1  value: 20821.74 mgc: 2.162875 ustep: 1 
iter: 2  value: 20821.74 mgc: 0.01189474 ustep: 1 
iter: 3  value: 20821.74 mgc: 3.999646e-07 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  7.680982 
iter: 1  value: 20820.34 mgc: 0.7963279 ustep: 1 
iter: 2  value: 20820.34 mgc: 0.002325414 ustep: 1 
iter: 3  value: 20820.34 mgc: 2.97234e-08 ustep: 1 
mgc: 7.038814e-14 
iter: 1  value: 20821.29 mgc: 0.7859577 ustep: 1 
iter: 2  value: 20821.29 mgc: 0.001401621 ustep: 1 
iter: 3  mgc: 8.632123e-09 
iter: 1  mgc: 8.632123e-09 
outer mgc:  17.07255 
iter: 1  value: 20821.35 mgc: 1.191343 ustep: 1 
iter: 2  value: 20821.35 mgc: 0.002196815 ustep: 1 
iter: 3  value: 20821.35 mgc: 3.57604e-08 ustep: 1 
mgc: 5.373479e-14 
iter: 1  mgc: 5.373479e-14 
outer mgc:  16.07965 
iter: 1  value: 20821.6 mgc: 0.7251431 ustep: 1 
iter: 2  value: 20821.6 mgc: 0.001022767 ustep: 1 
iter: 3  mgc: 3.051494e-09 
iter: 1  mgc: 3.051494e-09 
outer mgc:  4.830304 
iter: 1  value: 20819.14 mgc: 1.003013 ustep: 1 
iter: 2  value: 20819.14 mgc: 0.001530112 ustep: 1 
iter: 3  mgc: 7.948484e-09 
iter: 1  mgc: 7.948484e-09 
outer mgc:  3.183899 
iter: 1  value: 20816.03 mgc: 0.6741367 ustep: 1 
iter: 2  value: 20816.03 mgc: 0.000379506 ustep: 1 
iter: 3  mgc: 1.522939e-09 
iter: 1  mgc: 1.522939e-09 
outer mgc:  7.813836 
iter: 1  value: 20815.54 mgc: 0.4818701 ustep: 1 
iter: 2  value: 20815.54 mgc: 0.0009626943 ustep: 1 
iter: 3  value: 20815.54 mgc: 2.830741e-08 ustep: 1 
mgc: 6.061818e-14 
iter: 1  mgc: 6.061818e-14 
outer mgc:  9.755475 
iter: 1  value: 20815.21 mgc: 0.3286469 ustep: 1 
iter: 2  value: 20815.21 mgc: 0.0003880506 ustep: 1 
iter: 3  mgc: 1.0845e-09 
iter: 1  mgc: 1.0845e-09 
outer mgc:  4.195816 
iter: 1  value: 20813.62 mgc: 0.6457381 ustep: 1 
iter: 2  value: 20813.62 mgc: 0.001772351 ustep: 1 
iter: 3  value: 20813.62 mgc: 2.74436e-08 ustep: 1 
mgc: 6.039613e-14 
iter: 1  mgc: 6.039613e-14 
outer mgc:  1.732649 
iter: 1  value: 20811.38 mgc: 0.4379964 ustep: 1 
iter: 2  value: 20811.38 mgc: 0.0003246873 ustep: 1 
iter: 3  mgc: 2.400835e-10 
iter: 1  mgc: 2.400835e-10 
outer mgc:  5.912512 
iter: 1  value: 20810.34 mgc: 0.3136229 ustep: 1 
iter: 2  value: 20810.34 mgc: 0.000188206 ustep: 1 
iter: 3  mgc: 1.774936e-10 
iter: 1  mgc: 1.774936e-10 
outer mgc:  7.672066 
iter: 1  value: 20809.13 mgc: 0.3894457 ustep: 1 
iter: 2  value: 20809.13 mgc: 0.000112664 ustep: 1 
iter: 3  mgc: 1.102789e-10 
iter: 1  mgc: 1.102789e-10 
outer mgc:  1.091956 
iter: 1  value: 20807.74 mgc: 0.4835584 ustep: 1 
iter: 2  value: 20807.74 mgc: 0.0001661805 ustep: 1 
iter: 3  mgc: 2.735918e-10 
iter: 1  mgc: 2.735918e-10 
outer mgc:  3.80917 
iter: 1  value: 20807.2 mgc: 0.2181431 ustep: 1 
iter: 2  value: 20807.2 mgc: 0.0001846772 ustep: 1 
iter: 3  mgc: 1.838734e-10 
iter: 1  value: 20806.57 mgc: 0.1906999 ustep: 1 
iter: 2  value: 20806.57 mgc: 0.0002016489 ustep: 1 
iter: 3  mgc: 3.987184e-10 
iter: 1  mgc: 3.987184e-10 
outer mgc:  6.499642 
iter: 1  value: 20803.92 mgc: 0.8847644 ustep: 1 
iter: 2  value: 20803.92 mgc: 0.0006950973 ustep: 1 
iter: 3  mgc: 1.481944e-09 
iter: 1  mgc: 1.481944e-09 
outer mgc:  3.809613 
iter: 1  value: 20799.41 mgc: 0.5516946 ustep: 1 
iter: 2  value: 20799.41 mgc: 0.0005138194 ustep: 1 
iter: 3  mgc: 9.41843e-10 
iter: 1  mgc: 9.41843e-10 
outer mgc:  4.69829 
iter: 1  value: 20796.42 mgc: 0.6658131 ustep: 1 
iter: 2  value: 20796.42 mgc: 0.0003186548 ustep: 1 
iter: 3  mgc: 5.344925e-10 
iter: 1  value: 20792.14 mgc: 1.079337 ustep: 1 
iter: 2  value: 20792.14 mgc: 0.0006307295 ustep: 1 
iter: 3  mgc: 9.924737e-10 
iter: 1  mgc: 9.924737e-10 
outer mgc:  1.059488 
iter: 1  value: 20785.16 mgc: 1.917023 ustep: 1 
iter: 2  value: 20785.16 mgc: 0.001871985 ustep: 1 
iter: 3  value: 20785.16 mgc: 1.657337e-08 ustep: 1 
mgc: 6.306067e-14 
iter: 1  mgc: 6.306067e-14 
outer mgc:  2.28506 
iter: 1  value: 20778.63 mgc: 2.121104 ustep: 1 
iter: 2  value: 20778.63 mgc: 0.001541287 ustep: 1 
iter: 3  mgc: 1.433458e-09 
iter: 1  mgc: 1.433458e-09 
outer mgc:  1.935026 
iter: 1  value: 20772.34 mgc: 1.53312 ustep: 1 
iter: 2  value: 20772.34 mgc: 0.0003635108 ustep: 1 
iter: 3  mgc: 1.098224e-09 
iter: 1  mgc: 1.098224e-09 
outer mgc:  1.293696 
iter: 1  value: 20762.51 mgc: 2.26322 ustep: 1 
iter: 2  value: 20762.51 mgc: 0.0005988901 ustep: 1 
iter: 3  mgc: 2.427084e-09 
iter: 1  mgc: 2.427084e-09 
outer mgc:  0.962556 
iter: 1  value: 20754.72 mgc: 1.989687 ustep: 1 
iter: 2  value: 20754.72 mgc: 0.0006183979 ustep: 1 
iter: 3  mgc: 1.188823e-09 
iter: 1  mgc: 1.188823e-09 
outer mgc:  1.090688 
iter: 1  value: 20750.07 mgc: 1.209811 ustep: 1 
iter: 2  value: 20750.07 mgc: 0.0001882694 ustep: 1 
iter: 3  mgc: 1.223022e-11 
iter: 1  mgc: 1.223022e-11 
outer mgc:  0.2491819 
iter: 1  value: 20745.89 mgc: 0.8638586 ustep: 1 
iter: 2  value: 20745.89 mgc: 5.670943e-05 ustep: 1 
iter: 3  mgc: 8.35243e-12 
iter: 1  mgc: 8.35243e-12 
outer mgc:  0.08846465 
iter: 1  value: 20742.03 mgc: 0.8213298 ustep: 1 
iter: 2  value: 20742.03 mgc: 3.784848e-05 ustep: 1 
iter: 3  mgc: 8.945733e-12 
iter: 1  mgc: 8.945733e-12 
outer mgc:  0.07680437 
iter: 1  value: 20739.87 mgc: 0.4635542 ustep: 1 
iter: 2  value: 20739.87 mgc: 1.134739e-05 ustep: 1 
iter: 3  mgc: 8.917311e-13 
iter: 1  mgc: 8.917311e-13 
outer mgc:  0.01872561 
iter: 1  value: 20739.15 mgc: 0.1512817 ustep: 1 
iter: 2  value: 20739.15 mgc: 1.172752e-06 ustep: 1 
iter: 3  mgc: 7.627232e-14 
iter: 1  mgc: 7.627232e-14 
outer mgc:  0.0009544511 
iter: 1  value: 20739.04 mgc: 0.02234408 ustep: 1 
iter: 2  value: 20739.04 mgc: 2.521136e-08 ustep: 1 
mgc: 6.639134e-14 
iter: 1  mgc: 6.639134e-14 
outer mgc:  0.0006228425 
iter: 1  mgc: 6.639134e-14 
iter: 1  mgc: 6.639134e-14 
outer mgc:  0.0006228425 
iter: 1  value: 20739.05 mgc: 0.02029615 ustep: 1 
iter: 2  value: 20739.05 mgc: 3.033619e-07 ustep: 1 
iter: 3  mgc: 7.327472e-14 
outer mgc:  1.410981 
iter: 1  value: 20739.04 mgc: 0.02028565 ustep: 1 
iter: 2  value: 20739.04 mgc: 3.029839e-07 ustep: 1 
iter: 3  mgc: 7.638334e-14 
outer mgc:  1.4091 
iter: 1  value: 20739.05 mgc: 0.01078976 ustep: 1 
iter: 2  value: 20739.05 mgc: 1.136051e-07 ustep: 1 
iter: 3  mgc: 1.001421e-13 
outer mgc:  0.7683478 
iter: 1  value: 20739.04 mgc: 0.01078518 ustep: 1 
iter: 2  value: 20739.04 mgc: 1.134542e-07 ustep: 1 
iter: 3  mgc: 8.948398e-14 
outer mgc:  0.7685197 
iter: 1  value: 20739.04 mgc: 0.02333771 ustep: 1 
iter: 2  value: 20739.04 mgc: 1.386688e-06 ustep: 1 
iter: 3  mgc: 1.141309e-13 
outer mgc:  1.170865 
iter: 1  value: 20739.05 mgc: 0.02333559 ustep: 1 
iter: 2  value: 20739.05 mgc: 1.386352e-06 ustep: 1 
iter: 3  mgc: 1.154632e-13 
outer mgc:  1.171495 
iter: 1  value: 20739.04 mgc: 0.01210258 ustep: 1 
iter: 2  value: 20739.04 mgc: 3.832496e-07 ustep: 1 
iter: 3  mgc: 8.082424e-14 
outer mgc:  0.7914024 
iter: 1  value: 20739.04 mgc: 0.01210204 ustep: 1 
iter: 2  value: 20739.04 mgc: 3.832567e-07 ustep: 1 
iter: 3  mgc: 6.750156e-14 
outer mgc:  0.7916312 
iter: 1  value: 20739.12 mgc: 0.2809549 ustep: 1 
iter: 2  value: 20739.12 mgc: 5.9831e-06 ustep: 1 
iter: 3  mgc: 8.926193e-14 
outer mgc:  0.2603217 
iter: 1  value: 20738.97 mgc: 0.2817951 ustep: 1 
iter: 2  value: 20738.97 mgc: 5.983674e-06 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.2588126 
iter: 1  value: 20739.08 mgc: 0.2773431 ustep: 1 
iter: 2  value: 20739.08 mgc: 4.215078e-06 ustep: 1 
iter: 3  mgc: 1.474376e-13 
outer mgc:  0.3187286 
iter: 1  value: 20739 mgc: 0.2776206 ustep: 1 
iter: 2  value: 20739 mgc: 4.19968e-06 ustep: 1 
iter: 3  mgc: 1.190159e-13 
outer mgc:  0.3191694 
iter: 1  value: 20739.03 mgc: 0.0025494 ustep: 1 
iter: 2  mgc: 3.077849e-10 
outer mgc:  0.0007218101 
iter: 1  value: 20739.06 mgc: 0.002549058 ustep: 1 
iter: 2  mgc: 3.079901e-10 
outer mgc:  0.0006734967 
iter: 1  value: 20739.02 mgc: 0.005132685 ustep: 1 
iter: 2  value: 20739.02 mgc: 5.650254e-08 ustep: 1 
iter: 3  mgc: 6.966649e-14 
outer mgc:  0.04667247 
iter: 1  value: 20739.07 mgc: 0.00513207 ustep: 1 
iter: 2  value: 20739.07 mgc: 5.654412e-08 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.04674318 
[Sat Aug 14 21:31:59 2021]
Finished job 0.
1 of 1 steps (100%) done

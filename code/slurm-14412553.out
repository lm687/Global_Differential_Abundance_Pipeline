Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:10:26 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.01_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4443.886708 
final  value 4226.335220 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3936.302 mgc: 3.884698 ustep: 0.6827823 
iter: 2  value: 3934.941 mgc: 1.020927 ustep: 0.8263238 
iter: 3  value: 3934.917 mgc: 0.1123933 ustep: 0.9090326 
iter: 4  value: 3934.917 mgc: 0.009538836 ustep: 0.9534367 
iter: 5  value: 3934.917 mgc: 0.0004335763 ustep: 0.9764432 
iter: 6  value: 3934.917 mgc: 9.820085e-06 ustep: 0.9881526 
iter: 7  value: 3934.917 mgc: 1.112118e-07 ustep: 0.9940592 
iter: 8  mgc: 6.301492e-10 
iter: 1  mgc: 6.301492e-10 
Matching hessian patterns... Done
outer mgc:  17.47347 
iter: 1  value: 3898.051 mgc: 1.020138 ustep: 1 
iter: 2  value: 3898.046 mgc: 0.06810076 ustep: 1 
iter: 3  value: 3898.046 mgc: 0.0003814351 ustep: 1 
iter: 4  value: 3898.046 mgc: 1.430401e-08 ustep: 1 
mgc: 2.109424e-15 
iter: 1  value: 3869.758 mgc: 12.98449 ustep: 1 
iter: 2  value: 3869.705 mgc: 0.5744006 ustep: 1 
iter: 3  value: 3869.705 mgc: 0.003029689 ustep: 1 
iter: 4  value: 3869.705 mgc: 4.906883e-07 ustep: 1 
iter: 5  mgc: 9.325873e-15 
iter: 1  mgc: 2.109424e-15 
outer mgc:  15.92249 
iter: 1  value: 3870.102 mgc: 2.541879 ustep: 1 
iter: 2  value: 3870.092 mgc: 0.1365876 ustep: 1 
iter: 3  value: 3870.092 mgc: 0.0006491515 ustep: 1 
iter: 4  value: 3870.092 mgc: 1.945784e-08 ustep: 1 
mgc: 2.470246e-15 
iter: 1  value: 3860.172 mgc: 7.092607 ustep: 1 
iter: 2  value: 3860.166 mgc: 0.1334707 ustep: 1 
iter: 3  value: 3860.166 mgc: 0.0005275674 ustep: 1 
iter: 4  value: 3860.166 mgc: 1.725052e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 2.470246e-15 
outer mgc:  9.378337 
iter: 1  value: 3852.708 mgc: 6.726218 ustep: 1 
iter: 2  value: 3852.699 mgc: 0.2063181 ustep: 1 
iter: 3  value: 3852.699 mgc: 0.0003818609 ustep: 1 
iter: 4  mgc: 2.46992e-09 
iter: 1  mgc: 2.46992e-09 
outer mgc:  25.68737 
iter: 1  value: 3836.899 mgc: 3.678645 ustep: 1 
iter: 2  value: 3836.896 mgc: 0.1121938 ustep: 1 
iter: 3  value: 3836.896 mgc: 0.0001196868 ustep: 1 
iter: 4  mgc: 4.707501e-10 
iter: 1  mgc: 4.707501e-10 
outer mgc:  14.36855 
iter: 1  value: 3827.747 mgc: 6.145201 ustep: 1 
iter: 2  value: 3827.657 mgc: 0.6376228 ustep: 1 
iter: 3  value: 3827.657 mgc: 0.00615529 ustep: 1 
iter: 4  value: 3827.657 mgc: 5.257703e-07 ustep: 1 
iter: 5  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  13.89052 
iter: 1  value: 3824.252 mgc: 24.29465 ustep: 1 
iter: 2  value: 3824.218 mgc: 0.6954263 ustep: 1 
iter: 3  value: 3824.218 mgc: 0.01138159 ustep: 1 
iter: 4  value: 3824.218 mgc: 8.062071e-06 ustep: 1 
iter: 5  mgc: 4.087841e-12 
iter: 1  value: 3825.236 mgc: 6.947942 ustep: 1 
iter: 2  value: 3825.233 mgc: 0.1340033 ustep: 1 
iter: 3  value: 3825.233 mgc: 0.0006104289 ustep: 1 
iter: 4  value: 3825.233 mgc: 1.036312e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  13.35707 
iter: 1  value: 3826.878 mgc: 4.692549 ustep: 1 
iter: 2  value: 3826.878 mgc: 0.05354912 ustep: 1 
iter: 3  value: 3826.878 mgc: 1.196328e-05 ustep: 1 
iter: 4  mgc: 6.771694e-12 
iter: 1  value: 3824.75 mgc: 2.160035 ustep: 1 
iter: 2  value: 3824.75 mgc: 0.0133043 ustep: 1 
iter: 3  value: 3824.75 mgc: 5.245713e-06 ustep: 1 
iter: 4  mgc: 1.441069e-13 
iter: 1  mgc: 1.441069e-13 
outer mgc:  2.310403 
iter: 1  value: 3824.527 mgc: 1.178355 ustep: 1 
iter: 2  value: 3824.527 mgc: 0.03865247 ustep: 1 
iter: 3  value: 3824.527 mgc: 4.127832e-05 ustep: 1 
iter: 4  mgc: 4.581535e-11 
iter: 1  value: 3824.307 mgc: 0.8732624 ustep: 1 
iter: 2  value: 3824.307 mgc: 0.007414902 ustep: 1 
iter: 3  value: 3824.307 mgc: 1.626244e-06 ustep: 1 
iter: 4  mgc: 7.549517e-14 
iter: 1  mgc: 7.549517e-14 
outer mgc:  1.056079 
iter: 1  value: 3823.562 mgc: 0.431688 ustep: 1 
iter: 2  value: 3823.562 mgc: 0.0009877412 ustep: 1 
iter: 3  value: 3823.562 mgc: 3.240802e-08 ustep: 1 
mgc: 6.106227e-15 
iter: 1  value: 3824.073 mgc: 0.3486788 ustep: 1 
iter: 2  value: 3824.073 mgc: 0.0007196062 ustep: 1 
iter: 3  value: 3824.073 mgc: 1.884406e-08 ustep: 1 
mgc: 4.551914e-15 
iter: 1  value: 3824.172 mgc: 0.1692702 ustep: 1 
iter: 2  value: 3824.172 mgc: 0.0001719608 ustep: 1 
iter: 3  mgc: 1.097292e-09 
iter: 1  mgc: 1.097292e-09 
outer mgc:  0.5163429 
iter: 1  value: 3823.942 mgc: 0.167041 ustep: 1 
iter: 2  value: 3823.942 mgc: 0.0001845676 ustep: 1 
iter: 3  mgc: 5.252843e-10 
iter: 1  mgc: 5.252843e-10 
outer mgc:  0.6625002 
iter: 1  value: 3823.745 mgc: 0.09659562 ustep: 1 
iter: 2  value: 3823.745 mgc: 7.99138e-05 ustep: 1 
iter: 3  mgc: 1.772009e-10 
iter: 1  mgc: 1.772009e-10 
outer mgc:  0.2930752 
iter: 1  value: 3823.739 mgc: 0.1312355 ustep: 1 
iter: 2  value: 3823.739 mgc: 0.0002329519 ustep: 1 
iter: 3  mgc: 2.876255e-10 
iter: 1  mgc: 2.876255e-10 
outer mgc:  0.2763859 
iter: 1  value: 3823.454 mgc: 0.3398049 ustep: 1 
iter: 2  value: 3823.454 mgc: 0.0002393151 ustep: 1 
iter: 3  mgc: 8.027179e-11 
iter: 1  mgc: 8.027179e-11 
outer mgc:  0.3436801 
iter: 1  value: 3823.342 mgc: 0.1166654 ustep: 1 
iter: 2  value: 3823.342 mgc: 5.950682e-05 ustep: 1 
iter: 3  mgc: 9.612888e-11 
iter: 1  value: 3823.419 mgc: 0.05070044 ustep: 1 
iter: 2  value: 3823.419 mgc: 1.473121e-05 ustep: 1 
iter: 3  mgc: 4.242051e-12 
iter: 1  mgc: 4.242051e-12 
outer mgc:  0.1454374 
iter: 1  value: 3823.375 mgc: 0.03258391 ustep: 1 
iter: 2  value: 3823.375 mgc: 3.117838e-06 ustep: 1 
iter: 3  mgc: 3.947953e-13 
iter: 1  mgc: 3.947953e-13 
outer mgc:  0.03692523 
iter: 1  value: 3823.31 mgc: 0.0366459 ustep: 1 
iter: 2  value: 3823.31 mgc: 9.028778e-06 ustep: 1 
iter: 3  mgc: 3.733458e-12 
iter: 1  mgc: 3.733458e-12 
outer mgc:  0.1500174 
iter: 1  value: 3823.253 mgc: 0.03850354 ustep: 1 
iter: 2  value: 3823.253 mgc: 4.299984e-06 ustep: 1 
iter: 3  mgc: 6.581402e-13 
iter: 1  value: 3823.159 mgc: 0.0761611 ustep: 1 
iter: 2  value: 3823.159 mgc: 1.12551e-05 ustep: 1 
iter: 3  mgc: 6.550316e-13 
iter: 1  mgc: 6.550316e-13 
outer mgc:  0.1522283 
iter: 1  value: 3822.908 mgc: 0.1561779 ustep: 1 
iter: 2  value: 3822.908 mgc: 7.493421e-05 ustep: 1 
iter: 3  mgc: 1.343228e-10 
iter: 1  mgc: 1.343228e-10 
outer mgc:  0.07418694 
iter: 1  value: 3822.598 mgc: 0.1910505 ustep: 1 
iter: 2  value: 3822.598 mgc: 4.726913e-05 ustep: 1 
iter: 3  mgc: 1.118147e-10 
iter: 1  mgc: 1.118147e-10 
outer mgc:  0.05934355 
iter: 1  value: 3822.253 mgc: 0.2680618 ustep: 1 
iter: 2  value: 3822.253 mgc: 0.0001151507 ustep: 1 
iter: 3  mgc: 1.161569e-10 
iter: 1  value: 3822.475 mgc: 0.09438043 ustep: 1 
iter: 2  value: 3822.475 mgc: 1.494611e-05 ustep: 1 
iter: 3  mgc: 1.968647e-12 
iter: 1  mgc: 1.968647e-12 
outer mgc:  0.02523544 
iter: 1  value: 3822.444 mgc: 0.02197686 ustep: 1 
iter: 2  value: 3822.444 mgc: 2.332287e-06 ustep: 1 
iter: 3  mgc: 1.944001e-13 
iter: 1  mgc: 1.944001e-13 
outer mgc:  0.003427782 
iter: 1  value: 3822.441 mgc: 0.005197154 ustep: 1 
iter: 2  value: 3822.441 mgc: 1.050438e-07 ustep: 1 
iter: 3  mgc: 7.21645e-15 
iter: 1  mgc: 7.21645e-15 
outer mgc:  0.001720956 
iter: 1  value: 3822.442 mgc: 0.002464146 ustep: 1 
iter: 2  mgc: 9.408666e-09 
iter: 1  mgc: 9.408666e-09 
outer mgc:  0.0001056164 
iter: 1  mgc: 9.408666e-09 
iter: 1  mgc: 9.408666e-09 
outer mgc:  0.0001056164 
iter: 1  value: 3822.441 mgc: 0.006370604 ustep: 1 
iter: 2  value: 3822.441 mgc: 7.26849e-07 ustep: 1 
iter: 3  mgc: 1.088019e-14 
outer mgc:  0.03920116 
iter: 1  value: 3822.443 mgc: 0.006368734 ustep: 1 
iter: 2  value: 3822.443 mgc: 7.274841e-07 ustep: 1 
iter: 3  mgc: 1.310063e-14 
outer mgc:  0.03938878 
iter: 1  value: 3822.443 mgc: 0.003582449 ustep: 1 
iter: 2  value: 3822.443 mgc: 2.762757e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.03744108 
iter: 1  value: 3822.442 mgc: 0.003581625 ustep: 1 
iter: 2  value: 3822.442 mgc: 2.768636e-07 ustep: 1 
iter: 3  mgc: 5.662137e-15 
outer mgc:  0.03732933 
iter: 1  value: 3822.444 mgc: 0.006455691 ustep: 1 
iter: 2  value: 3822.444 mgc: 8.279651e-08 ustep: 1 
iter: 3  mgc: 7.160939e-15 
outer mgc:  0.08174872 
iter: 1  value: 3822.441 mgc: 0.006452312 ustep: 1 
iter: 2  value: 3822.441 mgc: 8.28164e-08 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.08162331 
iter: 1  value: 3822.443 mgc: 0.003381898 ustep: 1 
iter: 2  value: 3822.443 mgc: 2.647277e-08 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.03953044 
iter: 1  value: 3822.442 mgc: 0.003380195 ustep: 1 
iter: 2  value: 3822.442 mgc: 2.647005e-08 ustep: 1 
mgc: 4.996004e-15 
outer mgc:  0.03970902 
iter: 1  value: 3822.449 mgc: 0.01490648 ustep: 1 
iter: 2  value: 3822.449 mgc: 1.380829e-06 ustep: 1 
iter: 3  mgc: 5.906386e-14 
outer mgc:  0.02685422 
iter: 1  value: 3822.436 mgc: 0.01492138 ustep: 1 
iter: 2  value: 3822.436 mgc: 1.382513e-06 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  0.02675217 
iter: 1  value: 3822.458 mgc: 0.02204556 ustep: 1 
iter: 2  value: 3822.458 mgc: 8.173492e-07 ustep: 1 
iter: 3  mgc: 5.440093e-15 
outer mgc:  0.01025346 
iter: 1  value: 3822.426 mgc: 0.02210089 ustep: 1 
iter: 2  value: 3822.426 mgc: 8.154348e-07 ustep: 1 
iter: 3  mgc: 6.439294e-15 
outer mgc:  0.01007148 
iter: 1  value: 3822.435 mgc: 0.003769113 ustep: 1 
iter: 2  value: 3822.435 mgc: 3.640874e-08 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.001125761 
iter: 1  value: 3822.449 mgc: 0.003767246 ustep: 1 
iter: 2  value: 3822.449 mgc: 3.648158e-08 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.001017064 
iter: 1  value: 3822.436 mgc: 0.004005543 ustep: 1 
iter: 2  value: 3822.436 mgc: 1.163573e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.02295315 
iter: 1  value: 3822.449 mgc: 0.004003615 ustep: 1 
iter: 2  value: 3822.449 mgc: 1.163086e-07 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.02284071 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:10:28 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:23:21 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2263.141315 
final  value 1980.143346 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 360.752 mgc: 58.05423 ustep: 1 
iter: 2  value: 328.125 mgc: 26.48478 ustep: 1 
iter: 3  value: 327.602 mgc: 2.644238 ustep: 1 
iter: 4  value: 327.5987 mgc: 0.1115276 ustep: 1 
iter: 5  value: 327.5987 mgc: 0.001126353 ustep: 1 
iter: 6  value: 327.5987 mgc: 1.693253e-07 ustep: 1 
iter: 7  mgc: 3.578388e-14 
iter: 1  mgc: 3.578388e-14 
Matching hessian patterns... Done
outer mgc:  194.6539 
iter: 1  value: 195.5302 mgc: 36.84112 ustep: 1 
iter: 2  value: 195.0201 mgc: 3.455268 ustep: 1 
iter: 3  value: 195.02 mgc: 0.02737354 ustep: 1 
iter: 4  value: 195.02 mgc: 8.309586e-06 ustep: 1 
iter: 5  mgc: 4.165834e-12 
iter: 1  mgc: 4.165834e-12 
outer mgc:  51.26797 
iter: 1  value: 161.7867 mgc: 17.29165 ustep: 1 
iter: 2  value: 161.5498 mgc: 1.826476 ustep: 1 
iter: 3  value: 161.5497 mgc: 0.01222749 ustep: 1 
iter: 4  value: 161.5497 mgc: 6.664208e-06 ustep: 1 
iter: 5  mgc: 2.577605e-12 
iter: 1  mgc: 2.577605e-12 
outer mgc:  56.84132 
iter: 1  value: 200.7145 mgc: 45.29452 ustep: 1 
iter: 2  value: 198.3322 mgc: 9.141364 ustep: 1 
iter: 3  value: 198.3316 mgc: 0.1331283 ustep: 1 
iter: 4  value: 198.3316 mgc: 9.514278e-05 ustep: 1 
iter: 5  mgc: 5.842891e-10 
iter: 1  value: 163.1783 mgc: 25.86363 ustep: 1 
iter: 2  value: 162.9137 mgc: 2.962866 ustep: 1 
iter: 3  value: 162.9137 mgc: 0.02875799 ustep: 1 
iter: 4  value: 162.9137 mgc: 3.116047e-06 ustep: 1 
iter: 5  mgc: 4.363176e-14 
iter: 1  value: 150.7274 mgc: 12.95084 ustep: 1 
iter: 2  value: 150.7176 mgc: 0.5851422 ustep: 1 
iter: 3  value: 150.7176 mgc: 0.00120071 ustep: 1 
iter: 4  mgc: 5.127633e-09 
iter: 1  mgc: 5.127633e-09 
outer mgc:  26.85204 
iter: 1  value: 144.6434 mgc: 7.9114 ustep: 1 
iter: 2  value: 144.6411 mgc: 0.2271669 ustep: 1 
iter: 3  value: 144.6411 mgc: 0.0002205128 ustep: 1 
iter: 4  mgc: 3.476809e-10 
iter: 1  mgc: 3.476809e-10 
outer mgc:  27.9603 
iter: 1  value: 135.8058 mgc: 14.34999 ustep: 1 
iter: 2  value: 135.7808 mgc: 0.5245983 ustep: 1 
iter: 3  value: 135.7808 mgc: 0.002087522 ustep: 1 
iter: 4  value: 135.7808 mgc: 2.740149e-07 ustep: 1 
iter: 5  mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  25.08377 
iter: 1  value: 135.8351 mgc: 15.86401 ustep: 1 
iter: 2  value: 135.6105 mgc: 1.156089 ustep: 1 
iter: 3  value: 135.6104 mgc: 0.01899236 ustep: 1 
iter: 4  value: 135.6104 mgc: 2.806407e-05 ustep: 1 
iter: 5  mgc: 5.918377e-11 
iter: 1  value: 132.5065 mgc: 10.82667 ustep: 1 
iter: 2  value: 132.4999 mgc: 0.3306284 ustep: 1 
iter: 3  value: 132.4999 mgc: 0.0007048241 ustep: 1 
iter: 4  mgc: 3.361009e-09 
iter: 1  mgc: 3.361009e-09 
outer mgc:  13.5835 
iter: 1  value: 129.4589 mgc: 11.87998 ustep: 1 
iter: 2  value: 129.4507 mgc: 0.2568571 ustep: 1 
iter: 3  value: 129.4507 mgc: 0.0004267563 ustep: 1 
iter: 4  mgc: 6.655824e-09 
iter: 1  mgc: 6.655824e-09 
outer mgc:  9.893061 
iter: 1  value: 126.4219 mgc: 5.373197 ustep: 1 
iter: 2  value: 126.4084 mgc: 0.3018544 ustep: 1 
iter: 3  value: 126.4084 mgc: 0.0008924744 ustep: 1 
iter: 4  value: 126.4084 mgc: 4.253745e-08 ustep: 1 
mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  7.438359 
iter: 1  value: 123.9543 mgc: 8.259529 ustep: 1 
iter: 2  value: 123.9438 mgc: 0.1786666 ustep: 1 
iter: 3  value: 123.9438 mgc: 0.0005325607 ustep: 1 
iter: 4  value: 123.9438 mgc: 1.556812e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  9.027396 
iter: 1  value: 119.3527 mgc: 16.4466 ustep: 1 
iter: 2  value: 119.1937 mgc: 1.072443 ustep: 1 
iter: 3  value: 119.1936 mgc: 0.008342922 ustep: 1 
iter: 4  value: 119.1936 mgc: 5.233902e-06 ustep: 1 
iter: 5  mgc: 1.954215e-12 
iter: 1  mgc: 1.954215e-12 
outer mgc:  14.70799 
iter: 1  value: 120.3049 mgc: 26.40386 ustep: 1 
iter: 2  value: 120.1889 mgc: 1.207296 ustep: 1 
iter: 3  value: 120.1888 mgc: 0.01056125 ustep: 1 
iter: 4  value: 120.1888 mgc: 4.35431e-06 ustep: 1 
iter: 5  mgc: 5.258016e-13 
iter: 1  value: 118.1418 mgc: 13.84821 ustep: 1 
iter: 2  value: 118.1401 mgc: 0.3368637 ustep: 1 
iter: 3  value: 118.1401 mgc: 0.0001465354 ustep: 1 
iter: 4  mgc: 5.411049e-11 
iter: 1  mgc: 5.411049e-11 
outer mgc:  17.44679 
iter: 1  value: 115.8735 mgc: 7.755744 ustep: 1 
iter: 2  value: 115.8682 mgc: 0.2394477 ustep: 1 
iter: 3  value: 115.8682 mgc: 0.0004311816 ustep: 1 
iter: 4  mgc: 7.820211e-09 
iter: 1  mgc: 7.820211e-09 
outer mgc:  6.407626 
iter: 1  value: 116.7211 mgc: 10.20549 ustep: 1 
iter: 2  value: 116.7203 mgc: 0.1029262 ustep: 1 
iter: 3  value: 116.7203 mgc: 0.0001197782 ustep: 1 
iter: 4  mgc: 3.793996e-10 
iter: 1  value: 115.5715 mgc: 2.668919 ustep: 1 
iter: 2  value: 115.5715 mgc: 0.006785343 ustep: 1 
iter: 3  value: 115.5715 mgc: 6.21697e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  3.453816 
iter: 1  value: 115.4265 mgc: 4.322228 ustep: 1 
iter: 2  value: 115.4264 mgc: 0.04099058 ustep: 1 
iter: 3  value: 115.4264 mgc: 6.486458e-06 ustep: 1 
iter: 4  mgc: 1.567635e-13 
iter: 1  value: 115.4645 mgc: 2.44992 ustep: 1 
iter: 2  value: 115.4644 mgc: 0.01361299 ustep: 1 
iter: 3  value: 115.4644 mgc: 7.369312e-07 ustep: 1 
iter: 4  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  4.726802 
iter: 1  value: 115.2721 mgc: 2.179534 ustep: 1 
iter: 2  value: 115.2721 mgc: 0.005205224 ustep: 1 
iter: 3  value: 115.2721 mgc: 2.971231e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  2.159113 
iter: 1  value: 115.102 mgc: 1.327849 ustep: 1 
iter: 2  value: 115.1019 mgc: 0.004538394 ustep: 1 
iter: 3  value: 115.1019 mgc: 7.90065e-08 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  1.963497 
iter: 1  value: 114.8385 mgc: 1.362775 ustep: 1 
iter: 2  value: 114.8385 mgc: 0.005706744 ustep: 1 
iter: 3  value: 114.8385 mgc: 6.712044e-07 ustep: 1 
iter: 4  mgc: 2.375877e-14 
iter: 1  mgc: 2.375877e-14 
outer mgc:  1.964618 
iter: 1  value: 114.709 mgc: 0.5937524 ustep: 1 
iter: 2  value: 114.709 mgc: 0.0005950633 ustep: 1 
iter: 3  mgc: 2.126725e-10 
iter: 1  value: 114.5106 mgc: 1.094836 ustep: 1 
iter: 2  value: 114.5106 mgc: 0.001640921 ustep: 1 
iter: 3  value: 114.5106 mgc: 1.11068e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  value: 114.2866 mgc: 1.288914 ustep: 1 
iter: 2  value: 114.2866 mgc: 0.004012096 ustep: 1 
iter: 3  value: 114.2866 mgc: 2.589502e-07 ustep: 1 
iter: 4  mgc: 5.107026e-14 
iter: 1  mgc: 5.107026e-14 
outer mgc:  3.511878 
iter: 1  value: 115.4846 mgc: 12.52 ustep: 1 
iter: 2  value: 115.4845 mgc: 0.03988111 ustep: 1 
iter: 3  value: 115.4845 mgc: 2.910821e-05 ustep: 1 
iter: 4  mgc: 4.4027e-11 
iter: 1  value: 114.1414 mgc: 3.496109 ustep: 1 
iter: 2  value: 114.1414 mgc: 0.007324079 ustep: 1 
iter: 3  value: 114.1414 mgc: 2.524702e-07 ustep: 1 
iter: 4  mgc: 4.707346e-14 
iter: 1  mgc: 4.707346e-14 
outer mgc:  4.593154 
iter: 1  value: 113.6648 mgc: 2.645928 ustep: 1 
iter: 2  value: 113.6648 mgc: 0.006681484 ustep: 1 
iter: 3  value: 113.6648 mgc: 1.045661e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  1.807948 
iter: 1  value: 113.6441 mgc: 1.980435 ustep: 1 
iter: 2  value: 113.6441 mgc: 0.002478223 ustep: 1 
iter: 3  value: 113.6441 mgc: 1.162772e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  value: 113.687 mgc: 1.769433 ustep: 1 
iter: 2  value: 113.687 mgc: 0.002336634 ustep: 1 
iter: 3  value: 113.687 mgc: 1.396571e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  value: 113.6693 mgc: 1.081426 ustep: 1 
iter: 2  value: 113.6693 mgc: 0.0009927274 ustep: 1 
iter: 3  mgc: 2.565217e-09 
iter: 1  value: 113.6556 mgc: 0.4872592 ustep: 1 
iter: 2  value: 113.6556 mgc: 0.0001997897 ustep: 1 
iter: 3  mgc: 1.059259e-10 
iter: 1  mgc: 1.059259e-10 
outer mgc:  1.218405 
iter: 1  value: 113.6377 mgc: 0.4273228 ustep: 1 
iter: 2  value: 113.6377 mgc: 0.0002025109 ustep: 1 
iter: 3  mgc: 7.564349e-11 
iter: 1  mgc: 7.564349e-11 
outer mgc:  1.28513 
iter: 1  value: 113.6118 mgc: 0.4015868 ustep: 1 
iter: 2  value: 113.6118 mgc: 0.0001111458 ustep: 1 
iter: 3  mgc: 1.283151e-11 
iter: 1  mgc: 1.283151e-11 
outer mgc:  1.075812 
iter: 1  value: 113.5605 mgc: 0.4232936 ustep: 1 
iter: 2  value: 113.5605 mgc: 0.0001850394 ustep: 1 
iter: 3  mgc: 6.227285e-11 
iter: 1  value: 113.4949 mgc: 0.2654685 ustep: 1 
iter: 2  value: 113.4949 mgc: 4.842138e-05 ustep: 1 
iter: 3  mgc: 2.408229e-11 
iter: 1  value: 113.1939 mgc: 0.9500398 ustep: 1 
iter: 2  value: 113.1939 mgc: 0.001698745 ustep: 1 
iter: 3  value: 113.1939 mgc: 2.72116e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.140612 
iter: 1  value: 112.9341 mgc: 2.689874 ustep: 1 
iter: 2  value: 112.934 mgc: 0.0217151 ustep: 1 
iter: 3  value: 112.934 mgc: 1.193507e-05 ustep: 1 
iter: 4  mgc: 5.037748e-12 
iter: 1  value: 113.0515 mgc: 0.9793028 ustep: 1 
iter: 2  value: 113.0515 mgc: 0.003068745 ustep: 1 
iter: 3  value: 113.0515 mgc: 2.370009e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  1.154594 
iter: 1  value: 112.9606 mgc: 0.8791997 ustep: 1 
iter: 2  value: 112.9606 mgc: 0.0007233462 ustep: 1 
iter: 3  mgc: 7.974089e-09 
iter: 1  mgc: 7.974089e-09 
outer mgc:  0.4284121 
iter: 1  value: 112.8862 mgc: 0.2746298 ustep: 1 
iter: 2  value: 112.8862 mgc: 7.39491e-05 ustep: 1 
iter: 3  mgc: 4.623915e-10 
iter: 1  value: 112.7343 mgc: 0.6496481 ustep: 1 
iter: 2  value: 112.7343 mgc: 0.0004117914 ustep: 1 
iter: 3  value: 112.7343 mgc: 1.412903e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  0.3314497 
iter: 1  value: 112.4135 mgc: 1.332084 ustep: 1 
iter: 2  value: 112.4135 mgc: 0.001862789 ustep: 1 
iter: 3  value: 112.4135 mgc: 2.241094e-08 ustep: 1 
mgc: 1.884604e-14 
iter: 1  value: 112.584 mgc: 0.5935924 ustep: 1 
iter: 2  value: 112.584 mgc: 0.000385998 ustep: 1 
iter: 3  mgc: 9.601324e-10 
iter: 1  mgc: 9.601324e-10 
outer mgc:  0.24567 
iter: 1  value: 112.5512 mgc: 0.3712259 ustep: 1 
iter: 2  value: 112.5512 mgc: 0.0008908743 ustep: 1 
iter: 3  mgc: 8.848916e-09 
iter: 1  mgc: 8.848916e-09 
outer mgc:  0.08010711 
iter: 1  value: 112.5447 mgc: 0.1380018 ustep: 1 
iter: 2  value: 112.5447 mgc: 8.450441e-05 ustep: 1 
iter: 3  mgc: 1.310516e-10 
iter: 1  mgc: 1.310516e-10 
outer mgc:  0.02688223 
iter: 1  value: 112.5449 mgc: 0.01004895 ustep: 1 
iter: 2  value: 112.5449 mgc: 6.261043e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.009674065 
iter: 1  value: 112.5443 mgc: 0.003556896 ustep: 1 
iter: 2  mgc: 3.11293e-09 
iter: 1  mgc: 3.11293e-09 
outer mgc:  0.0001565843 
iter: 1  value: 112.5443 mgc: 0.0001138435 ustep: 1 
iter: 2  mgc: 1.462144e-11 
iter: 1  mgc: 1.462144e-11 
outer mgc:  2.709836e-05 
iter: 1  mgc: 1.462144e-11 
iter: 1  mgc: 1.462144e-11 
outer mgc:  2.709836e-05 
iter: 1  value: 112.5452 mgc: 0.0563453 ustep: 1 
iter: 2  value: 112.5452 mgc: 1.901273e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.2280356 
iter: 1  value: 112.5436 mgc: 0.05634789 ustep: 1 
iter: 2  value: 112.5436 mgc: 1.902494e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.2280681 
iter: 1  value: 112.5448 mgc: 0.02972648 ustep: 1 
iter: 2  value: 112.5448 mgc: 5.566253e-07 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.1874543 
iter: 1  value: 112.544 mgc: 0.02972731 ustep: 1 
iter: 2  value: 112.544 mgc: 5.555066e-07 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.1874993 
iter: 1  value: 112.5439 mgc: 0.05423578 ustep: 1 
iter: 2  value: 112.5439 mgc: 3.240573e-06 ustep: 1 
iter: 3  mgc: 2.375877e-14 
outer mgc:  0.1977108 
iter: 1  value: 112.5449 mgc: 0.05422629 ustep: 1 
iter: 2  value: 112.5449 mgc: 3.242649e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.197678 
iter: 1  value: 112.5443 mgc: 0.02901754 ustep: 1 
iter: 2  value: 112.5443 mgc: 1.014371e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  0.1733559 
iter: 1  value: 112.5445 mgc: 0.02901494 ustep: 1 
iter: 2  value: 112.5445 mgc: 1.015365e-06 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.1732916 
iter: 1  value: 112.5433 mgc: 0.003537521 ustep: 1 
iter: 2  mgc: 6.365284e-09 
outer mgc:  0.0007194587 
iter: 1  value: 112.5453 mgc: 0.003536771 ustep: 1 
iter: 2  mgc: 6.367753e-09 
outer mgc:  0.0007467276 
iter: 1  value: 112.5484 mgc: 0.05765538 ustep: 1 
iter: 2  value: 112.5484 mgc: 2.679121e-06 ustep: 1 
iter: 3  mgc: 1.723066e-13 
outer mgc:  0.1070429 
iter: 1  value: 112.5403 mgc: 0.05782894 ustep: 1 
iter: 2  value: 112.5403 mgc: 2.67482e-06 ustep: 1 
iter: 3  mgc: 1.918465e-13 
outer mgc:  0.1070767 
iter: 1  value: 112.5462 mgc: 0.05805246 ustep: 1 
iter: 2  value: 112.5462 mgc: 3.980004e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.1121284 
iter: 1  value: 112.5425 mgc: 0.05811054 ustep: 1 
iter: 2  value: 112.5425 mgc: 3.994962e-06 ustep: 1 
iter: 3  mgc: 6.591949e-14 
outer mgc:  0.1122363 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:23:23 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:59:13 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4479.042301 
final  value 4088.249113 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1306.328 mgc: 107.5535 ustep: 1 
iter: 2  value: 1243.635 mgc: 82.19003 ustep: 1 
iter: 3  value: 1125.163 mgc: 106.3162 ustep: 0.2494656 
iter: 4  value: 750.5725 mgc: 92.31181 ustep: 0.08285847 
iter: 5  value: 641.6554 mgc: 91.11388 ustep: 0.2879227 
iter: 6  value: 602.9686 mgc: 75.54963 ustep: 0.5366306 
iter: 7  value: 553.6391 mgc: 79.97847 ustep: 0.7325775 
iter: 8  value: 519.8663 mgc: 52.15553 ustep: 0.8559218 
iter: 9  value: 517.1518 mgc: 16.57673 ustep: 0.9251679 
iter: 10  value: 517.1507 mgc: 0.2012044 ustep: 0.9618603 
iter: 11  value: 517.1507 mgc: 0.001392489 ustep: 0.9807467 
iter: 12  value: 517.1507 mgc: 1.697451e-06 ustep: 0.9903275 
iter: 13  mgc: 1.071327e-09 
iter: 1  mgc: 1.071327e-09 
Matching hessian patterns... Done
outer mgc:  308.6485 
iter: 1  value: 312.9162 mgc: 31.27751 ustep: 1 
iter: 2  value: 303.7674 mgc: 9.616496 ustep: 1 
iter: 3  value: 303.7429 mgc: 0.6929856 ustep: 1 
iter: 4  value: 303.7429 mgc: 0.005232141 ustep: 1 
iter: 5  value: 303.7429 mgc: 3.065549e-07 ustep: 1 
iter: 6  mgc: 2.250977e-14 
iter: 1  mgc: 2.250977e-14 
outer mgc:  47.51524 
iter: 1  value: 275.7339 mgc: 16.3001 ustep: 1 
iter: 2  value: 275.4991 mgc: 1.258563 ustep: 1 
iter: 3  value: 275.4991 mgc: 0.01555144 ustep: 1 
iter: 4  value: 275.4991 mgc: 2.486457e-06 ustep: 1 
iter: 5  mgc: 5.528911e-14 
iter: 1  value: 262.3599 mgc: 13.59929 ustep: 1 
iter: 2  value: 262.3247 mgc: 0.6243226 ustep: 1 
iter: 3  value: 262.3247 mgc: 0.003103686 ustep: 1 
iter: 4  value: 262.3247 mgc: 8.022927e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  24.4186 
iter: 1  value: 351.1805 mgc: 79.37235 ustep: 1 
iter: 2  value: 349.5088 mgc: 7.447496 ustep: 1 
iter: 3  value: 349.5087 mgc: 0.06393283 ustep: 1 
iter: 4  value: 349.5087 mgc: 4.472428e-06 ustep: 1 
iter: 5  mgc: 7.205347e-14 
iter: 1  value: 254.2723 mgc: 6.166667 ustep: 1 
iter: 2  value: 254.2541 mgc: 0.3576022 ustep: 1 
iter: 3  value: 254.2541 mgc: 0.0007007707 ustep: 1 
iter: 4  mgc: 6.534555e-09 
iter: 1  mgc: 6.534555e-09 
outer mgc:  17.77624 
iter: 1  value: 269.7099 mgc: 19.19827 ustep: 1 
iter: 2  value: 269.2478 mgc: 1.848224 ustep: 1 
iter: 3  value: 269.2478 mgc: 0.01965757 ustep: 1 
iter: 4  value: 269.2478 mgc: 2.792004e-06 ustep: 1 
iter: 5  mgc: 5.040413e-14 
iter: 1  value: 253.0108 mgc: 4.723422 ustep: 1 
iter: 2  value: 253.0098 mgc: 0.08599483 ustep: 1 
iter: 3  value: 253.0098 mgc: 4.759671e-05 ustep: 1 
iter: 4  mgc: 1.639577e-11 
iter: 1  mgc: 1.639577e-11 
outer mgc:  7.00707 
iter: 1  value: 251.9905 mgc: 2.782154 ustep: 1 
iter: 2  value: 251.9904 mgc: 0.01902559 ustep: 1 
iter: 3  value: 251.9904 mgc: 5.278615e-06 ustep: 1 
iter: 4  mgc: 1.736389e-13 
iter: 1  mgc: 1.736389e-13 
outer mgc:  10.9338 
iter: 1  value: 250.1282 mgc: 4.140866 ustep: 1 
iter: 2  value: 250.1262 mgc: 0.1193356 ustep: 1 
iter: 3  value: 250.1262 mgc: 0.0001319775 ustep: 1 
iter: 4  mgc: 1.713407e-10 
iter: 1  mgc: 1.713407e-10 
outer mgc:  11.55585 
iter: 1  value: 248.604 mgc: 7.835994 ustep: 1 
iter: 2  value: 248.6029 mgc: 0.08051555 ustep: 1 
iter: 3  value: 248.6029 mgc: 4.553596e-05 ustep: 1 
iter: 4  mgc: 1.532285e-11 
iter: 1  mgc: 1.532285e-11 
outer mgc:  14.10307 
iter: 1  value: 248.1485 mgc: 5.573009 ustep: 1 
iter: 2  value: 248.1449 mgc: 0.1547967 ustep: 1 
iter: 3  value: 248.1449 mgc: 0.0001587705 ustep: 1 
iter: 4  mgc: 1.967284e-10 
iter: 1  mgc: 1.967284e-10 
outer mgc:  10.48226 
iter: 1  value: 247.5844 mgc: 3.041004 ustep: 1 
iter: 2  value: 247.5844 mgc: 0.01373948 ustep: 1 
iter: 3  value: 247.5844 mgc: 6.367929e-07 ustep: 1 
iter: 4  mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  15.72452 
iter: 1  value: 247.7614 mgc: 6.970939 ustep: 1 
iter: 2  value: 247.7612 mgc: 0.05808902 ustep: 1 
iter: 3  value: 247.7612 mgc: 1.240345e-05 ustep: 1 
iter: 4  mgc: 1.073808e-12 
iter: 1  value: 247.0476 mgc: 2.707176 ustep: 1 
iter: 2  value: 247.0476 mgc: 0.007813271 ustep: 1 
iter: 3  value: 247.0476 mgc: 3.105521e-07 ustep: 1 
iter: 4  mgc: 2.825518e-14 
iter: 1  mgc: 2.825518e-14 
outer mgc:  8.544162 
iter: 1  value: 246.7367 mgc: 3.352703 ustep: 1 
iter: 2  value: 246.7366 mgc: 0.02872926 ustep: 1 
iter: 3  value: 246.7366 mgc: 3.15906e-06 ustep: 1 
iter: 4  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  6.641112 
iter: 1  value: 246.1932 mgc: 1.420347 ustep: 1 
iter: 2  value: 246.1932 mgc: 0.005952888 ustep: 1 
iter: 3  value: 246.1932 mgc: 1.112424e-07 ustep: 1 
mgc: 2.43694e-14 
iter: 1  mgc: 2.43694e-14 
outer mgc:  1.576351 
iter: 1  value: 246.1115 mgc: 1.390033 ustep: 1 
iter: 2  value: 246.1115 mgc: 0.00286679 ustep: 1 
iter: 3  value: 246.1115 mgc: 6.104012e-08 ustep: 1 
mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  4.221687 
iter: 1  value: 245.9707 mgc: 1.255129 ustep: 1 
iter: 2  value: 245.9707 mgc: 0.001665492 ustep: 1 
iter: 3  value: 245.9707 mgc: 2.424934e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  1.849578 
iter: 1  value: 245.7213 mgc: 0.9797066 ustep: 1 
iter: 2  value: 245.7213 mgc: 0.001536596 ustep: 1 
iter: 3  value: 245.7213 mgc: 1.097089e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  3.48462 
iter: 1  value: 245.3754 mgc: 1.064441 ustep: 1 
iter: 2  value: 245.3754 mgc: 0.003087265 ustep: 1 
iter: 3  value: 245.3754 mgc: 3.052133e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  1.96773 
iter: 1  value: 245.311 mgc: 0.5238207 ustep: 1 
iter: 2  value: 245.311 mgc: 0.001489519 ustep: 1 
iter: 3  mgc: 5.762277e-09 
iter: 1  mgc: 5.762277e-09 
outer mgc:  0.7599739 
iter: 1  value: 245.1554 mgc: 0.5075193 ustep: 1 
iter: 2  value: 245.1554 mgc: 0.000194117 ustep: 1 
iter: 3  mgc: 3.004423e-10 
iter: 1  value: 245.0001 mgc: 0.3439048 ustep: 1 
iter: 2  value: 245.0001 mgc: 0.0001972075 ustep: 1 
iter: 3  mgc: 9.624685e-10 
iter: 1  mgc: 9.624685e-10 
outer mgc:  1.382293 
iter: 1  value: 244.3379 mgc: 1.162241 ustep: 1 
iter: 2  value: 244.3379 mgc: 0.003964415 ustep: 1 
iter: 3  value: 244.3379 mgc: 6.26107e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  0.9718306 
iter: 1  value: 244.0876 mgc: 1.08033 ustep: 1 
iter: 2  value: 244.0876 mgc: 0.005037791 ustep: 1 
iter: 3  value: 244.0876 mgc: 1.252333e-07 ustep: 1 
iter: 4  mgc: 2.797762e-14 
iter: 1  value: 244.2261 mgc: 0.4154887 ustep: 1 
iter: 2  value: 244.2261 mgc: 0.00076087 ustep: 1 
iter: 3  mgc: 2.679212e-09 
iter: 1  mgc: 2.679212e-09 
outer mgc:  0.6778404 
iter: 1  value: 244.0654 mgc: 0.4325499 ustep: 1 
iter: 2  value: 244.0654 mgc: 0.0005243794 ustep: 1 
iter: 3  mgc: 1.453288e-09 
iter: 1  mgc: 1.453288e-09 
outer mgc:  0.325964 
iter: 1  value: 243.8615 mgc: 1.149868 ustep: 1 
iter: 2  value: 243.8615 mgc: 0.003608845 ustep: 1 
iter: 3  value: 243.8615 mgc: 1.010848e-07 ustep: 1 
iter: 4  mgc: 1.909584e-14 
iter: 1  value: 244.0087 mgc: 0.2994864 ustep: 1 
iter: 2  value: 244.0087 mgc: 0.0002526785 ustep: 1 
iter: 3  mgc: 4.829002e-10 
iter: 1  mgc: 4.829002e-10 
outer mgc:  0.2930161 
iter: 1  value: 243.9836 mgc: 0.1233125 ustep: 1 
iter: 2  value: 243.9836 mgc: 1.617394e-05 ustep: 1 
iter: 3  mgc: 1.640466e-12 
iter: 1  mgc: 1.640466e-12 
outer mgc:  0.1844909 
iter: 1  value: 243.9486 mgc: 0.07505231 ustep: 1 
iter: 2  value: 243.9486 mgc: 1.289216e-05 ustep: 1 
iter: 3  mgc: 8.073542e-13 
iter: 1  mgc: 8.073542e-13 
outer mgc:  0.02667251 
iter: 1  value: 243.9432 mgc: 0.01459928 ustep: 1 
iter: 2  value: 243.9432 mgc: 7.114637e-07 ustep: 1 
iter: 3  mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  0.01115001 
iter: 1  value: 243.9443 mgc: 0.00290291 ustep: 1 
iter: 2  value: 243.9443 mgc: 1.588934e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.0006659802 
iter: 1  value: 243.9443 mgc: 0.0001181274 ustep: 1 
iter: 2  mgc: 4.443979e-11 
iter: 1  mgc: 4.443979e-11 
outer mgc:  9.818864e-05 
iter: 1  mgc: 4.443979e-11 
iter: 1  mgc: 4.443979e-11 
outer mgc:  9.818864e-05 
iter: 1  value: 243.9433 mgc: 0.04114136 ustep: 1 
iter: 2  value: 243.9433 mgc: 4.08576e-06 ustep: 1 
iter: 3  mgc: 6.77236e-14 
outer mgc:  0.2488442 
iter: 1  value: 243.9456 mgc: 0.04112407 ustep: 1 
iter: 2  value: 243.9456 mgc: 4.089339e-06 ustep: 1 
iter: 3  mgc: 6.350476e-14 
outer mgc:  0.2490203 
iter: 1  value: 243.9438 mgc: 0.01947853 ustep: 1 
iter: 2  value: 243.9438 mgc: 9.985451e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.2092157 
iter: 1  value: 243.9451 mgc: 0.01946801 ustep: 1 
iter: 2  value: 243.9451 mgc: 9.978849e-07 ustep: 1 
iter: 3  mgc: 1.976197e-14 
outer mgc:  0.209182 
iter: 1  value: 243.946 mgc: 0.05443545 ustep: 1 
iter: 2  value: 243.946 mgc: 2.859617e-06 ustep: 1 
iter: 3  mgc: 7.371881e-14 
outer mgc:  0.3095802 
iter: 1  value: 243.943 mgc: 0.05443131 ustep: 1 
iter: 2  value: 243.943 mgc: 2.851533e-06 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.3094032 
iter: 1  value: 243.9459 mgc: 0.02811347 ustep: 1 
iter: 2  value: 243.9459 mgc: 7.883461e-07 ustep: 1 
iter: 3  mgc: 3.08642e-14 
outer mgc:  0.3157734 
iter: 1  value: 243.9431 mgc: 0.02811542 ustep: 1 
iter: 2  value: 243.9431 mgc: 7.877844e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.3158039 
iter: 1  value: 243.9415 mgc: 0.00498303 ustep: 1 
iter: 2  value: 243.9415 mgc: 4.132192e-08 ustep: 1 
mgc: 1.776357e-14 
outer mgc:  0.002223685 
iter: 1  value: 243.9472 mgc: 0.004981321 ustep: 1 
iter: 2  value: 243.9472 mgc: 4.133803e-08 ustep: 1 
mgc: 3.552714e-14 
outer mgc:  0.002233521 
iter: 1  value: 243.9503 mgc: 0.02918356 ustep: 1 
iter: 2  value: 243.9503 mgc: 3.648946e-06 ustep: 1 
iter: 3  mgc: 6.661338e-14 
outer mgc:  0.1031692 
iter: 1  value: 243.9384 mgc: 0.02925893 ustep: 1 
iter: 2  value: 243.9384 mgc: 3.655385e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.1032687 
iter: 1  value: 243.9491 mgc: 0.02831933 ustep: 1 
iter: 2  value: 243.9491 mgc: 1.165838e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.1086205 
iter: 1  value: 243.9397 mgc: 0.02840073 ustep: 1 
iter: 2  value: 243.9397 mgc: 1.166869e-06 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.108718 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:59:15 2021]
Finished job 0.
1 of 1 steps (100%) done

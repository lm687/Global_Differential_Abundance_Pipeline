Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:19:08 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2135.702289 
final  value 1901.863902 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 832.8213 mgc: 102.3829 ustep: 1 
iter: 2  value: 502.1341 mgc: 80.52676 ustep: 0.1336527 
iter: 3  value: 475.2782 mgc: 98.40897 ustep: 0.203518 
iter: 4  value: 455.5431 mgc: 75.99246 ustep: 0.1392616 
iter: 5  value: 306.0738 mgc: 94.59282 ustep: 0.1102124 
iter: 6  value: 207.5831 mgc: 65.94412 ustep: 0.09594352 
iter: 7  value: 163.7217 mgc: 58.30229 ustep: 0.3098165 
iter: 8  value: 162.4401 mgc: 9.843716 ustep: 0.556656 
iter: 9  value: 162.4388 mgc: 0.2154229 ustep: 0.7461192 
iter: 10  value: 162.4388 mgc: 0.003194958 ustep: 0.8637955 
iter: 11  value: 162.4388 mgc: 3.167985e-05 ustep: 0.9294131 
iter: 12  value: 162.4388 mgc: 1.548908e-07 ustep: 0.9640643 
iter: 13  mgc: 3.738364e-10 
iter: 1  mgc: 3.738364e-10 
Matching hessian patterns... Done
outer mgc:  55.34445 
iter: 1  value: 159.5986 mgc: 25.42955 ustep: 1 
iter: 2  value: 155.0536 mgc: 8.231231 ustep: 1 
iter: 3  value: 155.0417 mgc: 0.4086362 ustep: 1 
iter: 4  value: 155.0417 mgc: 0.001807306 ustep: 1 
iter: 5  value: 155.0417 mgc: 6.055603e-08 ustep: 1 
mgc: 3.4861e-14 
iter: 1  mgc: 3.4861e-14 
outer mgc:  60.41851 
iter: 1  value: 136.5639 mgc: 12.63933 ustep: 1 
iter: 2  value: 136.5256 mgc: 0.6609995 ustep: 1 
iter: 3  value: 136.5255 mgc: 0.005771711 ustep: 1 
iter: 4  value: 136.5255 mgc: 7.27376e-07 ustep: 1 
iter: 5  mgc: 2.137179e-14 
iter: 1  mgc: 2.137179e-14 
outer mgc:  17.20571 
iter: 1  value: 124.3162 mgc: 27.69505 ustep: 1 
iter: 2  value: 123.4413 mgc: 4.07482 ustep: 1 
iter: 3  value: 123.441 mgc: 0.07926847 ustep: 1 
iter: 4  value: 123.441 mgc: 7.084089e-05 ustep: 1 
iter: 5  mgc: 5.666279e-11 
iter: 1  mgc: 5.666279e-11 
outer mgc:  7.347598 
iter: 1  value: 116.9556 mgc: 14.95825 ustep: 1 
iter: 2  value: 116.1926 mgc: 2.768901 ustep: 1 
iter: 3  value: 116.1923 mgc: 0.07671923 ustep: 1 
iter: 4  value: 116.1923 mgc: 6.405586e-05 ustep: 1 
iter: 5  mgc: 4.478284e-11 
iter: 1  mgc: 4.478284e-11 
outer mgc:  15.05061 
iter: 1  value: 114.6594 mgc: 20.54188 ustep: 1 
iter: 2  value: 114.626 mgc: 0.9792324 ustep: 1 
iter: 3  value: 114.626 mgc: 0.00226871 ustep: 1 
iter: 4  value: 114.626 mgc: 3.77927e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  value: 115.795 mgc: 2.647603 ustep: 1 
iter: 2  value: 115.795 mgc: 0.03696443 ustep: 1 
iter: 3  value: 115.795 mgc: 7.643661e-06 ustep: 1 
iter: 4  mgc: 3.266276e-13 
iter: 1  mgc: 3.266276e-13 
outer mgc:  23.98732 
iter: 1  value: 113.0203 mgc: 6.820623 ustep: 1 
iter: 2  value: 113.02 mgc: 0.07504312 ustep: 1 
iter: 3  value: 113.02 mgc: 1.346284e-05 ustep: 1 
iter: 4  mgc: 2.196909e-12 
iter: 1  mgc: 2.196909e-12 
outer mgc:  10.32811 
iter: 1  value: 112.8152 mgc: 7.985207 ustep: 1 
iter: 2  value: 112.8023 mgc: 0.4090391 ustep: 1 
iter: 3  value: 112.8023 mgc: 0.0009049631 ustep: 1 
iter: 4  mgc: 4.912888e-09 
iter: 1  mgc: 4.912888e-09 
outer mgc:  11.79834 
iter: 1  value: 110.6718 mgc: 9.194258 ustep: 1 
iter: 2  value: 110.6702 mgc: 0.1292689 ustep: 1 
iter: 3  value: 110.6702 mgc: 0.0001673939 ustep: 1 
iter: 4  mgc: 1.969527e-10 
iter: 1  mgc: 1.969527e-10 
outer mgc:  2.135791 
iter: 1  value: 109.8164 mgc: 2.626406 ustep: 1 
iter: 2  value: 109.8164 mgc: 0.04619208 ustep: 1 
iter: 3  value: 109.8164 mgc: 7.479955e-06 ustep: 1 
iter: 4  mgc: 3.064216e-13 
iter: 1  mgc: 3.064216e-13 
outer mgc:  6.520809 
iter: 1  value: 109.6414 mgc: 4.995265 ustep: 1 
iter: 2  value: 109.6414 mgc: 0.01922216 ustep: 1 
iter: 3  value: 109.6414 mgc: 3.043464e-06 ustep: 1 
iter: 4  mgc: 4.62963e-14 
iter: 1  value: 109.5337 mgc: 3.512815 ustep: 1 
iter: 2  value: 109.5336 mgc: 0.01012813 ustep: 1 
iter: 3  value: 109.5336 mgc: 4.060177e-07 ustep: 1 
iter: 4  mgc: 2.464695e-14 
iter: 1  mgc: 2.464695e-14 
outer mgc:  3.999275 
iter: 1  value: 109.281 mgc: 3.028732 ustep: 1 
iter: 2  value: 109.2809 mgc: 0.02113856 ustep: 1 
iter: 3  value: 109.2809 mgc: 2.428466e-06 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  2.3418 
iter: 1  value: 109.107 mgc: 1.265786 ustep: 1 
iter: 2  value: 109.107 mgc: 0.00836188 ustep: 1 
iter: 3  value: 109.107 mgc: 3.654543e-07 ustep: 1 
iter: 4  mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  2.556148 
iter: 1  value: 108.934 mgc: 2.479313 ustep: 1 
iter: 2  value: 108.934 mgc: 0.009430716 ustep: 1 
iter: 3  value: 108.934 mgc: 2.124923e-07 ustep: 1 
iter: 4  mgc: 3.552714e-14 
iter: 1  value: 109.0978 mgc: 1.914494 ustep: 1 
iter: 2  value: 109.0978 mgc: 0.005552088 ustep: 1 
iter: 3  value: 109.0978 mgc: 9.529329e-08 ustep: 1 
mgc: 1.687539e-14 
iter: 1  value: 109.0567 mgc: 0.6611031 ustep: 1 
iter: 2  value: 109.0567 mgc: 0.000681225 ustep: 1 
iter: 3  mgc: 1.430185e-09 
iter: 1  mgc: 1.430185e-09 
outer mgc:  1.14732 
iter: 1  value: 109.0353 mgc: 0.5247281 ustep: 1 
iter: 2  value: 109.0353 mgc: 0.0009391262 ustep: 1 
iter: 3  mgc: 4.264082e-09 
iter: 1  mgc: 4.264082e-09 
outer mgc:  1.190674 
iter: 1  value: 108.9878 mgc: 0.5405778 ustep: 1 
iter: 2  value: 108.9878 mgc: 0.0004708427 ustep: 1 
iter: 3  mgc: 6.084639e-10 
iter: 1  mgc: 6.084639e-10 
outer mgc:  0.8598738 
iter: 1  value: 108.9181 mgc: 0.3578702 ustep: 1 
iter: 2  value: 108.9181 mgc: 0.0004173699 ustep: 1 
iter: 3  mgc: 8.148149e-10 
iter: 1  value: 108.8111 mgc: 0.2450415 ustep: 1 
iter: 2  value: 108.8111 mgc: 0.0002222638 ustep: 1 
iter: 3  mgc: 1.856835e-10 
iter: 1  value: 108.3428 mgc: 0.9654299 ustep: 1 
iter: 2  value: 108.3428 mgc: 0.003079865 ustep: 1 
iter: 3  value: 108.3428 mgc: 3.093099e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  1.229218 
iter: 1  value: 108.1956 mgc: 3.126482 ustep: 1 
iter: 2  value: 108.1955 mgc: 0.02996757 ustep: 1 
iter: 3  value: 108.1955 mgc: 2.534228e-06 ustep: 1 
iter: 4  mgc: 2.908784e-14 
iter: 1  value: 108.249 mgc: 2.163018 ustep: 1 
iter: 2  value: 108.249 mgc: 0.01453887 ustep: 1 
iter: 3  value: 108.249 mgc: 6.35928e-07 ustep: 1 
iter: 4  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  2.319107 
iter: 1  value: 107.9852 mgc: 1.620655 ustep: 1 
iter: 2  value: 107.9852 mgc: 0.003525221 ustep: 1 
iter: 3  value: 107.9852 mgc: 1.43716e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.53258 
iter: 1  value: 107.468 mgc: 1.634118 ustep: 1 
iter: 2  value: 107.468 mgc: 0.01065559 ustep: 1 
iter: 3  value: 107.468 mgc: 4.937828e-07 ustep: 1 
iter: 4  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  1.704226 
iter: 1  value: 107.2905 mgc: 0.8768854 ustep: 1 
iter: 2  value: 107.2905 mgc: 0.004547896 ustep: 1 
iter: 3  value: 107.2905 mgc: 1.321573e-07 ustep: 1 
iter: 4  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  0.8269511 
iter: 1  value: 107.084 mgc: 0.8685234 ustep: 1 
iter: 2  value: 107.084 mgc: 0.0009892123 ustep: 1 
iter: 3  mgc: 1.728735e-09 
iter: 1  mgc: 1.728735e-09 
outer mgc:  0.5961142 
iter: 1  value: 106.8087 mgc: 0.8543205 ustep: 1 
iter: 2  value: 106.8087 mgc: 0.001642277 ustep: 1 
iter: 3  mgc: 5.90835e-09 
iter: 1  mgc: 5.90835e-09 
outer mgc:  0.6806587 
iter: 1  value: 106.6082 mgc: 0.600237 ustep: 1 
iter: 2  value: 106.6082 mgc: 0.0003978445 ustep: 1 
iter: 3  mgc: 2.637481e-10 
iter: 1  mgc: 2.637481e-10 
outer mgc:  0.2183308 
iter: 1  value: 106.3564 mgc: 0.633239 ustep: 1 
iter: 2  value: 106.3564 mgc: 0.0007417632 ustep: 1 
iter: 3  mgc: 1.069695e-09 
iter: 1  mgc: 1.069695e-09 
outer mgc:  0.06247522 
iter: 1  value: 106.3268 mgc: 0.1938742 ustep: 1 
iter: 2  value: 106.3268 mgc: 0.0001159404 ustep: 1 
iter: 3  mgc: 5.722356e-11 
iter: 1  mgc: 5.722356e-11 
outer mgc:  0.08640425 
iter: 1  value: 106.3273 mgc: 0.05548181 ustep: 1 
iter: 2  value: 106.3273 mgc: 1.748772e-05 ustep: 1 
iter: 3  mgc: 1.676881e-12 
iter: 1  mgc: 1.676881e-12 
outer mgc:  0.00436085 
iter: 1  value: 106.3257 mgc: 0.004583779 ustep: 1 
iter: 2  value: 106.3257 mgc: 4.666018e-08 ustep: 1 
mgc: 1.84297e-14 
iter: 1  mgc: 1.84297e-14 
outer mgc:  0.0008134954 
iter: 1  value: 106.3254 mgc: 0.0008926888 ustep: 1 
iter: 2  mgc: 1.022881e-09 
iter: 1  mgc: 1.022881e-09 
outer mgc:  6.627191e-05 
iter: 1  mgc: 1.022881e-09 
iter: 1  mgc: 1.022881e-09 
outer mgc:  6.627191e-05 
iter: 1  value: 106.325 mgc: 0.03085745 ustep: 1 
iter: 2  value: 106.325 mgc: 1.595916e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.1618005 
iter: 1  value: 106.326 mgc: 0.03083922 ustep: 1 
iter: 2  value: 106.326 mgc: 1.594965e-06 ustep: 1 
iter: 3  mgc: 2.764455e-14 
outer mgc:  0.1618963 
iter: 1  value: 106.3252 mgc: 0.01544279 ustep: 1 
iter: 2  value: 106.3252 mgc: 3.939944e-07 ustep: 1 
iter: 3  mgc: 1.776357e-14 
outer mgc:  0.09647082 
iter: 1  value: 106.3258 mgc: 0.0154325 ustep: 1 
iter: 2  value: 106.3258 mgc: 3.935804e-07 ustep: 1 
iter: 3  mgc: 2.198242e-14 
outer mgc:  0.09651253 
iter: 1  value: 106.3261 mgc: 0.05041901 ustep: 1 
iter: 2  value: 106.3261 mgc: 3.642727e-06 ustep: 1 
iter: 3  mgc: 1.669775e-13 
outer mgc:  0.1560545 
iter: 1  value: 106.3249 mgc: 0.05041636 ustep: 1 
iter: 2  value: 106.3249 mgc: 3.634418e-06 ustep: 1 
iter: 3  mgc: 1.749711e-13 
outer mgc:  0.1559743 
iter: 1  value: 106.3259 mgc: 0.02721694 ustep: 1 
iter: 2  value: 106.3259 mgc: 1.021583e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.1489091 
iter: 1  value: 106.3251 mgc: 0.02721598 ustep: 1 
iter: 2  value: 106.3251 mgc: 1.020889e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.1488819 
iter: 1  value: 106.3238 mgc: 0.004171209 ustep: 1 
iter: 2  value: 106.3238 mgc: 2.969851e-08 ustep: 1 
mgc: 1.776357e-14 
outer mgc:  0.0006338018 
iter: 1  value: 106.3271 mgc: 0.004170087 ustep: 1 
iter: 2  value: 106.3271 mgc: 2.972089e-08 ustep: 1 
mgc: 2.930989e-14 
outer mgc:  0.0007021337 
iter: 1  value: 106.3309 mgc: 0.04506209 ustep: 1 
iter: 2  value: 106.3309 mgc: 3.27539e-06 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.05028481 
iter: 1  value: 106.3201 mgc: 0.04519342 ustep: 1 
iter: 2  value: 106.3201 mgc: 3.279091e-06 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.05032217 
iter: 1  value: 106.3273 mgc: 0.04126779 ustep: 1 
iter: 2  value: 106.3273 mgc: 2.53481e-06 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.06033885 
iter: 1  value: 106.3237 mgc: 0.04139 ustep: 1 
iter: 2  value: 106.3237 mgc: 2.535679e-06 ustep: 1 
iter: 3  mgc: 3.563816e-14 
outer mgc:  0.06035784 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:19:11 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 03:23:34 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_50_100_80_3_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11020.179868 
iter  10 value 7482.394274
iter  10 value 7482.394274
final  value 7482.394274 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 12387.34 mgc: 154.2748 ustep: 0.6827823 
iter: 2  value: 6163.04 mgc: 141.5132 ustep: 0.103588 
iter: 3  value: 2530.681 mgc: 93.17684 ustep: 0.09253576 
iter: 4  value: 1549.512 mgc: 104.7895 ustep: 0.3042665 
iter: 5  value: 1440.55 mgc: 78.41378 ustep: 0.1816765 
iter: 6  value: 1357.1 mgc: 101.8842 ustep: 0.1296658 
iter: 7  value: 1122.311 mgc: 84.15259 ustep: 0.05427017 
iter: 8  value: 1112.632 mgc: 23.27461 ustep: 0.2330363 
iter: 9  value: 1111.672 mgc: 5.871762 ustep: 0.4827901 
iter: 10  value: 1111.648 mgc: 0.8233439 ustep: 0.6948615 
iter: 11  value: 1111.648 mgc: 0.03648888 ustep: 0.8336002 
iter: 12  value: 1111.648 mgc: 0.0009880327 ustep: 0.9130258 
iter: 13  value: 1111.648 mgc: 3.364259e-05 ustep: 0.9555283 
iter: 14  value: 1111.648 mgc: 5.825215e-07 ustep: 0.9775135 
iter: 15  mgc: 5.058403e-09 
iter: 1  mgc: 5.058403e-09 
Matching hessian patterns... Done
outer mgc:  368.1797 
iter: 1  value: 861.0678 mgc: 22.92088 ustep: 1 
iter: 2  value: 810.9819 mgc: 11.41245 ustep: 1 
iter: 3  value: 810.1577 mgc: 1.22285 ustep: 1 
iter: 4  value: 810.1573 mgc: 0.03066699 ustep: 1 
iter: 5  value: 810.1573 mgc: 4.535125e-05 ustep: 1 
iter: 6  mgc: 9.959311e-11 
iter: 1  mgc: 9.959311e-11 
outer mgc:  146.5502 
iter: 1  value: 700.8976 mgc: 9.79432 ustep: 1 
iter: 2  value: 698.0011 mgc: 2.359104 ustep: 1 
iter: 3  value: 697.9972 mgc: 0.09750499 ustep: 1 
iter: 4  value: 697.9972 mgc: 0.0002412561 ustep: 1 
iter: 5  mgc: 1.488098e-09 
iter: 1  mgc: 1.488098e-09 
outer mgc:  46.946 
iter: 1  value: 662.4587 mgc: 8.590775 ustep: 1 
iter: 2  value: 660.7787 mgc: 1.616971 ustep: 1 
iter: 3  value: 660.7774 mgc: 0.04363779 ustep: 1 
iter: 4  value: 660.7774 mgc: 8.441485e-05 ustep: 1 
iter: 5  mgc: 3.196172e-10 
iter: 1  mgc: 3.196172e-10 
outer mgc:  97.48508 
iter: 1  value: 729.1355 mgc: 23.40003 ustep: 1 
iter: 2  value: 724.2178 mgc: 4.619026 ustep: 1 
iter: 3  value: 724.211 mgc: 0.1917865 ustep: 1 
iter: 4  value: 724.211 mgc: 0.0007767684 ustep: 1 
iter: 5  value: 724.211 mgc: 2.316372e-08 ustep: 1 
mgc: 5.662137e-14 
iter: 1  value: 649.5589 mgc: 9.088761 ustep: 1 
iter: 2  value: 649.5327 mgc: 0.26473 ustep: 1 
iter: 3  value: 649.5327 mgc: 0.0008113187 ustep: 1 
iter: 4  value: 649.5327 mgc: 1.15115e-08 ustep: 1 
mgc: 3.164136e-14 
iter: 1  mgc: 3.164136e-14 
outer mgc:  38.08452 
iter: 1  value: 639.52 mgc: 3.696675 ustep: 1 
iter: 2  value: 639.5164 mgc: 0.07609543 ustep: 1 
iter: 3  value: 639.5164 mgc: 0.0001603793 ustep: 1 
iter: 4  mgc: 1.589742e-09 
iter: 1  mgc: 1.589742e-09 
outer mgc:  31.03966 
iter: 1  value: 635.5697 mgc: 13.66263 ustep: 1 
iter: 2  value: 627.6389 mgc: 3.551732 ustep: 1 
iter: 3  value: 627.6159 mgc: 0.177653 ustep: 1 
iter: 4  value: 627.6159 mgc: 0.001141141 ustep: 1 
iter: 5  value: 627.6159 mgc: 4.79127e-08 ustep: 1 
mgc: 5.034861e-14 
iter: 1  mgc: 5.034861e-14 
outer mgc:  43.16976 
iter: 1  value: 608.5302 mgc: 7.435326 ustep: 1 
iter: 2  value: 607.2123 mgc: 1.064512 ustep: 1 
iter: 3  value: 607.2116 mgc: 0.02932661 ustep: 1 
iter: 4  value: 607.2116 mgc: 3.625745e-05 ustep: 1 
iter: 5  mgc: 5.715783e-11 
iter: 1  value: 596.4245 mgc: 9.806304 ustep: 1 
iter: 2  value: 593.7926 mgc: 1.649968 ustep: 1 
iter: 3  value: 593.791 mgc: 0.04869631 ustep: 1 
iter: 4  value: 593.791 mgc: 6.005703e-05 ustep: 1 
iter: 5  mgc: 9.16287e-11 
iter: 1  mgc: 9.16287e-11 
outer mgc:  89.24059 
iter: 1  value: 619.1155 mgc: 12.61301 ustep: 1 
iter: 2  value: 616.2027 mgc: 2.456629 ustep: 1 
iter: 3  value: 616.202 mgc: 0.04133084 ustep: 1 
iter: 4  value: 616.202 mgc: 2.019007e-05 ustep: 1 
iter: 5  mgc: 5.226042e-12 
iter: 1  value: 587.6684 mgc: 10.58468 ustep: 1 
iter: 2  value: 587.6344 mgc: 0.2599918 ustep: 1 
iter: 3  value: 587.6344 mgc: 0.0007280247 ustep: 1 
iter: 4  mgc: 5.817042e-09 
iter: 1  mgc: 5.817042e-09 
outer mgc:  115.8588 
iter: 1  value: 573.756 mgc: 9.901579 ustep: 1 
iter: 2  value: 573.3555 mgc: 0.9102839 ustep: 1 
iter: 3  value: 573.3554 mgc: 0.008727867 ustep: 1 
iter: 4  value: 573.3554 mgc: 8.257157e-07 ustep: 1 
iter: 5  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  61.81324 
iter: 1  value: 568.8896 mgc: 21.95806 ustep: 1 
iter: 2  value: 568.6912 mgc: 0.8804636 ustep: 1 
iter: 3  value: 568.6912 mgc: 0.002838661 ustep: 1 
iter: 4  value: 568.6912 mgc: 4.142537e-08 ustep: 1 
mgc: 4.318768e-14 
iter: 1  mgc: 4.318768e-14 
outer mgc:  55.29668 
iter: 1  value: 557.6137 mgc: 6.965718 ustep: 1 
iter: 2  value: 557.3942 mgc: 0.6093053 ustep: 1 
iter: 3  value: 557.3942 mgc: 0.003634508 ustep: 1 
iter: 4  value: 557.3942 mgc: 1.879785e-07 ustep: 1 
iter: 5  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  24.52071 
iter: 1  value: 563.0096 mgc: 12.53112 ustep: 1 
iter: 2  value: 562.7062 mgc: 0.7155223 ustep: 1 
iter: 3  value: 562.7062 mgc: 0.004657855 ustep: 1 
iter: 4  value: 562.7062 mgc: 2.702547e-07 ustep: 1 
iter: 5  mgc: 3.419487e-14 
iter: 1  value: 554.2186 mgc: 2.557469 ustep: 1 
iter: 2  value: 554.2179 mgc: 0.05486244 ustep: 1 
iter: 3  value: 554.2179 mgc: 2.828206e-05 ustep: 1 
iter: 4  mgc: 7.56506e-12 
iter: 1  mgc: 7.56506e-12 
outer mgc:  13.38981 
iter: 1  value: 551.0987 mgc: 1.248685 ustep: 1 
iter: 2  value: 551.0987 mgc: 0.01899316 ustep: 1 
iter: 3  value: 551.0987 mgc: 1.65401e-06 ustep: 1 
iter: 4  mgc: 2.848416e-14 
iter: 1  mgc: 2.848416e-14 
outer mgc:  19.51915 
iter: 1  value: 551.7762 mgc: 6.206857 ustep: 1 
iter: 2  value: 551.7683 mgc: 0.1155691 ustep: 1 
iter: 3  value: 551.7683 mgc: 0.0001378686 ustep: 1 
iter: 4  mgc: 3.287521e-10 
iter: 1  value: 550.6145 mgc: 1.892692 ustep: 1 
iter: 2  value: 550.6144 mgc: 0.008629225 ustep: 1 
iter: 3  value: 550.6144 mgc: 9.578222e-07 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  8.066669 
iter: 1  value: 549.5184 mgc: 1.967261 ustep: 1 
iter: 2  value: 549.5184 mgc: 0.009204712 ustep: 1 
iter: 3  value: 549.5184 mgc: 4.244003e-07 ustep: 1 
iter: 4  mgc: 5.240253e-14 
iter: 1  mgc: 5.240253e-14 
outer mgc:  7.376155 
iter: 1  value: 549.249 mgc: 2.038999 ustep: 1 
iter: 2  value: 549.2489 mgc: 0.0131513 ustep: 1 
iter: 3  value: 549.2489 mgc: 1.830115e-06 ustep: 1 
iter: 4  mgc: 7.549517e-14 
iter: 1  mgc: 7.549517e-14 
outer mgc:  3.755539 
iter: 1  value: 548.5289 mgc: 1.232577 ustep: 1 
iter: 2  value: 548.5289 mgc: 0.004326346 ustep: 1 
iter: 3  value: 548.5289 mgc: 1.156564e-07 ustep: 1 
iter: 4  mgc: 3.109145e-14 
iter: 1  mgc: 3.109145e-14 
outer mgc:  2.823755 
iter: 1  value: 548.3582 mgc: 0.9968181 ustep: 1 
iter: 2  value: 548.3582 mgc: 0.004679077 ustep: 1 
iter: 3  value: 548.3582 mgc: 2.294739e-07 ustep: 1 
iter: 4  mgc: 3.974598e-14 
iter: 1  mgc: 3.974598e-14 
outer mgc:  4.419558 
iter: 1  value: 548.4242 mgc: 0.970854 ustep: 1 
iter: 2  value: 548.4242 mgc: 0.003135766 ustep: 1 
iter: 3  value: 548.4242 mgc: 1.248842e-07 ustep: 1 
iter: 4  mgc: 5.040413e-14 
iter: 1  value: 548.3088 mgc: 0.2435448 ustep: 1 
iter: 2  value: 548.3088 mgc: 0.0001340025 ustep: 1 
iter: 3  mgc: 1.978631e-10 
iter: 1  mgc: 1.978631e-10 
outer mgc:  2.332358 
iter: 1  value: 548.1714 mgc: 0.4720742 ustep: 1 
iter: 2  value: 548.1714 mgc: 0.0005293855 ustep: 1 
iter: 3  mgc: 1.954625e-09 
iter: 1  mgc: 1.954625e-09 
outer mgc:  1.502713 
iter: 1  value: 548.0869 mgc: 0.2064721 ustep: 1 
iter: 2  value: 548.0869 mgc: 0.0004364164 ustep: 1 
iter: 3  mgc: 2.070093e-09 
iter: 1  value: 548.1034 mgc: 0.08637383 ustep: 1 
iter: 2  value: 548.1034 mgc: 5.754503e-05 ustep: 1 
iter: 3  mgc: 3.680878e-11 
iter: 1  mgc: 3.680878e-11 
outer mgc:  1.414865 
iter: 1  value: 548.0326 mgc: 0.1943376 ustep: 1 
iter: 2  value: 548.0326 mgc: 0.0002822072 ustep: 1 
iter: 3  mgc: 7.060068e-10 
iter: 1  mgc: 7.060068e-10 
outer mgc:  1.003092 
iter: 1  value: 547.9738 mgc: 0.07192553 ustep: 1 
iter: 2  value: 547.9738 mgc: 4.54652e-05 ustep: 1 
iter: 3  mgc: 2.194289e-11 
iter: 1  mgc: 2.194289e-11 
outer mgc:  0.7779481 
iter: 1  value: 547.9306 mgc: 0.1890382 ustep: 1 
iter: 2  value: 547.9306 mgc: 0.0001987148 ustep: 1 
iter: 3  mgc: 2.983356e-10 
iter: 1  mgc: 2.983356e-10 
outer mgc:  0.4757538 
iter: 1  value: 547.8874 mgc: 0.1418939 ustep: 1 
iter: 2  value: 547.8874 mgc: 0.0001580294 ustep: 1 
iter: 3  mgc: 2.126788e-10 
iter: 1  mgc: 2.126788e-10 
outer mgc:  0.8402417 
iter: 1  value: 547.7997 mgc: 0.3098223 ustep: 1 
iter: 2  value: 547.7997 mgc: 0.0002258453 ustep: 1 
iter: 3  mgc: 4.939507e-10 
iter: 1  value: 547.893 mgc: 0.1603465 ustep: 1 
iter: 2  value: 547.893 mgc: 5.668709e-05 ustep: 1 
iter: 3  mgc: 1.265887e-11 
iter: 1  mgc: 1.265887e-11 
outer mgc:  0.6269156 
iter: 1  value: 547.8308 mgc: 0.06397057 ustep: 1 
iter: 2  value: 547.8308 mgc: 2.263294e-05 ustep: 1 
iter: 3  mgc: 3.961276e-12 
iter: 1  mgc: 3.961276e-12 
outer mgc:  0.122572 
iter: 1  value: 547.8544 mgc: 0.06385553 ustep: 1 
iter: 2  value: 547.8544 mgc: 6.736972e-06 ustep: 1 
iter: 3  mgc: 4.809486e-13 
iter: 1  value: 547.8295 mgc: 0.03029182 ustep: 1 
iter: 2  value: 547.8295 mgc: 1.433561e-06 ustep: 1 
iter: 3  mgc: 4.107825e-14 
iter: 1  mgc: 4.107825e-14 
outer mgc:  0.1765857 
iter: 1  value: 547.8408 mgc: 0.02167663 ustep: 1 
iter: 2  value: 547.8408 mgc: 1.80719e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.03211586 
iter: 1  value: 547.846 mgc: 0.005736366 ustep: 1 
iter: 2  value: 547.846 mgc: 2.498695e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  0.02457866 
iter: 1  value: 547.8338 mgc: 0.004806588 ustep: 1 
iter: 2  value: 547.8338 mgc: 1.812531e-07 ustep: 1 
iter: 3  mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  0.01308946 
iter: 1  value: 547.8429 mgc: 0.00574335 ustep: 1 
iter: 2  value: 547.8429 mgc: 2.527052e-07 ustep: 1 
iter: 3  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.009970183 
iter: 1  value: 547.8459 mgc: 0.009777676 ustep: 1 
iter: 2  value: 547.8459 mgc: 2.019426e-07 ustep: 1 
iter: 3  mgc: 3.130829e-14 
iter: 1  value: 547.8423 mgc: 0.003784053 ustep: 1 
iter: 2  value: 547.8423 mgc: 4.347427e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.01301105 
iter: 1  value: 547.8418 mgc: 0.0008041979 ustep: 1 
iter: 2  mgc: 3.313811e-09 
iter: 1  mgc: 3.313811e-09 
outer mgc:  0.001637128 
iter: 1  value: 547.8416 mgc: 0.0003894685 ustep: 1 
iter: 2  mgc: 2.195002e-09 
iter: 1  mgc: 2.195002e-09 
outer mgc:  0.001772768 
iter: 1  mgc: 2.195002e-09 
iter: 1  mgc: 2.195002e-09 
outer mgc:  0.001772768 
iter: 1  value: 547.8373 mgc: 0.02074821 ustep: 1 
iter: 2  value: 547.8373 mgc: 3.44323e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  0.2826589 
iter: 1  value: 547.8462 mgc: 0.02073284 ustep: 1 
iter: 2  value: 547.8462 mgc: 3.442529e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
outer mgc:  0.2800213 
iter: 1  value: 547.8401 mgc: 0.006238718 ustep: 1 
iter: 2  value: 547.8401 mgc: 3.069079e-07 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  0.1474266 
iter: 1  value: 547.8433 mgc: 0.006233193 ustep: 1 
iter: 2  value: 547.8433 mgc: 3.064277e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.1478212 
iter: 1  value: 547.8467 mgc: 0.05026934 ustep: 1 
iter: 2  value: 547.8467 mgc: 6.625764e-06 ustep: 1 
iter: 3  mgc: 3.295142e-13 
outer mgc:  0.3530202 
iter: 1  value: 547.8369 mgc: 0.05027772 ustep: 1 
iter: 2  value: 547.8369 mgc: 6.618641e-06 ustep: 1 
iter: 3  mgc: 3.002043e-13 
outer mgc:  0.3540081 
iter: 1  value: 547.8453 mgc: 0.02557744 ustep: 1 
iter: 2  value: 547.8453 mgc: 1.373725e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
outer mgc:  0.50748 
iter: 1  value: 547.8384 mgc: 0.02558701 ustep: 1 
iter: 2  value: 547.8384 mgc: 1.37401e-06 ustep: 1 
iter: 3  mgc: 4.62963e-14 
outer mgc:  0.5111457 
iter: 1  value: 547.8308 mgc: 0.005249203 ustep: 1 
iter: 2  value: 547.8308 mgc: 2.886046e-07 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.01072542 
iter: 1  value: 547.8525 mgc: 0.005246218 ustep: 1 
iter: 2  value: 547.8525 mgc: 2.887905e-07 ustep: 1 
iter: 3  mgc: 4.92939e-14 
outer mgc:  0.009553187 
iter: 1  value: 547.8638 mgc: 0.01363448 ustep: 1 
iter: 2  value: 547.8638 mgc: 1.628721e-06 ustep: 1 
iter: 3  mgc: 3.368139e-14 
outer mgc:  0.07712921 
iter: 1  value: 547.8195 mgc: 0.01366546 ustep: 1 
iter: 2  value: 547.8195 mgc: 1.631776e-06 ustep: 1 
iter: 3  mgc: 4.72955e-14 
outer mgc:  0.07739469 
iter: 1  value: 547.8483 mgc: 0.02404393 ustep: 1 
iter: 2  value: 547.8483 mgc: 4.769254e-06 ustep: 1 
iter: 3  mgc: 2.282619e-13 
outer mgc:  0.1124664 
iter: 1  value: 547.835 mgc: 0.02410127 ustep: 1 
iter: 2  value: 547.835 mgc: 4.781953e-06 ustep: 1 
iter: 3  mgc: 2.54019e-13 
outer mgc:  0.1137913 
[Mon Aug 16 03:23:35 2021]
Finished job 0.
1 of 1 steps (100%) done

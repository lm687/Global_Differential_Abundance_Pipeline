Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 19:56:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_80_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4408.731114 
iter  10 value 3809.490598
final  value 3809.489729 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3869.052 mgc: 5.880434 ustep: 0.6827823 
iter: 2  value: 3851.684 mgc: 5.62053 ustep: 0.8263238 
iter: 3  value: 3846.16 mgc: 5.735829 ustep: 0.9090326 
iter: 4  value: 3845.766 mgc: 5.469685 ustep: 0.7841362 
iter: 5  value: 3833.703 mgc: 5.00828 ustep: 0.661594 
iter: 6  value: 3833.561 mgc: 0.7219588 ustep: 0.8134029 
iter: 7  value: 3833.559 mgc: 0.07415028 ustep: 0.9018983 
iter: 8  value: 3833.559 mgc: 0.004406603 ustep: 0.9496883 
iter: 9  value: 3833.559 mgc: 0.0001752468 ustep: 0.9745221 
iter: 10  value: 3833.559 mgc: 3.881895e-06 ustep: 0.9871801 
iter: 11  value: 3833.559 mgc: 4.270522e-08 ustep: 0.99357 
iter: 12  mgc: 2.338942e-10 
iter: 1  mgc: 2.338942e-10 
Matching hessian patterns... Done
outer mgc:  29.09564 
iter: 1  value: 3790.365 mgc: 1.468471 ustep: 1 
iter: 2  value: 3790.35 mgc: 0.1092827 ustep: 1 
iter: 3  value: 3790.35 mgc: 0.001052247 ustep: 1 
iter: 4  value: 3790.35 mgc: 1.05864e-07 ustep: 1 
iter: 5  mgc: 2.720046e-15 
iter: 1  value: 3833.324 mgc: 22.65969 ustep: 1 
iter: 2  value: 3730.786 mgc: 20.00388 ustep: 1 
iter: 3  value: 3727.49 mgc: 4.324005 ustep: 1 
iter: 4  value: 3727.487 mgc: 0.1860808 ustep: 1 
iter: 5  value: 3727.487 mgc: 0.0003023662 ustep: 1 
iter: 6  mgc: 8.513292e-10 
iter: 1  mgc: 8.513292e-10 
outer mgc:  53.09165 
iter: 1  value: 4521.844 mgc: 38.44087 ustep: 1 
iter: 2  value: 4520.373 mgc: 4.608974 ustep: 1 
iter: 3  value: 4520.373 mgc: 0.1143047 ustep: 1 
iter: 4  value: 4520.373 mgc: 2.692065e-05 ustep: 1 
iter: 5  mgc: 6.089351e-12 
iter: 1  value: 3707.665 mgc: 4.251818 ustep: 1 
iter: 2  value: 3707.657 mgc: 0.247003 ustep: 1 
iter: 3  value: 3707.657 mgc: 0.00107685 ustep: 1 
iter: 4  value: 3707.657 mgc: 2.067745e-08 ustep: 1 
mgc: 2.456368e-14 
iter: 1  mgc: 2.456368e-14 
outer mgc:  19.60927 
iter: 1  value: 3700.502 mgc: 2.507829 ustep: 1 
iter: 2  value: 3700.501 mgc: 0.05696888 ustep: 1 
iter: 3  value: 3700.501 mgc: 8.288571e-05 ustep: 1 
iter: 4  mgc: 1.78375e-10 
iter: 1  mgc: 1.78375e-10 
outer mgc:  14.90316 
iter: 1  value: 3698.193 mgc: 12.64771 ustep: 1 
iter: 2  value: 3694.714 mgc: 5.036261 ustep: 1 
iter: 3  value: 3694.7 mgc: 0.3818949 ustep: 1 
iter: 4  value: 3694.7 mgc: 0.004310833 ustep: 1 
iter: 5  value: 3694.7 mgc: 5.725912e-07 ustep: 1 
iter: 6  mgc: 5.417888e-14 
iter: 1  mgc: 5.417888e-14 
outer mgc:  27.7955 
iter: 1  value: 3703.077 mgc: 58.26733 ustep: 1 
iter: 2  value: 3702.091 mgc: 4.383923 ustep: 1 
iter: 3  value: 3702.089 mgc: 0.1099366 ustep: 1 
iter: 4  value: 3702.089 mgc: 0.001001715 ustep: 1 
iter: 5  value: 3702.089 mgc: 8.634584e-08 ustep: 1 
iter: 6  mgc: 3.019807e-14 
iter: 1  value: 3684.239 mgc: 4.051846 ustep: 1 
iter: 2  value: 3684.219 mgc: 0.262197 ustep: 1 
iter: 3  value: 3684.219 mgc: 0.002063914 ustep: 1 
iter: 4  value: 3684.219 mgc: 1.241151e-07 ustep: 1 
iter: 5  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  22.40872 
iter: 1  value: 3681.333 mgc: 12.65814 ustep: 1 
iter: 2  value: 3680.76 mgc: 1.578418 ustep: 1 
iter: 3  value: 3680.76 mgc: 0.02486335 ustep: 1 
iter: 4  value: 3680.76 mgc: 1.537324e-05 ustep: 1 
iter: 5  mgc: 4.766409e-12 
iter: 1  mgc: 4.766409e-12 
outer mgc:  25.59412 
iter: 1  value: 3672.417 mgc: 9.834373 ustep: 1 
iter: 2  value: 3672.371 mgc: 0.6727491 ustep: 1 
iter: 3  value: 3672.371 mgc: 0.004432371 ustep: 1 
iter: 4  value: 3672.371 mgc: 1.976982e-07 ustep: 1 
mgc: 6.032674e-14 
iter: 1  mgc: 6.032674e-14 
outer mgc:  19.58598 
iter: 1  value: 3671.459 mgc: 6.716926 ustep: 1 
iter: 2  value: 3671.447 mgc: 0.4034712 ustep: 1 
iter: 3  value: 3671.447 mgc: 0.0005433181 ustep: 1 
iter: 4  mgc: 2.733279e-09 
iter: 1  value: 3670.432 mgc: 3.690235 ustep: 1 
iter: 2  value: 3670.429 mgc: 0.1710975 ustep: 1 
iter: 3  value: 3670.429 mgc: 0.0003168027 ustep: 1 
iter: 4  mgc: 1.093845e-09 
iter: 1  mgc: 1.093845e-09 
outer mgc:  7.748827 
iter: 1  value: 3670.974 mgc: 3.705931 ustep: 1 
iter: 2  value: 3670.974 mgc: 0.04759391 ustep: 1 
iter: 3  value: 3670.974 mgc: 3.265896e-05 ustep: 1 
iter: 4  mgc: 1.702516e-11 
iter: 1  mgc: 1.702516e-11 
outer mgc:  10.11399 
iter: 1  value: 3672.749 mgc: 2.648423 ustep: 1 
iter: 2  value: 3672.749 mgc: 0.03188831 ustep: 1 
iter: 3  value: 3672.749 mgc: 8.950361e-06 ustep: 1 
iter: 4  mgc: 4.263256e-13 
iter: 1  value: 3671.147 mgc: 2.250431 ustep: 1 
iter: 2  value: 3671.147 mgc: 0.0150784 ustep: 1 
iter: 3  value: 3671.147 mgc: 1.180013e-06 ustep: 1 
iter: 4  mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  5.609496 
iter: 1  value: 3670.355 mgc: 1.538284 ustep: 1 
iter: 2  value: 3670.355 mgc: 0.01707075 ustep: 1 
iter: 3  value: 3670.355 mgc: 2.932334e-06 ustep: 1 
iter: 4  mgc: 1.04583e-13 
iter: 1  mgc: 1.04583e-13 
outer mgc:  3.34017 
iter: 1  value: 3670.287 mgc: 1.76433 ustep: 1 
iter: 2  value: 3670.287 mgc: 0.01445374 ustep: 1 
iter: 3  value: 3670.287 mgc: 3.070392e-06 ustep: 1 
iter: 4  mgc: 1.185718e-13 
iter: 1  value: 3670.167 mgc: 0.6041598 ustep: 1 
iter: 2  value: 3670.167 mgc: 0.001716253 ustep: 1 
iter: 3  value: 3670.167 mgc: 4.182506e-08 ustep: 1 
mgc: 1.334488e-13 
iter: 1  mgc: 1.334488e-13 
outer mgc:  2.060412 
iter: 1  value: 3670.13 mgc: 0.9289575 ustep: 1 
iter: 2  value: 3670.13 mgc: 0.003351647 ustep: 1 
iter: 3  value: 3670.13 mgc: 4.317838e-08 ustep: 1 
mgc: 5.306866e-14 
iter: 1  value: 3670.155 mgc: 0.5072965 ustep: 1 
iter: 2  value: 3670.155 mgc: 0.0009894199 ustep: 1 
iter: 3  mgc: 3.733204e-09 
iter: 1  mgc: 3.733204e-09 
outer mgc:  1.454575 
iter: 1  value: 3670.022 mgc: 0.3388277 ustep: 1 
iter: 2  value: 3670.022 mgc: 0.0003558488 ustep: 1 
iter: 3  mgc: 1.8943e-09 
iter: 1  mgc: 1.8943e-09 
outer mgc:  1.113615 
iter: 1  value: 3669.828 mgc: 0.4805548 ustep: 1 
iter: 2  value: 3669.828 mgc: 0.0003983907 ustep: 1 
iter: 3  mgc: 8.719985e-10 
iter: 1  mgc: 8.719985e-10 
outer mgc:  1.021627 
iter: 1  value: 3669.521 mgc: 0.4297776 ustep: 1 
iter: 2  value: 3669.521 mgc: 0.001226698 ustep: 1 
iter: 3  value: 3669.521 mgc: 2.091391e-08 ustep: 1 
mgc: 6.661338e-14 
iter: 1  value: 3669.025 mgc: 0.7359937 ustep: 1 
iter: 2  value: 3669.025 mgc: 0.003533838 ustep: 1 
iter: 3  value: 3669.025 mgc: 1.072309e-07 ustep: 1 
mgc: 7.027712e-14 
iter: 1  mgc: 7.027712e-14 
outer mgc:  0.9707726 
iter: 1  value: 3667.99 mgc: 1.457024 ustep: 1 
iter: 2  value: 3667.99 mgc: 0.01233102 ustep: 1 
iter: 3  value: 3667.99 mgc: 1.740915e-06 ustep: 1 
iter: 4  mgc: 7.785439e-14 
iter: 1  mgc: 7.785439e-14 
outer mgc:  4.095024 
iter: 1  value: 3667.629 mgc: 3.594169 ustep: 1 
iter: 2  value: 3667.628 mgc: 0.03271584 ustep: 1 
iter: 3  value: 3667.628 mgc: 8.77288e-06 ustep: 1 
iter: 4  mgc: 1.495692e-12 
iter: 1  value: 3667.833 mgc: 1.060115 ustep: 1 
iter: 2  value: 3667.833 mgc: 0.003326789 ustep: 1 
iter: 3  value: 3667.833 mgc: 7.703258e-08 ustep: 1 
iter: 4  mgc: 7.127632e-14 
iter: 1  mgc: 7.127632e-14 
outer mgc:  1.746146 
iter: 1  value: 3667.845 mgc: 0.7260796 ustep: 1 
iter: 2  value: 3667.845 mgc: 0.001211262 ustep: 1 
iter: 3  mgc: 7.24993e-09 
iter: 1  value: 3667.812 mgc: 0.3386822 ustep: 1 
iter: 2  value: 3667.812 mgc: 0.0002607742 ustep: 1 
iter: 3  mgc: 3.4318e-10 
iter: 1  mgc: 3.4318e-10 
outer mgc:  0.9754324 
iter: 1  value: 3667.663 mgc: 0.345851 ustep: 1 
iter: 2  value: 3667.663 mgc: 0.0002048046 ustep: 1 
iter: 3  mgc: 2.873664e-10 
iter: 1  mgc: 2.873664e-10 
outer mgc:  0.5277448 
iter: 1  value: 3667.705 mgc: 0.1023687 ustep: 1 
iter: 2  value: 3667.705 mgc: 4.083701e-05 ustep: 1 
iter: 3  mgc: 6.520118e-12 
iter: 1  value: 3667.748 mgc: 0.143124 ustep: 1 
iter: 2  value: 3667.748 mgc: 9.930395e-05 ustep: 1 
iter: 3  mgc: 1.577369e-10 
iter: 1  mgc: 1.577369e-10 
outer mgc:  0.4036965 
iter: 1  value: 3667.46 mgc: 0.4055782 ustep: 1 
iter: 2  value: 3667.46 mgc: 0.0009998339 ustep: 1 
iter: 3  mgc: 6.179979e-09 
iter: 1  mgc: 6.179979e-09 
outer mgc:  0.6201466 
iter: 1  value: 3667.259 mgc: 0.3426627 ustep: 1 
iter: 2  value: 3667.259 mgc: 0.0005578502 ustep: 1 
iter: 3  mgc: 2.69234e-09 
iter: 1  value: 3667.072 mgc: 0.3891883 ustep: 1 
iter: 2  value: 3667.072 mgc: 0.0004652294 ustep: 1 
iter: 3  mgc: 1.672531e-09 
iter: 1  mgc: 1.672531e-09 
outer mgc:  1.011869 
iter: 1  value: 3666.664 mgc: 0.7217164 ustep: 1 
iter: 2  value: 3666.664 mgc: 0.00234985 ustep: 1 
iter: 3  value: 3666.664 mgc: 3.356783e-08 ustep: 1 
mgc: 7.527312e-14 
iter: 1  mgc: 7.527312e-14 
outer mgc:  0.4283203 
iter: 1  value: 3666.175 mgc: 0.4894611 ustep: 1 
iter: 2  value: 3666.175 mgc: 0.001191757 ustep: 1 
iter: 3  value: 3666.175 mgc: 1.287838e-08 ustep: 1 
mgc: 7.838175e-14 
iter: 1  mgc: 7.838175e-14 
outer mgc:  0.4356319 
iter: 1  value: 3666.038 mgc: 0.6833898 ustep: 1 
iter: 2  value: 3666.038 mgc: 0.001567274 ustep: 1 
iter: 3  value: 3666.038 mgc: 2.077049e-08 ustep: 1 
mgc: 7.549517e-14 
iter: 1  mgc: 7.549517e-14 
outer mgc:  0.202145 
iter: 1  value: 3665.928 mgc: 0.3546786 ustep: 1 
iter: 2  value: 3665.928 mgc: 0.0002457436 ustep: 1 
iter: 3  mgc: 3.617826e-10 
iter: 1  mgc: 3.617826e-10 
outer mgc:  0.2220152 
iter: 1  value: 3665.968 mgc: 0.182483 ustep: 1 
iter: 2  value: 3665.968 mgc: 9.012055e-05 ustep: 1 
iter: 3  mgc: 3.667422e-11 
iter: 1  mgc: 3.667422e-11 
outer mgc:  0.01121643 
iter: 1  value: 3665.961 mgc: 0.02166492 ustep: 1 
iter: 2  value: 3665.961 mgc: 1.636799e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  0.001602725 
iter: 1  value: 3665.959 mgc: 0.001126636 ustep: 1 
iter: 2  mgc: 4.792514e-09 
iter: 1  mgc: 4.792514e-09 
outer mgc:  0.0001903442 
iter: 1  mgc: 4.792514e-09 
iter: 1  mgc: 4.792514e-09 
outer mgc:  0.0001903442 
iter: 1  value: 3665.961 mgc: 0.02821832 ustep: 1 
iter: 2  value: 3665.961 mgc: 2.311674e-06 ustep: 1 
iter: 3  mgc: 1.478817e-13 
outer mgc:  0.1897777 
iter: 1  value: 3665.957 mgc: 0.02821625 ustep: 1 
iter: 2  value: 3665.957 mgc: 2.304012e-06 ustep: 1 
iter: 3  mgc: 2.058353e-13 
outer mgc:  0.1900938 
iter: 1  value: 3665.96 mgc: 0.01456966 ustep: 1 
iter: 2  value: 3665.96 mgc: 6.50175e-07 ustep: 1 
iter: 3  mgc: 8.737455e-14 
outer mgc:  0.1721929 
iter: 1  value: 3665.958 mgc: 0.01456831 ustep: 1 
iter: 2  value: 3665.958 mgc: 6.492698e-07 ustep: 1 
iter: 3  mgc: 9.148238e-14 
outer mgc:  0.1725914 
iter: 1  value: 3665.957 mgc: 0.01400753 ustep: 1 
iter: 2  value: 3665.957 mgc: 1.152186e-06 ustep: 1 
iter: 3  mgc: 6.039613e-14 
outer mgc:  0.1370506 
iter: 1  value: 3665.961 mgc: 0.01399343 ustep: 1 
iter: 2  value: 3665.961 mgc: 1.151332e-06 ustep: 1 
iter: 3  mgc: 1.012523e-13 
outer mgc:  0.1368719 
iter: 1  value: 3665.958 mgc: 0.006851479 ustep: 1 
iter: 2  value: 3665.958 mgc: 2.796444e-07 ustep: 1 
iter: 3  mgc: 5.817569e-14 
outer mgc:  0.08101304 
iter: 1  value: 3665.96 mgc: 0.006845508 ustep: 1 
iter: 2  value: 3665.96 mgc: 2.793051e-07 ustep: 1 
iter: 3  mgc: 7.01661e-14 
outer mgc:  0.08102227 
iter: 1  value: 3665.964 mgc: 0.02997002 ustep: 1 
iter: 2  value: 3665.964 mgc: 1.489549e-06 ustep: 1 
iter: 3  mgc: 8.670842e-14 
outer mgc:  0.05613903 
iter: 1  value: 3665.953 mgc: 0.03005551 ustep: 1 
iter: 2  value: 3665.953 mgc: 1.490752e-06 ustep: 1 
iter: 3  mgc: 7.860379e-14 
outer mgc:  0.05584237 
iter: 1  value: 3665.97 mgc: 0.02596928 ustep: 1 
iter: 2  value: 3665.97 mgc: 2.467951e-06 ustep: 1 
iter: 3  mgc: 8.465451e-14 
outer mgc:  0.04122738 
iter: 1  value: 3665.948 mgc: 0.0260447 ustep: 1 
iter: 2  value: 3665.948 mgc: 2.469665e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.04133126 
iter: 1  value: 3665.954 mgc: 0.005511389 ustep: 1 
iter: 2  value: 3665.954 mgc: 1.005904e-07 ustep: 1 
mgc: 5.329071e-14 
outer mgc:  0.001037822 
iter: 1  value: 3665.964 mgc: 0.005509281 ustep: 1 
iter: 2  value: 3665.964 mgc: 1.007139e-07 ustep: 1 
mgc: 5.684342e-14 
outer mgc:  0.001363672 
iter: 1  value: 3665.954 mgc: 0.00309721 ustep: 1 
iter: 2  value: 3665.954 mgc: 3.463791e-08 ustep: 1 
mgc: 1.014744e-13 
outer mgc:  0.005469853 
iter: 1  value: 3665.964 mgc: 0.003097778 ustep: 1 
iter: 2  value: 3665.964 mgc: 3.463077e-08 ustep: 1 
mgc: 7.238654e-14 
outer mgc:  0.005722686 
[Sun Aug 15 19:56:59 2021]
Finished job 0.
1 of 1 steps (100%) done

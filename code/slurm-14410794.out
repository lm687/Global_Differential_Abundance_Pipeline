Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:25:35 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4501.014547 
final  value 4153.441224 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3830.593 mgc: 3.204819 ustep: 1 
iter: 2  value: 3825.191 mgc: 2.989733 ustep: 1 
iter: 3  value: 3823.478 mgc: 1.987868 ustep: 1 
iter: 4  value: 3822.921 mgc: 1.459127 ustep: 1 
iter: 5  value: 3822.913 mgc: 0.1630036 ustep: 1 
iter: 6  value: 3822.913 mgc: 0.0004928737 ustep: 1 
iter: 7  value: 3822.913 mgc: 1.14562e-07 ustep: 1 
iter: 8  mgc: 4.385381e-15 
iter: 1  mgc: 4.385381e-15 
Matching hessian patterns... Done
outer mgc:  16.3552 
iter: 1  value: 3790.438 mgc: 1.360349 ustep: 1 
iter: 2  value: 3790.433 mgc: 0.09423254 ustep: 1 
iter: 3  value: 3790.433 mgc: 0.0005545925 ustep: 1 
iter: 4  value: 3790.433 mgc: 2.456426e-08 ustep: 1 
iter: 5  mgc: 3.219647e-15 
iter: 1  value: 3735.27 mgc: 41.14798 ustep: 1 
iter: 2  value: 3734.768 mgc: 1.231116 ustep: 1 
iter: 3  value: 3734.768 mgc: 0.0410241 ustep: 1 
iter: 4  value: 3734.768 mgc: 7.611614e-06 ustep: 1 
iter: 5  mgc: 1.501299e-12 
iter: 1  mgc: 1.501299e-12 
outer mgc:  36.41032 
iter: 1  value: 3837.335 mgc: 227.7007 ustep: 1 
iter: 2  value: 3837.301 mgc: 0.6766647 ustep: 1 
iter: 3  value: 3837.301 mgc: 0.001067219 ustep: 1 
iter: 4  mgc: 2.688027e-09 
iter: 1  value: 3725.566 mgc: 5.849411 ustep: 1 
iter: 2  value: 3725.499 mgc: 0.2633181 ustep: 1 
iter: 3  value: 3725.499 mgc: 0.001220803 ustep: 1 
iter: 4  value: 3725.499 mgc: 4.255075e-08 ustep: 1 
iter: 5  mgc: 3.774758e-15 
iter: 1  mgc: 3.774758e-15 
outer mgc:  23.3688 
iter: 1  value: 3718.902 mgc: 2.599626 ustep: 1 
iter: 2  value: 3718.901 mgc: 0.0436531 ustep: 1 
iter: 3  value: 3718.901 mgc: 4.220212e-06 ustep: 1 
iter: 4  mgc: 1.181277e-13 
iter: 1  mgc: 1.181277e-13 
outer mgc:  15.12409 
iter: 1  value: 3699.172 mgc: 6.409124 ustep: 1 
iter: 2  value: 3699.172 mgc: 0.00683271 ustep: 1 
iter: 3  value: 3699.172 mgc: 1.301576e-07 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  10.42153 
iter: 1  value: 3717.449 mgc: 5.621211 ustep: 1 
iter: 2  value: 3717.448 mgc: 0.06224618 ustep: 1 
iter: 3  value: 3717.448 mgc: 4.671898e-06 ustep: 1 
iter: 4  mgc: 1.480482e-13 
iter: 1  value: 3699.076 mgc: 1.387886 ustep: 1 
iter: 2  value: 3699.076 mgc: 0.003418597 ustep: 1 
iter: 3  value: 3699.076 mgc: 5.178774e-08 ustep: 1 
iter: 4  mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  9.373786 
iter: 1  value: 3699.85 mgc: 1.90998 ustep: 1 
iter: 2  value: 3699.85 mgc: 0.002285143 ustep: 1 
iter: 3  mgc: 7.994994e-09 
iter: 1  mgc: 7.994994e-09 
outer mgc:  7.70003 
iter: 1  value: 3701.525 mgc: 2.738892 ustep: 1 
iter: 2  value: 3701.525 mgc: 0.00759542 ustep: 1 
iter: 3  value: 3701.525 mgc: 1.534153e-07 ustep: 1 
iter: 4  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  1.988172 
iter: 1  value: 3703.676 mgc: 1.407277 ustep: 1 
iter: 2  value: 3703.676 mgc: 0.01097533 ustep: 1 
iter: 3  value: 3703.676 mgc: 6.249504e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  2.697388 
iter: 1  value: 3710.287 mgc: 2.354452 ustep: 1 
iter: 2  value: 3710.286 mgc: 0.07347341 ustep: 1 
iter: 3  value: 3710.286 mgc: 2.715109e-05 ustep: 1 
iter: 4  mgc: 2.542078e-11 
iter: 1  mgc: 2.542078e-11 
outer mgc:  1.266256 
iter: 1  value: 3712.137 mgc: 4.041378 ustep: 1 
iter: 2  value: 3712.137 mgc: 0.05247327 ustep: 1 
iter: 3  value: 3712.137 mgc: 1.281245e-05 ustep: 1 
iter: 4  mgc: 1.598333e-12 
iter: 1  value: 3710.803 mgc: 1.04988 ustep: 1 
iter: 2  value: 3710.803 mgc: 0.003858746 ustep: 1 
iter: 3  value: 3710.803 mgc: 2.333078e-07 ustep: 1 
iter: 4  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  2.571334 
iter: 1  value: 3710.444 mgc: 0.6468692 ustep: 1 
iter: 2  value: 3710.444 mgc: 0.001011496 ustep: 1 
iter: 3  value: 3710.444 mgc: 1.033654e-08 ustep: 1 
mgc: 6.994405e-15 
iter: 1  mgc: 6.994405e-15 
outer mgc:  1.700351 
iter: 1  value: 3710.565 mgc: 1.428118 ustep: 1 
iter: 2  value: 3710.565 mgc: 0.006892806 ustep: 1 
iter: 3  value: 3710.565 mgc: 4.273701e-07 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.7925798 
iter: 1  value: 3711.216 mgc: 0.386697 ustep: 1 
iter: 2  value: 3711.216 mgc: 0.002800983 ustep: 1 
iter: 3  value: 3711.216 mgc: 8.452401e-08 ustep: 1 
iter: 4  mgc: 5.606626e-15 
iter: 1  mgc: 5.606626e-15 
outer mgc:  1.844103 
iter: 1  value: 3711.285 mgc: 0.4658991 ustep: 1 
iter: 2  value: 3711.285 mgc: 0.0002713229 ustep: 1 
iter: 3  mgc: 1.883505e-09 
iter: 1  mgc: 1.883505e-09 
outer mgc:  0.3328111 
iter: 1  value: 3710.738 mgc: 0.4154429 ustep: 1 
iter: 2  value: 3710.738 mgc: 0.0008805696 ustep: 1 
iter: 3  mgc: 4.594122e-09 
iter: 1  mgc: 4.594122e-09 
outer mgc:  0.4109428 
iter: 1  value: 3710.488 mgc: 0.3688855 ustep: 1 
iter: 2  value: 3710.488 mgc: 9.881128e-05 ustep: 1 
iter: 3  mgc: 5.299721e-10 
iter: 1  mgc: 5.299721e-10 
outer mgc:  0.4671881 
iter: 1  value: 3710.567 mgc: 0.09340412 ustep: 1 
iter: 2  value: 3710.567 mgc: 0.0001504467 ustep: 1 
iter: 3  mgc: 3.222604e-10 
iter: 1  mgc: 3.222604e-10 
outer mgc:  0.1974409 
iter: 1  value: 3710.147 mgc: 0.1664546 ustep: 1 
iter: 2  value: 3710.147 mgc: 5.055162e-05 ustep: 1 
iter: 3  mgc: 2.799538e-11 
iter: 1  value: 3708.985 mgc: 0.4963784 ustep: 1 
iter: 2  value: 3708.985 mgc: 0.0004833999 ustep: 1 
iter: 3  mgc: 2.781347e-09 
iter: 1  mgc: 2.781347e-09 
outer mgc:  0.6346549 
iter: 1  value: 3707.727 mgc: 0.7070483 ustep: 1 
iter: 2  value: 3707.727 mgc: 0.001838904 ustep: 1 
iter: 3  value: 3707.727 mgc: 2.583745e-08 ustep: 1 
mgc: 8.548717e-15 
iter: 1  value: 3706.51 mgc: 0.7051679 ustep: 1 
iter: 2  value: 3706.51 mgc: 0.00148955 ustep: 1 
iter: 3  value: 3706.51 mgc: 1.207736e-08 ustep: 1 
mgc: 9.547918e-15 
iter: 1  mgc: 9.547918e-15 
outer mgc:  0.8341717 
iter: 1  value: 3704.756 mgc: 1.210768 ustep: 1 
iter: 2  value: 3704.756 mgc: 0.0007297624 ustep: 1 
iter: 3  value: 3704.756 mgc: 4.478081e-08 ustep: 1 
iter: 4  mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  1.078532 
iter: 1  value: 3703.504 mgc: 0.4885755 ustep: 1 
iter: 2  value: 3703.504 mgc: 0.0003799598 ustep: 1 
iter: 3  mgc: 5.326976e-09 
iter: 1  mgc: 5.326976e-09 
outer mgc:  0.250479 
iter: 1  value: 3702.617 mgc: 0.4249872 ustep: 1 
iter: 2  value: 3702.617 mgc: 0.0002283903 ustep: 1 
iter: 3  mgc: 2.698028e-10 
iter: 1  mgc: 2.698028e-10 
outer mgc:  0.06420945 
iter: 1  value: 3701.925 mgc: 0.2509729 ustep: 1 
iter: 2  value: 3701.925 mgc: 4.720286e-05 ustep: 1 
iter: 3  mgc: 2.010481e-11 
iter: 1  value: 3700.022 mgc: 0.7402257 ustep: 1 
iter: 2  value: 3700.022 mgc: 0.0002727021 ustep: 1 
iter: 3  mgc: 6.162879e-10 
iter: 1  mgc: 6.162879e-10 
outer mgc:  0.2559217 
iter: 1  value: 3698.144 mgc: 0.9826034 ustep: 1 
iter: 2  value: 3698.144 mgc: 0.0003400103 ustep: 1 
iter: 3  mgc: 9.143273e-10 
iter: 1  mgc: 9.143273e-10 
outer mgc:  0.1233231 
iter: 1  value: 3696.469 mgc: 0.8029204 ustep: 1 
iter: 2  value: 3696.469 mgc: 0.0001406728 ustep: 1 
iter: 3  mgc: 1.671454e-10 
iter: 1  mgc: 1.671454e-10 
outer mgc:  0.03174633 
iter: 1  value: 3694.288 mgc: 1.017761 ustep: 1 
iter: 2  value: 3694.288 mgc: 0.0001603652 ustep: 1 
iter: 3  mgc: 1.921205e-10 
iter: 1  mgc: 1.921205e-10 
outer mgc:  0.04174885 
iter: 1  value: 3692.299 mgc: 0.8938751 ustep: 1 
iter: 2  value: 3692.299 mgc: 8.728572e-05 ustep: 1 
iter: 3  mgc: 5.182432e-11 
iter: 1  mgc: 5.182432e-11 
outer mgc:  0.0307361 
iter: 1  value: 3690.456 mgc: 0.7994339 ustep: 1 
iter: 2  value: 3690.456 mgc: 5.265248e-05 ustep: 1 
iter: 3  mgc: 1.621592e-11 
iter: 1  mgc: 1.621592e-11 
outer mgc:  0.02147345 
iter: 1  value: 3688.78 mgc: 0.7307962 ustep: 1 
iter: 2  value: 3688.78 mgc: 2.93999e-05 ustep: 1 
iter: 3  mgc: 5.43432e-12 
iter: 1  mgc: 5.43432e-12 
outer mgc:  0.007716166 
iter: 1  value: 3687.224 mgc: 0.6717908 ustep: 1 
iter: 2  value: 3687.224 mgc: 1.93395e-05 ustep: 1 
iter: 3  mgc: 2.088996e-12 
iter: 1  mgc: 2.088996e-12 
outer mgc:  0.009410509 
iter: 1  value: 3685.794 mgc: 0.6245071 ustep: 1 
iter: 2  value: 3685.794 mgc: 1.117598e-05 ustep: 1 
iter: 3  mgc: 8.193446e-13 
iter: 1  mgc: 8.193446e-13 
outer mgc:  0.002310566 
iter: 1  value: 3684.447 mgc: 0.5782887 ustep: 1 
iter: 2  value: 3684.447 mgc: 8.138323e-06 ustep: 1 
iter: 3  mgc: 3.78364e-13 
iter: 1  mgc: 3.78364e-13 
outer mgc:  0.005985576 
iter: 1  value: 3683.382 mgc: 0.4540142 ustep: 1 
iter: 2  value: 3683.382 mgc: 3.55746e-06 ustep: 1 
iter: 3  mgc: 8.348877e-14 
iter: 1  mgc: 8.348877e-14 
outer mgc:  0.001092822 
iter: 1  value: 3682.71 mgc: 0.2766842 ustep: 1 
iter: 2  value: 3682.71 mgc: 1.3465e-06 ustep: 1 
iter: 3  mgc: 7.893686e-14 
iter: 1  mgc: 7.893686e-14 
outer mgc:  0.001869806 
iter: 1  value: 3682.428 mgc: 0.1140182 ustep: 1 
iter: 2  value: 3682.428 mgc: 1.833988e-07 ustep: 1 
iter: 3  mgc: 9.989926e-14 
iter: 1  mgc: 9.989926e-14 
outer mgc:  0.0001307214 
iter: 1  value: 3682.359 mgc: 0.02753798 ustep: 1 
iter: 2  value: 3682.359 mgc: 1.257138e-08 ustep: 1 
mgc: 1.056932e-13 
iter: 1  mgc: 1.056932e-13 
outer mgc:  6.072829e-05 
iter: 1  mgc: 1.056932e-13 
iter: 1  mgc: 1.056932e-13 
outer mgc:  6.072829e-05 
iter: 1  value: 3682.36 mgc: 0.005437406 ustep: 1 
iter: 2  value: 3682.36 mgc: 1.982546e-07 ustep: 1 
iter: 3  mgc: 8.038015e-14 
outer mgc:  0.08169038 
iter: 1  value: 3682.357 mgc: 0.00543715 ustep: 1 
iter: 2  value: 3682.357 mgc: 1.977696e-07 ustep: 1 
iter: 3  mgc: 8.970602e-14 
outer mgc:  0.08171039 
iter: 1  value: 3682.36 mgc: 0.002743591 ustep: 1 
iter: 2  value: 3682.36 mgc: 2.086155e-08 ustep: 1 
iter: 3  mgc: 6.77236e-14 
outer mgc:  0.04857263 
iter: 1  value: 3682.357 mgc: 0.002742492 ustep: 1 
iter: 2  value: 3682.357 mgc: 2.083309e-08 ustep: 1 
iter: 3  mgc: 9.05942e-14 
outer mgc:  0.04859245 
iter: 1  value: 3682.358 mgc: 0.004824981 ustep: 1 
iter: 2  value: 3682.358 mgc: 1.28314e-07 ustep: 1 
iter: 3  mgc: 6.994405e-14 
outer mgc:  0.06545377 
iter: 1  value: 3682.359 mgc: 0.004822387 ustep: 1 
iter: 2  value: 3682.359 mgc: 1.281744e-07 ustep: 1 
iter: 3  mgc: 7.827072e-14 
outer mgc:  0.06540553 
iter: 1  value: 3682.359 mgc: 0.003012928 ustep: 1 
iter: 2  value: 3682.359 mgc: 2.947819e-08 ustep: 1 
iter: 3  mgc: 9.269668e-14 
outer mgc:  0.04214902 
iter: 1  value: 3682.358 mgc: 0.003012693 ustep: 1 
iter: 2  value: 3682.358 mgc: 2.945921e-08 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  0.04209968 
iter: 1  value: 3682.372 mgc: 0.3029528 ustep: 1 
iter: 2  value: 3682.372 mgc: 6.420051e-07 ustep: 1 
iter: 3  mgc: 7.81597e-14 
outer mgc:  0.01802207 
iter: 1  value: 3682.345 mgc: 0.3038569 ustep: 1 
iter: 2  value: 3682.345 mgc: 6.437135e-07 ustep: 1 
iter: 3  mgc: 9.714451e-14 
outer mgc:  0.01796847 
iter: 1  value: 3682.373 mgc: 0.2971904 ustep: 1 
iter: 2  value: 3682.373 mgc: 1.244365e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  0.01872156 
iter: 1  value: 3682.344 mgc: 0.2974877 ustep: 1 
iter: 2  value: 3682.344 mgc: 1.240224e-06 ustep: 1 
iter: 3  mgc: 9.05942e-14 
outer mgc:  0.01870198 
iter: 1  value: 3682.357 mgc: 0.0006706155 ustep: 1 
iter: 2  mgc: 5.615508e-12 
outer mgc:  4.345031e-05 
iter: 1  value: 3682.36 mgc: 0.0006705565 ustep: 1 
iter: 2  mgc: 5.664802e-12 
outer mgc:  7.801069e-05 
iter: 1  value: 3682.354 mgc: 0.003479892 ustep: 1 
iter: 2  value: 3682.354 mgc: 5.730634e-08 ustep: 1 
iter: 3  mgc: 6.972201e-14 
outer mgc:  0.02896177 
iter: 1  value: 3682.363 mgc: 0.003477049 ustep: 1 
iter: 2  value: 3682.363 mgc: 5.722142e-08 ustep: 1 
iter: 3  mgc: 5.617729e-14 
outer mgc:  0.02907504 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:25:37 2021]
Finished job 0.
1 of 1 steps (100%) done

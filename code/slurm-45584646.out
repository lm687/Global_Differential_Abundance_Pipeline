Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:38:55 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_4_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_10_4_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_10_4_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_4_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_10_4_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_4_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_4_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_4_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2790.610549 
iter  10 value 2616.154865
final  value 2616.154694 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2413.393 mgc: 6.83593 ustep: 0.6827823 
iter: 2  value: 2412.277 mgc: 5.45756 ustep: 0.8263238 
iter: 3  value: 2404.006 mgc: 4.588192 ustep: 0.9090326 
iter: 4  value: 2403.984 mgc: 4.888839 ustep: 0.9534367 
iter: 5  value: 2396.887 mgc: 3.277735 ustep: 0.608063 
iter: 6  value: 2396.78 mgc: 0.3735703 ustep: 0.779806 
iter: 7  value: 2396.775 mgc: 0.07048905 ustep: 0.8830779 
iter: 8  value: 2396.775 mgc: 0.009120889 ustep: 0.9397283 
iter: 9  value: 2396.775 mgc: 0.0007318663 ustep: 0.9693989 
iter: 10  value: 2396.775 mgc: 3.077386e-05 ustep: 0.9845821 
iter: 11  value: 2396.775 mgc: 6.505401e-07 ustep: 0.9922619 
iter: 12  mgc: 6.887201e-09 
iter: 1  mgc: 6.887201e-09 
Matching hessian patterns... Done
outer mgc:  20.33483 
iter: 1  value: 2370.948 mgc: 1.063001 ustep: 1 
iter: 2  value: 2370.94 mgc: 0.09598782 ustep: 1 
iter: 3  value: 2370.94 mgc: 0.0009099556 ustep: 1 
iter: 4  value: 2370.94 mgc: 1.252163e-07 ustep: 1 
iter: 5  mgc: 2.997602e-15 
iter: 1  value: 2350.576 mgc: 3.637431 ustep: 1 
iter: 2  value: 2350.438 mgc: 1.296606 ustep: 1 
iter: 3  value: 2350.437 mgc: 0.05608692 ustep: 1 
iter: 4  value: 2350.437 mgc: 0.0001268599 ustep: 1 
iter: 5  mgc: 6.762373e-10 
iter: 1  mgc: 6.762373e-10 
outer mgc:  11.06307 
iter: 1  value: 2357.409 mgc: 14.10277 ustep: 1 
iter: 2  value: 2356.774 mgc: 1.39297 ustep: 1 
iter: 3  value: 2356.773 mgc: 0.1272443 ustep: 1 
iter: 4  value: 2356.773 mgc: 0.000321086 ustep: 1 
iter: 5  mgc: 7.898207e-09 
iter: 1  value: 2349.213 mgc: 3.12371 ustep: 1 
iter: 2  value: 2349.205 mgc: 0.138133 ustep: 1 
iter: 3  value: 2349.205 mgc: 0.002278315 ustep: 1 
iter: 4  value: 2349.205 mgc: 2.998853e-07 ustep: 1 
iter: 5  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  5.485059 
iter: 1  value: 2352.744 mgc: 7.795553 ustep: 1 
iter: 2  value: 2349.649 mgc: 3.473239 ustep: 1 
iter: 3  value: 2349.639 mgc: 0.2502333 ustep: 1 
iter: 4  value: 2349.639 mgc: 0.001061196 ustep: 1 
iter: 5  value: 2349.639 mgc: 3.538447e-08 ustep: 1 
mgc: 2.664535e-15 
iter: 1  value: 2345.425 mgc: 3.099572 ustep: 1 
iter: 2  value: 2345.404 mgc: 0.2170552 ustep: 1 
iter: 3  value: 2345.404 mgc: 0.003459195 ustep: 1 
iter: 4  value: 2345.404 mgc: 1.084185e-06 ustep: 1 
iter: 5  mgc: 1.108558e-13 
iter: 1  mgc: 1.108558e-13 
outer mgc:  6.149737 
iter: 1  value: 2345.032 mgc: 1.892679 ustep: 1 
iter: 2  value: 2345.029 mgc: 0.1118987 ustep: 1 
iter: 3  value: 2345.029 mgc: 0.0002570025 ustep: 1 
iter: 4  mgc: 4.254786e-09 
iter: 1  value: 2344.304 mgc: 0.8760433 ustep: 1 
iter: 2  value: 2344.304 mgc: 0.02162104 ustep: 1 
iter: 3  value: 2344.304 mgc: 1.633898e-05 ustep: 1 
iter: 4  mgc: 8.556933e-12 
iter: 1  mgc: 8.556933e-12 
outer mgc:  4.575467 
iter: 1  value: 2342.863 mgc: 1.546262 ustep: 1 
iter: 2  value: 2342.862 mgc: 0.0492883 ustep: 1 
iter: 3  value: 2342.862 mgc: 0.000118761 ustep: 1 
iter: 4  mgc: 9.773923e-10 
iter: 1  mgc: 9.773923e-10 
outer mgc:  3.963754 
iter: 1  value: 2340.34 mgc: 2.587155 ustep: 1 
iter: 2  value: 2340.328 mgc: 0.1302538 ustep: 1 
iter: 3  value: 2340.328 mgc: 0.001991471 ustep: 1 
iter: 4  value: 2340.328 mgc: 1.277128e-07 ustep: 1 
iter: 5  mgc: 5.995204e-15 
iter: 1  value: 2337.934 mgc: 4.784473 ustep: 1 
iter: 2  value: 2337.885 mgc: 0.3000197 ustep: 1 
iter: 3  value: 2337.885 mgc: 0.008775435 ustep: 1 
iter: 4  value: 2337.885 mgc: 2.36034e-06 ustep: 1 
iter: 5  mgc: 6.838974e-13 
iter: 1  mgc: 6.838974e-13 
outer mgc:  4.421746 
iter: 1  value: 2336.771 mgc: 5.274378 ustep: 1 
iter: 2  value: 2336.63 mgc: 0.3940124 ustep: 1 
iter: 3  value: 2336.63 mgc: 0.02248327 ustep: 1 
iter: 4  value: 2336.63 mgc: 3.41452e-05 ustep: 1 
iter: 5  mgc: 1.546776e-10 
iter: 1  mgc: 1.546776e-10 
outer mgc:  5.729363 
iter: 1  value: 2336.941 mgc: 2.307822 ustep: 1 
iter: 2  value: 2336.938 mgc: 0.105566 ustep: 1 
iter: 3  value: 2336.938 mgc: 0.0004565397 ustep: 1 
iter: 4  mgc: 7.662229e-09 
iter: 1  mgc: 7.662229e-09 
outer mgc:  4.21858 
iter: 1  value: 2334.499 mgc: 2.090534 ustep: 1 
iter: 2  value: 2334.498 mgc: 0.06283552 ustep: 1 
iter: 3  value: 2334.498 mgc: 0.0002248167 ustep: 1 
iter: 4  mgc: 2.247318e-09 
iter: 1  mgc: 2.247318e-09 
outer mgc:  1.750669 
iter: 1  value: 2336.838 mgc: 2.648072 ustep: 1 
iter: 2  value: 2336.834 mgc: 0.1540118 ustep: 1 
iter: 3  value: 2336.834 mgc: 0.001186892 ustep: 1 
iter: 4  value: 2336.834 mgc: 7.693951e-08 ustep: 1 
iter: 5  mgc: 6.217249e-15 
iter: 1  value: 2335.248 mgc: 1.213474 ustep: 1 
iter: 2  value: 2335.247 mgc: 0.03415221 ustep: 1 
iter: 3  value: 2335.247 mgc: 2.351193e-05 ustep: 1 
iter: 4  mgc: 1.145262e-11 
iter: 1  mgc: 1.145262e-11 
outer mgc:  0.8007468 
iter: 1  value: 2335.897 mgc: 1.162658 ustep: 1 
iter: 2  value: 2335.895 mgc: 0.1080297 ustep: 1 
iter: 3  value: 2335.895 mgc: 0.0006714456 ustep: 1 
iter: 4  value: 2335.895 mgc: 2.661927e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  1.097453 
iter: 1  value: 2335.488 mgc: 0.6826912 ustep: 1 
iter: 2  value: 2335.488 mgc: 0.01134462 ustep: 1 
iter: 3  value: 2335.488 mgc: 7.148833e-06 ustep: 1 
iter: 4  mgc: 2.861517e-12 
iter: 1  mgc: 2.861517e-12 
outer mgc:  0.555173 
iter: 1  value: 2335.381 mgc: 0.267402 ustep: 1 
iter: 2  value: 2335.381 mgc: 0.001638411 ustep: 1 
iter: 3  value: 2335.381 mgc: 1.264551e-07 ustep: 1 
iter: 4  mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.371396 
iter: 1  value: 2335.451 mgc: 0.25854 ustep: 1 
iter: 2  value: 2335.451 mgc: 0.001290209 ustep: 1 
iter: 3  value: 2335.451 mgc: 1.109808e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.8728153 
iter: 1  value: 2335.416 mgc: 0.3128118 ustep: 1 
iter: 2  value: 2335.416 mgc: 0.001434121 ustep: 1 
iter: 3  value: 2335.416 mgc: 6.688465e-08 ustep: 1 
iter: 4  mgc: 1.221245e-14 
iter: 1  mgc: 1.221245e-14 
outer mgc:  0.3683426 
iter: 1  value: 2335.357 mgc: 0.4800253 ustep: 1 
iter: 2  value: 2335.357 mgc: 0.002197571 ustep: 1 
iter: 3  value: 2335.357 mgc: 1.265233e-07 ustep: 1 
iter: 4  mgc: 5.828671e-15 
iter: 1  mgc: 5.828671e-15 
outer mgc:  0.3321672 
iter: 1  value: 2335.406 mgc: 0.1945851 ustep: 1 
iter: 2  value: 2335.406 mgc: 0.001899322 ustep: 1 
iter: 3  value: 2335.406 mgc: 1.892633e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  0.466382 
iter: 1  value: 2335.461 mgc: 0.1296562 ustep: 1 
iter: 2  value: 2335.461 mgc: 0.0002224486 ustep: 1 
iter: 3  mgc: 1.536557e-09 
iter: 1  mgc: 1.536557e-09 
outer mgc:  0.1267918 
iter: 1  value: 2335.444 mgc: 0.2159151 ustep: 1 
iter: 2  value: 2335.444 mgc: 0.002692951 ustep: 1 
iter: 3  value: 2335.444 mgc: 4.083231e-07 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  value: 2335.41 mgc: 0.08993609 ustep: 1 
iter: 2  value: 2335.41 mgc: 0.0004087543 ustep: 1 
iter: 3  mgc: 9.070169e-09 
iter: 1  mgc: 9.070169e-09 
outer mgc:  0.1411693 
iter: 1  value: 2335.468 mgc: 0.07018941 ustep: 1 
iter: 2  value: 2335.468 mgc: 0.0001557497 ustep: 1 
iter: 3  mgc: 1.222106e-09 
iter: 1  mgc: 1.222106e-09 
outer mgc:  0.07154033 
iter: 1  value: 2335.408 mgc: 0.09075073 ustep: 1 
iter: 2  value: 2335.408 mgc: 0.0001662431 ustep: 1 
iter: 3  mgc: 7.204497e-10 
iter: 1  mgc: 7.204497e-10 
outer mgc:  0.07552609 
iter: 1  value: 2335.426 mgc: 0.03982388 ustep: 1 
iter: 2  value: 2335.426 mgc: 3.413938e-05 ustep: 1 
iter: 3  mgc: 5.096945e-11 
iter: 1  mgc: 5.096945e-11 
outer mgc:  0.03373656 
iter: 1  value: 2335.428 mgc: 0.03020679 ustep: 1 
iter: 2  value: 2335.428 mgc: 2.537488e-05 ustep: 1 
iter: 3  mgc: 4.290188e-11 
iter: 1  value: 2335.427 mgc: 0.0148914 ustep: 1 
iter: 2  value: 2335.427 mgc: 4.886479e-06 ustep: 1 
iter: 3  mgc: 1.591338e-12 
iter: 1  mgc: 1.591338e-12 
outer mgc:  0.006505376 
iter: 1  value: 2335.437 mgc: 0.01698862 ustep: 1 
iter: 2  value: 2335.437 mgc: 7.047417e-06 ustep: 1 
iter: 3  mgc: 1.140421e-12 
iter: 1  value: 2335.432 mgc: 0.008694655 ustep: 1 
iter: 2  value: 2335.432 mgc: 1.848636e-06 ustep: 1 
iter: 3  mgc: 7.682743e-14 
iter: 1  mgc: 7.682743e-14 
outer mgc:  0.004039067 
iter: 1  value: 2335.433 mgc: 0.005172741 ustep: 1 
iter: 2  value: 2335.433 mgc: 7.247987e-07 ustep: 1 
iter: 3  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  0.002566699 
iter: 1  value: 2335.434 mgc: 0.002864487 ustep: 1 
iter: 2  value: 2335.434 mgc: 7.299068e-07 ustep: 1 
iter: 3  mgc: 7.549517e-15 
iter: 1  value: 2335.434 mgc: 0.001359046 ustep: 1 
iter: 2  value: 2335.434 mgc: 1.148306e-07 ustep: 1 
iter: 3  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.0008576464 
iter: 1  value: 2335.433 mgc: 0.001182469 ustep: 1 
iter: 2  value: 2335.433 mgc: 3.923892e-08 ustep: 1 
iter: 3  mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  0.0006937785 
iter: 1  value: 2335.433 mgc: 0.0007146967 ustep: 1 
iter: 2  value: 2335.433 mgc: 2.431873e-08 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  0.0006937785 
iter: 1  value: 2335.434 mgc: 0.007862335 ustep: 1 
iter: 2  value: 2335.434 mgc: 1.021177e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.02147015 
iter: 1  value: 2335.432 mgc: 0.007860805 ustep: 1 
iter: 2  value: 2335.432 mgc: 1.023707e-06 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.02168902 
iter: 1  value: 2335.433 mgc: 0.003999041 ustep: 1 
iter: 2  value: 2335.433 mgc: 2.906325e-07 ustep: 1 
iter: 3  mgc: 3.774758e-15 
outer mgc:  0.02130885 
iter: 1  value: 2335.433 mgc: 0.00399847 ustep: 1 
iter: 2  value: 2335.433 mgc: 2.908149e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.02177572 
iter: 1  value: 2335.432 mgc: 0.004624206 ustep: 1 
iter: 2  value: 2335.432 mgc: 1.225648e-06 ustep: 1 
iter: 3  mgc: 8.415491e-14 
outer mgc:  0.01371241 
iter: 1  value: 2335.434 mgc: 0.004618779 ustep: 1 
iter: 2  value: 2335.434 mgc: 1.226642e-06 ustep: 1 
iter: 3  mgc: 8.21565e-14 
outer mgc:  0.01232233 
iter: 1  value: 2335.433 mgc: 0.00305374 ustep: 1 
iter: 2  value: 2335.433 mgc: 5.663809e-07 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.01208887 
iter: 1  value: 2335.433 mgc: 0.003051405 ustep: 1 
iter: 2  value: 2335.433 mgc: 5.66557e-07 ustep: 1 
iter: 3  mgc: 2.065015e-14 
outer mgc:  0.01088697 
iter: 1  value: 2335.434 mgc: 0.007816956 ustep: 1 
iter: 2  value: 2335.434 mgc: 9.860706e-07 ustep: 1 
iter: 3  mgc: 2.625677e-14 
outer mgc:  0.02246928 
iter: 1  value: 2335.433 mgc: 0.007814735 ustep: 1 
iter: 2  value: 2335.433 mgc: 9.875371e-07 ustep: 1 
iter: 3  mgc: 2.298162e-14 
outer mgc:  0.02288776 
iter: 1  value: 2335.433 mgc: 0.00390467 ustep: 1 
iter: 2  value: 2335.433 mgc: 3.45516e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.02056754 
iter: 1  value: 2335.433 mgc: 0.003903674 ustep: 1 
iter: 2  value: 2335.433 mgc: 3.456247e-07 ustep: 1 
iter: 3  mgc: 8.437695e-15 
outer mgc:  0.021461 
iter: 1  value: 2335.436 mgc: 0.007952422 ustep: 1 
iter: 2  value: 2335.436 mgc: 1.591149e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.0135578 
iter: 1  value: 2335.43 mgc: 0.007970385 ustep: 1 
iter: 2  value: 2335.43 mgc: 1.5935e-06 ustep: 1 
iter: 3  mgc: 6.217249e-14 
outer mgc:  0.0138322 
iter: 1  value: 2335.437 mgc: 0.005661334 ustep: 1 
iter: 2  value: 2335.437 mgc: 1.581936e-06 ustep: 1 
iter: 3  mgc: 1.225686e-13 
outer mgc:  0.01006104 
iter: 1  value: 2335.429 mgc: 0.005673612 ustep: 1 
iter: 2  value: 2335.429 mgc: 1.583011e-06 ustep: 1 
iter: 3  mgc: 1.225686e-13 
outer mgc:  0.009769414 
iter: 1  value: 2335.437 mgc: 0.006859291 ustep: 1 
iter: 2  value: 2335.437 mgc: 8.638514e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.01311723 
iter: 1  value: 2335.429 mgc: 0.006873293 ustep: 1 
iter: 2  value: 2335.429 mgc: 8.640646e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.01274979 
iter: 1  value: 2335.431 mgc: 0.002668622 ustep: 1 
iter: 2  value: 2335.431 mgc: 3.243275e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.00326548 
iter: 1  value: 2335.435 mgc: 0.002665592 ustep: 1 
iter: 2  value: 2335.435 mgc: 3.245919e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.003711482 
iter: 1  value: 2335.431 mgc: 0.002713051 ustep: 1 
iter: 2  value: 2335.431 mgc: 1.591461e-07 ustep: 1 
iter: 3  mgc: 8.437695e-15 
outer mgc:  0.002832039 
iter: 1  value: 2335.435 mgc: 0.002711462 ustep: 1 
iter: 2  value: 2335.435 mgc: 1.592044e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.002939118 
iter: 1  value: 2335.432 mgc: 0.002987092 ustep: 1 
iter: 2  value: 2335.432 mgc: 3.374444e-07 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.003228756 
iter: 1  value: 2335.434 mgc: 0.002987023 ustep: 1 
iter: 2  value: 2335.434 mgc: 3.373758e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.003241438 
iter: 1  value: 2335.427 mgc: 0.003741748 ustep: 1 
iter: 2  value: 2335.427 mgc: 1.851278e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.01355987 
iter: 1  value: 2335.439 mgc: 0.003739458 ustep: 1 
iter: 2  value: 2335.439 mgc: 1.850381e-07 ustep: 1 
iter: 3  mgc: 5.662137e-15 
outer mgc:  0.01326136 
[Sun Aug 15 20:38:57 2021]
Finished job 0.
1 of 1 steps (100%) done

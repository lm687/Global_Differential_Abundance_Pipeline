Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 00:12:01 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4364.786623 
final  value 4075.091874 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1388.24 mgc: 120.2008 ustep: 1 
iter: 2  value: 1012.44 mgc: 54.50015 ustep: 0.2494656 
iter: 3  value: 432.0584 mgc: 100.9876 ustep: 0.4995153 
iter: 4  value: 412.3794 mgc: 16.50358 ustep: 0.7067933 
iter: 5  value: 410.1536 mgc: 10.54904 ustep: 0.8407259 
iter: 6  value: 410.1306 mgc: 1.070753 ustep: 0.9169194 
iter: 7  value: 410.1306 mgc: 0.01870421 ustep: 0.9575633 
iter: 8  value: 410.1306 mgc: 3.767737e-05 ustep: 0.9785538 
iter: 9  value: 410.1306 mgc: 3.384652e-08 ustep: 0.9892199 
mgc: 1.561606e-11 
iter: 1  mgc: 1.561606e-11 
Matching hessian patterns... Done
outer mgc:  23.8651 
iter: 1  value: 423.2797 mgc: 9.636103 ustep: 1 
iter: 2  value: 423.2492 mgc: 0.4295334 ustep: 1 
iter: 3  value: 423.2492 mgc: 0.00220849 ustep: 1 
iter: 4  value: 423.2492 mgc: 1.27436e-07 ustep: 1 
iter: 5  mgc: 1.24345e-14 
iter: 1  value: 404.068 mgc: 3.865666 ustep: 1 
iter: 2  value: 404.0674 mgc: 0.06094716 ustep: 1 
iter: 3  value: 404.0674 mgc: 5.165951e-05 ustep: 1 
iter: 4  mgc: 7.186737e-11 
iter: 1  mgc: 7.186737e-11 
outer mgc:  22.02131 
iter: 1  value: 399.7909 mgc: 12.95119 ustep: 1 
iter: 2  value: 399.7095 mgc: 0.7617089 ustep: 1 
iter: 3  value: 399.7095 mgc: 0.005730207 ustep: 1 
iter: 4  value: 399.7095 mgc: 4.224059e-07 ustep: 1 
iter: 5  mgc: 1.898481e-14 
iter: 1  mgc: 1.898481e-14 
outer mgc:  26.4288 
iter: 1  value: 391.8232 mgc: 1.524629 ustep: 1 
iter: 2  value: 391.8232 mgc: 0.01284847 ustep: 1 
iter: 3  value: 391.8232 mgc: 3.942833e-06 ustep: 1 
iter: 4  mgc: 3.73479e-13 
iter: 1  mgc: 3.73479e-13 
outer mgc:  12.71009 
iter: 1  value: 389.7401 mgc: 24.60078 ustep: 1 
iter: 2  value: 388.4018 mgc: 3.528492 ustep: 1 
iter: 3  value: 388.4011 mgc: 0.1051712 ustep: 1 
iter: 4  value: 388.4011 mgc: 0.0001409144 ustep: 1 
iter: 5  mgc: 3.032032e-10 
iter: 1  mgc: 3.032032e-10 
outer mgc:  34.94385 
iter: 1  value: 382.2595 mgc: 13.34295 ustep: 1 
iter: 2  value: 382.0283 mgc: 2.149143 ustep: 1 
iter: 3  value: 382.0279 mgc: 0.1048855 ustep: 1 
iter: 4  value: 382.0279 mgc: 0.0002794284 ustep: 1 
iter: 5  mgc: 1.995863e-09 
iter: 1  mgc: 1.995863e-09 
outer mgc:  31.78748 
iter: 1  value: 381.6672 mgc: 32.8545 ustep: 1 
iter: 2  value: 376.6908 mgc: 5.905144 ustep: 1 
iter: 3  value: 376.6858 mgc: 0.1882162 ustep: 1 
iter: 4  value: 376.6858 mgc: 0.0003283053 ustep: 1 
iter: 5  mgc: 1.169661e-09 
iter: 1  mgc: 1.169661e-09 
outer mgc:  17.15389 
iter: 1  value: 380.8116 mgc: 25.34012 ustep: 1 
iter: 2  value: 379.6025 mgc: 2.697029 ustep: 1 
iter: 3  value: 379.6021 mgc: 0.05437245 ustep: 1 
iter: 4  value: 379.6021 mgc: 5.522544e-05 ustep: 1 
iter: 5  mgc: 5.623879e-11 
iter: 1  value: 374.3182 mgc: 14.42498 ustep: 1 
iter: 2  value: 374.2119 mgc: 0.9063725 ustep: 1 
iter: 3  value: 374.2119 mgc: 0.003820873 ustep: 1 
iter: 4  value: 374.2119 mgc: 6.100631e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  11.5484 
iter: 1  value: 375.8083 mgc: 11.0979 ustep: 1 
iter: 2  value: 375.7684 mgc: 0.4803399 ustep: 1 
iter: 3  value: 375.7684 mgc: 0.002039115 ustep: 1 
iter: 4  value: 375.7684 mgc: 5.301147e-08 ustep: 1 
mgc: 1.251776e-14 
iter: 1  value: 373.658 mgc: 5.49596 ustep: 1 
iter: 2  value: 373.6566 mgc: 0.1066203 ustep: 1 
iter: 3  value: 373.6566 mgc: 9.392441e-05 ustep: 1 
iter: 4  mgc: 7.281398e-11 
iter: 1  mgc: 7.281398e-11 
outer mgc:  8.87433 
iter: 1  value: 373.1243 mgc: 4.615912 ustep: 1 
iter: 2  value: 373.1232 mgc: 0.08496333 ustep: 1 
iter: 3  value: 373.1232 mgc: 7.672051e-05 ustep: 1 
iter: 4  mgc: 1.125978e-10 
iter: 1  mgc: 1.125978e-10 
outer mgc:  5.722007 
iter: 1  value: 372.6634 mgc: 2.222798 ustep: 1 
iter: 2  value: 372.6632 mgc: 0.02427556 ustep: 1 
iter: 3  value: 372.6632 mgc: 6.644478e-06 ustep: 1 
iter: 4  mgc: 9.845458e-13 
iter: 1  mgc: 9.845458e-13 
outer mgc:  3.55241 
iter: 1  value: 372.4089 mgc: 3.303379 ustep: 1 
iter: 2  value: 372.4087 mgc: 0.03599787 ustep: 1 
iter: 3  value: 372.4087 mgc: 2.347393e-05 ustep: 1 
iter: 4  mgc: 1.250766e-11 
iter: 1  mgc: 1.250766e-11 
outer mgc:  3.105844 
iter: 1  value: 372.3219 mgc: 2.13276 ustep: 1 
iter: 2  value: 372.3219 mgc: 0.01498785 ustep: 1 
iter: 3  value: 372.3219 mgc: 1.955865e-06 ustep: 1 
iter: 4  mgc: 5.362377e-14 
iter: 1  mgc: 5.362377e-14 
outer mgc:  1.585747 
iter: 1  value: 372.5461 mgc: 1.403657 ustep: 1 
iter: 2  value: 372.5461 mgc: 0.009668865 ustep: 1 
iter: 3  value: 372.5461 mgc: 3.36363e-06 ustep: 1 
iter: 4  mgc: 3.774758e-13 
iter: 1  value: 372.2801 mgc: 0.4438959 ustep: 1 
iter: 2  value: 372.2801 mgc: 0.0006453946 ustep: 1 
iter: 3  value: 372.2801 mgc: 1.604952e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  1.477574 
iter: 1  value: 372.2561 mgc: 1.022493 ustep: 1 
iter: 2  value: 372.2561 mgc: 0.003147756 ustep: 1 
iter: 3  value: 372.2561 mgc: 5.308403e-08 ustep: 1 
mgc: 2.339795e-14 
iter: 1  mgc: 2.339795e-14 
outer mgc:  2.095342 
iter: 1  value: 372.2326 mgc: 0.533454 ustep: 1 
iter: 2  value: 372.2326 mgc: 0.001086252 ustep: 1 
iter: 3  mgc: 6.567179e-09 
iter: 1  mgc: 6.567179e-09 
outer mgc:  0.506044 
iter: 1  value: 372.2196 mgc: 0.4443613 ustep: 1 
iter: 2  value: 372.2196 mgc: 0.00161044 ustep: 1 
iter: 3  value: 372.2196 mgc: 4.92511e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  1.214693 
iter: 1  value: 372.2112 mgc: 0.1030972 ustep: 1 
iter: 2  value: 372.2112 mgc: 0.0002720214 ustep: 1 
iter: 3  mgc: 2.328639e-09 
iter: 1  mgc: 2.328639e-09 
outer mgc:  0.3507575 
iter: 1  value: 372.2332 mgc: 0.6465457 ustep: 1 
iter: 2  value: 372.2332 mgc: 0.00162585 ustep: 1 
iter: 3  value: 372.2332 mgc: 2.466577e-08 ustep: 1 
mgc: 1.665335e-14 
iter: 1  value: 372.2184 mgc: 0.3069646 ustep: 1 
iter: 2  value: 372.2184 mgc: 0.0003640598 ustep: 1 
iter: 3  mgc: 1.233702e-09 
iter: 1  mgc: 1.233702e-09 
outer mgc:  0.6422641 
iter: 1  value: 372.217 mgc: 0.190214 ustep: 1 
iter: 2  value: 372.217 mgc: 9.818637e-05 ustep: 1 
iter: 3  mgc: 6.192991e-11 
iter: 1  mgc: 6.192991e-11 
outer mgc:  0.2512471 
iter: 1  value: 372.2183 mgc: 0.1049202 ustep: 1 
iter: 2  value: 372.2183 mgc: 4.611887e-05 ustep: 1 
iter: 3  mgc: 1.588585e-11 
iter: 1  mgc: 1.588585e-11 
outer mgc:  0.2279768 
iter: 1  value: 372.2336 mgc: 0.237856 ustep: 1 
iter: 2  value: 372.2336 mgc: 0.0001543038 ustep: 1 
iter: 3  mgc: 4.203647e-10 
iter: 1  mgc: 4.203647e-10 
outer mgc:  0.1949772 
iter: 1  value: 372.2364 mgc: 0.09495582 ustep: 1 
iter: 2  value: 372.2364 mgc: 7.988446e-05 ustep: 1 
iter: 3  mgc: 2.04099e-10 
iter: 1  mgc: 2.04099e-10 
outer mgc:  0.2314611 
iter: 1  value: 372.2105 mgc: 0.1208728 ustep: 1 
iter: 2  value: 372.2105 mgc: 0.0001641253 ustep: 1 
iter: 3  mgc: 4.310903e-10 
iter: 1  value: 372.2299 mgc: 0.02172296 ustep: 1 
iter: 2  value: 372.2299 mgc: 2.694822e-06 ustep: 1 
iter: 3  mgc: 1.149081e-13 
iter: 1  mgc: 1.149081e-13 
outer mgc:  0.03173254 
iter: 1  value: 372.2364 mgc: 0.0598567 ustep: 1 
iter: 2  value: 372.2364 mgc: 1.502142e-05 ustep: 1 
iter: 3  mgc: 7.589929e-12 
iter: 1  value: 372.2311 mgc: 0.008085907 ustep: 1 
iter: 2  value: 372.2311 mgc: 8.514498e-07 ustep: 1 
iter: 3  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.03373116 
iter: 1  value: 372.2322 mgc: 0.0139739 ustep: 1 
iter: 2  value: 372.2322 mgc: 1.150028e-06 ustep: 1 
iter: 3  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.00699461 
iter: 1  value: 372.2316 mgc: 0.005623194 ustep: 1 
iter: 2  value: 372.2316 mgc: 1.833035e-07 ustep: 1 
iter: 3  mgc: 1.465494e-14 
iter: 1  mgc: 1.465494e-14 
outer mgc:  0.008319106 
iter: 1  value: 372.2323 mgc: 0.01796047 ustep: 1 
iter: 2  value: 372.2323 mgc: 1.140073e-06 ustep: 1 
iter: 3  mgc: 1.820766e-14 
iter: 1  value: 372.2319 mgc: 0.01154469 ustep: 1 
iter: 2  value: 372.2319 mgc: 4.402891e-07 ustep: 1 
iter: 3  mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  0.011688 
iter: 1  value: 372.2319 mgc: 0.008722312 ustep: 1 
iter: 2  value: 372.2319 mgc: 2.35649e-07 ustep: 1 
iter: 3  mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  0.005130491 
iter: 1  value: 372.2322 mgc: 0.004075798 ustep: 1 
iter: 2  value: 372.2322 mgc: 1.085533e-07 ustep: 1 
iter: 3  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.004941819 
iter: 1  value: 372.2321 mgc: 0.002751797 ustep: 1 
iter: 2  value: 372.2321 mgc: 2.26254e-08 ustep: 1 
mgc: 1.570966e-14 
iter: 1  mgc: 1.570966e-14 
outer mgc:  0.0003365486 
iter: 1  value: 372.2321 mgc: 0.0002274877 ustep: 1 
iter: 2  mgc: 2.732498e-10 
iter: 1  mgc: 2.732498e-10 
outer mgc:  5.102162e-05 
iter: 1  mgc: 2.732498e-10 
iter: 1  mgc: 2.732498e-10 
outer mgc:  5.102162e-05 
iter: 1  value: 372.2322 mgc: 0.05341237 ustep: 1 
iter: 2  value: 372.2322 mgc: 8.735915e-06 ustep: 1 
iter: 3  mgc: 5.546674e-13 
outer mgc:  0.06480336 
iter: 1  value: 372.2321 mgc: 0.05341417 ustep: 1 
iter: 2  value: 372.2321 mgc: 8.745065e-06 ustep: 1 
iter: 3  mgc: 5.622169e-13 
outer mgc:  0.064732 
iter: 1  value: 372.2322 mgc: 0.02699592 ustep: 1 
iter: 2  value: 372.2322 mgc: 2.5641e-06 ustep: 1 
iter: 3  mgc: 3.93019e-14 
outer mgc:  0.196979 
iter: 1  value: 372.2323 mgc: 0.02699625 ustep: 1 
iter: 2  value: 372.2323 mgc: 2.565325e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.1969091 
iter: 1  value: 372.2319 mgc: 0.04859815 ustep: 1 
iter: 2  value: 372.2319 mgc: 8.941574e-06 ustep: 1 
iter: 3  mgc: 6.217249e-13 
outer mgc:  0.05321993 
iter: 1  value: 372.2324 mgc: 0.04860073 ustep: 1 
iter: 2  value: 372.2324 mgc: 8.952199e-06 ustep: 1 
iter: 3  mgc: 6.12288e-13 
outer mgc:  0.05332165 
iter: 1  value: 372.2321 mgc: 0.02512863 ustep: 1 
iter: 2  value: 372.2321 mgc: 2.452359e-06 ustep: 1 
iter: 3  mgc: 7.749357e-14 
outer mgc:  0.16702 
iter: 1  value: 372.2323 mgc: 0.02513037 ustep: 1 
iter: 2  value: 372.2323 mgc: 2.451787e-06 ustep: 1 
iter: 3  mgc: 8.437695e-14 
outer mgc:  0.1671 
iter: 1  value: 372.2305 mgc: 0.003546549 ustep: 1 
iter: 2  value: 372.2305 mgc: 1.300404e-07 ustep: 1 
mgc: 1.465494e-14 
outer mgc:  0.01054031 
iter: 1  value: 372.2337 mgc: 0.003543456 ustep: 1 
iter: 2  value: 372.2337 mgc: 1.299005e-07 ustep: 1 
mgc: 1.376677e-14 
outer mgc:  0.01055539 
iter: 1  value: 372.2341 mgc: 0.007872636 ustep: 1 
iter: 2  value: 372.2341 mgc: 6.849524e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.05258086 
iter: 1  value: 372.2302 mgc: 0.007889504 ustep: 1 
iter: 2  value: 372.2302 mgc: 6.879775e-07 ustep: 1 
iter: 3  mgc: 1.787459e-14 
outer mgc:  0.05275305 
iter: 1  value: 372.2343 mgc: 0.00921758 ustep: 1 
iter: 2  value: 372.2343 mgc: 2.089263e-06 ustep: 1 
iter: 3  mgc: 1.372236e-13 
outer mgc:  0.05008983 
iter: 1  value: 372.23 mgc: 0.009238602 ustep: 1 
iter: 2  value: 372.23 mgc: 2.096151e-06 ustep: 1 
iter: 3  mgc: 1.407763e-13 
outer mgc:  0.05025708 
[Mon Aug 16 00:12:03 2021]
Finished job 0.
1 of 1 steps (100%) done

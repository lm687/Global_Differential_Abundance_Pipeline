Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:17:42 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_4_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2801.700904 
iter  10 value 1954.929947
final  value 1954.920999 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1359.835 mgc: 127.3064 ustep: 1 
iter: 2  value: 1169.034 mgc: 46.98576 ustep: 1 
iter: 3  value: 1110.467 mgc: 44.31415 ustep: 1 
iter: 4  value: 1107.235 mgc: 8.819624 ustep: 1 
iter: 5  value: 1107.188 mgc: 0.9875573 ustep: 1 
iter: 6  value: 1107.188 mgc: 0.01822864 ustep: 1 
iter: 7  value: 1107.188 mgc: 6.695474e-06 ustep: 1 
iter: 8  mgc: 1.065703e-12 
iter: 1  mgc: 1.065703e-12 
Matching hessian patterns... Done
outer mgc:  401.0908 
iter: 1  value: 733.4158 mgc: 27.90466 ustep: 1 
iter: 2  value: 723.1731 mgc: 10.31255 ustep: 1 
iter: 3  value: 723.0673 mgc: 1.015922 ustep: 1 
iter: 4  value: 723.0672 mgc: 0.01940091 ustep: 1 
iter: 5  value: 723.0672 mgc: 8.584988e-06 ustep: 1 
iter: 6  mgc: 1.684652e-12 
iter: 1  value: 529.6872 mgc: 57.21178 ustep: 0.4367355 
iter: 2  value: 301.3443 mgc: 56.12042 ustep: 0.6608936 
iter: 3  value: 289.2549 mgc: 10.5276 ustep: 0.8129723 
iter: 4  value: 289.0798 mgc: 1.404199 ustep: 0.9016596 
iter: 5  value: 289.0797 mgc: 0.04508518 ustep: 0.9495626 
iter: 6  value: 289.0797 mgc: 0.0001972208 ustep: 0.9744576 
iter: 7  value: 289.0797 mgc: 5.667307e-07 ustep: 0.9871475 
iter: 8  mgc: 1.266493e-09 
iter: 1  mgc: 1.266493e-09 
outer mgc:  53.53784 
iter: 1  value: 296.1124 mgc: 52.14517 ustep: 1 
iter: 2  value: 291.4422 mgc: 7.283342 ustep: 1 
iter: 3  value: 291.4228 mgc: 0.5044556 ustep: 1 
iter: 4  value: 291.4228 mgc: 0.003899281 ustep: 1 
iter: 5  value: 291.4228 mgc: 2.567331e-07 ustep: 1 
iter: 6  mgc: 2.242651e-14 
iter: 1  value: 223.508 mgc: 15.42354 ustep: 1 
iter: 2  value: 223.3636 mgc: 1.338561 ustep: 1 
iter: 3  value: 223.3636 mgc: 0.02290512 ustep: 1 
iter: 4  value: 223.3636 mgc: 7.691429e-06 ustep: 1 
iter: 5  mgc: 8.610612e-13 
iter: 1  mgc: 8.610612e-13 
outer mgc:  20.94313 
iter: 1  value: 206.281 mgc: 16.61837 ustep: 1 
iter: 2  value: 206.2026 mgc: 0.9716028 ustep: 1 
iter: 3  value: 206.2026 mgc: 0.02082422 ustep: 1 
iter: 4  value: 206.2026 mgc: 1.015224e-05 ustep: 1 
iter: 5  mgc: 2.418066e-12 
iter: 1  mgc: 2.418066e-12 
outer mgc:  25.53643 
iter: 1  value: 222.6902 mgc: 47.60116 ustep: 1 
iter: 2  value: 220.9567 mgc: 3.950343 ustep: 1 
iter: 3  value: 220.9559 mgc: 0.1179101 ustep: 1 
iter: 4  value: 220.9559 mgc: 0.0001172289 ustep: 1 
iter: 5  mgc: 1.15997e-10 
iter: 1  value: 203.0521 mgc: 15.31882 ustep: 1 
iter: 2  value: 202.9855 mgc: 0.8482222 ustep: 1 
iter: 3  value: 202.9855 mgc: 0.008076238 ustep: 1 
iter: 4  value: 202.9855 mgc: 8.009778e-07 ustep: 1 
iter: 5  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  21.6423 
iter: 1  value: 200.7612 mgc: 13.61579 ustep: 1 
iter: 2  value: 199.9632 mgc: 2.759908 ustep: 1 
iter: 3  value: 199.9626 mgc: 0.06201441 ustep: 1 
iter: 4  value: 199.9626 mgc: 5.496015e-05 ustep: 1 
iter: 5  mgc: 5.181211e-11 
iter: 1  mgc: 5.181211e-11 
outer mgc:  7.494318 
iter: 1  value: 199.9888 mgc: 12.66197 ustep: 1 
iter: 2  value: 199.9321 mgc: 0.8252853 ustep: 1 
iter: 3  value: 199.9321 mgc: 0.006152846 ustep: 1 
iter: 4  value: 199.9321 mgc: 4.833845e-07 ustep: 1 
iter: 5  mgc: 2.597922e-14 
iter: 1  value: 198.0093 mgc: 6.025977 ustep: 1 
iter: 2  value: 198.0051 mgc: 0.2267536 ustep: 1 
iter: 3  value: 198.0051 mgc: 0.0004737431 ustep: 1 
iter: 4  mgc: 3.176141e-09 
iter: 1  mgc: 3.176141e-09 
outer mgc:  2.978061 
iter: 1  value: 197.0237 mgc: 3.755549 ustep: 1 
iter: 2  value: 197.0208 mgc: 0.1197476 ustep: 1 
iter: 3  value: 197.0208 mgc: 0.0002588508 ustep: 1 
iter: 4  mgc: 1.585974e-09 
iter: 1  mgc: 1.585974e-09 
outer mgc:  4.01149 
iter: 1  value: 195.4267 mgc: 8.479559 ustep: 1 
iter: 2  value: 195.4122 mgc: 0.2496487 ustep: 1 
iter: 3  value: 195.4122 mgc: 0.001384505 ustep: 1 
iter: 4  value: 195.4122 mgc: 1.890291e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  4.725319 
iter: 1  value: 195.0223 mgc: 9.331033 ustep: 1 
iter: 2  value: 194.9961 mgc: 0.6466501 ustep: 1 
iter: 3  value: 194.9961 mgc: 0.001792914 ustep: 1 
iter: 4  value: 194.9961 mgc: 4.471089e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  10.68739 
iter: 1  value: 194.706 mgc: 7.847338 ustep: 1 
iter: 2  value: 194.6855 mgc: 0.3884739 ustep: 1 
iter: 3  value: 194.6855 mgc: 0.001442628 ustep: 1 
iter: 4  value: 194.6855 mgc: 3.485293e-08 ustep: 1 
mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  8.835204 
iter: 1  value: 193.5352 mgc: 13.70439 ustep: 1 
iter: 2  value: 193.4658 mgc: 0.6903035 ustep: 1 
iter: 3  value: 193.4658 mgc: 0.005762733 ustep: 1 
iter: 4  value: 193.4658 mgc: 7.50207e-07 ustep: 1 
iter: 5  mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  4.729441 
iter: 1  value: 195.0721 mgc: 11.72582 ustep: 1 
iter: 2  value: 195.049 mgc: 0.4701248 ustep: 1 
iter: 3  value: 195.049 mgc: 0.003457896 ustep: 1 
iter: 4  value: 195.049 mgc: 3.810189e-07 ustep: 1 
iter: 5  mgc: 3.774758e-14 
iter: 1  value: 192.7785 mgc: 3.937012 ustep: 1 
iter: 2  value: 192.7783 mgc: 0.0381568 ustep: 1 
iter: 3  value: 192.7783 mgc: 3.968408e-05 ustep: 1 
iter: 4  mgc: 5.617506e-11 
iter: 1  mgc: 5.617506e-11 
outer mgc:  3.528717 
iter: 1  value: 192.447 mgc: 1.459469 ustep: 1 
iter: 2  value: 192.447 mgc: 0.01663998 ustep: 1 
iter: 3  value: 192.447 mgc: 5.818246e-06 ustep: 1 
iter: 4  mgc: 6.330492e-13 
iter: 1  mgc: 6.330492e-13 
outer mgc:  1.796653 
iter: 1  value: 192.271 mgc: 1.767925 ustep: 1 
iter: 2  value: 192.2709 mgc: 0.02964579 ustep: 1 
iter: 3  value: 192.2709 mgc: 1.127759e-05 ustep: 1 
iter: 4  mgc: 1.988854e-12 
iter: 1  value: 192.307 mgc: 1.060714 ustep: 1 
iter: 2  value: 192.307 mgc: 0.01079441 ustep: 1 
iter: 3  value: 192.307 mgc: 1.480431e-06 ustep: 1 
iter: 4  mgc: 2.992051e-14 
iter: 1  mgc: 2.992051e-14 
outer mgc:  0.5253683 
iter: 1  value: 192.2954 mgc: 1.418928 ustep: 1 
iter: 2  value: 192.2954 mgc: 0.01300999 ustep: 1 
iter: 3  value: 192.2954 mgc: 2.861221e-06 ustep: 1 
iter: 4  mgc: 1.408318e-13 
iter: 1  value: 192.3121 mgc: 1.078214 ustep: 1 
iter: 2  value: 192.3121 mgc: 0.007236708 ustep: 1 
iter: 3  value: 192.3121 mgc: 5.865478e-07 ustep: 1 
iter: 4  mgc: 3.796963e-14 
iter: 1  mgc: 3.796963e-14 
outer mgc:  0.5328347 
iter: 1  value: 192.3279 mgc: 0.3908313 ustep: 1 
iter: 2  value: 192.3279 mgc: 0.0008350431 ustep: 1 
iter: 3  value: 192.3279 mgc: 1.196184e-08 ustep: 1 
mgc: 3.530509e-14 
iter: 1  value: 192.3014 mgc: 0.3071751 ustep: 1 
iter: 2  value: 192.3014 mgc: 0.0003762571 ustep: 1 
iter: 3  mgc: 1.732121e-09 
iter: 1  mgc: 1.732121e-09 
outer mgc:  0.4229029 
iter: 1  value: 192.3196 mgc: 0.1861338 ustep: 1 
iter: 2  value: 192.3196 mgc: 4.967989e-05 ustep: 1 
iter: 3  mgc: 2.378187e-11 
iter: 1  mgc: 2.378187e-11 
outer mgc:  0.07315183 
iter: 1  value: 192.3263 mgc: 0.1728813 ustep: 1 
iter: 2  value: 192.3263 mgc: 0.0002245902 ustep: 1 
iter: 3  mgc: 8.423293e-10 
iter: 1  value: 192.3196 mgc: 0.09849908 ustep: 1 
iter: 2  value: 192.3196 mgc: 8.072918e-05 ustep: 1 
iter: 3  mgc: 8.114237e-11 
iter: 1  mgc: 8.114237e-11 
outer mgc:  0.05510591 
iter: 1  value: 192.3247 mgc: 0.05382314 ustep: 1 
iter: 2  value: 192.3247 mgc: 2.130157e-05 ustep: 1 
iter: 3  mgc: 2.977174e-12 
iter: 1  mgc: 2.977174e-12 
outer mgc:  0.02311961 
iter: 1  value: 192.3157 mgc: 0.03976584 ustep: 1 
iter: 2  value: 192.3157 mgc: 1.89783e-05 ustep: 1 
iter: 3  mgc: 8.043788e-12 
iter: 1  value: 192.321 mgc: 0.01428742 ustep: 1 
iter: 2  value: 192.321 mgc: 9.998462e-07 ustep: 1 
iter: 3  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.06682451 
iter: 1  value: 192.3191 mgc: 0.01987828 ustep: 1 
iter: 2  value: 192.3191 mgc: 1.6791e-06 ustep: 1 
iter: 3  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  0.02104237 
iter: 1  value: 192.3208 mgc: 0.03442335 ustep: 1 
iter: 2  value: 192.3208 mgc: 5.33128e-06 ustep: 1 
iter: 3  mgc: 2.382539e-13 
iter: 1  value: 192.3192 mgc: 0.02387612 ustep: 1 
iter: 2  value: 192.3192 mgc: 4.296136e-06 ustep: 1 
iter: 3  mgc: 1.416645e-13 
iter: 1  mgc: 1.416645e-13 
outer mgc:  0.009178545 
iter: 1  value: 192.3199 mgc: 0.01493961 ustep: 1 
iter: 2  value: 192.3199 mgc: 4.871765e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  0.00848136 
iter: 1  value: 192.3198 mgc: 0.005666923 ustep: 1 
iter: 2  value: 192.3198 mgc: 1.416816e-07 ustep: 1 
iter: 3  mgc: 2.065015e-14 
iter: 1  mgc: 2.065015e-14 
outer mgc:  0.002807482 
iter: 1  value: 192.3195 mgc: 0.003677295 ustep: 1 
iter: 2  value: 192.3195 mgc: 6.321089e-08 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.00608499 
iter: 1  value: 192.3196 mgc: 0.002579171 ustep: 1 
iter: 2  value: 192.3196 mgc: 4.969127e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.001515434 
iter: 1  value: 192.3194 mgc: 0.002060453 ustep: 1 
iter: 2  value: 192.3194 mgc: 2.108108e-08 ustep: 1 
mgc: 2.275957e-14 
iter: 1  mgc: 2.275957e-14 
outer mgc:  0.003028676 
iter: 1  value: 192.3194 mgc: 0.00125909 ustep: 1 
iter: 2  value: 192.3194 mgc: 1.699048e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.0007511254 
iter: 1  value: 192.3196 mgc: 0.00173081 ustep: 1 
iter: 2  value: 192.3196 mgc: 1.759768e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  value: 192.3195 mgc: 0.0008365862 ustep: 1 
iter: 2  mgc: 4.111198e-09 
iter: 1  mgc: 4.111198e-09 
outer mgc:  8.068046e-05 
iter: 1  value: 192.3195 mgc: 0.0002146671 ustep: 1 
iter: 2  mgc: 2.353047e-10 
iter: 1  mgc: 2.353047e-10 
outer mgc:  4.762115e-05 
iter: 1  mgc: 2.353047e-10 
iter: 1  mgc: 2.353047e-10 
outer mgc:  4.762115e-05 
iter: 1  value: 192.3193 mgc: 0.03785745 ustep: 1 
iter: 2  value: 192.3193 mgc: 7.54025e-06 ustep: 1 
iter: 3  mgc: 5.949685e-13 
outer mgc:  0.01976399 
iter: 1  value: 192.3197 mgc: 0.03784223 ustep: 1 
iter: 2  value: 192.3197 mgc: 7.547766e-06 ustep: 1 
iter: 3  mgc: 6.035172e-13 
outer mgc:  0.01969586 
iter: 1  value: 192.3191 mgc: 0.01191846 ustep: 1 
iter: 2  value: 192.3191 mgc: 1.30727e-06 ustep: 1 
iter: 3  mgc: 3.663736e-14 
outer mgc:  0.04444282 
iter: 1  value: 192.3199 mgc: 0.01190988 ustep: 1 
iter: 2  value: 192.3199 mgc: 1.306441e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.04446078 
iter: 1  value: 192.3192 mgc: 0.02721553 ustep: 1 
iter: 2  value: 192.3192 mgc: 5.676577e-06 ustep: 1 
iter: 3  mgc: 2.482459e-13 
outer mgc:  0.03194822 
iter: 1  value: 192.3198 mgc: 0.02720058 ustep: 1 
iter: 2  value: 192.3198 mgc: 5.681236e-06 ustep: 1 
iter: 3  mgc: 2.469136e-13 
outer mgc:  0.03191301 
iter: 1  value: 192.3192 mgc: 0.008004357 ustep: 1 
iter: 2  value: 192.3192 mgc: 5.115525e-07 ustep: 1 
iter: 3  mgc: 2.653433e-14 
outer mgc:  0.02532777 
iter: 1  value: 192.3198 mgc: 0.007997808 ustep: 1 
iter: 2  value: 192.3198 mgc: 5.108734e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.0252849 
iter: 1  value: 192.3198 mgc: 0.0396689 ustep: 1 
iter: 2  value: 192.3198 mgc: 2.506655e-06 ustep: 1 
iter: 3  mgc: 4.773959e-14 
outer mgc:  0.02883771 
iter: 1  value: 192.3191 mgc: 0.03967077 ustep: 1 
iter: 2  value: 192.3191 mgc: 2.499415e-06 ustep: 1 
iter: 3  mgc: 4.551914e-14 
outer mgc:  0.02879766 
iter: 1  value: 192.3205 mgc: 0.01986705 ustep: 1 
iter: 2  value: 192.3205 mgc: 7.084948e-07 ustep: 1 
iter: 3  mgc: 1.532108e-14 
outer mgc:  0.07382846 
iter: 1  value: 192.3185 mgc: 0.0198755 ustep: 1 
iter: 2  value: 192.3185 mgc: 7.083582e-07 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.07377362 
iter: 1  value: 192.3189 mgc: 0.00465471 ustep: 1 
iter: 2  value: 192.3189 mgc: 4.585747e-07 ustep: 1 
iter: 3  mgc: 2.120526e-14 
outer mgc:  0.007098814 
iter: 1  value: 192.32 mgc: 0.004650144 ustep: 1 
iter: 2  value: 192.32 mgc: 4.57898e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.007027526 
iter: 1  value: 192.3194 mgc: 0.002837388 ustep: 1 
iter: 2  value: 192.3194 mgc: 1.286649e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.007863223 
iter: 1  value: 192.3195 mgc: 0.002836712 ustep: 1 
iter: 2  value: 192.3195 mgc: 1.282072e-07 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.007828921 
iter: 1  value: 192.3191 mgc: 0.004533658 ustep: 1 
iter: 2  value: 192.3191 mgc: 1.634237e-07 ustep: 1 
mgc: 3.141931e-14 
outer mgc:  0.007248473 
iter: 1  value: 192.3199 mgc: 0.004528297 ustep: 1 
iter: 2  value: 192.3199 mgc: 1.630991e-07 ustep: 1 
mgc: 2.919887e-14 
outer mgc:  0.00724799 
iter: 1  value: 192.321 mgc: 0.005762131 ustep: 1 
iter: 2  value: 192.321 mgc: 4.366559e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.01565493 
iter: 1  value: 192.318 mgc: 0.005773758 ustep: 1 
iter: 2  value: 192.318 mgc: 4.376033e-07 ustep: 1 
iter: 3  mgc: 3.752554e-14 
outer mgc:  0.01576558 
iter: 1  value: 192.3219 mgc: 0.007503631 ustep: 1 
iter: 2  value: 192.3219 mgc: 1.208292e-06 ustep: 1 
iter: 3  mgc: 3.574918e-14 
outer mgc:  0.01235017 
iter: 1  value: 192.317 mgc: 0.007519201 ustep: 1 
iter: 2  value: 192.317 mgc: 1.210599e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.01236062 
iter: 1  value: 192.3205 mgc: 0.006882138 ustep: 1 
iter: 2  value: 192.3205 mgc: 6.877034e-08 ustep: 1 
mgc: 1.509903e-14 
outer mgc:  0.01748083 
iter: 1  value: 192.3184 mgc: 0.006895708 ustep: 1 
iter: 2  value: 192.3184 mgc: 6.904095e-08 ustep: 1 
mgc: 1.154632e-14 
outer mgc:  0.01751475 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:17:44 2021]
Finished job 0.
1 of 1 steps (100%) done

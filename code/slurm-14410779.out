Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:25:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.1_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.1, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4269.207354 
final  value 3902.073136 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 699.6701 mgc: 93.00093 ustep: 1 
iter: 2  value: 617.7966 mgc: 53.84932 ustep: 1 
iter: 3  value: 611.1232 mgc: 107.2994 ustep: 1 
iter: 4  value: 515.7406 mgc: 59.87034 ustep: 0.1336527 
iter: 5  value: 431.7709 mgc: 89.07708 ustep: 0.3656489 
iter: 6  value: 427.0475 mgc: 16.42022 ustep: 0.6047286 
iter: 7  value: 427.032 mgc: 1.040017 ustep: 0.7776652 
iter: 8  value: 427.032 mgc: 0.008790556 ustep: 0.8818651 
iter: 9  value: 427.032 mgc: 2.872749e-05 ustep: 0.9390828 
iter: 10  value: 427.032 mgc: 5.090621e-08 ustep: 0.969066 
mgc: 5.815093e-11 
iter: 1  mgc: 5.815093e-11 
Matching hessian patterns... Done
outer mgc:  254.6072 
iter: 1  value: 300.6181 mgc: 31.57194 ustep: 1 
iter: 2  value: 294.2059 mgc: 7.550413 ustep: 1 
iter: 3  value: 294.1992 mgc: 0.2751855 ustep: 1 
iter: 4  value: 294.1992 mgc: 0.0006215264 ustep: 1 
iter: 5  mgc: 3.208262e-09 
iter: 1  mgc: 3.208262e-09 
outer mgc:  49.62341 
iter: 1  value: 280.1082 mgc: 6.806737 ustep: 1 
iter: 2  value: 280.0561 mgc: 0.397834 ustep: 1 
iter: 3  value: 280.0561 mgc: 0.001935994 ustep: 1 
iter: 4  value: 280.0561 mgc: 1.282709e-07 ustep: 1 
iter: 5  mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  58.08778 
iter: 1  value: 277.9754 mgc: 37.34001 ustep: 1 
iter: 2  value: 252.4469 mgc: 12.94999 ustep: 1 
iter: 3  value: 252.3721 mgc: 0.8478301 ustep: 1 
iter: 4  value: 252.3721 mgc: 0.005567875 ustep: 1 
iter: 5  value: 252.3721 mgc: 3.070031e-07 ustep: 1 
iter: 6  mgc: 2.742251e-14 
iter: 1  mgc: 2.742251e-14 
outer mgc:  48.45053 
iter: 1  value: 235.6266 mgc: 9.853273 ustep: 1 
iter: 2  value: 235.6045 mgc: 0.6895412 ustep: 1 
iter: 3  value: 235.6045 mgc: 0.002709413 ustep: 1 
iter: 4  value: 235.6045 mgc: 4.24106e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  29.1098 
iter: 1  value: 351.5905 mgc: 61.10294 ustep: 1 
iter: 2  value: 346.0564 mgc: 6.509893 ustep: 1 
iter: 3  value: 346.0514 mgc: 0.1431698 ustep: 1 
iter: 4  value: 346.0514 mgc: 0.0001982582 ustep: 1 
iter: 5  mgc: 5.80588e-10 
iter: 1  value: 232.3842 mgc: 7.813818 ustep: 1 
iter: 2  value: 232.3809 mgc: 0.1553185 ustep: 1 
iter: 3  value: 232.3809 mgc: 0.0001115574 ustep: 1 
iter: 4  mgc: 5.795187e-11 
iter: 1  mgc: 5.795187e-11 
outer mgc:  20.64671 
iter: 1  value: 232.3254 mgc: 3.682575 ustep: 1 
iter: 2  value: 232.3254 mgc: 0.02412486 ustep: 1 
iter: 3  value: 232.3254 mgc: 1.607539e-06 ustep: 1 
iter: 4  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  21.86638 
iter: 1  value: 231.0238 mgc: 3.887766 ustep: 1 
iter: 2  value: 231.0237 mgc: 0.03497545 ustep: 1 
iter: 3  value: 231.0237 mgc: 4.537747e-06 ustep: 1 
iter: 4  mgc: 9.947598e-14 
iter: 1  mgc: 9.947598e-14 
outer mgc:  4.214203 
iter: 1  value: 230.5158 mgc: 1.455411 ustep: 1 
iter: 2  value: 230.5158 mgc: 0.005892816 ustep: 1 
iter: 3  value: 230.5158 mgc: 1.74177e-07 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  3.923918 
iter: 1  value: 229.4508 mgc: 3.217423 ustep: 1 
iter: 2  value: 229.4508 mgc: 0.01532511 ustep: 1 
iter: 3  value: 229.4508 mgc: 5.160189e-07 ustep: 1 
iter: 4  mgc: 2.420286e-14 
iter: 1  mgc: 2.420286e-14 
outer mgc:  4.952576 
iter: 1  value: 228.9476 mgc: 1.722945 ustep: 1 
iter: 2  value: 228.9475 mgc: 0.006056461 ustep: 1 
iter: 3  value: 228.9475 mgc: 1.520948e-07 ustep: 1 
mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  4.353707 
iter: 1  value: 228.8663 mgc: 2.047156 ustep: 1 
iter: 2  value: 228.8663 mgc: 0.01995454 ustep: 1 
iter: 3  value: 228.8663 mgc: 1.967806e-06 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  4.229284 
iter: 1  value: 228.7539 mgc: 4.270414 ustep: 1 
iter: 2  value: 228.7538 mgc: 0.0391316 ustep: 1 
iter: 3  value: 228.7538 mgc: 4.144709e-06 ustep: 1 
iter: 4  mgc: 4.796163e-14 
iter: 1  value: 228.5547 mgc: 1.728012 ustep: 1 
iter: 2  value: 228.5547 mgc: 0.006807924 ustep: 1 
iter: 3  value: 228.5547 mgc: 1.35287e-07 ustep: 1 
mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  4.09126 
iter: 1  value: 228.3894 mgc: 1.852569 ustep: 1 
iter: 2  value: 228.3894 mgc: 0.007569867 ustep: 1 
iter: 3  value: 228.3894 mgc: 1.990083e-07 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  5.920489 
iter: 1  value: 228.0866 mgc: 1.185716 ustep: 1 
iter: 2  value: 228.0866 mgc: 0.003429016 ustep: 1 
iter: 3  value: 228.0866 mgc: 3.922928e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  2.257424 
iter: 1  value: 227.6226 mgc: 1.10008 ustep: 1 
iter: 2  value: 227.6226 mgc: 0.003963687 ustep: 1 
iter: 3  value: 227.6226 mgc: 5.80306e-08 ustep: 1 
mgc: 2.631229e-14 
iter: 1  mgc: 2.631229e-14 
outer mgc:  3.469062 
iter: 1  value: 227.2942 mgc: 0.6976788 ustep: 1 
iter: 2  value: 227.2942 mgc: 0.002358374 ustep: 1 
iter: 3  value: 227.2942 mgc: 1.004471e-08 ustep: 1 
mgc: 3.064216e-14 
iter: 1  value: 227.2091 mgc: 1.381027 ustep: 1 
iter: 2  value: 227.2091 mgc: 0.003586314 ustep: 1 
iter: 3  value: 227.2091 mgc: 9.364066e-08 ustep: 1 
iter: 4  mgc: 2.831069e-14 
iter: 1  mgc: 2.831069e-14 
outer mgc:  5.544328 
iter: 1  value: 224.9969 mgc: 3.693746 ustep: 1 
iter: 2  value: 224.9969 mgc: 0.02653224 ustep: 1 
iter: 3  value: 224.9969 mgc: 1.293867e-06 ustep: 1 
iter: 4  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  5.665919 
iter: 1  value: 224.7629 mgc: 6.417075 ustep: 1 
iter: 2  value: 224.7627 mgc: 0.05994341 ustep: 1 
iter: 3  value: 224.7627 mgc: 1.208444e-05 ustep: 1 
iter: 4  mgc: 3.180789e-13 
iter: 1  value: 225.083 mgc: 4.864621 ustep: 1 
iter: 2  value: 225.0829 mgc: 0.04563179 ustep: 1 
iter: 3  value: 225.0829 mgc: 7.292812e-06 ustep: 1 
iter: 4  mgc: 1.253997e-13 
iter: 1  value: 225.1564 mgc: 3.606721 ustep: 1 
iter: 2  value: 225.1564 mgc: 0.02730741 ustep: 1 
iter: 3  value: 225.1564 mgc: 2.591257e-06 ustep: 1 
iter: 4  mgc: 3.874678e-14 
iter: 1  value: 224.9478 mgc: 1.749086 ustep: 1 
iter: 2  value: 224.9478 mgc: 0.006396164 ustep: 1 
iter: 3  value: 224.9478 mgc: 1.328756e-07 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  3.660041 
iter: 1  value: 224.8419 mgc: 0.7739215 ustep: 1 
iter: 2  value: 224.8419 mgc: 0.0007798995 ustep: 1 
iter: 3  mgc: 8.377068e-10 
iter: 1  mgc: 8.377068e-10 
outer mgc:  2.082566 
iter: 1  value: 224.7803 mgc: 0.5396427 ustep: 1 
iter: 2  value: 224.7803 mgc: 0.0006116535 ustep: 1 
iter: 3  mgc: 6.031896e-09 
iter: 1  value: 224.7293 mgc: 0.3379862 ustep: 1 
iter: 2  value: 224.7293 mgc: 0.001052623 ustep: 1 
iter: 3  value: 224.7293 mgc: 1.386782e-08 ustep: 1 
mgc: 2.631229e-14 
iter: 1  mgc: 2.631229e-14 
outer mgc:  1.312046 
iter: 1  value: 224.5143 mgc: 0.8973232 ustep: 1 
iter: 2  value: 224.5143 mgc: 0.00203328 ustep: 1 
iter: 3  value: 224.5143 mgc: 1.101041e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  2.430523 
iter: 1  value: 224.3068 mgc: 0.4903297 ustep: 1 
iter: 2  value: 224.3068 mgc: 0.0002747225 ustep: 1 
iter: 3  mgc: 1.8421e-10 
iter: 1  value: 224.0218 mgc: 0.6645716 ustep: 1 
iter: 2  value: 224.0218 mgc: 0.0007990065 ustep: 1 
iter: 3  mgc: 1.193546e-09 
iter: 1  value: 223.4491 mgc: 1.095874 ustep: 1 
iter: 2  value: 223.4491 mgc: 0.002055219 ustep: 1 
iter: 3  mgc: 5.66708e-09 
iter: 1  mgc: 5.66708e-09 
outer mgc:  4.162667 
iter: 1  value: 222.8909 mgc: 1.584699 ustep: 1 
iter: 2  value: 222.8909 mgc: 0.004713254 ustep: 1 
iter: 3  value: 222.8909 mgc: 8.970136e-08 ustep: 1 
iter: 4  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  1.536385 
iter: 1  value: 222.3617 mgc: 2.083757 ustep: 1 
iter: 2  value: 222.3617 mgc: 0.004533719 ustep: 1 
iter: 3  value: 222.3617 mgc: 1.467281e-07 ustep: 1 
iter: 4  mgc: 3.763656e-14 
iter: 1  value: 222.6297 mgc: 1.283507 ustep: 1 
iter: 2  value: 222.6297 mgc: 0.00149372 ustep: 1 
iter: 3  value: 222.6297 mgc: 1.588303e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  2.215986 
iter: 1  value: 222.5152 mgc: 0.6701659 ustep: 1 
iter: 2  value: 222.5152 mgc: 0.0003212513 ustep: 1 
iter: 3  mgc: 1.940439e-10 
iter: 1  mgc: 1.940439e-10 
outer mgc:  0.1784245 
iter: 1  value: 222.4591 mgc: 0.09703892 ustep: 1 
iter: 2  value: 222.4591 mgc: 1.245298e-05 ustep: 1 
iter: 3  mgc: 3.28626e-13 
iter: 1  mgc: 3.28626e-13 
outer mgc:  0.05715705 
iter: 1  value: 222.3467 mgc: 0.1879101 ustep: 1 
iter: 2  value: 222.3467 mgc: 4.987607e-05 ustep: 1 
iter: 3  mgc: 4.698464e-12 
iter: 1  mgc: 4.698464e-12 
outer mgc:  0.009002612 
iter: 1  value: 222.3411 mgc: 0.01055144 ustep: 1 
iter: 2  value: 222.3411 mgc: 1.577899e-07 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  0.001184004 
iter: 1  value: 222.3409 mgc: 0.0006430091 ustep: 1 
iter: 2  mgc: 6.305783e-10 
iter: 1  mgc: 6.305783e-10 
outer mgc:  0.0002173113 
iter: 1  mgc: 6.305783e-10 
iter: 1  mgc: 6.305783e-10 
outer mgc:  0.0002173113 
iter: 1  value: 222.3406 mgc: 0.04176261 ustep: 1 
iter: 2  value: 222.3406 mgc: 2.109189e-06 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.3876725 
iter: 1  value: 222.3415 mgc: 0.04174529 ustep: 1 
iter: 2  value: 222.3415 mgc: 2.109957e-06 ustep: 1 
iter: 3  mgc: 4.818368e-14 
outer mgc:  0.3871809 
iter: 1  value: 222.3408 mgc: 0.02099354 ustep: 1 
iter: 2  value: 222.3408 mgc: 5.414227e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.2682319 
iter: 1  value: 222.3413 mgc: 0.0209829 ustep: 1 
iter: 2  value: 222.3413 mgc: 5.412448e-07 ustep: 1 
iter: 3  mgc: 2.231548e-14 
outer mgc:  0.2678656 
iter: 1  value: 222.3418 mgc: 0.05083496 ustep: 1 
iter: 2  value: 222.3418 mgc: 3.213014e-06 ustep: 1 
iter: 3  mgc: 1.501022e-13 
outer mgc:  0.3405194 
iter: 1  value: 222.3403 mgc: 0.050827 ustep: 1 
iter: 2  value: 222.3403 mgc: 3.205575e-06 ustep: 1 
iter: 3  mgc: 1.438849e-13 
outer mgc:  0.3409955 
iter: 1  value: 222.3419 mgc: 0.02624745 ustep: 1 
iter: 2  value: 222.3419 mgc: 8.091948e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.3196468 
iter: 1  value: 222.3402 mgc: 0.02624719 ustep: 1 
iter: 2  value: 222.3402 mgc: 8.103233e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.320115 
iter: 1  value: 222.3382 mgc: 0.004533756 ustep: 1 
iter: 2  value: 222.3382 mgc: 2.834618e-08 ustep: 1 
mgc: 1.931788e-14 
outer mgc:  0.001077313 
iter: 1  value: 222.3436 mgc: 0.004532667 ustep: 1 
iter: 2  value: 222.3436 mgc: 2.836326e-08 ustep: 1 
mgc: 2.734878e-14 
outer mgc:  0.001370287 
iter: 1  value: 222.3509 mgc: 0.05783391 ustep: 1 
iter: 2  value: 222.3509 mgc: 4.474318e-06 ustep: 1 
iter: 3  mgc: 5.373479e-14 
outer mgc:  0.1346163 
iter: 1  value: 222.3311 mgc: 0.05800687 ustep: 1 
iter: 2  value: 222.3311 mgc: 4.485138e-06 ustep: 1 
iter: 3  mgc: 5.140333e-14 
outer mgc:  0.1348944 
iter: 1  value: 222.3445 mgc: 0.05708768 ustep: 1 
iter: 2  value: 222.3445 mgc: 3.614886e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.1513407 
iter: 1  value: 222.3374 mgc: 0.0571448 ustep: 1 
iter: 2  value: 222.3374 mgc: 3.613183e-06 ustep: 1 
iter: 3  mgc: 4.174439e-14 
outer mgc:  0.1512724 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:25:16 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:51:01 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.02_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0.02_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.02, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.02_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2221.394048 
iter  10 value 2119.500375
iter  10 value 2119.500374
final  value 2119.500374 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2928.823 mgc: 75.4865 ustep: 0.4367355 
iter: 2  value: 2305.309 mgc: 54.38744 ustep: 0.06263616 
iter: 3  value: 2247.109 mgc: 35.57405 ustep: 0.08797778 
iter: 4  value: 2056.031 mgc: 117.498 ustep: 0.08420918 
iter: 5  value: 2052.847 mgc: 9.930516 ustep: 0.2902592 
iter: 6  value: 2052.836 mgc: 0.4912851 ustep: 0.5388032 
iter: 7  value: 2052.836 mgc: 0.01926214 ustep: 0.7340587 
iter: 8  value: 2052.836 mgc: 0.0004094578 ustep: 0.8567866 
iter: 9  value: 2052.836 mgc: 4.132632e-06 ustep: 0.9256351 
iter: 10  value: 2052.836 mgc: 2.014046e-08 ustep: 0.9621031 
mgc: 4.780509e-11 
iter: 1  mgc: 4.780509e-11 
Matching hessian patterns... Done
outer mgc:  95.47423 
iter: 1  value: 2001.178 mgc: 28.15275 ustep: 1 
iter: 2  value: 2000.834 mgc: 1.963243 ustep: 1 
iter: 3  value: 2000.834 mgc: 0.03226398 ustep: 1 
iter: 4  value: 2000.834 mgc: 2.810027e-06 ustep: 1 
iter: 5  mgc: 6.231793e-12 
iter: 1  mgc: 6.231793e-12 
outer mgc:  29.9272 
iter: 1  value: 2002.993 mgc: 19.73085 ustep: 1 
iter: 2  value: 2002.907 mgc: 1.94803 ustep: 1 
iter: 3  value: 2002.907 mgc: 0.01010442 ustep: 1 
iter: 4  value: 2002.907 mgc: 3.54375e-07 ustep: 1 
iter: 5  mgc: 5.066711e-12 
iter: 1  value: 1995.007 mgc: 11.59032 ustep: 1 
iter: 2  value: 1994.999 mgc: 0.5430917 ustep: 1 
iter: 3  value: 1994.999 mgc: 0.001173321 ustep: 1 
iter: 4  mgc: 8.970202e-09 
iter: 1  mgc: 8.970202e-09 
outer mgc:  17.80679 
iter: 1  value: 1994.445 mgc: 7.969972 ustep: 1 
iter: 2  value: 1994.444 mgc: 0.1826693 ustep: 1 
iter: 3  value: 1994.444 mgc: 0.000206371 ustep: 1 
iter: 4  mgc: 2.669116e-10 
iter: 1  mgc: 2.669116e-10 
outer mgc:  19.59992 
iter: 1  value: 1989.943 mgc: 16.37621 ustep: 1 
iter: 2  value: 1989.362 mgc: 2.390409 ustep: 1 
iter: 3  value: 1989.361 mgc: 0.05138472 ustep: 1 
iter: 4  value: 1989.361 mgc: 6.168732e-05 ustep: 1 
iter: 5  mgc: 9.192891e-11 
iter: 1  mgc: 9.192891e-11 
outer mgc:  3.749719 
iter: 1  value: 1987.803 mgc: 12.12822 ustep: 1 
iter: 2  value: 1987.599 mgc: 1.404598 ustep: 1 
iter: 3  value: 1987.599 mgc: 0.02420073 ustep: 1 
iter: 4  value: 1987.599 mgc: 1.364737e-05 ustep: 1 
iter: 5  mgc: 7.912115e-12 
iter: 1  mgc: 7.912115e-12 
outer mgc:  7.890916 
iter: 1  value: 1986.701 mgc: 19.13178 ustep: 1 
iter: 2  value: 1984.308 mgc: 4.870576 ustep: 1 
iter: 3  value: 1984.303 mgc: 0.2795682 ustep: 1 
iter: 4  value: 1984.303 mgc: 0.00174426 ustep: 1 
iter: 5  value: 1984.303 mgc: 6.917329e-08 ustep: 1 
mgc: 4.327871e-12 
iter: 1  mgc: 4.327871e-12 
outer mgc:  7.325014 
iter: 1  value: 1982.949 mgc: 13.12486 ustep: 1 
iter: 2  value: 1982.815 mgc: 1.03299 ustep: 1 
iter: 3  value: 1982.815 mgc: 0.01333491 ustep: 1 
iter: 4  value: 1982.815 mgc: 3.637876e-06 ustep: 1 
iter: 5  mgc: 1.062211e-11 
iter: 1  mgc: 1.062211e-11 
outer mgc:  5.122592 
iter: 1  value: 1984.458 mgc: 34.25904 ustep: 1 
iter: 2  value: 1983.769 mgc: 2.518968 ustep: 1 
iter: 3  value: 1983.769 mgc: 0.03934825 ustep: 1 
iter: 4  value: 1983.769 mgc: 6.643115e-06 ustep: 1 
iter: 5  mgc: 4.36734e-12 
iter: 1  value: 1982.2 mgc: 10.88582 ustep: 1 
iter: 2  value: 1982.186 mgc: 0.4195353 ustep: 1 
iter: 3  value: 1982.186 mgc: 0.00108091 ustep: 1 
iter: 4  mgc: 7.460367e-09 
iter: 1  mgc: 7.460367e-09 
outer mgc:  2.204652 
iter: 1  value: 1982.312 mgc: 11.35744 ustep: 1 
iter: 2  value: 1982.303 mgc: 0.4302657 ustep: 1 
iter: 3  value: 1982.303 mgc: 0.001388617 ustep: 1 
iter: 4  value: 1982.303 mgc: 1.471331e-08 ustep: 1 
mgc: 8.009149e-12 
iter: 1  value: 1982.067 mgc: 4.868949 ustep: 1 
iter: 2  value: 1982.067 mgc: 0.0841889 ustep: 1 
iter: 3  value: 1982.067 mgc: 5.363228e-05 ustep: 1 
iter: 4  mgc: 2.17808e-11 
iter: 1  mgc: 2.17808e-11 
outer mgc:  1.186553 
iter: 1  value: 1982.029 mgc: 3.191373 ustep: 1 
iter: 2  value: 1982.029 mgc: 0.04279002 ustep: 1 
iter: 3  value: 1982.029 mgc: 1.799602e-05 ustep: 1 
iter: 4  mgc: 7.999823e-12 
iter: 1  mgc: 7.999823e-12 
outer mgc:  0.8500122 
iter: 1  value: 1982.109 mgc: 1.466118 ustep: 1 
iter: 2  value: 1982.109 mgc: 0.0116115 ustep: 1 
iter: 3  value: 1982.109 mgc: 1.049318e-06 ustep: 1 
iter: 4  mgc: 1.389533e-11 
iter: 1  value: 1982.04 mgc: 0.3164438 ustep: 1 
iter: 2  value: 1982.04 mgc: 0.0004926431 ustep: 1 
iter: 3  mgc: 1.53664e-09 
iter: 1  value: 1982.031 mgc: 0.4368522 ustep: 1 
iter: 2  value: 1982.031 mgc: 0.0007469682 ustep: 1 
iter: 3  mgc: 3.57075e-09 
iter: 1  mgc: 3.57075e-09 
outer mgc:  0.6157955 
iter: 1  value: 1982.024 mgc: 0.1151329 ustep: 1 
iter: 2  value: 1982.024 mgc: 6.780117e-05 ustep: 1 
iter: 3  mgc: 2.687739e-11 
iter: 1  mgc: 2.687739e-11 
outer mgc:  0.2025943 
iter: 1  value: 1982.02 mgc: 0.5506189 ustep: 1 
iter: 2  value: 1982.02 mgc: 0.001749544 ustep: 1 
iter: 3  value: 1982.02 mgc: 3.539284e-08 ustep: 1 
mgc: 6.997514e-12 
iter: 1  mgc: 6.997514e-12 
outer mgc:  0.2755179 
iter: 1  value: 1982.021 mgc: 0.3516005 ustep: 1 
iter: 2  value: 1982.021 mgc: 0.0002967461 ustep: 1 
iter: 3  mgc: 5.456728e-10 
iter: 1  mgc: 5.456728e-10 
outer mgc:  0.08961237 
iter: 1  value: 1982.022 mgc: 0.1248622 ustep: 1 
iter: 2  value: 1982.022 mgc: 9.793614e-05 ustep: 1 
iter: 3  mgc: 7.647305e-11 
iter: 1  mgc: 7.647305e-11 
outer mgc:  0.03098712 
iter: 1  value: 1982.019 mgc: 0.02257789 ustep: 1 
iter: 2  value: 1982.019 mgc: 3.21763e-06 ustep: 1 
iter: 3  mgc: 6.784434e-12 
iter: 1  mgc: 6.784434e-12 
outer mgc:  0.03026063 
iter: 1  value: 1982.014 mgc: 0.09164735 ustep: 1 
iter: 2  value: 1982.014 mgc: 2.965444e-05 ustep: 1 
iter: 3  mgc: 8.951284e-12 
iter: 1  value: 1982.008 mgc: 0.1106879 ustep: 1 
iter: 2  value: 1982.008 mgc: 4.325759e-05 ustep: 1 
iter: 3  mgc: 1.977396e-11 
iter: 1  mgc: 1.977396e-11 
outer mgc:  0.2091026 
iter: 1  value: 1981.996 mgc: 0.1911086 ustep: 1 
iter: 2  value: 1981.996 mgc: 0.0001448894 ustep: 1 
iter: 3  mgc: 1.374039e-10 
iter: 1  value: 1981.978 mgc: 0.3147736 ustep: 1 
iter: 2  value: 1981.978 mgc: 0.000390497 ustep: 1 
iter: 3  mgc: 9.612153e-10 
iter: 1  mgc: 9.612153e-10 
outer mgc:  0.2956443 
iter: 1  value: 1981.962 mgc: 0.3395974 ustep: 1 
iter: 2  value: 1981.962 mgc: 0.0004222977 ustep: 1 
iter: 3  mgc: 1.11602e-09 
iter: 1  mgc: 1.11602e-09 
outer mgc:  0.3415274 
iter: 1  value: 1981.941 mgc: 0.1409596 ustep: 1 
iter: 2  value: 1981.941 mgc: 0.0001301707 ustep: 1 
iter: 3  mgc: 1.57089e-10 
iter: 1  mgc: 1.57089e-10 
outer mgc:  0.1378565 
iter: 1  value: 1981.93 mgc: 0.08421305 ustep: 1 
iter: 2  value: 1981.93 mgc: 2.469306e-05 ustep: 1 
iter: 3  mgc: 5.854939e-11 
iter: 1  mgc: 5.854939e-11 
outer mgc:  0.01287424 
iter: 1  value: 1981.923 mgc: 0.04160358 ustep: 1 
iter: 2  value: 1981.923 mgc: 4.456321e-06 ustep: 0.2494656 
iter: 3  value: 1981.923 mgc: 4.435195e-07 ustep: 0.02138696 
iter: 4  value: 1981.923 mgc: 3.130741e-07 ustep: 0.1463282 
iter: 5  value: 1981.923 mgc: 7.38897e-08 ustep: 0.3825904 
mgc: 5.820217e-09 
iter: 1  mgc: 5.820217e-09 
outer mgc:  0.0578396 
iter: 1  value: 1981.917 mgc: 0.005378945 ustep: 1 
iter: 2  value: 1981.917 mgc: 1.656717e-07 ustep: 0.8994163 
iter: 3  mgc: 9.22165e-10 
iter: 1  mgc: 9.22165e-10 
outer mgc:  0.04842545 
iter: 1  value: 1981.91 mgc: 0.0148546 ustep: 1 
iter: 2  value: 1981.91 mgc: 1.363369e-06 ustep: 1 
iter: 3  mgc: 6.850784e-10 
iter: 1  mgc: 6.850784e-10 
outer mgc:  0.01200291 
iter: 1  value: 1981.905 mgc: 0.01024957 ustep: 1 
iter: 2  value: 1981.905 mgc: 6.562062e-07 ustep: 0.8994163 
iter: 3  mgc: 2.494818e-09 
iter: 1  mgc: 2.494818e-09 
outer mgc:  0.008511209 
iter: 1  value: 1981.899 mgc: 0.009640299 ustep: 1 
iter: 2  value: 1981.899 mgc: 3.646902e-07 ustep: 0.6827823 
iter: 3  value: 1981.899 mgc: 1.284807e-08 ustep: 2.666552e-05 
mgc: 9.710238e-09 
iter: 1  mgc: 9.710238e-09 
outer mgc:  0.0160178 
iter: 1  value: 1981.894 mgc: 0.00779101 ustep: 0.9999 
iter: 2  value: 1981.894 mgc: 5.844325e-07 ustep: 0.9928299 
iter: 3  value: 1981.894 mgc: 1.540089e-07 ustep: 0.001370844 
mgc: 2.456386e-07 
iter: 1  value: 1981.894 mgc: 2.456386e-07 ustep: 8.530883e-09 
mgc: 1.865537e-07 
outer mgc:  0.01049202 
iter: 1  value: 1981.888 mgc: 0.006816097 ustep: 1 
iter: 2  value: 1981.888 mgc: 7.652737e-06 ustep: 1 
iter: 3  value: 1981.888 mgc: 3.986276e-06 ustep: 0.0005598185 
mgc: 7.658336e-06 
iter: 1  value: 1981.888 mgc: 7.658336e-06 ustep: 0.2494656 
iter: 2  value: 1981.887 mgc: 4.857085e-06 ustep: 0.08285847 
iter: 3  value: 1981.887 mgc: 4.006125e-06 ustep: 2.523118e-09 
mgc: 4.745555e-06 
outer mgc:  0.0004705493 
iter: 1  value: 3287.393 mgc: 7.497599 ustep: 1 
iter: 2  value: -1325.715 mgc: 18.82063 ustep: 0.9999 
iter: 3  value: -4154.635 mgc: 25.28054 ustep: 0.001202747 
iter: 4  value: -5591.991 mgc: 25.15935 ustep: 3.453149e-05 
iter: 5  value: -6103.991 mgc: 22.62193 ustep: 1.391057e-12 
mgc: 18.78107 
iter: 1  value: -9001.971 mgc: 18.78107 ustep: 3.498385e-05 
iter: 2  value: -10075.51 mgc: 34.89387 ustep: 7.354052e-07 
iter: 3  value: -12947.02 mgc: 25.15784 ustep: 4.672252e-07 
iter: 4  value: -12947.02 mgc: 30.10009 ustep: 4.435703e-17 
mgc: 30.85925 
outer mgc:  70.6389 
iter: 1  value: -2.079739e+29 mgc: 58.60929 ustep: 0.989901 
iter: 2  value: -2.47588e+29 mgc: 98.67423 ustep: 0.1521162 
iter: 3  value: -2.67395e+29 mgc: 82.42313 ustep: 0.3900818 
iter: 4  value: -3.961408e+29 mgc: 96.0213 ustep: 4.661853e-07 
iter: 5  value: -4.654655e+29 mgc: 96.02113 ustep: 2.445671e-05 
iter: 6  value: -5.149831e+29 mgc: 96.01229 ustep: 1.173813e-12 
mgc: 96.01229 
iter: 1  value: -7.724746e+29 mgc: 96.01229 ustep: 6.497498e-14 
mgc: 96.01229 
outer mgc:  3592.068 
iter: 1  value: -5.323526e+131 mgc: 196.2112 ustep: 1 
iter: 2  value: -1.508332e+132 mgc: 421.7634 ustep: 0.4367355 
iter: 3  value: -2.484312e+132 mgc: 187.8008 ustep: 0.0006360717 
iter: 4  value: -3.726468e+132 mgc: 186.101 ustep: 0.0008006513 
iter: 5  value: -4.968624e+132 mgc: 183.986 ustep: 0.0008992638 
iter: 6  value: -6.122055e+132 mgc: 181.641 ustep: 3.633062e-09 
iter: 7  value: -6.122055e+132 mgc: 181.641 ustep: 1.488269e-13 
Error in newton(par = c(u_large = -6.87933078637375, u_large = -2.77722670026114,  : 
  Newton failed to find minimum.
In addition: Warning message:
package ‘nnet’ was built under R version 3.6.3 
iter: 1  value: -7.724746e+29 mgc: 96.01229 ustep: 6.497498e-14 
mgc: 96.01229 
iter: 1  value: -7.823781e+29 mgc: 96.01229 ustep: 1.014625e-15 
mgc: 96.01229 
outer mgc:  3592.068 
iter: 1  value: -2.971056e+28 mgc: 96.01229 ustep: 0.9999 
iter: 2  value: -2.872021e+29 mgc: 120.8999 ustep: 0.01538496 
iter: 3  value: -3.367197e+29 mgc: 121.1518 ustep: 0.02307914 
iter: 4  value: -3.466232e+29 mgc: 116.9192 ustep: 3.576071e-06 
iter: 5  value: -4.159479e+29 mgc: 116.9185 ustep: 3.035979e-08 
iter: 6  value: -4.95176e+29 mgc: 116.9185 ustep: 3.182295e-14 
Error in newton(par = c(u_large = -6.87933078637135, u_large = -2.77722670026118,  : 
  Newton failed to find minimum.
In addition: Warning message:
In nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) :
  NA/NaN function evaluation
outer mgc:  NaN 
Error in optimHess(par.fixed, obj$fn, obj$gr) : 
  gradient in optim evaluated to length 1 not 8
[Sun Aug 15 14:51:03 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:12:54 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2259.845478 
iter  10 value 1632.400300
iter  10 value 1632.400299
final  value 1632.400299 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 327.8169 mgc: 125.1125 ustep: 1 
iter: 2  value: 245.8034 mgc: 29.83864 ustep: 1 
iter: 3  value: 227.8593 mgc: 22.44418 ustep: 1 
iter: 4  value: 227.7176 mgc: 1.822601 ustep: 1 
iter: 5  value: 227.7176 mgc: 0.02426489 ustep: 1 
iter: 6  value: 227.7176 mgc: 8.20142e-06 ustep: 1 
iter: 7  mgc: 9.369172e-13 
iter: 1  mgc: 9.369172e-13 
Matching hessian patterns... Done
outer mgc:  16.18332 
iter: 1  value: 216.1029 mgc: 20.14958 ustep: 1 
iter: 2  value: 215.4382 mgc: 2.521966 ustep: 1 
iter: 3  value: 215.4378 mgc: 0.05271465 ustep: 1 
iter: 4  value: 215.4378 mgc: 4.153191e-05 ustep: 1 
iter: 5  mgc: 5.902365e-11 
iter: 1  mgc: 5.902365e-11 
outer mgc:  15.75921 
iter: 1  value: 247.9714 mgc: 26.94449 ustep: 1 
iter: 2  value: 247.2697 mgc: 2.381367 ustep: 1 
iter: 3  value: 247.2691 mgc: 0.07577304 ustep: 1 
iter: 4  value: 247.2691 mgc: 0.0001142992 ustep: 1 
iter: 5  mgc: 2.614573e-10 
iter: 1  value: 213.1918 mgc: 4.602651 ustep: 1 
iter: 2  value: 213.1905 mgc: 0.1176242 ustep: 1 
iter: 3  value: 213.1905 mgc: 0.0001525687 ustep: 1 
iter: 4  mgc: 4.158402e-10 
iter: 1  mgc: 4.158402e-10 
outer mgc:  5.130369 
iter: 1  value: 211.8373 mgc: 3.992143 ustep: 1 
iter: 2  value: 211.8367 mgc: 0.08020571 ustep: 1 
iter: 3  value: 211.8367 mgc: 6.56058e-05 ustep: 1 
iter: 4  mgc: 1.782655e-10 
iter: 1  mgc: 1.782655e-10 
outer mgc:  5.120255 
iter: 1  value: 210.5845 mgc: 3.63666 ustep: 1 
iter: 2  value: 210.5834 mgc: 0.08955258 ustep: 1 
iter: 3  value: 210.5834 mgc: 0.0001993401 ustep: 1 
iter: 4  mgc: 2.010035e-09 
iter: 1  mgc: 2.010035e-09 
outer mgc:  14.20316 
iter: 1  value: 208.9424 mgc: 19.82795 ustep: 1 
iter: 2  value: 208.2259 mgc: 2.911663 ustep: 1 
iter: 3  value: 208.2257 mgc: 0.05005007 ustep: 1 
iter: 4  value: 208.2257 mgc: 3.438397e-05 ustep: 1 
iter: 5  mgc: 2.303097e-11 
iter: 1  mgc: 2.303097e-11 
outer mgc:  4.823279 
iter: 1  value: 207.9191 mgc: 8.379002 ustep: 1 
iter: 2  value: 207.8925 mgc: 0.5084042 ustep: 1 
iter: 3  value: 207.8925 mgc: 0.002821395 ustep: 1 
iter: 4  value: 207.8925 mgc: 1.131199e-07 ustep: 1 
mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  7.778799 
iter: 1  value: 206.1023 mgc: 20.34745 ustep: 1 
iter: 2  value: 205.4128 mgc: 2.892621 ustep: 1 
iter: 3  value: 205.4126 mgc: 0.04721886 ustep: 1 
iter: 4  value: 205.4126 mgc: 2.216469e-05 ustep: 1 
iter: 5  mgc: 9.711343e-12 
iter: 1  mgc: 9.711343e-12 
outer mgc:  7.874036 
iter: 1  value: 203.5726 mgc: 11.99517 ustep: 1 
iter: 2  value: 203.5148 mgc: 0.8010011 ustep: 1 
iter: 3  value: 203.5148 mgc: 0.005395614 ustep: 1 
iter: 4  value: 203.5148 mgc: 2.928947e-07 ustep: 1 
iter: 5  mgc: 3.252953e-14 
iter: 1  mgc: 3.252953e-14 
outer mgc:  9.854356 
iter: 1  value: 201.1816 mgc: 18.28387 ustep: 1 
iter: 2  value: 200.7944 mgc: 2.083886 ustep: 1 
iter: 3  value: 200.7944 mgc: 0.02746866 ustep: 1 
iter: 4  value: 200.7944 mgc: 5.571204e-06 ustep: 1 
iter: 5  mgc: 3.115286e-13 
iter: 1  value: 204.7571 mgc: 33.59526 ustep: 1 
iter: 2  value: 198.4604 mgc: 8.581319 ustep: 1 
iter: 3  value: 198.4504 mgc: 0.3823696 ustep: 1 
iter: 4  value: 198.4504 mgc: 0.001633262 ustep: 1 
iter: 5  value: 198.4504 mgc: 3.608181e-08 ustep: 1 
mgc: 3.474998e-14 
iter: 1  mgc: 3.474998e-14 
outer mgc:  8.487769 
iter: 1  value: 198.3792 mgc: 15.87561 ustep: 1 
iter: 2  value: 194.9607 mgc: 5.751871 ustep: 1 
iter: 3  value: 194.9543 mgc: 0.1974603 ustep: 1 
iter: 4  value: 194.9543 mgc: 0.0006544413 ustep: 1 
iter: 5  value: 194.9543 mgc: 1.589263e-08 ustep: 1 
mgc: 3.297644e-14 
iter: 1  mgc: 3.297644e-14 
outer mgc:  14.05754 
iter: 1  value: 210.9328 mgc: 59.26811 ustep: 1 
iter: 2  value: 206.5757 mgc: 6.449833 ustep: 1 
iter: 3  value: 206.5641 mgc: 0.3461162 ustep: 1 
iter: 4  value: 206.5641 mgc: 0.001532038 ustep: 1 
iter: 5  value: 206.5641 mgc: 3.045557e-08 ustep: 1 
mgc: 4.707346e-14 
iter: 1  value: 193.7789 mgc: 18.16948 ustep: 1 
iter: 2  value: 193.7008 mgc: 1.031139 ustep: 1 
iter: 3  value: 193.7007 mgc: 0.007395823 ustep: 1 
iter: 4  value: 193.7007 mgc: 6.977433e-07 ustep: 1 
iter: 5  mgc: 4.152234e-14 
iter: 1  mgc: 4.152234e-14 
outer mgc:  16.24674 
iter: 1  value: 192.1906 mgc: 3.62376 ustep: 1 
iter: 2  value: 192.1896 mgc: 0.07545449 ustep: 1 
iter: 3  value: 192.1896 mgc: 7.2104e-05 ustep: 1 
iter: 4  mgc: 1.43526e-10 
iter: 1  mgc: 1.43526e-10 
outer mgc:  3.306242 
iter: 1  value: 191.7469 mgc: 4.653898 ustep: 1 
iter: 2  value: 191.744 mgc: 0.1624767 ustep: 1 
iter: 3  value: 191.744 mgc: 0.0002555114 ustep: 1 
iter: 4  mgc: 8.87364e-10 
iter: 1  mgc: 8.87364e-10 
outer mgc:  2.811703 
iter: 1  value: 191.4219 mgc: 6.547537 ustep: 1 
iter: 2  value: 191.4199 mgc: 0.1443991 ustep: 1 
iter: 3  value: 191.4199 mgc: 0.0001596858 ustep: 1 
iter: 4  mgc: 1.954263e-10 
iter: 1  value: 191.6323 mgc: 5.271541 ustep: 1 
iter: 2  value: 191.6318 mgc: 0.08138912 ustep: 1 
iter: 3  value: 191.6318 mgc: 4.160678e-05 ustep: 1 
iter: 4  mgc: 2.055511e-11 
iter: 1  value: 191.5736 mgc: 2.58762 ustep: 1 
iter: 2  value: 191.5735 mgc: 0.02639667 ustep: 1 
iter: 3  value: 191.5735 mgc: 4.314495e-06 ustep: 1 
iter: 4  mgc: 1.285638e-13 
iter: 1  mgc: 1.285638e-13 
outer mgc:  2.60445 
iter: 1  value: 191.4542 mgc: 1.580919 ustep: 1 
iter: 2  value: 191.4542 mgc: 0.01483489 ustep: 1 
iter: 3  value: 191.4542 mgc: 2.190471e-06 ustep: 1 
iter: 4  mgc: 8.237855e-14 
iter: 1  mgc: 8.237855e-14 
outer mgc:  1.16141 
iter: 1  value: 191.332 mgc: 0.9811752 ustep: 1 
iter: 2  value: 191.332 mgc: 0.005807391 ustep: 1 
iter: 3  value: 191.332 mgc: 2.08052e-07 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  1.07672 
iter: 1  value: 191.269 mgc: 0.9373385 ustep: 1 
iter: 2  value: 191.269 mgc: 0.009112655 ustep: 1 
iter: 3  value: 191.269 mgc: 1.809243e-06 ustep: 1 
iter: 4  mgc: 1.154632e-13 
iter: 1  mgc: 1.154632e-13 
outer mgc:  0.7616309 
iter: 1  value: 191.2278 mgc: 1.167389 ustep: 1 
iter: 2  value: 191.2278 mgc: 0.02026637 ustep: 1 
iter: 3  value: 191.2278 mgc: 1.169205e-06 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.509685 
iter: 1  value: 191.2074 mgc: 0.9583089 ustep: 1 
iter: 2  value: 191.2074 mgc: 0.003333032 ustep: 1 
iter: 3  value: 191.2074 mgc: 6.544255e-08 ustep: 1 
mgc: 2.581269e-14 
iter: 1  mgc: 2.581269e-14 
outer mgc:  0.4664526 
iter: 1  value: 191.248 mgc: 1.072223 ustep: 1 
iter: 2  value: 191.248 mgc: 0.002901773 ustep: 1 
iter: 3  value: 191.248 mgc: 7.347583e-08 ustep: 1 
mgc: 5.795364e-14 
iter: 1  value: 191.2137 mgc: 0.3943 ustep: 1 
iter: 2  value: 191.2137 mgc: 0.000664979 ustep: 1 
iter: 3  mgc: 2.73877e-09 
iter: 1  mgc: 2.73877e-09 
outer mgc:  0.475017 
iter: 1  value: 191.2231 mgc: 0.1034527 ustep: 1 
iter: 2  value: 191.2231 mgc: 0.0001016657 ustep: 1 
iter: 3  mgc: 2.798579e-10 
iter: 1  mgc: 2.798579e-10 
outer mgc:  0.1912265 
iter: 1  value: 191.2128 mgc: 0.04331231 ustep: 1 
iter: 2  value: 191.2128 mgc: 3.163873e-05 ustep: 1 
iter: 3  mgc: 3.414491e-11 
iter: 1  mgc: 3.414491e-11 
outer mgc:  0.09459759 
iter: 1  value: 191.2198 mgc: 0.05049021 ustep: 1 
iter: 2  value: 191.2198 mgc: 6.138124e-06 ustep: 1 
iter: 3  mgc: 1.028067e-12 
iter: 1  mgc: 1.028067e-12 
outer mgc:  0.0110774 
iter: 1  value: 191.2196 mgc: 0.02054387 ustep: 1 
iter: 2  value: 191.2196 mgc: 1.710195e-06 ustep: 1 
iter: 3  mgc: 4.818368e-14 
iter: 1  mgc: 4.818368e-14 
outer mgc:  0.01374951 
iter: 1  value: 191.2193 mgc: 0.005949172 ustep: 1 
iter: 2  value: 191.2193 mgc: 1.695798e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.004287936 
iter: 1  value: 191.2193 mgc: 0.003500664 ustep: 1 
iter: 2  value: 191.2193 mgc: 5.700229e-08 ustep: 1 
mgc: 3.558265e-14 
iter: 1  mgc: 3.558265e-14 
outer mgc:  0.000613247 
iter: 1  value: 191.2193 mgc: 0.0004879034 ustep: 1 
iter: 2  mgc: 1.782321e-09 
iter: 1  mgc: 1.782321e-09 
outer mgc:  9.577527e-05 
iter: 1  mgc: 1.782321e-09 
iter: 1  mgc: 1.782321e-09 
outer mgc:  9.577527e-05 
iter: 1  value: 191.2201 mgc: 0.04784328 ustep: 1 
iter: 2  value: 191.2201 mgc: 7.76351e-06 ustep: 1 
iter: 3  mgc: 3.204104e-13 
outer mgc:  0.05613248 
iter: 1  value: 191.2185 mgc: 0.04785923 ustep: 1 
iter: 2  value: 191.2185 mgc: 7.7564e-06 ustep: 1 
iter: 3  mgc: 3.390621e-13 
outer mgc:  0.05611182 
iter: 1  value: 191.2198 mgc: 0.0226901 ustep: 1 
iter: 2  value: 191.2198 mgc: 1.818826e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.1137713 
iter: 1  value: 191.2188 mgc: 0.0226987 ustep: 1 
iter: 2  value: 191.2188 mgc: 1.819281e-06 ustep: 1 
iter: 3  mgc: 3.097522e-14 
outer mgc:  0.1139757 
iter: 1  value: 191.2188 mgc: 0.03676733 ustep: 1 
iter: 2  value: 191.2188 mgc: 8.401643e-06 ustep: 1 
iter: 3  mgc: 6.215028e-13 
outer mgc:  0.02738893 
iter: 1  value: 191.2198 mgc: 0.03674754 ustep: 1 
iter: 2  value: 191.2198 mgc: 8.410693e-06 ustep: 1 
iter: 3  mgc: 6.155076e-13 
outer mgc:  0.02740988 
iter: 1  value: 191.2191 mgc: 0.01840679 ustep: 1 
iter: 2  value: 191.2191 mgc: 2.105563e-06 ustep: 1 
iter: 3  mgc: 5.423439e-14 
outer mgc:  0.05929831 
iter: 1  value: 191.2195 mgc: 0.01839684 ustep: 1 
iter: 2  value: 191.2195 mgc: 2.10555e-06 ustep: 1 
iter: 3  mgc: 5.195844e-14 
outer mgc:  0.05942089 
iter: 1  value: 191.2183 mgc: 0.004948262 ustep: 1 
iter: 2  value: 191.2183 mgc: 2.145432e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.004760742 
iter: 1  value: 191.2202 mgc: 0.004943137 ustep: 1 
iter: 2  value: 191.2202 mgc: 2.143728e-07 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.004689472 
iter: 1  value: 191.2208 mgc: 0.01409624 ustep: 1 
iter: 2  value: 191.2208 mgc: 3.036441e-07 ustep: 1 
iter: 3  mgc: 3.441691e-14 
outer mgc:  0.0238958 
iter: 1  value: 191.2178 mgc: 0.01412668 ustep: 1 
iter: 2  value: 191.2178 mgc: 3.053215e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.02399253 
iter: 1  value: 191.2208 mgc: 0.007650331 ustep: 1 
iter: 2  value: 191.2208 mgc: 7.364584e-07 ustep: 1 
iter: 3  mgc: 3.674838e-14 
outer mgc:  0.02292573 
iter: 1  value: 191.2178 mgc: 0.007668895 ustep: 1 
iter: 2  value: 191.2178 mgc: 7.379121e-07 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.02292412 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:12:56 2021]
Finished job 0.
1 of 1 steps (100%) done

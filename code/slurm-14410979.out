Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:31:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.02_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.02_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.02_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4437.295034 
final  value 4292.084995 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 735.5824 mgc: 88.12077 ustep: 1 
iter: 2  value: 666.9601 mgc: 34.14166 ustep: 1 
iter: 3  value: 643.7395 mgc: 37.84478 ustep: 1 
iter: 4  value: 643.0406 mgc: 6.270906 ustep: 1 
iter: 5  value: 643.0373 mgc: 0.4152653 ustep: 1 
iter: 6  value: 643.0373 mgc: 0.002318838 ustep: 1 
iter: 7  value: 643.0373 mgc: 7.362323e-08 ustep: 1 
mgc: 1.609823e-14 
iter: 1  mgc: 1.609823e-14 
Matching hessian patterns... Done
outer mgc:  158.1982 
iter: 1  value: 493.8519 mgc: 19.54878 ustep: 1 
iter: 2  value: 493.2856 mgc: 1.318162 ustep: 1 
iter: 3  value: 493.2854 mgc: 0.03642565 ustep: 1 
iter: 4  value: 493.2854 mgc: 4.572228e-05 ustep: 1 
iter: 5  mgc: 8.426246e-11 
iter: 1  mgc: 8.426246e-11 
outer mgc:  94.82348 
iter: 1  value: 438.0502 mgc: 13.13333 ustep: 1 
iter: 2  value: 437.9215 mgc: 0.8515713 ustep: 1 
iter: 3  value: 437.9215 mgc: 0.007827373 ustep: 1 
iter: 4  value: 437.9215 mgc: 1.202669e-06 ustep: 1 
iter: 5  mgc: 4.77951e-14 
iter: 1  mgc: 4.77951e-14 
outer mgc:  40.61226 
iter: 1  value: 508.1028 mgc: 36.60199 ustep: 1 
iter: 2  value: 501.9037 mgc: 6.487753 ustep: 1 
iter: 3  value: 501.8975 mgc: 0.2521237 ustep: 1 
iter: 4  value: 501.8975 mgc: 0.0006617112 ustep: 1 
iter: 5  mgc: 6.377256e-09 
iter: 1  value: 432.2791 mgc: 9.389244 ustep: 1 
iter: 2  value: 432.2657 mgc: 0.2254112 ustep: 1 
iter: 3  value: 432.2657 mgc: 0.0004768543 ustep: 1 
iter: 4  mgc: 3.626669e-09 
iter: 1  mgc: 3.626669e-09 
outer mgc:  18.81095 
iter: 1  value: 427.834 mgc: 0.9437039 ustep: 1 
iter: 2  value: 427.834 mgc: 0.004220432 ustep: 1 
iter: 3  value: 427.834 mgc: 1.490159e-07 ustep: 1 
mgc: 2.653433e-14 
iter: 1  mgc: 2.653433e-14 
outer mgc:  17.89068 
iter: 1  value: 420.2451 mgc: 16.67543 ustep: 1 
iter: 2  value: 420.0211 mgc: 1.10383 ustep: 1 
iter: 3  value: 420.0211 mgc: 0.009574871 ustep: 1 
iter: 4  value: 420.0211 mgc: 1.847512e-06 ustep: 1 
iter: 5  mgc: 6.239453e-14 
iter: 1  mgc: 6.239453e-14 
outer mgc:  25.69237 
iter: 1  value: 406.6077 mgc: 11.34013 ustep: 1 
iter: 2  value: 406.4533 mgc: 1.418521 ustep: 1 
iter: 3  value: 406.4533 mgc: 0.02522625 ustep: 1 
iter: 4  value: 406.4533 mgc: 8.415145e-06 ustep: 1 
iter: 5  mgc: 9.388046e-13 
iter: 1  mgc: 9.388046e-13 
outer mgc:  12.32385 
iter: 1  value: 411.6071 mgc: 25.73355 ustep: 1 
iter: 2  value: 410.9053 mgc: 4.298118 ustep: 1 
iter: 3  value: 410.9052 mgc: 0.0982957 ustep: 1 
iter: 4  value: 410.9052 mgc: 5.453018e-05 ustep: 1 
iter: 5  mgc: 1.639222e-11 
iter: 1  value: 405.7272 mgc: 3.798778 ustep: 1 
iter: 2  value: 405.7257 mgc: 0.1006702 ustep: 1 
iter: 3  value: 405.7257 mgc: 7.433739e-05 ustep: 1 
iter: 4  mgc: 5.090861e-11 
iter: 1  mgc: 5.090861e-11 
outer mgc:  23.01735 
iter: 1  value: 405.0663 mgc: 11.92856 ustep: 1 
iter: 2  value: 405.0476 mgc: 0.4534575 ustep: 1 
iter: 3  value: 405.0476 mgc: 0.0015069 ustep: 1 
iter: 4  value: 405.0476 mgc: 1.650383e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  20.00337 
iter: 1  value: 403.3637 mgc: 8.149954 ustep: 1 
iter: 2  value: 403.3558 mgc: 0.2282466 ustep: 1 
iter: 3  value: 403.3558 mgc: 0.0002699808 ustep: 1 
iter: 4  mgc: 5.10145e-10 
iter: 1  mgc: 5.10145e-10 
outer mgc:  5.552345 
iter: 1  value: 403.7408 mgc: 2.08121 ustep: 1 
iter: 2  value: 403.7406 mgc: 0.02811428 ustep: 1 
iter: 3  value: 403.7406 mgc: 5.675089e-06 ustep: 1 
iter: 4  mgc: 8.497647e-13 
iter: 1  value: 403.2984 mgc: 1.476702 ustep: 1 
iter: 2  value: 403.2984 mgc: 0.005350451 ustep: 1 
iter: 3  value: 403.2984 mgc: 1.490754e-07 ustep: 1 
mgc: 2.475797e-14 
iter: 1  mgc: 2.475797e-14 
outer mgc:  6.32202 
iter: 1  value: 403.1991 mgc: 2.304943 ustep: 1 
iter: 2  value: 403.199 mgc: 0.01933521 ustep: 1 
iter: 3  value: 403.199 mgc: 2.413566e-06 ustep: 1 
iter: 4  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  2.108814 
iter: 1  value: 403.0949 mgc: 1.42968 ustep: 1 
iter: 2  value: 403.0949 mgc: 0.006686684 ustep: 1 
iter: 3  value: 403.0949 mgc: 3.479375e-07 ustep: 1 
iter: 4  mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  0.8745988 
iter: 1  value: 403.1121 mgc: 0.9972397 ustep: 1 
iter: 2  value: 403.1121 mgc: 0.004444304 ustep: 1 
iter: 3  value: 403.1121 mgc: 1.394152e-07 ustep: 1 
mgc: 2.697842e-14 
iter: 1  value: 403.0965 mgc: 0.7230599 ustep: 1 
iter: 2  value: 403.0965 mgc: 0.0009767229 ustep: 1 
iter: 3  mgc: 5.601824e-09 
iter: 1  mgc: 5.601824e-09 
outer mgc:  1.427834 
iter: 1  value: 403.0804 mgc: 0.5288204 ustep: 1 
iter: 2  value: 403.0804 mgc: 0.0009655862 ustep: 1 
iter: 3  mgc: 6.868827e-09 
iter: 1  mgc: 6.868827e-09 
outer mgc:  1.275772 
iter: 1  value: 403.0748 mgc: 0.2498204 ustep: 1 
iter: 2  value: 403.0748 mgc: 0.0004090046 ustep: 1 
iter: 3  mgc: 2.115854e-09 
iter: 1  mgc: 2.115854e-09 
outer mgc:  0.3822482 
iter: 1  value: 403.0684 mgc: 0.2411845 ustep: 1 
iter: 2  value: 403.0684 mgc: 0.0003859812 ustep: 1 
iter: 3  mgc: 1.103715e-09 
iter: 1  value: 403.0696 mgc: 0.08838215 ustep: 1 
iter: 2  value: 403.0696 mgc: 5.192218e-05 ustep: 1 
iter: 3  mgc: 2.007638e-11 
iter: 1  mgc: 2.007638e-11 
outer mgc:  0.2588898 
iter: 1  value: 403.0621 mgc: 0.1590753 ustep: 1 
iter: 2  value: 403.0621 mgc: 6.096449e-05 ustep: 1 
iter: 3  mgc: 2.39373e-11 
iter: 1  mgc: 2.39373e-11 
outer mgc:  0.5851764 
iter: 1  value: 403.0592 mgc: 0.1535554 ustep: 1 
iter: 2  value: 403.0592 mgc: 6.59457e-05 ustep: 1 
iter: 3  mgc: 2.715872e-11 
iter: 1  mgc: 2.715872e-11 
outer mgc:  0.2119159 
iter: 1  value: 403.0462 mgc: 0.17192 ustep: 1 
iter: 2  value: 403.0462 mgc: 7.540338e-05 ustep: 1 
iter: 3  mgc: 1.770228e-11 
iter: 1  mgc: 1.770228e-11 
outer mgc:  0.3802237 
iter: 1  value: 403.0322 mgc: 0.1808191 ustep: 1 
iter: 2  value: 403.0322 mgc: 0.0001264352 ustep: 1 
iter: 3  mgc: 9.969048e-11 
iter: 1  mgc: 9.969048e-11 
outer mgc:  0.4007559 
iter: 1  value: 403.0222 mgc: 0.3046416 ustep: 1 
iter: 2  value: 403.0222 mgc: 0.0003030971 ustep: 1 
iter: 3  mgc: 6.987868e-10 
iter: 1  value: 403.0344 mgc: 0.1623579 ustep: 1 
iter: 2  value: 403.0344 mgc: 0.0001099371 ustep: 1 
iter: 3  mgc: 9.091394e-11 
iter: 1  value: 403.0325 mgc: 0.05330299 ustep: 1 
iter: 2  value: 403.0325 mgc: 9.613378e-06 ustep: 1 
iter: 3  mgc: 9.618972e-13 
iter: 1  mgc: 9.618972e-13 
outer mgc:  0.2276194 
iter: 1  value: 403.0291 mgc: 0.07682091 ustep: 1 
iter: 2  value: 403.0291 mgc: 1.558448e-05 ustep: 1 
iter: 3  mgc: 1.314948e-12 
iter: 1  mgc: 1.314948e-12 
outer mgc:  0.1103889 
iter: 1  value: 403.0245 mgc: 0.04557988 ustep: 1 
iter: 2  value: 403.0245 mgc: 4.428111e-06 ustep: 1 
iter: 3  mgc: 9.947598e-14 
iter: 1  value: 403.0201 mgc: 0.04745062 ustep: 1 
iter: 2  value: 403.0201 mgc: 1.333905e-05 ustep: 1 
iter: 3  mgc: 2.626455e-12 
iter: 1  value: 403.0119 mgc: 0.08781791 ustep: 1 
iter: 2  value: 403.0119 mgc: 4.21418e-05 ustep: 1 
iter: 3  mgc: 2.65139e-11 
iter: 1  mgc: 2.65139e-11 
outer mgc:  0.1117716 
iter: 1  value: 402.995 mgc: 0.2526918 ustep: 1 
iter: 2  value: 402.995 mgc: 0.000460613 ustep: 1 
iter: 3  mgc: 1.765436e-09 
iter: 1  mgc: 1.765436e-09 
outer mgc:  0.1361886 
iter: 1  value: 403.0066 mgc: 0.06895696 ustep: 1 
iter: 2  value: 403.0066 mgc: 1.296895e-05 ustep: 1 
iter: 3  mgc: 7.030487e-13 
iter: 1  value: 402.9961 mgc: 0.04480181 ustep: 1 
iter: 2  value: 402.9961 mgc: 7.481848e-06 ustep: 1 
iter: 3  mgc: 4.050094e-13 
iter: 1  mgc: 4.050094e-13 
outer mgc:  0.03764546 
iter: 1  value: 402.9981 mgc: 0.03048737 ustep: 1 
iter: 2  value: 402.9981 mgc: 6.683546e-06 ustep: 1 
iter: 3  mgc: 2.318146e-13 
iter: 1  mgc: 2.318146e-13 
outer mgc:  0.01432375 
iter: 1  value: 402.9969 mgc: 0.02563245 ustep: 1 
iter: 2  value: 402.9969 mgc: 3.62919e-06 ustep: 1 
iter: 3  mgc: 1.266764e-13 
iter: 1  mgc: 1.266764e-13 
outer mgc:  0.01641941 
iter: 1  value: 402.9989 mgc: 0.006351852 ustep: 1 
iter: 2  value: 402.9989 mgc: 1.406967e-07 ustep: 1 
iter: 3  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  0.00511972 
iter: 1  value: 402.9982 mgc: 0.007554742 ustep: 1 
iter: 2  value: 402.9982 mgc: 1.027774e-07 ustep: 1 
mgc: 1.598721e-14 
iter: 1  value: 402.9987 mgc: 0.002115708 ustep: 1 
iter: 2  value: 402.9987 mgc: 3.282155e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  0.003700351 
iter: 1  value: 402.9984 mgc: 0.001579194 ustep: 1 
iter: 2  value: 402.9984 mgc: 1.132266e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.0002696188 
iter: 1  value: 402.9984 mgc: 0.0004625042 ustep: 1 
iter: 2  mgc: 1.395755e-09 
iter: 1  mgc: 1.395755e-09 
outer mgc:  0.0002174259 
iter: 1  mgc: 1.395755e-09 
iter: 1  mgc: 1.395755e-09 
outer mgc:  0.0002174259 
iter: 1  value: 402.999 mgc: 0.05383923 ustep: 1 
iter: 2  value: 402.999 mgc: 5.928608e-06 ustep: 1 
iter: 3  mgc: 2.300382e-13 
outer mgc:  0.1374797 
iter: 1  value: 402.998 mgc: 0.05383215 ustep: 1 
iter: 2  value: 402.998 mgc: 5.937066e-06 ustep: 1 
iter: 3  mgc: 2.229328e-13 
outer mgc:  0.1375613 
iter: 1  value: 402.9995 mgc: 0.02872974 ustep: 1 
iter: 2  value: 402.9995 mgc: 2.317042e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.2606096 
iter: 1  value: 402.9976 mgc: 0.0287305 ustep: 1 
iter: 2  value: 402.9976 mgc: 2.319903e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.2610566 
iter: 1  value: 402.9981 mgc: 0.04776864 ustep: 1 
iter: 2  value: 402.9981 mgc: 8.25478e-06 ustep: 1 
iter: 3  mgc: 4.215517e-13 
outer mgc:  0.09498153 
iter: 1  value: 402.9989 mgc: 0.04776038 ustep: 1 
iter: 2  value: 402.9989 mgc: 8.265159e-06 ustep: 1 
iter: 3  mgc: 4.23106e-13 
outer mgc:  0.09489959 
iter: 1  value: 402.9984 mgc: 0.02593462 ustep: 1 
iter: 2  value: 402.9984 mgc: 2.727384e-06 ustep: 1 
iter: 3  mgc: 5.750955e-14 
outer mgc:  0.2001079 
iter: 1  value: 402.9986 mgc: 0.02592843 ustep: 1 
iter: 2  value: 402.9986 mgc: 2.727707e-06 ustep: 1 
iter: 3  mgc: 4.307665e-14 
outer mgc:  0.1998736 
iter: 1  value: 402.9967 mgc: 0.004260622 ustep: 1 
iter: 2  value: 402.9967 mgc: 1.155563e-07 ustep: 1 
mgc: 1.798561e-14 
outer mgc:  0.005441298 
iter: 1  value: 403.0001 mgc: 0.004258465 ustep: 1 
iter: 2  value: 403.0001 mgc: 1.155239e-07 ustep: 1 
mgc: 2.842171e-14 
outer mgc:  0.005543851 
iter: 1  value: 403.0013 mgc: 0.01898733 ustep: 1 
iter: 2  value: 403.0013 mgc: 2.025765e-06 ustep: 1 
iter: 3  mgc: 3.924638e-14 
outer mgc:  0.08162402 
iter: 1  value: 402.9956 mgc: 0.01903583 ustep: 1 
iter: 2  value: 402.9956 mgc: 2.033366e-06 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.08180153 
iter: 1  value: 403.0007 mgc: 0.01056448 ustep: 1 
iter: 2  value: 403.0007 mgc: 1.325545e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.08526875 
iter: 1  value: 402.9962 mgc: 0.01058759 ustep: 1 
iter: 2  value: 402.9962 mgc: 1.329521e-06 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.08532092 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:31:07 2021]
Finished job 0.
1 of 1 steps (100%) done

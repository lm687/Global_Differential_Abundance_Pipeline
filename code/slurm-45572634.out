Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:00:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_4_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2141.195351 
final  value 1815.338541 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2082.731 mgc: 110.468 ustep: 1 
iter: 2  value: 2059.106 mgc: 76.0855 ustep: 0.4367355 
iter: 3  value: 2039.654 mgc: 87.92546 ustep: 0.06532755 
iter: 4  value: 1980.84 mgc: 80.95357 ustep: 0.07114355 
iter: 5  value: 1944.934 mgc: 83.03378 ustep: 0.1437151 
iter: 6  value: 1918.778 mgc: 70.57016 ustep: 0.3791599 
iter: 7  value: 1871.858 mgc: 66.25532 ustep: 0.615798 
iter: 8  value: 1860.154 mgc: 31.39587 ustep: 0.7847495 
iter: 9  value: 1860.057 mgc: 2.73065 ustep: 0.8858723 
iter: 10  value: 1860.057 mgc: 0.03085607 ustep: 0.9412138 
iter: 11  value: 1860.057 mgc: 0.0001152528 ustep: 0.9701647 
iter: 12  value: 1860.057 mgc: 1.925172e-07 ustep: 0.9849709 
iter: 13  mgc: 1.652151e-10 
iter: 1  mgc: 1.652151e-10 
Matching hessian patterns... Done
outer mgc:  65.73166 
iter: 1  value: 1805.407 mgc: 9.710319 ustep: 1 
iter: 2  value: 1805.142 mgc: 1.701672 ustep: 1 
iter: 3  value: 1805.142 mgc: 0.01631197 ustep: 1 
iter: 4  value: 1805.142 mgc: 1.202481e-05 ustep: 1 
iter: 5  mgc: 1.070991e-11 
iter: 1  mgc: 1.070991e-11 
outer mgc:  34.34913 
iter: 1  value: 1786.338 mgc: 21.02463 ustep: 1 
iter: 2  value: 1785.995 mgc: 2.043032 ustep: 1 
iter: 3  value: 1785.995 mgc: 0.03705082 ustep: 1 
iter: 4  value: 1785.995 mgc: 3.506813e-05 ustep: 1 
iter: 5  mgc: 6.571765e-11 
iter: 1  mgc: 6.571765e-11 
outer mgc:  27.41343 
iter: 1  value: 1809.711 mgc: 20.87115 ustep: 1 
iter: 2  value: 1809.439 mgc: 1.904893 ustep: 1 
iter: 3  value: 1809.439 mgc: 0.03178506 ustep: 1 
iter: 4  value: 1809.439 mgc: 9.615363e-06 ustep: 1 
iter: 5  mgc: 3.970345e-12 
iter: 1  value: 1780.965 mgc: 7.150197 ustep: 1 
iter: 2  value: 1780.958 mgc: 0.3214282 ustep: 1 
iter: 3  value: 1780.958 mgc: 0.001055274 ustep: 1 
iter: 4  value: 1780.958 mgc: 1.152518e-08 ustep: 1 
mgc: 4.615974e-12 
iter: 1  mgc: 4.615974e-12 
outer mgc:  9.323726 
iter: 1  value: 1779.239 mgc: 11.98295 ustep: 1 
iter: 2  value: 1779.081 mgc: 1.302321 ustep: 1 
iter: 3  value: 1779.081 mgc: 0.01689829 ustep: 1 
iter: 4  value: 1779.081 mgc: 2.988496e-06 ustep: 1 
iter: 5  mgc: 5.688616e-12 
iter: 1  mgc: 5.688616e-12 
outer mgc:  9.524778 
iter: 1  value: 1776.11 mgc: 15.82412 ustep: 1 
iter: 2  value: 1774.995 mgc: 3.213881 ustep: 1 
iter: 3  value: 1774.994 mgc: 0.06891759 ustep: 1 
iter: 4  value: 1774.994 mgc: 6.597934e-05 ustep: 1 
iter: 5  mgc: 6.294459e-11 
iter: 1  mgc: 6.294459e-11 
outer mgc:  4.414493 
iter: 1  value: 1773.063 mgc: 16.91731 ustep: 1 
iter: 2  value: 1771.511 mgc: 3.600082 ustep: 1 
iter: 3  value: 1771.51 mgc: 0.1113565 ustep: 1 
iter: 4  value: 1771.51 mgc: 0.000152777 ustep: 1 
iter: 5  mgc: 3.249189e-10 
iter: 1  value: 1934.942 mgc: 35.22623 ustep: 1 
iter: 2  value: 1770.616 mgc: 43.6904 ustep: 1 
iter: 3  value: 1767.283 mgc: 5.207379 ustep: 1 
iter: 4  value: 1767.276 mgc: 0.323128 ustep: 1 
iter: 5  value: 1767.276 mgc: 0.001560324 ustep: 1 
iter: 6  value: 1767.276 mgc: 3.696929e-08 ustep: 1 
mgc: 6.068035e-12 
iter: 1  mgc: 6.068035e-12 
outer mgc:  7.536414 
iter: 1  value: 1820.456 mgc: 65.31083 ustep: 1 
iter: 2  value: 1810.002 mgc: 20.63417 ustep: 1 
iter: 3  value: 1809.99 mgc: 0.4974106 ustep: 1 
iter: 4  value: 1809.99 mgc: 0.002658253 ustep: 1 
iter: 5  value: 1809.99 mgc: 7.69237e-08 ustep: 1 
mgc: 6.80167e-12 
iter: 1  value: 1765.561 mgc: 7.240202 ustep: 1 
iter: 2  value: 1765.556 mgc: 0.2280042 ustep: 1 
iter: 3  value: 1765.556 mgc: 0.0004128867 ustep: 1 
iter: 4  mgc: 1.912184e-09 
iter: 1  mgc: 1.912184e-09 
outer mgc:  6.795736 
iter: 1  value: 1764.536 mgc: 16.85971 ustep: 1 
iter: 2  value: 1764.521 mgc: 0.5629917 ustep: 1 
iter: 3  value: 1764.521 mgc: 0.002992347 ustep: 1 
iter: 4  value: 1764.521 mgc: 9.032944e-08 ustep: 1 
mgc: 5.588863e-12 
iter: 1  mgc: 5.588863e-12 
outer mgc:  7.392957 
iter: 1  value: 1764.725 mgc: 11.09296 ustep: 1 
iter: 2  value: 1764.672 mgc: 0.8308465 ustep: 1 
iter: 3  value: 1764.672 mgc: 0.002156186 ustep: 1 
iter: 4  value: 1764.672 mgc: 3.85093e-08 ustep: 1 
mgc: 4.347855e-12 
iter: 1  value: 1763.561 mgc: 3.335884 ustep: 1 
iter: 2  value: 1763.559 mgc: 0.1333916 ustep: 1 
iter: 3  value: 1763.559 mgc: 6.605089e-05 ustep: 1 
iter: 4  mgc: 7.132051e-11 
iter: 1  mgc: 7.132051e-11 
outer mgc:  2.487233 
iter: 1  value: 1763.757 mgc: 1.079366 ustep: 1 
iter: 2  value: 1763.757 mgc: 0.005480357 ustep: 1 
iter: 3  value: 1763.757 mgc: 2.129859e-07 ustep: 1 
mgc: 1.073541e-11 
iter: 1  value: 1763.383 mgc: 0.383099 ustep: 1 
iter: 2  value: 1763.383 mgc: 0.0006548595 ustep: 1 
iter: 3  mgc: 3.033172e-09 
iter: 1  mgc: 3.033172e-09 
outer mgc:  3.332279 
iter: 1  value: 1763.197 mgc: 2.054743 ustep: 1 
iter: 2  value: 1763.197 mgc: 0.03190376 ustep: 1 
iter: 3  value: 1763.197 mgc: 1.002834e-05 ustep: 1 
iter: 4  mgc: 9.019674e-12 
iter: 1  mgc: 9.019674e-12 
outer mgc:  1.374111 
iter: 1  value: 1763.052 mgc: 1.052736 ustep: 1 
iter: 2  value: 1763.052 mgc: 0.003310778 ustep: 1 
iter: 3  value: 1763.052 mgc: 1.36348e-07 ustep: 1 
mgc: 6.302292e-12 
iter: 1  mgc: 6.302292e-12 
outer mgc:  1.230281 
iter: 1  value: 1762.81 mgc: 0.5058481 ustep: 1 
iter: 2  value: 1762.81 mgc: 0.003614003 ustep: 1 
iter: 3  value: 1762.81 mgc: 8.418129e-08 ustep: 1 
mgc: 6.419754e-12 
iter: 1  mgc: 6.419754e-12 
outer mgc:  0.6825302 
iter: 1  value: 1762.697 mgc: 4.063034 ustep: 1 
iter: 2  value: 1762.696 mgc: 0.1002994 ustep: 1 
iter: 3  value: 1762.696 mgc: 7.777306e-05 ustep: 1 
iter: 4  mgc: 5.944711e-11 
iter: 1  value: 1762.742 mgc: 2.627921 ustep: 1 
iter: 2  value: 1762.742 mgc: 0.02660258 ustep: 1 
iter: 3  value: 1762.742 mgc: 6.656874e-06 ustep: 1 
iter: 4  mgc: 6.3336e-12 
iter: 1  mgc: 6.3336e-12 
outer mgc:  0.6363962 
iter: 1  value: 1762.654 mgc: 0.7145933 ustep: 1 
iter: 2  value: 1762.654 mgc: 0.003556205 ustep: 1 
iter: 3  value: 1762.654 mgc: 1.695886e-07 ustep: 1 
iter: 4  mgc: 8.390622e-12 
iter: 1  mgc: 8.390622e-12 
outer mgc:  0.5319655 
iter: 1  value: 1762.633 mgc: 0.9362342 ustep: 1 
iter: 2  value: 1762.633 mgc: 0.006919407 ustep: 1 
iter: 3  value: 1762.633 mgc: 5.469879e-07 ustep: 1 
iter: 4  mgc: 5.275336e-12 
iter: 1  mgc: 5.275336e-12 
outer mgc:  0.1615701 
iter: 1  value: 1762.596 mgc: 0.4539803 ustep: 1 
iter: 2  value: 1762.596 mgc: 0.0005709704 ustep: 1 
iter: 3  mgc: 2.70935e-09 
iter: 1  mgc: 2.70935e-09 
outer mgc:  0.0725865 
iter: 1  value: 1762.612 mgc: 0.1637245 ustep: 1 
iter: 2  value: 1762.612 mgc: 0.0003081102 ustep: 1 
iter: 3  mgc: 3.876433e-10 
iter: 1  mgc: 3.876433e-10 
outer mgc:  0.108782 
iter: 1  value: 1762.61 mgc: 0.05898293 ustep: 1 
iter: 2  value: 1762.61 mgc: 2.297159e-05 ustep: 1 
iter: 3  mgc: 8.933743e-12 
iter: 1  mgc: 8.933743e-12 
outer mgc:  0.05720864 
iter: 1  value: 1762.601 mgc: 0.08899446 ustep: 1 
iter: 2  value: 1762.601 mgc: 5.309377e-05 ustep: 1 
iter: 3  mgc: 2.045475e-11 
iter: 1  value: 1762.592 mgc: 0.1235306 ustep: 1 
iter: 2  value: 1762.592 mgc: 0.0001023668 ustep: 1 
iter: 3  mgc: 7.597567e-11 
iter: 1  mgc: 7.597567e-11 
outer mgc:  0.135165 
iter: 1  value: 1762.577 mgc: 0.04100617 ustep: 1 
iter: 2  value: 1762.577 mgc: 1.200243e-05 ustep: 1 
iter: 3  mgc: 1.277434e-11 
iter: 1  mgc: 1.277434e-11 
outer mgc:  0.173578 
iter: 1  value: 1762.552 mgc: 0.07832218 ustep: 1 
iter: 2  value: 1762.552 mgc: 3.722724e-05 ustep: 1 
iter: 3  mgc: 3.521783e-11 
iter: 1  mgc: 3.521783e-11 
outer mgc:  0.1132976 
iter: 1  value: 1762.538 mgc: 0.1057323 ustep: 1 
iter: 2  value: 1762.538 mgc: 7.442679e-05 ustep: 1 
iter: 3  mgc: 6.114542e-11 
iter: 1  mgc: 6.114542e-11 
outer mgc:  0.02125688 
iter: 1  value: 1762.53 mgc: 0.05496209 ustep: 1 
iter: 2  value: 1762.53 mgc: 2.147756e-05 ustep: 1 
iter: 3  mgc: 1.367407e-10 
iter: 1  mgc: 1.367407e-10 
outer mgc:  0.02728963 
iter: 1  value: 1762.525 mgc: 0.009643003 ustep: 1 
iter: 2  value: 1762.525 mgc: 8.838438e-07 ustep: 1 
iter: 3  mgc: 1.29571e-10 
iter: 1  mgc: 1.29571e-10 
outer mgc:  0.03430625 
iter: 1  value: 1762.521 mgc: 0.01912791 ustep: 1 
iter: 2  value: 1762.521 mgc: 2.329096e-06 ustep: 0.4367355 
iter: 3  value: 1762.521 mgc: 7.898499e-08 ustep: 0.1263996 
mgc: 1.821821e-08 
iter: 1  value: 1762.521 mgc: 1.821821e-08 ustep: 0.0692153 
mgc: 7.972461e-09 
outer mgc:  0.01864187 
iter: 1  value: 1762.518 mgc: 0.0200193 ustep: 1 
iter: 2  value: 1762.518 mgc: 2.494585e-06 ustep: 1 
iter: 3  mgc: 1.161729e-09 
iter: 1  mgc: 1.161729e-09 
outer mgc:  0.002304559 
iter: 1  value: 1762.514 mgc: 0.01487571 ustep: 1 
iter: 2  value: 1762.514 mgc: 1.390677e-06 ustep: 1 
iter: 3  mgc: 3.711925e-09 
iter: 1  mgc: 3.711925e-09 
outer mgc:  0.008941094 
iter: 1  value: 1762.51 mgc: 0.009367144 ustep: 1 
iter: 2  value: 1762.51 mgc: 4.239192e-07 ustep: 0.8994163 
iter: 3  value: 1762.51 mgc: 2.871343e-08 ustep: 0.04521831 
mgc: 2.306184e-08 
iter: 1  value: 1762.51 mgc: 2.306184e-08 ustep: 1 
mgc: 2.755437e-08 
outer mgc:  0.0113411 
iter: 1  value: 1762.503 mgc: 0.01127711 ustep: 0.989901 
iter: 2  value: 1762.503 mgc: 6.492208e-06 ustep: 0.9949382 
iter: 3  value: 1762.503 mgc: 5.950331e-07 ustep: 0.04556486 
iter: 4  value: 1762.503 mgc: 7.571499e-07 ustep: 0.00374397 
mgc: 9.033922e-07 
iter: 1  value: 1762.503 mgc: 9.033922e-07 ustep: 0.004471122 
mgc: 7.450489e-07 
outer mgc:  0.006956268 
iter: 1  value: 1762.419 mgc: 0.01377287 ustep: 1 
iter: 2  value: 1762.413 mgc: 0.0004449444 ustep: 6.997346e-05 
iter: 3  value: 1762.391 mgc: 0.0002983255 ustep: 1.010975e-09 
mgc: 0.0001564179 
iter: 1  value: 1762.391 mgc: 0.0001564179 ustep: 2.080239e-12 
mgc: 0.0001209433 
outer mgc:  0.0009714959 
iter: 1  value: -29295130 mgc: 4.807616 ustep: 1 
iter: 2  value: -180294955 mgc: 0.1905221 ustep: 0.9999 
iter: 3  value: -213849396 mgc: 0.0009270584 ustep: 0.2653346 
iter: 4  value: -314512694 mgc: 0.0001409822 ustep: 0.5151549 
iter: 5  value: -582948150 mgc: 9.974069e-06 ustep: 0.7177711 
iter: 6  value: -750720310 mgc: 3.824929e-07 ustep: 0.1107402 
iter: 7  value: -750720310 mgc: 1.691419e-07 ustep: 7.516696e-10 
mgc: 1.691419e-07 
iter: 1  value: -750720310 mgc: 1.691419e-07 ustep: 2.664569e-10 
mgc: 1.691419e-07 
outer mgc:  0.5541697 
iter: 1  value: 5.480631e+47 mgc: 0.4060149 ustep: 1 
iter: 2  value: -4.110473e+47 mgc: 0.002821434 ustep: 1 
iter: 3  value: -9.362745e+47 mgc: 2.545782e-05 ustep: 0.989901 
iter: 4  value: -9.362745e+47 mgc: 2.587403e-05 ustep: 2.452461e-09 
mgc: 3.762923e-05 
iter: 1  value: -9.819464e+47 mgc: 3.762923e-05 ustep: 2.664569e-10 
mgc: 2.587403e-05 
outer mgc:  0.319146 
iter: 1  value: -6.585091e+129 mgc: 4.155302 ustep: 0.004471122 
iter: 2  value: -6.585091e+129 mgc: 4.074328 ustep: 0.0002704762 
iter: 3  value: -8.491301e+129 mgc: 4.069456 ustep: 0.0002604799 
iter: 4  value: -8.491301e+129 mgc: 4.064769 ustep: 5.788311e-17 
mgc: 4.064769 
iter: 1  value: -8.491301e+129 mgc: 4.064769 ustep: 1.267901e-16 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  Error in iterate(par) : 
  Newton dropout because inner gradient had non-finite components.
iter: 1  value: -8.491301e+129 mgc: 4.064769 ustep: 1.267901e-16 
mgc: 4.064769 
iter: 1  value: -8.491301e+129 mgc: 4.064769 ustep: 1.267901e-16 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: -8.144717e+129 mgc: 4.064769 ustep: 0.6827823 
iter: 2  value: -8.318009e+129 mgc: 0.3862105 ustep: 1.546891e-15 
mgc: 0.3862105 
outer mgc:  0.072818 
iter: 1  value: -7.45155e+129 mgc: 4.064769 ustep: 0.8994163 
iter: 2  value: -9.184468e+129 mgc: 0.1001925 ustep: 0.04521831 
iter: 3  value: -1.005093e+130 mgc: 0.08582692 ustep: 3.64367e-06 
iter: 4  value: -1.299689e+130 mgc: 0.08582596 ustep: 1.821392e-15 
mgc: 0.08582596 
outer mgc:  0.003968923 
iter: 1  value: -8.491301e+129 mgc: 4.064769 ustep: 1.267901e-16 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: -8.491301e+129 mgc: 4.064769 ustep: 1.267901e-16 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: -8.664593e+129 mgc: 4.064769 ustep: 2.664569e-10 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: 5.198756e+128 mgc: 4.064769 ustep: 1 
iter: 2  mgc: 3.40759e-16 
outer mgc:  1.776357e-15 
iter: 1  value: -7.104966e+129 mgc: 4.064769 ustep: 6.33887e-17 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: -7.104966e+129 mgc: 4.064769 ustep: 6.33887e-17 
mgc: 4.064769 
outer mgc:  4.213006 
iter: 1  value: -7.278258e+129 mgc: 4.060706 ustep: 0.2494656 
iter: 2  value: -9.011177e+129 mgc: 1.644423 ustep: 0.4995153 
iter: 3  value: -9.704344e+129 mgc: 0.3406474 ustep: 4.337569e-15 
mgc: 0.3406474 
outer mgc:  0.06252381 
iter: 1  value: -7.45155e+129 mgc: 4.068836 ustep: 0.03522464 
iter: 2  value: -7.45155e+129 mgc: 3.502402 ustep: 0.05065226 
iter: 3  value: -7.624842e+129 mgc: 2.83288 ustep: 0.0009950636 
iter: 4  value: -8.318009e+129 mgc: 2.820436 ustep: 3.730751e-12 
mgc: 2.820436 
outer mgc:  2.500088 
iter: 1  value: -7.104966e+129 mgc: 4.064769 ustep: 1.092717e-06 
iter: 2  value: -7.104966e+129 mgc: 4.06475 ustep: 0.0001431821 
iter: 3  value: -9.531052e+129 mgc: 4.062175 ustep: 0.00151565 
iter: 4  value: -9.531052e+129 mgc: 4.035071 ustep: 7.036995e-17 
mgc: 4.035071 
outer mgc:  4.166201 
iter: 1  value: -9.184468e+129 mgc: 4.064769 ustep: 5.463041e-07 
iter: 2  value: -1.091739e+130 mgc: 4.064759 ustep: 1.900581e-16 
mgc: 4.064759 
outer mgc:  4.217207 
iter: 1  value: 1.213043e+129 mgc: 4.064769 ustep: 1 
iter: 2  mgc: 4.912911e-16 
outer mgc:  2.50576e-31 
iter: 1  value: -2.252794e+129 mgc: 4.064769 ustep: 1 
iter: 2  mgc: 4.912911e-16 
outer mgc:  2.50576e-31 
iter: 1  value: 2.079502e+129 mgc: 4.064769 ustep: 1 
iter: 2  mgc: 4.912911e-16 
outer mgc:  2.50576e-31 
iter: 1  value: 2.079502e+129 mgc: 4.064769 ustep: 1 
iter: 2  mgc: 4.912911e-16 
outer mgc:  2.50576e-31 
Warning message:
In nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) :
  NA/NaN function evaluation
[Sun Aug 15 00:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

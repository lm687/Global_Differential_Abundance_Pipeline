Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 07:24:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_80_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4443.886708 
iter  10 value 3959.424261
iter  10 value 3959.424260
final  value 3959.424260 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1881.558 mgc: 67.67788 ustep: 1 
iter: 2  value: 1837.021 mgc: 20.72746 ustep: 1 
iter: 3  value: 1836.964 mgc: 0.8408511 ustep: 1 
iter: 4  value: 1836.964 mgc: 0.002360519 ustep: 1 
iter: 5  value: 1836.964 mgc: 4.047638e-08 ustep: 1 
mgc: 3.208545e-14 
iter: 1  mgc: 3.208545e-14 
Matching hessian patterns... Done
outer mgc:  700.2738 
iter: 1  value: 1233.664 mgc: 26.37772 ustep: 1 
iter: 2  value: 1233.479 mgc: 2.163979 ustep: 1 
iter: 3  value: 1233.479 mgc: 0.01474121 ustep: 1 
iter: 4  value: 1233.479 mgc: 1.602656e-06 ustep: 1 
iter: 5  mgc: 2.78666e-14 
iter: 1  value: 816.8824 mgc: 64.17373 ustep: 1 
iter: 2  value: 795.8936 mgc: 19.48189 ustep: 1 
iter: 3  value: 795.8892 mgc: 0.2529272 ustep: 1 
iter: 4  value: 795.8892 mgc: 0.0003152328 ustep: 1 
iter: 5  mgc: 3.011517e-10 
iter: 1  mgc: 3.011517e-10 
outer mgc:  403.6995 
iter: 1  value: 819.5191 mgc: 86.89699 ustep: 1 
iter: 2  value: 671.7443 mgc: 39.79673 ustep: 1 
iter: 3  value: 670.6516 mgc: 2.308524 ustep: 1 
iter: 4  value: 670.6513 mgc: 0.0517933 ustep: 1 
iter: 5  value: 670.6513 mgc: 7.56329e-05 ustep: 1 
iter: 6  mgc: 1.291443e-10 
iter: 1  mgc: 1.291443e-10 
outer mgc:  371.7264 
iter: 1  value: 1731.011 mgc: 74.71248 ustep: 0.2494656 
iter: 2  value: 491.4458 mgc: 105.3055 ustep: 0.4995153 
iter: 3  value: 464.4477 mgc: 19.67699 ustep: 0.7067933 
iter: 4  value: 464.343 mgc: 2.159146 ustep: 0.8407259 
iter: 5  value: 464.3429 mgc: 0.0342358 ustep: 0.9169194 
iter: 6  value: 464.3429 mgc: 0.0001332331 ustep: 0.9575633 
iter: 7  value: 464.3429 mgc: 5.132337e-07 ustep: 0.9785538 
iter: 8  mgc: 1.271276e-09 
iter: 1  mgc: 1.271276e-09 
outer mgc:  211.947 
iter: 1  value: 1939.752 mgc: 89.9431 ustep: 0.4367355 
iter: 2  value: 746.4378 mgc: 99.66822 ustep: 0.6608936 
iter: 3  value: 473.911 mgc: 67.18748 ustep: 0.8129723 
iter: 4  value: 445.8582 mgc: 46.37989 ustep: 0.9016596 
iter: 5  value: 445.7968 mgc: 2.09906 ustep: 0.9495626 
iter: 6  value: 445.7968 mgc: 0.008615644 ustep: 0.9744576 
iter: 7  value: 445.7968 mgc: 4.169569e-06 ustep: 0.9871475 
iter: 8  mgc: 2.049171e-09 
iter: 1  mgc: 2.049171e-09 
outer mgc:  130.7992 
iter: 1  value: 433.2303 mgc: 27.30992 ustep: 1 
iter: 2  value: 431.9179 mgc: 5.06965 ustep: 1 
iter: 3  value: 431.9177 mgc: 0.08603398 ustep: 1 
iter: 4  value: 431.9177 mgc: 2.749766e-05 ustep: 1 
iter: 5  mgc: 2.939184e-12 
iter: 1  mgc: 2.939184e-12 
outer mgc:  187.8994 
iter: 1  value: 350.0825 mgc: 33.15334 ustep: 1 
iter: 2  value: 333.987 mgc: 10.99062 ustep: 1 
iter: 3  value: 333.9661 mgc: 0.4859193 ustep: 1 
iter: 4  value: 333.9661 mgc: 0.001588796 ustep: 1 
iter: 5  value: 333.9661 mgc: 1.736926e-08 ustep: 1 
mgc: 2.631922e-14 
iter: 1  mgc: 2.631922e-14 
outer mgc:  42.84137 
iter: 1  value: 313.3419 mgc: 9.02329 ustep: 1 
iter: 2  value: 313.3345 mgc: 0.3857911 ustep: 1 
iter: 3  value: 313.3345 mgc: 0.0003388052 ustep: 1 
iter: 4  mgc: 2.898872e-10 
iter: 1  mgc: 2.898872e-10 
outer mgc:  57.39762 
iter: 1  value: 283.7471 mgc: 42.51063 ustep: 1 
iter: 2  value: 278.7269 mgc: 9.301808 ustep: 1 
iter: 3  value: 278.7257 mgc: 0.183012 ustep: 1 
iter: 4  value: 278.7257 mgc: 7.855644e-05 ustep: 1 
iter: 5  mgc: 1.953904e-11 
iter: 1  mgc: 1.953904e-11 
outer mgc:  56.98464 
iter: 1  value: 398.7043 mgc: 50.10789 ustep: 1 
iter: 2  value: 398.5633 mgc: 1.539999 ustep: 1 
iter: 3  value: 398.5633 mgc: 0.006185073 ustep: 1 
iter: 4  value: 398.5633 mgc: 9.657332e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  value: 271.7378 mgc: 13.45495 ustep: 1 
iter: 2  value: 271.7146 mgc: 0.3769195 ustep: 1 
iter: 3  value: 271.7146 mgc: 0.000509144 ustep: 1 
iter: 4  mgc: 2.716876e-10 
iter: 1  mgc: 2.716876e-10 
outer mgc:  24.56871 
iter: 1  value: 267.4229 mgc: 5.667736 ustep: 1 
iter: 2  value: 267.4224 mgc: 0.0680034 ustep: 1 
iter: 3  value: 267.4224 mgc: 1.635855e-05 ustep: 1 
iter: 4  mgc: 7.543965e-13 
iter: 1  mgc: 7.543965e-13 
outer mgc:  15.47406 
iter: 1  value: 262.7875 mgc: 5.996761 ustep: 1 
iter: 2  value: 262.7869 mgc: 0.0816205 ustep: 1 
iter: 3  value: 262.7869 mgc: 1.541384e-05 ustep: 1 
iter: 4  mgc: 6.525891e-13 
iter: 1  mgc: 6.525891e-13 
outer mgc:  15.18426 
iter: 1  value: 258.7156 mgc: 10.94533 ustep: 1 
iter: 2  value: 258.7113 mgc: 0.1991565 ustep: 1 
iter: 3  value: 258.7113 mgc: 0.0001369952 ustep: 1 
iter: 4  mgc: 5.607301e-11 
iter: 1  mgc: 5.607301e-11 
outer mgc:  16.42713 
iter: 1  value: 248.854 mgc: 12.30672 ustep: 1 
iter: 2  value: 248.8498 mgc: 0.1853997 ustep: 1 
iter: 3  value: 248.8498 mgc: 8.954115e-05 ustep: 1 
iter: 4  mgc: 2.783129e-11 
iter: 1  value: 248.0935 mgc: 34.1639 ustep: 1 
iter: 2  value: 248.0553 mgc: 1.057378 ustep: 1 
iter: 3  value: 248.0553 mgc: 0.0005789673 ustep: 1 
iter: 4  mgc: 1.831477e-09 
iter: 1  mgc: 2.783129e-11 
outer mgc:  21.9478 
iter: 1  value: 243.9583 mgc: 25.60547 ustep: 1 
iter: 2  value: 243.9235 mgc: 0.7191662 ustep: 1 
iter: 3  value: 243.9235 mgc: 0.0008605684 ustep: 1 
iter: 4  mgc: 1.574355e-09 
iter: 1  mgc: 1.574355e-09 
outer mgc:  31.06517 
iter: 1  value: 236.947 mgc: 19.65587 ustep: 1 
iter: 2  value: 236.9188 mgc: 0.6769664 ustep: 1 
iter: 3  value: 236.9188 mgc: 0.0007890133 ustep: 1 
iter: 4  mgc: 5.553247e-10 
iter: 1  mgc: 5.553247e-10 
outer mgc:  37.05507 
iter: 1  value: 235.3091 mgc: 8.147251 ustep: 1 
iter: 2  value: 235.3083 mgc: 0.134601 ustep: 1 
iter: 3  value: 235.3083 mgc: 1.656277e-05 ustep: 1 
iter: 4  mgc: 6.76792e-13 
iter: 1  mgc: 6.76792e-13 
outer mgc:  10.60949 
iter: 1  value: 239.7851 mgc: 10.70491 ustep: 1 
iter: 2  value: 239.7797 mgc: 0.1765928 ustep: 1 
iter: 3  value: 239.7797 mgc: 0.0001142832 ustep: 1 
iter: 4  mgc: 5.145218e-11 
iter: 1  value: 234.7723 mgc: 1.890095 ustep: 1 
iter: 2  value: 234.7723 mgc: 0.008117278 ustep: 1 
iter: 3  value: 234.7723 mgc: 1.589891e-07 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  9.390664 
iter: 1  value: 233.9713 mgc: 3.283451 ustep: 1 
iter: 2  value: 233.9712 mgc: 0.005604588 ustep: 1 
iter: 3  value: 233.9712 mgc: 1.277199e-07 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  10.38412 
iter: 1  value: 233.1366 mgc: 3.53977 ustep: 1 
iter: 2  value: 233.1366 mgc: 0.00611369 ustep: 1 
iter: 3  value: 233.1366 mgc: 1.523891e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  8.354172 
iter: 1  value: 232.9467 mgc: 3.050635 ustep: 1 
iter: 2  value: 232.9467 mgc: 0.01019042 ustep: 1 
iter: 3  value: 232.9467 mgc: 1.342582e-07 ustep: 1 
mgc: 3.891332e-14 
iter: 1  mgc: 3.891332e-14 
outer mgc:  3.34337 
iter: 1  value: 232.9818 mgc: 1.476782 ustep: 1 
iter: 2  value: 232.9818 mgc: 0.002544845 ustep: 1 
iter: 3  value: 232.9818 mgc: 1.329053e-08 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  3.802098 
iter: 1  value: 232.6435 mgc: 0.7571501 ustep: 1 
iter: 2  value: 232.6435 mgc: 0.0003224514 ustep: 1 
iter: 3  mgc: 3.040519e-10 
iter: 1  value: 232.2603 mgc: 0.9060254 ustep: 1 
iter: 2  value: 232.2603 mgc: 0.0004438672 ustep: 1 
iter: 3  mgc: 5.339373e-10 
iter: 1  mgc: 5.339373e-10 
outer mgc:  1.63373 
iter: 1  value: 232.2015 mgc: 0.5282993 ustep: 1 
iter: 2  value: 232.2015 mgc: 0.0005084459 ustep: 1 
iter: 3  mgc: 4.950369e-10 
iter: 1  value: 232.2191 mgc: 0.2232644 ustep: 1 
iter: 2  value: 232.2191 mgc: 8.034019e-05 ustep: 1 
iter: 3  mgc: 6.587619e-12 
iter: 1  mgc: 6.587619e-12 
outer mgc:  1.147936 
iter: 1  value: 231.9483 mgc: 0.6553691 ustep: 1 
iter: 2  value: 231.9483 mgc: 0.0005516294 ustep: 1 
iter: 3  mgc: 4.759739e-10 
iter: 1  mgc: 4.759739e-10 
outer mgc:  0.4583401 
iter: 1  value: 231.9476 mgc: 0.1772882 ustep: 1 
iter: 2  value: 231.9476 mgc: 8.848746e-05 ustep: 1 
iter: 3  mgc: 7.118395e-11 
iter: 1  mgc: 7.118395e-11 
outer mgc:  0.1903207 
iter: 1  value: 231.8567 mgc: 0.1787821 ustep: 1 
iter: 2  value: 231.8567 mgc: 3.520852e-05 ustep: 1 
iter: 3  mgc: 1.119105e-12 
iter: 1  value: 231.9237 mgc: 0.05376703 ustep: 1 
iter: 2  value: 231.9237 mgc: 3.186944e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.07086483 
iter: 1  value: 231.9198 mgc: 0.02408782 ustep: 1 
iter: 2  value: 231.9198 mgc: 4.462922e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
iter: 1  value: 231.922 mgc: 0.01065321 ustep: 1 
iter: 2  value: 231.922 mgc: 8.735027e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.02990423 
iter: 1  value: 231.9222 mgc: 0.008681112 ustep: 1 
iter: 2  value: 231.9222 mgc: 1.085254e-07 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.008561222 
iter: 1  value: 231.9206 mgc: 0.00455777 ustep: 1 
iter: 2  value: 231.9206 mgc: 1.16224e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.001652071 
iter: 1  value: 231.9208 mgc: 0.0004821683 ustep: 1 
iter: 2  mgc: 2.066658e-10 
iter: 1  mgc: 2.066658e-10 
outer mgc:  0.0002770257 
iter: 1  mgc: 2.066658e-10 
iter: 1  mgc: 2.066658e-10 
outer mgc:  0.0002770257 
iter: 1  value: 231.921 mgc: 0.04676012 ustep: 1 
iter: 2  value: 231.921 mgc: 2.361699e-06 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.4418866 
iter: 1  value: 231.9211 mgc: 0.04674054 ustep: 1 
iter: 2  value: 231.9211 mgc: 2.363417e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.442234 
iter: 1  value: 231.9213 mgc: 0.02753668 ustep: 1 
iter: 2  value: 231.9213 mgc: 6.686917e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.3491325 
iter: 1  value: 231.9207 mgc: 0.02753161 ustep: 1 
iter: 2  value: 231.9207 mgc: 6.693435e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.349527 
iter: 1  value: 231.9212 mgc: 0.05731442 ustep: 1 
iter: 2  value: 231.9212 mgc: 2.304492e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.36079 
iter: 1  value: 231.9208 mgc: 0.05731001 ustep: 1 
iter: 2  value: 231.9208 mgc: 2.308746e-06 ustep: 1 
iter: 3  mgc: 1.926237e-14 
outer mgc:  0.3602717 
iter: 1  value: 231.9218 mgc: 0.02870379 ustep: 1 
iter: 2  value: 231.9218 mgc: 6.274953e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.3521474 
iter: 1  value: 231.9201 mgc: 0.02870771 ustep: 1 
iter: 2  value: 231.9201 mgc: 6.286676e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.3516063 
iter: 1  value: 231.9167 mgc: 0.008020124 ustep: 1 
iter: 2  value: 231.9167 mgc: 3.258295e-08 ustep: 1 
mgc: 2.708944e-14 
outer mgc:  0.00211325 
iter: 1  value: 231.9249 mgc: 0.008016654 ustep: 1 
iter: 2  value: 231.9249 mgc: 3.260233e-08 ustep: 1 
mgc: 1.953993e-14 
outer mgc:  0.002289561 
iter: 1  value: 231.9308 mgc: 0.04090163 ustep: 1 
iter: 2  value: 231.9308 mgc: 1.645792e-06 ustep: 1 
iter: 3  mgc: 2.919887e-14 
outer mgc:  0.0486423 
iter: 1  value: 231.9108 mgc: 0.04101487 ustep: 1 
iter: 2  value: 231.9108 mgc: 1.647877e-06 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.04858338 
iter: 1  value: 231.9255 mgc: 0.03130505 ustep: 1 
iter: 2  value: 231.9255 mgc: 5.242728e-07 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.06126117 
iter: 1  value: 231.9161 mgc: 0.03134879 ustep: 1 
iter: 2  value: 231.9161 mgc: 5.231297e-07 ustep: 1 
iter: 3  mgc: 2.087219e-14 
outer mgc:  0.06111042 
[Sat Aug 14 07:24:50 2021]
Finished job 0.
1 of 1 steps (100%) done

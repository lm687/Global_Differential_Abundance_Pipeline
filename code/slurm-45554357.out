Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 12:17:38 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_50_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11082.800768 
iter  10 value 7807.967090
final  value 7802.195258 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6746.752 mgc: 68.24668 ustep: 1 
iter: 2  value: 6697.704 mgc: 22.19767 ustep: 1 
iter: 3  value: 6694.103 mgc: 4.381324 ustep: 1 
iter: 4  value: 6693.427 mgc: 1.439902 ustep: 1 
iter: 5  value: 6693.362 mgc: 0.3471621 ustep: 1 
iter: 6  value: 6693.361 mgc: 0.03881526 ustep: 1 
iter: 7  value: 6693.361 mgc: 0.0006470426 ustep: 1 
iter: 8  value: 6693.361 mgc: 1.874006e-07 ustep: 1 
iter: 9  mgc: 3.869127e-14 
iter: 1  mgc: 3.869127e-14 
Matching hessian patterns... Done
outer mgc:  1527.053 
iter: 1  value: 5360.736 mgc: 29.36884 ustep: 1 
iter: 2  value: 5335.2 mgc: 7.448845 ustep: 1 
iter: 3  value: 5335.09 mgc: 0.588776 ustep: 1 
iter: 4  value: 5335.09 mgc: 0.00773547 ustep: 1 
iter: 5  value: 5335.09 mgc: 4.072648e-06 ustep: 1 
iter: 6  mgc: 1.166012e-12 
iter: 1  value: 4819.411 mgc: 62.16124 ustep: 0.4367355 
iter: 2  value: 3257.935 mgc: 63.95125 ustep: 0.6608936 
iter: 3  value: 3215.163 mgc: 14.97096 ustep: 0.8129723 
iter: 4  value: 3214.665 mgc: 0.8778793 ustep: 0.9016596 
iter: 5  value: 3214.664 mgc: 0.03226332 ustep: 0.9495626 
iter: 6  value: 3214.664 mgc: 0.001836248 ustep: 0.9744576 
iter: 7  value: 3214.664 mgc: 9.980383e-05 ustep: 0.9871475 
iter: 8  value: 3214.664 mgc: 2.89893e-06 ustep: 0.9935536 
iter: 9  value: 3214.664 mgc: 4.295592e-08 ustep: 0.9967719 
iter: 10  mgc: 3.204047e-10 
iter: 1  mgc: 3.204047e-10 
outer mgc:  668.661 
iter: 1  value: 1363.414 mgc: 68.43141 ustep: 1 
iter: 2  value: 1299.661 mgc: 39.79077 ustep: 1 
iter: 3  value: 1297.096 mgc: 6.196578 ustep: 1 
iter: 4  value: 1297.068 mgc: 0.5465513 ustep: 1 
iter: 5  value: 1297.068 mgc: 0.009799948 ustep: 1 
iter: 6  value: 1297.068 mgc: 4.137805e-06 ustep: 1 
iter: 7  mgc: 7.334133e-13 
iter: 1  mgc: 7.334133e-13 
outer mgc:  307.7417 
iter: 1  value: 1778.367 mgc: 35.73529 ustep: 1 
iter: 2  value: 1756.887 mgc: 10.46914 ustep: 1 
iter: 3  value: 1756.81 mgc: 0.8199023 ustep: 1 
iter: 4  value: 1756.81 mgc: 0.01182907 ustep: 1 
iter: 5  value: 1756.81 mgc: 2.547244e-06 ustep: 1 
iter: 6  mgc: 1.065814e-13 
iter: 1  value: 1131.312 mgc: 23.33401 ustep: 1 
iter: 2  value: 1130.961 mgc: 1.75808 ustep: 1 
iter: 3  value: 1130.961 mgc: 0.01236697 ustep: 1 
iter: 4  value: 1130.961 mgc: 1.524549e-06 ustep: 1 
iter: 5  mgc: 3.708145e-14 
iter: 1  mgc: 3.708145e-14 
outer mgc:  280.3263 
iter: 1  value: 1071.464 mgc: 61.09946 ustep: 1 
iter: 2  value: 1053.36 mgc: 15.09951 ustep: 1 
iter: 3  value: 1053.348 mgc: 0.224535 ustep: 1 
iter: 4  value: 1053.348 mgc: 0.003211002 ustep: 1 
iter: 5  value: 1053.348 mgc: 7.76684e-07 ustep: 1 
iter: 6  mgc: 5.095924e-14 
iter: 1  mgc: 5.095924e-14 
outer mgc:  157.6533 
iter: 1  value: 978.5386 mgc: 32.8337 ustep: 1 
iter: 2  value: 969.5434 mgc: 5.783169 ustep: 1 
iter: 3  value: 969.5035 mgc: 0.2300914 ustep: 1 
iter: 4  value: 969.5033 mgc: 0.01568999 ustep: 1 
iter: 5  value: 969.5033 mgc: 0.0001025286 ustep: 1 
iter: 6  mgc: 4.426264e-09 
iter: 1  mgc: 4.426264e-09 
outer mgc:  58.40499 
iter: 1  value: 958.649 mgc: 8.873992 ustep: 1 
iter: 2  value: 958.2777 mgc: 1.355917 ustep: 1 
iter: 3  value: 958.2728 mgc: 0.1404892 ustep: 1 
iter: 4  value: 958.2728 mgc: 0.00212522 ustep: 1 
iter: 5  value: 958.2728 mgc: 4.977286e-07 ustep: 1 
iter: 6  mgc: 5.417888e-14 
iter: 1  mgc: 5.417888e-14 
outer mgc:  169.897 
iter: 1  value: 1108.801 mgc: 72.20403 ustep: 1 
iter: 2  value: 1050.706 mgc: 26.30502 ustep: 1 
iter: 3  value: 1050.672 mgc: 0.8091301 ustep: 1 
iter: 4  value: 1050.672 mgc: 0.002908395 ustep: 1 
iter: 5  value: 1050.672 mgc: 1.489872e-07 ustep: 1 
iter: 6  mgc: 3.774758e-14 
iter: 1  value: 898.2646 mgc: 25.65722 ustep: 1 
iter: 2  value: 897.9047 mgc: 1.220392 ustep: 1 
iter: 3  value: 897.9047 mgc: 0.01104789 ustep: 1 
iter: 4  value: 897.9047 mgc: 1.202813e-06 ustep: 1 
iter: 5  mgc: 3.352874e-14 
iter: 1  mgc: 3.352874e-14 
outer mgc:  40.07073 
iter: 1  value: 899.9266 mgc: 13.86578 ustep: 1 
iter: 2  value: 899.892 mgc: 0.2974535 ustep: 1 
iter: 3  value: 899.892 mgc: 0.0005084423 ustep: 1 
iter: 4  mgc: 3.058225e-09 
iter: 1  value: 894.7523 mgc: 4.809588 ustep: 1 
iter: 2  value: 894.7521 mgc: 0.0300437 ustep: 1 
iter: 3  value: 894.7521 mgc: 4.957656e-06 ustep: 1 
iter: 4  mgc: 4.90552e-13 
iter: 1  mgc: 4.90552e-13 
outer mgc:  15.04352 
iter: 1  value: 891.7529 mgc: 3.636323 ustep: 1 
iter: 2  value: 891.7481 mgc: 0.1155574 ustep: 1 
iter: 3  value: 891.7481 mgc: 0.0001846494 ustep: 1 
iter: 4  mgc: 4.80878e-10 
iter: 1  mgc: 4.80878e-10 
outer mgc:  12.01245 
iter: 1  value: 892.8034 mgc: 3.865205 ustep: 1 
iter: 2  value: 892.8028 mgc: 0.0544767 ustep: 1 
iter: 3  value: 892.8028 mgc: 1.254208e-05 ustep: 1 
iter: 4  mgc: 8.227752e-12 
iter: 1  value: 892.4281 mgc: 2.405908 ustep: 1 
iter: 2  value: 892.428 mgc: 0.02032496 ustep: 1 
iter: 3  value: 892.428 mgc: 1.525739e-06 ustep: 1 
iter: 4  mgc: 3.68594e-14 
iter: 1  value: 891.8519 mgc: 1.209605 ustep: 1 
iter: 2  value: 891.8519 mgc: 0.004462679 ustep: 1 
iter: 3  value: 891.8519 mgc: 7.620113e-08 ustep: 1 
mgc: 2.875478e-14 
iter: 1  mgc: 2.875478e-14 
outer mgc:  7.152773 
iter: 1  value: 891.5703 mgc: 1.666774 ustep: 1 
iter: 2  value: 891.5703 mgc: 0.009631711 ustep: 1 
iter: 3  value: 891.5703 mgc: 7.31852e-07 ustep: 1 
iter: 4  mgc: 5.329071e-14 
iter: 1  mgc: 5.329071e-14 
outer mgc:  3.494979 
iter: 1  value: 891.5886 mgc: 0.7689931 ustep: 1 
iter: 2  value: 891.5886 mgc: 0.001872154 ustep: 1 
iter: 3  value: 891.5886 mgc: 5.339647e-08 ustep: 1 
iter: 4  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  2.666355 
iter: 1  value: 891.4112 mgc: 0.8655021 ustep: 1 
iter: 2  value: 891.4112 mgc: 0.002858515 ustep: 1 
iter: 3  value: 891.4112 mgc: 7.357908e-08 ustep: 1 
mgc: 3.841372e-14 
iter: 1  mgc: 3.841372e-14 
outer mgc:  4.195957 
iter: 1  value: 891.5007 mgc: 0.5318372 ustep: 1 
iter: 2  value: 891.5007 mgc: 0.0006195536 ustep: 1 
iter: 3  mgc: 1.205645e-09 
iter: 1  value: 891.4719 mgc: 0.5496459 ustep: 1 
iter: 2  value: 891.4719 mgc: 0.0009410759 ustep: 1 
iter: 3  mgc: 3.111553e-09 
iter: 1  mgc: 3.111553e-09 
outer mgc:  3.571544 
iter: 1  value: 891.4024 mgc: 0.2604455 ustep: 1 
iter: 2  value: 891.4024 mgc: 0.0002158447 ustep: 1 
iter: 3  mgc: 3.641902e-09 
iter: 1  mgc: 3.641902e-09 
outer mgc:  1.529013 
iter: 1  value: 891.3805 mgc: 0.1869234 ustep: 1 
iter: 2  value: 891.3805 mgc: 0.0001237648 ustep: 1 
iter: 3  mgc: 1.360831e-10 
iter: 1  mgc: 1.360831e-10 
outer mgc:  2.511125 
iter: 1  value: 891.2576 mgc: 0.6664043 ustep: 1 
iter: 2  value: 891.2576 mgc: 0.001898424 ustep: 1 
iter: 3  value: 891.2576 mgc: 5.041269e-08 ustep: 1 
mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  2.807812 
iter: 1  value: 891.3144 mgc: 0.6205416 ustep: 1 
iter: 2  value: 891.3144 mgc: 0.001400415 ustep: 1 
iter: 3  value: 891.3144 mgc: 9.774864e-08 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.076063 
iter: 1  value: 891.506 mgc: 1.413184 ustep: 1 
iter: 2  value: 891.506 mgc: 0.003232401 ustep: 1 
iter: 3  value: 891.506 mgc: 5.240915e-08 ustep: 1 
iter: 4  mgc: 5.084821e-14 
iter: 1  value: 891.2864 mgc: 0.47101 ustep: 1 
iter: 2  value: 891.2864 mgc: 0.0006023613 ustep: 1 
iter: 3  mgc: 1.781513e-09 
iter: 1  mgc: 1.781513e-09 
outer mgc:  1.144659 
iter: 1  value: 891.3156 mgc: 0.2612536 ustep: 1 
iter: 2  value: 891.3156 mgc: 0.0002095887 ustep: 1 
iter: 3  mgc: 2.254823e-10 
iter: 1  mgc: 2.254823e-10 
outer mgc:  2.00544 
iter: 1  value: 891.2689 mgc: 0.1723364 ustep: 1 
iter: 2  value: 891.2689 mgc: 0.0001021122 ustep: 1 
iter: 3  mgc: 4.779555e-11 
iter: 1  mgc: 4.779555e-11 
outer mgc:  0.3041485 
iter: 1  value: 891.2943 mgc: 0.04353319 ustep: 1 
iter: 2  value: 891.2943 mgc: 2.671142e-05 ustep: 1 
iter: 3  mgc: 7.972023e-11 
iter: 1  mgc: 7.972023e-11 
outer mgc:  0.3452701 
iter: 1  value: 891.2798 mgc: 0.03170419 ustep: 1 
iter: 2  value: 891.2798 mgc: 9.84871e-06 ustep: 1 
iter: 3  mgc: 9.379164e-13 
iter: 1  mgc: 9.379164e-13 
outer mgc:  0.1484633 
iter: 1  value: 891.2822 mgc: 0.1190407 ustep: 1 
iter: 2  value: 891.2822 mgc: 3.534733e-05 ustep: 1 
iter: 3  mgc: 6.03706e-12 
iter: 1  value: 891.2798 mgc: 0.04753521 ustep: 1 
iter: 2  value: 891.2798 mgc: 5.136383e-06 ustep: 1 
iter: 3  mgc: 1.179057e-13 
iter: 1  mgc: 1.179057e-13 
outer mgc:  0.2758389 
iter: 1  value: 891.2856 mgc: 0.03351663 ustep: 1 
iter: 2  value: 891.2856 mgc: 2.432637e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  0.112773 
iter: 1  value: 891.2839 mgc: 0.021463 ustep: 1 
iter: 2  value: 891.2839 mgc: 1.727531e-06 ustep: 1 
iter: 3  mgc: 1.322276e-13 
iter: 1  mgc: 1.322276e-13 
outer mgc:  0.1144752 
iter: 1  value: 891.2832 mgc: 0.02523551 ustep: 1 
iter: 2  value: 891.2832 mgc: 3.981172e-06 ustep: 1 
iter: 3  mgc: 2.202682e-13 
iter: 1  value: 891.2797 mgc: 0.01575868 ustep: 1 
iter: 2  value: 891.2797 mgc: 2.964488e-06 ustep: 1 
iter: 3  mgc: 1.74305e-13 
iter: 1  mgc: 1.74305e-13 
outer mgc:  0.09430871 
iter: 1  value: 891.2835 mgc: 0.03400145 ustep: 1 
iter: 2  value: 891.2835 mgc: 7.446313e-06 ustep: 1 
iter: 3  mgc: 7.438494e-13 
iter: 1  mgc: 7.438494e-13 
outer mgc:  0.1032356 
iter: 1  value: 891.2901 mgc: 0.008395257 ustep: 1 
iter: 2  value: 891.2901 mgc: 4.315458e-06 ustep: 1 
iter: 3  mgc: 2.178702e-12 
iter: 1  value: 891.2871 mgc: 0.005901186 ustep: 1 
iter: 2  value: 891.2871 mgc: 5.807204e-07 ustep: 1 
iter: 3  mgc: 3.7359e-14 
iter: 1  mgc: 3.7359e-14 
outer mgc:  0.06201135 
iter: 1  value: 891.2868 mgc: 0.005740245 ustep: 1 
iter: 2  value: 891.2868 mgc: 3.376056e-07 ustep: 1 
iter: 3  mgc: 3.524958e-14 
iter: 1  mgc: 3.524958e-14 
outer mgc:  0.01083452 
iter: 1  value: 891.2854 mgc: 0.009045144 ustep: 1 
iter: 2  value: 891.2854 mgc: 2.434696e-07 ustep: 1 
iter: 3  mgc: 4.440892e-14 
iter: 1  value: 891.2866 mgc: 0.004575567 ustep: 1 
iter: 2  value: 891.2866 mgc: 4.593097e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  0.006647974 
iter: 1  value: 891.286 mgc: 0.001799407 ustep: 1 
iter: 2  mgc: 8.439839e-09 
iter: 1  mgc: 8.439839e-09 
outer mgc:  0.00439363 
iter: 1  value: 891.2862 mgc: 0.0008105281 ustep: 1 
iter: 2  mgc: 2.076068e-09 
iter: 1  mgc: 2.076068e-09 
outer mgc:  0.0009319502 
iter: 1  mgc: 2.076068e-09 
iter: 1  mgc: 2.076068e-09 
outer mgc:  0.0009319502 
iter: 1  value: 891.2869 mgc: 0.0354666 ustep: 1 
iter: 2  value: 891.2869 mgc: 2.635307e-06 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.1376287 
iter: 1  value: 891.2856 mgc: 0.03546714 ustep: 1 
iter: 2  value: 891.2856 mgc: 2.632777e-06 ustep: 1 
iter: 3  mgc: 4.002354e-14 
outer mgc:  0.1360428 
iter: 1  value: 891.293 mgc: 0.02572964 ustep: 1 
iter: 2  value: 891.293 mgc: 1.869319e-06 ustep: 1 
iter: 3  mgc: 3.219647e-14 
outer mgc:  0.3389142 
iter: 1  value: 891.2798 mgc: 0.02574085 ustep: 1 
iter: 2  value: 891.2798 mgc: 1.866575e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.3371618 
iter: 1  value: 891.2861 mgc: 0.04936052 ustep: 1 
iter: 2  value: 891.2861 mgc: 7.849509e-06 ustep: 1 
iter: 3  mgc: 4.591882e-13 
outer mgc:  0.1533865 
iter: 1  value: 891.2865 mgc: 0.04934823 ustep: 1 
iter: 2  value: 891.2865 mgc: 7.859922e-06 ustep: 1 
iter: 3  mgc: 4.636291e-13 
outer mgc:  0.1548721 
iter: 1  value: 891.2816 mgc: 0.02361455 ustep: 1 
iter: 2  value: 891.2816 mgc: 1.920551e-06 ustep: 1 
iter: 3  mgc: 3.430589e-14 
outer mgc:  0.3308989 
iter: 1  value: 891.2912 mgc: 0.02360259 ustep: 1 
iter: 2  value: 891.2912 mgc: 1.921896e-06 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.332454 
iter: 1  value: 891.2835 mgc: 0.004950834 ustep: 1 
iter: 2  value: 891.2835 mgc: 2.3436e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.02180008 
iter: 1  value: 891.2889 mgc: 0.004947475 ustep: 1 
iter: 2  value: 891.2889 mgc: 2.341841e-07 ustep: 1 
iter: 3  mgc: 4.92939e-14 
outer mgc:  0.02199308 
iter: 1  value: 891.291 mgc: 0.01227566 ustep: 1 
iter: 2  value: 891.291 mgc: 8.633043e-07 ustep: 1 
iter: 3  mgc: 7.149836e-14 
outer mgc:  0.1626001 
iter: 1  value: 891.2815 mgc: 0.01230725 ustep: 1 
iter: 2  value: 891.2815 mgc: 8.723509e-07 ustep: 1 
iter: 3  mgc: 9.692247e-14 
outer mgc:  0.1634457 
iter: 1  value: 891.2913 mgc: 0.01074847 ustep: 1 
iter: 2  value: 891.2913 mgc: 1.736808e-06 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  0.1619971 
iter: 1  value: 891.2813 mgc: 0.01077539 ustep: 1 
iter: 2  value: 891.2813 mgc: 1.743789e-06 ustep: 1 
iter: 3  mgc: 4.909961e-14 
outer mgc:  0.1615805 
[Sat Aug 14 12:17:40 2021]
Finished job 0.
1 of 1 steps (100%) done

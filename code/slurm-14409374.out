Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:43:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.005_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.005_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.005_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4370.279684 
final  value 4097.953630 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5864.726 mgc: 76.8206 ustep: 0.6827823 
iter: 2  value: 4647.049 mgc: 62.92527 ustep: 0.06195147 
iter: 3  value: 4283.241 mgc: 69.79152 ustep: 0.08403402 
iter: 4  value: 4198.86 mgc: 19.74838 ustep: 0.1573439 
iter: 5  value: 4194.918 mgc: 9.446687 ustep: 0.3967263 
iter: 6  value: 4194.846 mgc: 1.583254 ustep: 0.6298992 
iter: 7  value: 4194.846 mgc: 0.09363389 ustep: 0.7936825 
iter: 8  value: 4194.846 mgc: 0.001540865 ustep: 0.8908995 
iter: 9  value: 4194.846 mgc: 1.081793e-05 ustep: 0.9438803 
iter: 10  value: 4194.846 mgc: 9.341617e-08 ustep: 0.9715379 
iter: 11  mgc: 4.40894e-10 
iter: 1  mgc: 4.40894e-10 
Matching hessian patterns... Done
outer mgc:  363.5321 
iter: 1  value: 3879.019 mgc: 33.20179 ustep: 1 
iter: 2  value: 3873.365 mgc: 6.756786 ustep: 1 
iter: 3  value: 3873.355 mgc: 0.4215056 ustep: 1 
iter: 4  value: 3873.355 mgc: 0.002677637 ustep: 1 
iter: 5  value: 3873.355 mgc: 1.103476e-07 ustep: 1 
mgc: 4.698852e-12 
iter: 1  mgc: 4.698852e-12 
outer mgc:  157.287 
iter: 1  value: 3797.568 mgc: 10.70357 ustep: 1 
iter: 2  value: 3797.517 mgc: 0.637744 ustep: 1 
iter: 3  value: 3797.517 mgc: 0.004464927 ustep: 1 
iter: 4  value: 3797.517 mgc: 7.599578e-07 ustep: 1 
iter: 5  mgc: 7.048973e-12 
iter: 1  mgc: 7.048973e-12 
outer mgc:  20.13386 
iter: 1  value: 3822.922 mgc: 20.19079 ustep: 1 
iter: 2  value: 3822.216 mgc: 3.186507 ustep: 1 
iter: 3  value: 3822.216 mgc: 0.04997147 ustep: 1 
iter: 4  value: 3822.216 mgc: 2.724537e-05 ustep: 1 
iter: 5  mgc: 1.854739e-11 
iter: 1  value: 3795.54 mgc: 5.66319 ustep: 1 
iter: 2  value: 3795.537 mgc: 0.188221 ustep: 1 
iter: 3  value: 3795.537 mgc: 0.0002486086 ustep: 1 
iter: 4  mgc: 1.34451e-09 
iter: 1  mgc: 1.34451e-09 
outer mgc:  13.56503 
iter: 1  value: 3793.909 mgc: 9.643314 ustep: 1 
iter: 2  value: 3793.877 mgc: 0.5317954 ustep: 1 
iter: 3  value: 3793.877 mgc: 0.003800999 ustep: 1 
iter: 4  value: 3793.877 mgc: 2.620608e-07 ustep: 1 
iter: 5  mgc: 8.222586e-12 
iter: 1  mgc: 8.222586e-12 
outer mgc:  16.40193 
iter: 1  value: 3791.221 mgc: 3.813009 ustep: 1 
iter: 2  value: 3791.221 mgc: 0.04226462 ustep: 1 
iter: 3  value: 3791.221 mgc: 2.445155e-05 ustep: 1 
iter: 4  mgc: 1.000577e-11 
iter: 1  mgc: 1.000577e-11 
outer mgc:  6.177575 
iter: 1  value: 3788.456 mgc: 15.23829 ustep: 1 
iter: 2  value: 3788.204 mgc: 1.411934 ustep: 1 
iter: 3  value: 3788.204 mgc: 0.02391254 ustep: 1 
iter: 4  value: 3788.204 mgc: 9.746129e-06 ustep: 1 
iter: 5  mgc: 9.194756e-12 
iter: 1  mgc: 9.194756e-12 
outer mgc:  17.09783 
iter: 1  value: 3783.449 mgc: 15.84737 ustep: 1 
iter: 2  value: 3783.228 mgc: 1.306079 ustep: 1 
iter: 3  value: 3783.228 mgc: 0.02143863 ustep: 1 
iter: 4  value: 3783.228 mgc: 7.338386e-06 ustep: 1 
iter: 5  mgc: 7.052137e-12 
iter: 1  mgc: 7.052137e-12 
outer mgc:  8.533606 
iter: 1  value: 3792.175 mgc: 24.95294 ustep: 1 
iter: 2  value: 3789.565 mgc: 3.742264 ustep: 1 
iter: 3  value: 3789.563 mgc: 0.10943 ustep: 1 
iter: 4  value: 3789.563 mgc: 0.0001985095 ustep: 1 
iter: 5  mgc: 7.773424e-10 
iter: 1  value: 3784.555 mgc: 6.039663 ustep: 1 
iter: 2  value: 3784.551 mgc: 0.155188 ustep: 1 
iter: 3  value: 3784.551 mgc: 0.0001850403 ustep: 1 
iter: 4  mgc: 5.737584e-10 
iter: 1  value: 3783.026 mgc: 1.754038 ustep: 1 
iter: 2  value: 3783.026 mgc: 0.01212915 ustep: 1 
iter: 3  value: 3783.026 mgc: 1.257734e-06 ustep: 1 
iter: 4  mgc: 5.454193e-12 
iter: 1  mgc: 5.454193e-12 
outer mgc:  3.697649 
iter: 1  value: 3782.964 mgc: 1.234623 ustep: 1 
iter: 2  value: 3782.964 mgc: 0.008443355 ustep: 1 
iter: 3  value: 3782.964 mgc: 1.03841e-06 ustep: 1 
iter: 4  mgc: 5.514089e-12 
iter: 1  mgc: 5.514089e-12 
outer mgc:  5.106457 
iter: 1  value: 3782.908 mgc: 1.014367 ustep: 1 
iter: 2  value: 3782.908 mgc: 0.00394106 ustep: 1 
iter: 3  value: 3782.908 mgc: 1.440775e-07 ustep: 1 
mgc: 3.626432e-12 
iter: 1  mgc: 3.626432e-12 
outer mgc:  0.852152 
iter: 1  value: 3782.868 mgc: 0.3834482 ustep: 1 
iter: 2  value: 3782.868 mgc: 0.0005306014 ustep: 1 
iter: 3  mgc: 4.025216e-09 
iter: 1  value: 3782.796 mgc: 1.150223 ustep: 1 
iter: 2  value: 3782.796 mgc: 0.004805568 ustep: 1 
iter: 3  value: 3782.796 mgc: 3.299413e-07 ustep: 1 
iter: 4  mgc: 3.18473e-12 
iter: 1  mgc: 3.18473e-12 
outer mgc:  2.87854 
iter: 1  value: 3782.516 mgc: 1.737896 ustep: 1 
iter: 2  value: 3782.516 mgc: 0.01032336 ustep: 1 
iter: 3  value: 3782.516 mgc: 1.148601e-06 ustep: 1 
iter: 4  mgc: 3.803069e-12 
iter: 1  value: 3781.984 mgc: 6.578263 ustep: 1 
iter: 2  value: 3781.98 mgc: 0.1340008 ustep: 1 
iter: 3  value: 3781.98 mgc: 0.0001916845 ustep: 1 
iter: 4  mgc: 4.91963e-10 
iter: 1  value: 3781.566 mgc: 9.891539 ustep: 1 
iter: 2  value: 3781.549 mgc: 0.2926361 ustep: 1 
iter: 3  value: 3781.549 mgc: 0.0008984139 ustep: 1 
iter: 4  value: 3781.549 mgc: 1.138868e-08 ustep: 1 
mgc: 1.037226e-12 
iter: 1  mgc: 1.037226e-12 
outer mgc:  12.15162 
iter: 1  value: 3776.744 mgc: 10.25533 ustep: 1 
iter: 2  value: 3776.724 mgc: 0.3501106 ustep: 1 
iter: 3  value: 3776.724 mgc: 0.001037484 ustep: 1 
iter: 4  value: 3776.724 mgc: 1.389187e-08 ustep: 1 
mgc: 2.748912e-13 
iter: 1  value: 3776.425 mgc: 11.88965 ustep: 1 
iter: 2  value: 3775.53 mgc: 1.950566 ustep: 1 
iter: 3  value: 3775.529 mgc: 0.05094434 ustep: 1 
iter: 4  value: 3775.529 mgc: 4.43018e-05 ustep: 1 
iter: 5  mgc: 4.039052e-11 
iter: 1  mgc: 4.039052e-11 
outer mgc:  61.61937 
iter: 1  value: 3969.945 mgc: 24.28231 ustep: 1 
iter: 2  value: 3969.941 mgc: 0.2616321 ustep: 1 
iter: 3  value: 3969.941 mgc: 2.100675e-05 ustep: 1 
iter: 4  mgc: 3.109735e-13 
iter: 1  value: 3756.436 mgc: 3.609172 ustep: 1 
iter: 2  value: 3756.422 mgc: 0.1754384 ustep: 1 
iter: 3  value: 3756.422 mgc: 0.0002208918 ustep: 1 
iter: 4  mgc: 1.169087e-09 
iter: 1  mgc: 1.169087e-09 
outer mgc:  36.20227 
iter: 1  value: 3741.706 mgc: 2.991608 ustep: 1 
iter: 2  value: 3741.654 mgc: 0.3004169 ustep: 1 
iter: 3  value: 3741.654 mgc: 0.002246327 ustep: 1 
iter: 4  value: 3741.654 mgc: 1.323902e-07 ustep: 1 
iter: 5  mgc: 3.774758e-15 
iter: 1  mgc: 3.774758e-15 
outer mgc:  12.51077 
iter: 1  value: 3736.669 mgc: 1.973361 ustep: 1 
iter: 2  value: 3736.668 mgc: 0.04651239 ustep: 1 
iter: 3  value: 3736.668 mgc: 5.396452e-05 ustep: 1 
iter: 4  mgc: 5.800516e-11 
iter: 1  mgc: 5.800516e-11 
outer mgc:  9.766346 
iter: 1  value: 3739.392 mgc: 2.308678 ustep: 1 
iter: 2  value: 3739.381 mgc: 0.1326387 ustep: 1 
iter: 3  value: 3739.381 mgc: 0.0004031553 ustep: 1 
iter: 4  mgc: 2.650127e-09 
iter: 1  value: 3734.894 mgc: 1.023544 ustep: 1 
iter: 2  value: 3734.893 mgc: 0.0134079 ustep: 1 
iter: 3  value: 3734.893 mgc: 3.264453e-06 ustep: 1 
iter: 4  mgc: 2.002842e-13 
iter: 1  mgc: 2.002842e-13 
outer mgc:  5.817649 
iter: 1  value: 3734.296 mgc: 1.435548 ustep: 1 
iter: 2  value: 3734.296 mgc: 0.03655992 ustep: 1 
iter: 3  value: 3734.296 mgc: 3.552651e-05 ustep: 1 
iter: 4  mgc: 3.910294e-11 
iter: 1  mgc: 3.910294e-11 
outer mgc:  1.435717 
iter: 1  value: 3734.355 mgc: 0.8263706 ustep: 1 
iter: 2  value: 3734.355 mgc: 0.007917021 ustep: 1 
iter: 3  value: 3734.355 mgc: 1.881551e-06 ustep: 1 
iter: 4  mgc: 1.14575e-13 
iter: 1  value: 3734.322 mgc: 0.2532095 ustep: 1 
iter: 2  value: 3734.322 mgc: 0.001588918 ustep: 1 
iter: 3  value: 3734.322 mgc: 6.141542e-08 ustep: 1 
mgc: 4.940492e-15 
iter: 1  mgc: 4.940492e-15 
outer mgc:  0.6450128 
iter: 1  value: 3735.016 mgc: 0.2083262 ustep: 1 
iter: 2  value: 3735.016 mgc: 0.001551031 ustep: 1 
iter: 3  value: 3735.016 mgc: 7.695996e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  1.0079 
iter: 1  value: 3735.13 mgc: 0.4217289 ustep: 1 
iter: 2  value: 3735.13 mgc: 0.004996403 ustep: 1 
iter: 3  value: 3735.13 mgc: 7.20123e-07 ustep: 1 
iter: 4  mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  0.489693 
iter: 1  value: 3735.054 mgc: 0.2173139 ustep: 1 
iter: 2  value: 3735.054 mgc: 0.001486446 ustep: 1 
iter: 3  value: 3735.054 mgc: 6.943001e-08 ustep: 1 
iter: 4  mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  0.2519676 
iter: 1  value: 3735.177 mgc: 0.146057 ustep: 1 
iter: 2  value: 3735.177 mgc: 0.0003832909 ustep: 1 
iter: 3  mgc: 2.019787e-09 
iter: 1  mgc: 2.019787e-09 
outer mgc:  0.07405313 
iter: 1  value: 3735.269 mgc: 0.05766044 ustep: 1 
iter: 2  value: 3735.269 mgc: 7.687742e-05 ustep: 1 
iter: 3  mgc: 1.429092e-10 
iter: 1  mgc: 1.429092e-10 
outer mgc:  0.05496969 
iter: 1  value: 3735.34 mgc: 0.05182417 ustep: 1 
iter: 2  value: 3735.34 mgc: 6.69314e-05 ustep: 1 
iter: 3  mgc: 1.499743e-10 
iter: 1  mgc: 1.499743e-10 
outer mgc:  0.04510346 
iter: 1  value: 3735.419 mgc: 0.05879417 ustep: 1 
iter: 2  value: 3735.419 mgc: 8.512481e-05 ustep: 1 
iter: 3  mgc: 2.477014e-10 
iter: 1  mgc: 2.477014e-10 
outer mgc:  0.02559917 
iter: 1  value: 3735.419 mgc: 0.002034506 ustep: 1 
iter: 2  value: 3735.419 mgc: 1.061786e-07 ustep: 1 
iter: 3  mgc: 6.106227e-15 
iter: 1  mgc: 6.106227e-15 
outer mgc:  0.01130297 
iter: 1  value: 3735.417 mgc: 0.002990625 ustep: 1 
iter: 2  value: 3735.417 mgc: 2.092295e-07 ustep: 1 
iter: 3  mgc: 8.687495e-15 
iter: 1  mgc: 8.687495e-15 
outer mgc:  0.005496586 
iter: 1  value: 3735.414 mgc: 0.002901296 ustep: 1 
iter: 2  value: 3735.414 mgc: 1.154433e-07 ustep: 1 
iter: 3  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.000514336 
iter: 1  value: 3735.414 mgc: 0.0001549596 ustep: 1 
iter: 2  mgc: 5.673542e-10 
iter: 1  mgc: 5.673542e-10 
outer mgc:  0.0001238963 
iter: 1  mgc: 5.673542e-10 
iter: 1  mgc: 5.673542e-10 
outer mgc:  0.0001238963 
iter: 1  value: 3735.413 mgc: 0.005416345 ustep: 1 
iter: 2  value: 3735.413 mgc: 8.359565e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.03548429 
iter: 1  value: 3735.416 mgc: 0.005412712 ustep: 1 
iter: 2  value: 3735.416 mgc: 8.376646e-07 ustep: 1 
iter: 3  mgc: 2.498002e-14 
outer mgc:  0.0353325 
iter: 1  value: 3735.414 mgc: 0.003060168 ustep: 1 
iter: 2  value: 3735.414 mgc: 2.883004e-07 ustep: 1 
iter: 3  mgc: 5.995204e-15 
outer mgc:  0.02793407 
iter: 1  value: 3735.415 mgc: 0.003058627 ustep: 1 
iter: 2  value: 3735.415 mgc: 2.884601e-07 ustep: 1 
iter: 3  mgc: 7.188694e-15 
outer mgc:  0.02795575 
iter: 1  value: 3735.414 mgc: 0.006382322 ustep: 1 
iter: 2  value: 3735.414 mgc: 6.445556e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.04150401 
iter: 1  value: 3735.415 mgc: 0.006379152 ustep: 1 
iter: 2  value: 3735.415 mgc: 6.465283e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.04125341 
iter: 1  value: 3735.415 mgc: 0.003521432 ustep: 1 
iter: 2  value: 3735.415 mgc: 2.206243e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.03818182 
iter: 1  value: 3735.414 mgc: 0.003520573 ustep: 1 
iter: 2  value: 3735.414 mgc: 2.211094e-07 ustep: 1 
iter: 3  mgc: 6.439294e-15 
outer mgc:  0.03803705 
iter: 1  value: 3735.419 mgc: 0.003153665 ustep: 1 
iter: 2  value: 3735.419 mgc: 2.704904e-07 ustep: 1 
iter: 3  mgc: 7.660539e-15 
outer mgc:  0.003038389 
iter: 1  value: 3735.41 mgc: 0.003156819 ustep: 1 
iter: 2  value: 3735.41 mgc: 2.705435e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.003030777 
iter: 1  value: 3735.419 mgc: 0.002672673 ustep: 1 
iter: 2  value: 3735.419 mgc: 1.080744e-07 ustep: 1 
iter: 3  mgc: 5.551115e-15 
outer mgc:  0.00304015 
iter: 1  value: 3735.41 mgc: 0.002675347 ustep: 1 
iter: 2  value: 3735.41 mgc: 1.080773e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.003011687 
iter: 1  value: 3735.41 mgc: 0.002899268 ustep: 1 
iter: 2  value: 3735.41 mgc: 2.632412e-07 ustep: 1 
iter: 3  mgc: 4.440892e-15 
outer mgc:  0.009075305 
iter: 1  value: 3735.419 mgc: 0.002897147 ustep: 1 
iter: 2  value: 3735.419 mgc: 2.62908e-07 ustep: 1 
iter: 3  mgc: 4.884981e-15 
outer mgc:  0.009150783 
iter: 1  value: 3735.41 mgc: 0.003048379 ustep: 1 
iter: 2  value: 3735.41 mgc: 1.515179e-07 ustep: 1 
iter: 3  mgc: 4.884981e-15 
outer mgc:  0.009947099 
iter: 1  value: 3735.419 mgc: 0.003046455 ustep: 1 
iter: 2  value: 3735.419 mgc: 1.514259e-07 ustep: 1 
iter: 3  mgc: 6.078471e-15 
outer mgc:  0.009955061 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:43:04 2021]
Finished job 0.
1 of 1 steps (100%) done

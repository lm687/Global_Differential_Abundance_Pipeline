Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:54:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2151.082861 
iter  10 value 1374.087930
final  value 1374.087855 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1438.517 mgc: 138.4687 ustep: 1 
iter: 2  value: 1273.574 mgc: 58.34365 ustep: 1 
iter: 3  value: 1270.544 mgc: 9.942618 ustep: 1 
iter: 4  value: 1270.534 mgc: 0.6393947 ustep: 1 
iter: 5  value: 1270.534 mgc: 0.003659966 ustep: 1 
iter: 6  value: 1270.534 mgc: 1.292747e-07 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
Matching hessian patterns... Done
outer mgc:  412.4398 
iter: 1  value: 882.0777 mgc: 30.04532 ustep: 1 
iter: 2  value: 867.1424 mgc: 12.32512 ustep: 1 
iter: 3  value: 867.0068 mgc: 1.239507 ustep: 1 
iter: 4  value: 867.0068 mgc: 0.02747016 ustep: 1 
iter: 5  value: 867.0068 mgc: 1.456876e-05 ustep: 1 
iter: 6  mgc: 4.100387e-12 
iter: 1  value: 417.6134 mgc: 58.72702 ustep: 0.1336527 
iter: 2  value: 250.4963 mgc: 58.44707 ustep: 0.3656489 
iter: 3  value: 245.6548 mgc: 6.776703 ustep: 0.6047286 
iter: 4  value: 245.616 mgc: 0.5203744 ustep: 0.7776652 
iter: 5  value: 245.6159 mgc: 0.01407637 ustep: 0.8818651 
iter: 6  value: 245.6159 mgc: 0.000159938 ustep: 0.9390828 
iter: 7  value: 245.6159 mgc: 1.128306e-06 ustep: 0.969066 
iter: 8  mgc: 4.295351e-09 
iter: 1  mgc: 4.295351e-09 
outer mgc:  53.58205 
iter: 1  value: 153.3855 mgc: 23.28688 ustep: 1 
iter: 2  value: 152.9567 mgc: 1.380931 ustep: 1 
iter: 3  value: 152.9567 mgc: 0.01849185 ustep: 1 
iter: 4  value: 152.9567 mgc: 8.622262e-06 ustep: 1 
iter: 5  mgc: 1.033007e-12 
iter: 1  mgc: 1.033007e-12 
outer mgc:  51.09144 
iter: 1  value: 393.9729 mgc: 49.35222 ustep: 1 
iter: 2  value: 390.1447 mgc: 5.141914 ustep: 1 
iter: 3  value: 390.1316 mgc: 0.378523 ustep: 1 
iter: 4  value: 390.1316 mgc: 0.00273136 ustep: 1 
iter: 5  value: 390.1316 mgc: 1.458198e-07 ustep: 1 
mgc: 3.153033e-14 
iter: 1  value: 128.7327 mgc: 20.29723 ustep: 1 
iter: 2  value: 128.2701 mgc: 1.981447 ustep: 1 
iter: 3  value: 128.2699 mgc: 0.05402129 ustep: 1 
iter: 4  value: 128.2699 mgc: 5.786829e-05 ustep: 1 
iter: 5  mgc: 6.664957e-11 
iter: 1  mgc: 6.664957e-11 
outer mgc:  20.54219 
iter: 1  value: 135.0387 mgc: 19.69825 ustep: 1 
iter: 2  value: 124.8899 mgc: 9.580852 ustep: 1 
iter: 3  value: 124.8035 mgc: 0.6947278 ustep: 1 
iter: 4  value: 124.8035 mgc: 0.008507414 ustep: 1 
iter: 5  value: 124.8035 mgc: 1.499519e-06 ustep: 1 
iter: 6  mgc: 5.095924e-14 
iter: 1  mgc: 5.095924e-14 
outer mgc:  22.01055 
iter: 1  value: 115.2114 mgc: 21.06914 ustep: 1 
iter: 2  value: 115.0771 mgc: 1.043151 ustep: 1 
iter: 3  value: 115.0771 mgc: 0.01716902 ustep: 1 
iter: 4  value: 115.0771 mgc: 4.083302e-06 ustep: 1 
iter: 5  mgc: 2.597922e-13 
iter: 1  mgc: 2.597922e-13 
outer mgc:  10.9472 
iter: 1  value: 123.9091 mgc: 21.99765 ustep: 1 
iter: 2  value: 108.2228 mgc: 11.36137 ustep: 1 
iter: 3  value: 108.0828 mgc: 1.027436 ustep: 1 
iter: 4  value: 108.0828 mgc: 0.01274379 ustep: 1 
iter: 5  value: 108.0828 mgc: 2.035631e-06 ustep: 1 
iter: 6  mgc: 5.963285e-14 
iter: 1  mgc: 5.963285e-14 
outer mgc:  8.677207 
iter: 1  value: 101.4304 mgc: 9.69521 ustep: 1 
iter: 2  value: 101.4257 mgc: 0.3674911 ustep: 1 
iter: 3  value: 101.4257 mgc: 0.0006524975 ustep: 1 
iter: 4  mgc: 1.923709e-09 
iter: 1  mgc: 1.923709e-09 
outer mgc:  22.57442 
iter: 1  value: 138.4152 mgc: 45.17451 ustep: 1 
iter: 2  value: 138.2106 mgc: 2.436292 ustep: 1 
iter: 3  value: 138.2106 mgc: 0.0178523 ustep: 1 
iter: 4  value: 138.2106 mgc: 1.553764e-06 ustep: 1 
iter: 5  mgc: 2.131628e-14 
iter: 1  value: 98.34929 mgc: 7.2377 ustep: 1 
iter: 2  value: 98.34706 mgc: 0.1750035 ustep: 1 
iter: 3  value: 98.34706 mgc: 0.0001300543 ustep: 1 
iter: 4  mgc: 7.120948e-11 
iter: 1  mgc: 7.120948e-11 
outer mgc:  7.781119 
iter: 1  value: 97.10935 mgc: 1.823674 ustep: 1 
iter: 2  value: 97.10933 mgc: 0.01543288 ustep: 1 
iter: 3  value: 97.10933 mgc: 1.871114e-06 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  6.381751 
iter: 1  value: 96.45455 mgc: 7.297511 ustep: 1 
iter: 2  value: 96.4539 mgc: 0.08623335 ustep: 1 
iter: 3  value: 96.4539 mgc: 3.575188e-05 ustep: 1 
iter: 4  mgc: 8.721468e-12 
iter: 1  mgc: 8.721468e-12 
outer mgc:  7.49503 
iter: 1  value: 95.55707 mgc: 1.580094 ustep: 1 
iter: 2  value: 95.55707 mgc: 0.009605677 ustep: 1 
iter: 3  value: 95.55707 mgc: 3.216597e-07 ustep: 1 
iter: 4  mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  1.903152 
iter: 1  value: 94.18109 mgc: 2.737836 ustep: 1 
iter: 2  value: 94.18109 mgc: 0.0168734 ustep: 1 
iter: 3  value: 94.18109 mgc: 5.808574e-07 ustep: 1 
iter: 4  mgc: 1.870726e-14 
iter: 1  mgc: 1.870726e-14 
outer mgc:  2.237919 
iter: 1  value: 92.43685 mgc: 4.237228 ustep: 1 
iter: 2  value: 92.43679 mgc: 0.03410911 ustep: 1 
iter: 3  value: 92.43679 mgc: 4.505085e-06 ustep: 1 
iter: 4  mgc: 1.496581e-13 
iter: 1  mgc: 1.496581e-13 
outer mgc:  2.671214 
iter: 1  value: 90.59069 mgc: 4.073282 ustep: 1 
iter: 2  value: 90.59066 mgc: 0.01826905 ustep: 1 
iter: 3  value: 90.59066 mgc: 1.457426e-06 ustep: 1 
iter: 4  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  4.136718 
iter: 1  value: 89.86084 mgc: 7.086862 ustep: 1 
iter: 2  value: 89.86084 mgc: 0.03241028 ustep: 1 
iter: 3  value: 89.86084 mgc: 6.30252e-07 ustep: 1 
mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  2.224155 
iter: 1  value: 89.47349 mgc: 1.452218 ustep: 1 
iter: 2  value: 89.47349 mgc: 0.00268925 ustep: 1 
iter: 3  value: 89.47349 mgc: 2.189138e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  2.447989 
iter: 1  value: 88.91006 mgc: 0.8310668 ustep: 1 
iter: 2  value: 88.91006 mgc: 0.0003861661 ustep: 1 
iter: 3  mgc: 1.888281e-10 
iter: 1  mgc: 1.888281e-10 
outer mgc:  0.4471311 
iter: 1  value: 88.59814 mgc: 0.7191621 ustep: 1 
iter: 2  value: 88.59814 mgc: 0.0001787104 ustep: 1 
iter: 3  mgc: 1.78364e-11 
iter: 1  value: 88.19508 mgc: 0.9464454 ustep: 1 
iter: 2  value: 88.19508 mgc: 0.0002643402 ustep: 1 
iter: 3  mgc: 3.554224e-11 
iter: 1  mgc: 3.554224e-11 
outer mgc:  0.4040923 
iter: 1  value: 86.68222 mgc: 4.004786 ustep: 1 
iter: 2  value: 86.68222 mgc: 0.002376826 ustep: 1 
iter: 3  mgc: 3.001613e-09 
iter: 1  mgc: 3.001613e-09 
outer mgc:  0.153725 
iter: 1  value: 85.27477 mgc: 3.599 ustep: 1 
iter: 2  value: 85.27477 mgc: 0.001004084 ustep: 1 
iter: 3  mgc: 6.769998e-10 
iter: 1  mgc: 6.769998e-10 
outer mgc:  0.07253725 
iter: 1  value: 84.00175 mgc: 3.199134 ustep: 1 
iter: 2  value: 84.00175 mgc: 0.0005336045 ustep: 1 
iter: 3  mgc: 1.177067e-10 
iter: 1  mgc: 1.177067e-10 
outer mgc:  0.09189274 
iter: 1  value: 82.35596 mgc: 4.346675 ustep: 1 
iter: 2  value: 82.35596 mgc: 0.0004637752 ustep: 1 
iter: 3  mgc: 1.230989e-10 
iter: 1  mgc: 1.230989e-10 
outer mgc:  0.0917587 
iter: 1  value: 80.89728 mgc: 3.718329 ustep: 1 
iter: 2  value: 80.89728 mgc: 0.0002212558 ustep: 1 
iter: 3  mgc: 1.476153e-11 
iter: 1  mgc: 1.476153e-11 
outer mgc:  0.05085754 
iter: 1  value: 79.65728 mgc: 3.182422 ustep: 1 
iter: 2  value: 79.65728 mgc: 8.802031e-05 ustep: 1 
iter: 3  mgc: 3.563372e-12 
iter: 1  mgc: 3.563372e-12 
outer mgc:  0.03752998 
iter: 1  value: 77.79578 mgc: 4.975215 ustep: 1 
iter: 2  value: 77.79578 mgc: 0.0001008149 ustep: 1 
iter: 3  mgc: 4.882317e-12 
iter: 1  mgc: 4.882317e-12 
outer mgc:  0.03061751 
iter: 1  value: 76.23341 mgc: 4.140071 ustep: 1 
iter: 2  value: 76.23341 mgc: 4.19309e-05 ustep: 1 
iter: 3  mgc: 5.382361e-13 
iter: 1  mgc: 5.382361e-13 
outer mgc:  0.02716243 
iter: 1  value: 74.34821 mgc: 5.019286 ustep: 1 
iter: 2  value: 74.34821 mgc: 2.333567e-05 ustep: 1 
iter: 3  mgc: 4.289902e-13 
iter: 1  mgc: 4.289902e-13 
outer mgc:  0.02095553 
iter: 1  value: 72.76984 mgc: 4.232743 ustep: 1 
iter: 2  value: 72.76984 mgc: 1.207819e-05 ustep: 1 
iter: 3  mgc: 1.632028e-13 
iter: 1  mgc: 1.632028e-13 
outer mgc:  0.01804154 
iter: 1  value: 70.76374 mgc: 5.375062 ustep: 1 
iter: 2  value: 70.76374 mgc: 6.386037e-06 ustep: 1 
iter: 3  mgc: 2.83773e-13 
iter: 1  mgc: 2.83773e-13 
outer mgc:  0.01392037 
iter: 1  value: 69.09933 mgc: 4.554487 ustep: 1 
iter: 2  value: 69.09933 mgc: 3.461998e-06 ustep: 1 
iter: 3  mgc: 8.784085e-13 
iter: 1  mgc: 8.784085e-13 
outer mgc:  0.009825634 
iter: 1  value: 67.05299 mgc: 5.492464 ustep: 1 
iter: 2  value: 67.05299 mgc: 1.518185e-06 ustep: 1 
iter: 3  mgc: 3.925749e-13 
iter: 1  mgc: 3.925749e-13 
outer mgc:  0.007319407 
iter: 1  value: 65.3581 mgc: 4.654603 ustep: 1 
iter: 2  value: 65.3581 mgc: 8.042395e-07 ustep: 1 
iter: 3  mgc: 1.068923e-12 
iter: 1  mgc: 1.068923e-12 
outer mgc:  0.004032698 
iter: 1  value: 63.28804 mgc: 5.605033 ustep: 1 
iter: 2  value: 63.28804 mgc: 3.465803e-07 ustep: 1 
mgc: 5.973e-13 
iter: 1  mgc: 5.973e-13 
outer mgc:  0.003223307 
iter: 1  value: 61.57496 mgc: 4.683766 ustep: 1 
iter: 2  value: 61.57496 mgc: 1.696563e-07 ustep: 1 
mgc: 1.795897e-12 
iter: 1  mgc: 1.795897e-12 
outer mgc:  0.001526536 
iter: 1  value: 59.49167 mgc: 5.685213 ustep: 1 
iter: 2  value: 59.49167 mgc: 8.163715e-08 ustep: 1 
mgc: 4.754419e-12 
iter: 1  mgc: 4.754419e-12 
outer mgc:  0.00137973 
iter: 1  value: 57.76879 mgc: 4.689266 ustep: 1 
iter: 2  value: 57.76879 mgc: 3.51052e-08 ustep: 1 
mgc: 9.06164e-12 
iter: 1  mgc: 9.06164e-12 
outer mgc:  0.0005827079 
iter: 1  value: 55.67812 mgc: 5.732021 ustep: 1 
iter: 2  value: 55.67812 mgc: 1.902922e-08 ustep: 1 
mgc: 8.35354e-12 
iter: 1  mgc: 8.35354e-12 
outer mgc:  0.0006037246 
iter: 1  value: 53.94998 mgc: 4.690028 ustep: 1 
iter: 2  mgc: 7.296881e-09 
iter: 1  mgc: 7.296881e-09 
outer mgc:  0.0002219015 
iter: 1  value: 51.85574 mgc: 5.755242 ustep: 1 
iter: 2  mgc: 4.301947e-09 
iter: 1  mgc: 4.301947e-09 
outer mgc:  0.0002717942 
iter: 1  value: 50.12509 mgc: 4.690093 ustep: 1 
iter: 2  mgc: 1.528035e-09 
iter: 1  mgc: 1.528035e-09 
outer mgc:  0.0001021332 
iter: 1  value: 48.02914 mgc: 5.765109 ustep: 1 
iter: 2  mgc: 9.586394e-10 
iter: 1  mgc: 9.586394e-10 
outer mgc:  0.000148706 
iter: 1  value: 46.29729 mgc: 4.692022 ustep: 1 
iter: 2  mgc: 3.214566e-10 
iter: 1  mgc: 3.214566e-10 
outer mgc:  4.715793e-05 
iter: 1  value: 44.20064 mgc: 5.766463 ustep: 1 
iter: 2  mgc: 2.040874e-10 
iter: 1  mgc: 2.040874e-10 
outer mgc:  8.149277e-05 
iter: 1  value: 42.4683 mgc: 4.696296 ustep: 1 
iter: 2  mgc: 6.799628e-11 
iter: 1  mgc: 6.799628e-11 
outer mgc:  2.128692e-05 
iter: 1  value: 40.37128 mgc: 5.762737 ustep: 1 
iter: 2  mgc: 1.671863e-10 
iter: 1  mgc: 1.671863e-10 
outer mgc:  4.405687e-05 
iter: 1  value: 38.6387 mgc: 4.703663 ustep: 1 
iter: 2  mgc: 1.846268e-10 
iter: 1  mgc: 1.846268e-10 
outer mgc:  9.403331e-06 
iter: 1  value: 36.54155 mgc: 5.754814 ustep: 1 
iter: 2  mgc: 9.398171e-11 
iter: 1  mgc: 9.398171e-11 
outer mgc:  2.370016e-05 
iter: 1  value: 34.80887 mgc: 4.713981 ustep: 1 
iter: 2  mgc: 6.015566e-10 
iter: 1  mgc: 6.015566e-10 
outer mgc:  4.059807e-06 
iter: 1  mgc: 6.015566e-10 
iter: 1  mgc: 6.015566e-10 
outer mgc:  4.059807e-06 
iter: 1  value: 34.80938 mgc: 0.02551481 ustep: 1 
iter: 2  value: 34.80938 mgc: 2.775083e-07 ustep: 1 
iter: 3  mgc: 2.217977e-10 
outer mgc:  0.2031029 
iter: 1  value: 34.80857 mgc: 0.02549653 ustep: 1 
iter: 2  value: 34.80857 mgc: 2.772669e-07 ustep: 1 
iter: 3  mgc: 7.047096e-10 
outer mgc:  0.2029747 
iter: 1  value: 34.8088 mgc: 0.01285993 ustep: 1 
iter: 2  value: 34.8088 mgc: 9.014872e-08 ustep: 1 
mgc: 2.78916e-10 
outer mgc:  0.09119531 
iter: 1  value: 34.80904 mgc: 0.01285054 ustep: 1 
iter: 2  value: 34.80904 mgc: 8.967002e-08 ustep: 1 
mgc: 4.328706e-10 
outer mgc:  0.09113403 
iter: 1  value: 34.80888 mgc: 0.03910389 ustep: 1 
iter: 2  value: 34.80888 mgc: 3.708875e-06 ustep: 1 
iter: 3  mgc: 3.963221e-10 
outer mgc:  0.1128595 
iter: 1  value: 34.80897 mgc: 0.03911199 ustep: 1 
iter: 2  value: 34.80897 mgc: 3.704116e-06 ustep: 1 
iter: 3  mgc: 4.598788e-10 
outer mgc:  0.1128993 
iter: 1  value: 34.80927 mgc: 0.01502119 ustep: 1 
iter: 2  value: 34.80927 mgc: 1.530665e-07 ustep: 1 
iter: 3  mgc: 2.661658e-10 
outer mgc:  0.09772431 
iter: 1  value: 34.80858 mgc: 0.01503131 ustep: 1 
iter: 2  value: 34.80858 mgc: 1.533432e-07 ustep: 1 
iter: 3  mgc: 4.416885e-10 
outer mgc:  0.09778167 
iter: 1  value: 34.80886 mgc: 3.505195e-05 ustep: 1 
mgc: 5.020462e-10 
outer mgc:  4.05929e-06 
iter: 1  value: 34.80889 mgc: 3.505273e-05 ustep: 1 
mgc: 5.61569e-10 
outer mgc:  4.059265e-06 
iter: 1  value: 34.81995 mgc: 2387.609 ustep: 1 
iter: 2  value: 34.81995 mgc: 9.96918e-07 ustep: 1 
iter: 3  mgc: 5.809633e-10 
outer mgc:  0.01220894 
iter: 1  value: 34.7978 mgc: 2394.782 ustep: 1 
iter: 2  value: 34.7978 mgc: 9.946095e-07 ustep: 1 
iter: 3  mgc: 6.790239e-10 
outer mgc:  0.01218519 
iter: 1  value: 34.80953 mgc: 2390.002 ustep: 1 
iter: 2  value: 34.80953 mgc: 1.20227e-06 ustep: 1 
iter: 3  mgc: 5.451173e-10 
outer mgc:  0.02789748 
iter: 1  value: 34.80824 mgc: 2392.393 ustep: 1 
iter: 2  value: 34.80824 mgc: 1.203621e-06 ustep: 1 
iter: 3  mgc: 4.297822e-10 
outer mgc:  0.02792591 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:54:48 2021]
Finished job 0.
1 of 1 steps (100%) done

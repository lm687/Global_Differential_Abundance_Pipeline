Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:06:09 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11153.111955 
iter  10 value 9084.950967
final  value 9082.617177 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 9477.68 mgc: 98.18144 ustep: 1 
iter: 2  value: 9359.439 mgc: 18.12785 ustep: 1 
iter: 3  value: 9353.362 mgc: 4.232931 ustep: 1 
iter: 4  value: 9353.158 mgc: 0.8566098 ustep: 1 
iter: 5  value: 9353.155 mgc: 0.09777743 ustep: 1 
iter: 6  value: 9353.155 mgc: 0.001729704 ustep: 1 
iter: 7  value: 9353.155 mgc: 5.661192e-07 ustep: 1 
iter: 8  mgc: 5.323519e-14 
iter: 1  mgc: 5.323519e-14 
Matching hessian patterns... Done
outer mgc:  2099.513 
iter: 1  value: 7113.033 mgc: 33.58069 ustep: 1 
iter: 2  value: 7110.989 mgc: 6.576088 ustep: 1 
iter: 3  value: 7110.987 mgc: 0.2123068 ustep: 1 
iter: 4  value: 7110.987 mgc: 0.0002624438 ustep: 1 
iter: 5  mgc: 4.687497e-09 
iter: 1  value: 5878.414 mgc: 85.07202 ustep: 0.4367355 
iter: 2  value: 4588.275 mgc: 162.206 ustep: 0.06532755 
iter: 3  value: 4495.921 mgc: 89.78204 ustep: 0.07114355 
iter: 4  value: 3543.842 mgc: 130.1987 ustep: 0.03803773 
iter: 5  value: 3369.704 mgc: 78.83345 ustep: 0.05280669 
iter: 6  value: 3291.723 mgc: 70.13206 ustep: 0.2298741 
iter: 7  value: 3289.305 mgc: 13.5402 ustep: 0.4795039 
iter: 8  value: 3289.277 mgc: 0.3442585 ustep: 0.692493 
iter: 9  value: 3289.277 mgc: 0.02889387 ustep: 0.8321784 
iter: 10  value: 3289.277 mgc: 0.003340059 ustep: 0.9122469 
iter: 11  value: 3289.277 mgc: 0.0002026023 ustep: 0.9551207 
iter: 12  value: 3289.277 mgc: 6.303779e-06 ustep: 0.977305 
iter: 13  value: 3289.277 mgc: 9.886035e-08 ustep: 0.9885885 
iter: 14  mgc: 7.771587e-10 
iter: 1  mgc: 7.771587e-10 
outer mgc:  648.8463 
iter: 1  value: 2644.81 mgc: 52.49326 ustep: 1 
iter: 2  value: 1495.68 mgc: 43.05866 ustep: 1 
iter: 3  value: 1436.865 mgc: 8.424989 ustep: 1 
iter: 4  value: 1434.934 mgc: 1.72361 ustep: 1 
iter: 5  value: 1434.92 mgc: 0.1791321 ustep: 1 
iter: 6  value: 1434.92 mgc: 0.003115191 ustep: 1 
iter: 7  value: 1434.92 mgc: 1.287437e-06 ustep: 1 
iter: 8  mgc: 2.127742e-13 
iter: 1  mgc: 2.127742e-13 
outer mgc:  601.7189 
iter: 1  value: 4864.781 mgc: 90.04988 ustep: 1 
iter: 2  value: 4571.095 mgc: 38.86253 ustep: 1 
iter: 3  value: 4548.259 mgc: 8.120178 ustep: 1 
iter: 4  value: 4548.168 mgc: 0.5934119 ustep: 1 
iter: 5  value: 4548.168 mgc: 0.006565675 ustep: 1 
iter: 6  value: 4548.168 mgc: 1.539286e-06 ustep: 1 
iter: 7  mgc: 9.281464e-14 
iter: 1  value: 1190.703 mgc: 34.11887 ustep: 1 
iter: 2  value: 1185.778 mgc: 6.249847 ustep: 1 
iter: 3  value: 1185.776 mgc: 0.2478322 ustep: 1 
iter: 4  value: 1185.776 mgc: 0.0004633566 ustep: 1 
iter: 5  mgc: 1.631359e-09 
iter: 1  mgc: 1.631359e-09 
outer mgc:  307.1597 
iter: 1  value: 1060.394 mgc: 20.83054 ustep: 1 
iter: 2  value: 1059.736 mgc: 1.976711 ustep: 1 
iter: 3  value: 1059.736 mgc: 0.02920215 ustep: 1 
iter: 4  value: 1059.736 mgc: 7.107335e-06 ustep: 1 
iter: 5  mgc: 4.274359e-13 
iter: 1  mgc: 4.274359e-13 
outer mgc:  284.8883 
iter: 1  value: 1026.695 mgc: 24.24137 ustep: 1 
iter: 2  value: 1021.682 mgc: 3.93773 ustep: 1 
iter: 3  value: 1021.654 mgc: 0.311526 ustep: 1 
iter: 4  value: 1021.654 mgc: 0.004835333 ustep: 1 
iter: 5  value: 1021.654 mgc: 1.212157e-06 ustep: 1 
iter: 6  mgc: 9.05942e-14 
iter: 1  mgc: 9.05942e-14 
outer mgc:  305.3024 
iter: 1  value: 3223.012 mgc: 104.9436 ustep: 1 
iter: 2  value: 2263.047 mgc: 65.79236 ustep: 1 
iter: 3  value: 2255.505 mgc: 9.515398 ustep: 1 
iter: 4  value: 2255.498 mgc: 0.237944 ustep: 1 
iter: 5  value: 2255.498 mgc: 0.0008906833 ustep: 1 
iter: 6  value: 2255.498 mgc: 1.248906e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  value: 970.7479 mgc: 13.08668 ustep: 1 
iter: 2  value: 970.7272 mgc: 0.3786981 ustep: 1 
iter: 3  value: 970.7272 mgc: 0.0004480758 ustep: 1 
iter: 4  mgc: 4.20135e-10 
iter: 1  mgc: 4.20135e-10 
outer mgc:  111.1272 
iter: 1  value: 936.3722 mgc: 4.829767 ustep: 1 
iter: 2  value: 936.3713 mgc: 0.1068502 ustep: 1 
iter: 3  value: 936.3713 mgc: 6.064026e-05 ustep: 1 
iter: 4  mgc: 2.036771e-11 
iter: 1  value: 893.7657 mgc: 9.798661 ustep: 1 
iter: 2  value: 893.7427 mgc: 0.4272197 ustep: 1 
iter: 3  value: 893.7427 mgc: 0.00134915 ustep: 1 
iter: 4  value: 893.7427 mgc: 1.387551e-08 ustep: 1 
mgc: 5.861978e-14 
iter: 1  mgc: 5.861978e-14 
outer mgc:  97.33087 
iter: 1  value: 847.0964 mgc: 18.22998 ustep: 1 
iter: 2  value: 847.0182 mgc: 1.154497 ustep: 1 
iter: 3  value: 847.0182 mgc: 0.004790408 ustep: 1 
iter: 4  value: 847.0182 mgc: 1.279684e-07 ustep: 1 
mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  71.60694 
iter: 1  value: 842.2384 mgc: 13.02199 ustep: 1 
iter: 2  value: 842.1311 mgc: 0.9675167 ustep: 1 
iter: 3  value: 842.131 mgc: 0.01631279 ustep: 1 
iter: 4  value: 842.131 mgc: 9.831802e-06 ustep: 1 
iter: 5  mgc: 3.21787e-12 
iter: 1  mgc: 3.21787e-12 
outer mgc:  111.7439 
iter: 1  value: 840.0494 mgc: 10.86173 ustep: 1 
iter: 2  value: 840.0103 mgc: 0.5554219 ustep: 1 
iter: 3  value: 840.0103 mgc: 0.00656186 ustep: 1 
iter: 4  value: 840.0103 mgc: 2.398159e-06 ustep: 1 
iter: 5  mgc: 3.046452e-13 
iter: 1  mgc: 3.046452e-13 
outer mgc:  228.1066 
iter: 1  value: 804.1719 mgc: 17.28613 ustep: 1 
iter: 2  value: 803.9586 mgc: 1.168055 ustep: 1 
iter: 3  value: 803.9586 mgc: 0.008027444 ustep: 1 
iter: 4  value: 803.9586 mgc: 3.899829e-07 ustep: 1 
iter: 5  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  90.92001 
iter: 1  value: 794.9035 mgc: 3.599057 ustep: 1 
iter: 2  value: 794.8942 mgc: 0.08852129 ustep: 1 
iter: 3  value: 794.8942 mgc: 0.0002114207 ustep: 1 
iter: 4  mgc: 1.922698e-09 
iter: 1  mgc: 1.922698e-09 
outer mgc:  34.0017 
iter: 1  value: 798.9075 mgc: 16.66728 ustep: 1 
iter: 2  value: 798.5856 mgc: 1.248055 ustep: 1 
iter: 3  value: 798.5856 mgc: 0.009212881 ustep: 1 
iter: 4  value: 798.5856 mgc: 5.17569e-07 ustep: 1 
iter: 5  mgc: 4.374279e-14 
iter: 1  value: 787.8534 mgc: 9.398818 ustep: 1 
iter: 2  value: 787.8441 mgc: 0.2680147 ustep: 1 
iter: 3  value: 787.8441 mgc: 0.0004337738 ustep: 1 
iter: 4  mgc: 1.288555e-09 
iter: 1  mgc: 1.288555e-09 
outer mgc:  58.24314 
iter: 1  value: 784.0875 mgc: 12.07542 ustep: 1 
iter: 2  value: 783.9787 mgc: 0.4632612 ustep: 1 
iter: 3  value: 783.9787 mgc: 0.003530414 ustep: 1 
iter: 4  value: 783.9787 mgc: 3.52564e-07 ustep: 1 
iter: 5  mgc: 4.862777e-14 
iter: 1  mgc: 4.862777e-14 
outer mgc:  46.06947 
iter: 1  value: 808.7137 mgc: 28.0963 ustep: 1 
iter: 2  value: 806.736 mgc: 3.429926 ustep: 1 
iter: 3  value: 806.7357 mgc: 0.05441109 ustep: 1 
iter: 4  value: 806.7357 mgc: 2.121051e-05 ustep: 1 
iter: 5  mgc: 3.206768e-12 
iter: 1  value: 778.4753 mgc: 9.426928 ustep: 1 
iter: 2  value: 778.4638 mgc: 0.2723893 ustep: 1 
iter: 3  value: 778.4638 mgc: 0.0004067282 ustep: 1 
iter: 4  mgc: 1.088985e-09 
iter: 1  mgc: 1.088985e-09 
outer mgc:  52.74342 
iter: 1  value: 779.1316 mgc: 7.89776 ustep: 1 
iter: 2  value: 779.1234 mgc: 0.2062602 ustep: 1 
iter: 3  value: 779.1234 mgc: 0.0002492334 ustep: 1 
iter: 4  mgc: 3.654987e-10 
iter: 1  value: 776.8786 mgc: 3.6527 ustep: 1 
iter: 2  value: 776.8782 mgc: 0.0450277 ustep: 1 
iter: 3  value: 776.8782 mgc: 1.184485e-05 ustep: 1 
iter: 4  mgc: 8.624212e-13 
iter: 1  mgc: 8.624212e-13 
outer mgc:  34.80578 
iter: 1  value: 775.2273 mgc: 2.057347 ustep: 1 
iter: 2  value: 775.2273 mgc: 0.01285283 ustep: 1 
iter: 3  value: 775.2273 mgc: 9.521993e-07 ustep: 1 
iter: 4  mgc: 5.040413e-14 
iter: 1  mgc: 5.040413e-14 
outer mgc:  22.11605 
iter: 1  value: 773.4267 mgc: 3.518417 ustep: 1 
iter: 2  value: 773.4264 mgc: 0.03793646 ustep: 1 
iter: 3  value: 773.4264 mgc: 6.051981e-06 ustep: 1 
iter: 4  mgc: 1.738609e-12 
iter: 1  mgc: 1.738609e-12 
outer mgc:  30.33819 
iter: 1  value: 769.2014 mgc: 2.908439 ustep: 1 
iter: 2  value: 769.1995 mgc: 0.06304258 ustep: 1 
iter: 3  value: 769.1995 mgc: 2.951497e-05 ustep: 1 
iter: 4  mgc: 2.499312e-11 
iter: 1  mgc: 2.499312e-11 
outer mgc:  19.33874 
iter: 1  value: 767.4772 mgc: 1.957255 ustep: 1 
iter: 2  value: 767.4769 mgc: 0.03292129 ustep: 1 
iter: 3  value: 767.4769 mgc: 1.472235e-05 ustep: 1 
iter: 4  mgc: 1.027267e-11 
iter: 1  mgc: 1.027267e-11 
outer mgc:  15.63267 
iter: 1  value: 766.5317 mgc: 7.314893 ustep: 1 
iter: 2  value: 766.5252 mgc: 0.1583713 ustep: 1 
iter: 3  value: 766.5252 mgc: 0.0001344913 ustep: 1 
iter: 4  mgc: 1.213412e-10 
iter: 1  mgc: 1.213412e-10 
outer mgc:  15.02171 
iter: 1  value: 765.572 mgc: 3.426441 ustep: 1 
iter: 2  value: 765.5664 mgc: 0.07134213 ustep: 1 
iter: 3  value: 765.5664 mgc: 0.000167648 ustep: 1 
iter: 4  mgc: 1.236512e-09 
iter: 1  mgc: 1.236512e-09 
outer mgc:  13.93733 
iter: 1  value: 765.2974 mgc: 7.650933 ustep: 1 
iter: 2  value: 765.2939 mgc: 0.1594595 ustep: 1 
iter: 3  value: 765.2939 mgc: 0.0001447024 ustep: 1 
iter: 4  mgc: 1.194405e-10 
iter: 1  mgc: 1.194405e-10 
outer mgc:  11.27943 
iter: 1  value: 764.1823 mgc: 0.9981822 ustep: 1 
iter: 2  value: 764.1821 mgc: 0.01555823 ustep: 1 
iter: 3  value: 764.1821 mgc: 3.404309e-05 ustep: 1 
iter: 4  mgc: 1.691234e-10 
iter: 1  mgc: 1.691234e-10 
outer mgc:  7.00587 
iter: 1  value: 765.0229 mgc: 6.283287 ustep: 1 
iter: 2  value: 765.0192 mgc: 0.1354174 ustep: 1 
iter: 3  value: 765.0192 mgc: 0.0001253973 ustep: 1 
iter: 4  mgc: 1.079212e-10 
iter: 1  value: 764.4183 mgc: 3.972106 ustep: 1 
iter: 2  value: 764.4177 mgc: 0.04910983 ustep: 1 
iter: 3  value: 764.4177 mgc: 1.671068e-05 ustep: 1 
iter: 4  mgc: 1.944223e-12 
iter: 1  value: 764.0536 mgc: 1.409862 ustep: 1 
iter: 2  value: 764.0536 mgc: 0.005979966 ustep: 1 
iter: 3  value: 764.0536 mgc: 2.467788e-07 ustep: 1 
iter: 4  mgc: 5.551115e-14 
iter: 1  mgc: 5.551115e-14 
outer mgc:  4.387877 
iter: 1  value: 763.9766 mgc: 0.3979131 ustep: 1 
iter: 2  value: 763.9766 mgc: 0.0004250151 ustep: 1 
iter: 3  mgc: 1.180475e-09 
iter: 1  mgc: 1.180475e-09 
outer mgc:  2.377243 
iter: 1  value: 763.9143 mgc: 0.3946612 ustep: 1 
iter: 2  value: 763.9143 mgc: 0.0005751121 ustep: 1 
iter: 3  mgc: 2.166022e-09 
iter: 1  value: 763.8659 mgc: 0.4585238 ustep: 1 
iter: 2  value: 763.8659 mgc: 0.0007766281 ustep: 1 
iter: 3  mgc: 3.938047e-09 
iter: 1  mgc: 3.938047e-09 
outer mgc:  0.3718937 
iter: 1  value: 763.8712 mgc: 0.06751837 ustep: 1 
iter: 2  value: 763.8712 mgc: 1.062167e-05 ustep: 1 
iter: 3  mgc: 1.122213e-12 
iter: 1  mgc: 1.122213e-12 
outer mgc:  0.0856358 
iter: 1  value: 763.8752 mgc: 0.01982582 ustep: 1 
iter: 2  value: 763.8752 mgc: 1.021018e-06 ustep: 1 
iter: 3  mgc: 1.052491e-13 
iter: 1  mgc: 1.052491e-13 
outer mgc:  0.03414077 
iter: 1  value: 763.8743 mgc: 0.004115256 ustep: 1 
iter: 2  value: 763.8743 mgc: 1.046804e-07 ustep: 1 
iter: 3  mgc: 4.32987e-14 
iter: 1  mgc: 4.32987e-14 
outer mgc:  0.0003274851 
iter: 1  value: 763.8743 mgc: 0.0001061975 ustep: 1 
iter: 2  mgc: 3.947997e-11 
iter: 1  mgc: 3.947997e-11 
outer mgc:  6.145858e-05 
iter: 1  mgc: 3.947997e-11 
iter: 1  mgc: 3.947997e-11 
outer mgc:  6.145858e-05 
iter: 1  value: 763.8751 mgc: 0.05853994 ustep: 1 
iter: 2  value: 763.8751 mgc: 8.913696e-06 ustep: 1 
iter: 3  mgc: 4.201084e-13 
outer mgc:  0.1670499 
iter: 1  value: 763.8737 mgc: 0.05854984 ustep: 1 
iter: 2  value: 763.8737 mgc: 8.923109e-06 ustep: 1 
iter: 3  mgc: 4.583001e-13 
outer mgc:  0.1670052 
iter: 1  value: 763.8743 mgc: 0.02905096 ustep: 1 
iter: 2  value: 763.8743 mgc: 2.803665e-06 ustep: 1 
iter: 3  mgc: 6.750156e-14 
outer mgc:  0.5243163 
iter: 1  value: 763.8749 mgc: 0.02905453 ustep: 1 
iter: 2  value: 763.8749 mgc: 2.80261e-06 ustep: 1 
iter: 3  mgc: 6.705747e-14 
outer mgc:  0.5242687 
iter: 1  value: 763.8744 mgc: 0.05322423 ustep: 1 
iter: 2  value: 763.8744 mgc: 8.207038e-06 ustep: 1 
iter: 3  mgc: 4.427569e-13 
outer mgc:  0.1478744 
iter: 1  value: 763.8744 mgc: 0.05322481 ustep: 1 
iter: 2  value: 763.8744 mgc: 8.218968e-06 ustep: 1 
iter: 3  mgc: 4.409806e-13 
outer mgc:  0.1479411 
iter: 1  value: 763.8752 mgc: 0.02903146 ustep: 1 
iter: 2  value: 763.8752 mgc: 2.875675e-06 ustep: 1 
iter: 3  mgc: 8.171241e-14 
outer mgc:  0.5214127 
iter: 1  value: 763.874 mgc: 0.0290278 ustep: 1 
iter: 2  value: 763.874 mgc: 2.879424e-06 ustep: 1 
iter: 3  mgc: 7.460699e-14 
outer mgc:  0.521472 
iter: 1  value: 763.8725 mgc: 0.003902234 ustep: 1 
iter: 2  value: 763.8725 mgc: 8.579451e-08 ustep: 1 
mgc: 4.751755e-14 
outer mgc:  0.01954566 
iter: 1  value: 763.8762 mgc: 0.003899901 ustep: 1 
iter: 2  value: 763.8762 mgc: 8.571881e-08 ustep: 1 
mgc: 4.374279e-14 
outer mgc:  0.01957405 
iter: 1  value: 763.8794 mgc: 0.01018307 ustep: 1 
iter: 2  value: 763.8794 mgc: 9.86914e-07 ustep: 1 
iter: 3  mgc: 4.32987e-14 
outer mgc:  0.2006016 
iter: 1  value: 763.8695 mgc: 0.01020594 ustep: 1 
iter: 2  value: 763.8695 mgc: 9.921624e-07 ustep: 1 
iter: 3  mgc: 5.52336e-14 
outer mgc:  0.2008218 
iter: 1  value: 763.8784 mgc: 0.01034813 ustep: 1 
iter: 2  value: 763.8784 mgc: 8.62623e-07 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.2046613 
iter: 1  value: 763.8705 mgc: 0.01037458 ustep: 1 
iter: 2  value: 763.8705 mgc: 8.666141e-07 ustep: 1 
iter: 3  mgc: 3.830269e-14 
outer mgc:  0.2051499 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:06:11 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 21:46:44 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21873.370667 
final  value 21548.797208 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 21789.89 mgc: 3.271817 ustep: 0.8994163 
iter: 2  value: 21782.67 mgc: 2.302918 ustep: 0.9483808 
iter: 3  value: 21737.66 mgc: 4.514841 ustep: 0.8382098 
iter: 4  value: 21731.8 mgc: 2.607299 ustep: 0.7093201 
iter: 5  value: 21730.7 mgc: 1.425682 ustep: 0.8422272 
iter: 6  value: 21730.69 mgc: 0.1444539 ustep: 0.9177376 
iter: 7  value: 21730.69 mgc: 0.007703954 ustep: 0.9579904 
iter: 8  value: 21730.69 mgc: 0.0001861874 ustep: 0.978772 
iter: 9  value: 21730.69 mgc: 2.61127e-06 ustep: 0.9893301 
iter: 10  value: 21730.69 mgc: 2.05064e-08 ustep: 0.9946513 
iter: 11  mgc: 8.476342e-11 
iter: 1  mgc: 8.476342e-11 
Matching hessian patterns... Done
outer mgc:  176.9191 
iter: 1  value: 21482.13 mgc: 0.9829324 ustep: 1 
iter: 2  value: 21482.12 mgc: 0.0771256 ustep: 1 
iter: 3  value: 21482.12 mgc: 0.0004310339 ustep: 1 
iter: 4  value: 21482.12 mgc: 1.827382e-08 ustep: 1 
iter: 5  mgc: 3.443426e-15 
iter: 1  value: 20978.97 mgc: 11.70721 ustep: 1 
iter: 2  value: 20978.17 mgc: 1.149558 ustep: 1 
iter: 3  value: 20978.17 mgc: 0.00868866 ustep: 1 
iter: 4  value: 20978.17 mgc: 2.177195e-07 ustep: 1 
iter: 5  mgc: 6.394885e-14 
iter: 1  mgc: 6.394885e-14 
outer mgc:  92.2228 
iter: 1  value: 24977.47 mgc: 95.58709 ustep: 1 
iter: 2  value: 24908.46 mgc: 16.63872 ustep: 1 
iter: 3  value: 24907.79 mgc: 2.836998 ustep: 1 
iter: 4  value: 24907.79 mgc: 0.1700912 ustep: 1 
iter: 5  value: 24907.79 mgc: 1.00255e-05 ustep: 1 
iter: 6  mgc: 9.80549e-13 
iter: 1  value: 20963.63 mgc: 7.683825 ustep: 1 
iter: 2  value: 20963.62 mgc: 0.1345469 ustep: 1 
iter: 3  value: 20963.62 mgc: 9.848643e-05 ustep: 1 
iter: 4  mgc: 8.737633e-11 
iter: 1  mgc: 8.737633e-11 
outer mgc:  109.9123 
iter: 1  value: 21029.19 mgc: 10.03993 ustep: 1 
iter: 2  value: 21029.03 mgc: 0.4105039 ustep: 1 
iter: 3  value: 21029.03 mgc: 0.001894315 ustep: 1 
iter: 4  value: 21029.03 mgc: 2.136158e-08 ustep: 1 
mgc: 6.750156e-14 
iter: 1  value: 20955.4 mgc: 2.145729 ustep: 1 
iter: 2  value: 20955.4 mgc: 0.01561798 ustep: 1 
iter: 3  value: 20955.4 mgc: 3.717845e-06 ustep: 1 
iter: 4  mgc: 1.647571e-13 
iter: 1  mgc: 1.647571e-13 
outer mgc:  33.83759 
iter: 1  value: 20949.91 mgc: 0.9645826 ustep: 1 
iter: 2  value: 20949.91 mgc: 0.003531012 ustep: 1 
iter: 3  value: 20949.91 mgc: 5.035458e-07 ustep: 1 
iter: 4  mgc: 6.350476e-14 
iter: 1  mgc: 6.350476e-14 
outer mgc:  29.88596 
iter: 1  value: 20946.07 mgc: 1.785937 ustep: 1 
iter: 2  value: 20946.06 mgc: 0.01293672 ustep: 1 
iter: 3  value: 20946.06 mgc: 1.781468e-06 ustep: 1 
iter: 4  mgc: 7.294165e-14 
iter: 1  mgc: 7.294165e-14 
outer mgc:  56.74774 
iter: 1  value: 20941.04 mgc: 2.240124 ustep: 1 
iter: 2  value: 20941.04 mgc: 0.006863867 ustep: 1 
iter: 3  value: 20941.04 mgc: 1.921536e-07 ustep: 1 
iter: 4  mgc: 5.440093e-14 
iter: 1  mgc: 5.440093e-14 
outer mgc:  16.06423 
iter: 1  value: 20936.27 mgc: 1.545098 ustep: 1 
iter: 2  value: 20936.27 mgc: 0.006094232 ustep: 1 
iter: 3  value: 20936.27 mgc: 1.66546e-07 ustep: 1 
iter: 4  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  19.78233 
iter: 1  value: 20931.96 mgc: 2.040549 ustep: 1 
iter: 2  value: 20931.96 mgc: 0.004706743 ustep: 1 
iter: 3  value: 20931.96 mgc: 3.283008e-07 ustep: 1 
iter: 4  mgc: 8.648637e-14 
iter: 1  mgc: 8.648637e-14 
outer mgc:  18.3055 
iter: 1  value: 20929.25 mgc: 1.464477 ustep: 1 
iter: 2  value: 20929.25 mgc: 0.002631094 ustep: 1 
iter: 3  value: 20929.25 mgc: 8.61122e-08 ustep: 1 
iter: 4  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  7.56245 
iter: 1  value: 20926.55 mgc: 0.9617661 ustep: 1 
iter: 2  value: 20926.55 mgc: 0.004155598 ustep: 1 
iter: 3  value: 20926.55 mgc: 1.154069e-07 ustep: 1 
iter: 4  mgc: 1.052491e-13 
iter: 1  mgc: 1.052491e-13 
outer mgc:  12.97891 
iter: 1  value: 20924.67 mgc: 3.54768 ustep: 1 
iter: 2  value: 20924.67 mgc: 0.07490117 ustep: 1 
iter: 3  value: 20924.67 mgc: 5.10493e-05 ustep: 1 
iter: 4  mgc: 2.022826e-11 
iter: 1  value: 20925.9 mgc: 0.9971367 ustep: 1 
iter: 2  value: 20925.9 mgc: 0.003211084 ustep: 1 
iter: 3  value: 20925.9 mgc: 6.145497e-08 ustep: 1 
mgc: 7.338574e-14 
iter: 1  value: 20926.11 mgc: 0.4455043 ustep: 1 
iter: 2  value: 20926.11 mgc: 0.0004980769 ustep: 1 
iter: 3  mgc: 1.583261e-09 
iter: 1  mgc: 1.583261e-09 
outer mgc:  10.40427 
iter: 1  value: 20925.79 mgc: 0.3733082 ustep: 1 
iter: 2  value: 20925.79 mgc: 0.0003774815 ustep: 1 
iter: 3  mgc: 4.397549e-10 
iter: 1  mgc: 4.397549e-10 
outer mgc:  9.635972 
iter: 1  value: 20925.04 mgc: 0.478962 ustep: 1 
iter: 2  value: 20925.04 mgc: 0.001552399 ustep: 1 
iter: 3  value: 20925.04 mgc: 1.676105e-08 ustep: 1 
mgc: 6.505907e-14 
iter: 1  mgc: 6.505907e-14 
outer mgc:  6.334833 
iter: 1  value: 20924.63 mgc: 0.4811199 ustep: 1 
iter: 2  value: 20924.63 mgc: 0.0005993442 ustep: 1 
iter: 3  mgc: 1.123537e-09 
iter: 1  mgc: 1.123537e-09 
outer mgc:  6.16818 
iter: 1  value: 20923.65 mgc: 0.8047248 ustep: 1 
iter: 2  value: 20923.65 mgc: 0.0009101753 ustep: 1 
iter: 3  value: 20923.65 mgc: 2.872853e-08 ustep: 1 
mgc: 5.92304e-14 
iter: 1  mgc: 5.92304e-14 
outer mgc:  8.372686 
iter: 1  value: 20922.16 mgc: 0.9122203 ustep: 1 
iter: 2  value: 20922.16 mgc: 0.001150484 ustep: 1 
iter: 3  value: 20922.16 mgc: 1.442245e-08 ustep: 1 
mgc: 6.650236e-14 
iter: 1  mgc: 6.650236e-14 
outer mgc:  5.539306 
iter: 1  value: 20921.07 mgc: 0.6531707 ustep: 1 
iter: 2  value: 20921.07 mgc: 0.002087172 ustep: 1 
iter: 3  mgc: 6.03136e-09 
iter: 1  mgc: 6.03136e-09 
outer mgc:  14.61735 
iter: 1  value: 20920.63 mgc: 1.455472 ustep: 1 
iter: 2  value: 20920.63 mgc: 0.005265558 ustep: 1 
iter: 3  value: 20920.63 mgc: 1.369385e-07 ustep: 1 
iter: 4  mgc: 7.904788e-14 
iter: 1  mgc: 7.904788e-14 
outer mgc:  14.18646 
iter: 1  value: 20918.94 mgc: 0.7202088 ustep: 1 
iter: 2  value: 20918.94 mgc: 0.001617378 ustep: 1 
iter: 3  value: 20918.94 mgc: 2.586662e-08 ustep: 1 
mgc: 7.638334e-14 
iter: 1  mgc: 7.638334e-14 
outer mgc:  3.233036 
iter: 1  value: 20916.97 mgc: 1.698864 ustep: 1 
iter: 2  value: 20916.97 mgc: 0.004108652 ustep: 1 
iter: 3  value: 20916.97 mgc: 9.441785e-08 ustep: 1 
iter: 4  mgc: 7.727152e-14 
iter: 1  value: 20918.02 mgc: 0.7077832 ustep: 1 
iter: 2  value: 20918.02 mgc: 0.0007467392 ustep: 1 
iter: 3  mgc: 3.028699e-09 
iter: 1  mgc: 3.028699e-09 
outer mgc:  2.749751 
iter: 1  value: 20917.74 mgc: 0.5546809 ustep: 1 
iter: 2  value: 20917.74 mgc: 0.0004588148 ustep: 1 
iter: 3  mgc: 1.730699e-09 
iter: 1  mgc: 1.730699e-09 
outer mgc:  10.90217 
iter: 1  value: 20917.72 mgc: 0.3393801 ustep: 1 
iter: 2  value: 20917.72 mgc: 0.0001606084 ustep: 1 
iter: 3  mgc: 2.152419e-10 
iter: 1  mgc: 2.152419e-10 
outer mgc:  2.623203 
iter: 1  value: 20917.14 mgc: 0.2835738 ustep: 1 
iter: 2  value: 20917.14 mgc: 6.624496e-05 ustep: 1 
iter: 3  mgc: 7.022649e-11 
iter: 1  value: 20916.48 mgc: 0.2440825 ustep: 1 
iter: 2  value: 20916.48 mgc: 8.11112e-05 ustep: 1 
iter: 3  mgc: 7.084822e-11 
iter: 1  value: 20914.55 mgc: 0.7545625 ustep: 1 
iter: 2  value: 20914.55 mgc: 0.0007057307 ustep: 1 
iter: 3  mgc: 5.563262e-09 
iter: 1  mgc: 5.563262e-09 
outer mgc:  3.892453 
iter: 1  value: 20913.18 mgc: 0.7807652 ustep: 1 
iter: 2  value: 20913.18 mgc: 0.001915915 ustep: 1 
iter: 3  value: 20913.18 mgc: 6.926275e-08 ustep: 1 
iter: 4  mgc: 7.222001e-14 
iter: 1  mgc: 7.222001e-14 
outer mgc:  9.603274 
iter: 1  value: 20905.92 mgc: 2.083647 ustep: 1 
iter: 2  value: 20905.92 mgc: 0.007033142 ustep: 1 
iter: 3  value: 20905.92 mgc: 7.509435e-07 ustep: 1 
iter: 4  mgc: 7.355228e-14 
iter: 1  mgc: 7.355228e-14 
outer mgc:  8.494437 
iter: 1  value: 20905.4 mgc: 1.548278 ustep: 1 
iter: 2  value: 20905.4 mgc: 0.00580742 ustep: 1 
iter: 3  value: 20905.4 mgc: 4.494868e-07 ustep: 1 
iter: 4  mgc: 9.614531e-14 
iter: 1  value: 20905.7 mgc: 0.6798414 ustep: 1 
iter: 2  value: 20905.7 mgc: 0.00186718 ustep: 1 
iter: 3  value: 20905.7 mgc: 1.923463e-08 ustep: 1 
mgc: 9.769963e-14 
iter: 1  mgc: 9.769963e-14 
outer mgc:  2.800714 
iter: 1  value: 20905.93 mgc: 1.780571 ustep: 1 
iter: 2  value: 20905.93 mgc: 0.006895347 ustep: 1 
iter: 3  value: 20905.93 mgc: 7.040974e-07 ustep: 1 
iter: 4  mgc: 9.681145e-14 
iter: 1  value: 20906.16 mgc: 0.8523111 ustep: 1 
iter: 2  value: 20906.16 mgc: 0.002155823 ustep: 1 
iter: 3  value: 20906.16 mgc: 2.772105e-08 ustep: 1 
mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
outer mgc:  7.009338 
iter: 1  value: 20906.18 mgc: 0.4066135 ustep: 1 
iter: 2  value: 20906.18 mgc: 0.0001992661 ustep: 1 
iter: 3  mgc: 2.736744e-10 
iter: 1  mgc: 2.736744e-10 
outer mgc:  10.04912 
iter: 1  value: 20906.37 mgc: 0.2824781 ustep: 1 
iter: 2  value: 20906.37 mgc: 9.155695e-05 ustep: 1 
iter: 3  mgc: 2.635758e-11 
iter: 1  mgc: 2.635758e-11 
outer mgc:  1.886496 
iter: 1  value: 20905.61 mgc: 0.7805744 ustep: 1 
iter: 2  value: 20905.61 mgc: 0.001271192 ustep: 1 
iter: 3  value: 20905.61 mgc: 1.086461e-08 ustep: 1 
mgc: 7.582823e-14 
iter: 1  mgc: 7.582823e-14 
outer mgc:  2.802791 
iter: 1  value: 20905.49 mgc: 0.4043213 ustep: 1 
iter: 2  value: 20905.49 mgc: 0.0003115141 ustep: 1 
iter: 3  mgc: 5.881824e-10 
iter: 1  mgc: 5.881824e-10 
outer mgc:  1.740216 
iter: 1  value: 20905.42 mgc: 0.1158195 ustep: 1 
iter: 2  value: 20905.42 mgc: 4.16184e-06 ustep: 1 
iter: 3  mgc: 4.618528e-13 
iter: 1  value: 20905.29 mgc: 0.1307326 ustep: 1 
iter: 2  value: 20905.29 mgc: 2.08162e-05 ustep: 1 
iter: 3  mgc: 5.211831e-12 
iter: 1  value: 20905.02 mgc: 0.3166506 ustep: 1 
iter: 2  value: 20905.02 mgc: 7.937896e-05 ustep: 1 
iter: 3  mgc: 7.281642e-11 
iter: 1  mgc: 7.281642e-11 
outer mgc:  2.30698 
iter: 1  value: 20903.51 mgc: 0.3726418 ustep: 1 
iter: 2  value: 20903.51 mgc: 0.0002131325 ustep: 1 
iter: 3  mgc: 1.122116e-09 
iter: 1  mgc: 1.122116e-09 
outer mgc:  0.7642493 
iter: 1  value: 20902.51 mgc: 0.3720664 ustep: 1 
iter: 2  value: 20902.51 mgc: 0.000148043 ustep: 1 
iter: 3  mgc: 1.238885e-10 
iter: 1  mgc: 1.238885e-10 
outer mgc:  0.3324169 
iter: 1  value: 20902.29 mgc: 0.1409002 ustep: 1 
iter: 2  value: 20902.29 mgc: 1.565773e-05 ustep: 1 
iter: 3  mgc: 1.270095e-12 
iter: 1  mgc: 1.270095e-12 
outer mgc:  0.5304834 
iter: 1  value: 20902.38 mgc: 0.07934631 ustep: 1 
iter: 2  value: 20902.38 mgc: 7.200707e-06 ustep: 1 
iter: 3  mgc: 7.531753e-13 
iter: 1  mgc: 7.531753e-13 
outer mgc:  0.2641144 
iter: 1  value: 20902.38 mgc: 0.01244835 ustep: 1 
iter: 2  value: 20902.38 mgc: 4.637216e-07 ustep: 1 
iter: 3  mgc: 6.927792e-14 
iter: 1  mgc: 6.927792e-14 
outer mgc:  0.04574803 
iter: 1  value: 20902.38 mgc: 0.006370087 ustep: 1 
iter: 2  value: 20902.38 mgc: 1.437246e-08 ustep: 1 
mgc: 9.547918e-14 
iter: 1  mgc: 9.547918e-14 
outer mgc:  0.013357 
iter: 1  value: 20902.38 mgc: 0.0009603394 ustep: 1 
iter: 2  mgc: 1.265725e-09 
iter: 1  mgc: 1.265725e-09 
outer mgc:  0.002043078 
iter: 1  mgc: 1.265725e-09 
iter: 1  mgc: 1.265725e-09 
outer mgc:  0.002043078 
iter: 1  value: 20902.37 mgc: 0.02520113 ustep: 1 
iter: 2  value: 20902.37 mgc: 2.23961e-06 ustep: 1 
iter: 3  mgc: 8.304468e-14 
outer mgc:  1.138999 
iter: 1  value: 20902.38 mgc: 0.02519383 ustep: 1 
iter: 2  value: 20902.38 mgc: 2.240471e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
outer mgc:  1.134844 
iter: 1  value: 20902.37 mgc: 0.01288794 ustep: 1 
iter: 2  value: 20902.37 mgc: 5.951613e-07 ustep: 1 
iter: 3  mgc: 9.148238e-14 
outer mgc:  0.8032326 
iter: 1  value: 20902.38 mgc: 0.01288301 ustep: 1 
iter: 2  value: 20902.38 mgc: 5.950055e-07 ustep: 1 
iter: 3  mgc: 9.792167e-14 
outer mgc:  0.8017677 
iter: 1  value: 20902.39 mgc: 0.02756811 ustep: 1 
iter: 2  value: 20902.39 mgc: 1.153726e-06 ustep: 1 
iter: 3  mgc: 9.792167e-14 
outer mgc:  1.486365 
iter: 1  value: 20902.37 mgc: 0.02756309 ustep: 1 
iter: 2  value: 20902.37 mgc: 1.154346e-06 ustep: 1 
iter: 3  mgc: 8.526513e-14 
outer mgc:  1.490419 
iter: 1  value: 20902.38 mgc: 0.01397626 ustep: 1 
iter: 2  value: 20902.38 mgc: 3.308965e-07 ustep: 1 
iter: 3  mgc: 7.904788e-14 
outer mgc:  0.9804141 
iter: 1  value: 20902.37 mgc: 0.01397353 ustep: 1 
iter: 2  value: 20902.37 mgc: 3.307794e-07 ustep: 1 
iter: 3  mgc: 8.504308e-14 
outer mgc:  0.9826398 
iter: 1  value: 20902.41 mgc: 0.04865539 ustep: 1 
iter: 2  value: 20902.41 mgc: 4.221578e-06 ustep: 1 
iter: 3  mgc: 8.65974e-14 
outer mgc:  0.3196163 
iter: 1  value: 20902.34 mgc: 0.04870407 ustep: 1 
iter: 2  value: 20902.34 mgc: 4.229413e-06 ustep: 1 
iter: 3  mgc: 7.771561e-14 
outer mgc:  0.3193546 
iter: 1  value: 20902.43 mgc: 0.05226905 ustep: 1 
iter: 2  value: 20902.43 mgc: 2.922435e-06 ustep: 1 
iter: 3  mgc: 1.580958e-13 
outer mgc:  0.2883816 
iter: 1  value: 20902.33 mgc: 0.05241462 ustep: 1 
iter: 2  value: 20902.33 mgc: 2.928954e-06 ustep: 1 
iter: 3  mgc: 1.900702e-13 
outer mgc:  0.2880351 
iter: 1  value: 20902.36 mgc: 0.006495159 ustep: 1 
iter: 2  value: 20902.36 mgc: 2.245325e-08 ustep: 1 
mgc: 8.348877e-14 
outer mgc:  0.003158901 
iter: 1  value: 20902.4 mgc: 0.006493065 ustep: 1 
iter: 2  value: 20902.4 mgc: 2.247364e-08 ustep: 1 
mgc: 8.321122e-14 
outer mgc:  0.003303308 
iter: 1  value: 20902.35 mgc: 0.006224943 ustep: 1 
iter: 2  value: 20902.35 mgc: 7.466778e-08 ustep: 1 
iter: 3  mgc: 8.348877e-14 
outer mgc:  0.03033149 
iter: 1  value: 20902.4 mgc: 0.00622505 ustep: 1 
iter: 2  value: 20902.4 mgc: 7.473444e-08 ustep: 1 
iter: 3  mgc: 7.460699e-14 
outer mgc:  0.03031671 
[Sat Aug 14 21:46:47 2021]
Finished job 0.
1 of 1 steps (100%) done

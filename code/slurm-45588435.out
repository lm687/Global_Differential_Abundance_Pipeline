Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:41:26 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10869.669984 
final  value 10556.271227 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 10583.62 mgc: 3.729999 ustep: 0.6827823 
iter: 2  value: 10575.42 mgc: 2.236246 ustep: 0.8263238 
iter: 3  value: 10573.17 mgc: 2.355501 ustep: 0.6983222 
iter: 4  value: 10571.54 mgc: 1.409398 ustep: 0.8356732 
iter: 5  value: 10571.52 mgc: 0.247757 ustep: 0.9141602 
iter: 6  value: 10571.52 mgc: 0.01569147 ustep: 0.9561216 
iter: 7  value: 10571.52 mgc: 0.0004294889 ustep: 0.9778169 
iter: 8  value: 10571.52 mgc: 6.023422e-06 ustep: 0.9888474 
iter: 9  value: 10571.52 mgc: 4.468666e-08 ustep: 0.9944086 
iter: 10  mgc: 1.773062e-10 
iter: 1  mgc: 1.773062e-10 
Matching hessian patterns... Done
outer mgc:  86.39866 
iter: 1  value: 10450.27 mgc: 0.8768361 ustep: 1 
iter: 2  value: 10450.27 mgc: 0.04854896 ustep: 1 
iter: 3  value: 10450.27 mgc: 0.0002494688 ustep: 1 
iter: 4  mgc: 6.748316e-09 
iter: 1  value: 10234.89 mgc: 7.419445 ustep: 1 
iter: 2  value: 10234.87 mgc: 0.2128899 ustep: 1 
iter: 3  value: 10234.87 mgc: 0.0004608472 ustep: 1 
iter: 4  mgc: 1.410755e-09 
iter: 1  mgc: 1.410755e-09 
outer mgc:  97.69451 
iter: 1  value: 12530.74 mgc: 33.44068 ustep: 0.09154103 
iter: 2  value: 12087.85 mgc: 22.71957 ustep: 0.07299565 
iter: 3  value: 11640.19 mgc: 23.23323 ustep: 0.08686945 
iter: 4  value: 11345.14 mgc: 17.28571 ustep: 0.1150847 
iter: 5  value: 11240.35 mgc: 13.99964 ustep: 0.1615232 
iter: 6  value: 11197.12 mgc: 26.85149 ustep: 0.2064881 
iter: 7  value: 11187.27 mgc: 6.881463 ustep: 0.1714342 
iter: 8  value: 11177.98 mgc: 4.956315 ustep: 0.2087153 
iter: 9  value: 11170.14 mgc: 16.50895 ustep: 0.4569081 
iter: 10  value: 11168.75 mgc: 2.780411 ustep: 0.6759821 
iter: 11  value: 11168.33 mgc: 0.5634245 ustep: 0.8221991 
iter: 12  value: 11168.27 mgc: 0.2091617 ustep: 0.9067613 
iter: 13  value: 11168.27 mgc: 0.04616952 ustep: 0.9522449 
iter: 14  value: 11168.27 mgc: 0.005659503 ustep: 0.9758328 
iter: 15  value: 11168.27 mgc: 0.0003665597 ustep: 0.9878437 
iter: 16  value: 11168.27 mgc: 1.219314e-05 ustep: 0.9939039 
iter: 17  value: 11168.27 mgc: 2.055143e-07 ustep: 0.9969476 
iter: 18  mgc: 1.743741e-09 
iter: 1  value: 10261.86 mgc: 13.28535 ustep: 1 
iter: 2  value: 10258.93 mgc: 2.426032 ustep: 1 
iter: 3  value: 10258.93 mgc: 0.06635646 ustep: 1 
iter: 4  value: 10258.93 mgc: 6.381061e-05 ustep: 1 
iter: 5  mgc: 6.10898e-11 
iter: 1  value: 10225.35 mgc: 5.749229 ustep: 1 
iter: 2  value: 10225.33 mgc: 0.1961236 ustep: 1 
iter: 3  value: 10225.33 mgc: 0.0003865719 ustep: 1 
iter: 4  mgc: 1.569335e-09 
iter: 1  mgc: 1.569335e-09 
outer mgc:  68.19219 
iter: 1  value: 10220.02 mgc: 5.361755 ustep: 1 
iter: 2  value: 10220.01 mgc: 0.1804062 ustep: 1 
iter: 3  value: 10220.01 mgc: 0.0001524196 ustep: 1 
iter: 4  mgc: 1.067253e-10 
iter: 1  mgc: 1.067253e-10 
outer mgc:  78.15587 
iter: 1  value: 10210.54 mgc: 5.555648 ustep: 1 
iter: 2  value: 10210.5 mgc: 0.2821116 ustep: 1 
iter: 3  value: 10210.5 mgc: 0.0008024956 ustep: 1 
iter: 4  mgc: 6.288379e-09 
iter: 1  mgc: 6.288379e-09 
outer mgc:  40.00862 
iter: 1  value: 10202.88 mgc: 3.557108 ustep: 1 
iter: 2  value: 10202.88 mgc: 0.0934798 ustep: 1 
iter: 3  value: 10202.88 mgc: 0.0001653346 ustep: 1 
iter: 4  mgc: 4.987066e-10 
iter: 1  mgc: 4.987066e-10 
outer mgc:  36.35734 
iter: 1  value: 10194.32 mgc: 9.757898 ustep: 1 
iter: 2  value: 10194.25 mgc: 0.705052 ustep: 1 
iter: 3  value: 10194.25 mgc: 0.003389489 ustep: 1 
iter: 4  value: 10194.25 mgc: 1.210741e-07 ustep: 1 
mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  56.40566 
iter: 1  value: 10187.08 mgc: 7.907029 ustep: 1 
iter: 2  value: 10187.08 mgc: 0.2469719 ustep: 1 
iter: 3  value: 10187.08 mgc: 0.0004508156 ustep: 1 
iter: 4  mgc: 1.622747e-09 
iter: 1  mgc: 1.622747e-09 
outer mgc:  43.80801 
iter: 1  value: 10190.67 mgc: 2.852436 ustep: 1 
iter: 2  value: 10190.67 mgc: 0.03086051 ustep: 1 
iter: 3  value: 10190.67 mgc: 4.87056e-06 ustep: 1 
iter: 4  mgc: 1.438849e-13 
iter: 1  value: 10185.5 mgc: 1.945922 ustep: 1 
iter: 2  value: 10185.5 mgc: 0.01032992 ustep: 1 
iter: 3  value: 10185.5 mgc: 5.360775e-07 ustep: 1 
iter: 4  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  9.478763 
iter: 1  value: 10187.29 mgc: 0.9969329 ustep: 1 
iter: 2  value: 10187.29 mgc: 0.004225685 ustep: 1 
iter: 3  value: 10187.29 mgc: 6.101764e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  8.535087 
iter: 1  value: 10187.19 mgc: 0.5656147 ustep: 1 
iter: 2  value: 10187.19 mgc: 0.001750192 ustep: 1 
iter: 3  value: 10187.19 mgc: 2.089932e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  value: 10187.11 mgc: 0.2734373 ustep: 1 
iter: 2  value: 10187.11 mgc: 0.0004149415 ustep: 1 
iter: 3  mgc: 1.192971e-09 
iter: 1  mgc: 1.192971e-09 
outer mgc:  6.351038 
iter: 1  value: 10186.99 mgc: 0.5705587 ustep: 1 
iter: 2  value: 10186.99 mgc: 0.0007836609 ustep: 1 
iter: 3  mgc: 4.698766e-09 
iter: 1  value: 10187.04 mgc: 0.282403 ustep: 1 
iter: 2  value: 10187.04 mgc: 0.000182446 ustep: 1 
iter: 3  mgc: 3.027609e-10 
iter: 1  mgc: 3.027609e-10 
outer mgc:  3.549654 
iter: 1  value: 10186.9 mgc: 0.1796909 ustep: 1 
iter: 2  value: 10186.9 mgc: 0.0001496899 ustep: 1 
iter: 3  mgc: 2.045988e-10 
iter: 1  mgc: 2.045988e-10 
outer mgc:  3.12728 
iter: 1  value: 10186.45 mgc: 0.3211671 ustep: 1 
iter: 2  value: 10186.45 mgc: 0.0002939629 ustep: 1 
iter: 3  mgc: 5.45942e-10 
iter: 1  mgc: 5.45942e-10 
outer mgc:  1.275986 
iter: 1  value: 10186.28 mgc: 0.2652722 ustep: 1 
iter: 2  value: 10186.28 mgc: 0.0001513092 ustep: 1 
iter: 3  mgc: 2.197238e-10 
iter: 1  mgc: 2.197238e-10 
outer mgc:  0.8627291 
iter: 1  value: 10186.18 mgc: 0.1714574 ustep: 1 
iter: 2  value: 10186.18 mgc: 0.0002369509 ustep: 1 
iter: 3  mgc: 7.78772e-10 
iter: 1  mgc: 7.78772e-10 
outer mgc:  1.114497 
iter: 1  value: 10185.87 mgc: 0.547122 ustep: 1 
iter: 2  value: 10185.87 mgc: 0.001337032 ustep: 1 
iter: 3  value: 10185.87 mgc: 1.28963e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  2.945849 
iter: 1  value: 10185.6 mgc: 0.3781111 ustep: 1 
iter: 2  value: 10185.6 mgc: 0.0002721177 ustep: 1 
iter: 3  mgc: 8.974048e-10 
iter: 1  mgc: 8.974048e-10 
outer mgc:  2.969123 
iter: 1  value: 10185.46 mgc: 0.5219163 ustep: 1 
iter: 2  value: 10185.46 mgc: 0.0006319558 ustep: 1 
iter: 3  mgc: 3.052429e-09 
iter: 1  mgc: 3.052429e-09 
outer mgc:  0.6249089 
iter: 1  value: 10185.19 mgc: 0.2041423 ustep: 1 
iter: 2  value: 10185.19 mgc: 0.00013545 ustep: 1 
iter: 3  mgc: 3.245703e-10 
iter: 1  mgc: 3.245703e-10 
outer mgc:  1.810622 
iter: 1  value: 10185 mgc: 0.1729965 ustep: 1 
iter: 2  value: 10185 mgc: 9.003781e-05 ustep: 1 
iter: 3  mgc: 6.63789e-11 
iter: 1  mgc: 6.63789e-11 
outer mgc:  0.4377104 
iter: 1  value: 10184.67 mgc: 0.274514 ustep: 1 
iter: 2  value: 10184.67 mgc: 0.0003702615 ustep: 1 
iter: 3  mgc: 8.459597e-10 
iter: 1  mgc: 8.459597e-10 
outer mgc:  1.318069 
iter: 1  value: 10184.46 mgc: 0.1577881 ustep: 1 
iter: 2  value: 10184.46 mgc: 9.262627e-05 ustep: 1 
iter: 3  mgc: 5.77165e-11 
iter: 1  value: 10184.25 mgc: 0.1429803 ustep: 1 
iter: 2  value: 10184.25 mgc: 6.570711e-05 ustep: 1 
iter: 3  mgc: 3.338307e-11 
iter: 1  value: 10183.58 mgc: 0.4248081 ustep: 1 
iter: 2  value: 10183.58 mgc: 0.000606378 ustep: 1 
iter: 3  mgc: 2.630441e-09 
iter: 1  mgc: 2.630441e-09 
outer mgc:  0.776029 
iter: 1  value: 10180.61 mgc: 0.653846 ustep: 1 
iter: 2  value: 10180.61 mgc: 0.0007403434 ustep: 1 
iter: 3  mgc: 4.143272e-09 
iter: 1  value: 10182.81 mgc: 0.2530012 ustep: 1 
iter: 2  value: 10182.81 mgc: 0.0001300805 ustep: 1 
iter: 3  mgc: 1.645519e-10 
iter: 1  mgc: 1.645519e-10 
outer mgc:  0.9534913 
iter: 1  value: 10182.91 mgc: 0.2546162 ustep: 1 
iter: 2  value: 10182.91 mgc: 0.0002878998 ustep: 1 
iter: 3  mgc: 4.506662e-10 
iter: 1  mgc: 4.506662e-10 
outer mgc:  0.5922563 
iter: 1  value: 10182.48 mgc: 0.3671518 ustep: 1 
iter: 2  value: 10182.48 mgc: 0.0003444237 ustep: 1 
iter: 3  mgc: 8.456704e-10 
iter: 1  value: 10182.72 mgc: 0.186602 ustep: 1 
iter: 2  value: 10182.72 mgc: 8.028207e-05 ustep: 1 
iter: 3  mgc: 4.077938e-11 
iter: 1  value: 10182.83 mgc: 0.1105238 ustep: 1 
iter: 2  value: 10182.83 mgc: 2.564276e-05 ustep: 1 
iter: 3  mgc: 5.04663e-12 
iter: 1  value: 10182.9 mgc: 0.0553195 ustep: 1 
iter: 2  value: 10182.9 mgc: 6.639105e-06 ustep: 1 
iter: 3  mgc: 4.058975e-13 
iter: 1  mgc: 4.058975e-13 
outer mgc:  0.7548229 
iter: 1  value: 10182.89 mgc: 0.02872785 ustep: 1 
iter: 2  value: 10182.89 mgc: 1.421043e-06 ustep: 1 
iter: 3  mgc: 6.039613e-14 
iter: 1  mgc: 6.039613e-14 
outer mgc:  0.2153147 
iter: 1  value: 10182.85 mgc: 0.05599022 ustep: 1 
iter: 2  value: 10182.85 mgc: 6.509849e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
iter: 1  mgc: 9.503509e-14 
outer mgc:  0.3581961 
iter: 1  value: 10182.8 mgc: 0.05112754 ustep: 1 
iter: 2  value: 10182.8 mgc: 6.474044e-06 ustep: 1 
iter: 3  mgc: 2.78888e-13 
iter: 1  mgc: 2.78888e-13 
outer mgc:  0.0981249 
iter: 1  value: 10182.67 mgc: 0.05221929 ustep: 1 
iter: 2  value: 10182.67 mgc: 1.017197e-05 ustep: 1 
iter: 3  mgc: 6.279421e-13 
iter: 1  value: 10182.59 mgc: 0.05618512 ustep: 1 
iter: 2  value: 10182.59 mgc: 1.028723e-05 ustep: 1 
iter: 3  mgc: 1.424694e-12 
iter: 1  value: 10182.32 mgc: 0.1151349 ustep: 1 
iter: 2  value: 10182.32 mgc: 3.600534e-05 ustep: 1 
iter: 3  mgc: 1.318157e-11 
iter: 1  mgc: 1.318157e-11 
outer mgc:  0.3478493 
iter: 1  value: 10181.79 mgc: 0.2665758 ustep: 1 
iter: 2  value: 10181.79 mgc: 0.0001271147 ustep: 1 
iter: 3  mgc: 1.232685e-10 
iter: 1  mgc: 1.232685e-10 
outer mgc:  0.2414405 
iter: 1  value: 10181.7 mgc: 0.3048221 ustep: 1 
iter: 2  value: 10181.7 mgc: 0.0002506361 ustep: 1 
iter: 3  mgc: 4.311191e-10 
iter: 1  value: 10181.78 mgc: 0.06520857 ustep: 1 
iter: 2  value: 10181.78 mgc: 1.06706e-05 ustep: 1 
iter: 3  mgc: 7.975842e-13 
iter: 1  mgc: 7.975842e-13 
outer mgc:  0.1818048 
iter: 1  value: 10181.86 mgc: 0.02353347 ustep: 1 
iter: 2  value: 10181.86 mgc: 1.577562e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  0.1874881 
iter: 1  value: 10181.85 mgc: 0.01818818 ustep: 1 
iter: 2  value: 10181.85 mgc: 2.977147e-06 ustep: 1 
iter: 3  mgc: 1.229017e-13 
iter: 1  mgc: 1.229017e-13 
outer mgc:  0.04702779 
iter: 1  value: 10181.83 mgc: 0.006930269 ustep: 1 
iter: 2  value: 10181.83 mgc: 2.468667e-07 ustep: 1 
iter: 3  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  0.009087068 
iter: 1  value: 10181.84 mgc: 0.001472615 ustep: 1 
iter: 2  value: 10181.84 mgc: 1.072136e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.004668993 
iter: 1  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.004668993 
iter: 1  value: 10181.84 mgc: 0.01909381 ustep: 1 
iter: 2  value: 10181.84 mgc: 1.143538e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.4707951 
iter: 1  value: 10181.84 mgc: 0.01908571 ustep: 1 
iter: 2  value: 10181.84 mgc: 1.144759e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.4613897 
iter: 1  value: 10181.84 mgc: 0.009878261 ustep: 1 
iter: 2  value: 10181.84 mgc: 3.299477e-07 ustep: 1 
iter: 3  mgc: 4.185541e-14 
outer mgc:  0.3241567 
iter: 1  value: 10181.84 mgc: 0.009872435 ustep: 1 
iter: 2  value: 10181.84 mgc: 3.300057e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.3212228 
iter: 1  value: 10181.84 mgc: 0.01950208 ustep: 1 
iter: 2  value: 10181.84 mgc: 1.595315e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.4013667 
iter: 1  value: 10181.84 mgc: 0.01949566 ustep: 1 
iter: 2  value: 10181.84 mgc: 1.597259e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.4077653 
iter: 1  value: 10181.84 mgc: 0.01040731 ustep: 1 
iter: 2  value: 10181.84 mgc: 4.919716e-07 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.3114207 
iter: 1  value: 10181.84 mgc: 0.01040575 ustep: 1 
iter: 2  value: 10181.84 mgc: 4.920054e-07 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.3150969 
iter: 1  value: 10181.86 mgc: 0.04200018 ustep: 1 
iter: 2  value: 10181.86 mgc: 4.128087e-06 ustep: 1 
iter: 3  mgc: 1.225686e-13 
outer mgc:  0.09147838 
iter: 1  value: 10181.81 mgc: 0.04211583 ustep: 1 
iter: 2  value: 10181.81 mgc: 4.132685e-06 ustep: 1 
iter: 3  mgc: 1.163514e-13 
outer mgc:  0.09271371 
iter: 1  value: 10181.86 mgc: 0.03253557 ustep: 1 
iter: 2  value: 10181.86 mgc: 2.676575e-06 ustep: 1 
iter: 3  mgc: 9.831025e-14 
outer mgc:  0.1017514 
iter: 1  value: 10181.82 mgc: 0.0326266 ustep: 1 
iter: 2  value: 10181.82 mgc: 2.68247e-06 ustep: 1 
iter: 3  mgc: 8.604228e-14 
outer mgc:  0.1005015 
iter: 1  value: 10181.83 mgc: 0.004372647 ustep: 1 
iter: 2  value: 10181.83 mgc: 3.74315e-08 ustep: 1 
mgc: 3.597123e-14 
outer mgc:  0.004583375 
iter: 1  value: 10181.85 mgc: 0.004370774 ustep: 1 
iter: 2  value: 10181.85 mgc: 3.748398e-08 ustep: 1 
mgc: 3.463896e-14 
outer mgc:  0.004754955 
iter: 1  value: 10181.82 mgc: 0.003688115 ustep: 1 
iter: 2  value: 10181.82 mgc: 8.50752e-08 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.02158209 
iter: 1  value: 10181.85 mgc: 0.003687566 ustep: 1 
iter: 2  value: 10181.85 mgc: 8.51074e-08 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.02236219 
[Sun Aug 15 23:41:29 2021]
Finished job 0.
1 of 1 steps (100%) done

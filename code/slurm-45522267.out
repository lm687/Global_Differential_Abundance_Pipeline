Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:16:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21847.003972 
final  value 20678.630850 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19833.4 mgc: 5.395605 ustep: 0.6827823 
iter: 2  value: 19826.13 mgc: 1.64341 ustep: 0.8263238 
iter: 3  value: 19826.05 mgc: 0.1250902 ustep: 0.9090326 
iter: 4  value: 19826.05 mgc: 0.007791643 ustep: 0.9534367 
iter: 5  value: 19826.05 mgc: 0.0003094901 ustep: 0.9764432 
iter: 6  value: 19826.05 mgc: 6.126352e-06 ustep: 0.9881526 
iter: 7  value: 19826.05 mgc: 6.058376e-08 ustep: 0.9940592 
iter: 8  mgc: 3.659985e-10 
iter: 1  mgc: 3.659985e-10 
Matching hessian patterns... Done
outer mgc:  127.0421 
iter: 1  value: 19631.18 mgc: 1.636381 ustep: 1 
iter: 2  value: 19631.05 mgc: 0.1641148 ustep: 1 
iter: 3  value: 19631.05 mgc: 0.001728625 ustep: 1 
iter: 4  value: 19631.05 mgc: 2.101234e-07 ustep: 1 
iter: 5  mgc: 4.024558e-15 
iter: 1  value: 19439.92 mgc: 8.515179 ustep: 1 
iter: 2  value: 19435.49 mgc: 2.712862 ustep: 1 
iter: 3  value: 19435.49 mgc: 0.1015722 ustep: 1 
iter: 4  value: 19435.49 mgc: 0.000177819 ustep: 1 
iter: 5  mgc: 6.437721e-10 
iter: 1  mgc: 6.437721e-10 
outer mgc:  134.5682 
iter: 1  value: 19587.01 mgc: 23.7765 ustep: 1 
iter: 2  value: 19586.81 mgc: 0.7415073 ustep: 1 
iter: 3  value: 19586.81 mgc: 0.004560764 ustep: 1 
iter: 4  value: 19586.81 mgc: 1.900706e-07 ustep: 1 
iter: 5  mgc: 3.552714e-15 
iter: 1  value: 19382.52 mgc: 5.548411 ustep: 1 
iter: 2  value: 19382.26 mgc: 0.5510779 ustep: 1 
iter: 3  value: 19382.26 mgc: 0.005246523 ustep: 1 
iter: 4  value: 19382.26 mgc: 5.270377e-07 ustep: 1 
iter: 5  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  85.4045 
iter: 1  value: 19539.15 mgc: 7.88235 ustep: 1 
iter: 2  value: 19538.65 mgc: 0.5442023 ustep: 1 
iter: 3  value: 19538.65 mgc: 0.002816317 ustep: 1 
iter: 4  value: 19538.65 mgc: 6.241529e-08 ustep: 1 
iter: 5  mgc: 6.217249e-15 
iter: 1  value: 19355.29 mgc: 2.038204 ustep: 1 
iter: 2  value: 19355.29 mgc: 0.02963557 ustep: 1 
iter: 3  value: 19355.29 mgc: 1.659644e-05 ustep: 1 
iter: 4  mgc: 2.719158e-12 
iter: 1  mgc: 2.719158e-12 
outer mgc:  26.88856 
iter: 1  value: 19329.3 mgc: 1.257178 ustep: 1 
iter: 2  value: 19329.3 mgc: 0.01716776 ustep: 1 
iter: 3  value: 19329.3 mgc: 3.680052e-06 ustep: 1 
iter: 4  mgc: 3.550493e-13 
iter: 1  value: 19259.89 mgc: 5.273104 ustep: 1 
iter: 2  value: 19259.89 mgc: 0.1172377 ustep: 1 
iter: 3  value: 19259.89 mgc: 9.464777e-05 ustep: 1 
iter: 4  mgc: 1.332197e-10 
iter: 1  mgc: 1.332197e-10 
outer mgc:  27.67614 
iter: 1  value: 19257.85 mgc: 10.16945 ustep: 1 
iter: 2  value: 19257.85 mgc: 0.1169469 ustep: 1 
iter: 3  value: 19257.85 mgc: 0.0001457271 ustep: 1 
iter: 4  mgc: 3.233778e-10 
iter: 1  value: 19258.24 mgc: 1.581874 ustep: 1 
iter: 2  value: 19258.24 mgc: 0.003346344 ustep: 1 
iter: 3  value: 19258.24 mgc: 6.951098e-08 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 19256.47 mgc: 0.5971371 ustep: 1 
iter: 2  value: 19256.47 mgc: 0.0005397883 ustep: 1 
iter: 3  mgc: 2.706691e-09 
iter: 1  mgc: 2.706691e-09 
outer mgc:  15.88236 
iter: 1  value: 19253.19 mgc: 0.6231338 ustep: 1 
iter: 2  value: 19253.19 mgc: 0.001051503 ustep: 1 
iter: 3  value: 19253.19 mgc: 1.355265e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  12.59076 
iter: 1  value: 19244.7 mgc: 1.020194 ustep: 1 
iter: 2  value: 19244.7 mgc: 0.003574255 ustep: 1 
iter: 3  value: 19244.7 mgc: 3.585433e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  value: 19249.61 mgc: 0.6079914 ustep: 1 
iter: 2  value: 19249.61 mgc: 0.0008204258 ustep: 1 
iter: 3  value: 19249.61 mgc: 1.449158e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  22.61746 
iter: 1  value: 19244.9 mgc: 0.6983706 ustep: 1 
iter: 2  value: 19244.9 mgc: 0.001847362 ustep: 1 
iter: 3  mgc: 6.542021e-09 
iter: 1  mgc: 6.542021e-09 
outer mgc:  6.213201 
iter: 1  value: 19238.53 mgc: 0.5898162 ustep: 1 
iter: 2  value: 19238.53 mgc: 0.002517674 ustep: 1 
iter: 3  value: 19238.53 mgc: 8.311645e-08 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  11.17655 
iter: 1  value: 19228.47 mgc: 1.052227 ustep: 1 
iter: 2  value: 19228.47 mgc: 0.007071264 ustep: 1 
iter: 3  value: 19228.47 mgc: 2.098592e-07 ustep: 1 
iter: 4  mgc: 5.662137e-15 
iter: 1  mgc: 5.662137e-15 
outer mgc:  9.670671 
iter: 1  value: 19221.67 mgc: 0.7724707 ustep: 1 
iter: 2  value: 19221.67 mgc: 0.002632872 ustep: 1 
iter: 3  value: 19221.67 mgc: 3.530672e-08 ustep: 1 
iter: 4  mgc: 5.662137e-15 
iter: 1  mgc: 5.662137e-15 
outer mgc:  8.989152 
iter: 1  value: 19219.73 mgc: 0.8694384 ustep: 1 
iter: 2  value: 19219.73 mgc: 0.002373696 ustep: 1 
iter: 3  value: 19219.73 mgc: 1.082941e-07 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  value: 19217.43 mgc: 0.3812722 ustep: 1 
iter: 2  value: 19217.43 mgc: 0.0007533709 ustep: 1 
iter: 3  mgc: 8.808398e-09 
iter: 1  mgc: 8.808398e-09 
outer mgc:  10.29971 
iter: 1  value: 19213.9 mgc: 0.5978056 ustep: 1 
iter: 2  value: 19213.9 mgc: 0.0009622487 ustep: 1 
iter: 3  mgc: 2.645956e-09 
iter: 1  value: 19216.22 mgc: 0.2672822 ustep: 1 
iter: 2  value: 19216.22 mgc: 5.583824e-05 ustep: 1 
iter: 3  mgc: 1.765721e-11 
iter: 1  mgc: 1.765721e-11 
outer mgc:  6.124216 
iter: 1  value: 19214 mgc: 0.1824146 ustep: 1 
iter: 2  value: 19214 mgc: 9.141002e-05 ustep: 1 
iter: 3  mgc: 1.607736e-10 
iter: 1  mgc: 1.607736e-10 
outer mgc:  3.662463 
iter: 1  value: 19210.14 mgc: 0.38234 ustep: 1 
iter: 2  value: 19210.14 mgc: 0.001689573 ustep: 1 
iter: 3  value: 19210.14 mgc: 2.475178e-08 ustep: 1 
mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  5.689508 
iter: 1  value: 19202.73 mgc: 0.2869466 ustep: 1 
iter: 2  value: 19202.73 mgc: 0.0005994941 ustep: 1 
iter: 3  mgc: 2.065696e-09 
iter: 1  mgc: 2.065696e-09 
outer mgc:  13.89528 
iter: 1  value: 19201.53 mgc: 0.5372199 ustep: 1 
iter: 2  value: 19201.53 mgc: 0.0002570551 ustep: 1 
iter: 3  mgc: 9.073071e-10 
iter: 1  value: 19201.86 mgc: 0.2678101 ustep: 1 
iter: 2  value: 19201.86 mgc: 6.36316e-05 ustep: 1 
iter: 3  mgc: 6.311041e-11 
iter: 1  mgc: 6.311041e-11 
outer mgc:  6.077763 
iter: 1  value: 19200.72 mgc: 0.2457223 ustep: 1 
iter: 2  value: 19200.72 mgc: 0.0002131798 ustep: 1 
iter: 3  mgc: 2.796279e-10 
iter: 1  mgc: 2.796279e-10 
outer mgc:  5.943497 
iter: 1  value: 19196.54 mgc: 0.2629628 ustep: 1 
iter: 2  value: 19196.54 mgc: 0.00088025 ustep: 1 
iter: 3  mgc: 5.969945e-09 
iter: 1  value: 19192.27 mgc: 0.3667357 ustep: 1 
iter: 2  value: 19192.27 mgc: 0.0009028092 ustep: 1 
iter: 3  mgc: 4.190686e-09 
iter: 1  value: 19175.18 mgc: 1.609095 ustep: 1 
iter: 2  value: 19175.18 mgc: 0.01185085 ustep: 1 
iter: 3  value: 19175.18 mgc: 4.912842e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  12.01692 
iter: 1  value: 19158.49 mgc: 2.072228 ustep: 1 
iter: 2  value: 19158.49 mgc: 0.0094693 ustep: 1 
iter: 3  value: 19158.49 mgc: 2.725207e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  7.853221 
iter: 1  value: 19148.66 mgc: 1.850122 ustep: 1 
iter: 2  value: 19148.66 mgc: 0.002292076 ustep: 1 
iter: 3  value: 19148.66 mgc: 1.561251e-08 ustep: 1 
mgc: 7.577272e-15 
iter: 1  mgc: 7.577272e-15 
outer mgc:  10.15909 
iter: 1  value: 19127.77 mgc: 1.323559 ustep: 1 
iter: 2  value: 19127.77 mgc: 0.001782619 ustep: 1 
iter: 3  mgc: 3.788973e-09 
iter: 1  mgc: 3.788973e-09 
outer mgc:  7.750738 
iter: 1  value: 19122.32 mgc: 1.859728 ustep: 1 
iter: 2  value: 19122.32 mgc: 0.0004665835 ustep: 1 
iter: 3  mgc: 6.286438e-11 
iter: 1  value: 19126.02 mgc: 0.3367692 ustep: 1 
iter: 2  value: 19126.02 mgc: 2.626088e-05 ustep: 1 
iter: 3  mgc: 1.936229e-13 
iter: 1  mgc: 1.936229e-13 
outer mgc:  5.36364 
iter: 1  value: 19119.27 mgc: 1.211686 ustep: 1 
iter: 2  value: 19119.27 mgc: 0.0003469247 ustep: 1 
iter: 3  mgc: 1.430767e-11 
iter: 1  mgc: 1.430767e-11 
outer mgc:  4.922054 
iter: 1  value: 19108.36 mgc: 0.6644029 ustep: 1 
iter: 2  value: 19108.36 mgc: 0.0004038353 ustep: 1 
iter: 3  mgc: 1.199778e-10 
iter: 1  value: 19090.66 mgc: 1.13815 ustep: 1 
iter: 2  value: 19090.66 mgc: 0.0007472049 ustep: 1 
iter: 3  mgc: 2.778053e-10 
iter: 1  mgc: 2.778053e-10 
outer mgc:  1.669198 
iter: 1  value: 19060.76 mgc: 2.147787 ustep: 1 
iter: 2  value: 19060.76 mgc: 0.00123197 ustep: 1 
iter: 3  mgc: 4.513305e-10 
iter: 1  mgc: 4.513305e-10 
outer mgc:  0.822413 
iter: 1  value: 18994.94 mgc: 5.362031 ustep: 1 
iter: 2  value: 18994.94 mgc: 0.001923115 ustep: 1 
iter: 3  mgc: 1.907559e-10 
iter: 1  value: 19047.6 mgc: 0.7726725 ustep: 1 
iter: 2  value: 19047.6 mgc: 0.0001477247 ustep: 1 
iter: 3  mgc: 4.335199e-12 
iter: 1  mgc: 4.335199e-12 
outer mgc:  2.225407 
iter: 1  value: 19033.89 mgc: 0.764738 ustep: 1 
iter: 2  value: 19033.89 mgc: 9.904713e-05 ustep: 1 
iter: 3  mgc: 1.331379e-12 
iter: 1  value: 19005.66 mgc: 1.673227 ustep: 1 
iter: 2  value: 19005.66 mgc: 0.0002534407 ustep: 1 
iter: 3  mgc: 4.511058e-12 
iter: 1  mgc: 4.511058e-12 
outer mgc:  0.696468 
iter: 1  value: 18963.42 mgc: 2.731529 ustep: 1 
iter: 2  value: 18963.42 mgc: 0.0002402331 ustep: 1 
iter: 3  mgc: 1.46283e-12 
iter: 1  mgc: 1.46283e-12 
outer mgc:  0.3718767 
iter: 1  value: 18906.16 mgc: 4.091352 ustep: 1 
iter: 2  value: 18906.16 mgc: 0.0001301452 ustep: 1 
iter: 3  mgc: 1.110223e-13 
iter: 1  mgc: 1.110223e-13 
outer mgc:  0.2915441 
iter: 1  value: 18849.12 mgc: 3.998035 ustep: 1 
iter: 2  value: 18849.12 mgc: 3.143056e-05 ustep: 1 
iter: 3  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.1440175 
iter: 1  value: 18789.52 mgc: 4.199119 ustep: 1 
iter: 2  value: 18789.52 mgc: 9.638606e-06 ustep: 1 
iter: 3  mgc: 5.606626e-15 
iter: 1  mgc: 5.606626e-15 
outer mgc:  0.1066155 
iter: 1  value: 18727.29 mgc: 4.420443 ustep: 1 
iter: 2  value: 18727.29 mgc: 4.193348e-06 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.05458617 
iter: 1  value: 18662.7 mgc: 4.644487 ustep: 1 
iter: 2  value: 18662.7 mgc: 1.746916e-06 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.04291251 
iter: 1  value: 18596.32 mgc: 4.837853 ustep: 1 
iter: 2  value: 18596.32 mgc: 7.163312e-07 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  0.02235834 
iter: 1  value: 18528.79 mgc: 4.999474 ustep: 1 
iter: 2  value: 18528.79 mgc: 2.813719e-07 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.01787046 
iter: 1  value: 18460.63 mgc: 5.133799 ustep: 1 
iter: 2  value: 18460.63 mgc: 1.035511e-07 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.009029105 
iter: 1  value: 18392.25 mgc: 5.255543 ustep: 1 
iter: 2  value: 18392.25 mgc: 3.632639e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.007205847 
iter: 1  value: 18323.91 mgc: 5.527626 ustep: 1 
iter: 2  value: 18323.91 mgc: 1.230299e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.003494934 
iter: 1  value: 18255.76 mgc: 6.265302 ustep: 1 
iter: 2  mgc: 4.067126e-09 
iter: 1  mgc: 4.067126e-09 
outer mgc:  0.002764344 
iter: 1  value: 18173.67 mgc: 9.707689 ustep: 1 
iter: 2  mgc: 1.740284e-09 
iter: 1  mgc: 1.740284e-09 
outer mgc:  0.001074264 
iter: 1  value: 18096.31 mgc: 10.42595 ustep: 1 
iter: 2  mgc: 4.127649e-10 
iter: 1  mgc: 4.127649e-10 
outer mgc:  0.0009497472 
iter: 1  value: 18019.4 mgc: 12.1614 ustep: 1 
iter: 2  mgc: 1.157181e-10 
iter: 1  mgc: 1.157181e-10 
outer mgc:  0.000264039 
iter: 1  value: 17942.93 mgc: 14.18897 ustep: 1 
iter: 2  mgc: 3.232792e-11 
iter: 1  mgc: 3.232792e-11 
outer mgc:  0.0003330387 
iter: 1  value: 17866.87 mgc: 16.5436 ustep: 1 
iter: 2  mgc: 8.984813e-12 
iter: 1  mgc: 8.984813e-12 
outer mgc:  4.334104e-05 
iter: 1  mgc: 8.984813e-12 
iter: 1  mgc: 8.984813e-12 
outer mgc:  4.334104e-05 
iter: 1  value: 17866.87 mgc: 0.005879167 ustep: 1 
iter: 2  mgc: 1.865175e-14 
outer mgc:  0.3962486 
iter: 1  value: 17866.87 mgc: 0.00587691 ustep: 1 
iter: 2  mgc: 2.620126e-14 
outer mgc:  0.3959387 
iter: 1  value: 17866.87 mgc: 0.003030581 ustep: 1 
mgc: 1.865175e-14 
outer mgc:  0.173031 
iter: 1  value: 17866.87 mgc: 0.003029258 ustep: 1 
mgc: 2.664535e-14 
outer mgc:  0.1728786 
iter: 1  value: 17866.87 mgc: 0.005554843 ustep: 1 
iter: 2  mgc: 2.575717e-14 
outer mgc:  0.5303495 
iter: 1  value: 17866.87 mgc: 0.005555556 ustep: 1 
iter: 2  mgc: 3.019807e-14 
outer mgc:  0.5303045 
iter: 1  value: 17866.87 mgc: 0.002773812 ustep: 1 
iter: 2  mgc: 3.774758e-14 
outer mgc:  0.2670835 
iter: 1  value: 17866.87 mgc: 0.002773345 ustep: 1 
iter: 2  mgc: 2.176037e-14 
outer mgc:  0.2670765 
iter: 1  value: 17866.97 mgc: 0.1126028 ustep: 1 
mgc: 4.041212e-14 
outer mgc:  4.338874e-05 
iter: 1  value: 17866.77 mgc: 0.1129317 ustep: 1 
mgc: 3.463896e-14 
outer mgc:  4.32934e-05 
iter: 1  value: 17866.97 mgc: 0.1033301 ustep: 1 
iter: 2  mgc: 2.4869e-14 
outer mgc:  4.35712e-05 
iter: 1  value: 17866.77 mgc: 0.1034335 ustep: 1 
iter: 2  mgc: 2.88658e-14 
outer mgc:  4.31113e-05 
iter: 1  value: 17866.9 mgc: 0.006313457 ustep: 1 
mgc: 1.731948e-14 
outer mgc:  4.333897e-05 
iter: 1  value: 17866.83 mgc: 0.006315862 ustep: 1 
mgc: 2.309264e-14 
outer mgc:  4.334311e-05 
iter: 1  value: 17866.87 mgc: 0.0049705 ustep: 1 
mgc: 2.620126e-14 
outer mgc:  0.1778582 
iter: 1  value: 17866.87 mgc: 0.004966848 ustep: 1 
mgc: 1.554312e-14 
outer mgc:  0.1778729 
[Fri Aug 13 12:16:53 2021]
Finished job 0.
1 of 1 steps (100%) done

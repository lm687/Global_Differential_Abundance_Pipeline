Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:18:13 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2284.014948 
iter  10 value 1475.161884
final  value 1462.138982 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2638.643 mgc: 94.84763 ustep: 1 
iter: 2  value: 2633.02 mgc: 6.412573 ustep: 1 
iter: 3  value: 2633.01 mgc: 0.409369 ustep: 1 
iter: 4  value: 2633.01 mgc: 0.002757758 ustep: 1 
iter: 5  value: 2633.01 mgc: 1.282139e-07 ustep: 1 
mgc: 2.242651e-14 
iter: 1  mgc: 2.242651e-14 
Matching hessian patterns... Done
outer mgc:  638.4207 
iter: 1  value: 1969.421 mgc: 29.32942 ustep: 1 
iter: 2  value: 1963.339 mgc: 10.2044 ustep: 1 
iter: 3  value: 1963.315 mgc: 0.7334668 ustep: 1 
iter: 4  value: 1963.315 mgc: 0.005111567 ustep: 1 
iter: 5  value: 1963.315 mgc: 2.585135e-07 ustep: 1 
iter: 6  mgc: 4.241052e-14 
iter: 1  value: 1135.059 mgc: 68.5177 ustep: 0.4367355 
iter: 2  value: 705.1389 mgc: 90.90738 ustep: 0.6608936 
iter: 3  value: 694.841 mgc: 21.26601 ustep: 0.8129723 
iter: 4  value: 694.6847 mgc: 2.949235 ustep: 0.9016596 
iter: 5  value: 694.6845 mgc: 0.07418767 ustep: 0.9495626 
iter: 6  value: 694.6845 mgc: 0.0002745908 ustep: 0.9744576 
iter: 7  value: 694.6845 mgc: 4.718649e-07 ustep: 0.9871475 
iter: 8  mgc: 4.797962e-10 
iter: 1  mgc: 4.797962e-10 
outer mgc:  282.3212 
iter: 1  value: 506.1854 mgc: 61.98012 ustep: 0.4367355 
iter: 2  value: 144.3704 mgc: 56.98251 ustep: 0.6608936 
iter: 3  value: 123.1967 mgc: 20.82077 ustep: 0.8129723 
iter: 4  value: 123.0705 mgc: 1.579571 ustep: 0.9016596 
iter: 5  value: 123.0705 mgc: 0.01691615 ustep: 0.9495626 
iter: 6  value: 123.0705 mgc: 5.312547e-05 ustep: 0.9744576 
iter: 7  value: 123.0705 mgc: 1.077396e-07 ustep: 0.9871475 
iter: 8  mgc: 1.578453e-10 
iter: 1  mgc: 1.578453e-10 
outer mgc:  10.68179 
iter: 1  value: 102.606 mgc: 263.641 ustep: 1 
iter: 2  value: 102.5669 mgc: 1.139761 ustep: 1 
iter: 3  value: 102.5669 mgc: 0.002561546 ustep: 1 
iter: 4  value: 102.5669 mgc: 1.268785e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  46.80515 
iter: 1  value: 505.5553 mgc: 185.7521 ustep: 1 
iter: 2  value: 503.9807 mgc: 5.115604 ustep: 1 
iter: 3  value: 503.9806 mgc: 0.04653117 ustep: 1 
iter: 4  value: 503.9806 mgc: 4.848817e-06 ustep: 1 
iter: 5  mgc: 9.237056e-14 
iter: 1  value: 96.3341 mgc: 13.29723 ustep: 1 
iter: 2  value: 96.33409 mgc: 0.01920755 ustep: 1 
iter: 3  value: 96.33409 mgc: 8.140661e-07 ustep: 1 
iter: 4  mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  15.60518 
iter: 1  value: 94.94237 mgc: 8.024609 ustep: 1 
iter: 2  value: 94.94234 mgc: 0.02149191 ustep: 1 
iter: 3  value: 94.94234 mgc: 1.068204e-06 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  13.75907 
iter: 1  value: 94.3993 mgc: 11.64306 ustep: 1 
iter: 2  value: 94.39879 mgc: 0.1129318 ustep: 1 
iter: 3  value: 94.39879 mgc: 7.493144e-05 ustep: 1 
iter: 4  mgc: 1.617373e-11 
iter: 1  mgc: 1.617373e-11 
outer mgc:  17.50326 
iter: 1  value: 95.19903 mgc: 11.06418 ustep: 1 
iter: 2  value: 95.1988 mgc: 0.1269444 ustep: 1 
iter: 3  value: 95.1988 mgc: 2.37776e-06 ustep: 1 
iter: 4  mgc: 6.350476e-14 
iter: 1  mgc: 6.350476e-14 
outer mgc:  13.72736 
iter: 1  value: 96.4845 mgc: 7.946962 ustep: 1 
iter: 2  value: 96.48408 mgc: 0.1171977 ustep: 1 
iter: 3  value: 96.48408 mgc: 3.402872e-05 ustep: 1 
iter: 4  mgc: 8.42082e-12 
iter: 1  mgc: 8.42082e-12 
outer mgc:  5.825575 
iter: 1  value: 96.14306 mgc: 8.94717 ustep: 1 
iter: 2  value: 96.14242 mgc: 0.1956071 ustep: 1 
iter: 3  value: 96.14242 mgc: 9.746637e-05 ustep: 1 
iter: 4  mgc: 1.975131e-11 
iter: 1  mgc: 1.975131e-11 
outer mgc:  5.130761 
iter: 1  value: 95.72184 mgc: 3.510568 ustep: 1 
iter: 2  value: 95.72141 mgc: 0.07060271 ustep: 1 
iter: 3  value: 95.72141 mgc: 2.44328e-05 ustep: 1 
iter: 4  mgc: 6.781686e-12 
iter: 1  mgc: 6.781686e-12 
outer mgc:  2.057941 
iter: 1  value: 97.01883 mgc: 11.29201 ustep: 1 
iter: 2  value: 96.99268 mgc: 0.3541194 ustep: 1 
iter: 3  value: 96.99268 mgc: 0.001072919 ustep: 1 
iter: 4  value: 96.99268 mgc: 1.855e-08 ustep: 1 
mgc: 1.731948e-14 
iter: 1  value: 95.68602 mgc: 2.818072 ustep: 1 
iter: 2  value: 95.68599 mgc: 0.01833197 ustep: 1 
iter: 3  value: 95.68599 mgc: 3.075332e-06 ustep: 1 
iter: 4  mgc: 1.483258e-13 
iter: 1  mgc: 1.483258e-13 
outer mgc:  2.147251 
iter: 1  value: 95.86987 mgc: 3.349895 ustep: 1 
iter: 2  value: 95.86981 mgc: 0.0229816 ustep: 1 
iter: 3  value: 95.86981 mgc: 2.235445e-06 ustep: 1 
iter: 4  mgc: 3.774758e-14 
iter: 1  value: 95.672 mgc: 1.597328 ustep: 1 
iter: 2  value: 95.67199 mgc: 0.002831304 ustep: 1 
iter: 3  value: 95.67199 mgc: 6.078278e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  2.456999 
iter: 1  value: 95.64053 mgc: 0.7245938 ustep: 1 
iter: 2  value: 95.64053 mgc: 0.0006993442 ustep: 1 
iter: 3  mgc: 4.317476e-09 
iter: 1  mgc: 4.317476e-09 
outer mgc:  0.2306751 
iter: 1  value: 95.60917 mgc: 0.6718418 ustep: 1 
iter: 2  value: 95.60917 mgc: 0.00196594 ustep: 1 
iter: 3  value: 95.60917 mgc: 2.485307e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  0.3551012 
iter: 1  value: 95.68803 mgc: 0.2946482 ustep: 1 
iter: 2  value: 95.68803 mgc: 0.0002636191 ustep: 1 
iter: 3  mgc: 3.187792e-10 
iter: 1  mgc: 3.187792e-10 
outer mgc:  0.2298993 
iter: 1  value: 95.67865 mgc: 0.1680562 ustep: 1 
iter: 2  value: 95.67865 mgc: 0.0002994447 ustep: 1 
iter: 3  mgc: 1.865376e-09 
iter: 1  mgc: 1.865376e-09 
outer mgc:  0.2086984 
iter: 1  value: 95.68498 mgc: 0.4418717 ustep: 1 
iter: 2  value: 95.68498 mgc: 0.0005857797 ustep: 1 
iter: 3  mgc: 2.455801e-09 
iter: 1  mgc: 2.455801e-09 
outer mgc:  0.1941233 
iter: 1  value: 95.73202 mgc: 0.2643518 ustep: 1 
iter: 2  value: 95.73202 mgc: 9.232499e-05 ustep: 1 
iter: 3  mgc: 2.933254e-11 
iter: 1  mgc: 2.933254e-11 
outer mgc:  0.05956796 
iter: 1  value: 95.70934 mgc: 0.1187984 ustep: 1 
iter: 2  value: 95.70934 mgc: 4.177668e-05 ustep: 1 
iter: 3  mgc: 3.896439e-12 
iter: 1  mgc: 3.896439e-12 
outer mgc:  0.01773071 
iter: 1  value: 95.71562 mgc: 0.03208391 ustep: 1 
iter: 2  value: 95.71562 mgc: 2.758468e-06 ustep: 1 
iter: 3  mgc: 2.065015e-14 
iter: 1  mgc: 2.065015e-14 
outer mgc:  0.0009404692 
iter: 1  value: 95.71559 mgc: 0.001595638 ustep: 1 
iter: 2  mgc: 7.220869e-09 
iter: 1  mgc: 7.220869e-09 
outer mgc:  0.000430955 
iter: 1  value: 95.7156 mgc: 0.0004671776 ustep: 1 
iter: 2  mgc: 6.449499e-10 
iter: 1  mgc: 6.449499e-10 
outer mgc:  1.895804e-06 
iter: 1  mgc: 6.449499e-10 
iter: 1  mgc: 6.449499e-10 
outer mgc:  1.895804e-06 
iter: 1  value: 95.71579 mgc: 0.0335496 ustep: 1 
iter: 2  value: 95.71579 mgc: 2.168292e-06 ustep: 1 
iter: 3  mgc: 3.841372e-14 
outer mgc:  0.06269182 
iter: 1  value: 95.71548 mgc: 0.03354634 ustep: 1 
iter: 2  value: 95.71548 mgc: 2.169516e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.06268826 
iter: 1  value: 95.71642 mgc: 0.0181811 ustep: 1 
iter: 2  value: 95.71642 mgc: 5.840926e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.0529524 
iter: 1  value: 95.71483 mgc: 0.01819187 ustep: 1 
iter: 2  value: 95.71483 mgc: 5.841466e-07 ustep: 1 
iter: 3  mgc: 2.609024e-14 
outer mgc:  0.05297702 
iter: 1  value: 95.71568 mgc: 0.03014185 ustep: 1 
iter: 2  value: 95.71568 mgc: 1.825212e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.08641329 
iter: 1  value: 95.71561 mgc: 0.03013565 ustep: 1 
iter: 2  value: 95.71561 mgc: 1.828895e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.08641349 
iter: 1  value: 95.71553 mgc: 0.001032954 ustep: 1 
iter: 2  mgc: 1.751241e-09 
outer mgc:  0.005841627 
iter: 1  value: 95.71568 mgc: 0.001031942 ustep: 1 
iter: 2  mgc: 1.747576e-09 
outer mgc:  0.005836127 
iter: 1  value: 95.7138 mgc: 0.006213941 ustep: 1 
iter: 2  value: 95.7138 mgc: 5.908522e-08 ustep: 1 
mgc: 2.309264e-14 
outer mgc:  0.002275458 
iter: 1  value: 95.7174 mgc: 0.006209868 ustep: 1 
iter: 2  value: 95.7174 mgc: 5.909286e-08 ustep: 1 
mgc: 2.930989e-14 
outer mgc:  0.002279224 
iter: 1  value: 95.71707 mgc: 0.01327464 ustep: 1 
iter: 2  value: 95.71707 mgc: 3.067862e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.02463471 
iter: 1  value: 95.71415 mgc: 0.01330983 ustep: 1 
iter: 2  value: 95.71415 mgc: 3.066818e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.024663 
iter: 1  value: 95.71912 mgc: 0.01511853 ustep: 1 
iter: 2  value: 95.71912 mgc: 9.308436e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.01841628 
iter: 1  value: 95.71209 mgc: 0.01515978 ustep: 1 
iter: 2  value: 95.71209 mgc: 9.329886e-07 ustep: 1 
iter: 3  mgc: 1.84297e-14 
outer mgc:  0.01841702 
[Sun Aug 15 20:18:15 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:54:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2151.082861 
iter  10 value 1374.087930
final  value 1374.087855 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1502.656 mgc: 4.167854 ustep: 0.8994163 
iter: 2  value: 1488.851 mgc: 2.836486 ustep: 0.772724 
iter: 3  value: 1481.043 mgc: 4.039903 ustep: 0.6521695 
iter: 4  value: 1480.607 mgc: 0.4948823 ustep: 0.8075894 
iter: 5  value: 1480.588 mgc: 0.07915806 ustep: 0.8986699 
iter: 6  value: 1480.587 mgc: 0.01954247 ustep: 0.9479872 
iter: 7  value: 1480.587 mgc: 0.002663379 ustep: 0.973649 
iter: 8  value: 1480.587 mgc: 0.0001941406 ustep: 0.9867379 
iter: 9  value: 1480.587 mgc: 7.3477e-06 ustep: 0.9933475 
iter: 10  value: 1480.587 mgc: 1.412257e-07 ustep: 0.9966685 
iter: 11  mgc: 1.367228e-09 
iter: 1  mgc: 1.367228e-09 
Matching hessian patterns... Done
outer mgc:  24.19445 
iter: 1  value: 1461.784 mgc: 1.156563 ustep: 1 
iter: 2  value: 1461.764 mgc: 0.1464245 ustep: 1 
iter: 3  value: 1461.764 mgc: 0.002529601 ustep: 1 
iter: 4  value: 1461.764 mgc: 6.946647e-07 ustep: 1 
iter: 5  mgc: 1.461609e-13 
iter: 1  mgc: 1.461609e-13 
outer mgc:  10.84552 
iter: 1  value: 1443.243 mgc: 1.249023 ustep: 1 
iter: 2  value: 1443.227 mgc: 0.121359 ustep: 1 
iter: 3  value: 1443.227 mgc: 0.0005017621 ustep: 1 
iter: 4  value: 1443.227 mgc: 1.224478e-08 ustep: 1 
iter: 5  mgc: 8.881784e-16 
iter: 1  value: 1405.589 mgc: 9.054033 ustep: 1 
iter: 2  value: 1405.321 mgc: 0.7613693 ustep: 1 
iter: 3  value: 1405.321 mgc: 0.008496161 ustep: 1 
iter: 4  value: 1405.321 mgc: 2.463113e-06 ustep: 1 
iter: 5  mgc: 2.355893e-13 
iter: 1  mgc: 2.355893e-13 
outer mgc:  14.83876 
iter: 1  value: 1414.812 mgc: 13.74629 ustep: 1 
iter: 2  value: 1414.809 mgc: 0.08632091 ustep: 1 
iter: 3  value: 1414.809 mgc: 5.236396e-05 ustep: 1 
iter: 4  mgc: 1.78258e-11 
iter: 1  value: 1390.15 mgc: 4.034872 ustep: 1 
iter: 2  value: 1390.149 mgc: 0.0861321 ustep: 1 
iter: 3  value: 1390.149 mgc: 1.951223e-05 ustep: 1 
iter: 4  mgc: 8.568701e-13 
iter: 1  mgc: 8.568701e-13 
outer mgc:  10.15382 
iter: 1  value: 1378.305 mgc: 2.172197 ustep: 1 
iter: 2  value: 1378.304 mgc: 0.07040963 ustep: 1 
iter: 3  value: 1378.304 mgc: 7.626201e-05 ustep: 1 
iter: 4  mgc: 1.376786e-10 
iter: 1  value: 1370.745 mgc: 3.62682 ustep: 1 
iter: 2  value: 1370.743 mgc: 0.1038345 ustep: 1 
iter: 3  value: 1370.743 mgc: 0.0001486483 ustep: 1 
iter: 4  mgc: 2.999507e-10 
iter: 1  mgc: 2.999507e-10 
outer mgc:  12.32664 
iter: 1  value: 1372.092 mgc: 6.07315 ustep: 1 
iter: 2  value: 1371.471 mgc: 2.174272 ustep: 1 
iter: 3  value: 1371.469 mgc: 0.1301733 ustep: 1 
iter: 4  value: 1371.469 mgc: 0.0005329687 ustep: 1 
iter: 5  mgc: 9.127449e-09 
iter: 1  value: 1367.302 mgc: 4.718314 ustep: 1 
iter: 2  value: 1367.213 mgc: 0.5170988 ustep: 1 
iter: 3  value: 1367.213 mgc: 0.006803889 ustep: 1 
iter: 4  value: 1367.213 mgc: 1.025587e-06 ustep: 1 
iter: 5  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  15.35573 
iter: 1  value: 1358.993 mgc: 7.576579 ustep: 1 
iter: 2  value: 1358.974 mgc: 0.3979443 ustep: 1 
iter: 3  value: 1358.974 mgc: 0.0032543 ustep: 1 
iter: 4  value: 1358.974 mgc: 2.924836e-07 ustep: 1 
iter: 5  mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  10.81364 
iter: 1  value: 1359.465 mgc: 4.544041 ustep: 1 
iter: 2  value: 1359.451 mgc: 0.2785818 ustep: 1 
iter: 3  value: 1359.451 mgc: 0.0006151634 ustep: 1 
iter: 4  mgc: 3.127649e-09 
iter: 1  value: 1352.509 mgc: 2.630812 ustep: 1 
iter: 2  value: 1352.509 mgc: 0.04714494 ustep: 1 
iter: 3  value: 1352.509 mgc: 1.634473e-05 ustep: 1 
iter: 4  mgc: 4.665934e-12 
iter: 1  mgc: 4.665934e-12 
outer mgc:  4.566339 
iter: 1  value: 1344.749 mgc: 3.876762 ustep: 1 
iter: 2  value: 1344.749 mgc: 0.0732313 ustep: 1 
iter: 3  value: 1344.749 mgc: 4.164906e-05 ustep: 1 
iter: 4  mgc: 1.343814e-11 
iter: 1  mgc: 1.343814e-11 
outer mgc:  3.593975 
iter: 1  value: 1340.323 mgc: 2.15861 ustep: 1 
iter: 2  value: 1340.323 mgc: 0.01467792 ustep: 1 
iter: 3  value: 1340.323 mgc: 5.625477e-07 ustep: 1 
iter: 4  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  5.614319 
iter: 1  value: 1337.721 mgc: 5.903873 ustep: 1 
iter: 2  value: 1337.72 mgc: 0.1209227 ustep: 1 
iter: 3  value: 1337.72 mgc: 7.526695e-05 ustep: 1 
iter: 4  mgc: 2.872813e-11 
iter: 1  mgc: 2.872813e-11 
outer mgc:  9.535876 
iter: 1  value: 1336.008 mgc: 9.144188 ustep: 1 
iter: 2  value: 1336.007 mgc: 0.111012 ustep: 1 
iter: 3  value: 1336.007 mgc: 2.431161e-05 ustep: 1 
iter: 4  mgc: 8.107959e-13 
iter: 1  value: 1336.685 mgc: 4.319014 ustep: 1 
iter: 2  value: 1336.685 mgc: 0.05617586 ustep: 1 
iter: 3  value: 1336.685 mgc: 1.004426e-05 ustep: 1 
iter: 4  mgc: 3.401723e-13 
iter: 1  mgc: 3.401723e-13 
outer mgc:  8.484913 
iter: 1  value: 1336.501 mgc: 3.38333 ustep: 1 
iter: 2  value: 1336.501 mgc: 0.01150866 ustep: 1 
iter: 3  value: 1336.501 mgc: 1.900807e-07 ustep: 1 
mgc: 6.084022e-14 
iter: 1  mgc: 6.084022e-14 
outer mgc:  2.806413 
iter: 1  value: 1335.615 mgc: 3.392668 ustep: 1 
iter: 2  value: 1335.615 mgc: 0.01197462 ustep: 1 
iter: 3  value: 1335.615 mgc: 2.687123e-07 ustep: 1 
iter: 4  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  4.169665 
iter: 1  value: 1335.28 mgc: 4.286227 ustep: 1 
iter: 2  value: 1335.28 mgc: 0.01137307 ustep: 1 
iter: 3  value: 1335.28 mgc: 2.083737e-07 ustep: 1 
mgc: 4.92939e-14 
iter: 1  mgc: 4.92939e-14 
outer mgc:  1.577783 
iter: 1  value: 1334.102 mgc: 2.152149 ustep: 1 
iter: 2  value: 1334.102 mgc: 0.0105809 ustep: 1 
iter: 3  value: 1334.102 mgc: 7.272316e-07 ustep: 1 
iter: 4  mgc: 5.340173e-14 
iter: 1  mgc: 5.340173e-14 
outer mgc:  1.90902 
iter: 1  value: 1334.743 mgc: 7.281809 ustep: 1 
iter: 2  value: 1334.743 mgc: 0.01778998 ustep: 1 
iter: 3  value: 1334.743 mgc: 4.589373e-07 ustep: 1 
iter: 4  mgc: 1.141309e-13 
iter: 1  mgc: 1.141309e-13 
outer mgc:  2.138057 
iter: 1  value: 1334.035 mgc: 5.321592 ustep: 1 
iter: 2  value: 1334.035 mgc: 0.008043283 ustep: 1 
iter: 3  value: 1334.035 mgc: 4.584956e-08 ustep: 1 
mgc: 9.514611e-14 
iter: 1  mgc: 9.514611e-14 
outer mgc:  1.516638 
iter: 1  value: 1332.66 mgc: 2.459083 ustep: 1 
iter: 2  value: 1332.66 mgc: 0.0121547 ustep: 1 
iter: 3  value: 1332.66 mgc: 9.308549e-07 ustep: 1 
iter: 4  mgc: 1.434408e-13 
iter: 1  mgc: 1.434408e-13 
outer mgc:  2.502567 
iter: 1  value: 1331.967 mgc: 3.645208 ustep: 1 
iter: 2  value: 1331.967 mgc: 0.00282136 ustep: 1 
iter: 3  value: 1331.967 mgc: 7.638205e-08 ustep: 1 
mgc: 1.209033e-13 
iter: 1  mgc: 1.209033e-13 
outer mgc:  0.4963692 
iter: 1  value: 1331.919 mgc: 2.199722 ustep: 1 
iter: 2  value: 1331.919 mgc: 0.0008166857 ustep: 1 
iter: 3  mgc: 3.532348e-10 
iter: 1  mgc: 3.532348e-10 
outer mgc:  0.2257592 
iter: 1  value: 1331.676 mgc: 0.6367181 ustep: 1 
iter: 2  value: 1331.676 mgc: 5.69485e-05 ustep: 1 
iter: 3  mgc: 3.231193e-12 
iter: 1  value: 1331.039 mgc: 1.911292 ustep: 1 
iter: 2  value: 1331.039 mgc: 0.0004049132 ustep: 1 
iter: 3  mgc: 1.585265e-10 
iter: 1  mgc: 1.585265e-10 
outer mgc:  0.136817 
iter: 1  value: 1329.084 mgc: 3.734514 ustep: 1 
iter: 2  value: 1329.084 mgc: 0.0007034647 ustep: 1 
iter: 3  mgc: 2.064695e-10 
iter: 1  mgc: 2.064695e-10 
outer mgc:  0.1645665 
iter: 1  value: 1327.494 mgc: 2.906465 ustep: 1 
iter: 2  value: 1327.494 mgc: 0.0001987324 ustep: 1 
iter: 3  mgc: 2.054934e-11 
iter: 1  mgc: 2.054934e-11 
outer mgc:  0.03639415 
iter: 1  value: 1325.424 mgc: 3.948449 ustep: 1 
iter: 2  value: 1325.424 mgc: 0.0001684416 ustep: 1 
iter: 3  mgc: 1.201172e-11 
iter: 1  mgc: 1.201172e-11 
outer mgc:  0.1094177 
iter: 1  value: 1323.876 mgc: 4.718191 ustep: 1 
iter: 2  value: 1323.876 mgc: 0.000117745 ustep: 1 
iter: 3  mgc: 1.340261e-11 
iter: 1  mgc: 1.340261e-11 
outer mgc:  0.08531357 
iter: 1  value: 1322.368 mgc: 2.594137 ustep: 1 
iter: 2  value: 1322.368 mgc: 1.739191e-05 ustep: 1 
iter: 3  mgc: 3.543832e-13 
iter: 1  mgc: 3.543832e-13 
outer mgc:  0.07990606 
iter: 1  value: 1320.255 mgc: 4.868465 ustep: 1 
iter: 2  value: 1320.255 mgc: 2.724798e-05 ustep: 1 
iter: 3  mgc: 9.179324e-13 
iter: 1  mgc: 9.179324e-13 
outer mgc:  0.03437327 
iter: 1  value: 1318.425 mgc: 3.059243 ustep: 1 
iter: 2  value: 1318.425 mgc: 4.750336e-06 ustep: 1 
iter: 3  mgc: 2.517986e-13 
iter: 1  mgc: 2.517986e-13 
outer mgc:  0.02715814 
iter: 1  value: 1316.408 mgc: 3.601604 ustep: 1 
iter: 2  value: 1316.408 mgc: 3.051047e-06 ustep: 1 
iter: 3  mgc: 4.667378e-13 
iter: 1  mgc: 4.667378e-13 
outer mgc:  0.007576239 
iter: 1  value: 1314.735 mgc: 2.879364 ustep: 1 
iter: 2  value: 1314.735 mgc: 9.251965e-07 ustep: 1 
iter: 3  mgc: 4.916068e-13 
iter: 1  mgc: 4.916068e-13 
outer mgc:  0.01288126 
iter: 1  value: 1312.736 mgc: 3.775863 ustep: 1 
iter: 2  value: 1312.736 mgc: 1.05977e-06 ustep: 1 
iter: 3  mgc: 4.169998e-13 
iter: 1  mgc: 4.169998e-13 
outer mgc:  0.01269304 
iter: 1  value: 1311.081 mgc: 3.497009 ustep: 1 
iter: 2  value: 1311.081 mgc: 4.800688e-07 ustep: 1 
iter: 3  mgc: 4.953815e-13 
iter: 1  mgc: 4.953815e-13 
outer mgc:  0.007905739 
iter: 1  value: 1308.971 mgc: 6.565915 ustep: 1 
iter: 2  value: 1308.971 mgc: 8.098707e-07 ustep: 1 
iter: 3  mgc: 9.392487e-13 
iter: 1  mgc: 9.392487e-13 
outer mgc:  0.001171933 
iter: 1  value: 1307.226 mgc: 5.337825 ustep: 1 
iter: 2  value: 1307.226 mgc: 2.517124e-07 ustep: 1 
mgc: 2.072564e-12 
iter: 1  mgc: 2.072564e-12 
outer mgc:  0.005619054 
iter: 1  value: 1305.308 mgc: 3.943955 ustep: 1 
iter: 2  value: 1305.308 mgc: 6.310624e-08 ustep: 1 
mgc: 2.57927e-12 
iter: 1  mgc: 2.57927e-12 
outer mgc:  0.006825429 
iter: 1  value: 1303.694 mgc: 2.772522 ustep: 1 
iter: 2  value: 1303.694 mgc: 1.054082e-08 ustep: 1 
mgc: 5.025313e-12 
iter: 1  mgc: 5.025313e-12 
outer mgc:  0.005435353 
iter: 1  value: 1301.52 mgc: 5.554659 ustep: 1 
iter: 2  value: 1301.52 mgc: 3.041302e-08 ustep: 1 
mgc: 6.916911e-12 
iter: 1  mgc: 6.916911e-12 
outer mgc:  0.001857371 
iter: 1  value: 1299.735 mgc: 5.687865 ustep: 1 
iter: 2  value: 1299.735 mgc: 1.646304e-08 ustep: 1 
mgc: 8.092194e-12 
iter: 1  mgc: 8.092194e-12 
outer mgc:  0.0008613689 
iter: 1  value: 1297.794 mgc: 4.804562 ustep: 1 
iter: 2  mgc: 5.117219e-09 
iter: 1  mgc: 5.117219e-09 
outer mgc:  0.002181241 
iter: 1  value: 1296.172 mgc: 2.960965 ustep: 1 
iter: 2  mgc: 8.293277e-10 
iter: 1  mgc: 8.293277e-10 
outer mgc:  0.002137022 
iter: 1  value: 1294.027 mgc: 12.39251 ustep: 1 
iter: 2  mgc: 7.744996e-09 
iter: 1  mgc: 7.744996e-09 
outer mgc:  0.001119378 
iter: 1  value: 1292.263 mgc: 16.35139 ustep: 1 
iter: 2  mgc: 6.63746e-09 
iter: 1  mgc: 6.63746e-09 
outer mgc:  0.0001039844 
iter: 1  value: 1290.269 mgc: 19.03217 ustep: 1 
iter: 2  mgc: 4.13602e-09 
iter: 1  mgc: 4.13602e-09 
outer mgc:  0.0007723647 
iter: 1  value: 1288.606 mgc: 7.612938 ustep: 1 
iter: 2  mgc: 4.641874e-10 
iter: 1  mgc: 4.641874e-10 
outer mgc:  0.0009638567 
iter: 1  value: 1286.514 mgc: 8.610741 ustep: 1 
iter: 2  mgc: 1.605636e-10 
iter: 1  mgc: 1.605636e-10 
outer mgc:  0.0007006525 
iter: 1  value: 1284.784 mgc: 21.48199 ustep: 1 
iter: 2  mgc: 6.071534e-10 
iter: 1  mgc: 6.071534e-10 
outer mgc:  0.0002913924 
iter: 1  mgc: 6.071534e-10 
iter: 1  mgc: 6.071534e-10 
outer mgc:  0.0002913924 
iter: 1  value: 1284.784 mgc: 0.01738454 ustep: 1 
iter: 2  value: 1284.784 mgc: 1.750298e-07 ustep: 1 
iter: 3  mgc: 9.084822e-11 
outer mgc:  0.1396497 
iter: 1  value: 1284.783 mgc: 0.01736884 ustep: 1 
iter: 2  value: 1284.783 mgc: 1.747735e-07 ustep: 1 
iter: 3  mgc: 2.615861e-10 
outer mgc:  0.13912 
iter: 1  value: 1284.784 mgc: 0.008302498 ustep: 1 
iter: 2  value: 1284.784 mgc: 7.210739e-08 ustep: 1 
mgc: 1.871956e-10 
outer mgc:  0.06206258 
iter: 1  value: 1284.784 mgc: 0.008294332 ustep: 1 
iter: 2  value: 1284.784 mgc: 7.181793e-08 ustep: 1 
mgc: 1.394507e-10 
outer mgc:  0.06198513 
iter: 1  value: 1284.784 mgc: 0.02611529 ustep: 1 
iter: 2  value: 1284.784 mgc: 2.369803e-06 ustep: 1 
iter: 3  mgc: 9.905876e-11 
outer mgc:  0.08266746 
iter: 1  value: 1284.784 mgc: 0.0261222 ustep: 1 
iter: 2  value: 1284.784 mgc: 2.364494e-06 ustep: 1 
iter: 3  mgc: 1.975855e-10 
outer mgc:  0.08305447 
iter: 1  value: 1284.784 mgc: 0.009383842 ustep: 1 
iter: 2  value: 1284.784 mgc: 1.108697e-07 ustep: 1 
iter: 3  mgc: 8.632739e-11 
outer mgc:  0.06655209 
iter: 1  value: 1284.783 mgc: 0.009391865 ustep: 1 
iter: 2  value: 1284.783 mgc: 1.111509e-07 ustep: 1 
iter: 3  mgc: 1.342948e-10 
outer mgc:  0.06647994 
iter: 1  value: 1284.795 mgc: 842.4491 ustep: 1 
iter: 2  value: 1284.795 mgc: 6.970474e-07 ustep: 1 
iter: 3  mgc: 2.205462e-10 
outer mgc:  0.007257497 
iter: 1  value: 1284.773 mgc: 844.9803 ustep: 1 
iter: 2  value: 1284.773 mgc: 6.957281e-07 ustep: 1 
iter: 3  mgc: 1.878182e-10 
outer mgc:  0.00782333 
iter: 1  value: 1284.785 mgc: 843.2967 ustep: 1 
iter: 2  value: 1284.785 mgc: 9.009413e-07 ustep: 1 
iter: 3  mgc: 1.496996e-10 
outer mgc:  0.02058851 
iter: 1  value: 1284.782 mgc: 844.1404 ustep: 1 
iter: 2  value: 1284.782 mgc: 9.018093e-07 ustep: 1 
iter: 3  mgc: 3.07965e-10 
outer mgc:  0.02001588 
iter: 1  value: 1284.784 mgc: 4.030068e-05 ustep: 1 
mgc: 1.365932e-10 
outer mgc:  0.0002913922 
iter: 1  value: 1284.784 mgc: 4.030062e-05 ustep: 1 
mgc: 1.087304e-10 
outer mgc:  0.0002913926 
iter: 1  value: 1284.783 mgc: 0.002333464 ustep: 1 
iter: 2  value: 1284.783 mgc: 1.169455e-08 ustep: 1 
mgc: 1.072848e-10 
outer mgc:  0.001467525 
iter: 1  value: 1284.785 mgc: 0.002334139 ustep: 1 
iter: 2  value: 1284.785 mgc: 1.172848e-08 ustep: 1 
mgc: 1.349156e-10 
outer mgc:  0.001616153 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:54:48 2021]
Finished job 0.
1 of 1 steps (100%) done

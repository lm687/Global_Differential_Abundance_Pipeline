Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:55:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21879.962341 
final  value 18106.479329 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17347.63 mgc: 5.325068 ustep: 0.6827823 
iter: 2  value: 17270.94 mgc: 5.553609 ustep: 0.8263238 
iter: 3  value: 17269.34 mgc: 3.55997 ustep: 0.5583883 
iter: 4  value: 17258.83 mgc: 6.483382 ustep: 0.7472791 
iter: 5  value: 17244.99 mgc: 4.133148 ustep: 0.6317882 
iter: 6  value: 17244.5 mgc: 1.174758 ustep: 0.7948716 
iter: 7  value: 17244.5 mgc: 0.1146105 ustep: 0.8915666 
iter: 8  value: 17244.5 mgc: 0.006872466 ustep: 0.9442336 
iter: 9  value: 17244.5 mgc: 0.0002066015 ustep: 0.9717197 
iter: 10  value: 17244.5 mgc: 3.52113e-06 ustep: 0.9857598 
iter: 11  value: 17244.5 mgc: 3.312835e-08 ustep: 0.9928551 
iter: 12  mgc: 1.639701e-10 
iter: 1  mgc: 1.639701e-10 
Matching hessian patterns... Done
outer mgc:  100.1316 
iter: 1  value: 17108.29 mgc: 1.309209 ustep: 1 
iter: 2  value: 17108.27 mgc: 0.08229987 ustep: 1 
iter: 3  value: 17108.27 mgc: 0.0004588897 ustep: 1 
iter: 4  value: 17108.27 mgc: 2.615196e-08 ustep: 1 
iter: 5  mgc: 4.385381e-15 
iter: 1  value: 17039.51 mgc: 5.685914 ustep: 1 
iter: 2  value: 17034.19 mgc: 1.690707 ustep: 1 
iter: 3  value: 17034.17 mgc: 0.2802884 ustep: 1 
iter: 4  value: 17034.17 mgc: 0.01335284 ustep: 1 
iter: 5  value: 17034.17 mgc: 3.594795e-05 ustep: 1 
iter: 6  mgc: 2.619858e-10 
iter: 1  mgc: 2.619858e-10 
outer mgc:  105.5506 
iter: 1  value: 17090.17 mgc: 4.827501 ustep: 1 
iter: 2  value: 17088.95 mgc: 0.729346 ustep: 1 
iter: 3  value: 17088.95 mgc: 0.03073405 ustep: 1 
iter: 4  value: 17088.95 mgc: 8.544287e-05 ustep: 1 
iter: 5  mgc: 6.06502e-10 
iter: 1  value: 17011.28 mgc: 2.329776 ustep: 1 
iter: 2  value: 17011.22 mgc: 0.3119793 ustep: 1 
iter: 3  value: 17011.22 mgc: 0.008025397 ustep: 1 
iter: 4  value: 17011.22 mgc: 7.700804e-06 ustep: 1 
iter: 5  mgc: 7.000289e-12 
iter: 1  mgc: 7.000289e-12 
outer mgc:  41.49612 
iter: 1  value: 17088.24 mgc: 5.607484 ustep: 1 
iter: 2  value: 16958.52 mgc: 6.2028 ustep: 1 
iter: 3  value: 16955.25 mgc: 2.73064 ustep: 1 
iter: 4  value: 16955.22 mgc: 0.4712497 ustep: 1 
iter: 5  value: 16955.22 mgc: 0.005042217 ustep: 1 
iter: 6  value: 16955.22 mgc: 3.039931e-06 ustep: 1 
iter: 7  mgc: 2.73892e-13 
iter: 1  mgc: 2.73892e-13 
outer mgc:  39.02918 
iter: 1  value: 16890.42 mgc: 3.023694 ustep: 1 
iter: 2  value: 16890.18 mgc: 0.2940055 ustep: 1 
iter: 3  value: 16890.18 mgc: 0.005357491 ustep: 1 
iter: 4  value: 16890.18 mgc: 2.289544e-06 ustep: 1 
iter: 5  mgc: 4.006795e-13 
iter: 1  mgc: 4.006795e-13 
outer mgc:  43.62585 
iter: 1  value: 16865.09 mgc: 4.116328 ustep: 1 
iter: 2  value: 16859.19 mgc: 1.373111 ustep: 1 
iter: 3  value: 16859.18 mgc: 0.06301508 ustep: 1 
iter: 4  value: 16859.18 mgc: 0.0003413617 ustep: 1 
iter: 5  mgc: 9.527835e-09 
iter: 1  mgc: 9.527835e-09 
outer mgc:  52.07873 
iter: 1  value: 16830.05 mgc: 6.552872 ustep: 1 
iter: 2  value: 16829.22 mgc: 1.066531 ustep: 1 
iter: 3  value: 16829.22 mgc: 0.003350128 ustep: 1 
iter: 4  value: 16829.22 mgc: 4.873206e-07 ustep: 1 
iter: 5  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  117.5982 
iter: 1  value: 16801.4 mgc: 3.562991 ustep: 1 
iter: 2  value: 16801.27 mgc: 0.2090155 ustep: 1 
iter: 3  value: 16801.27 mgc: 0.0006947519 ustep: 1 
iter: 4  value: 16801.27 mgc: 1.848305e-08 ustep: 1 
iter: 5  mgc: 6.106227e-15 
iter: 1  mgc: 6.106227e-15 
outer mgc:  34.78894 
iter: 1  value: 16769.42 mgc: 1.36974 ustep: 1 
iter: 2  value: 16769.42 mgc: 0.04499654 ustep: 1 
iter: 3  value: 16769.42 mgc: 5.848425e-05 ustep: 1 
iter: 4  mgc: 1.018908e-10 
iter: 1  mgc: 1.018908e-10 
outer mgc:  29.65938 
iter: 1  value: 16751.11 mgc: 2.429347 ustep: 1 
iter: 2  value: 16751.11 mgc: 0.06808595 ustep: 1 
iter: 3  value: 16751.11 mgc: 7.117546e-05 ustep: 1 
iter: 4  mgc: 7.242962e-11 
iter: 1  mgc: 7.242962e-11 
outer mgc:  32.86035 
iter: 1  value: 16733.54 mgc: 2.66315 ustep: 1 
iter: 2  value: 16733.54 mgc: 0.08461711 ustep: 1 
iter: 3  value: 16733.54 mgc: 0.0001073152 ustep: 1 
iter: 4  mgc: 1.878191e-10 
iter: 1  value: 16741.8 mgc: 1.328435 ustep: 1 
iter: 2  value: 16741.8 mgc: 0.02663089 ustep: 1 
iter: 3  value: 16741.8 mgc: 1.312985e-05 ustep: 1 
iter: 4  mgc: 3.900436e-12 
iter: 1  mgc: 3.900436e-12 
outer mgc:  31.63919 
iter: 1  value: 16732.93 mgc: 1.549464 ustep: 1 
iter: 2  value: 16732.93 mgc: 0.01731135 ustep: 1 
iter: 3  value: 16732.93 mgc: 3.803265e-06 ustep: 1 
iter: 4  mgc: 1.831868e-13 
iter: 1  mgc: 1.831868e-13 
outer mgc:  25.90466 
iter: 1  value: 16719.3 mgc: 0.7524673 ustep: 1 
iter: 2  value: 16719.3 mgc: 0.005355787 ustep: 1 
iter: 3  value: 16719.3 mgc: 4.665441e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  8.294451 
iter: 1  value: 16710.64 mgc: 1.328262 ustep: 1 
iter: 2  value: 16710.64 mgc: 0.00596802 ustep: 1 
iter: 3  value: 16710.64 mgc: 2.815419e-07 ustep: 1 
iter: 4  mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  13.85151 
iter: 1  value: 16696.47 mgc: 0.9079008 ustep: 1 
iter: 2  value: 16696.47 mgc: 0.003391114 ustep: 1 
iter: 3  value: 16696.47 mgc: 1.32089e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  23.3162 
iter: 1  value: 16684.48 mgc: 1.023857 ustep: 1 
iter: 2  value: 16684.48 mgc: 0.00454254 ustep: 1 
iter: 3  value: 16684.48 mgc: 1.176722e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  value: 16691.49 mgc: 0.746841 ustep: 1 
iter: 2  value: 16691.49 mgc: 0.002784028 ustep: 1 
iter: 3  value: 16691.49 mgc: 5.330387e-08 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  16.19521 
iter: 1  value: 16684.7 mgc: 0.6406202 ustep: 1 
iter: 2  value: 16684.7 mgc: 0.002417107 ustep: 1 
iter: 3  value: 16684.7 mgc: 5.217152e-08 ustep: 1 
mgc: 6.702104e-15 
iter: 1  mgc: 6.702104e-15 
outer mgc:  4.998718 
iter: 1  value: 16679.84 mgc: 0.4350781 ustep: 1 
iter: 2  value: 16679.84 mgc: 0.0005964966 ustep: 1 
iter: 3  mgc: 2.751363e-09 
iter: 1  value: 16683.05 mgc: 0.1273095 ustep: 1 
iter: 2  value: 16683.05 mgc: 5.491944e-05 ustep: 1 
iter: 3  mgc: 2.447598e-11 
iter: 1  mgc: 2.447598e-11 
outer mgc:  7.291573 
iter: 1  value: 16681.3 mgc: 0.2373852 ustep: 1 
iter: 2  value: 16681.3 mgc: 0.0001775838 ustep: 1 
iter: 3  mgc: 1.65e-10 
iter: 1  mgc: 1.65e-10 
outer mgc:  3.416154 
iter: 1  value: 16678.96 mgc: 0.1775863 ustep: 1 
iter: 2  value: 16678.96 mgc: 0.0001369357 ustep: 1 
iter: 3  mgc: 1.659002e-10 
iter: 1  mgc: 1.659002e-10 
outer mgc:  3.296997 
iter: 1  value: 16674.47 mgc: 0.2976912 ustep: 1 
iter: 2  value: 16674.47 mgc: 0.0002446111 ustep: 1 
iter: 3  mgc: 3.689147e-10 
iter: 1  value: 16664.95 mgc: 0.5589819 ustep: 1 
iter: 2  value: 16664.95 mgc: 0.001306494 ustep: 1 
iter: 3  value: 16664.95 mgc: 1.003479e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  value: 16642.2 mgc: 1.373741 ustep: 1 
iter: 2  value: 16642.2 mgc: 0.00474069 ustep: 1 
iter: 3  value: 16642.2 mgc: 8.820272e-08 ustep: 1 
mgc: 6.550316e-15 
iter: 1  mgc: 6.550316e-15 
outer mgc:  9.363441 
iter: 1  value: 16604.77 mgc: 2.127401 ustep: 1 
iter: 2  value: 16604.77 mgc: 0.003524303 ustep: 1 
iter: 3  value: 16604.77 mgc: 2.839555e-08 ustep: 1 
mgc: 6.827872e-15 
iter: 1  mgc: 6.827872e-15 
outer mgc:  14.19107 
iter: 1  value: 16568.07 mgc: 2.651424 ustep: 1 
iter: 2  value: 16568.07 mgc: 0.002948118 ustep: 1 
iter: 3  mgc: 4.751142e-09 
iter: 1  value: 16588.84 mgc: 1.183668 ustep: 1 
iter: 2  value: 16588.84 mgc: 0.0009164909 ustep: 1 
iter: 3  mgc: 7.370304e-10 
iter: 1  mgc: 7.370304e-10 
outer mgc:  8.141038 
iter: 1  value: 16574.93 mgc: 1.114397 ustep: 1 
iter: 2  value: 16574.93 mgc: 0.0004187682 ustep: 1 
iter: 3  mgc: 1.749854e-10 
iter: 1  mgc: 1.749854e-10 
outer mgc:  5.274897 
iter: 1  value: 16557.91 mgc: 0.9532141 ustep: 1 
iter: 2  value: 16557.91 mgc: 0.0005404524 ustep: 1 
iter: 3  mgc: 2.27776e-10 
iter: 1  mgc: 2.27776e-10 
outer mgc:  6.833894 
iter: 1  value: 16539.33 mgc: 0.7647176 ustep: 1 
iter: 2  value: 16539.33 mgc: 0.0002288713 ustep: 1 
iter: 3  mgc: 2.814682e-11 
iter: 1  mgc: 2.814682e-11 
outer mgc:  5.171711 
iter: 1  value: 16520.01 mgc: 0.9034801 ustep: 1 
iter: 2  value: 16520.01 mgc: 0.00020987 ustep: 1 
iter: 3  mgc: 1.660094e-11 
iter: 1  mgc: 1.660094e-11 
outer mgc:  2.331223 
iter: 1  value: 16500.41 mgc: 1.01619 ustep: 1 
iter: 2  value: 16500.41 mgc: 0.0001875763 ustep: 1 
iter: 3  mgc: 8.112178e-12 
iter: 1  value: 16466.26 mgc: 1.88358 ustep: 1 
iter: 2  value: 16466.26 mgc: 0.0003352372 ustep: 1 
iter: 3  mgc: 1.269918e-11 
iter: 1  mgc: 1.269918e-11 
outer mgc:  3.075444 
iter: 1  value: 16411.89 mgc: 3.261994 ustep: 1 
iter: 2  value: 16411.89 mgc: 0.0003372829 ustep: 1 
iter: 3  mgc: 4.424017e-12 
iter: 1  mgc: 4.424017e-12 
outer mgc:  2.01403 
iter: 1  value: 16357.24 mgc: 3.175992 ustep: 1 
iter: 2  value: 16357.24 mgc: 0.0001258304 ustep: 1 
iter: 3  mgc: 2.131628e-13 
iter: 1  mgc: 2.131628e-13 
outer mgc:  0.4608583 
iter: 1  value: 16302.37 mgc: 3.210228 ustep: 1 
iter: 2  value: 16302.37 mgc: 4.504095e-05 ustep: 1 
iter: 3  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  0.2043472 
iter: 1  value: 16247.38 mgc: 3.247799 ustep: 1 
iter: 2  value: 16247.38 mgc: 1.607993e-05 ustep: 1 
iter: 3  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.1136242 
iter: 1  value: 16174.54 mgc: 4.727725 ustep: 1 
iter: 2  value: 16174.54 mgc: 8.604085e-06 ustep: 1 
mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  0.06753136 
iter: 1  value: 16107.16 mgc: 4.261691 ustep: 1 
iter: 2  value: 16107.16 mgc: 1.95632e-06 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.04220697 
iter: 1  value: 16039.75 mgc: 4.268491 ustep: 1 
iter: 2  value: 16039.75 mgc: 5.515399e-07 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.02543891 
iter: 1  value: 15972.32 mgc: 4.271945 ustep: 1 
iter: 2  value: 15972.32 mgc: 1.556432e-07 ustep: 1 
mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  0.01353425 
iter: 1  value: 15904.89 mgc: 4.274197 ustep: 1 
iter: 2  value: 15904.89 mgc: 4.399789e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.006758382 
iter: 1  value: 15837.45 mgc: 4.275389 ustep: 1 
iter: 2  value: 15837.45 mgc: 1.246153e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.003374492 
iter: 1  value: 15770.01 mgc: 4.27603 ustep: 1 
iter: 2  mgc: 3.53639e-09 
iter: 1  mgc: 3.53639e-09 
outer mgc:  0.001807414 
iter: 1  value: 15702.57 mgc: 4.276329 ustep: 1 
iter: 2  mgc: 1.005425e-09 
iter: 1  mgc: 1.005425e-09 
outer mgc:  0.001026338 
iter: 1  value: 15635.13 mgc: 4.276481 ustep: 1 
iter: 2  mgc: 2.863354e-10 
iter: 1  mgc: 2.863354e-10 
outer mgc:  0.0005803593 
iter: 1  value: 15567.69 mgc: 4.276559 ustep: 1 
iter: 2  mgc: 8.167067e-11 
iter: 1  mgc: 8.167067e-11 
outer mgc:  0.0003144115 
iter: 1  value: 15500.25 mgc: 4.276604 ustep: 1 
iter: 2  mgc: 2.332801e-11 
iter: 1  mgc: 2.332801e-11 
outer mgc:  0.0001627828 
iter: 1  value: 15432.81 mgc: 4.276628 ustep: 1 
iter: 2  mgc: 6.67022e-12 
iter: 1  mgc: 6.67022e-12 
outer mgc:  8.358028e-05 
iter: 1  value: 15365.37 mgc: 4.276641 ustep: 1 
iter: 2  mgc: 1.919354e-12 
iter: 1  mgc: 1.919354e-12 
outer mgc:  4.404939e-05 
iter: 1  value: 15297.93 mgc: 4.276648 ustep: 1 
iter: 2  mgc: 5.52447e-13 
iter: 1  mgc: 5.52447e-13 
outer mgc:  2.412774e-05 
iter: 1  value: 15230.49 mgc: 4.276651 ustep: 1 
iter: 2  mgc: 1.572076e-13 
iter: 1  mgc: 1.572076e-13 
outer mgc:  1.338263e-05 
iter: 1  mgc: 1.572076e-13 
iter: 1  mgc: 1.572076e-13 
outer mgc:  1.338263e-05 
iter: 1  value: 15230.49 mgc: 0.006132047 ustep: 1 
mgc: 7.993606e-15 
outer mgc:  0.5137261 
iter: 1  value: 15230.49 mgc: 0.006132025 ustep: 1 
mgc: 6.883383e-15 
outer mgc:  0.513878 
iter: 1  value: 15230.49 mgc: 0.003020338 ustep: 1 
mgc: 6.763687e-15 
outer mgc:  0.2611033 
iter: 1  value: 15230.49 mgc: 0.003019935 ustep: 1 
mgc: 7.993606e-15 
outer mgc:  0.2611621 
iter: 1  value: 15230.49 mgc: 0.004725525 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.2807164 
iter: 1  value: 15230.49 mgc: 0.004722695 ustep: 1 
mgc: 7.105427e-15 
outer mgc:  0.2804184 
iter: 1  value: 15230.49 mgc: 0.002717098 ustep: 1 
mgc: 6.550316e-15 
outer mgc:  0.1509834 
iter: 1  value: 15230.49 mgc: 0.002715548 ustep: 1 
mgc: 7.105427e-15 
outer mgc:  0.1508255 
iter: 1  value: 15230.54 mgc: 0.004966872 ustep: 1 
mgc: 5.995204e-15 
outer mgc:  1.33959e-05 
iter: 1  value: 15230.44 mgc: 0.004971841 ustep: 1 
mgc: 7.105427e-15 
outer mgc:  1.336937e-05 
iter: 1  value: 15230.54 mgc: 0.003610881 ustep: 1 
mgc: 5.551115e-15 
outer mgc:  1.338326e-05 
iter: 1  value: 15230.44 mgc: 0.003614493 ustep: 1 
mgc: 7.300584e-15 
outer mgc:  1.338199e-05 
iter: 1  value: 15230.49 mgc: 0.00443834 ustep: 1 
mgc: 6.661338e-15 
outer mgc:  0.1749832 
iter: 1  value: 15230.49 mgc: 0.004435534 ustep: 1 
mgc: 7.993606e-15 
outer mgc:  0.174947 
[Fri Aug 13 11:56:01 2021]
Finished job 0.
1 of 1 steps (100%) done

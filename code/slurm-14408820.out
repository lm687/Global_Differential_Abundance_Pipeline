Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:26:42 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2278.521887 
iter  10 value 1804.785893
iter  10 value 1804.785893
final  value 1804.785893 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1427.02 mgc: 86.67176 ustep: 0.2494656 
iter: 2  value: 1134.553 mgc: 76.46158 ustep: 0.1588666 
iter: 3  value: 1129.821 mgc: 126.8723 ustep: 0.3986409 
iter: 4  value: 966.8092 mgc: 71.3253 ustep: 0.1172538 
iter: 5  value: 895.848 mgc: 118.5536 ustep: 0.3424892 
iter: 6  value: 835.6154 mgc: 64.80647 ustep: 0.1041456 
iter: 7  value: 769.8699 mgc: 80.13621 ustep: 0.3227837 
iter: 8  value: 768.395 mgc: 8.909698 ustep: 0.5681837 
iter: 9  value: 768.3741 mgc: 0.6655053 ustep: 0.7538042 
iter: 10  value: 768.3741 mgc: 0.03347464 ustep: 0.8682322 
iter: 11  value: 768.3741 mgc: 0.0005076081 ustep: 0.9317966 
iter: 12  value: 768.3741 mgc: 3.501057e-06 ustep: 0.9652996 
iter: 13  value: 768.3741 mgc: 1.1931e-08 ustep: 0.9824984 
mgc: 2.02125e-11 
iter: 1  mgc: 2.02125e-11 
Matching hessian patterns... Done
outer mgc:  337.7064 
iter: 1  value: 451.1877 mgc: 31.08926 ustep: 1 
iter: 2  value: 439.4465 mgc: 10.77333 ustep: 1 
iter: 3  value: 439.3693 mgc: 0.8528813 ustep: 1 
iter: 4  value: 439.3693 mgc: 0.01500583 ustep: 1 
iter: 5  value: 439.3693 mgc: 4.908115e-06 ustep: 1 
iter: 6  mgc: 5.205836e-13 
iter: 1  value: 428.5842 mgc: 53.68013 ustep: 1 
iter: 2  value: 161.1084 mgc: 66.16083 ustep: 1 
iter: 3  value: 149.9036 mgc: 11.46426 ustep: 1 
iter: 4  value: 149.75 mgc: 1.667238 ustep: 1 
iter: 5  value: 149.7499 mgc: 0.05746978 ustep: 1 
iter: 6  value: 149.7499 mgc: 7.59003e-05 ustep: 1 
iter: 7  mgc: 1.32911e-10 
iter: 1  mgc: 1.32911e-10 
outer mgc:  24.46612 
iter: 1  value: 291.3086 mgc: 59.88165 ustep: 1 
iter: 2  value: 231.9206 mgc: 45.5631 ustep: 1 
iter: 3  value: 231.8417 mgc: 1.431947 ustep: 1 
iter: 4  value: 231.8416 mgc: 0.02974607 ustep: 1 
iter: 5  value: 231.8416 mgc: 1.211112e-05 ustep: 1 
iter: 6  mgc: 2.006395e-12 
iter: 1  value: 139.389 mgc: 24.1005 ustep: 1 
iter: 2  value: 139.184 mgc: 2.46032 ustep: 1 
iter: 3  value: 139.184 mgc: 0.01143642 ustep: 1 
iter: 4  value: 139.184 mgc: 2.476232e-07 ustep: 1 
iter: 5  mgc: 2.325917e-14 
iter: 1  mgc: 2.325917e-14 
outer mgc:  25.3178 
iter: 1  value: 135.7814 mgc: 7.238986 ustep: 1 
iter: 2  value: 135.7711 mgc: 0.4044341 ustep: 1 
iter: 3  value: 135.7711 mgc: 0.004118373 ustep: 1 
iter: 4  value: 135.7711 mgc: 4.391772e-07 ustep: 1 
iter: 5  mgc: 2.170486e-14 
iter: 1  mgc: 2.170486e-14 
outer mgc:  23.78776 
iter: 1  value: 129.6478 mgc: 20.33819 ustep: 1 
iter: 2  value: 129.6032 mgc: 1.15152 ustep: 1 
iter: 3  value: 129.6032 mgc: 0.002264255 ustep: 1 
iter: 4  mgc: 9.514205e-09 
iter: 1  mgc: 9.514205e-09 
outer mgc:  24.07525 
iter: 1  value: 139.9234 mgc: 12.96686 ustep: 1 
iter: 2  value: 139.8629 mgc: 1.402274 ustep: 1 
iter: 3  value: 139.8629 mgc: 0.003296893 ustep: 1 
iter: 4  value: 139.8629 mgc: 8.90632e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  value: 126.1187 mgc: 8.223944 ustep: 1 
iter: 2  value: 126.1126 mgc: 0.3999375 ustep: 1 
iter: 3  value: 126.1126 mgc: 0.0007644659 ustep: 1 
iter: 4  mgc: 2.820612e-09 
iter: 1  mgc: 2.820612e-09 
outer mgc:  10.41766 
iter: 1  value: 123.5836 mgc: 15.74265 ustep: 1 
iter: 2  value: 123.5697 mgc: 0.6058556 ustep: 1 
iter: 3  value: 123.5697 mgc: 0.0006214961 ustep: 1 
iter: 4  mgc: 1.647271e-09 
iter: 1  mgc: 1.647271e-09 
outer mgc:  7.041592 
iter: 1  value: 120.7234 mgc: 9.009319 ustep: 1 
iter: 2  value: 120.7221 mgc: 0.1573365 ustep: 1 
iter: 3  value: 120.7221 mgc: 7.454198e-05 ustep: 1 
iter: 4  mgc: 3.30691e-11 
iter: 1  value: 120.5635 mgc: 40.6297 ustep: 1 
iter: 2  value: 119.3613 mgc: 5.902498 ustep: 1 
iter: 3  value: 119.3612 mgc: 0.04222892 ustep: 1 
iter: 4  value: 119.3612 mgc: 2.199258e-06 ustep: 1 
iter: 5  mgc: 4.202194e-14 
iter: 1  mgc: 4.202194e-14 
outer mgc:  24.0672 
iter: 1  value: 134.0043 mgc: 14.46955 ustep: 1 
iter: 2  value: 133.1731 mgc: 3.655703 ustep: 1 
iter: 3  value: 133.1725 mgc: 0.1214808 ustep: 1 
iter: 4  value: 133.1725 mgc: 0.0001517601 ustep: 1 
iter: 5  mgc: 2.377413e-10 
iter: 1  value: 115.7912 mgc: 10.96383 ustep: 1 
iter: 2  value: 115.7324 mgc: 0.742024 ustep: 1 
iter: 3  value: 115.7324 mgc: 0.004830703 ustep: 1 
iter: 4  value: 115.7324 mgc: 2.09237e-07 ustep: 1 
iter: 5  mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  11.83868 
iter: 1  value: 112.1551 mgc: 4.95905 ustep: 1 
iter: 2  value: 112.1535 mgc: 0.1181067 ustep: 1 
iter: 3  value: 112.1535 mgc: 0.000256173 ustep: 1 
iter: 4  mgc: 1.175062e-09 
iter: 1  mgc: 1.175062e-09 
outer mgc:  7.097354 
iter: 1  value: 111.7601 mgc: 8.132649 ustep: 1 
iter: 2  value: 111.7349 mgc: 0.4515746 ustep: 1 
iter: 3  value: 111.7349 mgc: 0.002093056 ustep: 1 
iter: 4  value: 111.7349 mgc: 4.487142e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  18.97914 
iter: 1  value: 109.1486 mgc: 8.629508 ustep: 1 
iter: 2  value: 109.1484 mgc: 0.073552 ustep: 1 
iter: 3  value: 109.1484 mgc: 1.075537e-05 ustep: 1 
iter: 4  mgc: 2.597922e-13 
iter: 1  mgc: 2.597922e-13 
outer mgc:  5.214758 
iter: 1  value: 108.3594 mgc: 1.668445 ustep: 1 
iter: 2  value: 108.3594 mgc: 0.01412293 ustep: 1 
iter: 3  value: 108.3594 mgc: 1.376916e-06 ustep: 1 
iter: 4  mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  3.174913 
iter: 1  value: 107.6012 mgc: 5.479425 ustep: 1 
iter: 2  value: 107.6012 mgc: 0.02217434 ustep: 1 
iter: 3  value: 107.6012 mgc: 6.392317e-07 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  9.569094 
iter: 1  value: 106.9015 mgc: 3.843808 ustep: 1 
iter: 2  value: 106.9009 mgc: 0.108056 ustep: 1 
iter: 3  value: 106.9009 mgc: 9.974372e-05 ustep: 1 
iter: 4  mgc: 8.337464e-11 
iter: 1  mgc: 8.337464e-11 
outer mgc:  5.208254 
iter: 1  value: 106.5972 mgc: 3.321674 ustep: 1 
iter: 2  value: 106.5966 mgc: 0.08850347 ustep: 1 
iter: 3  value: 106.5966 mgc: 6.862288e-05 ustep: 1 
iter: 4  mgc: 4.210055e-11 
iter: 1  mgc: 4.210055e-11 
outer mgc:  4.960018 
iter: 1  value: 106.5494 mgc: 4.123437 ustep: 1 
iter: 2  value: 106.5494 mgc: 0.008295328 ustep: 1 
iter: 3  value: 106.5494 mgc: 4.507066e-07 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  value: 106.6727 mgc: 3.747097 ustep: 1 
iter: 2  value: 106.6727 mgc: 0.007341982 ustep: 1 
iter: 3  value: 106.6727 mgc: 1.890995e-07 ustep: 1 
mgc: 3.219647e-14 
iter: 1  value: 106.4946 mgc: 1.603589 ustep: 1 
iter: 2  value: 106.4946 mgc: 0.002252635 ustep: 1 
iter: 3  value: 106.4946 mgc: 1.961572e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  2.615034 
iter: 1  value: 106.4599 mgc: 0.5100359 ustep: 1 
iter: 2  value: 106.4599 mgc: 0.0009538564 ustep: 1 
iter: 3  mgc: 4.402299e-09 
iter: 1  mgc: 4.402299e-09 
outer mgc:  1.226165 
iter: 1  value: 106.37 mgc: 0.821087 ustep: 1 
iter: 2  value: 106.37 mgc: 0.001301479 ustep: 1 
iter: 3  value: 106.37 mgc: 2.071735e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  1.454458 
iter: 1  value: 106.255 mgc: 0.382941 ustep: 1 
iter: 2  value: 106.255 mgc: 0.0008408769 ustep: 1 
iter: 3  mgc: 4.556116e-09 
iter: 1  value: 105.9584 mgc: 1.082287 ustep: 1 
iter: 2  value: 105.9584 mgc: 0.004779082 ustep: 1 
iter: 3  value: 105.9584 mgc: 1.299783e-07 ustep: 1 
mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  1.178258 
iter: 1  value: 105.5297 mgc: 1.119163 ustep: 1 
iter: 2  value: 105.5297 mgc: 0.00243495 ustep: 1 
iter: 3  value: 105.5297 mgc: 3.450632e-08 ustep: 1 
mgc: 1.650069e-14 
iter: 1  value: 105.7464 mgc: 0.4713751 ustep: 1 
iter: 2  value: 105.7464 mgc: 0.0004508085 ustep: 1 
iter: 3  mgc: 1.28033e-09 
iter: 1  mgc: 1.28033e-09 
outer mgc:  0.7179433 
iter: 1  value: 105.5018 mgc: 0.6030498 ustep: 1 
iter: 2  value: 105.5018 mgc: 0.0009031723 ustep: 1 
iter: 3  mgc: 4.792684e-09 
iter: 1  mgc: 4.792684e-09 
outer mgc:  0.6272734 
iter: 1  value: 105.298 mgc: 0.6421955 ustep: 1 
iter: 2  value: 105.298 mgc: 0.0004514596 ustep: 1 
iter: 3  mgc: 1.208221e-09 
iter: 1  mgc: 1.208221e-09 
outer mgc:  0.2719921 
iter: 1  value: 104.9772 mgc: 0.7454862 ustep: 1 
iter: 2  value: 104.9772 mgc: 0.001661154 ustep: 1 
iter: 3  value: 104.9772 mgc: 1.348034e-08 ustep: 1 
mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  0.1993712 
iter: 1  value: 104.9267 mgc: 0.2817323 ustep: 1 
iter: 2  value: 104.9267 mgc: 0.0001926993 ustep: 1 
iter: 3  mgc: 2.329079e-10 
iter: 1  mgc: 2.329079e-10 
outer mgc:  0.1468419 
iter: 1  value: 104.9348 mgc: 0.1310214 ustep: 1 
iter: 2  value: 104.9348 mgc: 5.534877e-05 ustep: 1 
iter: 3  mgc: 1.886491e-11 
iter: 1  mgc: 1.886491e-11 
outer mgc:  0.004122709 
iter: 1  value: 104.9336 mgc: 0.005992577 ustep: 1 
iter: 2  value: 104.9336 mgc: 2.896549e-08 ustep: 1 
mgc: 2.635392e-14 
iter: 1  mgc: 2.635392e-14 
outer mgc:  0.001489537 
iter: 1  value: 104.933 mgc: 0.002077703 ustep: 1 
iter: 2  mgc: 4.032048e-09 
iter: 1  mgc: 4.032048e-09 
outer mgc:  5.413348e-05 
iter: 1  value: 104.933 mgc: 4.734875e-05 ustep: 1 
iter: 2  mgc: 8.050394e-12 
iter: 1  mgc: 8.050394e-12 
outer mgc:  9.71073e-06 
iter: 1  mgc: 8.050394e-12 
iter: 1  mgc: 8.050394e-12 
outer mgc:  9.71073e-06 
iter: 1  value: 104.9323 mgc: 0.03294731 ustep: 1 
iter: 2  value: 104.9323 mgc: 3.166686e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.1125577 
iter: 1  value: 104.9338 mgc: 0.03293389 ustep: 1 
iter: 2  value: 104.9338 mgc: 3.167302e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.1125656 
iter: 1  value: 104.9327 mgc: 0.01177766 ustep: 1 
iter: 2  value: 104.9327 mgc: 3.532449e-07 ustep: 1 
iter: 3  mgc: 2.68674e-14 
outer mgc:  0.07201454 
iter: 1  value: 104.9333 mgc: 0.01176892 ustep: 1 
iter: 2  value: 104.9333 mgc: 3.527131e-07 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.07198339 
iter: 1  value: 104.934 mgc: 0.03902535 ustep: 1 
iter: 2  value: 104.934 mgc: 7.895427e-07 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.1631278 
iter: 1  value: 104.9322 mgc: 0.03902589 ustep: 1 
iter: 2  value: 104.9322 mgc: 7.893813e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.1631209 
iter: 1  value: 104.9343 mgc: 0.02625479 ustep: 1 
iter: 2  value: 104.9343 mgc: 2.947983e-07 ustep: 1 
iter: 3  mgc: 1.985911e-14 
outer mgc:  0.1489814 
iter: 1  value: 104.9318 mgc: 0.02626406 ustep: 1 
iter: 2  value: 104.9318 mgc: 2.952835e-07 ustep: 1 
iter: 3  mgc: 1.576517e-14 
outer mgc:  0.1489977 
iter: 1  value: 104.931 mgc: 0.005174006 ustep: 1 
iter: 2  value: 104.931 mgc: 3.46369e-08 ustep: 1 
mgc: 1.776357e-14 
outer mgc:  0.0005389651 
iter: 1  value: 104.9349 mgc: 0.00517216 ustep: 1 
iter: 2  value: 104.9349 mgc: 3.466845e-08 ustep: 1 
mgc: 2.664535e-14 
outer mgc:  0.0005332769 
iter: 1  value: 104.9364 mgc: 0.03319451 ustep: 1 
iter: 2  value: 104.9364 mgc: 3.245337e-06 ustep: 1 
iter: 3  mgc: 7.194245e-14 
outer mgc:  0.03488623 
iter: 1  value: 104.9296 mgc: 0.03322772 ustep: 1 
iter: 2  value: 104.9296 mgc: 3.250353e-06 ustep: 1 
iter: 3  mgc: 7.682743e-14 
outer mgc:  0.03491152 
iter: 1  value: 104.9366 mgc: 0.03393699 ustep: 1 
iter: 2  value: 104.9366 mgc: 1.353784e-06 ustep: 1 
iter: 3  mgc: 1.820766e-14 
outer mgc:  0.0356372 
iter: 1  value: 104.9294 mgc: 0.03403817 ustep: 1 
iter: 2  value: 104.9294 mgc: 1.353086e-06 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.03564778 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:26:43 2021]
Finished job 0.
1 of 1 steps (100%) done

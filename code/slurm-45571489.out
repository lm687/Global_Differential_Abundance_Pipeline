Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 22:50:33 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22090.895901 
final  value 20010.712345 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18830.89 mgc: 4.54526 ustep: 1 
iter: 2  value: 18820.6 mgc: 4.257488 ustep: 0.8994163 
iter: 3  value: 18791 mgc: 4.180393 ustep: 0.523213 
iter: 4  value: 18788.68 mgc: 2.028753 ustep: 0.7233623 
iter: 5  value: 18788.5 mgc: 0.9183899 ustep: 0.850522 
iter: 6  value: 18788.49 mgc: 0.05342379 ustep: 0.9222453 
iter: 7  value: 18788.49 mgc: 0.001654494 ustep: 0.96034 
iter: 8  value: 18788.49 mgc: 6.752569e-05 ustep: 0.9799714 
iter: 9  value: 18788.49 mgc: 1.790187e-06 ustep: 0.989936 
iter: 10  value: 18788.49 mgc: 2.463531e-08 ustep: 0.9949558 
iter: 11  mgc: 1.711729e-10 
iter: 1  mgc: 1.711729e-10 
Matching hessian patterns... Done
outer mgc:  126.6917 
iter: 1  value: 18603 mgc: 0.9494913 ustep: 1 
iter: 2  value: 18602.99 mgc: 0.07835314 ustep: 1 
iter: 3  value: 18602.99 mgc: 0.0006104807 ustep: 1 
iter: 4  value: 18602.99 mgc: 3.795103e-08 ustep: 1 
iter: 5  mgc: 4.82947e-15 
iter: 1  value: 18485.22 mgc: 6.289368 ustep: 1 
iter: 2  value: 18484.97 mgc: 0.8615728 ustep: 1 
iter: 3  value: 18484.97 mgc: 0.03267634 ustep: 1 
iter: 4  value: 18484.97 mgc: 5.882641e-05 ustep: 1 
iter: 5  mgc: 1.897305e-10 
iter: 1  mgc: 1.897305e-10 
outer mgc:  111.7809 
iter: 1  value: 19201.81 mgc: 68.49956 ustep: 1 
iter: 2  value: 18955.25 mgc: 6.602115 ustep: 1 
iter: 3  value: 18941 mgc: 4.057059 ustep: 1 
iter: 4  value: 18940.96 mgc: 0.3440367 ustep: 1 
iter: 5  value: 18940.96 mgc: 0.001059432 ustep: 1 
iter: 6  mgc: 4.883393e-09 
iter: 1  value: 18471.42 mgc: 2.26966 ustep: 1 
iter: 2  value: 18471.41 mgc: 0.1650574 ustep: 1 
iter: 3  value: 18471.41 mgc: 0.0008910765 ustep: 1 
iter: 4  value: 18471.41 mgc: 2.519369e-08 ustep: 1 
mgc: 9.547918e-15 
iter: 1  mgc: 9.547918e-15 
outer mgc:  125.0185 
iter: 1  value: 18457.77 mgc: 3.258197 ustep: 1 
iter: 2  value: 18456.68 mgc: 0.5969961 ustep: 1 
iter: 3  value: 18456.68 mgc: 0.01508934 ustep: 1 
iter: 4  value: 18456.68 mgc: 1.620176e-05 ustep: 1 
iter: 5  mgc: 1.897535e-11 
iter: 1  mgc: 1.897535e-11 
outer mgc:  83.32594 
iter: 1  value: 18416.94 mgc: 3.552283 ustep: 1 
iter: 2  value: 18416.72 mgc: 0.4538419 ustep: 1 
iter: 3  value: 18416.72 mgc: 0.005664219 ustep: 1 
iter: 4  value: 18416.72 mgc: 1.09099e-06 ustep: 1 
iter: 5  mgc: 1.070255e-13 
iter: 1  mgc: 1.070255e-13 
outer mgc:  42.95842 
iter: 1  value: 18365.41 mgc: 6.528982 ustep: 1 
iter: 2  value: 18365.19 mgc: 0.5188567 ustep: 1 
iter: 3  value: 18365.19 mgc: 0.005147472 ustep: 1 
iter: 4  value: 18365.19 mgc: 2.583012e-06 ustep: 1 
iter: 5  mgc: 3.725908e-13 
iter: 1  mgc: 3.725908e-13 
outer mgc:  39.23339 
iter: 1  value: 18323.7 mgc: 5.173126 ustep: 1 
iter: 2  value: 18323.68 mgc: 0.2258526 ustep: 1 
iter: 3  value: 18323.68 mgc: 0.0001820725 ustep: 1 
iter: 4  mgc: 2.328836e-09 
iter: 1  mgc: 2.328836e-09 
outer mgc:  68.16709 
iter: 1  value: 18292.05 mgc: 5.970943 ustep: 1 
iter: 2  value: 18292.03 mgc: 0.1490132 ustep: 1 
iter: 3  value: 18292.03 mgc: 0.0003596696 ustep: 1 
iter: 4  mgc: 3.086751e-09 
iter: 1  mgc: 3.086751e-09 
outer mgc:  27.48519 
iter: 1  value: 18277.94 mgc: 6.240688 ustep: 1 
iter: 2  value: 18277.93 mgc: 0.06091889 ustep: 1 
iter: 3  value: 18277.93 mgc: 4.543476e-05 ustep: 1 
iter: 4  mgc: 1.524292e-11 
iter: 1  value: 18284.88 mgc: 1.391749 ustep: 1 
iter: 2  value: 18284.88 mgc: 0.002772289 ustep: 1 
iter: 3  value: 18284.88 mgc: 3.536369e-07 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  16.21571 
iter: 1  value: 18282.42 mgc: 1.079993 ustep: 1 
iter: 2  value: 18282.42 mgc: 0.002886054 ustep: 1 
iter: 3  value: 18282.42 mgc: 2.810893e-08 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  14.45397 
iter: 1  value: 18278.94 mgc: 0.483405 ustep: 1 
iter: 2  value: 18278.94 mgc: 0.001394618 ustep: 1 
iter: 3  value: 18278.94 mgc: 1.522704e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  8.314466 
iter: 1  value: 18271.21 mgc: 1.647931 ustep: 1 
iter: 2  value: 18271.21 mgc: 0.004817571 ustep: 1 
iter: 3  value: 18271.21 mgc: 1.167749e-06 ustep: 1 
iter: 4  mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  4.049354 
iter: 1  value: 18267.52 mgc: 0.9181322 ustep: 1 
iter: 2  value: 18267.52 mgc: 0.0009088557 ustep: 1 
iter: 3  mgc: 8.136817e-09 
iter: 1  mgc: 8.136817e-09 
outer mgc:  11.37291 
iter: 1  value: 18264.99 mgc: 0.9832669 ustep: 1 
iter: 2  value: 18264.99 mgc: 0.0009543111 ustep: 1 
iter: 3  value: 18264.99 mgc: 1.702028e-08 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  15.8604 
iter: 1  value: 18261.22 mgc: 0.3880167 ustep: 1 
iter: 2  value: 18261.22 mgc: 0.0001637028 ustep: 1 
iter: 3  mgc: 1.279079e-09 
iter: 1  mgc: 1.279079e-09 
outer mgc:  4.219572 
iter: 1  value: 18259.12 mgc: 0.4855816 ustep: 1 
iter: 2  value: 18259.12 mgc: 0.000587507 ustep: 1 
iter: 3  mgc: 6.763488e-10 
iter: 1  mgc: 6.763488e-10 
outer mgc:  4.413006 
iter: 1  value: 18256.86 mgc: 0.2220551 ustep: 1 
iter: 2  value: 18256.86 mgc: 0.0001522016 ustep: 1 
iter: 3  mgc: 2.333147e-10 
iter: 1  mgc: 2.333147e-10 
outer mgc:  1.684832 
iter: 1  value: 18254.52 mgc: 0.3192314 ustep: 1 
iter: 2  value: 18254.52 mgc: 3.533963e-05 ustep: 1 
iter: 3  mgc: 5.715428e-12 
iter: 1  value: 18251.32 mgc: 0.2886529 ustep: 1 
iter: 2  value: 18251.32 mgc: 6.475214e-05 ustep: 1 
iter: 3  mgc: 1.713296e-11 
iter: 1  value: 18244.19 mgc: 0.7334527 ustep: 1 
iter: 2  value: 18244.19 mgc: 0.0002660661 ustep: 1 
iter: 3  mgc: 2.81926e-10 
iter: 1  mgc: 2.81926e-10 
outer mgc:  5.174716 
iter: 1  value: 18238.63 mgc: 0.9247218 ustep: 1 
iter: 2  value: 18238.63 mgc: 0.003294949 ustep: 1 
iter: 3  value: 18238.63 mgc: 5.979903e-08 ustep: 1 
iter: 4  mgc: 9.992007e-15 
iter: 1  mgc: 9.992007e-15 
outer mgc:  6.200791 
iter: 1  value: 18232.17 mgc: 1.047298 ustep: 1 
iter: 2  value: 18232.17 mgc: 0.0004225284 ustep: 1 
iter: 3  mgc: 4.167092e-09 
iter: 1  value: 18235.49 mgc: 0.4728126 ustep: 1 
iter: 2  value: 18235.49 mgc: 6.996344e-05 ustep: 1 
iter: 3  mgc: 1.470011e-10 
iter: 1  mgc: 1.470011e-10 
outer mgc:  5.46881 
iter: 1  value: 18226.36 mgc: 1.727635 ustep: 1 
iter: 2  value: 18226.36 mgc: 0.003035025 ustep: 1 
iter: 3  value: 18226.36 mgc: 2.77305e-08 ustep: 1 
iter: 4  mgc: 1.171285e-14 
iter: 1  mgc: 1.171285e-14 
outer mgc:  4.873217 
iter: 1  value: 18222.79 mgc: 0.5707339 ustep: 1 
iter: 2  value: 18222.79 mgc: 0.000107609 ustep: 1 
iter: 3  mgc: 1.048703e-10 
iter: 1  mgc: 1.048703e-10 
outer mgc:  2.118851 
iter: 1  value: 18220.92 mgc: 1.28435 ustep: 1 
iter: 2  value: 18220.92 mgc: 0.0006097494 ustep: 1 
iter: 3  mgc: 6.504828e-10 
iter: 1  mgc: 6.504828e-10 
outer mgc:  2.477682 
iter: 1  value: 18214.78 mgc: 0.4675971 ustep: 1 
iter: 2  value: 18214.78 mgc: 0.0001075196 ustep: 1 
iter: 3  mgc: 2.037921e-10 
iter: 1  value: 18206.17 mgc: 0.6866558 ustep: 1 
iter: 2  value: 18206.17 mgc: 0.0002752217 ustep: 1 
iter: 3  mgc: 1.065026e-09 
iter: 1  mgc: 1.065026e-09 
outer mgc:  1.977004 
iter: 1  value: 18199.45 mgc: 1.465338 ustep: 1 
iter: 2  value: 18199.45 mgc: 0.0004868213 ustep: 1 
iter: 3  mgc: 9.670367e-10 
iter: 1  value: 18192.71 mgc: 1.982665 ustep: 1 
iter: 2  value: 18192.71 mgc: 0.0006118387 ustep: 1 
iter: 3  mgc: 1.295935e-09 
iter: 1  mgc: 1.295935e-09 
outer mgc:  2.332771 
iter: 1  value: 18176.64 mgc: 3.574136 ustep: 1 
iter: 2  value: 18176.64 mgc: 0.0006067659 ustep: 1 
iter: 3  mgc: 8.360943e-10 
iter: 1  mgc: 8.360943e-10 
outer mgc:  2.520177 
iter: 1  value: 18165.56 mgc: 1.249603 ustep: 1 
iter: 2  value: 18165.56 mgc: 3.558977e-05 ustep: 1 
iter: 3  mgc: 7.856382e-12 
iter: 1  mgc: 7.856382e-12 
outer mgc:  0.53791 
iter: 1  value: 18155.68 mgc: 0.9719228 ustep: 1 
iter: 2  value: 18155.68 mgc: 9.949988e-06 ustep: 1 
iter: 3  mgc: 6.07514e-13 
iter: 1  mgc: 6.07514e-13 
outer mgc:  0.1547289 
iter: 1  value: 18134.45 mgc: 2.447067 ustep: 1 
iter: 2  value: 18134.45 mgc: 2.405419e-05 ustep: 1 
iter: 3  mgc: 4.773959e-12 
iter: 1  mgc: 4.773959e-12 
outer mgc:  0.4018766 
iter: 1  value: 18117.04 mgc: 1.814172 ustep: 1 
iter: 2  value: 18117.04 mgc: 7.610682e-06 ustep: 1 
iter: 3  mgc: 4.014566e-13 
iter: 1  mgc: 4.014566e-13 
outer mgc:  0.2550739 
iter: 1  value: 18096.67 mgc: 2.120815 ustep: 1 
iter: 2  value: 18096.67 mgc: 4.898268e-06 ustep: 1 
iter: 3  mgc: 2.122746e-13 
iter: 1  mgc: 2.122746e-13 
outer mgc:  0.02848904 
iter: 1  value: 18079.7 mgc: 1.664613 ustep: 1 
iter: 2  value: 18079.7 mgc: 1.646805e-06 ustep: 1 
iter: 3  mgc: 2.260414e-13 
iter: 1  mgc: 2.260414e-13 
outer mgc:  0.06794863 
iter: 1  value: 18058.98 mgc: 2.037493 ustep: 1 
iter: 2  value: 18058.98 mgc: 1.218442e-06 ustep: 1 
iter: 3  mgc: 3.574918e-13 
iter: 1  mgc: 3.574918e-13 
outer mgc:  0.05768585 
iter: 1  value: 18041.8 mgc: 1.580363 ustep: 1 
iter: 2  value: 18041.8 mgc: 4.042429e-07 ustep: 1 
iter: 3  mgc: 5.622169e-13 
iter: 1  mgc: 5.622169e-13 
outer mgc:  0.02180417 
iter: 1  value: 18020.91 mgc: 1.996915 ustep: 1 
iter: 2  value: 18020.91 mgc: 2.801021e-07 ustep: 1 
iter: 3  mgc: 6.350476e-13 
iter: 1  mgc: 6.350476e-13 
outer mgc:  0.0100835 
iter: 1  value: 18003.65 mgc: 1.640717 ustep: 1 
iter: 2  value: 18003.65 mgc: 8.55698e-08 ustep: 1 
iter: 3  mgc: 8.85958e-13 
iter: 1  mgc: 8.85958e-13 
outer mgc:  0.01265358 
iter: 1  value: 17982.71 mgc: 2.120968 ustep: 1 
iter: 2  value: 17982.71 mgc: 5.696913e-08 ustep: 1 
iter: 3  mgc: 1.482814e-12 
iter: 1  mgc: 1.482814e-12 
outer mgc:  0.00475363 
iter: 1  value: 17965.41 mgc: 1.69733 ustep: 1 
iter: 2  value: 17965.41 mgc: 1.788861e-08 ustep: 1 
mgc: 3.736567e-12 
iter: 1  mgc: 3.736567e-12 
outer mgc:  0.003086773 
iter: 1  value: 17944.46 mgc: 2.10431 ustep: 1 
iter: 2  value: 17944.46 mgc: 1.24933e-08 ustep: 1 
mgc: 2.421618e-12 
iter: 1  mgc: 2.421618e-12 
outer mgc:  0.003115872 
iter: 1  value: 17927.14 mgc: 1.640222 ustep: 1 
iter: 2  mgc: 4.050698e-09 
iter: 1  mgc: 4.050698e-09 
outer mgc:  0.002090937 
iter: 1  value: 17906.18 mgc: 2.042158 ustep: 1 
iter: 2  mgc: 2.810428e-09 
iter: 1  mgc: 2.810428e-09 
outer mgc:  0.0009265751 
iter: 1  value: 17888.85 mgc: 1.638754 ustep: 1 
iter: 2  mgc: 8.788046e-10 
iter: 1  mgc: 8.788046e-10 
outer mgc:  0.0004165317 
iter: 1  value: 17867.88 mgc: 2.086615 ustep: 1 
iter: 2  mgc: 5.92411e-10 
iter: 1  mgc: 5.92411e-10 
outer mgc:  0.0003324638 
iter: 1  value: 17850.56 mgc: 1.676289 ustep: 1 
iter: 2  mgc: 1.823923e-10 
iter: 1  mgc: 1.823923e-10 
outer mgc:  0.0002361518 
iter: 1  value: 17829.59 mgc: 2.104517 ustep: 1 
iter: 2  mgc: 1.245812e-10 
iter: 1  mgc: 1.245812e-10 
outer mgc:  0.0002276467 
iter: 1  value: 17812.26 mgc: 1.659537 ustep: 1 
iter: 2  mgc: 4.374701e-11 
iter: 1  mgc: 4.374701e-11 
outer mgc:  0.0001739858 
iter: 1  mgc: 4.374701e-11 
iter: 1  mgc: 4.374701e-11 
outer mgc:  0.0001739858 
iter: 1  value: 17812.27 mgc: 0.005735268 ustep: 1 
iter: 2  value: 17812.27 mgc: 1.569155e-07 ustep: 1 
iter: 3  mgc: 4.164336e-11 
outer mgc:  0.451413 
iter: 1  value: 17812.25 mgc: 0.005734795 ustep: 1 
iter: 2  value: 17812.25 mgc: 1.567408e-07 ustep: 1 
iter: 3  mgc: 6.808265e-11 
outer mgc:  0.4515972 
iter: 1  value: 17812.26 mgc: 0.002891549 ustep: 1 
iter: 2  value: 17812.26 mgc: 9.400419e-08 ustep: 1 
iter: 3  mgc: 5.057332e-11 
outer mgc:  0.2388398 
iter: 1  value: 17812.25 mgc: 0.002890532 ustep: 1 
iter: 2  value: 17812.25 mgc: 9.387796e-08 ustep: 1 
iter: 3  mgc: 4.710166e-11 
outer mgc:  0.2390467 
iter: 1  value: 17812.26 mgc: 0.005409494 ustep: 1 
iter: 2  value: 17812.26 mgc: 7.805928e-08 ustep: 1 
iter: 3  mgc: 6.981171e-11 
outer mgc:  0.3267398 
iter: 1  value: 17812.26 mgc: 0.005406578 ustep: 1 
iter: 2  value: 17812.26 mgc: 7.794897e-08 ustep: 1 
iter: 3  mgc: 5.324297e-11 
outer mgc:  0.3263436 
iter: 1  value: 17812.26 mgc: 0.003081778 ustep: 1 
iter: 2  value: 17812.26 mgc: 2.837064e-08 ustep: 1 
iter: 3  mgc: 4.305134e-11 
outer mgc:  0.1681447 
iter: 1  value: 17812.26 mgc: 0.00308075 ustep: 1 
iter: 2  value: 17812.26 mgc: 2.830714e-08 ustep: 1 
iter: 3  mgc: 4.444534e-11 
outer mgc:  0.1679215 
iter: 1  value: 17812.33 mgc: 224.104 ustep: 1 
iter: 2  value: 17812.33 mgc: 4.66295e-07 ustep: 1 
iter: 3  mgc: 5.474932e-11 
outer mgc:  0.03967948 
iter: 1  value: 17812.18 mgc: 224.7773 ustep: 1 
iter: 2  value: 17812.18 mgc: 4.654917e-07 ustep: 1 
iter: 3  mgc: 3.951151e-11 
outer mgc:  0.03947313 
iter: 1  value: 17812.34 mgc: 224.322 ustep: 1 
iter: 2  value: 17812.34 mgc: 1.251508e-06 ustep: 1 
iter: 3  mgc: 5.283507e-11 
outer mgc:  0.03198825 
iter: 1  value: 17812.17 mgc: 224.5465 ustep: 1 
iter: 2  value: 17812.17 mgc: 1.249471e-06 ustep: 1 
iter: 3  mgc: 4.310929e-11 
outer mgc:  0.03184304 
iter: 1  value: 17812.26 mgc: 3.809819e-05 ustep: 1 
mgc: 4.00211e-11 
outer mgc:  0.0001739825 
iter: 1  value: 17812.26 mgc: 3.809792e-05 ustep: 1 
mgc: 5.232215e-11 
outer mgc:  0.0001739887 
iter: 1  value: 17812.24 mgc: 0.004349832 ustep: 1 
iter: 2  value: 17812.24 mgc: 1.404167e-07 ustep: 1 
iter: 3  mgc: 4.477108e-11 
outer mgc:  0.1514598 
iter: 1  value: 17812.27 mgc: 0.004347316 ustep: 1 
iter: 2  value: 17812.27 mgc: 1.401004e-07 ustep: 1 
iter: 3  mgc: 4.401923e-11 
outer mgc:  0.1517725 
[Sat Aug 14 22:50:37 2021]
Finished job 0.
1 of 1 steps (100%) done

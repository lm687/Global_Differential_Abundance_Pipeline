Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:52:29 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4364.786623 
final  value 4251.482577 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1238.598 mgc: 88.12727 ustep: 1 
iter: 2  value: 1141.417 mgc: 61.25564 ustep: 0.2494656 
iter: 3  value: 909.6336 mgc: 125.2835 ustep: 0.4995153 
iter: 4  value: 686.9488 mgc: 68.03365 ustep: 0.0737805 
iter: 5  value: 674.8211 mgc: 33.92797 ustep: 0.2716985 
iter: 6  value: 674.7266 mgc: 2.857806 ustep: 0.5212949 
iter: 7  value: 674.7265 mgc: 0.08198502 ustep: 0.7220354 
iter: 8  value: 674.7265 mgc: 0.0007445854 ustep: 0.8497417 
iter: 9  value: 674.7265 mgc: 1.115727e-05 ustep: 0.9218222 
iter: 10  value: 674.7265 mgc: 8.917462e-08 ustep: 0.9601197 
mgc: 3.454051e-10 
iter: 1  mgc: 3.454051e-10 
Matching hessian patterns... Done
outer mgc:  234.9514 
iter: 1  value: 512.5462 mgc: 28.79873 ustep: 1 
iter: 2  value: 511.4156 mgc: 3.692728 ustep: 1 
iter: 3  value: 511.4155 mgc: 0.05020747 ustep: 1 
iter: 4  value: 511.4155 mgc: 1.031682e-05 ustep: 1 
iter: 5  mgc: 1.229601e-12 
iter: 1  mgc: 1.229601e-12 
outer mgc:  16.65932 
iter: 1  value: 499.1209 mgc: 22.33989 ustep: 1 
iter: 2  value: 499.0101 mgc: 1.428019 ustep: 1 
iter: 3  value: 499.0101 mgc: 0.0065318 ustep: 1 
iter: 4  value: 499.0101 mgc: 3.297966e-07 ustep: 1 
iter: 5  mgc: 3.053113e-14 
iter: 1  mgc: 3.053113e-14 
outer mgc:  50.22393 
iter: 1  value: 506.4004 mgc: 45.38473 ustep: 1 
iter: 2  value: 485.9135 mgc: 15.6128 ustep: 1 
iter: 3  value: 485.8457 mgc: 1.177305 ustep: 1 
iter: 4  value: 485.8457 mgc: 0.01007567 ustep: 1 
iter: 5  value: 485.8457 mgc: 1.087819e-06 ustep: 1 
iter: 6  mgc: 3.974598e-14 
iter: 1  mgc: 3.974598e-14 
outer mgc:  28.3767 
iter: 1  value: 492.8003 mgc: 24.3007 ustep: 1 
iter: 2  value: 492.2122 mgc: 2.836649 ustep: 1 
iter: 3  value: 492.212 mgc: 0.08708038 ustep: 1 
iter: 4  value: 492.212 mgc: 8.828709e-05 ustep: 1 
iter: 5  mgc: 9.161738e-11 
iter: 1  value: 482.8618 mgc: 20.89154 ustep: 1 
iter: 2  value: 482.7726 mgc: 0.9571668 ustep: 1 
iter: 3  value: 482.7726 mgc: 0.003583856 ustep: 1 
iter: 4  value: 482.7726 mgc: 4.934719e-08 ustep: 1 
mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  37.70254 
iter: 1  value: 485.2251 mgc: 16.41022 ustep: 1 
iter: 2  value: 484.9498 mgc: 1.591572 ustep: 1 
iter: 3  value: 484.9498 mgc: 0.01749449 ustep: 1 
iter: 4  value: 484.9498 mgc: 3.974578e-06 ustep: 1 
iter: 5  mgc: 3.508305e-13 
iter: 1  value: 478.9505 mgc: 8.503375 ustep: 1 
iter: 2  value: 478.9423 mgc: 0.3522279 ustep: 1 
iter: 3  value: 478.9423 mgc: 0.0008954374 ustep: 1 
iter: 4  mgc: 5.84613e-09 
iter: 1  mgc: 5.84613e-09 
outer mgc:  7.517501 
iter: 1  value: 477.9049 mgc: 4.056865 ustep: 1 
iter: 2  value: 477.9031 mgc: 0.1209724 ustep: 1 
iter: 3  value: 477.9031 mgc: 0.0003282693 ustep: 1 
iter: 4  mgc: 2.439365e-09 
iter: 1  mgc: 2.439365e-09 
outer mgc:  5.498076 
iter: 1  value: 477.2975 mgc: 3.792135 ustep: 1 
iter: 2  value: 477.2969 mgc: 0.09426201 ustep: 1 
iter: 3  value: 477.2969 mgc: 6.60226e-05 ustep: 1 
iter: 4  mgc: 3.201084e-11 
iter: 1  mgc: 3.201084e-11 
outer mgc:  6.905996 
iter: 1  value: 477.4956 mgc: 3.957018 ustep: 1 
iter: 2  value: 477.4951 mgc: 0.05099456 ustep: 1 
iter: 3  value: 477.4951 mgc: 4.492319e-05 ustep: 1 
iter: 4  mgc: 3.727418e-11 
iter: 1  value: 477.3291 mgc: 2.427598 ustep: 1 
iter: 2  value: 477.3291 mgc: 0.01471726 ustep: 1 
iter: 3  value: 477.3291 mgc: 7.691582e-07 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  8.753293 
iter: 1  value: 477.2418 mgc: 3.57738 ustep: 1 
iter: 2  value: 477.2415 mgc: 0.04596498 ustep: 1 
iter: 3  value: 477.2415 mgc: 1.678065e-05 ustep: 1 
iter: 4  mgc: 3.276046e-12 
iter: 1  mgc: 3.276046e-12 
outer mgc:  3.725167 
iter: 1  value: 477.0682 mgc: 2.037646 ustep: 1 
iter: 2  value: 477.0681 mgc: 0.02481395 ustep: 1 
iter: 3  value: 477.0681 mgc: 4.729322e-06 ustep: 1 
iter: 4  mgc: 1.660894e-13 
iter: 1  mgc: 1.660894e-13 
outer mgc:  4.817614 
iter: 1  value: 477.03 mgc: 0.8205119 ustep: 1 
iter: 2  value: 477.03 mgc: 0.004474644 ustep: 1 
iter: 3  value: 477.03 mgc: 2.46946e-07 ustep: 1 
iter: 4  mgc: 1.762479e-14 
iter: 1  mgc: 1.762479e-14 
outer mgc:  4.6093 
iter: 1  value: 477.0115 mgc: 1.821338 ustep: 1 
iter: 2  value: 477.0115 mgc: 0.01117918 ustep: 1 
iter: 3  value: 477.0115 mgc: 8.551951e-07 ustep: 1 
iter: 4  mgc: 3.352874e-14 
iter: 1  value: 476.9763 mgc: 1.065952 ustep: 1 
iter: 2  value: 476.9763 mgc: 0.004127831 ustep: 1 
iter: 3  value: 476.9763 mgc: 1.159856e-07 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  1.373924 
iter: 1  value: 476.986 mgc: 0.4684351 ustep: 1 
iter: 2  value: 476.986 mgc: 0.0007602307 ustep: 1 
iter: 3  mgc: 5.632833e-09 
iter: 1  mgc: 5.632833e-09 
outer mgc:  0.5747073 
iter: 1  value: 476.9959 mgc: 0.4415575 ustep: 1 
iter: 2  value: 476.9959 mgc: 0.0006802082 ustep: 1 
iter: 3  mgc: 3.126602e-09 
iter: 1  value: 476.9831 mgc: 0.1520283 ustep: 1 
iter: 2  value: 476.9831 mgc: 8.097765e-05 ustep: 1 
iter: 3  mgc: 4.44822e-11 
iter: 1  mgc: 4.44822e-11 
outer mgc:  0.4051147 
iter: 1  value: 476.9741 mgc: 0.1529838 ustep: 1 
iter: 2  value: 476.9741 mgc: 7.101464e-05 ustep: 1 
iter: 3  mgc: 4.412737e-11 
iter: 1  mgc: 4.412737e-11 
outer mgc:  0.1857236 
iter: 1  value: 476.9703 mgc: 0.1568395 ustep: 1 
iter: 2  value: 476.9703 mgc: 7.517605e-05 ustep: 1 
iter: 3  mgc: 2.609934e-11 
iter: 1  value: 476.9732 mgc: 0.03229439 ustep: 1 
iter: 2  value: 476.9732 mgc: 4.642015e-06 ustep: 1 
iter: 3  mgc: 1.896261e-13 
iter: 1  mgc: 1.896261e-13 
outer mgc:  0.0545884 
iter: 1  value: 476.9759 mgc: 0.0814395 ustep: 1 
iter: 2  value: 476.9759 mgc: 1.493692e-05 ustep: 1 
iter: 3  mgc: 1.202594e-12 
iter: 1  value: 476.9738 mgc: 0.02248347 ustep: 1 
iter: 2  value: 476.9738 mgc: 1.080813e-06 ustep: 1 
iter: 3  mgc: 2.609024e-14 
iter: 1  mgc: 2.609024e-14 
outer mgc:  0.0263978 
iter: 1  value: 476.9742 mgc: 0.01466215 ustep: 1 
iter: 2  value: 476.9742 mgc: 9.60242e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.01562259 
iter: 1  value: 476.9745 mgc: 0.02216225 ustep: 1 
iter: 2  value: 476.9745 mgc: 1.227237e-06 ustep: 1 
iter: 3  mgc: 2.131628e-14 
iter: 1  value: 476.9742 mgc: 0.01175065 ustep: 1 
iter: 2  value: 476.9742 mgc: 3.479204e-07 ustep: 1 
iter: 3  mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  0.01292614 
iter: 1  value: 476.9741 mgc: 0.003281713 ustep: 1 
iter: 2  value: 476.9741 mgc: 4.71844e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.001668319 
iter: 1  value: 476.9738 mgc: 0.00508446 ustep: 1 
iter: 2  value: 476.9738 mgc: 1.537497e-07 ustep: 1 
mgc: 2.309264e-14 
iter: 1  value: 476.974 mgc: 0.00219406 ustep: 1 
iter: 2  value: 476.974 mgc: 2.674658e-08 ustep: 1 
mgc: 2.420286e-14 
iter: 1  mgc: 2.420286e-14 
outer mgc:  0.002651308 
iter: 1  value: 476.974 mgc: 0.0003038309 ustep: 1 
iter: 2  mgc: 2.110711e-09 
iter: 1  mgc: 2.110711e-09 
outer mgc:  0.0003941615 
iter: 1  value: 476.974 mgc: 0.00133415 ustep: 1 
iter: 2  mgc: 6.975445e-09 
iter: 1  mgc: 2.110711e-09 
iter: 1  mgc: 2.110711e-09 
outer mgc:  0.0003941615 
iter: 1  value: 476.9738 mgc: 0.05106943 ustep: 1 
iter: 2  value: 476.9738 mgc: 8.620928e-06 ustep: 1 
iter: 3  mgc: 6.301626e-13 
outer mgc:  0.05503441 
iter: 1  value: 476.9743 mgc: 0.05105571 ustep: 1 
iter: 2  value: 476.9743 mgc: 8.627781e-06 ustep: 1 
iter: 3  mgc: 6.410428e-13 
outer mgc:  0.054327 
iter: 1  value: 476.9743 mgc: 0.02628155 ustep: 1 
iter: 2  value: 476.9743 mgc: 3.103547e-06 ustep: 1 
iter: 3  mgc: 7.549517e-14 
outer mgc:  0.1890553 
iter: 1  value: 476.9739 mgc: 0.02627916 ustep: 1 
iter: 2  value: 476.9739 mgc: 3.104693e-06 ustep: 1 
iter: 3  mgc: 7.81597e-14 
outer mgc:  0.1895381 
iter: 1  value: 476.9744 mgc: 0.05440651 ustep: 1 
iter: 2  value: 476.9744 mgc: 7.290849e-06 ustep: 1 
iter: 3  mgc: 4.014566e-13 
outer mgc:  0.08597483 
iter: 1  value: 476.9737 mgc: 0.05440443 ustep: 1 
iter: 2  value: 476.9737 mgc: 7.295811e-06 ustep: 1 
iter: 3  mgc: 4.076739e-13 
outer mgc:  0.08676318 
iter: 1  value: 476.9735 mgc: 0.02718228 ustep: 1 
iter: 2  value: 476.9735 mgc: 1.81737e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.2344084 
iter: 1  value: 476.9747 mgc: 0.02717644 ustep: 1 
iter: 2  value: 476.9747 mgc: 1.814447e-06 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.2338968 
iter: 1  value: 476.9726 mgc: 0.003800761 ustep: 1 
iter: 2  value: 476.9726 mgc: 1.047165e-07 ustep: 1 
mgc: 1.598721e-14 
outer mgc:  0.008245034 
iter: 1  value: 476.9753 mgc: 0.003797894 ustep: 1 
iter: 2  value: 476.9753 mgc: 1.046301e-07 ustep: 1 
mgc: 2.68674e-14 
outer mgc:  0.008515425 
iter: 1  value: 476.9757 mgc: 0.009108751 ustep: 1 
iter: 2  value: 476.9757 mgc: 1.756958e-06 ustep: 1 
iter: 3  mgc: 7.061018e-14 
outer mgc:  0.06363746 
iter: 1  value: 476.9723 mgc: 0.009129793 ustep: 1 
iter: 2  value: 476.9723 mgc: 1.763035e-06 ustep: 1 
iter: 3  mgc: 6.306067e-14 
outer mgc:  0.06323116 
iter: 1  value: 476.9761 mgc: 0.01190984 ustep: 1 
iter: 2  value: 476.9761 mgc: 1.042346e-06 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.06441136 
iter: 1  value: 476.972 mgc: 0.01193702 ustep: 1 
iter: 2  value: 476.972 mgc: 1.046107e-06 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.06450475 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:52:30 2021]
Finished job 0.
1 of 1 steps (100%) done

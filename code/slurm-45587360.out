Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:25:48 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21863.483157 
final  value 19462.806407 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13557.75 mgc: 102.5582 ustep: 0.4367355 
iter: 2  value: 7973.597 mgc: 96.41659 ustep: 0.1263996 
iter: 3  value: 4493.755 mgc: 135.5975 ustep: 0.1040152 
iter: 4  value: 2713.95 mgc: 83.21674 ustep: 0.09275755 
iter: 5  value: 2011.117 mgc: 100.7366 ustep: 0.3046308 
iter: 6  value: 1904.187 mgc: 51.20751 ustep: 0.5519785 
iter: 7  value: 1892.42 mgc: 19.67454 ustep: 0.7429783 
iter: 8  value: 1892.414 mgc: 0.5613889 ustep: 0.8619757 
iter: 9  value: 1892.414 mgc: 0.002757734 ustep: 0.9284336 
iter: 10  value: 1892.414 mgc: 4.843069e-06 ustep: 0.9635562 
iter: 11  value: 1892.414 mgc: 1.074864e-08 ustep: 0.9816108 
mgc: 1.613787e-11 
iter: 1  mgc: 1.613787e-11 
Matching hessian patterns... Done
outer mgc:  699.3958 
iter: 1  value: 1621.282 mgc: 24.17604 ustep: 1 
iter: 2  value: 1576.434 mgc: 8.108769 ustep: 1 
iter: 3  value: 1576.26 mgc: 0.4692388 ustep: 1 
iter: 4  value: 1576.26 mgc: 0.004068974 ustep: 1 
iter: 5  value: 1576.26 mgc: 5.005441e-07 ustep: 1 
iter: 6  mgc: 3.744227e-14 
iter: 1  mgc: 3.744227e-14 
outer mgc:  470.1815 
iter: 1  value: 1584.836 mgc: 25.86677 ustep: 1 
iter: 2  value: 1583.159 mgc: 3.361258 ustep: 1 
iter: 3  value: 1583.158 mgc: 0.06169021 ustep: 1 
iter: 4  value: 1583.158 mgc: 2.276571e-05 ustep: 1 
iter: 5  mgc: 3.102518e-12 
iter: 1  value: 1459.238 mgc: 13.31205 ustep: 1 
iter: 2  value: 1459.158 mgc: 0.7995182 ustep: 1 
iter: 3  value: 1459.158 mgc: 0.003739937 ustep: 1 
iter: 4  value: 1459.158 mgc: 8.373375e-08 ustep: 1 
mgc: 2.883804e-14 
iter: 1  mgc: 2.883804e-14 
outer mgc:  177.7979 
iter: 1  value: 1424.963 mgc: 12.16609 ustep: 1 
iter: 2  value: 1423.861 mgc: 1.222893 ustep: 1 
iter: 3  value: 1423.861 mgc: 0.012971 ustep: 1 
iter: 4  value: 1423.861 mgc: 2.580997e-06 ustep: 1 
iter: 5  mgc: 1.963429e-13 
iter: 1  mgc: 1.963429e-13 
outer mgc:  236.083 
iter: 1  value: 1367.259 mgc: 7.522423 ustep: 1 
iter: 2  value: 1367.247 mgc: 0.249236 ustep: 1 
iter: 3  value: 1367.247 mgc: 0.0003402243 ustep: 1 
iter: 4  mgc: 6.401963e-10 
iter: 1  mgc: 6.401963e-10 
outer mgc:  158.435 
iter: 1  value: 1325.143 mgc: 12.27713 ustep: 1 
iter: 2  value: 1324.719 mgc: 0.8035778 ustep: 1 
iter: 3  value: 1324.719 mgc: 0.006699979 ustep: 1 
iter: 4  value: 1324.719 mgc: 6.75219e-07 ustep: 1 
iter: 5  mgc: 4.446443e-14 
iter: 1  mgc: 4.446443e-14 
outer mgc:  126.6531 
iter: 1  value: 1298.91 mgc: 13.26879 ustep: 1 
iter: 2  value: 1298.784 mgc: 0.4840726 ustep: 1 
iter: 3  value: 1298.784 mgc: 0.002112967 ustep: 1 
iter: 4  value: 1298.784 mgc: 1.13031e-07 ustep: 1 
iter: 5  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  138.9498 
iter: 1  value: 1260.711 mgc: 17.39226 ustep: 1 
iter: 2  value: 1252.791 mgc: 3.011897 ustep: 1 
iter: 3  value: 1252.787 mgc: 0.07521897 ustep: 1 
iter: 4  value: 1252.787 mgc: 5.254392e-05 ustep: 1 
iter: 5  mgc: 2.670975e-11 
iter: 1  mgc: 2.670975e-11 
outer mgc:  76.2765 
iter: 1  value: 1215.55 mgc: 7.326456 ustep: 1 
iter: 2  value: 1215.186 mgc: 0.8167921 ustep: 1 
iter: 3  value: 1215.186 mgc: 0.0117193 ustep: 1 
iter: 4  value: 1215.186 mgc: 2.439582e-06 ustep: 1 
iter: 5  mgc: 1.030287e-13 
iter: 1  value: 1264.184 mgc: 14.03471 ustep: 1 
iter: 2  value: 1261.799 mgc: 1.864579 ustep: 1 
iter: 3  value: 1261.799 mgc: 0.02998809 ustep: 1 
iter: 4  value: 1261.799 mgc: 7.75679e-06 ustep: 1 
iter: 5  mgc: 5.180301e-13 
iter: 1  mgc: 1.030287e-13 
outer mgc:  40.15912 
iter: 1  value: 1187.48 mgc: 8.252895 ustep: 1 
iter: 2  value: 1187.465 mgc: 0.2463341 ustep: 1 
iter: 3  value: 1187.465 mgc: 0.0003602004 ustep: 1 
iter: 4  mgc: 1.330871e-09 
iter: 1  mgc: 1.330871e-09 
outer mgc:  132.2248 
iter: 1  value: 1207.375 mgc: 18.74799 ustep: 1 
iter: 2  value: 1207.228 mgc: 1.237704 ustep: 1 
iter: 3  value: 1207.228 mgc: 0.003884169 ustep: 1 
iter: 4  value: 1207.228 mgc: 3.776798e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  value: 1180.516 mgc: 5.534409 ustep: 1 
iter: 2  value: 1180.515 mgc: 0.06354311 ustep: 1 
iter: 3  value: 1180.515 mgc: 1.388e-05 ustep: 1 
iter: 4  mgc: 1.453948e-12 
iter: 1  mgc: 1.453948e-12 
outer mgc:  79.76125 
iter: 1  value: 1174.885 mgc: 5.917641 ustep: 1 
iter: 2  value: 1174.88 mgc: 0.1090784 ustep: 1 
iter: 3  value: 1174.88 mgc: 6.574061e-05 ustep: 1 
iter: 4  mgc: 2.407674e-11 
iter: 1  mgc: 2.407674e-11 
outer mgc:  83.28658 
iter: 1  value: 1168.47 mgc: 7.167113 ustep: 1 
iter: 2  value: 1168.467 mgc: 0.1601067 ustep: 1 
iter: 3  value: 1168.467 mgc: 7.346603e-05 ustep: 1 
iter: 4  mgc: 1.533529e-11 
iter: 1  mgc: 1.533529e-11 
outer mgc:  25.17553 
iter: 1  value: 1165.384 mgc: 3.185964 ustep: 1 
iter: 2  value: 1165.383 mgc: 0.04970813 ustep: 1 
iter: 3  value: 1165.383 mgc: 1.743419e-05 ustep: 1 
iter: 4  mgc: 1.988631e-12 
iter: 1  value: 1166.283 mgc: 2.166786 ustep: 1 
iter: 2  value: 1166.283 mgc: 0.01390934 ustep: 1 
iter: 3  value: 1166.283 mgc: 1.644809e-06 ustep: 1 
iter: 4  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  22.51678 
iter: 1  value: 1164.136 mgc: 2.095613 ustep: 1 
iter: 2  value: 1164.136 mgc: 0.0136795 ustep: 1 
iter: 3  value: 1164.136 mgc: 7.594757e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 1165.583 mgc: 1.74274 ustep: 1 
iter: 2  value: 1165.583 mgc: 0.006455281 ustep: 1 
iter: 3  value: 1165.583 mgc: 1.748831e-07 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  18.48898 
iter: 1  value: 1165.098 mgc: 0.7645862 ustep: 1 
iter: 2  value: 1165.098 mgc: 0.002401465 ustep: 1 
iter: 3  value: 1165.098 mgc: 2.681693e-08 ustep: 1 
mgc: 3.230749e-14 
iter: 1  mgc: 3.230749e-14 
outer mgc:  12.61573 
iter: 1  value: 1163.926 mgc: 0.7367224 ustep: 1 
iter: 2  value: 1163.926 mgc: 0.0009021172 ustep: 1 
iter: 3  mgc: 2.405609e-09 
iter: 1  mgc: 2.405609e-09 
outer mgc:  5.011328 
iter: 1  value: 1163.692 mgc: 0.5217326 ustep: 1 
iter: 2  value: 1163.692 mgc: 0.0006177742 ustep: 1 
iter: 3  mgc: 1.233174e-09 
iter: 1  mgc: 1.233174e-09 
outer mgc:  5.831803 
iter: 1  value: 1163.207 mgc: 0.7720224 ustep: 1 
iter: 2  value: 1163.207 mgc: 0.0007654268 ustep: 1 
iter: 3  mgc: 3.305271e-09 
iter: 1  mgc: 3.305271e-09 
outer mgc:  9.025404 
iter: 1  value: 1162.978 mgc: 0.4751852 ustep: 1 
iter: 2  value: 1162.978 mgc: 0.0003482907 ustep: 1 
iter: 3  mgc: 5.30435e-10 
iter: 1  mgc: 5.30435e-10 
outer mgc:  6.549512 
iter: 1  value: 1162.797 mgc: 0.2764629 ustep: 1 
iter: 2  value: 1162.797 mgc: 8.758817e-05 ustep: 1 
iter: 3  mgc: 6.360246e-11 
iter: 1  mgc: 6.360246e-11 
outer mgc:  5.416989 
iter: 1  value: 1162.396 mgc: 0.2686677 ustep: 1 
iter: 2  value: 1162.396 mgc: 0.0001203066 ustep: 1 
iter: 3  mgc: 1.021068e-10 
iter: 1  mgc: 1.021068e-10 
outer mgc:  1.326252 
iter: 1  value: 1162.253 mgc: 0.2328826 ustep: 1 
iter: 2  value: 1162.253 mgc: 0.0001271202 ustep: 1 
iter: 3  mgc: 7.029577e-11 
iter: 1  mgc: 7.029577e-11 
outer mgc:  2.728739 
iter: 1  value: 1162.348 mgc: 0.2086783 ustep: 1 
iter: 2  value: 1162.348 mgc: 0.0003627198 ustep: 1 
iter: 3  mgc: 7.935848e-10 
iter: 1  mgc: 7.935848e-10 
outer mgc:  1.519611 
iter: 1  value: 1162.123 mgc: 0.1434626 ustep: 1 
iter: 2  value: 1162.123 mgc: 8.356288e-05 ustep: 1 
iter: 3  mgc: 2.716227e-11 
iter: 1  mgc: 2.716227e-11 
outer mgc:  1.233228 
iter: 1  value: 1162.004 mgc: 0.2908414 ustep: 1 
iter: 2  value: 1162.004 mgc: 0.0001618851 ustep: 1 
iter: 3  mgc: 2.097618e-10 
iter: 1  value: 1162.085 mgc: 0.1626093 ustep: 1 
iter: 2  value: 1162.085 mgc: 4.819898e-05 ustep: 1 
iter: 3  mgc: 9.550583e-12 
iter: 1  value: 1162.115 mgc: 0.08805274 ustep: 1 
iter: 2  value: 1162.115 mgc: 1.315199e-05 ustep: 1 
iter: 3  mgc: 5.195844e-13 
iter: 1  mgc: 5.195844e-13 
outer mgc:  1.168807 
iter: 1  value: 1162.074 mgc: 0.04585056 ustep: 1 
iter: 2  value: 1162.074 mgc: 7.596858e-06 ustep: 1 
iter: 3  mgc: 2.247091e-13 
iter: 1  mgc: 2.247091e-13 
outer mgc:  0.4426021 
iter: 1  value: 1161.991 mgc: 0.07618029 ustep: 1 
iter: 2  value: 1161.991 mgc: 9.532841e-06 ustep: 1 
iter: 3  mgc: 1.588951e-12 
iter: 1  mgc: 1.588951e-12 
outer mgc:  0.6785489 
iter: 1  value: 1161.844 mgc: 0.09650506 ustep: 1 
iter: 2  value: 1161.844 mgc: 1.09615e-05 ustep: 1 
iter: 3  mgc: 8.117951e-13 
iter: 1  mgc: 8.117951e-13 
outer mgc:  0.4353241 
iter: 1  value: 1161.815 mgc: 0.086825 ustep: 1 
iter: 2  value: 1161.815 mgc: 2.390525e-05 ustep: 1 
iter: 3  mgc: 1.759481e-12 
iter: 1  mgc: 1.759481e-12 
outer mgc:  0.6231769 
iter: 1  value: 1161.745 mgc: 0.1122801 ustep: 1 
iter: 2  value: 1161.745 mgc: 7.793868e-05 ustep: 1 
iter: 3  mgc: 3.810641e-11 
iter: 1  value: 1161.806 mgc: 0.02287082 ustep: 1 
iter: 2  value: 1161.806 mgc: 8.811772e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
iter: 1  value: 1161.811 mgc: 0.009880401 ustep: 1 
iter: 2  value: 1161.811 mgc: 1.644909e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.4014728 
iter: 1  value: 1161.799 mgc: 0.02673701 ustep: 1 
iter: 2  value: 1161.799 mgc: 1.125966e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.2738573 
iter: 1  value: 1161.791 mgc: 0.008035539 ustep: 1 
iter: 2  value: 1161.791 mgc: 2.830311e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.143534 
iter: 1  value: 1161.77 mgc: 0.01638444 ustep: 1 
iter: 2  value: 1161.77 mgc: 7.584073e-07 ustep: 1 
iter: 3  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  0.1174593 
iter: 1  value: 1161.764 mgc: 0.003594722 ustep: 1 
iter: 2  value: 1161.764 mgc: 7.264424e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.05288053 
iter: 1  value: 1161.754 mgc: 0.007242781 ustep: 1 
iter: 2  value: 1161.754 mgc: 1.126158e-07 ustep: 1 
mgc: 4.307665e-14 
iter: 1  mgc: 4.307665e-14 
outer mgc:  0.04638333 
iter: 1  value: 1161.739 mgc: 0.009519618 ustep: 1 
iter: 2  value: 1161.739 mgc: 3.716069e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.05160708 
iter: 1  value: 1161.743 mgc: 0.002903193 ustep: 1 
iter: 2  value: 1161.743 mgc: 8.6273e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.01278563 
iter: 1  value: 1161.748 mgc: 0.003556915 ustep: 1 
iter: 2  value: 1161.748 mgc: 3.56707e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.02272999 
iter: 1  value: 1161.745 mgc: 0.002217999 ustep: 1 
iter: 2  mgc: 8.728545e-09 
iter: 1  mgc: 8.728545e-09 
outer mgc:  0.003623303 
iter: 1  value: 1161.745 mgc: 0.0006446906 ustep: 1 
iter: 2  mgc: 1.582131e-09 
iter: 1  mgc: 8.728545e-09 
iter: 1  mgc: 8.728545e-09 
outer mgc:  0.003623303 
iter: 1  value: 1161.739 mgc: 0.03395142 ustep: 1 
iter: 2  value: 1161.739 mgc: 4.263895e-06 ustep: 1 
iter: 3  mgc: 7.144285e-14 
outer mgc:  0.9824464 
iter: 1  value: 1161.752 mgc: 0.03393282 ustep: 1 
iter: 2  value: 1161.752 mgc: 4.263283e-06 ustep: 1 
iter: 3  mgc: 7.444045e-14 
outer mgc:  0.9759776 
iter: 1  value: 1161.742 mgc: 0.0151827 ustep: 1 
iter: 2  value: 1161.742 mgc: 8.6251e-07 ustep: 1 
iter: 3  mgc: 2.68674e-14 
outer mgc:  0.6959752 
iter: 1  value: 1161.749 mgc: 0.01517212 ustep: 1 
iter: 2  value: 1161.749 mgc: 8.617237e-07 ustep: 1 
iter: 3  mgc: 4.03011e-14 
outer mgc:  0.6978439 
iter: 1  value: 1161.753 mgc: 0.06147307 ustep: 1 
iter: 2  value: 1161.753 mgc: 5.512119e-06 ustep: 1 
iter: 3  mgc: 1.352252e-13 
outer mgc:  1.123127 
iter: 1  value: 1161.739 mgc: 0.06147813 ustep: 1 
iter: 2  value: 1161.739 mgc: 5.518318e-06 ustep: 1 
iter: 3  mgc: 1.154632e-13 
outer mgc:  1.130147 
iter: 1  value: 1161.751 mgc: 0.03079295 ustep: 1 
iter: 2  value: 1161.751 mgc: 1.668217e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  1.422133 
iter: 1  value: 1161.741 mgc: 0.03079666 ustep: 1 
iter: 2  value: 1161.741 mgc: 1.669023e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  1.429473 
iter: 1  value: 1161.726 mgc: 0.008431428 ustep: 1 
iter: 2  value: 1161.726 mgc: 2.114613e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.01705336 
iter: 1  value: 1161.764 mgc: 0.008427327 ustep: 1 
iter: 2  value: 1161.764 mgc: 2.115536e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.01256054 
iter: 1  value: 1161.785 mgc: 0.03205389 ustep: 1 
iter: 2  value: 1161.785 mgc: 3.917938e-06 ustep: 1 
iter: 3  mgc: 9.237056e-14 
outer mgc:  0.2783708 
iter: 1  value: 1161.706 mgc: 0.03214425 ustep: 1 
iter: 2  value: 1161.706 mgc: 3.926976e-06 ustep: 1 
iter: 3  mgc: 9.681145e-14 
outer mgc:  0.2729685 
iter: 1  value: 1161.762 mgc: 0.03315544 ustep: 1 
iter: 2  value: 1161.762 mgc: 2.469117e-06 ustep: 1 
iter: 3  mgc: 3.952394e-14 
outer mgc:  0.3353802 
iter: 1  value: 1161.729 mgc: 0.03324877 ustep: 1 
iter: 2  value: 1161.729 mgc: 2.475685e-06 ustep: 1 
iter: 3  mgc: 2.936887e-14 
outer mgc:  0.3402884 
[Sun Aug 15 22:25:50 2021]
Finished job 0.
1 of 1 steps (100%) done

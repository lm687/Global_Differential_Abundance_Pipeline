Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 10:28:36 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4491.127036 
iter  10 value 3785.603372
iter  10 value 3785.603371
final  value 3785.603371 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3096.931 mgc: 120.2361 ustep: 0.4367355 
iter: 2  value: 2999.186 mgc: 98.38452 ustep: 0.1263996 
iter: 3  value: 2915.212 mgc: 144.4594 ustep: 0.1040152 
iter: 4  value: 1817.882 mgc: 135.4215 ustep: 0.09275755 
iter: 5  value: 1354.851 mgc: 140.9719 ustep: 0.08680754 
iter: 6  value: 998.1031 mgc: 129.6332 ustep: 0.08356576 
iter: 7  value: 969.1257 mgc: 135.603 ustep: 0.1568642 
iter: 8  value: 573.5109 mgc: 117.2452 ustep: 0.0610822 
iter: 9  value: 504.5566 mgc: 82.03102 ustep: 0.2472234 
iter: 10  value: 503.7233 mgc: 8.278922 ustep: 0.4972659 
iter: 11  value: 503.7218 mgc: 0.28592 ustep: 0.7052003 
iter: 12  value: 503.7218 mgc: 0.004368591 ustep: 0.8397781 
iter: 13  value: 503.7218 mgc: 7.873111e-05 ustep: 0.9164024 
iter: 14  value: 503.7218 mgc: 1.216006e-06 ustep: 0.9572934 
iter: 15  mgc: 9.256869e-09 
iter: 1  mgc: 9.256869e-09 
Matching hessian patterns... Done
outer mgc:  95.49756 
iter: 1  value: 496.1109 mgc: 28.67384 ustep: 1 
iter: 2  value: 485.4994 mgc: 8.652184 ustep: 1 
iter: 3  value: 485.4439 mgc: 0.4681559 ustep: 1 
iter: 4  value: 485.4439 mgc: 0.005640372 ustep: 1 
iter: 5  value: 485.4439 mgc: 9.821099e-07 ustep: 1 
iter: 6  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  117.1223 
iter: 1  value: 455.9833 mgc: 17.42459 ustep: 1 
iter: 2  value: 455.8647 mgc: 0.7553323 ustep: 1 
iter: 3  value: 455.8647 mgc: 0.006125007 ustep: 1 
iter: 4  value: 455.8647 mgc: 6.294615e-07 ustep: 1 
iter: 5  mgc: 3.913536e-14 
iter: 1  mgc: 3.913536e-14 
outer mgc:  59.64386 
iter: 1  value: 434.953 mgc: 22.69459 ustep: 1 
iter: 2  value: 434.4879 mgc: 2.316663 ustep: 1 
iter: 3  value: 434.4878 mgc: 0.02795201 ustep: 1 
iter: 4  value: 434.4878 mgc: 1.829809e-05 ustep: 1 
iter: 5  mgc: 9.939494e-12 
iter: 1  mgc: 9.939494e-12 
outer mgc:  23.1191 
iter: 1  value: 460.4195 mgc: 30.50586 ustep: 1 
iter: 2  value: 459.9317 mgc: 2.923443 ustep: 1 
iter: 3  value: 459.9316 mgc: 0.02619818 ustep: 1 
iter: 4  value: 459.9316 mgc: 5.229122e-06 ustep: 1 
iter: 5  mgc: 9.343637e-13 
iter: 1  value: 431.377 mgc: 11.68274 ustep: 1 
iter: 2  value: 431.3714 mgc: 0.2775551 ustep: 1 
iter: 3  value: 431.3714 mgc: 0.0003760389 ustep: 1 
iter: 4  mgc: 1.017423e-09 
iter: 1  mgc: 1.017423e-09 
outer mgc:  23.90163 
iter: 1  value: 429.5168 mgc: 8.696099 ustep: 1 
iter: 2  value: 429.4766 mgc: 0.5081733 ustep: 1 
iter: 3  value: 429.4766 mgc: 0.002071389 ustep: 1 
iter: 4  value: 429.4766 mgc: 1.101012e-07 ustep: 1 
iter: 5  mgc: 3.053113e-14 
iter: 1  mgc: 3.053113e-14 
outer mgc:  24.58013 
iter: 1  value: 425.4809 mgc: 5.03726 ustep: 1 
iter: 2  value: 425.4659 mgc: 0.2440311 ustep: 1 
iter: 3  value: 425.4659 mgc: 0.0007523159 ustep: 1 
iter: 4  value: 425.4659 mgc: 2.942025e-08 ustep: 1 
mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  10.3516 
iter: 1  value: 428.4267 mgc: 19.86922 ustep: 1 
iter: 2  value: 425.0465 mgc: 5.161344 ustep: 1 
iter: 3  value: 425.0411 mgc: 0.1711051 ustep: 1 
iter: 4  value: 425.0411 mgc: 0.0004041314 ustep: 1 
iter: 5  mgc: 3.554543e-09 
iter: 1  mgc: 3.554543e-09 
outer mgc:  30.74226 
iter: 1  value: 416.4974 mgc: 9.04241 ustep: 1 
iter: 2  value: 416.3116 mgc: 0.972077 ustep: 1 
iter: 3  value: 416.3116 mgc: 0.01502256 ustep: 1 
iter: 4  value: 416.3116 mgc: 9.517949e-06 ustep: 1 
iter: 5  mgc: 3.830491e-12 
iter: 1  mgc: 3.830491e-12 
outer mgc:  9.666862 
iter: 1  value: 420.3618 mgc: 9.03529 ustep: 1 
iter: 2  value: 420.3521 mgc: 0.2537001 ustep: 1 
iter: 3  value: 420.3521 mgc: 0.000849247 ustep: 1 
iter: 4  value: 420.3521 mgc: 2.031456e-08 ustep: 1 
mgc: 2.953193e-14 
iter: 1  value: 414.7881 mgc: 2.831238 ustep: 1 
iter: 2  value: 414.7881 mgc: 0.0236068 ustep: 1 
iter: 3  value: 414.7881 mgc: 4.98221e-06 ustep: 1 
iter: 4  mgc: 8.91065e-13 
iter: 1  mgc: 8.91065e-13 
outer mgc:  9.351226 
iter: 1  value: 413.3874 mgc: 4.830147 ustep: 1 
iter: 2  value: 413.3867 mgc: 0.06328821 ustep: 1 
iter: 3  value: 413.3867 mgc: 3.187665e-05 ustep: 1 
iter: 4  mgc: 1.252354e-11 
iter: 1  mgc: 1.252354e-11 
outer mgc:  11.53302 
iter: 1  value: 412.2195 mgc: 4.919891 ustep: 1 
iter: 2  value: 412.2134 mgc: 0.1920691 ustep: 1 
iter: 3  value: 412.2134 mgc: 0.0002598658 ustep: 1 
iter: 4  mgc: 1.035264e-09 
iter: 1  mgc: 1.035264e-09 
outer mgc:  7.121817 
iter: 1  value: 411.132 mgc: 5.229505 ustep: 1 
iter: 2  value: 411.1309 mgc: 0.07764814 ustep: 1 
iter: 3  value: 411.1309 mgc: 5.088976e-05 ustep: 1 
iter: 4  mgc: 3.054978e-11 
iter: 1  mgc: 3.054978e-11 
outer mgc:  5.905628 
iter: 1  value: 410.1345 mgc: 4.94798 ustep: 1 
iter: 2  value: 410.1269 mgc: 0.2247913 ustep: 1 
iter: 3  value: 410.1269 mgc: 0.0003897511 ustep: 1 
iter: 4  mgc: 3.292705e-09 
iter: 1  mgc: 3.292705e-09 
outer mgc:  6.92494 
iter: 1  value: 410.5857 mgc: 8.472452 ustep: 1 
iter: 2  value: 410.5838 mgc: 0.0890197 ustep: 1 
iter: 3  value: 410.5838 mgc: 6.748358e-05 ustep: 1 
iter: 4  mgc: 1.978151e-11 
iter: 1  value: 409.797 mgc: 4.41409 ustep: 1 
iter: 2  value: 409.7969 mgc: 0.02869107 ustep: 1 
iter: 3  value: 409.7969 mgc: 3.396406e-06 ustep: 1 
iter: 4  mgc: 1.119105e-13 
iter: 1  mgc: 1.119105e-13 
outer mgc:  2.479474 
iter: 1  value: 409.8483 mgc: 1.554679 ustep: 1 
iter: 2  value: 409.8483 mgc: 0.01885773 ustep: 1 
iter: 3  value: 409.8483 mgc: 2.820589e-06 ustep: 1 
iter: 4  mgc: 6.256107e-14 
iter: 1  mgc: 6.256107e-14 
outer mgc:  3.063475 
iter: 1  value: 409.9448 mgc: 0.7968854 ustep: 1 
iter: 2  value: 409.9448 mgc: 0.005321039 ustep: 1 
iter: 3  value: 409.9448 mgc: 4.307592e-07 ustep: 1 
iter: 4  mgc: 3.3612e-14 
iter: 1  mgc: 3.3612e-14 
outer mgc:  1.909443 
iter: 1  value: 409.5084 mgc: 2.109378 ustep: 1 
iter: 2  value: 409.5084 mgc: 0.004883141 ustep: 1 
iter: 3  value: 409.5084 mgc: 2.893577e-07 ustep: 1 
iter: 4  mgc: 3.334832e-14 
iter: 1  value: 409.769 mgc: 0.5253905 ustep: 1 
iter: 2  value: 409.769 mgc: 0.0006404322 ustep: 1 
iter: 3  value: 409.769 mgc: 1.058212e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.5780562 
iter: 1  value: 409.8206 mgc: 1.054557 ustep: 1 
iter: 2  value: 409.8206 mgc: 0.004775222 ustep: 1 
iter: 3  value: 409.8206 mgc: 1.395639e-07 ustep: 1 
iter: 4  mgc: 2.4869e-14 
iter: 1  value: 409.7744 mgc: 0.3491034 ustep: 1 
iter: 2  value: 409.7744 mgc: 0.00052533 ustep: 1 
iter: 3  mgc: 1.690783e-09 
iter: 1  mgc: 1.690783e-09 
outer mgc:  0.6002095 
iter: 1  value: 409.8034 mgc: 0.3611348 ustep: 1 
iter: 2  value: 409.8034 mgc: 0.0009219272 ustep: 1 
iter: 3  mgc: 5.970213e-09 
iter: 1  mgc: 5.970213e-09 
outer mgc:  1.074034 
iter: 1  value: 409.7959 mgc: 0.3005596 ustep: 1 
iter: 2  value: 409.7959 mgc: 0.0002049483 ustep: 1 
iter: 3  mgc: 6.04812e-10 
iter: 1  mgc: 6.04812e-10 
outer mgc:  0.1540602 
iter: 1  value: 409.7752 mgc: 0.1691289 ustep: 1 
iter: 2  value: 409.7752 mgc: 6.910827e-05 ustep: 1 
iter: 3  mgc: 1.566747e-11 
iter: 1  mgc: 1.566747e-11 
outer mgc:  0.1354478 
iter: 1  value: 409.7827 mgc: 0.07172593 ustep: 1 
iter: 2  value: 409.7827 mgc: 6.556636e-05 ustep: 1 
iter: 3  mgc: 1.043987e-11 
iter: 1  mgc: 1.043987e-11 
outer mgc:  0.1959367 
iter: 1  value: 409.7817 mgc: 0.0452091 ustep: 1 
iter: 2  value: 409.7817 mgc: 1.542525e-05 ustep: 1 
iter: 3  mgc: 1.402656e-12 
iter: 1  mgc: 1.402656e-12 
outer mgc:  0.05764532 
iter: 1  value: 409.7784 mgc: 0.008922186 ustep: 1 
iter: 2  value: 409.7784 mgc: 1.337503e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
iter: 1  mgc: 5.506706e-14 
outer mgc:  0.01432302 
iter: 1  value: 409.7802 mgc: 0.006736672 ustep: 1 
iter: 2  value: 409.7802 mgc: 4.098831e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.004034811 
iter: 1  value: 409.7797 mgc: 0.002613949 ustep: 1 
iter: 2  mgc: 8.102619e-09 
iter: 1  mgc: 8.102619e-09 
outer mgc:  0.001814135 
iter: 1  value: 409.7799 mgc: 0.001510308 ustep: 1 
iter: 2  value: 409.7799 mgc: 1.764125e-08 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.0003213785 
iter: 1  value: 409.7799 mgc: 0.0003058545 ustep: 1 
iter: 2  mgc: 7.240479e-10 
iter: 1  mgc: 7.240479e-10 
outer mgc:  9.1202e-05 
iter: 1  mgc: 7.240479e-10 
iter: 1  mgc: 7.240479e-10 
outer mgc:  9.1202e-05 
iter: 1  value: 409.7789 mgc: 0.03670854 ustep: 1 
iter: 2  value: 409.7789 mgc: 9.432644e-06 ustep: 1 
iter: 3  mgc: 6.790124e-13 
outer mgc:  0.05672682 
iter: 1  value: 409.7809 mgc: 0.03668634 ustep: 1 
iter: 2  value: 409.7809 mgc: 9.441024e-06 ustep: 1 
iter: 3  mgc: 6.834533e-13 
outer mgc:  0.05670621 
iter: 1  value: 409.7793 mgc: 0.01580544 ustep: 1 
iter: 2  value: 409.7793 mgc: 1.769399e-06 ustep: 1 
iter: 3  mgc: 4.485301e-14 
outer mgc:  0.1076768 
iter: 1  value: 409.7805 mgc: 0.01579489 ustep: 1 
iter: 2  value: 409.7805 mgc: 1.768373e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.1075937 
iter: 1  value: 409.7813 mgc: 0.05697399 ustep: 1 
iter: 2  value: 409.7813 mgc: 6.477605e-06 ustep: 1 
iter: 3  mgc: 1.918465e-13 
outer mgc:  0.1274743 
iter: 1  value: 409.7786 mgc: 0.05696311 ustep: 1 
iter: 2  value: 409.7786 mgc: 6.464997e-06 ustep: 1 
iter: 3  mgc: 1.563194e-13 
outer mgc:  0.1274951 
iter: 1  value: 409.781 mgc: 0.0299329 ustep: 1 
iter: 2  value: 409.781 mgc: 1.463904e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.2663084 
iter: 1  value: 409.779 mgc: 0.02992983 ustep: 1 
iter: 2  value: 409.779 mgc: 1.463975e-06 ustep: 1 
iter: 3  mgc: 2.810252e-14 
outer mgc:  0.2665109 
iter: 1  value: 409.7777 mgc: 0.006519308 ustep: 1 
iter: 2  value: 409.7777 mgc: 2.188502e-07 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.009629448 
iter: 1  value: 409.782 mgc: 0.006513297 ustep: 1 
iter: 2  value: 409.782 mgc: 2.187002e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.009652739 
iter: 1  value: 409.7831 mgc: 0.006627661 ustep: 1 
iter: 2  value: 409.7831 mgc: 1.374691e-06 ustep: 1 
iter: 3  mgc: 6.084022e-14 
outer mgc:  0.04309297 
iter: 1  value: 409.7767 mgc: 0.00664392 ustep: 1 
iter: 2  value: 409.7767 mgc: 1.37831e-06 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  0.04315624 
iter: 1  value: 409.7824 mgc: 0.01183338 ustep: 1 
iter: 2  value: 409.7824 mgc: 2.753813e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.04798633 
iter: 1  value: 409.7774 mgc: 0.01185642 ustep: 1 
iter: 2  value: 409.7774 mgc: 2.762077e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.04800846 
[Fri Aug 13 10:28:37 2021]
Finished job 0.
1 of 1 steps (100%) done

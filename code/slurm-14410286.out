Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:09:59 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4506.507608 
final  value 4108.258655 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3819.796 mgc: 5.797855 ustep: 1 
iter: 2  value: 3805.692 mgc: 3.940516 ustep: 0.8994163 
iter: 3  value: 3789.269 mgc: 2.722397 ustep: 0.772724 
iter: 4  value: 3786.959 mgc: 1.941845 ustep: 0.8790593 
iter: 5  value: 3786.856 mgc: 0.382705 ustep: 0.9375879 
iter: 6  value: 3786.856 mgc: 0.01132363 ustep: 0.9682944 
iter: 7  value: 3786.856 mgc: 0.0002611173 ustep: 0.9840211 
iter: 8  value: 3786.856 mgc: 3.070735e-06 ustep: 0.9919792 
iter: 9  value: 3786.856 mgc: 1.821951e-08 ustep: 0.9959819 
iter: 10  mgc: 5.400025e-11 
iter: 1  mgc: 5.400025e-11 
Matching hessian patterns... Done
outer mgc:  26.41648 
iter: 1  value: 3748.901 mgc: 1.213339 ustep: 1 
iter: 2  value: 3748.898 mgc: 0.09322179 ustep: 1 
iter: 3  value: 3748.898 mgc: 0.0008456548 ustep: 1 
iter: 4  value: 3748.898 mgc: 7.962626e-08 ustep: 1 
iter: 5  mgc: 4.107825e-15 
iter: 1  value: 3719.551 mgc: 7.193317 ustep: 1 
iter: 2  value: 3719.473 mgc: 0.6380433 ustep: 1 
iter: 3  value: 3719.473 mgc: 0.007001261 ustep: 1 
iter: 4  value: 3719.473 mgc: 2.411959e-06 ustep: 1 
iter: 5  mgc: 2.919956e-13 
iter: 1  mgc: 2.919956e-13 
outer mgc:  22.21112 
iter: 1  value: 3720.707 mgc: 71.26304 ustep: 1 
iter: 2  value: 3716.764 mgc: 6.106347 ustep: 1 
iter: 3  value: 3716.762 mgc: 0.1336217 ustep: 1 
iter: 4  value: 3716.762 mgc: 0.0002191009 ustep: 1 
iter: 5  mgc: 1.075782e-09 
iter: 1  mgc: 1.075782e-09 
outer mgc:  39.39198 
iter: 1  value: 3725.324 mgc: 7.028192 ustep: 1 
iter: 2  value: 3725.313 mgc: 0.2211916 ustep: 1 
iter: 3  value: 3725.313 mgc: 0.0004864676 ustep: 1 
iter: 4  mgc: 2.478985e-09 
iter: 1  value: 3705.329 mgc: 4.344958 ustep: 1 
iter: 2  value: 3705.326 mgc: 0.1107079 ustep: 1 
iter: 3  value: 3705.326 mgc: 0.0004143452 ustep: 1 
iter: 4  mgc: 3.773183e-09 
iter: 1  mgc: 3.773183e-09 
outer mgc:  21.52747 
iter: 1  value: 3709.293 mgc: 5.189277 ustep: 1 
iter: 2  value: 3709.285 mgc: 0.1404202 ustep: 1 
iter: 3  value: 3709.285 mgc: 0.0004765613 ustep: 1 
iter: 4  mgc: 2.173187e-09 
iter: 1  value: 3701.647 mgc: 2.736715 ustep: 1 
iter: 2  value: 3701.646 mgc: 0.04768678 ustep: 1 
iter: 3  value: 3701.646 mgc: 5.990672e-05 ustep: 1 
iter: 4  mgc: 5.843259e-11 
iter: 1  mgc: 5.843259e-11 
outer mgc:  11.78071 
iter: 1  value: 3698.676 mgc: 2.879623 ustep: 1 
iter: 2  value: 3698.676 mgc: 0.02573443 ustep: 1 
iter: 3  value: 3698.676 mgc: 1.998255e-05 ustep: 1 
iter: 4  mgc: 6.13376e-12 
iter: 1  mgc: 6.13376e-12 
outer mgc:  10.3083 
iter: 1  value: 3700.717 mgc: 4.226305 ustep: 1 
iter: 2  value: 3700.714 mgc: 0.08093021 ustep: 1 
iter: 3  value: 3700.714 mgc: 0.0003525587 ustep: 1 
iter: 4  mgc: 2.565319e-09 
iter: 1  mgc: 2.565319e-09 
outer mgc:  6.978396 
iter: 1  value: 3699.083 mgc: 2.57703 ustep: 1 
iter: 2  value: 3699.082 mgc: 0.05756536 ustep: 1 
iter: 3  value: 3699.082 mgc: 8.250619e-05 ustep: 1 
iter: 4  mgc: 1.441678e-10 
iter: 1  mgc: 1.441678e-10 
outer mgc:  4.837666 
iter: 1  value: 3699.783 mgc: 6.234909 ustep: 1 
iter: 2  value: 3699.762 mgc: 0.4249607 ustep: 1 
iter: 3  value: 3699.762 mgc: 0.002448457 ustep: 1 
iter: 4  value: 3699.762 mgc: 1.700535e-07 ustep: 1 
iter: 5  mgc: 8.992806e-15 
iter: 1  value: 3699.17 mgc: 1.305678 ustep: 1 
iter: 2  value: 3699.17 mgc: 0.018447 ustep: 1 
iter: 3  value: 3699.17 mgc: 5.629479e-06 ustep: 1 
iter: 4  mgc: 5.20306e-13 
iter: 1  mgc: 5.20306e-13 
outer mgc:  5.423798 
iter: 1  value: 3697.842 mgc: 1.679684 ustep: 1 
iter: 2  value: 3697.842 mgc: 0.009847621 ustep: 1 
iter: 3  value: 3697.842 mgc: 3.623449e-06 ustep: 1 
iter: 4  mgc: 1.887379e-13 
iter: 1  mgc: 1.887379e-13 
outer mgc:  2.729132 
iter: 1  value: 3697.415 mgc: 1.205816 ustep: 1 
iter: 2  value: 3697.415 mgc: 0.01518792 ustep: 1 
iter: 3  value: 3697.415 mgc: 2.585041e-06 ustep: 1 
iter: 4  mgc: 6.483702e-14 
iter: 1  mgc: 6.483702e-14 
outer mgc:  0.9087775 
iter: 1  value: 3696.842 mgc: 1.277818 ustep: 1 
iter: 2  value: 3696.842 mgc: 0.01083367 ustep: 1 
iter: 3  value: 3696.842 mgc: 1.934543e-06 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  value: 3697.122 mgc: 0.5050758 ustep: 1 
iter: 2  value: 3697.122 mgc: 0.001866039 ustep: 1 
iter: 3  value: 3697.122 mgc: 5.34052e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  1.429542 
iter: 1  value: 3696.788 mgc: 0.2420052 ustep: 1 
iter: 2  value: 3696.788 mgc: 0.000331015 ustep: 1 
iter: 3  mgc: 2.619666e-09 
iter: 1  mgc: 2.619666e-09 
outer mgc:  1.168439 
iter: 1  value: 3696.524 mgc: 0.1379895 ustep: 1 
iter: 2  value: 3696.524 mgc: 0.0003669536 ustep: 1 
iter: 3  mgc: 1.807278e-09 
iter: 1  value: 3696.198 mgc: 0.2009511 ustep: 1 
iter: 2  value: 3696.198 mgc: 0.0004959206 ustep: 1 
iter: 3  value: 3696.198 mgc: 1.323156e-08 ustep: 1 
mgc: 6.050715e-15 
iter: 1  mgc: 6.050715e-15 
outer mgc:  0.820538 
iter: 1  value: 3695.498 mgc: 0.4446918 ustep: 1 
iter: 2  value: 3695.498 mgc: 0.001742652 ustep: 1 
iter: 3  value: 3695.498 mgc: 4.336309e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.7422557 
iter: 1  value: 3694.528 mgc: 0.6262578 ustep: 1 
iter: 2  value: 3694.528 mgc: 0.00214909 ustep: 1 
iter: 3  value: 3694.528 mgc: 8.847179e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.2640295 
iter: 1  value: 3694.032 mgc: 0.2869239 ustep: 1 
iter: 2  value: 3694.032 mgc: 0.0006184621 ustep: 1 
iter: 3  mgc: 6.185284e-09 
iter: 1  mgc: 6.185284e-09 
outer mgc:  0.3065667 
iter: 1  value: 3693.189 mgc: 0.3885264 ustep: 1 
iter: 2  value: 3693.189 mgc: 0.0011253 ustep: 1 
iter: 3  value: 3693.189 mgc: 1.59696e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  value: 3691.83 mgc: 0.6465064 ustep: 1 
iter: 2  value: 3691.83 mgc: 0.00239049 ustep: 1 
iter: 3  value: 3691.83 mgc: 5.742148e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.2900919 
iter: 1  value: 3691.037 mgc: 0.6524421 ustep: 1 
iter: 2  value: 3691.037 mgc: 0.001253949 ustep: 1 
iter: 3  value: 3691.037 mgc: 2.195165e-08 ustep: 1 
mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  0.5000014 
iter: 1  value: 3689.998 mgc: 0.3390631 ustep: 1 
iter: 2  value: 3689.998 mgc: 0.0002947867 ustep: 1 
iter: 3  mgc: 5.252148e-09 
iter: 1  mgc: 5.252148e-09 
outer mgc:  0.1117715 
iter: 1  value: 3689.602 mgc: 0.2722333 ustep: 1 
iter: 2  value: 3689.602 mgc: 0.0001760369 ustep: 1 
iter: 3  mgc: 8.968293e-11 
iter: 1  mgc: 8.968293e-11 
outer mgc:  0.02715178 
iter: 1  value: 3689.209 mgc: 0.183528 ustep: 1 
iter: 2  value: 3689.209 mgc: 0.0001015412 ustep: 1 
iter: 3  mgc: 9.744472e-11 
iter: 1  mgc: 9.744472e-11 
outer mgc:  0.0173252 
iter: 1  value: 3688.377 mgc: 0.390859 ustep: 1 
iter: 2  value: 3688.377 mgc: 0.0003003158 ustep: 1 
iter: 3  mgc: 9.64989e-10 
iter: 1  mgc: 9.64989e-10 
outer mgc:  0.02595168 
iter: 1  value: 3688.15 mgc: 0.1022627 ustep: 1 
iter: 2  value: 3688.15 mgc: 2.339746e-05 ustep: 1 
iter: 3  mgc: 5.118572e-12 
iter: 1  mgc: 5.118572e-12 
outer mgc:  0.008179526 
iter: 1  value: 3688.128 mgc: 0.01224416 ustep: 1 
iter: 2  value: 3688.128 mgc: 2.94229e-07 ustep: 1 
iter: 3  mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.0007500661 
iter: 1  value: 3688.118 mgc: 0.004382707 ustep: 1 
iter: 2  value: 3688.118 mgc: 3.798563e-08 ustep: 1 
mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  5.38282e-05 
iter: 1  mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  5.38282e-05 
iter: 1  value: 3688.12 mgc: 0.006140669 ustep: 1 
iter: 2  value: 3688.12 mgc: 4.029862e-07 ustep: 1 
iter: 3  mgc: 1.176836e-14 
outer mgc:  0.07558886 
iter: 1  value: 3688.116 mgc: 0.006140822 ustep: 1 
iter: 2  value: 3688.116 mgc: 4.017408e-07 ustep: 1 
iter: 3  mgc: 7.827072e-15 
outer mgc:  0.07551339 
iter: 1  value: 3688.119 mgc: 0.003143903 ustep: 1 
iter: 2  value: 3688.119 mgc: 1.172378e-07 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.04655503 
iter: 1  value: 3688.117 mgc: 0.00314338 ustep: 1 
iter: 2  value: 3688.117 mgc: 1.170156e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.04653296 
iter: 1  value: 3688.118 mgc: 0.004785864 ustep: 1 
iter: 2  value: 3688.118 mgc: 1.548876e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.05819631 
iter: 1  value: 3688.119 mgc: 0.004782239 ustep: 1 
iter: 2  value: 3688.119 mgc: 1.546235e-07 ustep: 1 
iter: 3  mgc: 6.078471e-15 
outer mgc:  0.05823952 
iter: 1  value: 3688.118 mgc: 0.002747617 ustep: 1 
iter: 2  value: 3688.118 mgc: 5.761218e-08 ustep: 1 
iter: 3  mgc: 8.888723e-15 
outer mgc:  0.03339694 
iter: 1  value: 3688.118 mgc: 0.002745988 ustep: 1 
iter: 2  value: 3688.118 mgc: 5.754736e-08 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.03334133 
iter: 1  value: 3688.129 mgc: 0.03249574 ustep: 1 
iter: 2  value: 3688.129 mgc: 7.399093e-07 ustep: 1 
iter: 3  mgc: 7.126244e-15 
outer mgc:  0.02113009 
iter: 1  value: 3688.107 mgc: 0.03259341 ustep: 1 
iter: 2  value: 3688.107 mgc: 7.409302e-07 ustep: 1 
iter: 3  mgc: 9.325873e-15 
outer mgc:  0.02119917 
iter: 1  value: 3688.133 mgc: 0.03482666 ustep: 1 
iter: 2  value: 3688.133 mgc: 2.08023e-06 ustep: 1 
iter: 3  mgc: 3.127013e-14 
outer mgc:  0.01753345 
iter: 1  value: 3688.104 mgc: 0.03492546 ustep: 1 
iter: 2  value: 3688.104 mgc: 2.080254e-06 ustep: 1 
iter: 3  mgc: 1.647987e-14 
outer mgc:  0.01743015 
iter: 1  value: 3688.113 mgc: 0.002189745 ustep: 1 
iter: 2  mgc: 8.947552e-09 
outer mgc:  0.0005417315 
iter: 1  value: 3688.123 mgc: 0.002189058 ustep: 1 
iter: 2  mgc: 8.961425e-09 
outer mgc:  0.0005696976 
iter: 1  value: 3688.113 mgc: 0.003490293 ustep: 1 
iter: 2  value: 3688.113 mgc: 1.224568e-07 ustep: 1 
iter: 3  mgc: 6.737666e-15 
outer mgc:  0.02654055 
iter: 1  value: 3688.123 mgc: 0.00348777 ustep: 1 
iter: 2  value: 3688.123 mgc: 1.223661e-07 ustep: 1 
iter: 3  mgc: 6.994405e-15 
outer mgc:  0.02656352 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:10:03 2021]
Finished job 0.
1 of 1 steps (100%) done

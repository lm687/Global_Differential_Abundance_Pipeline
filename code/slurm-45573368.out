Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 01:02:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4375.772746 
iter  10 value 2476.670189
final  value 2476.626063 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2493.741 mgc: 2.411219 ustep: 0.6827823 
iter: 2  value: 2469.15 mgc: 1.372935 ustep: 0.5831969 
iter: 3  value: 2453.612 mgc: 1.201878 ustep: 0.5138385 
iter: 4  value: 2451.103 mgc: 0.8992918 ustep: 0.7168536 
iter: 5  value: 2445.869 mgc: 2.939526 ustep: 0.6083876 
iter: 6  value: 2444.824 mgc: 0.9934787 ustep: 0.5309203 
iter: 7  value: 2444.073 mgc: 0.4744913 ustep: 0.4790586 
iter: 8  value: 2442.954 mgc: 0.6594647 ustep: 0.4451324 
iter: 9  value: 2441.662 mgc: 0.9873306 ustep: 0.6672157 
iter: 10  value: 2440.971 mgc: 1.27297 ustep: 0.8168511 
iter: 11  value: 2440.961 mgc: 0.1074957 ustep: 0.9038077 
iter: 12  value: 2440.961 mgc: 0.01329232 ustep: 0.950693 
iter: 13  value: 2440.961 mgc: 0.0008761095 ustep: 0.9750374 
iter: 14  value: 2440.961 mgc: 3.242675e-05 ustep: 0.9874411 
iter: 15  value: 2440.961 mgc: 6.45779e-07 ustep: 0.9937013 
iter: 16  mgc: 6.610552e-09 
iter: 1  mgc: 6.610552e-09 
Matching hessian patterns... Done
outer mgc:  64.04197 
iter: 1  value: 2396.756 mgc: 1.144463 ustep: 1 
iter: 2  value: 2396.544 mgc: 0.1522833 ustep: 1 
iter: 3  value: 2396.543 mgc: 0.02042268 ustep: 1 
iter: 4  value: 2396.543 mgc: 0.0008102397 ustep: 1 
iter: 5  value: 2396.543 mgc: 1.490404e-06 ustep: 1 
iter: 6  mgc: 5.162676e-12 
iter: 1  mgc: 5.162676e-12 
outer mgc:  27.81683 
iter: 1  value: 2369.333 mgc: 1.483239 ustep: 1 
iter: 2  value: 2369.251 mgc: 0.1108959 ustep: 1 
iter: 3  value: 2369.251 mgc: 0.006376306 ustep: 1 
iter: 4  value: 2369.251 mgc: 2.442246e-05 ustep: 1 
iter: 5  mgc: 3.169908e-10 
iter: 1  mgc: 3.169908e-10 
outer mgc:  21.22541 
iter: 1  value: 2342.42 mgc: 1.256816 ustep: 1 
iter: 2  value: 2342.377 mgc: 0.161754 ustep: 1 
iter: 3  value: 2342.377 mgc: 0.003220256 ustep: 1 
iter: 4  value: 2342.377 mgc: 5.941314e-07 ustep: 1 
iter: 5  mgc: 5.440093e-14 
iter: 1  value: 2310.584 mgc: 6.447777 ustep: 1 
iter: 2  value: 2310.196 mgc: 0.4242346 ustep: 1 
iter: 3  value: 2310.196 mgc: 0.01334508 ustep: 1 
iter: 4  value: 2310.196 mgc: 3.388719e-06 ustep: 1 
iter: 5  mgc: 3.896883e-13 
iter: 1  mgc: 3.896883e-13 
outer mgc:  18.04672 
iter: 1  value: 2247.563 mgc: 3.752614 ustep: 1 
iter: 2  value: 2247.539 mgc: 0.09703686 ustep: 1 
iter: 3  value: 2247.539 mgc: 0.000581418 ustep: 1 
iter: 4  value: 2247.539 mgc: 3.418139e-08 ustep: 1 
iter: 5  mgc: 1.221245e-15 
iter: 1  value: 2235.123 mgc: 8.777009 ustep: 1 
iter: 2  value: 2235.074 mgc: 0.4118014 ustep: 1 
iter: 3  value: 2235.074 mgc: 0.004765313 ustep: 1 
iter: 4  value: 2235.074 mgc: 1.569269e-06 ustep: 1 
iter: 5  mgc: 1.657841e-13 
iter: 1  mgc: 1.657841e-13 
outer mgc:  18.8697 
iter: 1  value: 2455.558 mgc: 25.55045 ustep: 0.2787028 
iter: 2  value: 2396.858 mgc: 5.466168 ustep: 0.2824287 
iter: 3  value: 2393.157 mgc: 17.90782 ustep: 0.531487 
iter: 4  value: 2367.305 mgc: 15.72523 ustep: 0.4794318 
iter: 5  value: 2361.928 mgc: 11.46785 ustep: 0.6924409 
iter: 6  value: 2359.251 mgc: 7.610725 ustep: 0.5902425 
iter: 7  value: 2353.866 mgc: 13.43346 ustep: 0.7682956 
iter: 8  value: 2351.096 mgc: 0.3968769 ustep: 0.8765371 
iter: 9  value: 2347.029 mgc: 1.806011 ustep: 0.4242794 
iter: 10  value: 2346.419 mgc: 4.068312 ustep: 0.6514022 
iter: 11  value: 2346.401 mgc: 0.2053837 ustep: 0.8071142 
iter: 12  value: 2346.401 mgc: 0.02366969 ustep: 0.8984055 
iter: 13  value: 2346.401 mgc: 0.001460893 ustep: 0.9478478 
iter: 14  value: 2346.401 mgc: 4.396722e-05 ustep: 0.9735774 
iter: 15  value: 2346.401 mgc: 6.557038e-07 ustep: 0.9867016 
iter: 16  mgc: 4.882516e-09 
iter: 1  value: 2211.287 mgc: 6.573703 ustep: 1 
iter: 2  value: 2211.266 mgc: 0.1785396 ustep: 1 
iter: 3  value: 2211.266 mgc: 0.005223326 ustep: 1 
iter: 4  value: 2211.266 mgc: 5.980308e-06 ustep: 1 
iter: 5  mgc: 7.601503e-12 
iter: 1  mgc: 7.601503e-12 
outer mgc:  9.226251 
iter: 1  value: 2205.665 mgc: 4.021592 ustep: 1 
iter: 2  value: 2205.631 mgc: 0.1744432 ustep: 1 
iter: 3  value: 2205.631 mgc: 0.001363299 ustep: 1 
iter: 4  value: 2205.631 mgc: 1.8831e-07 ustep: 1 
iter: 5  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  23.05202 
iter: 1  value: 2199.378 mgc: 2.474797 ustep: 1 
iter: 2  value: 2199.378 mgc: 0.0155966 ustep: 1 
iter: 3  value: 2199.378 mgc: 2.25776e-05 ustep: 1 
iter: 4  mgc: 4.902345e-11 
iter: 1  mgc: 4.902345e-11 
outer mgc:  8.396995 
iter: 1  value: 2195.161 mgc: 1.416081 ustep: 1 
iter: 2  value: 2195.161 mgc: 0.01763436 ustep: 1 
iter: 3  value: 2195.161 mgc: 4.59788e-05 ustep: 1 
iter: 4  mgc: 1.855947e-10 
iter: 1  mgc: 1.855947e-10 
outer mgc:  3.912592 
iter: 1  value: 2190.494 mgc: 1.714763 ustep: 1 
iter: 2  value: 2190.494 mgc: 0.01219859 ustep: 1 
iter: 3  value: 2190.494 mgc: 8.413933e-06 ustep: 1 
iter: 4  mgc: 3.597123e-12 
iter: 1  mgc: 3.597123e-12 
outer mgc:  7.844422 
iter: 1  value: 2185.69 mgc: 0.7095718 ustep: 1 
iter: 2  value: 2185.69 mgc: 0.001656796 ustep: 1 
iter: 3  value: 2185.69 mgc: 1.705242e-07 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  3.394548 
iter: 1  value: 2187.335 mgc: 1.874134 ustep: 1 
iter: 2  value: 2187.334 mgc: 0.03834143 ustep: 1 
iter: 3  value: 2187.334 mgc: 2.63967e-05 ustep: 1 
iter: 4  mgc: 4.802974e-11 
iter: 1  mgc: 4.802974e-11 
outer mgc:  2.395977 
iter: 1  value: 2186.644 mgc: 1.228892 ustep: 1 
iter: 2  value: 2186.644 mgc: 0.01276807 ustep: 1 
iter: 3  value: 2186.644 mgc: 5.357935e-06 ustep: 1 
iter: 4  mgc: 1.185718e-12 
iter: 1  mgc: 1.185718e-12 
outer mgc:  2.039726 
iter: 1  value: 2184.018 mgc: 1.182007 ustep: 1 
iter: 2  value: 2184.018 mgc: 0.01154041 ustep: 1 
iter: 3  value: 2184.018 mgc: 9.539147e-06 ustep: 1 
iter: 4  mgc: 6.687539e-12 
iter: 1  mgc: 6.687539e-12 
outer mgc:  1.032472 
iter: 1  value: 2183.386 mgc: 0.5634357 ustep: 1 
iter: 2  value: 2183.386 mgc: 0.004686125 ustep: 1 
iter: 3  value: 2183.386 mgc: 1.540742e-06 ustep: 1 
iter: 4  mgc: 1.723066e-13 
iter: 1  value: 2183.637 mgc: 0.1589716 ustep: 1 
iter: 2  value: 2183.637 mgc: 0.000374173 ustep: 1 
iter: 3  mgc: 9.526459e-09 
iter: 1  mgc: 9.526459e-09 
outer mgc:  0.4974572 
iter: 1  value: 2183.245 mgc: 0.2576138 ustep: 1 
iter: 2  value: 2183.245 mgc: 0.0002835865 ustep: 1 
iter: 3  mgc: 3.651579e-09 
iter: 1  mgc: 3.651579e-09 
outer mgc:  0.4307334 
iter: 1  value: 2182.642 mgc: 0.2925522 ustep: 1 
iter: 2  value: 2182.642 mgc: 0.0002073486 ustep: 1 
iter: 3  mgc: 5.223391e-10 
iter: 1  mgc: 5.223391e-10 
outer mgc:  0.1585572 
iter: 1  value: 2181.801 mgc: 0.2940443 ustep: 1 
iter: 2  value: 2181.801 mgc: 0.0001384704 ustep: 1 
iter: 3  mgc: 4.747607e-10 
iter: 1  value: 2180.338 mgc: 0.5195519 ustep: 1 
iter: 2  value: 2180.338 mgc: 0.0003268193 ustep: 1 
iter: 3  mgc: 4.252424e-09 
iter: 1  mgc: 4.252424e-09 
outer mgc:  0.2333462 
iter: 1  value: 2178.667 mgc: 0.6078789 ustep: 1 
iter: 2  value: 2178.667 mgc: 0.0003146614 ustep: 1 
iter: 3  mgc: 2.140621e-10 
iter: 1  mgc: 2.140621e-10 
outer mgc:  0.3038608 
iter: 1  value: 2174.738 mgc: 1.54122 ustep: 1 
iter: 2  value: 2174.738 mgc: 0.0009208399 ustep: 1 
iter: 3  value: 2174.738 mgc: 1.294734e-08 ustep: 1 
mgc: 9.492407e-15 
iter: 1  mgc: 9.492407e-15 
outer mgc:  0.1729474 
iter: 1  value: 2172.043 mgc: 0.9729255 ustep: 1 
iter: 2  value: 2172.043 mgc: 0.0002094659 ustep: 1 
iter: 3  mgc: 7.451018e-11 
iter: 1  mgc: 7.451018e-11 
outer mgc:  0.1291685 
iter: 1  value: 2169.684 mgc: 1.240257 ustep: 1 
iter: 2  value: 2169.684 mgc: 0.0001110013 ustep: 1 
iter: 3  mgc: 5.106937e-11 
iter: 1  mgc: 5.106937e-11 
outer mgc:  0.09901772 
iter: 1  value: 2166.353 mgc: 2.394873 ustep: 1 
iter: 2  value: 2166.353 mgc: 0.0002565368 ustep: 1 
iter: 3  mgc: 1.105987e-09 
iter: 1  mgc: 1.105987e-09 
outer mgc:  0.05093821 
iter: 1  value: 2163.318 mgc: 2.204281 ustep: 1 
iter: 2  value: 2163.318 mgc: 0.00010821 ustep: 1 
iter: 3  mgc: 2.667511e-11 
iter: 1  mgc: 2.667511e-11 
outer mgc:  0.03781466 
iter: 1  value: 2160.602 mgc: 1.36254 ustep: 1 
iter: 2  value: 2160.602 mgc: 2.66378e-05 ustep: 1 
iter: 3  mgc: 1.173284e-12 
iter: 1  mgc: 1.173284e-12 
outer mgc:  0.02905229 
iter: 1  value: 2156.574 mgc: 1.539012 ustep: 1 
iter: 2  value: 2156.574 mgc: 2.380446e-05 ustep: 1 
iter: 3  mgc: 1.576517e-12 
iter: 1  mgc: 1.576517e-12 
outer mgc:  0.03615532 
iter: 1  value: 2153.171 mgc: 1.34244 ustep: 1 
iter: 2  value: 2153.171 mgc: 7.905022e-06 ustep: 1 
iter: 3  mgc: 1.990852e-12 
iter: 1  mgc: 1.990852e-12 
outer mgc:  0.0228467 
iter: 1  value: 2148.98 mgc: 1.907307 ustep: 1 
iter: 2  value: 2148.98 mgc: 1.262403e-05 ustep: 1 
iter: 3  mgc: 7.552181e-12 
iter: 1  mgc: 7.552181e-12 
outer mgc:  0.009478563 
iter: 1  value: 2145.563 mgc: 1.236811 ustep: 1 
iter: 2  value: 2145.563 mgc: 1.735736e-06 ustep: 1 
iter: 3  mgc: 1.620371e-13 
iter: 1  mgc: 1.620371e-13 
outer mgc:  0.01449139 
iter: 1  value: 2141.603 mgc: 1.825081 ustep: 1 
iter: 2  value: 2141.603 mgc: 1.049814e-06 ustep: 1 
iter: 3  mgc: 3.712586e-13 
iter: 1  mgc: 3.712586e-13 
outer mgc:  0.01272221 
iter: 1  value: 2138.332 mgc: 2.491934 ustep: 1 
iter: 2  value: 2138.332 mgc: 1.039142e-06 ustep: 1 
iter: 3  mgc: 3.41227e-13 
iter: 1  mgc: 3.41227e-13 
outer mgc:  0.007648354 
iter: 1  value: 2134.176 mgc: 4.339197 ustep: 1 
iter: 2  value: 2134.176 mgc: 1.341227e-06 ustep: 1 
iter: 3  mgc: 6.417089e-13 
iter: 1  mgc: 6.417089e-13 
outer mgc:  0.001490887 
iter: 1  value: 2130.73 mgc: 3.013494 ustep: 1 
iter: 2  value: 2130.73 mgc: 3.327664e-07 ustep: 1 
iter: 3  mgc: 7.940315e-13 
iter: 1  mgc: 7.940315e-13 
outer mgc:  0.003191127 
iter: 1  value: 2126.669 mgc: 2.117966 ustep: 1 
iter: 2  value: 2126.669 mgc: 6.465461e-08 ustep: 1 
mgc: 1.188827e-12 
iter: 1  mgc: 1.188827e-12 
outer mgc:  0.004007086 
iter: 1  value: 2123.285 mgc: 1.851456 ustep: 1 
iter: 2  value: 2123.285 mgc: 5.317045e-08 ustep: 1 
iter: 3  mgc: 6.306067e-13 
iter: 1  mgc: 6.306067e-13 
outer mgc:  0.002427069 
iter: 1  value: 2119.035 mgc: 3.750794 ustep: 1 
iter: 2  value: 2119.035 mgc: 1.699535e-07 ustep: 1 
iter: 3  mgc: 1.769251e-12 
iter: 1  mgc: 1.769251e-12 
outer mgc:  0.0006635959 
iter: 1  value: 2115.535 mgc: 2.961725 ustep: 1 
iter: 2  value: 2115.535 mgc: 3.914623e-08 ustep: 1 
iter: 3  mgc: 1.669331e-12 
iter: 1  mgc: 1.669331e-12 
outer mgc:  0.001258594 
iter: 1  value: 2111.425 mgc: 1.684266 ustep: 1 
iter: 2  mgc: 6.072599e-09 
iter: 1  mgc: 6.072599e-09 
outer mgc:  0.001559562 
iter: 1  value: 2108.022 mgc: 3.53025 ustep: 1 
iter: 2  mgc: 5.057226e-09 
iter: 1  mgc: 5.057226e-09 
outer mgc:  0.001119654 
iter: 1  value: 2103.806 mgc: 8.584776 ustep: 1 
iter: 2  value: 2103.806 mgc: 1.470699e-08 ustep: 1 
mgc: 8.054668e-12 
iter: 1  mgc: 8.054668e-12 
outer mgc:  0.0002200191 
iter: 1  value: 2100.326 mgc: 6.91886 ustep: 1 
iter: 2  mgc: 6.342089e-09 
iter: 1  mgc: 6.342089e-09 
outer mgc:  0.0002885296 
iter: 1  value: 2096.187 mgc: 5.436015 ustep: 1 
iter: 2  mgc: 1.023237e-09 
iter: 1  mgc: 1.023237e-09 
outer mgc:  0.0005214282 
iter: 1  value: 2092.758 mgc: 2.901942 ustep: 1 
iter: 2  mgc: 3.135826e-10 
iter: 1  mgc: 3.135826e-10 
outer mgc:  0.0003919314 
iter: 1  mgc: 3.135826e-10 
iter: 1  mgc: 3.135826e-10 
outer mgc:  0.0003919314 
iter: 1  value: 2092.758 mgc: 0.003499188 ustep: 1 
iter: 2  value: 2092.758 mgc: 1.145502e-07 ustep: 1 
iter: 3  mgc: 1.84926e-11 
outer mgc:  0.04074852 
iter: 1  value: 2092.758 mgc: 0.003499357 ustep: 1 
iter: 2  value: 2092.758 mgc: 1.143234e-07 ustep: 1 
iter: 3  mgc: 2.103473e-11 
outer mgc:  0.04027889 
iter: 1  value: 2092.758 mgc: 0.000795886 ustep: 1 
iter: 2  mgc: 9.714319e-09 
outer mgc:  0.01015263 
iter: 1  value: 2092.757 mgc: 0.0007965769 ustep: 1 
iter: 2  mgc: 9.738103e-09 
outer mgc:  0.009892216 
iter: 1  value: 2092.759 mgc: 0.002828596 ustep: 1 
iter: 2  value: 2092.759 mgc: 1.824936e-08 ustep: 1 
mgc: 2.701528e-11 
outer mgc:  0.04655637 
iter: 1  value: 2092.756 mgc: 0.002828027 ustep: 1 
iter: 2  value: 2092.756 mgc: 1.821553e-08 ustep: 1 
mgc: 3.176875e-11 
outer mgc:  0.04654838 
iter: 1  value: 2092.758 mgc: 0.0003788834 ustep: 1 
iter: 2  mgc: 1.643841e-10 
outer mgc:  0.00504074 
iter: 1  value: 2092.758 mgc: 0.0003785244 ustep: 1 
iter: 2  mgc: 1.966583e-10 
outer mgc:  0.005049324 
iter: 1  value: 2092.771 mgc: 118.2897 ustep: 1 
iter: 2  value: 2092.771 mgc: 3.830687e-07 ustep: 1 
iter: 3  mgc: 2.85314e-11 
outer mgc:  0.009640708 
iter: 1  value: 2092.744 mgc: 118.408 ustep: 1 
iter: 2  value: 2092.744 mgc: 3.834008e-07 ustep: 1 
iter: 3  mgc: 1.690714e-11 
outer mgc:  0.009950683 
iter: 1  value: 2092.776 mgc: 118.1706 ustep: 1 
iter: 2  value: 2092.776 mgc: 2.274606e-07 ustep: 1 
iter: 3  mgc: 1.721157e-11 
outer mgc:  0.005033396 
iter: 1  value: 2092.739 mgc: 118.5257 ustep: 1 
iter: 2  value: 2092.739 mgc: 2.269096e-07 ustep: 1 
iter: 3  mgc: 3.228084e-11 
outer mgc:  0.004236721 
iter: 1  value: 2092.758 mgc: 3.82684e-05 ustep: 1 
mgc: 2.286127e-11 
outer mgc:  0.0003919317 
iter: 1  value: 2092.758 mgc: 3.826804e-05 ustep: 1 
mgc: 2.186101e-11 
outer mgc:  0.000391931 
iter: 1  value: 2092.755 mgc: 0.002898655 ustep: 1 
iter: 2  value: 2092.755 mgc: 7.355608e-08 ustep: 1 
iter: 3  mgc: 4.455691e-11 
outer mgc:  0.02019914 
iter: 1  value: 2092.76 mgc: 0.002896349 ustep: 1 
iter: 2  value: 2092.76 mgc: 7.335845e-08 ustep: 1 
iter: 3  mgc: 3.844391e-11 
outer mgc:  0.02079243 
[Sun Aug 15 01:11:36 2021]
Finished job 0.
1 of 1 steps (100%) done

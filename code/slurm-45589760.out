Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 01:43:15 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0.6_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_4_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_4_0.6_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=4, beta_intensity=0.6, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0.6_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_4_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0.6_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0.6_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0.6_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 5529.928207 
iter  10 value 4839.400750
final  value 4839.285677 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4444.949 mgc: 3.671997 ustep: 0.6827823 
iter: 2  value: 4428.735 mgc: 8.141907 ustep: 0.8263238 
iter: 3  value: 4424.228 mgc: 4.751849 ustep: 0.9090326 
iter: 4  value: 4421.127 mgc: 6.609183 ustep: 0.9534367 
iter: 5  value: 4416.651 mgc: 5.187452 ustep: 0.608063 
iter: 6  value: 4412.447 mgc: 6.13957 ustep: 0.779806 
iter: 7  value: 4408.53 mgc: 4.406161 ustep: 0.415147 
iter: 8  value: 4407.876 mgc: 2.093582 ustep: 0.6443546 
iter: 9  value: 4407.858 mgc: 0.2391768 ustep: 0.8027367 
iter: 10  value: 4407.857 mgc: 0.02866221 ustep: 0.8959662 
iter: 11  value: 4407.857 mgc: 0.003658262 ustep: 0.9465602 
iter: 12  value: 4407.857 mgc: 0.0003901581 ustep: 0.972916 
iter: 13  value: 4407.857 mgc: 2.218786e-05 ustep: 0.9863664 
iter: 14  value: 4407.857 mgc: 6.469068e-07 ustep: 0.9931605 
iter: 15  mgc: 9.552479e-09 
iter: 1  mgc: 9.552479e-09 
Matching hessian patterns... Done
outer mgc:  33.21914 
iter: 1  value: 4359.313 mgc: 1.69271 ustep: 1 
iter: 2  value: 4359.284 mgc: 0.162724 ustep: 1 
iter: 3  value: 4359.284 mgc: 0.001326072 ustep: 1 
iter: 4  value: 4359.284 mgc: 1.723539e-07 ustep: 1 
iter: 5  mgc: 2.803313e-15 
iter: 1  value: 4333.609 mgc: 2.716332 ustep: 1 
iter: 2  value: 4333.553 mgc: 0.2215455 ustep: 1 
iter: 3  value: 4333.553 mgc: 0.003848231 ustep: 1 
iter: 4  value: 4333.553 mgc: 8.237413e-07 ustep: 1 
iter: 5  mgc: 6.824402e-14 
iter: 1  mgc: 6.824402e-14 
outer mgc:  23.22709 
iter: 1  value: 4416.942 mgc: 12.35983 ustep: 1 
iter: 2  value: 4374.82 mgc: 15.35038 ustep: 0.4367355 
iter: 3  value: 4349.5 mgc: 8.228474 ustep: 0.4176298 
iter: 4  value: 4329.004 mgc: 11.77515 ustep: 0.1159347 
iter: 5  value: 4328.482 mgc: 1.87684 ustep: 0.3405578 
iter: 6  value: 4328.398 mgc: 0.3962728 ustep: 0.583615 
iter: 7  value: 4328.392 mgc: 0.05654914 ustep: 0.7639706 
iter: 8  value: 4328.392 mgc: 0.00728276 ustep: 0.8740667 
iter: 9  value: 4328.392 mgc: 0.0005259673 ustep: 0.9349219 
iter: 10  value: 4328.392 mgc: 2.105955e-05 ustep: 0.9669169 
iter: 11  value: 4328.392 mgc: 4.277036e-07 ustep: 0.983321 
iter: 12  mgc: 4.364673e-09 
iter: 1  value: 4323.02 mgc: 4.559593 ustep: 1 
iter: 2  value: 4321.144 mgc: 1.674039 ustep: 1 
iter: 3  value: 4321.134 mgc: 0.1522482 ustep: 1 
iter: 4  value: 4321.134 mgc: 0.002045842 ustep: 1 
iter: 5  value: 4321.134 mgc: 4.067636e-07 ustep: 1 
iter: 6  mgc: 1.537659e-14 
iter: 1  mgc: 1.537659e-14 
outer mgc:  15.69276 
iter: 1  value: 4300.699 mgc: 4.044639 ustep: 1 
iter: 2  value: 4300.371 mgc: 0.9287682 ustep: 1 
iter: 3  value: 4300.371 mgc: 0.03088118 ustep: 1 
iter: 4  value: 4300.371 mgc: 5.748563e-05 ustep: 1 
iter: 5  mgc: 1.941872e-10 
iter: 1  mgc: 1.941872e-10 
outer mgc:  10.92131 
iter: 1  value: 4290.444 mgc: 3.522235 ustep: 1 
iter: 2  value: 4289.729 mgc: 0.5992656 ustep: 1 
iter: 3  value: 4289.728 mgc: 0.02581445 ustep: 1 
iter: 4  value: 4289.728 mgc: 0.0001190023 ustep: 1 
iter: 5  mgc: 2.301002e-09 
iter: 1  mgc: 2.301002e-09 
outer mgc:  17.95089 
iter: 1  value: 4289.167 mgc: 9.953816 ustep: 1 
iter: 2  value: 4279.979 mgc: 5.971819 ustep: 1 
iter: 3  value: 4279.955 mgc: 0.3060922 ustep: 1 
iter: 4  value: 4279.955 mgc: 0.003187367 ustep: 1 
iter: 5  value: 4279.955 mgc: 7.43942e-07 ustep: 1 
iter: 6  mgc: 5.373479e-14 
iter: 1  mgc: 5.373479e-14 
outer mgc:  10.97642 
iter: 1  value: 4290.787 mgc: 6.946497 ustep: 1 
iter: 2  value: 4289.883 mgc: 1.08942 ustep: 1 
iter: 3  value: 4289.883 mgc: 0.0497998 ustep: 1 
iter: 4  value: 4289.883 mgc: 8.469104e-05 ustep: 1 
iter: 5  mgc: 4.851828e-10 
iter: 1  value: 4278.385 mgc: 3.519192 ustep: 1 
iter: 2  value: 4278.331 mgc: 0.2767225 ustep: 1 
iter: 3  value: 4278.331 mgc: 0.001939441 ustep: 1 
iter: 4  value: 4278.331 mgc: 1.10268e-07 ustep: 1 
iter: 5  mgc: 6.550316e-15 
iter: 1  mgc: 6.550316e-15 
outer mgc:  9.047865 
iter: 1  value: 4277.391 mgc: 2.163898 ustep: 1 
iter: 2  value: 4277.388 mgc: 0.08820911 ustep: 1 
iter: 3  value: 4277.388 mgc: 0.0002198139 ustep: 1 
iter: 4  mgc: 1.30425e-09 
iter: 1  mgc: 1.30425e-09 
outer mgc:  3.216261 
iter: 1  value: 4272.495 mgc: 1.144692 ustep: 1 
iter: 2  value: 4272.494 mgc: 0.05012158 ustep: 1 
iter: 3  value: 4272.494 mgc: 0.0001113032 ustep: 1 
iter: 4  mgc: 5.577764e-10 
iter: 1  mgc: 5.577764e-10 
outer mgc:  4.210852 
iter: 1  value: 4272.678 mgc: 1.739472 ustep: 1 
iter: 2  value: 4272.674 mgc: 0.08425159 ustep: 1 
iter: 3  value: 4272.674 mgc: 0.0003325458 ustep: 1 
iter: 4  mgc: 9.646789e-09 
iter: 1  mgc: 9.646789e-09 
outer mgc:  6.494926 
iter: 1  value: 4272.78 mgc: 2.43159 ustep: 1 
iter: 2  value: 4272.775 mgc: 0.11672 ustep: 1 
iter: 3  value: 4272.775 mgc: 0.0004298755 ustep: 1 
iter: 4  mgc: 5.536544e-09 
iter: 1  mgc: 5.536544e-09 
outer mgc:  5.820962 
iter: 1  value: 4271.912 mgc: 1.635234 ustep: 1 
iter: 2  value: 4271.911 mgc: 0.0503401 ustep: 1 
iter: 3  value: 4271.911 mgc: 8.571466e-05 ustep: 1 
iter: 4  mgc: 2.463865e-10 
iter: 1  mgc: 2.463865e-10 
outer mgc:  2.138685 
iter: 1  value: 4271.11 mgc: 1.020355 ustep: 1 
iter: 2  value: 4271.11 mgc: 0.02619684 ustep: 1 
iter: 3  value: 4271.11 mgc: 2.130736e-05 ustep: 1 
iter: 4  mgc: 2.382006e-11 
iter: 1  mgc: 2.382006e-11 
outer mgc:  2.157764 
iter: 1  value: 4271.013 mgc: 0.8217047 ustep: 1 
iter: 2  value: 4271.013 mgc: 0.01182216 ustep: 1 
iter: 3  value: 4271.013 mgc: 5.698614e-06 ustep: 1 
iter: 4  mgc: 1.744382e-12 
iter: 1  mgc: 1.744382e-12 
outer mgc:  2.237692 
iter: 1  value: 4271.177 mgc: 0.8628384 ustep: 1 
iter: 2  value: 4271.177 mgc: 0.01808406 ustep: 1 
iter: 3  value: 4271.177 mgc: 8.838549e-06 ustep: 1 
iter: 4  mgc: 2.263967e-12 
iter: 1  mgc: 2.263967e-12 
outer mgc:  1.989292 
iter: 1  value: 4270.978 mgc: 0.3989103 ustep: 1 
iter: 2  value: 4270.978 mgc: 0.004770432 ustep: 1 
iter: 3  value: 4270.978 mgc: 8.123301e-07 ustep: 1 
iter: 4  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.7127425 
iter: 1  value: 4270.048 mgc: 0.3702832 ustep: 1 
iter: 2  value: 4270.048 mgc: 0.003019935 ustep: 1 
iter: 3  value: 4270.048 mgc: 2.17972e-07 ustep: 1 
iter: 4  mgc: 9.547918e-15 
iter: 1  value: 4270.814 mgc: 0.1319534 ustep: 1 
iter: 2  value: 4270.814 mgc: 0.000442175 ustep: 1 
iter: 3  value: 4270.814 mgc: 1.096165e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.2764659 
iter: 1  value: 4270.658 mgc: 0.1521574 ustep: 1 
iter: 2  value: 4270.658 mgc: 0.0001494748 ustep: 1 
iter: 3  mgc: 9.360743e-10 
iter: 1  value: 4270.745 mgc: 0.1072598 ustep: 1 
iter: 2  value: 4270.745 mgc: 0.0001638068 ustep: 1 
iter: 3  mgc: 8.075196e-10 
iter: 1  mgc: 8.075196e-10 
outer mgc:  0.3246482 
iter: 1  value: 4270.787 mgc: 0.05867716 ustep: 1 
iter: 2  value: 4270.787 mgc: 0.0001064641 ustep: 1 
iter: 3  mgc: 4.551062e-10 
iter: 1  mgc: 4.551062e-10 
outer mgc:  0.03224702 
iter: 1  value: 4270.795 mgc: 0.03054841 ustep: 1 
iter: 2  value: 4270.795 mgc: 4.070656e-05 ustep: 1 
iter: 3  mgc: 7.249512e-11 
iter: 1  value: 4270.777 mgc: 0.02303662 ustep: 1 
iter: 2  value: 4270.777 mgc: 1.467615e-05 ustep: 1 
iter: 3  mgc: 8.325785e-12 
iter: 1  value: 4270.782 mgc: 0.01061661 ustep: 1 
iter: 2  value: 4270.782 mgc: 3.116859e-06 ustep: 1 
iter: 3  mgc: 3.708145e-13 
iter: 1  mgc: 3.708145e-13 
outer mgc:  0.03788068 
iter: 1  value: 4270.789 mgc: 0.01298525 ustep: 1 
iter: 2  value: 4270.789 mgc: 3.645744e-06 ustep: 1 
iter: 3  mgc: 3.461675e-13 
iter: 1  mgc: 3.461675e-13 
outer mgc:  0.03832805 
iter: 1  value: 4270.803 mgc: 0.009942085 ustep: 1 
iter: 2  value: 4270.803 mgc: 1.810764e-06 ustep: 1 
iter: 3  mgc: 1.59206e-13 
iter: 1  mgc: 1.59206e-13 
outer mgc:  0.0101498 
iter: 1  value: 4270.788 mgc: 0.01288512 ustep: 1 
iter: 2  value: 4270.788 mgc: 4.263389e-06 ustep: 1 
iter: 3  mgc: 7.180923e-13 
iter: 1  value: 4270.797 mgc: 0.004926086 ustep: 1 
iter: 2  value: 4270.797 mgc: 5.879554e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  0.01423361 
iter: 1  value: 4270.797 mgc: 0.004432444 ustep: 1 
iter: 2  value: 4270.797 mgc: 5.116255e-07 ustep: 1 
iter: 3  mgc: 1.265654e-14 
iter: 1  mgc: 1.265654e-14 
outer mgc:  0.008088982 
iter: 1  value: 4270.803 mgc: 0.00268023 ustep: 1 
iter: 2  value: 4270.803 mgc: 2.085567e-07 ustep: 1 
iter: 3  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  0.004659011 
iter: 1  value: 4270.809 mgc: 0.00337711 ustep: 1 
iter: 2  value: 4270.809 mgc: 4.782074e-07 ustep: 1 
iter: 3  mgc: 1.44329e-14 
iter: 1  mgc: 1.44329e-14 
outer mgc:  0.005307901 
iter: 1  value: 4270.804 mgc: 0.004320998 ustep: 1 
iter: 2  value: 4270.804 mgc: 8.843864e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  0.003477445 
iter: 1  value: 4270.807 mgc: 0.004805766 ustep: 1 
iter: 2  value: 4270.807 mgc: 1.065835e-06 ustep: 1 
iter: 3  mgc: 5.817569e-14 
iter: 1  value: 4270.805 mgc: 0.00189005 ustep: 1 
iter: 2  value: 4270.805 mgc: 7.9229e-08 ustep: 1 
iter: 3  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  0.004096106 
iter: 1  value: 4270.807 mgc: 0.001452589 ustep: 1 
iter: 2  value: 4270.807 mgc: 3.250342e-08 ustep: 1 
iter: 3  mgc: 7.650131e-15 
iter: 1  mgc: 7.650131e-15 
outer mgc:  0.001426267 
iter: 1  value: 4270.807 mgc: 0.001115556 ustep: 1 
iter: 2  value: 4270.807 mgc: 4.079141e-08 ustep: 1 
iter: 3  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.0008828512 
iter: 1  value: 4270.806 mgc: 0.0008449796 ustep: 1 
iter: 2  value: 4270.806 mgc: 1.74504e-08 ustep: 1 
mgc: 9.103829e-15 
iter: 1  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.0008828512 
iter: 1  value: 4270.809 mgc: 0.008289701 ustep: 1 
iter: 2  value: 4270.809 mgc: 1.285043e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.03981962 
iter: 1  value: 4270.806 mgc: 0.008288238 ustep: 1 
iter: 2  value: 4270.806 mgc: 1.286536e-06 ustep: 1 
iter: 3  mgc: 5.173639e-14 
outer mgc:  0.0395609 
iter: 1  value: 4270.808 mgc: 0.004426481 ustep: 1 
iter: 2  value: 4270.808 mgc: 3.681358e-07 ustep: 1 
iter: 3  mgc: 1.287859e-14 
outer mgc:  0.04426029 
iter: 1  value: 4270.807 mgc: 0.004425622 ustep: 1 
iter: 2  value: 4270.807 mgc: 3.687437e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.04248614 
iter: 1  value: 4270.808 mgc: 0.008457248 ustep: 1 
iter: 2  value: 4270.808 mgc: 1.317734e-06 ustep: 1 
iter: 3  mgc: 5.251355e-14 
outer mgc:  0.03479087 
iter: 1  value: 4270.806 mgc: 0.008459839 ustep: 1 
iter: 2  value: 4270.806 mgc: 1.32039e-06 ustep: 1 
iter: 3  mgc: 5.273559e-14 
outer mgc:  0.03609081 
iter: 1  value: 4270.808 mgc: 0.004408947 ustep: 1 
iter: 2  value: 4270.808 mgc: 4.144981e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.04192931 
iter: 1  value: 4270.806 mgc: 0.004410282 ustep: 1 
iter: 2  value: 4270.806 mgc: 4.148109e-07 ustep: 1 
iter: 3  mgc: 1.221245e-14 
outer mgc:  0.04270086 
iter: 1  value: 4270.806 mgc: 0.003921011 ustep: 1 
iter: 2  value: 4270.806 mgc: 7.762027e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.02915678 
iter: 1  value: 4270.809 mgc: 0.00391586 ustep: 1 
iter: 2  value: 4270.809 mgc: 7.760049e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.02990087 
iter: 1  value: 4270.806 mgc: 0.003184058 ustep: 1 
iter: 2  value: 4270.806 mgc: 5.573816e-07 ustep: 1 
iter: 3  mgc: 1.332268e-14 
outer mgc:  0.02449977 
iter: 1  value: 4270.808 mgc: 0.003181319 ustep: 1 
iter: 2  value: 4270.808 mgc: 5.577525e-07 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.02531991 
iter: 1  value: 4270.813 mgc: 0.00674609 ustep: 1 
iter: 2  value: 4270.813 mgc: 1.348526e-06 ustep: 1 
iter: 3  mgc: 4.174439e-14 
outer mgc:  0.02374102 
iter: 1  value: 4270.801 mgc: 0.006761303 ustep: 1 
iter: 2  value: 4270.801 mgc: 1.350608e-06 ustep: 1 
iter: 3  mgc: 4.485301e-14 
outer mgc:  0.02340252 
iter: 1  value: 4270.815 mgc: 0.005844194 ustep: 1 
iter: 2  value: 4270.815 mgc: 4.875268e-07 ustep: 1 
iter: 3  mgc: 1.421085e-14 
outer mgc:  0.01680444 
iter: 1  value: 4270.799 mgc: 0.005856356 ustep: 1 
iter: 2  value: 4270.799 mgc: 4.881063e-07 ustep: 1 
iter: 3  mgc: 1.376677e-14 
outer mgc:  0.01644046 
iter: 1  value: 4270.818 mgc: 0.006014196 ustep: 1 
iter: 2  value: 4270.818 mgc: 1.588075e-06 ustep: 1 
iter: 3  mgc: 1.367795e-13 
outer mgc:  0.01160562 
iter: 1  value: 4270.796 mgc: 0.006027338 ustep: 1 
iter: 2  value: 4270.796 mgc: 1.587487e-06 ustep: 1 
iter: 3  mgc: 1.429967e-13 
outer mgc:  0.01137136 
iter: 1  value: 4270.807 mgc: 0.003742459 ustep: 1 
iter: 2  value: 4270.807 mgc: 2.809004e-07 ustep: 1 
iter: 3  mgc: 1.487699e-14 
outer mgc:  0.009956147 
iter: 1  value: 4270.808 mgc: 0.003738248 ustep: 1 
iter: 2  value: 4270.808 mgc: 2.805222e-07 ustep: 1 
iter: 3  mgc: 1.215694e-14 
outer mgc:  0.01071838 
iter: 1  value: 4270.802 mgc: 0.003569039 ustep: 1 
iter: 2  value: 4270.802 mgc: 5.358949e-07 ustep: 1 
iter: 3  mgc: 1.487699e-14 
outer mgc:  0.004351984 
iter: 1  value: 4270.812 mgc: 0.003565947 ustep: 1 
iter: 2  value: 4270.812 mgc: 5.361586e-07 ustep: 1 
iter: 3  mgc: 1.64313e-14 
outer mgc:  0.004555526 
iter: 1  value: 4270.809 mgc: 0.003176842 ustep: 1 
iter: 2  value: 4270.809 mgc: 3.379049e-07 ustep: 1 
iter: 3  mgc: 8.548717e-15 
outer mgc:  0.005179364 
iter: 1  value: 4270.805 mgc: 0.003177192 ustep: 1 
iter: 2  value: 4270.805 mgc: 3.375148e-07 ustep: 1 
iter: 3  mgc: 9.325873e-15 
outer mgc:  0.004986523 
iter: 1  value: 4270.796 mgc: 0.003427583 ustep: 1 
iter: 2  value: 4270.796 mgc: 2.591974e-07 ustep: 1 
iter: 3  mgc: 7.549517e-15 
outer mgc:  0.02530591 
iter: 1  value: 4270.819 mgc: 0.003425737 ustep: 1 
iter: 2  value: 4270.819 mgc: 2.591155e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.02622467 
[Mon Aug 16 01:43:17 2021]
Finished job 0.
1 of 1 steps (100%) done

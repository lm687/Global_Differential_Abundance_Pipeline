Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 19:56:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_diagREDM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_80_3_0_ModeldiagREDM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_diagREDM_NA_NA_NA_dataset1.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4339.518540 
iter  10 value 4165.969143
iter  10 value 4165.969143
final  value 4165.969143 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4115.028 mgc: 74.19408 ustep: 1 
iter: 2  value: 4085.308 mgc: 22.51502 ustep: 1 
iter: 3  value: 4082.41 mgc: 13.36085 ustep: 1 
iter: 4  value: 4082.387 mgc: 1.167555 ustep: 1 
iter: 5  value: 4082.387 mgc: 0.01354104 ustep: 1 
iter: 6  value: 4082.387 mgc: 1.906506e-06 ustep: 1 
iter: 7  mgc: 5.665135e-12 
iter: 1  mgc: 5.665135e-12 
Matching hessian patterns... Done
outer mgc:  22.54196 
iter: 1  value: 4171.809 mgc: 17.54251 ustep: 1 
iter: 2  value: 4171.498 mgc: 1.244587 ustep: 1 
iter: 3  value: 4171.498 mgc: 0.01540354 ustep: 1 
iter: 4  value: 4171.498 mgc: 3.70022e-06 ustep: 1 
iter: 5  mgc: 1.006759e-11 
iter: 1  value: 4080.107 mgc: 2.102636 ustep: 1 
iter: 2  value: 4080.106 mgc: 0.02334579 ustep: 1 
iter: 3  value: 4080.106 mgc: 4.818236e-06 ustep: 1 
iter: 4  mgc: 6.908918e-12 
iter: 1  mgc: 6.908918e-12 
outer mgc:  8.462553 
iter: 1  value: 4078.695 mgc: 6.364033 ustep: 1 
iter: 2  value: 4078.694 mgc: 0.1042844 ustep: 1 
iter: 3  value: 4078.694 mgc: 7.801505e-05 ustep: 1 
iter: 4  mgc: 6.395218e-11 
iter: 1  mgc: 6.395218e-11 
outer mgc:  9.325562 
iter: 1  value: 4075.543 mgc: 6.774697 ustep: 1 
iter: 2  value: 4075.542 mgc: 0.1259893 ustep: 1 
iter: 3  value: 4075.542 mgc: 0.0001414659 ustep: 1 
iter: 4  mgc: 2.057453e-10 
iter: 1  mgc: 2.057453e-10 
outer mgc:  12.50706 
iter: 1  value: 4070.482 mgc: 19.26302 ustep: 1 
iter: 2  value: 4070.147 mgc: 1.585037 ustep: 1 
iter: 3  value: 4070.147 mgc: 0.02287569 ustep: 1 
iter: 4  value: 4070.147 mgc: 5.038207e-06 ustep: 1 
iter: 5  mgc: 1.030406e-11 
iter: 1  mgc: 1.030406e-11 
outer mgc:  19.40246 
iter: 1  value: 4062.982 mgc: 13.59211 ustep: 1 
iter: 2  value: 4062.958 mgc: 0.573813 ustep: 1 
iter: 3  value: 4062.958 mgc: 0.002171146 ustep: 1 
iter: 4  value: 4062.958 mgc: 4.623281e-08 ustep: 1 
mgc: 7.275708e-12 
iter: 1  mgc: 7.275708e-12 
outer mgc:  6.848058 
iter: 1  value: 4060.631 mgc: 13.94244 ustep: 1 
iter: 2  value: 4060.445 mgc: 1.034689 ustep: 1 
iter: 3  value: 4060.445 mgc: 0.00978182 ustep: 1 
iter: 4  value: 4060.445 mgc: 9.032123e-07 ustep: 1 
iter: 5  mgc: 8.416434e-12 
iter: 1  mgc: 8.416434e-12 
outer mgc:  29.00347 
iter: 1  value: 4050.402 mgc: 4.785916 ustep: 1 
iter: 2  value: 4050.395 mgc: 0.2740308 ustep: 1 
iter: 3  value: 4050.395 mgc: 0.0003594509 ustep: 1 
iter: 4  mgc: 1.890044e-09 
iter: 1  mgc: 1.890044e-09 
outer mgc:  15.80401 
iter: 1  value: 4056.589 mgc: 11.27275 ustep: 1 
iter: 2  value: 4056.484 mgc: 0.8256349 ustep: 1 
iter: 3  value: 4056.484 mgc: 0.008338408 ustep: 1 
iter: 4  value: 4056.484 mgc: 9.049379e-07 ustep: 1 
iter: 5  mgc: 7.845724e-12 
iter: 1  value: 4050.786 mgc: 6.189802 ustep: 1 
iter: 2  value: 4050.78 mgc: 0.1621943 ustep: 1 
iter: 3  value: 4050.78 mgc: 0.0002316359 ustep: 1 
iter: 4  mgc: 5.150294e-10 
iter: 1  value: 4050.463 mgc: 4.221684 ustep: 1 
iter: 2  value: 4050.463 mgc: 0.06449418 ustep: 1 
iter: 3  value: 4050.463 mgc: 3.725084e-05 ustep: 1 
iter: 4  mgc: 1.155664e-11 
iter: 1  value: 4049.806 mgc: 2.032122 ustep: 1 
iter: 2  value: 4049.806 mgc: 0.01471304 ustep: 1 
iter: 3  value: 4049.806 mgc: 1.939569e-06 ustep: 1 
iter: 4  mgc: 5.361933e-12 
iter: 1  mgc: 5.361933e-12 
outer mgc:  3.444308 
iter: 1  value: 4049.504 mgc: 0.8776053 ustep: 1 
iter: 2  value: 4049.504 mgc: 0.002814513 ustep: 1 
iter: 3  value: 4049.504 mgc: 6.167132e-08 ustep: 1 
mgc: 6.969784e-12 
iter: 1  mgc: 6.969784e-12 
outer mgc:  3.616 
iter: 1  value: 4049.082 mgc: 1.367995 ustep: 1 
iter: 2  value: 4049.082 mgc: 0.01492978 ustep: 1 
iter: 3  value: 4049.082 mgc: 3.127166e-06 ustep: 1 
iter: 4  mgc: 7.362555e-12 
iter: 1  mgc: 7.362555e-12 
outer mgc:  7.302428 
iter: 1  value: 4048.437 mgc: 2.313946 ustep: 1 
iter: 2  value: 4048.437 mgc: 0.02474514 ustep: 1 
iter: 3  value: 4048.437 mgc: 5.326957e-06 ustep: 1 
iter: 4  mgc: 8.034018e-12 
iter: 1  mgc: 8.034018e-12 
outer mgc:  2.251911 
iter: 1  value: 4048.179 mgc: 4.988355 ustep: 1 
iter: 2  value: 4048.177 mgc: 0.09715462 ustep: 1 
iter: 3  value: 4048.177 mgc: 8.197994e-05 ustep: 1 
iter: 4  mgc: 5.911382e-11 
iter: 1  mgc: 5.911382e-11 
outer mgc:  4.660115 
iter: 1  value: 4047.718 mgc: 3.364202 ustep: 1 
iter: 2  value: 4047.718 mgc: 0.02859644 ustep: 1 
iter: 3  value: 4047.718 mgc: 5.968333e-06 ustep: 1 
iter: 4  mgc: 4.48841e-12 
iter: 1  mgc: 4.48841e-12 
outer mgc:  1.230809 
iter: 1  value: 4047.903 mgc: 2.484658 ustep: 1 
iter: 2  value: 4047.903 mgc: 0.04001208 ustep: 1 
iter: 3  value: 4047.903 mgc: 2.902168e-06 ustep: 1 
iter: 4  mgc: 4.097611e-12 
iter: 1  value: 4047.647 mgc: 0.6011549 ustep: 1 
iter: 2  value: 4047.647 mgc: 0.002386537 ustep: 1 
iter: 3  value: 4047.647 mgc: 1.160247e-08 ustep: 1 
mgc: 5.270895e-12 
iter: 1  mgc: 5.270895e-12 
outer mgc:  1.106844 
iter: 1  value: 4047.581 mgc: 0.3823901 ustep: 1 
iter: 2  value: 4047.581 mgc: 0.0005162554 ustep: 1 
iter: 3  mgc: 3.464724e-09 
iter: 1  mgc: 3.464724e-09 
outer mgc:  1.094282 
iter: 1  value: 4047.47 mgc: 0.7744227 ustep: 1 
iter: 2  value: 4047.47 mgc: 0.002858445 ustep: 1 
iter: 3  value: 4047.47 mgc: 3.561916e-08 ustep: 1 
mgc: 6.776357e-12 
iter: 1  mgc: 6.776357e-12 
outer mgc:  2.921979 
iter: 1  value: 4047.378 mgc: 0.2419709 ustep: 1 
iter: 2  value: 4047.378 mgc: 0.000586933 ustep: 1 
iter: 3  mgc: 4.780151e-09 
iter: 1  mgc: 4.780151e-09 
outer mgc:  1.19581 
iter: 1  value: 4047.312 mgc: 0.4912676 ustep: 1 
iter: 2  value: 4047.312 mgc: 0.001711045 ustep: 1 
iter: 3  value: 4047.312 mgc: 3.821549e-08 ustep: 1 
mgc: 4.593437e-12 
iter: 1  mgc: 4.593437e-12 
outer mgc:  0.7548247 
iter: 1  value: 4047.257 mgc: 0.3168955 ustep: 1 
iter: 2  value: 4047.257 mgc: 0.0004681244 ustep: 1 
iter: 3  mgc: 1.786236e-09 
iter: 1  value: 4047.165 mgc: 0.1886157 ustep: 1 
iter: 2  value: 4047.165 mgc: 0.0002406091 ustep: 1 
iter: 3  mgc: 9.601075e-11 
iter: 1  value: 4047.047 mgc: 0.722204 ustep: 1 
iter: 2  value: 4047.047 mgc: 0.002462342 ustep: 1 
iter: 3  value: 4047.047 mgc: 3.312052e-08 ustep: 1 
mgc: 2.985612e-12 
iter: 1  mgc: 2.985612e-12 
outer mgc:  3.822227 
iter: 1  value: 4046.626 mgc: 0.9739915 ustep: 1 
iter: 2  value: 4046.626 mgc: 0.003538272 ustep: 1 
iter: 3  value: 4046.626 mgc: 1.58107e-07 ustep: 1 
mgc: 2.138068e-12 
iter: 1  value: 4045.188 mgc: 2.329174 ustep: 1 
iter: 2  value: 4045.188 mgc: 0.04674788 ustep: 1 
iter: 3  value: 4045.188 mgc: 2.481087e-05 ustep: 1 
iter: 4  mgc: 6.78213e-12 
iter: 1  mgc: 6.78213e-12 
outer mgc:  7.826099 
iter: 1  value: 4115.647 mgc: 22.42117 ustep: 1 
iter: 2  value: 4115.602 mgc: 0.6190695 ustep: 1 
iter: 3  value: 4115.602 mgc: 0.0007950343 ustep: 1 
iter: 4  mgc: 2.048245e-09 
iter: 1  value: 4042.566 mgc: 3.057773 ustep: 1 
iter: 2  value: 4042.566 mgc: 0.06436667 ustep: 1 
iter: 3  value: 4042.566 mgc: 2.994025e-05 ustep: 1 
iter: 4  mgc: 7.084555e-12 
iter: 1  mgc: 7.084555e-12 
outer mgc:  5.472045 
iter: 1  value: 4036.535 mgc: 6.263709 ustep: 1 
iter: 2  value: 4036.53 mgc: 0.344461 ustep: 1 
iter: 3  value: 4036.53 mgc: 0.001204915 ustep: 1 
iter: 4  value: 4036.53 mgc: 1.692203e-08 ustep: 1 
mgc: 1.323039e-13 
iter: 1  value: 4149.726 mgc: 15.93234 ustep: 1 
iter: 2  value: 4149.722 mgc: 0.1772664 ustep: 1 
iter: 3  value: 4149.722 mgc: 7.554386e-05 ustep: 1 
iter: 4  mgc: 2.159062e-11 
iter: 1  mgc: 1.323039e-13 
outer mgc:  6.126564 
iter: 1  value: 4093.09 mgc: 9.323549 ustep: 1 
iter: 2  value: 4092.28 mgc: 2.573014 ustep: 1 
iter: 3  value: 4092.28 mgc: 0.08636086 ustep: 1 
iter: 4  value: 4092.28 mgc: 0.0001112398 ustep: 1 
iter: 5  mgc: 1.89688e-10 
iter: 1  value: 4037.357 mgc: 2.684828 ustep: 1 
iter: 2  value: 4037.356 mgc: 0.06581628 ustep: 1 
iter: 3  value: 4037.356 mgc: 4.378165e-05 ustep: 1 
iter: 4  mgc: 1.979705e-11 
iter: 1  mgc: 1.979705e-11 
outer mgc:  10.28003 
iter: 1  value: 4036.625 mgc: 2.01461 ustep: 1 
iter: 2  value: 4036.625 mgc: 0.03375823 ustep: 1 
iter: 3  value: 4036.625 mgc: 1.272918e-05 ustep: 1 
iter: 4  mgc: 2.127187e-12 
iter: 1  mgc: 2.127187e-12 
outer mgc:  2.862675 
iter: 1  value: 4036.956 mgc: 1.999094 ustep: 1 
iter: 2  value: 4036.956 mgc: 0.01875626 ustep: 1 
iter: 3  value: 4036.956 mgc: 4.695358e-06 ustep: 1 
iter: 4  mgc: 2.375877e-13 
iter: 1  mgc: 2.375877e-13 
outer mgc:  3.045561 
iter: 1  value: 4037.273 mgc: 1.044206 ustep: 1 
iter: 2  value: 4037.273 mgc: 0.006311042 ustep: 1 
iter: 3  value: 4037.273 mgc: 5.027166e-07 ustep: 1 
iter: 4  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.7332764 
iter: 1  value: 4037.669 mgc: 0.6382448 ustep: 1 
iter: 2  value: 4037.669 mgc: 0.004200907 ustep: 1 
iter: 3  value: 4037.669 mgc: 1.746762e-07 ustep: 1 
mgc: 1.114664e-13 
iter: 1  mgc: 1.114664e-13 
outer mgc:  1.622765 
iter: 1  value: 4038.271 mgc: 0.1678078 ustep: 1 
iter: 2  value: 4038.271 mgc: 0.0003511735 ustep: 1 
iter: 3  mgc: 1.58675e-09 
iter: 1  value: 4039.11 mgc: 0.426209 ustep: 1 
iter: 2  value: 4039.11 mgc: 0.001738711 ustep: 1 
iter: 3  value: 4039.11 mgc: 2.24779e-08 ustep: 1 
mgc: 8.038015e-14 
iter: 1  mgc: 8.038015e-14 
outer mgc:  1.619118 
iter: 1  value: 4040.147 mgc: 1.038602 ustep: 1 
iter: 2  value: 4040.147 mgc: 0.009571083 ustep: 1 
iter: 3  value: 4040.147 mgc: 1.177481e-06 ustep: 1 
iter: 4  mgc: 6.702972e-14 
iter: 1  mgc: 6.702972e-14 
outer mgc:  0.9413376 
iter: 1  value: 4040.428 mgc: 1.299893 ustep: 1 
iter: 2  value: 4040.428 mgc: 0.01414913 ustep: 1 
iter: 3  value: 4040.428 mgc: 1.709718e-06 ustep: 1 
iter: 4  mgc: 5.551115e-14 
iter: 1  mgc: 5.551115e-14 
outer mgc:  1.332002 
iter: 1  value: 4039.663 mgc: 0.5265366 ustep: 1 
iter: 2  value: 4039.663 mgc: 0.002034527 ustep: 1 
iter: 3  value: 4039.663 mgc: 4.91922e-08 ustep: 1 
mgc: 5.252743e-14 
iter: 1  mgc: 5.252743e-14 
outer mgc:  0.6968412 
iter: 1  value: 4039.837 mgc: 0.4462432 ustep: 1 
iter: 2  value: 4039.837 mgc: 0.001585968 ustep: 1 
iter: 3  value: 4039.837 mgc: 2.988e-08 ustep: 1 
mgc: 4.168887e-14 
iter: 1  mgc: 4.168887e-14 
outer mgc:  0.2647372 
iter: 1  value: 4039.796 mgc: 0.8126063 ustep: 1 
iter: 2  value: 4039.796 mgc: 0.003265134 ustep: 1 
iter: 3  value: 4039.796 mgc: 1.295433e-07 ustep: 1 
iter: 4  mgc: 3.440304e-14 
iter: 1  mgc: 3.440304e-14 
outer mgc:  0.2680385 
iter: 1  value: 4039.731 mgc: 0.2397318 ustep: 1 
iter: 2  value: 4039.731 mgc: 0.0003206137 ustep: 1 
iter: 3  mgc: 8.001777e-10 
iter: 1  mgc: 8.001777e-10 
outer mgc:  0.06275102 
iter: 1  value: 4039.611 mgc: 0.03249738 ustep: 1 
iter: 2  value: 4039.611 mgc: 1.154036e-05 ustep: 1 
iter: 3  mgc: 1.420863e-12 
iter: 1  mgc: 1.420863e-12 
outer mgc:  0.02821255 
iter: 1  value: 4039.653 mgc: 0.07271831 ustep: 1 
iter: 2  value: 4039.653 mgc: 2.845919e-05 ustep: 1 
iter: 3  mgc: 8.336443e-12 
iter: 1  mgc: 8.336443e-12 
outer mgc:  0.03092353 
iter: 1  value: 4039.655 mgc: 0.01224507 ustep: 1 
iter: 2  value: 4039.655 mgc: 1.007429e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.01231848 
iter: 1  value: 4039.651 mgc: 0.002873259 ustep: 1 
iter: 2  value: 4039.651 mgc: 3.134946e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.0001660004 
iter: 1  value: 4039.651 mgc: 0.0005853978 ustep: 1 
iter: 2  mgc: 1.703197e-09 
iter: 1  mgc: 1.703197e-09 
outer mgc:  2.566322e-05 
iter: 1  mgc: 1.703197e-09 
iter: 1  mgc: 1.703197e-09 
outer mgc:  2.566322e-05 
iter: 1  value: 4039.651 mgc: 0.01847497 ustep: 1 
iter: 2  value: 4039.651 mgc: 1.860076e-06 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  0.09110745 
iter: 1  value: 4039.651 mgc: 0.01847703 ustep: 1 
iter: 2  value: 4039.651 mgc: 1.864939e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.09115838 
iter: 1  value: 4039.651 mgc: 0.005555046 ustep: 1 
iter: 2  value: 4039.651 mgc: 1.350462e-07 ustep: 1 
iter: 3  mgc: 3.341771e-14 
outer mgc:  0.07824879 
iter: 1  value: 4039.651 mgc: 0.005555211 ustep: 1 
iter: 2  value: 4039.651 mgc: 1.352349e-07 ustep: 1 
iter: 3  mgc: 4.196643e-14 
outer mgc:  0.07825477 
iter: 1  value: 4039.65 mgc: 0.01335449 ustep: 1 
iter: 2  value: 4039.65 mgc: 2.10839e-06 ustep: 1 
iter: 3  mgc: 6.061818e-14 
outer mgc:  0.09498912 
iter: 1  value: 4039.653 mgc: 0.01334307 ustep: 1 
iter: 2  value: 4039.653 mgc: 2.111142e-06 ustep: 1 
iter: 3  mgc: 7.460699e-14 
outer mgc:  0.09499406 
iter: 1  value: 4039.651 mgc: 0.005026989 ustep: 1 
iter: 2  value: 4039.651 mgc: 2.581495e-07 ustep: 1 
iter: 3  mgc: 4.156397e-14 
outer mgc:  0.05711025 
iter: 1  value: 4039.652 mgc: 0.005024493 ustep: 1 
iter: 2  value: 4039.652 mgc: 2.581379e-07 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.05709967 
iter: 1  value: 4039.654 mgc: 0.005947187 ustep: 1 
iter: 2  value: 4039.654 mgc: 2.431073e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.00466684 
iter: 1  value: 4039.648 mgc: 0.005953135 ustep: 1 
iter: 2  value: 4039.648 mgc: 2.432121e-07 ustep: 1 
iter: 3  mgc: 6.245698e-14 
outer mgc:  0.00465812 
iter: 1  value: 4039.656 mgc: 0.005708355 ustep: 1 
iter: 2  value: 4039.656 mgc: 2.75242e-07 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  0.002655076 
iter: 1  value: 4039.646 mgc: 0.005714069 ustep: 1 
iter: 2  value: 4039.646 mgc: 2.752637e-07 ustep: 1 
iter: 3  mgc: 6.733503e-14 
outer mgc:  0.002631095 
iter: 1  value: 4039.647 mgc: 0.002828162 ustep: 1 
iter: 2  value: 4039.647 mgc: 5.300275e-08 ustep: 1 
mgc: 3.463896e-14 
outer mgc:  0.001958284 
iter: 1  value: 4039.655 mgc: 0.00282809 ustep: 1 
iter: 2  value: 4039.655 mgc: 5.302631e-08 ustep: 1 
mgc: 3.119727e-14 
outer mgc:  0.0019868 
iter: 1  value: 4039.649 mgc: 0.002972305 ustep: 1 
iter: 2  value: 4039.649 mgc: 1.10879e-07 ustep: 1 
mgc: 3.508305e-14 
outer mgc:  0.008500738 
iter: 1  value: 4039.654 mgc: 0.002970953 ustep: 1 
iter: 2  value: 4039.654 mgc: 1.107126e-07 ustep: 1 
mgc: 4.94188e-14 
outer mgc:  0.008487758 
[Sun Aug 15 19:56:58 2021]
Finished job 0.
1 of 1 steps (100%) done

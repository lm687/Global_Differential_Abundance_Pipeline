Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 07:12:49 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_0.01_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_0.01_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_0.01_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10799.358798 
final  value 9865.281101 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6581.637 mgc: 98.89437 ustep: 0.4367355 
iter: 2  value: 3816.083 mgc: 97.85055 ustep: 0.1263996 
iter: 3  value: 2993.208 mgc: 119.7689 ustep: 0.1972298 
iter: 4  value: 953.7256 mgc: 101.4823 ustep: 0.07075753 
iter: 5  value: 769.8719 mgc: 91.58059 ustep: 0.2660763 
iter: 6  value: 747.4607 mgc: 46.81136 ustep: 0.5158742 
iter: 7  value: 746.9419 mgc: 7.426575 ustep: 0.718272 
iter: 8  value: 746.9416 mgc: 0.08802498 ustep: 0.8475246 
iter: 9  value: 746.9416 mgc: 0.0009461927 ustep: 0.9206189 
iter: 10  value: 746.9416 mgc: 4.112691e-06 ustep: 0.9594929 
iter: 11  mgc: 8.860344e-09 
iter: 1  mgc: 8.860344e-09 
Matching hessian patterns... Done
outer mgc:  55.49283 
iter: 1  value: 746.1412 mgc: 19.67685 ustep: 1 
iter: 2  value: 727.3715 mgc: 6.377548 ustep: 1 
iter: 3  value: 727.3182 mgc: 0.3864369 ustep: 1 
iter: 4  value: 727.3182 mgc: 0.002130456 ustep: 1 
iter: 5  value: 727.3182 mgc: 6.602704e-08 ustep: 1 
mgc: 3.53606e-14 
iter: 1  mgc: 3.53606e-14 
outer mgc:  128.7245 
iter: 1  value: 738.9199 mgc: 18.56196 ustep: 1 
iter: 2  value: 738.7529 mgc: 1.782774 ustep: 1 
iter: 3  value: 738.7529 mgc: 0.01190888 ustep: 1 
iter: 4  value: 738.7529 mgc: 5.565196e-07 ustep: 1 
iter: 5  mgc: 3.219647e-14 
iter: 1  value: 702.5799 mgc: 14.45107 ustep: 1 
iter: 2  value: 702.4434 mgc: 0.5467146 ustep: 1 
iter: 3  value: 702.4434 mgc: 0.00380537 ustep: 1 
iter: 4  value: 702.4434 mgc: 2.05694e-07 ustep: 1 
iter: 5  mgc: 3.27724e-14 
iter: 1  mgc: 3.27724e-14 
outer mgc:  116.0158 
iter: 1  value: 678.3214 mgc: 9.429607 ustep: 1 
iter: 2  value: 678.2647 mgc: 0.418084 ustep: 1 
iter: 3  value: 678.2647 mgc: 0.00198848 ustep: 1 
iter: 4  value: 678.2647 mgc: 4.639392e-08 ustep: 1 
mgc: 2.770006e-14 
iter: 1  mgc: 2.770006e-14 
outer mgc:  49.38311 
iter: 1  value: 665.0618 mgc: 12.06436 ustep: 1 
iter: 2  value: 665.0178 mgc: 0.4512488 ustep: 1 
iter: 3  value: 665.0178 mgc: 0.001024853 ustep: 1 
iter: 4  value: 665.0178 mgc: 1.171736e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  59.68597 
iter: 1  value: 656.8122 mgc: 14.05261 ustep: 1 
iter: 2  value: 654.8765 mgc: 2.156762 ustep: 1 
iter: 3  value: 654.876 mgc: 0.04445416 ustep: 1 
iter: 4  value: 654.876 mgc: 2.011784e-05 ustep: 1 
iter: 5  mgc: 4.14957e-12 
iter: 1  mgc: 4.14957e-12 
outer mgc:  60.56773 
iter: 1  value: 633.903 mgc: 7.134503 ustep: 1 
iter: 2  value: 633.6747 mgc: 0.6610858 ustep: 1 
iter: 3  value: 633.6746 mgc: 0.008977705 ustep: 1 
iter: 4  value: 633.6746 mgc: 1.708094e-06 ustep: 1 
iter: 5  mgc: 6.336598e-14 
iter: 1  mgc: 6.336598e-14 
outer mgc:  28.52165 
iter: 1  value: 635.701 mgc: 6.506921 ustep: 1 
iter: 2  value: 635.6793 mgc: 0.2638662 ustep: 1 
iter: 3  value: 635.6793 mgc: 0.0008694627 ustep: 1 
iter: 4  value: 635.6793 mgc: 1.189557e-08 ustep: 1 
mgc: 3.552714e-14 
iter: 1  value: 627.7192 mgc: 2.859064 ustep: 1 
iter: 2  value: 627.7185 mgc: 0.04888527 ustep: 1 
iter: 3  value: 627.7185 mgc: 2.099071e-05 ustep: 1 
iter: 4  mgc: 8.37852e-12 
iter: 1  mgc: 8.37852e-12 
outer mgc:  50.47471 
iter: 1  value: 619.5417 mgc: 6.456959 ustep: 1 
iter: 2  value: 619.4804 mgc: 0.3502608 ustep: 1 
iter: 3  value: 619.4804 mgc: 0.001107285 ustep: 1 
iter: 4  value: 619.4804 mgc: 1.196536e-08 ustep: 1 
mgc: 2.231548e-14 
iter: 1  mgc: 2.231548e-14 
outer mgc:  36.64691 
iter: 1  value: 603.3097 mgc: 5.612429 ustep: 1 
iter: 2  value: 603.2546 mgc: 0.4580856 ustep: 1 
iter: 3  value: 603.2546 mgc: 0.002721387 ustep: 1 
iter: 4  value: 603.2546 mgc: 9.316409e-08 ustep: 1 
mgc: 4.485301e-14 
iter: 1  value: 599.6215 mgc: 8.081082 ustep: 1 
iter: 2  value: 599.5215 mgc: 0.5747782 ustep: 1 
iter: 3  value: 599.5215 mgc: 0.002866486 ustep: 1 
iter: 4  value: 599.5215 mgc: 7.054274e-08 ustep: 1 
mgc: 2.358183e-14 
iter: 1  mgc: 2.358183e-14 
outer mgc:  63.4408 
iter: 1  value: 656.9734 mgc: 34.64975 ustep: 1 
iter: 2  value: 656.1896 mgc: 2.479222 ustep: 1 
iter: 3  value: 656.1896 mgc: 0.01613805 ustep: 1 
iter: 4  value: 656.1896 mgc: 9.356866e-07 ustep: 1 
iter: 5  mgc: 3.730349e-14 
iter: 1  value: 589.2693 mgc: 8.51216 ustep: 1 
iter: 2  value: 589.2558 mgc: 0.2002192 ustep: 1 
iter: 3  value: 589.2558 mgc: 0.0002114314 ustep: 1 
iter: 4  mgc: 2.555833e-10 
iter: 1  mgc: 2.555833e-10 
outer mgc:  47.00977 
iter: 1  value: 589.6884 mgc: 6.960478 ustep: 1 
iter: 2  value: 589.6831 mgc: 0.1792289 ustep: 1 
iter: 3  value: 589.6831 mgc: 0.0001770217 ustep: 1 
iter: 4  mgc: 1.736768e-10 
iter: 1  value: 586.6514 mgc: 3.948493 ustep: 1 
iter: 2  value: 586.6511 mgc: 0.04547286 ustep: 1 
iter: 3  value: 586.6511 mgc: 1.160255e-05 ustep: 1 
iter: 4  mgc: 7.600587e-13 
iter: 1  mgc: 7.600587e-13 
outer mgc:  23.9906 
iter: 1  value: 583.6973 mgc: 4.48789 ustep: 1 
iter: 2  value: 583.6972 mgc: 0.04096663 ustep: 1 
iter: 3  value: 583.6972 mgc: 7.010641e-06 ustep: 1 
iter: 4  mgc: 1.985079e-13 
iter: 1  mgc: 1.985079e-13 
outer mgc:  22.70478 
iter: 1  value: 578.8237 mgc: 2.989259 ustep: 1 
iter: 2  value: 578.8231 mgc: 0.05194343 ustep: 1 
iter: 3  value: 578.8231 mgc: 9.40976e-06 ustep: 1 
iter: 4  mgc: 4.165557e-13 
iter: 1  mgc: 4.165557e-13 
outer mgc:  20.12299 
iter: 1  value: 573.2183 mgc: 4.325651 ustep: 1 
iter: 2  value: 573.2182 mgc: 0.04513756 ustep: 1 
iter: 3  value: 573.2182 mgc: 8.530466e-06 ustep: 1 
iter: 4  mgc: 9.392487e-14 
iter: 1  mgc: 9.392487e-14 
outer mgc:  24.06234 
iter: 1  value: 569.4953 mgc: 6.89675 ustep: 1 
iter: 2  value: 569.4939 mgc: 0.07132113 ustep: 1 
iter: 3  value: 569.4939 mgc: 5.362894e-05 ustep: 1 
iter: 4  mgc: 3.019673e-11 
iter: 1  value: 571.2741 mgc: 4.115241 ustep: 1 
iter: 2  value: 571.2741 mgc: 0.02131624 ustep: 1 
iter: 3  value: 571.2741 mgc: 3.047058e-06 ustep: 1 
iter: 4  mgc: 1.114664e-13 
iter: 1  mgc: 1.114664e-13 
outer mgc:  18.72553 
iter: 1  value: 570.2607 mgc: 3.287892 ustep: 1 
iter: 2  value: 570.2606 mgc: 0.02689205 ustep: 1 
iter: 3  value: 570.2606 mgc: 2.356717e-06 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  10.15384 
iter: 1  value: 569.615 mgc: 2.518188 ustep: 1 
iter: 2  value: 569.615 mgc: 0.01075157 ustep: 1 
iter: 3  value: 569.615 mgc: 1.893896e-07 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  7.770145 
iter: 1  value: 568.273 mgc: 2.057707 ustep: 1 
iter: 2  value: 568.2729 mgc: 0.01063296 ustep: 1 
iter: 3  value: 568.2729 mgc: 3.113454e-07 ustep: 1 
iter: 4  mgc: 2.753353e-14 
iter: 1  value: 569.2418 mgc: 1.721041 ustep: 1 
iter: 2  value: 569.2418 mgc: 0.003787583 ustep: 1 
iter: 3  value: 569.2418 mgc: 3.738349e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  value: 569.3211 mgc: 0.709516 ustep: 1 
iter: 2  value: 569.3211 mgc: 0.0006608061 ustep: 1 
iter: 3  mgc: 1.144018e-09 
iter: 1  mgc: 1.144018e-09 
outer mgc:  5.414948 
iter: 1  value: 569.1887 mgc: 0.6553675 ustep: 1 
iter: 2  value: 569.1887 mgc: 0.0005613237 ustep: 1 
iter: 3  mgc: 6.521805e-10 
iter: 1  value: 569.2171 mgc: 0.3242158 ustep: 1 
iter: 2  value: 569.2171 mgc: 0.0001375292 ustep: 1 
iter: 3  mgc: 4.044454e-11 
iter: 1  mgc: 4.044454e-11 
outer mgc:  2.880999 
iter: 1  value: 569.0264 mgc: 0.3729834 ustep: 1 
iter: 2  value: 569.0264 mgc: 0.000140155 ustep: 1 
iter: 3  mgc: 4.911183e-11 
iter: 1  mgc: 4.911183e-11 
outer mgc:  2.847211 
iter: 1  value: 568.7259 mgc: 0.458208 ustep: 1 
iter: 2  value: 568.7259 mgc: 0.000218977 ustep: 1 
iter: 3  mgc: 1.78348e-10 
iter: 1  mgc: 1.78348e-10 
outer mgc:  3.398922 
iter: 1  value: 568.2234 mgc: 0.4814466 ustep: 1 
iter: 2  value: 568.2234 mgc: 0.0006143188 ustep: 1 
iter: 3  mgc: 1.063569e-09 
iter: 1  value: 567.7862 mgc: 0.3396929 ustep: 1 
iter: 2  value: 567.7862 mgc: 0.0003471912 ustep: 1 
iter: 3  mgc: 2.075327e-10 
iter: 1  value: 566.8305 mgc: 0.7858566 ustep: 1 
iter: 2  value: 566.8305 mgc: 0.001797986 ustep: 1 
iter: 3  mgc: 5.803093e-09 
iter: 1  mgc: 5.803093e-09 
outer mgc:  4.608374 
iter: 1  value: 565.9244 mgc: 1.171706 ustep: 1 
iter: 2  value: 565.9244 mgc: 0.006006945 ustep: 1 
iter: 3  value: 565.9244 mgc: 6.683035e-08 ustep: 1 
mgc: 2.520206e-14 
iter: 1  mgc: 2.520206e-14 
outer mgc:  2.890664 
iter: 1  value: 563.7542 mgc: 2.102038 ustep: 1 
iter: 2  value: 563.7542 mgc: 0.004524181 ustep: 1 
iter: 3  value: 563.7542 mgc: 9.715143e-08 ustep: 1 
mgc: 4.485301e-14 
iter: 1  mgc: 4.485301e-14 
outer mgc:  11.6551 
iter: 1  value: 560.5663 mgc: 1.530494 ustep: 1 
iter: 2  value: 560.5663 mgc: 0.003804536 ustep: 1 
iter: 3  value: 560.5663 mgc: 3.225894e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  4.03714 
iter: 1  value: 559.5483 mgc: 1.152672 ustep: 1 
iter: 2  value: 559.5483 mgc: 0.001357222 ustep: 1 
iter: 3  mgc: 4.784729e-09 
iter: 1  mgc: 4.784729e-09 
outer mgc:  3.342562 
iter: 1  value: 558.5621 mgc: 0.7545015 ustep: 1 
iter: 2  value: 558.5621 mgc: 0.001097592 ustep: 1 
iter: 3  mgc: 2.159772e-09 
iter: 1  mgc: 2.159772e-09 
outer mgc:  3.0905 
iter: 1  value: 557.3769 mgc: 0.7558151 ustep: 1 
iter: 2  value: 557.3769 mgc: 0.0006289536 ustep: 1 
iter: 3  mgc: 8.819505e-10 
iter: 1  mgc: 8.819505e-10 
outer mgc:  2.396209 
iter: 1  value: 555.9332 mgc: 1.009784 ustep: 1 
iter: 2  value: 555.9332 mgc: 0.001303772 ustep: 1 
iter: 3  mgc: 2.962753e-09 
iter: 1  mgc: 2.962753e-09 
outer mgc:  2.499209 
iter: 1  value: 554.6582 mgc: 0.7379251 ustep: 1 
iter: 2  value: 554.6582 mgc: 0.0005161128 ustep: 1 
iter: 3  mgc: 4.915996e-10 
iter: 1  mgc: 4.915996e-10 
outer mgc:  0.7200359 
iter: 1  value: 553.205 mgc: 0.872781 ustep: 1 
iter: 2  value: 553.205 mgc: 0.0006169066 ustep: 1 
iter: 3  mgc: 7.206999e-10 
iter: 1  mgc: 7.206999e-10 
outer mgc:  0.1566269 
iter: 1  value: 552.5099 mgc: 0.4254721 ustep: 1 
iter: 2  value: 552.5099 mgc: 0.000147797 ustep: 1 
iter: 3  mgc: 3.574208e-11 
iter: 1  mgc: 3.574208e-11 
outer mgc:  0.1086192 
iter: 1  value: 552.3541 mgc: 0.09476125 ustep: 1 
iter: 2  value: 552.3541 mgc: 8.10376e-06 ustep: 1 
iter: 3  mgc: 7.993606e-14 
iter: 1  mgc: 7.993606e-14 
outer mgc:  0.04899702 
iter: 1  value: 552.3523 mgc: 0.01863072 ustep: 1 
iter: 2  value: 552.3523 mgc: 3.120415e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.005476211 
iter: 1  value: 552.3548 mgc: 0.001809666 ustep: 1 
iter: 2  mgc: 2.761595e-09 
iter: 1  mgc: 2.761595e-09 
outer mgc:  0.0004471331 
iter: 1  mgc: 2.761595e-09 
iter: 1  mgc: 2.761595e-09 
outer mgc:  0.0004471331 
iter: 1  value: 552.3535 mgc: 0.03124059 ustep: 1 
iter: 2  value: 552.3535 mgc: 1.072064e-06 ustep: 1 
iter: 3  mgc: 2.758904e-14 
outer mgc:  0.8696641 
iter: 1  value: 552.357 mgc: 0.03122013 ustep: 1 
iter: 2  value: 552.357 mgc: 1.071104e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.8694852 
iter: 1  value: 552.3542 mgc: 0.01569354 ustep: 1 
iter: 2  value: 552.3542 mgc: 2.793542e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.5225362 
iter: 1  value: 552.356 mgc: 0.01568296 ustep: 1 
iter: 2  value: 552.356 mgc: 2.790361e-07 ustep: 1 
iter: 3  mgc: 3.891332e-14 
outer mgc:  0.5226865 
iter: 1  value: 552.3572 mgc: 0.05796815 ustep: 1 
iter: 2  value: 552.3572 mgc: 4.07238e-06 ustep: 1 
iter: 3  mgc: 1.882938e-13 
outer mgc:  0.8133533 
iter: 1  value: 552.3533 mgc: 0.05796146 ustep: 1 
iter: 2  value: 552.3533 mgc: 4.064697e-06 ustep: 1 
iter: 3  mgc: 1.79412e-13 
outer mgc:  0.8137578 
iter: 1  value: 552.3562 mgc: 0.02874347 ustep: 1 
iter: 2  value: 552.3562 mgc: 1.046063e-06 ustep: 1 
iter: 3  mgc: 2.68674e-14 
outer mgc:  0.7969373 
iter: 1  value: 552.3542 mgc: 0.0287439 ustep: 1 
iter: 2  value: 552.3542 mgc: 1.046092e-06 ustep: 1 
iter: 3  mgc: 3.774758e-14 
outer mgc:  0.7960593 
iter: 1  value: 552.3451 mgc: 0.005638691 ustep: 1 
iter: 2  value: 552.3451 mgc: 2.543383e-08 ustep: 1 
mgc: 2.9865e-14 
outer mgc:  0.002021851 
iter: 1  value: 552.3645 mgc: 0.00563712 ustep: 1 
iter: 2  value: 552.3645 mgc: 2.545915e-08 ustep: 1 
mgc: 5.77316e-14 
outer mgc:  0.002680044 
iter: 1  value: 552.387 mgc: 0.07544559 ustep: 1 
iter: 2  value: 552.387 mgc: 4.388707e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.1584524 
iter: 1  value: 552.3228 mgc: 0.0756673 ustep: 1 
iter: 2  value: 552.3228 mgc: 4.391504e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.1590718 
iter: 1  value: 552.3652 mgc: 0.07329574 ustep: 1 
iter: 2  value: 552.3652 mgc: 3.950716e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.2114631 
iter: 1  value: 552.3446 mgc: 0.07349894 ustep: 1 
iter: 2  value: 552.3446 mgc: 3.947939e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.211041 
[Sun Aug 15 07:12:51 2021]
Finished job 0.
1 of 1 steps (100%) done

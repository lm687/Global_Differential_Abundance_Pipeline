Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:27:33 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4384.561644 
iter  10 value 2902.156842
final  value 2895.751722 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 7553.881 mgc: 149.0307 ustep: 1 
iter: 2  value: 6670.194 mgc: 65.79968 ustep: 1 
iter: 3  value: 6564.15 mgc: 32.37755 ustep: 1 
iter: 4  value: 6562.56 mgc: 7.15597 ustep: 1 
iter: 5  value: 6562.559 mgc: 0.1934206 ustep: 1 
iter: 6  value: 6562.559 mgc: 9.842575e-05 ustep: 1 
iter: 7  mgc: 1.367546e-09 
iter: 1  mgc: 1.367546e-09 
Matching hessian patterns... Done
outer mgc:  1264.731 
iter: 1  value: 5221.603 mgc: 32.81893 ustep: 1 
iter: 2  value: 5212.386 mgc: 9.235953 ustep: 1 
iter: 3  value: 5212.36 mgc: 0.5071914 ustep: 1 
iter: 4  value: 5212.36 mgc: 0.004104309 ustep: 1 
iter: 5  value: 5212.36 mgc: 3.202554e-07 ustep: 1 
iter: 6  mgc: 3.241851e-14 
iter: 1  value: 2197.321 mgc: 73.02267 ustep: 0.0692153 
iter: 2  value: 1854.884 mgc: 88.52876 ustep: 0.2631617 
iter: 3  value: 1848.537 mgc: 13.45222 ustep: 0.5130416 
iter: 4  value: 1848.478 mgc: 1.124479 ustep: 0.7162976 
iter: 5  value: 1848.476 mgc: 0.0567815 ustep: 0.846359 
iter: 6  value: 1848.476 mgc: 0.00543916 ustep: 0.9199857 
iter: 7  value: 1848.476 mgc: 0.0003388725 ustep: 0.959163 
iter: 8  value: 1848.476 mgc: 1.117551e-05 ustep: 0.9793707 
iter: 9  value: 1848.476 mgc: 1.873799e-07 ustep: 0.9896326 
iter: 10  mgc: 1.578063e-09 
iter: 1  value: 2326.964 mgc: 77.35993 ustep: 1 
iter: 2  value: 2164.065 mgc: 37.43673 ustep: 1 
iter: 3  value: 2150.723 mgc: 53.29883 ustep: 0.6827823 
iter: 4  value: 1952.294 mgc: 38.86935 ustep: 0.8263238 
iter: 5  value: 1925.056 mgc: 18.23057 ustep: 0.9090326 
iter: 6  value: 1919.305 mgc: 13.65413 ustep: 0.9534367 
iter: 7  value: 1918.849 mgc: 1.070525 ustep: 0.9764432 
iter: 8  value: 1918.827 mgc: 0.2205199 ustep: 0.9881526 
iter: 9  value: 1918.826 mgc: 0.0134898 ustep: 0.9940592 
iter: 10  value: 1918.826 mgc: 0.0001170869 ustep: 0.9970255 
iter: 11  value: 1918.826 mgc: 2.784613e-07 ustep: 0.9985118 
iter: 12  mgc: 3.717191e-10 
iter: 1  mgc: 1.578063e-09 
outer mgc:  782.6255 
iter: 1  value: 758.7684 mgc: 68.36036 ustep: 1 
iter: 2  value: 604.7201 mgc: 31.30456 ustep: 1 
iter: 3  value: 604.1096 mgc: 2.013403 ustep: 1 
iter: 4  value: 604.1094 mgc: 0.04137614 ustep: 1 
iter: 5  value: 604.1094 mgc: 3.711168e-05 ustep: 1 
iter: 6  mgc: 5.673934e-11 
iter: 1  mgc: 5.673934e-11 
outer mgc:  169.0972 
iter: 1  value: 331.4639 mgc: 51.96217 ustep: 1 
iter: 2  value: 328.8616 mgc: 5.542276 ustep: 1 
iter: 3  value: 328.8584 mgc: 0.2345945 ustep: 1 
iter: 4  value: 328.8584 mgc: 0.0007170528 ustep: 1 
iter: 5  mgc: 7.598588e-09 
iter: 1  mgc: 7.598588e-09 
outer mgc:  134.6628 
iter: 1  value: 736.3051 mgc: 1130.086 ustep: 1 
iter: 2  value: 607.0291 mgc: 32.25459 ustep: 1 
iter: 3  value: 606.1562 mgc: 2.738046 ustep: 1 
iter: 4  value: 606.1559 mgc: 0.07259865 ustep: 1 
iter: 5  value: 606.1559 mgc: 6.462459e-05 ustep: 1 
iter: 6  mgc: 5.141443e-11 
iter: 1  value: 284.5736 mgc: 22.74951 ustep: 1 
iter: 2  value: 282.0871 mgc: 6.207389 ustep: 1 
iter: 3  value: 282.0839 mgc: 0.2790385 ustep: 1 
iter: 4  value: 282.0839 mgc: 0.000712 ustep: 1 
iter: 5  mgc: 4.641246e-09 
iter: 1  mgc: 4.641246e-09 
outer mgc:  58.64876 
iter: 1  value: 257.0229 mgc: 12.11175 ustep: 1 
iter: 2  value: 257.0134 mgc: 0.1536239 ustep: 1 
iter: 3  value: 257.0134 mgc: 0.002188035 ustep: 1 
iter: 4  value: 257.0134 mgc: 5.331779e-07 ustep: 1 
iter: 5  mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  24.11827 
iter: 1  value: 290.1565 mgc: 40.06029 ustep: 1 
iter: 2  value: 288.6904 mgc: 2.961231 ustep: 1 
iter: 3  value: 288.69 mgc: 0.05508151 ustep: 1 
iter: 4  value: 288.69 mgc: 3.275336e-05 ustep: 1 
iter: 5  mgc: 1.160938e-11 
iter: 1  value: 252.6669 mgc: 9.442792 ustep: 1 
iter: 2  value: 252.6572 mgc: 0.2564612 ustep: 1 
iter: 3  value: 252.6572 mgc: 0.0005560392 ustep: 1 
iter: 4  mgc: 2.642718e-09 
iter: 1  mgc: 2.642718e-09 
outer mgc:  25.24991 
iter: 1  value: 249.6827 mgc: 7.567964 ustep: 1 
iter: 2  value: 249.6658 mgc: 0.4039001 ustep: 1 
iter: 3  value: 249.6658 mgc: 0.00140087 ustep: 1 
iter: 4  value: 249.6658 mgc: 1.709084e-08 ustep: 1 
mgc: 2.9865e-14 
iter: 1  mgc: 2.9865e-14 
outer mgc:  21.12627 
iter: 1  value: 247.176 mgc: 6.29927 ustep: 1 
iter: 2  value: 247.1659 mgc: 0.1748546 ustep: 1 
iter: 3  value: 247.1659 mgc: 0.0004291618 ustep: 1 
iter: 4  value: 247.1659 mgc: 1.948791e-08 ustep: 1 
iter: 5  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  21.40107 
iter: 1  value: 241.5486 mgc: 3.49194 ustep: 1 
iter: 2  value: 241.5351 mgc: 0.3376811 ustep: 1 
iter: 3  value: 241.5351 mgc: 0.002717279 ustep: 1 
iter: 4  value: 241.5351 mgc: 1.809846e-07 ustep: 1 
iter: 5  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  10.07973 
iter: 1  value: 243.6782 mgc: 3.679747 ustep: 1 
iter: 2  value: 243.6706 mgc: 0.2441168 ustep: 1 
iter: 3  value: 243.6706 mgc: 0.001684117 ustep: 1 
iter: 4  value: 243.6706 mgc: 8.197543e-08 ustep: 1 
iter: 5  mgc: 2.775558e-14 
iter: 1  value: 240.2607 mgc: 1.437091 ustep: 1 
iter: 2  value: 240.2605 mgc: 0.04640558 ustep: 1 
iter: 3  value: 240.2605 mgc: 5.335724e-05 ustep: 1 
iter: 4  mgc: 7.065903e-11 
iter: 1  mgc: 7.065903e-11 
outer mgc:  12.58924 
iter: 1  value: 239.0517 mgc: 2.137328 ustep: 1 
iter: 2  value: 239.0516 mgc: 0.01307651 ustep: 1 
iter: 3  value: 239.0516 mgc: 3.578474e-06 ustep: 1 
iter: 4  mgc: 2.176037e-13 
iter: 1  mgc: 2.176037e-13 
outer mgc:  13.7715 
iter: 1  value: 238.738 mgc: 5.040949 ustep: 1 
iter: 2  value: 238.7376 mgc: 0.05403244 ustep: 1 
iter: 3  value: 238.7376 mgc: 2.510322e-05 ustep: 1 
iter: 4  mgc: 5.486056e-12 
iter: 1  mgc: 5.486056e-12 
outer mgc:  12.21158 
iter: 1  value: 237.185 mgc: 7.748319 ustep: 1 
iter: 2  value: 237.1727 mgc: 0.2842265 ustep: 1 
iter: 3  value: 237.1727 mgc: 0.0006772899 ustep: 1 
iter: 4  mgc: 3.992286e-09 
iter: 1  mgc: 3.992286e-09 
outer mgc:  5.114746 
iter: 1  value: 236.5112 mgc: 6.280139 ustep: 1 
iter: 2  value: 236.5029 mgc: 0.2317819 ustep: 1 
iter: 3  value: 236.5029 mgc: 0.000403634 ustep: 1 
iter: 4  mgc: 1.245401e-09 
iter: 1  mgc: 1.245401e-09 
outer mgc:  5.69584 
iter: 1  value: 235.2547 mgc: 3.520842 ustep: 1 
iter: 2  value: 235.2546 mgc: 0.02841458 ustep: 1 
iter: 3  value: 235.2546 mgc: 3.1352e-06 ustep: 1 
iter: 4  mgc: 6.283862e-14 
iter: 1  value: 234.3585 mgc: 2.23293 ustep: 1 
iter: 2  value: 234.3583 mgc: 0.03359118 ustep: 1 
iter: 3  value: 234.3583 mgc: 8.87384e-06 ustep: 1 
iter: 4  mgc: 1.042416e-12 
iter: 1  mgc: 1.042416e-12 
outer mgc:  3.831232 
iter: 1  value: 233.5421 mgc: 3.718274 ustep: 1 
iter: 2  value: 233.5392 mgc: 0.1060366 ustep: 1 
iter: 3  value: 233.5392 mgc: 0.0001029935 ustep: 1 
iter: 4  mgc: 2.527858e-10 
iter: 1  mgc: 2.527858e-10 
outer mgc:  2.488046 
iter: 1  value: 232.7925 mgc: 2.4114 ustep: 1 
iter: 2  value: 232.7924 mgc: 0.01528677 ustep: 1 
iter: 3  value: 232.7924 mgc: 5.7415e-06 ustep: 1 
iter: 4  mgc: 4.618528e-13 
iter: 1  mgc: 4.618528e-13 
outer mgc:  0.6825567 
iter: 1  value: 232.8012 mgc: 1.987555 ustep: 1 
iter: 2  value: 232.8004 mgc: 0.05521347 ustep: 1 
iter: 3  value: 232.8004 mgc: 4.876269e-05 ustep: 1 
iter: 4  mgc: 3.216334e-10 
iter: 1  value: 232.6671 mgc: 0.8116162 ustep: 1 
iter: 2  value: 232.6671 mgc: 0.009101677 ustep: 1 
iter: 3  value: 232.6671 mgc: 1.436174e-06 ustep: 1 
iter: 4  mgc: 2.799982e-13 
iter: 1  mgc: 2.799982e-13 
outer mgc:  2.048837 
iter: 1  value: 232.6569 mgc: 0.6025771 ustep: 1 
iter: 2  value: 232.6569 mgc: 0.001890235 ustep: 1 
iter: 3  value: 232.6569 mgc: 7.967644e-08 ustep: 1 
iter: 4  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  2.918988 
iter: 1  value: 232.6049 mgc: 0.8148616 ustep: 1 
iter: 2  value: 232.6049 mgc: 0.004068277 ustep: 1 
iter: 3  value: 232.6049 mgc: 1.774783e-07 ustep: 1 
iter: 4  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  0.9773015 
iter: 1  value: 232.592 mgc: 0.5192143 ustep: 1 
iter: 2  value: 232.592 mgc: 0.002217673 ustep: 1 
iter: 3  value: 232.592 mgc: 4.14656e-08 ustep: 1 
iter: 4  mgc: 2.420286e-14 
iter: 1  mgc: 2.420286e-14 
outer mgc:  0.3573723 
iter: 1  value: 232.5949 mgc: 0.2427283 ustep: 1 
iter: 2  value: 232.5949 mgc: 0.0003709712 ustep: 1 
iter: 3  mgc: 1.798705e-09 
iter: 1  mgc: 1.798705e-09 
outer mgc:  0.08673813 
iter: 1  value: 232.5936 mgc: 0.03377805 ustep: 1 
iter: 2  value: 232.5936 mgc: 5.210063e-06 ustep: 1 
iter: 3  mgc: 6.687984e-13 
iter: 1  mgc: 6.687984e-13 
outer mgc:  0.01710155 
iter: 1  value: 232.5936 mgc: 0.006134194 ustep: 1 
iter: 2  value: 232.5936 mgc: 1.106383e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.0006938983 
iter: 1  value: 232.5936 mgc: 0.00037631 ustep: 1 
iter: 2  mgc: 1.061673e-09 
iter: 1  mgc: 1.061673e-09 
outer mgc:  3.358496e-05 
iter: 1  mgc: 1.061673e-09 
iter: 1  mgc: 1.061673e-09 
outer mgc:  3.358496e-05 
iter: 1  value: 232.5932 mgc: 0.03893855 ustep: 1 
iter: 2  value: 232.5932 mgc: 8.541209e-06 ustep: 1 
iter: 3  mgc: 6.979209e-13 
outer mgc:  0.04366733 
iter: 1  value: 232.594 mgc: 0.03891992 ustep: 1 
iter: 2  value: 232.594 mgc: 8.548661e-06 ustep: 1 
iter: 3  mgc: 7.006132e-13 
outer mgc:  0.04368672 
iter: 1  value: 232.5922 mgc: 0.01802621 ustep: 1 
iter: 2  value: 232.5922 mgc: 2.143437e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.1131163 
iter: 1  value: 232.595 mgc: 0.01801645 ustep: 1 
iter: 2  value: 232.595 mgc: 2.143187e-06 ustep: 1 
iter: 3  mgc: 3.93019e-14 
outer mgc:  0.1131073 
iter: 1  value: 232.5941 mgc: 0.03794018 ustep: 1 
iter: 2  value: 232.5941 mgc: 3.642674e-06 ustep: 1 
iter: 3  mgc: 9.614531e-14 
outer mgc:  0.05819614 
iter: 1  value: 232.5931 mgc: 0.03794746 ustep: 1 
iter: 2  value: 232.5931 mgc: 3.637215e-06 ustep: 1 
iter: 3  mgc: 7.660539e-14 
outer mgc:  0.05819768 
iter: 1  value: 232.5951 mgc: 0.0181972 ustep: 1 
iter: 2  value: 232.5951 mgc: 2.127009e-06 ustep: 1 
iter: 3  mgc: 4.396483e-14 
outer mgc:  0.1145126 
iter: 1  value: 232.5922 mgc: 0.01820694 ustep: 1 
iter: 2  value: 232.5922 mgc: 2.127193e-06 ustep: 1 
iter: 3  mgc: 4.818368e-14 
outer mgc:  0.1145205 
iter: 1  value: 232.5924 mgc: 0.003570304 ustep: 1 
iter: 2  value: 232.5924 mgc: 2.123183e-07 ustep: 1 
iter: 3  mgc: 3.258505e-14 
outer mgc:  0.008817496 
iter: 1  value: 232.5948 mgc: 0.003567861 ustep: 1 
iter: 2  value: 232.5948 mgc: 2.121279e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.008829847 
iter: 1  value: 232.5957 mgc: 0.007443671 ustep: 1 
iter: 2  value: 232.5957 mgc: 1.150673e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.060316 
iter: 1  value: 232.5915 mgc: 0.00746359 ustep: 1 
iter: 2  value: 232.5915 mgc: 1.153988e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.06043428 
iter: 1  value: 232.5957 mgc: 0.0087303 ustep: 1 
iter: 2  value: 232.5957 mgc: 4.389535e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.06172256 
iter: 1  value: 232.5915 mgc: 0.008753559 ustep: 1 
iter: 2  value: 232.5915 mgc: 4.420105e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.06174095 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:27:35 2021]
Finished job 0.
1 of 1 steps (100%) done

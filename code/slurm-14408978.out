Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:31:45 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2202.717639 
final  value 2153.368459 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 288.0931 mgc: 73.87868 ustep: 1 
iter: 2  value: 247.0349 mgc: 27.68586 ustep: 1 
iter: 3  value: 242.5378 mgc: 16.45981 ustep: 1 
iter: 4  value: 242.5164 mgc: 1.143385 ustep: 1 
iter: 5  value: 242.5164 mgc: 0.008424704 ustep: 1 
iter: 6  value: 242.5164 mgc: 4.73611e-07 ustep: 1 
iter: 7  mgc: 1.659783e-14 
iter: 1  mgc: 1.659783e-14 
Matching hessian patterns... Done
outer mgc:  58.53904 
iter: 1  value: 228.0944 mgc: 22.02633 ustep: 1 
iter: 2  value: 227.915 mgc: 2.026302 ustep: 1 
iter: 3  value: 227.915 mgc: 0.03322687 ustep: 1 
iter: 4  value: 227.915 mgc: 9.547935e-06 ustep: 1 
iter: 5  mgc: 7.872591e-13 
iter: 1  mgc: 7.872591e-13 
outer mgc:  40.98466 
iter: 1  value: 231.4792 mgc: 27.82689 ustep: 1 
iter: 2  value: 226.5916 mgc: 8.620726 ustep: 1 
iter: 3  value: 226.5823 mgc: 0.44045 ustep: 1 
iter: 4  value: 226.5823 mgc: 0.002257949 ustep: 1 
iter: 5  value: 226.5823 mgc: 7.034278e-08 ustep: 1 
mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  50.68688 
iter: 1  value: 211.0509 mgc: 9.698767 ustep: 1 
iter: 2  value: 211.0418 mgc: 0.3890097 ustep: 1 
iter: 3  value: 211.0418 mgc: 0.001090958 ustep: 1 
iter: 4  mgc: 8.750802e-09 
iter: 1  mgc: 8.750802e-09 
outer mgc:  12.36295 
iter: 1  value: 217.93 mgc: 37.14955 ustep: 1 
iter: 2  value: 217.2289 mgc: 4.498371 ustep: 1 
iter: 3  value: 217.2288 mgc: 0.06414345 ustep: 1 
iter: 4  value: 217.2288 mgc: 4.662741e-05 ustep: 1 
iter: 5  mgc: 2.474221e-11 
iter: 1  value: 207.5758 mgc: 13.60482 ustep: 1 
iter: 2  value: 207.5646 mgc: 0.4536988 ustep: 1 
iter: 3  value: 207.5646 mgc: 0.001717236 ustep: 1 
iter: 4  value: 207.5646 mgc: 2.490851e-08 ustep: 1 
mgc: 3.219647e-14 
iter: 1  mgc: 3.219647e-14 
outer mgc:  12.27459 
iter: 1  value: 205.0693 mgc: 1.157466 ustep: 1 
iter: 2  value: 205.0693 mgc: 0.007572201 ustep: 1 
iter: 3  value: 205.0693 mgc: 6.840891e-07 ustep: 1 
iter: 4  mgc: 3.014256e-14 
iter: 1  mgc: 3.014256e-14 
outer mgc:  15.61109 
iter: 1  value: 201.2402 mgc: 15.27644 ustep: 1 
iter: 2  value: 201.1819 mgc: 0.8639444 ustep: 1 
iter: 3  value: 201.1819 mgc: 0.007783565 ustep: 1 
iter: 4  value: 201.1819 mgc: 6.503025e-07 ustep: 1 
iter: 5  mgc: 2.031708e-14 
iter: 1  mgc: 2.031708e-14 
outer mgc:  7.225973 
iter: 1  value: 199.0518 mgc: 6.66006 ustep: 1 
iter: 2  value: 199.0498 mgc: 0.2026579 ustep: 1 
iter: 3  value: 199.0498 mgc: 0.0002935833 ustep: 1 
iter: 4  mgc: 6.252541e-10 
iter: 1  mgc: 6.252541e-10 
outer mgc:  6.88746 
iter: 1  value: 197.9764 mgc: 17.06334 ustep: 1 
iter: 2  value: 197.9548 mgc: 0.6741713 ustep: 1 
iter: 3  value: 197.9548 mgc: 0.002838712 ustep: 1 
iter: 4  value: 197.9548 mgc: 5.149243e-08 ustep: 1 
mgc: 1.659783e-14 
iter: 1  mgc: 1.659783e-14 
outer mgc:  8.508928 
iter: 1  value: 197.5325 mgc: 14.1886 ustep: 1 
iter: 2  value: 197.5167 mgc: 0.4630856 ustep: 1 
iter: 3  value: 197.5167 mgc: 0.0007377776 ustep: 1 
iter: 4  mgc: 3.045013e-09 
iter: 1  mgc: 3.045013e-09 
outer mgc:  6.855244 
iter: 1  value: 197.1546 mgc: 6.434407 ustep: 1 
iter: 2  value: 197.1534 mgc: 0.1559901 ustep: 1 
iter: 3  value: 197.1534 mgc: 0.0001044674 ustep: 1 
iter: 4  mgc: 2.30469e-11 
iter: 1  mgc: 2.30469e-11 
outer mgc:  5.312214 
iter: 1  value: 197.7394 mgc: 5.788523 ustep: 1 
iter: 2  value: 197.739 mgc: 0.08941787 ustep: 1 
iter: 3  value: 197.739 mgc: 4.903291e-05 ustep: 1 
iter: 4  mgc: 1.508793e-11 
iter: 1  value: 196.9834 mgc: 3.264205 ustep: 1 
iter: 2  value: 196.9833 mgc: 0.02139683 ustep: 1 
iter: 3  value: 196.9833 mgc: 2.79344e-06 ustep: 1 
iter: 4  mgc: 4.707346e-14 
iter: 1  mgc: 4.707346e-14 
outer mgc:  2.278595 
iter: 1  value: 196.8925 mgc: 1.318691 ustep: 1 
iter: 2  value: 196.8925 mgc: 0.01049309 ustep: 1 
iter: 3  value: 196.8925 mgc: 7.877169e-07 ustep: 1 
iter: 4  mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  0.5726547 
iter: 1  value: 196.9382 mgc: 0.5056422 ustep: 1 
iter: 2  value: 196.9382 mgc: 0.0008726457 ustep: 1 
iter: 3  mgc: 2.987909e-09 
iter: 1  value: 196.8864 mgc: 0.1339712 ustep: 1 
iter: 2  value: 196.8864 mgc: 6.058527e-05 ustep: 1 
iter: 3  mgc: 1.418221e-11 
iter: 1  mgc: 1.418221e-11 
outer mgc:  0.5105986 
iter: 1  value: 196.8824 mgc: 0.466722 ustep: 1 
iter: 2  value: 196.8824 mgc: 0.0006362541 ustep: 1 
iter: 3  mgc: 2.477759e-09 
iter: 1  mgc: 2.477759e-09 
outer mgc:  0.4862761 
iter: 1  value: 196.8798 mgc: 0.2971571 ustep: 1 
iter: 2  value: 196.8798 mgc: 0.000338722 ustep: 1 
iter: 3  mgc: 7.144052e-10 
iter: 1  mgc: 7.144052e-10 
outer mgc:  0.2442548 
iter: 1  value: 196.8797 mgc: 0.4247065 ustep: 1 
iter: 2  value: 196.8797 mgc: 0.0005153602 ustep: 1 
iter: 3  mgc: 1.467503e-09 
iter: 1  mgc: 1.467503e-09 
outer mgc:  0.3646418 
iter: 1  value: 196.8908 mgc: 0.2233135 ustep: 1 
iter: 2  value: 196.8908 mgc: 0.0001624396 ustep: 1 
iter: 3  mgc: 1.596964e-10 
iter: 1  mgc: 1.596964e-10 
outer mgc:  0.3666833 
iter: 1  value: 196.8934 mgc: 0.1743167 ustep: 1 
iter: 2  value: 196.8934 mgc: 0.0001510485 ustep: 1 
iter: 3  mgc: 1.452195e-10 
iter: 1  mgc: 1.452195e-10 
outer mgc:  0.4851638 
iter: 1  value: 196.8873 mgc: 0.4742355 ustep: 1 
iter: 2  value: 196.8873 mgc: 0.001179843 ustep: 1 
iter: 3  value: 196.8873 mgc: 1.050895e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.2112823 
iter: 1  value: 196.9088 mgc: 0.2859723 ustep: 1 
iter: 2  value: 196.9088 mgc: 0.001110175 ustep: 1 
iter: 3  mgc: 2.917517e-09 
iter: 1  mgc: 2.917517e-09 
outer mgc:  0.2193986 
iter: 1  value: 196.891 mgc: 0.1265454 ustep: 1 
iter: 2  value: 196.891 mgc: 0.0001245259 ustep: 1 
iter: 3  mgc: 1.214273e-10 
iter: 1  mgc: 1.214273e-10 
outer mgc:  0.03209578 
iter: 1  value: 196.8999 mgc: 0.143601 ustep: 1 
iter: 2  value: 196.8999 mgc: 7.648019e-05 ustep: 1 
iter: 3  mgc: 8.538309e-11 
iter: 1  value: 196.8945 mgc: 0.05703408 ustep: 1 
iter: 2  value: 196.8945 mgc: 8.529771e-06 ustep: 1 
iter: 3  mgc: 1.420308e-12 
iter: 1  mgc: 1.420308e-12 
outer mgc:  0.0325982 
iter: 1  value: 196.8989 mgc: 0.04316851 ustep: 1 
iter: 2  value: 196.8989 mgc: 9.767919e-06 ustep: 1 
iter: 3  mgc: 4.926615e-13 
iter: 1  value: 196.896 mgc: 0.01592868 ustep: 1 
iter: 2  value: 196.896 mgc: 1.312339e-06 ustep: 1 
iter: 3  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  0.007802544 
iter: 1  value: 196.8963 mgc: 0.006117832 ustep: 1 
iter: 2  value: 196.8963 mgc: 7.391e-08 ustep: 1 
mgc: 1.756928e-14 
iter: 1  mgc: 1.756928e-14 
outer mgc:  0.007725181 
iter: 1  value: 196.8965 mgc: 0.004651186 ustep: 1 
iter: 2  value: 196.8965 mgc: 5.944703e-08 ustep: 1 
mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  0.003200981 
iter: 1  value: 196.8964 mgc: 0.001532926 ustep: 1 
iter: 2  mgc: 7.051244e-09 
iter: 1  mgc: 7.051244e-09 
outer mgc:  2.516082e-05 
iter: 1  value: 196.8964 mgc: 4.121136e-05 ustep: 1 
iter: 2  mgc: 4.207301e-12 
iter: 1  mgc: 4.207301e-12 
outer mgc:  1.53384e-05 
iter: 1  value: 196.8964 mgc: 8.650917e-06 ustep: 1 
iter: 2  mgc: 2.566836e-13 
iter: 1  mgc: 2.566836e-13 
outer mgc:  3.761768e-07 
iter: 1  value: 196.8964 mgc: 3.543878e-07 ustep: 1 
iter: 2  mgc: 2.753353e-14 
iter: 1  mgc: 2.566836e-13 
iter: 1  mgc: 2.566836e-13 
outer mgc:  3.761768e-07 
iter: 1  value: 196.8965 mgc: 0.05327146 ustep: 1 
iter: 2  value: 196.8965 mgc: 7.670777e-06 ustep: 1 
iter: 3  mgc: 3.672618e-13 
outer mgc:  0.04531689 
iter: 1  value: 196.8963 mgc: 0.05327067 ustep: 1 
iter: 2  value: 196.8963 mgc: 7.677301e-06 ustep: 1 
iter: 3  mgc: 3.828049e-13 
outer mgc:  0.04531715 
iter: 1  value: 196.8963 mgc: 0.02845147 ustep: 1 
iter: 2  value: 196.8963 mgc: 1.710964e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.1199147 
iter: 1  value: 196.8966 mgc: 0.02844552 ustep: 1 
iter: 2  value: 196.8966 mgc: 1.710228e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.1199039 
iter: 1  value: 196.8963 mgc: 0.04474909 ustep: 1 
iter: 2  value: 196.8963 mgc: 7.139219e-06 ustep: 1 
iter: 3  mgc: 3.091694e-13 
outer mgc:  0.0588243 
iter: 1  value: 196.8966 mgc: 0.04473673 ustep: 1 
iter: 2  value: 196.8966 mgc: 7.147579e-06 ustep: 1 
iter: 3  mgc: 2.96152e-13 
outer mgc:  0.05882355 
iter: 1  value: 196.8964 mgc: 0.02323549 ustep: 1 
iter: 2  value: 196.8964 mgc: 2.403499e-06 ustep: 1 
iter: 3  mgc: 3.708145e-14 
outer mgc:  0.103489 
iter: 1  value: 196.8965 mgc: 0.02322973 ustep: 1 
iter: 2  value: 196.8965 mgc: 2.403736e-06 ustep: 1 
iter: 3  mgc: 3.130829e-14 
outer mgc:  0.1034796 
iter: 1  value: 196.8954 mgc: 0.005222019 ustep: 1 
iter: 2  value: 196.8954 mgc: 2.131228e-07 ustep: 1 
mgc: 1.820766e-14 
outer mgc:  0.00397494 
iter: 1  value: 196.8974 mgc: 0.005218326 ustep: 1 
iter: 2  value: 196.8974 mgc: 2.129911e-07 ustep: 1 
mgc: 1.598721e-14 
outer mgc:  0.003978467 
iter: 1  value: 196.8973 mgc: 0.008267063 ustep: 1 
iter: 2  value: 196.8973 mgc: 3.77501e-07 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.03001251 
iter: 1  value: 196.8956 mgc: 0.008287281 ustep: 1 
iter: 2  value: 196.8956 mgc: 3.790865e-07 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.0300656 
iter: 1  value: 196.8981 mgc: 0.0105109 ustep: 1 
iter: 2  value: 196.8981 mgc: 9.426214e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
outer mgc:  0.02688826 
iter: 1  value: 196.8947 mgc: 0.01053689 ustep: 1 
iter: 2  value: 196.8947 mgc: 9.457818e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.0269214 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:31:47 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:53:41 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22117.262595 
final  value 21185.325502 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19775.61 mgc: 3.945344 ustep: 0.6827823 
iter: 2  value: 19701.18 mgc: 3.016543 ustep: 0.8263238 
iter: 3  value: 19699.14 mgc: 2.178764 ustep: 0.6983222 
iter: 4  value: 19694.37 mgc: 2.516241 ustep: 0.8356732 
iter: 5  value: 19689.48 mgc: 2.010977 ustep: 0.4586086 
iter: 6  value: 19686.75 mgc: 1.70106 ustep: 0.6772387 
iter: 7  value: 19685.69 mgc: 1.163399 ustep: 0.8229629 
iter: 8  value: 19685.69 mgc: 0.1049946 ustep: 0.9071823 
iter: 9  value: 19685.69 mgc: 0.005703175 ustep: 0.9524659 
iter: 10  value: 19685.69 mgc: 0.0001418962 ustep: 0.975946 
iter: 11  value: 19685.69 mgc: 1.925571e-06 ustep: 0.987901 
iter: 12  value: 19685.69 mgc: 1.434615e-08 ustep: 0.9939327 
iter: 13  mgc: 5.680681e-11 
iter: 1  mgc: 5.680681e-11 
Matching hessian patterns... Done
outer mgc:  140.9603 
iter: 1  value: 19484.7 mgc: 0.8690704 ustep: 1 
iter: 2  value: 19484.7 mgc: 0.04274852 ustep: 1 
iter: 3  value: 19484.7 mgc: 0.0006767862 ustep: 1 
iter: 4  value: 19484.7 mgc: 6.702785e-08 ustep: 1 
iter: 5  mgc: 3.552714e-15 
iter: 1  value: 19343 mgc: 3.811571 ustep: 1 
iter: 2  value: 19342.97 mgc: 0.5841066 ustep: 1 
iter: 3  value: 19342.97 mgc: 0.009239754 ustep: 1 
iter: 4  value: 19342.97 mgc: 2.388609e-06 ustep: 1 
iter: 5  mgc: 1.629807e-13 
iter: 1  mgc: 1.629807e-13 
outer mgc:  78.15546 
iter: 1  value: 19973.09 mgc: 17.69856 ustep: 0.4367355 
iter: 2  value: 19819.73 mgc: 10.12205 ustep: 0.4176298 
iter: 3  value: 19783.84 mgc: 8.924429 ustep: 0.4052143 
iter: 4  value: 19626.54 mgc: 22.29611 ustep: 0.3971343 
iter: 5  value: 19478.37 mgc: 14.73342 ustep: 0.3918678 
iter: 6  value: 19383.09 mgc: 9.651612 ustep: 0.388431 
iter: 7  value: 19373.57 mgc: 10.1426 ustep: 0.3861862 
iter: 8  value: 19364.74 mgc: 9.554342 ustep: 0.384719 
iter: 9  value: 19359.76 mgc: 5.278781 ustep: 0.3837597 
iter: 10  value: 19358.1 mgc: 4.817948 ustep: 0.6195215 
iter: 11  value: 19358.09 mgc: 0.1853335 ustep: 0.7871181 
iter: 12  value: 19358.09 mgc: 0.009949468 ustep: 0.8872081 
iter: 13  value: 19358.09 mgc: 0.0002680545 ustep: 0.941923 
iter: 14  value: 19358.09 mgc: 3.755705e-06 ustep: 0.9705301 
iter: 15  value: 19358.09 mgc: 2.668155e-08 ustep: 0.9851564 
mgc: 9.495604e-11 
iter: 1  value: 19366.34 mgc: 3.568361 ustep: 1 
iter: 2  value: 19362.67 mgc: 1.061859 ustep: 1 
iter: 3  value: 19362.67 mgc: 0.04122133 ustep: 1 
iter: 4  value: 19362.67 mgc: 9.930292e-05 ustep: 1 
iter: 5  mgc: 7.86131e-10 
iter: 1  mgc: 7.86131e-10 
outer mgc:  72.42876 
iter: 1  value: 19378.08 mgc: 11.33157 ustep: 1 
iter: 2  value: 19375.87 mgc: 2.331908 ustep: 1 
iter: 3  value: 19375.87 mgc: 0.1238386 ustep: 1 
iter: 4  value: 19375.87 mgc: 0.0004770068 ustep: 1 
iter: 5  mgc: 7.102292e-09 
iter: 1  value: 19323.77 mgc: 3.458693 ustep: 1 
iter: 2  value: 19323.72 mgc: 0.3724588 ustep: 1 
iter: 3  value: 19323.72 mgc: 0.004055196 ustep: 1 
iter: 4  value: 19323.72 mgc: 5.039899e-07 ustep: 1 
iter: 5  mgc: 6.27276e-15 
iter: 1  mgc: 6.27276e-15 
outer mgc:  40.44467 
iter: 1  value: 19300.69 mgc: 4.413341 ustep: 1 
iter: 2  value: 19300.53 mgc: 0.3409755 ustep: 1 
iter: 3  value: 19300.53 mgc: 0.00345043 ustep: 1 
iter: 4  value: 19300.53 mgc: 1.799729e-07 ustep: 1 
iter: 5  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  82.20934 
iter: 1  value: 19265.67 mgc: 4.331407 ustep: 1 
iter: 2  value: 19265.63 mgc: 0.1522972 ustep: 1 
iter: 3  value: 19265.63 mgc: 0.0004334508 ustep: 1 
iter: 4  mgc: 1.600649e-09 
iter: 1  mgc: 1.600649e-09 
outer mgc:  43.83211 
iter: 1  value: 19251.27 mgc: 3.335915 ustep: 1 
iter: 2  value: 19251.25 mgc: 0.2245417 ustep: 1 
iter: 3  value: 19251.25 mgc: 0.0009033423 ustep: 1 
iter: 4  value: 19251.25 mgc: 1.250451e-08 ustep: 1 
mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  26.90479 
iter: 1  value: 19220.59 mgc: 5.378832 ustep: 1 
iter: 2  value: 19220.59 mgc: 0.1534817 ustep: 1 
iter: 3  value: 19220.59 mgc: 0.0001150959 ustep: 1 
iter: 4  mgc: 9.713386e-11 
iter: 1  mgc: 9.713386e-11 
outer mgc:  13.12822 
iter: 1  value: 19210.36 mgc: 2.978168 ustep: 1 
iter: 2  value: 19210.36 mgc: 0.03745274 ustep: 1 
iter: 3  value: 19210.36 mgc: 1.459962e-05 ustep: 1 
iter: 4  mgc: 1.919354e-12 
iter: 1  value: 19219.08 mgc: 1.095579 ustep: 1 
iter: 2  value: 19219.08 mgc: 0.02413542 ustep: 1 
iter: 3  value: 19219.08 mgc: 7.309815e-06 ustep: 1 
iter: 4  mgc: 6.510348e-13 
iter: 1  mgc: 6.510348e-13 
outer mgc:  11.0455 
iter: 1  value: 19217.57 mgc: 1.724123 ustep: 1 
iter: 2  value: 19217.57 mgc: 0.0118263 ustep: 1 
iter: 3  value: 19217.57 mgc: 5.203142e-07 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  value: 19218.83 mgc: 0.7288524 ustep: 1 
iter: 2  value: 19218.83 mgc: 0.00209437 ustep: 1 
iter: 3  value: 19218.83 mgc: 4.049368e-08 ustep: 1 
iter: 4  mgc: 4.468648e-15 
iter: 1  value: 19218.49 mgc: 0.3337907 ustep: 1 
iter: 2  value: 19218.49 mgc: 0.0005037863 ustep: 1 
iter: 3  mgc: 2.461758e-09 
iter: 1  mgc: 2.461758e-09 
outer mgc:  5.248388 
iter: 1  value: 19218.08 mgc: 0.3750556 ustep: 1 
iter: 2  value: 19218.08 mgc: 0.0004762347 ustep: 1 
iter: 3  mgc: 3.32118e-09 
iter: 1  mgc: 3.32118e-09 
outer mgc:  4.674057 
iter: 1  value: 19218.31 mgc: 0.3775285 ustep: 1 
iter: 2  value: 19218.31 mgc: 0.0005420705 ustep: 1 
iter: 3  mgc: 2.530768e-09 
iter: 1  value: 19218.08 mgc: 0.1717844 ustep: 1 
iter: 2  value: 19218.08 mgc: 0.0001198604 ustep: 1 
iter: 3  mgc: 1.406544e-10 
iter: 1  mgc: 1.406544e-10 
outer mgc:  2.539152 
iter: 1  value: 19218.22 mgc: 0.1887188 ustep: 1 
iter: 2  value: 19218.22 mgc: 0.0002369284 ustep: 1 
iter: 3  mgc: 7.382241e-10 
iter: 1  mgc: 7.382241e-10 
outer mgc:  2.730674 
iter: 1  value: 19219.08 mgc: 0.3009552 ustep: 1 
iter: 2  value: 19219.08 mgc: 0.0006272162 ustep: 1 
iter: 3  mgc: 3.070982e-09 
iter: 1  mgc: 3.070982e-09 
outer mgc:  2.07462 
iter: 1  value: 19220.92 mgc: 0.2431504 ustep: 1 
iter: 2  value: 19220.92 mgc: 0.0004664707 ustep: 1 
iter: 3  mgc: 1.7908e-09 
iter: 1  mgc: 1.7908e-09 
outer mgc:  1.606012 
iter: 1  value: 19222.46 mgc: 0.3748636 ustep: 1 
iter: 2  value: 19222.46 mgc: 0.0012269 ustep: 1 
iter: 3  value: 19222.46 mgc: 1.34354e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  value: 19224.84 mgc: 0.4808762 ustep: 1 
iter: 2  value: 19224.84 mgc: 0.002281761 ustep: 1 
iter: 3  value: 19224.84 mgc: 5.147885e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  value: 19229.22 mgc: 0.8679694 ustep: 1 
iter: 2  value: 19229.22 mgc: 0.009093729 ustep: 1 
iter: 3  value: 19229.22 mgc: 9.800465e-07 ustep: 1 
iter: 4  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  7.275681 
iter: 1  value: 19238.56 mgc: 1.588647 ustep: 1 
iter: 2  value: 19238.55 mgc: 0.04208843 ustep: 1 
iter: 3  value: 19238.55 mgc: 2.876334e-05 ustep: 1 
iter: 4  mgc: 1.271871e-11 
iter: 1  mgc: 1.271871e-11 
outer mgc:  6.394266 
iter: 1  value: 19245.74 mgc: 1.516428 ustep: 1 
iter: 2  value: 19245.74 mgc: 0.05049624 ustep: 1 
iter: 3  value: 19245.74 mgc: 4.847313e-05 ustep: 1 
iter: 4  mgc: 4.369394e-11 
iter: 1  mgc: 4.369394e-11 
outer mgc:  2.890428 
iter: 1  value: 19243.4 mgc: 1.384502 ustep: 1 
iter: 2  value: 19243.4 mgc: 0.02592844 ustep: 1 
iter: 3  value: 19243.4 mgc: 1.022112e-05 ustep: 1 
iter: 4  mgc: 1.556089e-12 
iter: 1  value: 19245.6 mgc: 0.157305 ustep: 1 
iter: 2  value: 19245.6 mgc: 0.0003258362 ustep: 1 
iter: 3  mgc: 1.071986e-09 
iter: 1  mgc: 1.071986e-09 
outer mgc:  2.330405 
iter: 1  value: 19244.08 mgc: 0.3509389 ustep: 1 
iter: 2  value: 19244.08 mgc: 0.002025398 ustep: 1 
iter: 3  value: 19244.08 mgc: 7.395021e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  1.560641 
iter: 1  value: 19242.83 mgc: 0.2757829 ustep: 1 
iter: 2  value: 19242.83 mgc: 0.0004290284 ustep: 1 
iter: 3  mgc: 2.890288e-09 
iter: 1  mgc: 2.890288e-09 
outer mgc:  1.726083 
iter: 1  value: 19243.43 mgc: 0.1357841 ustep: 1 
iter: 2  value: 19243.43 mgc: 0.0003057634 ustep: 1 
iter: 3  mgc: 1.687235e-09 
iter: 1  value: 19243 mgc: 0.0691185 ustep: 1 
iter: 2  value: 19243 mgc: 5.607762e-05 ustep: 1 
iter: 3  mgc: 4.838041e-11 
iter: 1  mgc: 4.838041e-11 
outer mgc:  0.5976778 
iter: 1  value: 19242.73 mgc: 0.0972529 ustep: 1 
iter: 2  value: 19242.73 mgc: 8.568377e-05 ustep: 1 
iter: 3  mgc: 8.081802e-11 
iter: 1  mgc: 8.081802e-11 
outer mgc:  1.040314 
iter: 1  value: 19242.46 mgc: 0.05829299 ustep: 1 
iter: 2  value: 19242.46 mgc: 5.938666e-05 ustep: 1 
iter: 3  mgc: 6.343903e-11 
iter: 1  mgc: 6.343903e-11 
outer mgc:  0.249289 
iter: 1  value: 19242.32 mgc: 0.02982128 ustep: 1 
iter: 2  value: 19242.32 mgc: 1.037484e-05 ustep: 1 
iter: 3  mgc: 1.397993e-12 
iter: 1  mgc: 1.397993e-12 
outer mgc:  0.133496 
iter: 1  value: 19241.98 mgc: 0.0582353 ustep: 1 
iter: 2  value: 19241.98 mgc: 6.001224e-05 ustep: 1 
iter: 3  mgc: 6.375789e-11 
iter: 1  mgc: 6.375789e-11 
outer mgc:  0.3470101 
iter: 1  value: 19242 mgc: 0.03409871 ustep: 1 
iter: 2  value: 19242 mgc: 1.263665e-05 ustep: 1 
iter: 3  mgc: 2.044587e-12 
iter: 1  value: 19241.99 mgc: 0.01728383 ustep: 1 
iter: 2  value: 19241.99 mgc: 3.206634e-06 ustep: 1 
iter: 3  mgc: 1.429967e-13 
iter: 1  mgc: 1.429967e-13 
outer mgc:  0.06888197 
iter: 1  value: 19241.9 mgc: 0.01667442 ustep: 1 
iter: 2  value: 19241.9 mgc: 4.16356e-06 ustep: 1 
iter: 3  mgc: 2.34035e-13 
iter: 1  value: 19241.95 mgc: 0.005249378 ustep: 1 
iter: 2  value: 19241.95 mgc: 4.171315e-07 ustep: 1 
iter: 3  mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.03686411 
iter: 1  value: 19241.95 mgc: 0.007137861 ustep: 1 
iter: 2  value: 19241.95 mgc: 9.003925e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  0.01240729 
iter: 1  value: 19241.97 mgc: 0.006032314 ustep: 1 
iter: 2  value: 19241.97 mgc: 5.021977e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
iter: 1  value: 19241.95 mgc: 0.002607812 ustep: 1 
iter: 2  value: 19241.95 mgc: 9.364017e-08 ustep: 1 
iter: 3  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.01184705 
iter: 1  value: 19241.94 mgc: 0.002565752 ustep: 1 
iter: 2  value: 19241.94 mgc: 4.899107e-08 ustep: 1 
iter: 3  mgc: 4.884981e-15 
iter: 1  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.01184705 
iter: 1  value: 19241.95 mgc: 0.005011272 ustep: 1 
iter: 2  value: 19241.95 mgc: 2.441233e-07 ustep: 1 
iter: 3  mgc: 4.940492e-15 
outer mgc:  0.2485904 
iter: 1  value: 19241.96 mgc: 0.005008024 ustep: 1 
iter: 2  value: 19241.96 mgc: 2.440997e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.2699946 
iter: 1  value: 19241.95 mgc: 0.003004521 ustep: 1 
iter: 2  value: 19241.95 mgc: 9.642332e-08 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.1443069 
iter: 1  value: 19241.96 mgc: 0.003003163 ustep: 1 
iter: 2  value: 19241.96 mgc: 9.64256e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.1678981 
iter: 1  value: 19241.95 mgc: 0.005851745 ustep: 1 
iter: 2  value: 19241.95 mgc: 4.086496e-07 ustep: 1 
iter: 3  mgc: 6.106227e-15 
outer mgc:  0.2541823 
iter: 1  value: 19241.96 mgc: 0.005850271 ustep: 1 
iter: 2  value: 19241.96 mgc: 4.091576e-07 ustep: 1 
iter: 3  mgc: 6.827872e-15 
outer mgc:  0.2451481 
iter: 1  value: 19241.95 mgc: 0.003351375 ustep: 1 
iter: 2  value: 19241.95 mgc: 1.511465e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.1905665 
iter: 1  value: 19241.95 mgc: 0.003351051 ustep: 1 
iter: 2  value: 19241.95 mgc: 1.512992e-07 ustep: 1 
iter: 3  mgc: 4.884981e-15 
outer mgc:  0.1783595 
iter: 1  value: 19242.02 mgc: 0.01154929 ustep: 1 
iter: 2  value: 19242.02 mgc: 2.370819e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
outer mgc:  0.02929327 
iter: 1  value: 19241.89 mgc: 0.01157227 ustep: 1 
iter: 2  value: 19241.89 mgc: 2.366637e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  0.03012086 
iter: 1  value: 19242 mgc: 0.01102733 ustep: 1 
iter: 2  value: 19242 mgc: 1.252619e-06 ustep: 1 
iter: 3  mgc: 2.087219e-14 
outer mgc:  0.06748767 
iter: 1  value: 19241.91 mgc: 0.01105166 ustep: 1 
iter: 2  value: 19241.91 mgc: 1.252976e-06 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.05211571 
iter: 1  value: 19241.92 mgc: 0.005630379 ustep: 1 
iter: 2  value: 19241.92 mgc: 4.349952e-07 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.01368017 
iter: 1  value: 19241.99 mgc: 0.005622437 ustep: 1 
iter: 2  value: 19241.99 mgc: 4.350314e-07 ustep: 1 
iter: 3  mgc: 4.662937e-15 
outer mgc:  0.01564395 
iter: 1  value: 19241.92 mgc: 0.005170926 ustep: 1 
iter: 2  value: 19241.92 mgc: 4.654805e-07 ustep: 1 
iter: 3  mgc: 6.439294e-15 
outer mgc:  0.1157543 
iter: 1  value: 19241.99 mgc: 0.005167046 ustep: 1 
iter: 2  value: 19241.99 mgc: 4.6448e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.1246082 
[Sun Aug 15 23:53:45 2021]
Finished job 0.
1 of 1 steps (100%) done

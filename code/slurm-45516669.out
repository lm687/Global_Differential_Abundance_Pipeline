Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:03:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4431.801972 
final  value 3921.680585 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2552.837 mgc: 111.2878 ustep: 0.4367355 
iter: 2  value: 1335.962 mgc: 98.40179 ustep: 0.1263996 
iter: 3  value: 1289.045 mgc: 137.0496 ustep: 0.1972298 
iter: 4  value: 615.9624 mgc: 106.2846 ustep: 0.07075753 
iter: 5  value: 546.5829 mgc: 72.76428 ustep: 0.2660763 
iter: 6  value: 525.9128 mgc: 43.97023 ustep: 0.5158742 
iter: 7  value: 525.6911 mgc: 4.584576 ustep: 0.718272 
iter: 8  value: 525.691 mgc: 0.01927926 ustep: 0.8475246 
iter: 9  value: 525.691 mgc: 0.0003830193 ustep: 0.9206189 
iter: 10  value: 525.691 mgc: 4.445678e-06 ustep: 0.9594929 
iter: 11  value: 525.691 mgc: 2.511981e-08 ustep: 0.9795391 
mgc: 7.033241e-11 
iter: 1  mgc: 7.033241e-11 
Matching hessian patterns... Done
outer mgc:  199.6848 
iter: 1  value: 447.108 mgc: 30.39652 ustep: 1 
iter: 2  value: 446.0035 mgc: 4.018654 ustep: 1 
iter: 3  value: 446.0032 mgc: 0.09250087 ustep: 1 
iter: 4  value: 446.0032 mgc: 8.381964e-05 ustep: 1 
iter: 5  mgc: 2.099073e-10 
iter: 1  mgc: 2.099073e-10 
outer mgc:  64.78447 
iter: 1  value: 429.7788 mgc: 15.23542 ustep: 1 
iter: 2  value: 429.5536 mgc: 1.136079 ustep: 1 
iter: 3  value: 429.5536 mgc: 0.0158305 ustep: 1 
iter: 4  value: 429.5536 mgc: 4.974987e-06 ustep: 1 
iter: 5  mgc: 1.034173e-12 
iter: 1  mgc: 1.034173e-12 
outer mgc:  49.77175 
iter: 1  value: 437.682 mgc: 23.56209 ustep: 1 
iter: 2  value: 431.9111 mgc: 6.313784 ustep: 1 
iter: 3  value: 431.8952 mgc: 0.2618226 ustep: 1 
iter: 4  value: 431.8952 mgc: 0.002168185 ustep: 1 
iter: 5  value: 431.8952 mgc: 1.798004e-07 ustep: 1 
iter: 6  mgc: 2.264855e-14 
iter: 1  value: 419.4011 mgc: 15.92205 ustep: 1 
iter: 2  value: 418.8283 mgc: 1.871632 ustep: 1 
iter: 3  value: 418.8281 mgc: 0.02638897 ustep: 1 
iter: 4  value: 418.8281 mgc: 2.694333e-05 ustep: 1 
iter: 5  mgc: 3.079115e-11 
iter: 1  mgc: 3.079115e-11 
outer mgc:  42.92872 
iter: 1  value: 409.7162 mgc: 10.14471 ustep: 1 
iter: 2  value: 409.7047 mgc: 0.4166977 ustep: 1 
iter: 3  value: 409.7047 mgc: 0.0005802102 ustep: 1 
iter: 4  mgc: 1.264641e-09 
iter: 1  mgc: 1.264641e-09 
outer mgc:  14.02934 
iter: 1  value: 407.5158 mgc: 9.26386 ustep: 1 
iter: 2  value: 407.501 mgc: 0.3460329 ustep: 1 
iter: 3  value: 407.501 mgc: 0.001003354 ustep: 1 
iter: 4  value: 407.501 mgc: 1.177606e-08 ustep: 1 
mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  15.91614 
iter: 1  value: 403.8729 mgc: 13.54747 ustep: 1 
iter: 2  value: 403.4333 mgc: 1.610654 ustep: 1 
iter: 3  value: 403.4332 mgc: 0.01983148 ustep: 1 
iter: 4  value: 403.4332 mgc: 5.901951e-06 ustep: 1 
iter: 5  mgc: 9.023893e-13 
iter: 1  mgc: 9.023893e-13 
outer mgc:  19.03257 
iter: 1  value: 404.0826 mgc: 16.16216 ustep: 1 
iter: 2  value: 404.0075 mgc: 0.8244432 ustep: 1 
iter: 3  value: 404.0075 mgc: 0.007497879 ustep: 1 
iter: 4  value: 404.0075 mgc: 4.972392e-07 ustep: 1 
iter: 5  mgc: 2.708944e-14 
iter: 1  value: 403.2854 mgc: 10.51935 ustep: 1 
iter: 2  value: 403.2824 mgc: 0.251067 ustep: 1 
iter: 3  value: 403.2824 mgc: 0.0003451596 ustep: 1 
iter: 4  mgc: 8.002283e-10 
iter: 1  mgc: 8.002283e-10 
outer mgc:  30.18728 
iter: 1  value: 401.0816 mgc: 5.654503 ustep: 1 
iter: 2  value: 401.0793 mgc: 0.1223772 ustep: 1 
iter: 3  value: 401.0793 mgc: 0.0001190942 ustep: 1 
iter: 4  mgc: 2.716951e-10 
iter: 1  mgc: 2.716951e-10 
outer mgc:  8.011208 
iter: 1  value: 400.1861 mgc: 4.477571 ustep: 1 
iter: 2  value: 400.1823 mgc: 0.1358317 ustep: 1 
iter: 3  value: 400.1823 mgc: 0.0001757029 ustep: 1 
iter: 4  mgc: 7.078538e-10 
iter: 1  value: 398.9094 mgc: 12.66639 ustep: 1 
iter: 2  value: 398.5421 mgc: 1.370344 ustep: 1 
iter: 3  value: 398.5421 mgc: 0.01593417 ustep: 1 
iter: 4  value: 398.5421 mgc: 5.121613e-06 ustep: 1 
iter: 5  mgc: 8.011369e-13 
iter: 1  mgc: 8.011369e-13 
outer mgc:  18.88025 
iter: 1  value: 397.4732 mgc: 20.47808 ustep: 1 
iter: 2  value: 391.5553 mgc: 5.915036 ustep: 1 
iter: 3  value: 391.5409 mgc: 0.3988563 ustep: 1 
iter: 4  value: 391.5409 mgc: 0.002274579 ustep: 1 
iter: 5  value: 391.5409 mgc: 7.530019e-08 ustep: 1 
mgc: 1.84297e-14 
iter: 1  value: 443.921 mgc: 29.64053 ustep: 1 
iter: 2  value: 398.251 mgc: 17.93187 ustep: 1 
iter: 3  value: 397.6747 mgc: 2.351987 ustep: 1 
iter: 4  value: 397.6744 mgc: 0.07340252 ustep: 1 
iter: 5  value: 397.6744 mgc: 7.898099e-05 ustep: 1 
iter: 6  mgc: 9.174683e-11 
iter: 1  mgc: 1.84297e-14 
outer mgc:  12.71031 
iter: 1  value: 396.9019 mgc: 20.67968 ustep: 1 
iter: 2  value: 396.733 mgc: 1.469424 ustep: 1 
iter: 3  value: 396.733 mgc: 0.01262841 ustep: 1 
iter: 4  value: 396.733 mgc: 1.477748e-06 ustep: 1 
iter: 5  mgc: 2.842171e-14 
iter: 1  value: 394.7754 mgc: 14.03932 ustep: 1 
iter: 2  value: 394.7561 mgc: 0.4184721 ustep: 1 
iter: 3  value: 394.7561 mgc: 0.0008351844 ustep: 1 
iter: 4  mgc: 6.009704e-09 
iter: 1  value: 390.252 mgc: 4.482177 ustep: 1 
iter: 2  value: 390.2518 mgc: 0.03832408 ustep: 1 
iter: 3  value: 390.2518 mgc: 1.276028e-05 ustep: 1 
iter: 4  mgc: 1.471212e-12 
iter: 1  mgc: 1.471212e-12 
outer mgc:  9.476309 
iter: 1  value: 389.3511 mgc: 2.052152 ustep: 1 
iter: 2  value: 389.351 mgc: 0.02185791 ustep: 1 
iter: 3  value: 389.351 mgc: 1.005902e-05 ustep: 1 
iter: 4  mgc: 3.101075e-12 
iter: 1  mgc: 3.101075e-12 
outer mgc:  8.717196 
iter: 1  value: 387.5383 mgc: 3.746707 ustep: 1 
iter: 2  value: 387.5379 mgc: 0.057301 ustep: 1 
iter: 3  value: 387.5379 mgc: 2.785212e-05 ustep: 1 
iter: 4  mgc: 8.414602e-12 
iter: 1  mgc: 8.414602e-12 
outer mgc:  11.85651 
iter: 1  value: 384.8007 mgc: 8.685161 ustep: 1 
iter: 2  value: 384.7237 mgc: 0.5848371 ustep: 1 
iter: 3  value: 384.7237 mgc: 0.004356074 ustep: 1 
iter: 4  value: 384.7237 mgc: 2.544845e-07 ustep: 1 
iter: 5  mgc: 2.764455e-14 
iter: 1  mgc: 2.764455e-14 
outer mgc:  7.673148 
iter: 1  value: 383.427 mgc: 10.88128 ustep: 1 
iter: 2  value: 383.419 mgc: 0.2829641 ustep: 1 
iter: 3  value: 383.419 mgc: 0.0003282847 ustep: 1 
iter: 4  mgc: 1.02876e-09 
iter: 1  mgc: 1.02876e-09 
outer mgc:  9.526749 
iter: 1  value: 381.9789 mgc: 6.906359 ustep: 1 
iter: 2  value: 381.9781 mgc: 0.1152649 ustep: 1 
iter: 3  value: 381.9781 mgc: 3.973046e-05 ustep: 1 
iter: 4  mgc: 3.877343e-11 
iter: 1  mgc: 3.877343e-11 
outer mgc:  7.57391 
iter: 1  value: 390.1389 mgc: 4.394903 ustep: 1 
iter: 2  value: 390.1352 mgc: 0.1890696 ustep: 1 
iter: 3  value: 390.1352 mgc: 0.0001338726 ustep: 1 
iter: 4  mgc: 2.248351e-10 
iter: 1  value: 381.5961 mgc: 0.7417074 ustep: 1 
iter: 2  value: 381.5961 mgc: 0.004951661 ustep: 1 
iter: 3  value: 381.5961 mgc: 1.086061e-07 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  4.460268 
iter: 1  value: 381.2628 mgc: 2.878927 ustep: 1 
iter: 2  value: 381.2625 mgc: 0.0443094 ustep: 1 
iter: 3  value: 381.2625 mgc: 1.436651e-05 ustep: 1 
iter: 4  mgc: 2.331191e-12 
iter: 1  mgc: 2.331191e-12 
outer mgc:  5.606582 
iter: 1  value: 381.002 mgc: 0.7618878 ustep: 1 
iter: 2  value: 381.002 mgc: 0.003603758 ustep: 1 
iter: 3  value: 381.002 mgc: 1.07133e-07 ustep: 1 
mgc: 2.642331e-14 
iter: 1  mgc: 2.642331e-14 
outer mgc:  2.292683 
iter: 1  value: 380.7457 mgc: 0.4997915 ustep: 1 
iter: 2  value: 380.7457 mgc: 0.001243941 ustep: 1 
iter: 3  mgc: 8.906512e-09 
iter: 1  mgc: 8.906512e-09 
outer mgc:  0.8879261 
iter: 1  value: 380.6288 mgc: 1.18392 ustep: 1 
iter: 2  value: 380.6288 mgc: 0.007664145 ustep: 1 
iter: 3  value: 380.6288 mgc: 4.242952e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  value: 380.6831 mgc: 0.6640784 ustep: 1 
iter: 2  value: 380.6831 mgc: 0.0025933 ustep: 1 
iter: 3  value: 380.6831 mgc: 5.091827e-08 ustep: 1 
mgc: 2.9865e-14 
iter: 1  mgc: 2.9865e-14 
outer mgc:  2.802561 
iter: 1  value: 380.6582 mgc: 0.4821643 ustep: 1 
iter: 2  value: 380.6582 mgc: 0.000731471 ustep: 1 
iter: 3  mgc: 4.083557e-09 
iter: 1  mgc: 4.083557e-09 
outer mgc:  0.2015324 
iter: 1  value: 380.6219 mgc: 0.1897472 ustep: 1 
iter: 2  value: 380.6219 mgc: 0.0005282303 ustep: 1 
iter: 3  mgc: 7.129099e-09 
iter: 1  value: 380.6303 mgc: 0.105736 ustep: 1 
iter: 2  value: 380.6303 mgc: 2.949486e-05 ustep: 1 
iter: 3  mgc: 4.150458e-12 
iter: 1  mgc: 4.150458e-12 
outer mgc:  0.672389 
iter: 1  value: 380.618 mgc: 0.1139166 ustep: 1 
iter: 2  value: 380.618 mgc: 0.0001701511 ustep: 1 
iter: 3  mgc: 7.433965e-10 
iter: 1  mgc: 7.433965e-10 
outer mgc:  0.3779442 
iter: 1  value: 380.6345 mgc: 0.05194327 ustep: 1 
iter: 2  value: 380.6345 mgc: 4.475412e-05 ustep: 1 
iter: 3  mgc: 5.990142e-11 
iter: 1  mgc: 5.990142e-11 
outer mgc:  0.1152804 
iter: 1  value: 380.6328 mgc: 0.1455061 ustep: 1 
iter: 2  value: 380.6328 mgc: 4.240856e-05 ustep: 1 
iter: 3  mgc: 1.272493e-11 
iter: 1  mgc: 1.272493e-11 
outer mgc:  0.1417551 
iter: 1  value: 380.6298 mgc: 0.1218822 ustep: 1 
iter: 2  value: 380.6298 mgc: 7.905555e-05 ustep: 1 
iter: 3  mgc: 4.383027e-11 
iter: 1  value: 380.6314 mgc: 0.05232882 ustep: 1 
iter: 2  value: 380.6314 mgc: 1.547125e-05 ustep: 1 
iter: 3  mgc: 1.494527e-12 
iter: 1  mgc: 1.494527e-12 
outer mgc:  0.06826166 
iter: 1  value: 380.6329 mgc: 0.08427919 ustep: 1 
iter: 2  value: 380.6329 mgc: 2.245262e-05 ustep: 1 
iter: 3  mgc: 4.733325e-12 
iter: 1  mgc: 4.733325e-12 
outer mgc:  0.08146329 
iter: 1  value: 380.6322 mgc: 0.04051466 ustep: 1 
iter: 2  value: 380.6322 mgc: 4.907365e-06 ustep: 1 
iter: 3  mgc: 2.122746e-13 
iter: 1  mgc: 2.122746e-13 
outer mgc:  0.001050258 
iter: 1  value: 380.6322 mgc: 0.0001880187 ustep: 1 
iter: 2  mgc: 1.141742e-10 
iter: 1  mgc: 1.141742e-10 
outer mgc:  0.0001136835 
iter: 1  mgc: 1.141742e-10 
iter: 1  mgc: 1.141742e-10 
outer mgc:  0.0001136835 
iter: 1  value: 380.6316 mgc: 0.0399101 ustep: 1 
iter: 2  value: 380.6316 mgc: 9.320817e-06 ustep: 1 
iter: 3  mgc: 6.816769e-13 
outer mgc:  0.04490507 
iter: 1  value: 380.6328 mgc: 0.03989048 ustep: 1 
iter: 2  value: 380.6328 mgc: 9.329824e-06 ustep: 1 
iter: 3  mgc: 6.770695e-13 
outer mgc:  0.04486487 
iter: 1  value: 380.632 mgc: 0.02094236 ustep: 1 
iter: 2  value: 380.632 mgc: 2.929084e-06 ustep: 1 
iter: 3  mgc: 7.971401e-14 
outer mgc:  0.1275767 
iter: 1  value: 380.6325 mgc: 0.0209326 ustep: 1 
iter: 2  value: 380.6325 mgc: 2.929954e-06 ustep: 1 
iter: 3  mgc: 7.355228e-14 
outer mgc:  0.1274724 
iter: 1  value: 380.6327 mgc: 0.05505997 ustep: 1 
iter: 2  value: 380.6327 mgc: 7.698745e-06 ustep: 1 
iter: 3  mgc: 3.188561e-13 
outer mgc:  0.09002096 
iter: 1  value: 380.6318 mgc: 0.05506477 ustep: 1 
iter: 2  value: 380.6318 mgc: 7.69073e-06 ustep: 1 
iter: 3  mgc: 2.993161e-13 
outer mgc:  0.09012394 
iter: 1  value: 380.6329 mgc: 0.02831805 ustep: 1 
iter: 2  value: 380.6329 mgc: 2.044469e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.2571149 
iter: 1  value: 380.6317 mgc: 0.02832239 ustep: 1 
iter: 2  value: 380.6317 mgc: 2.046459e-06 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.2569016 
iter: 1  value: 380.6318 mgc: 0.00382369 ustep: 1 
iter: 2  value: 380.6318 mgc: 3.76341e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
outer mgc:  0.01546052 
iter: 1  value: 380.6326 mgc: 0.003820537 ustep: 1 
iter: 2  value: 380.6326 mgc: 3.757796e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.01549448 
iter: 1  value: 380.6351 mgc: 0.005933966 ustep: 1 
iter: 2  value: 380.6351 mgc: 1.042299e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.0295805 
iter: 1  value: 380.6293 mgc: 0.005946121 ustep: 1 
iter: 2  value: 380.6293 mgc: 1.045009e-06 ustep: 1 
iter: 3  mgc: 4.118927e-14 
outer mgc:  0.02956804 
iter: 1  value: 380.6344 mgc: 0.01003229 ustep: 1 
iter: 2  value: 380.6344 mgc: 5.862671e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.03283102 
iter: 1  value: 380.63 mgc: 0.01005226 ustep: 1 
iter: 2  value: 380.63 mgc: 5.880755e-07 ustep: 1 
iter: 3  mgc: 3.264056e-14 
outer mgc:  0.03290939 
[Fri Aug 13 11:03:29 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 01:27:22 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22035.965286 
iter  10 value 14519.918366
final  value 14519.833209 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13939 mgc: 5.243725 ustep: 0.6827823 
iter: 2  value: 13851.7 mgc: 3.586216 ustep: 0.8263238 
iter: 3  value: 13843.25 mgc: 4.448503 ustep: 0.9090326 
iter: 4  value: 13830.16 mgc: 4.273814 ustep: 0.7841362 
iter: 5  value: 13827.11 mgc: 4.232825 ustep: 0.8855261 
iter: 6  value: 13824.1 mgc: 3.348363 ustep: 0.7570866 
iter: 7  value: 13821.81 mgc: 4.118661 ustep: 0.8701202 
iter: 8  value: 13819.97 mgc: 2.862321 ustep: 0.7407138 
iter: 9  value: 13817.6 mgc: 3.052363 ustep: 0.8606613 
iter: 10  value: 13817.48 mgc: 0.7026186 ustep: 0.9277255 
iter: 11  value: 13817.47 mgc: 0.04554509 ustep: 0.9631888 
iter: 12  value: 13817.47 mgc: 0.0009295246 ustep: 0.9814237 
iter: 13  value: 13817.47 mgc: 1.835054e-05 ustep: 0.9906692 
iter: 14  value: 13817.47 mgc: 3.671479e-07 ustep: 0.9953241 
iter: 15  mgc: 4.332431e-09 
iter: 1  mgc: 4.332431e-09 
Matching hessian patterns... Done
outer mgc:  78.09152 
iter: 1  value: 13730.5 mgc: 1.179262 ustep: 1 
iter: 2  value: 13729.91 mgc: 0.3072228 ustep: 1 
iter: 3  value: 13729.91 mgc: 0.01128429 ustep: 1 
iter: 4  value: 13729.91 mgc: 2.382207e-05 ustep: 1 
iter: 5  mgc: 9.763856e-11 
iter: 1  mgc: 9.763856e-11 
outer mgc:  101.065 
iter: 1  value: 13734.15 mgc: 2.564647 ustep: 1 
iter: 2  value: 13728.26 mgc: 0.8522831 ustep: 1 
iter: 3  value: 13728.23 mgc: 0.1176066 ustep: 1 
iter: 4  value: 13728.23 mgc: 0.004577421 ustep: 1 
iter: 5  value: 13728.23 mgc: 7.148958e-06 ustep: 1 
iter: 6  mgc: 1.720968e-11 
iter: 1  value: 13693.77 mgc: 0.6251803 ustep: 1 
iter: 2  value: 13693.75 mgc: 0.03716225 ustep: 1 
iter: 3  value: 13693.75 mgc: 0.0001774859 ustep: 1 
iter: 4  mgc: 9.759091e-09 
iter: 1  mgc: 9.759091e-09 
outer mgc:  92.73847 
iter: 1  value: 13652.83 mgc: 0.8157341 ustep: 1 
iter: 2  value: 13652.81 mgc: 0.1140191 ustep: 1 
iter: 3  value: 13652.81 mgc: 0.002847793 ustep: 1 
iter: 4  value: 13652.81 mgc: 4.126124e-06 ustep: 1 
iter: 5  mgc: 8.535395e-12 
iter: 1  mgc: 8.535395e-12 
outer mgc:  98.69157 
iter: 1  value: 13560.51 mgc: 1.133411 ustep: 1 
iter: 2  value: 13558.66 mgc: 0.4219365 ustep: 1 
iter: 3  value: 13558.65 mgc: 0.01535397 ustep: 1 
iter: 4  value: 13558.65 mgc: 6.984044e-05 ustep: 1 
iter: 5  mgc: 1.397594e-09 
iter: 1  mgc: 1.397594e-09 
outer mgc:  94.7804 
iter: 1  value: 13395.63 mgc: 4.319804 ustep: 1 
iter: 2  value: 13360.5 mgc: 4.971519 ustep: 1 
iter: 3  value: 13359.53 mgc: 1.508667 ustep: 1 
iter: 4  value: 13358.53 mgc: 2.387907 ustep: 1 
iter: 5  value: 13358.53 mgc: 0.1889626 ustep: 1 
iter: 6  value: 13358.53 mgc: 0.003859945 ustep: 1 
iter: 7  value: 13358.53 mgc: 2.009124e-06 ustep: 1 
iter: 8  mgc: 5.124789e-13 
iter: 1  value: 13165.6 mgc: 8.277311 ustep: 1 
iter: 2  value: 13152.03 mgc: 3.396331 ustep: 1 
iter: 3  value: 13151.95 mgc: 0.4008075 ustep: 1 
iter: 4  value: 13151.95 mgc: 0.006916495 ustep: 1 
iter: 5  value: 13151.95 mgc: 8.371362e-06 ustep: 1 
iter: 6  mgc: 7.490231e-12 
iter: 1  mgc: 7.490231e-12 
outer mgc:  67.87271 
iter: 1  value: 16668.54 mgc: 2225.38 ustep: 0.1336527 
iter: 2  value: 15895.93 mgc: 146.0877 ustep: 0.203518 
iter: 3  value: 15777.89 mgc: 55.5824 ustep: 0.4511846 
iter: 4  value: 15757.14 mgc: 29.37063 ustep: 0.6717356 
iter: 5  value: 15756.55 mgc: 6.094466 ustep: 0.8196128 
iter: 6  value: 15756.55 mgc: 0.1973994 ustep: 0.9053342 
iter: 7  value: 15756.55 mgc: 0.0008833346 ustep: 0.9514954 
iter: 8  value: 15756.55 mgc: 3.716156e-06 ustep: 0.9754487 
iter: 9  mgc: 7.919851e-09 
iter: 1  value: 13104.02 mgc: 5.942507 ustep: 1 
iter: 2  value: 13103.96 mgc: 0.3345586 ustep: 1 
iter: 3  value: 13103.96 mgc: 0.004279965 ustep: 1 
iter: 4  value: 13103.96 mgc: 5.132535e-06 ustep: 1 
iter: 5  mgc: 5.178524e-12 
iter: 1  mgc: 5.178524e-12 
outer mgc:  40.66652 
iter: 1  value: 13077.46 mgc: 7.754682 ustep: 1 
iter: 2  value: 13077.41 mgc: 0.2079862 ustep: 1 
iter: 3  value: 13077.41 mgc: 0.002854503 ustep: 1 
iter: 4  value: 13077.41 mgc: 8.490458e-07 ustep: 1 
iter: 5  mgc: 1.136868e-13 
iter: 1  mgc: 1.136868e-13 
outer mgc:  67.31929 
iter: 1  value: 13038.66 mgc: 4.570589 ustep: 1 
iter: 2  value: 13038.66 mgc: 0.03891684 ustep: 1 
iter: 3  value: 13038.66 mgc: 0.0001014974 ustep: 1 
iter: 4  mgc: 1.300835e-09 
iter: 1  mgc: 1.300835e-09 
outer mgc:  21.14446 
iter: 1  value: 13014.18 mgc: 5.064856 ustep: 1 
iter: 2  value: 13014.18 mgc: 0.02791809 ustep: 1 
iter: 3  value: 13014.18 mgc: 5.710119e-05 ustep: 1 
iter: 4  mgc: 2.682521e-10 
iter: 1  mgc: 2.682521e-10 
outer mgc:  40.05788 
iter: 1  value: 13001.43 mgc: 1.216484 ustep: 1 
iter: 2  value: 13001.43 mgc: 0.01436618 ustep: 1 
iter: 3  value: 13001.43 mgc: 1.932903e-05 ustep: 1 
iter: 4  mgc: 2.469758e-11 
iter: 1  mgc: 2.469758e-11 
outer mgc:  16.50584 
iter: 1  value: 13017.31 mgc: 3.675501 ustep: 1 
iter: 2  value: 13017.31 mgc: 0.05486973 ustep: 1 
iter: 3  value: 13017.31 mgc: 0.0002725454 ustep: 1 
iter: 4  mgc: 6.551349e-09 
iter: 1  mgc: 6.551349e-09 
outer mgc:  16.22129 
iter: 1  value: 13006.9 mgc: 0.5142276 ustep: 1 
iter: 2  value: 13006.9 mgc: 0.001817563 ustep: 1 
iter: 3  value: 13006.9 mgc: 1.584407e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  18.86643 
iter: 1  value: 13003.19 mgc: 1.376768 ustep: 1 
iter: 2  value: 13003.19 mgc: 0.004481972 ustep: 1 
iter: 3  value: 13003.19 mgc: 1.010681e-06 ustep: 1 
iter: 4  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  12.69909 
iter: 1  value: 13000.07 mgc: 1.078434 ustep: 1 
iter: 2  value: 13000.07 mgc: 0.01162448 ustep: 1 
iter: 3  value: 13000.07 mgc: 8.131692e-06 ustep: 1 
iter: 4  mgc: 7.39675e-12 
iter: 1  mgc: 7.39675e-12 
outer mgc:  5.051177 
iter: 1  value: 13007.78 mgc: 3.714309 ustep: 1 
iter: 2  value: 13007.78 mgc: 0.01980351 ustep: 1 
iter: 3  value: 13007.78 mgc: 1.279217e-05 ustep: 1 
iter: 4  mgc: 1.115907e-11 
iter: 1  value: 12999.74 mgc: 0.3627307 ustep: 1 
iter: 2  value: 12999.74 mgc: 0.0002192767 ustep: 1 
iter: 3  mgc: 1.187039e-09 
iter: 1  mgc: 1.187039e-09 
outer mgc:  3.7802 
iter: 1  value: 12998.62 mgc: 0.2029998 ustep: 1 
iter: 2  value: 12998.62 mgc: 0.000224018 ustep: 1 
iter: 3  mgc: 4.638138e-09 
iter: 1  mgc: 4.638138e-09 
outer mgc:  1.796163 
iter: 1  value: 13000.55 mgc: 0.5795117 ustep: 1 
iter: 2  value: 13000.55 mgc: 0.0006889025 ustep: 1 
iter: 3  value: 13000.55 mgc: 2.769614e-08 ustep: 1 
iter: 4  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  1.056102 
iter: 1  value: 12998.22 mgc: 0.5022797 ustep: 1 
iter: 2  value: 12998.22 mgc: 0.001260449 ustep: 1 
iter: 3  value: 12998.22 mgc: 1.362551e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  2.445185 
iter: 1  value: 12995.82 mgc: 0.3284085 ustep: 1 
iter: 2  value: 12995.82 mgc: 0.0007174754 ustep: 1 
iter: 3  value: 12995.82 mgc: 6.106232e-08 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  value: 12997.29 mgc: 0.1703729 ustep: 1 
iter: 2  value: 12997.29 mgc: 8.526724e-05 ustep: 1 
iter: 3  mgc: 1.138003e-09 
iter: 1  value: 12998.06 mgc: 0.07666035 ustep: 1 
iter: 2  value: 12998.06 mgc: 5.766415e-06 ustep: 1 
iter: 3  mgc: 9.237056e-14 
iter: 1  mgc: 9.237056e-14 
outer mgc:  2.24234 
iter: 1  value: 12997.57 mgc: 0.09633056 ustep: 1 
iter: 2  value: 12997.57 mgc: 3.195579e-05 ustep: 1 
iter: 3  mgc: 7.09619e-11 
iter: 1  mgc: 7.09619e-11 
outer mgc:  0.4597108 
iter: 1  value: 12997.75 mgc: 0.1109393 ustep: 1 
iter: 2  value: 12997.75 mgc: 1.874414e-05 ustep: 1 
iter: 3  mgc: 1.535394e-11 
iter: 1  mgc: 1.535394e-11 
outer mgc:  0.4169735 
iter: 1  value: 13000.02 mgc: 0.224958 ustep: 1 
iter: 2  value: 13000.02 mgc: 0.0001622784 ustep: 1 
iter: 3  mgc: 2.518607e-09 
iter: 1  value: 12998.59 mgc: 0.08385117 ustep: 1 
iter: 2  value: 12998.59 mgc: 2.154893e-05 ustep: 1 
iter: 3  mgc: 4.579262e-11 
iter: 1  mgc: 4.579262e-11 
outer mgc:  0.1832611 
iter: 1  value: 12998.72 mgc: 0.05492493 ustep: 1 
iter: 2  value: 12998.72 mgc: 1.185367e-05 ustep: 1 
iter: 3  mgc: 1.731681e-11 
iter: 1  mgc: 1.731681e-11 
outer mgc:  0.07815024 
iter: 1  value: 12998.96 mgc: 0.0492044 ustep: 1 
iter: 2  value: 12998.96 mgc: 2.191958e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
iter: 1  value: 12999.35 mgc: 0.08059817 ustep: 1 
iter: 2  value: 12999.35 mgc: 6.002732e-06 ustep: 1 
iter: 3  mgc: 6.12399e-13 
iter: 1  mgc: 6.12399e-13 
outer mgc:  0.1582643 
iter: 1  value: 13000.41 mgc: 0.1273527 ustep: 1 
iter: 2  value: 13000.41 mgc: 3.044099e-05 ustep: 1 
iter: 3  mgc: 2.758682e-12 
iter: 1  mgc: 2.758682e-12 
outer mgc:  0.1166312 
iter: 1  value: 13000.62 mgc: 0.05634065 ustep: 1 
iter: 2  value: 13000.62 mgc: 5.732143e-06 ustep: 1 
iter: 3  mgc: 9.006129e-13 
iter: 1  mgc: 9.006129e-13 
outer mgc:  0.0517082 
iter: 1  value: 13000.81 mgc: 0.05821415 ustep: 1 
iter: 2  value: 13000.81 mgc: 1.281054e-05 ustep: 1 
iter: 3  mgc: 1.244516e-11 
iter: 1  mgc: 1.244516e-11 
outer mgc:  0.04375243 
iter: 1  value: 13000.79 mgc: 0.02309539 ustep: 1 
iter: 2  value: 13000.79 mgc: 1.912933e-06 ustep: 1 
iter: 3  mgc: 3.93463e-13 
iter: 1  mgc: 3.93463e-13 
outer mgc:  0.002603084 
iter: 1  value: 13000.79 mgc: 0.0003049437 ustep: 1 
iter: 2  mgc: 9.07785e-11 
iter: 1  mgc: 9.07785e-11 
outer mgc:  0.0006967902 
iter: 1  mgc: 9.07785e-11 
iter: 1  mgc: 9.07785e-11 
outer mgc:  0.0006967902 
iter: 1  value: 13000.8 mgc: 0.005027512 ustep: 1 
iter: 2  value: 13000.8 mgc: 1.551565e-07 ustep: 1 
iter: 3  mgc: 5.995204e-15 
outer mgc:  0.3000905 
iter: 1  value: 13000.78 mgc: 0.005029358 ustep: 1 
iter: 2  value: 13000.78 mgc: 1.54758e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.3009551 
iter: 1  value: 13000.79 mgc: 0.002376971 ustep: 1 
iter: 2  value: 13000.79 mgc: 1.190917e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.1320431 
iter: 1  value: 13000.79 mgc: 0.002378588 ustep: 1 
iter: 2  value: 13000.79 mgc: 1.1921e-08 ustep: 1 
iter: 3  mgc: 7.771561e-15 
outer mgc:  0.1320255 
iter: 1  value: 13000.79 mgc: 0.005038301 ustep: 1 
iter: 2  value: 13000.79 mgc: 5.524652e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.2961306 
iter: 1  value: 13000.79 mgc: 0.005036562 ustep: 1 
iter: 2  value: 13000.79 mgc: 5.522615e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.294569 
iter: 1  value: 13000.79 mgc: 0.002190599 ustep: 1 
iter: 2  mgc: 9.244579e-09 
outer mgc:  0.1190217 
iter: 1  value: 13000.79 mgc: 0.002189301 ustep: 1 
iter: 2  mgc: 9.233507e-09 
outer mgc:  0.1189796 
iter: 1  value: 13000.85 mgc: 0.02397413 ustep: 1 
iter: 2  value: 13000.85 mgc: 1.002507e-06 ustep: 1 
iter: 3  mgc: 5.151435e-14 
outer mgc:  0.06132747 
iter: 1  value: 13000.73 mgc: 0.02403721 ustep: 1 
iter: 2  value: 13000.73 mgc: 1.003602e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.06065524 
iter: 1  value: 13000.87 mgc: 0.02729965 ustep: 1 
iter: 2  value: 13000.87 mgc: 3.052716e-06 ustep: 1 
iter: 3  mgc: 7.336354e-13 
outer mgc:  0.04103287 
iter: 1  value: 13000.71 mgc: 0.02737231 ustep: 1 
iter: 2  value: 13000.71 mgc: 3.043967e-06 ustep: 1 
iter: 3  mgc: 7.354117e-13 
outer mgc:  0.0410068 
iter: 1  value: 13000.76 mgc: 0.00403585 ustep: 1 
iter: 2  value: 13000.76 mgc: 2.083239e-08 ustep: 1 
mgc: 6.050715e-15 
outer mgc:  0.002513759 
iter: 1  value: 13000.82 mgc: 0.004034305 ustep: 1 
iter: 2  value: 13000.82 mgc: 2.086674e-08 ustep: 1 
mgc: 7.105427e-15 
outer mgc:  0.003662814 
iter: 1  value: 13000.77 mgc: 0.004404393 ustep: 1 
iter: 2  value: 13000.77 mgc: 1.100394e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.1138239 
iter: 1  value: 13000.81 mgc: 0.004401523 ustep: 1 
iter: 2  value: 13000.81 mgc: 1.097763e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.1149628 
[Sat Aug 14 01:27:28 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 12:17:37 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21853.595646 
final  value 20703.401061 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 7993.961 mgc: 123.8694 ustep: 1 
iter: 2  value: 4733.235 mgc: 93.25819 ustep: 0.1336527 
iter: 3  value: 4570.315 mgc: 148.9507 ustep: 0.203518 
iter: 4  value: 4079.946 mgc: 100.8579 ustep: 0.1392616 
iter: 5  value: 3962.171 mgc: 160.2996 ustep: 0.1102124 
iter: 6  value: 2545.461 mgc: 104.0528 ustep: 0.09594352 
iter: 7  value: 2482.274 mgc: 56.37689 ustep: 0.3098165 
iter: 8  value: 2474.398 mgc: 28.97949 ustep: 0.556656 
iter: 9  value: 2474.359 mgc: 1.944063 ustep: 0.7461192 
iter: 10  value: 2474.359 mgc: 0.0267926 ustep: 0.8637955 
iter: 11  value: 2474.359 mgc: 0.0001083672 ustep: 0.9294131 
iter: 12  value: 2474.359 mgc: 1.940975e-06 ustep: 0.9640643 
iter: 13  value: 2474.359 mgc: 1.722655e-08 ustep: 0.9818696 
mgc: 7.607825e-11 
iter: 1  mgc: 7.607825e-11 
Matching hessian patterns... Done
outer mgc:  186.5273 
iter: 1  value: 2582.689 mgc: 31.38825 ustep: 1 
iter: 2  value: 2578.068 mgc: 4.294028 ustep: 1 
iter: 3  value: 2578.067 mgc: 0.1148904 ustep: 1 
iter: 4  value: 2578.067 mgc: 0.0001160618 ustep: 1 
iter: 5  mgc: 1.725952e-10 
iter: 1  value: 2435.883 mgc: 11.21368 ustep: 1 
iter: 2  value: 2435.833 mgc: 0.443003 ustep: 1 
iter: 3  value: 2435.833 mgc: 0.001408132 ustep: 1 
iter: 4  value: 2435.833 mgc: 1.497785e-08 ustep: 1 
mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  127.3795 
iter: 1  value: 2423.902 mgc: 4.558196 ustep: 1 
iter: 2  value: 2423.899 mgc: 0.09486805 ustep: 1 
iter: 3  value: 2423.899 mgc: 8.881754e-05 ustep: 1 
iter: 4  mgc: 1.17931e-10 
iter: 1  mgc: 1.17931e-10 
outer mgc:  210.8751 
iter: 1  value: 2376.205 mgc: 15.75456 ustep: 1 
iter: 2  value: 2375.477 mgc: 1.126321 ustep: 1 
iter: 3  value: 2375.477 mgc: 0.0150038 ustep: 1 
iter: 4  value: 2375.477 mgc: 2.910062e-06 ustep: 1 
iter: 5  mgc: 1.59206e-13 
iter: 1  mgc: 1.59206e-13 
outer mgc:  79.01996 
iter: 1  value: 2326.671 mgc: 17.84595 ustep: 1 
iter: 2  value: 2324.774 mgc: 1.770028 ustep: 1 
iter: 3  value: 2324.774 mgc: 0.02912161 ustep: 1 
iter: 4  value: 2324.774 mgc: 1.970341e-05 ustep: 1 
iter: 5  mgc: 9.030776e-12 
iter: 1  mgc: 9.030776e-12 
outer mgc:  141.5682 
iter: 1  value: 2313.017 mgc: 22.28781 ustep: 1 
iter: 2  value: 2305.52 mgc: 3.194268 ustep: 1 
iter: 3  value: 2305.513 mgc: 0.2598936 ustep: 1 
iter: 4  value: 2305.513 mgc: 0.002174194 ustep: 1 
iter: 5  value: 2305.513 mgc: 1.552388e-07 ustep: 1 
iter: 6  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  240.9873 
iter: 1  value: 2309.448 mgc: 14.36943 ustep: 1 
iter: 2  value: 2308.623 mgc: 3.610213 ustep: 1 
iter: 3  value: 2308.622 mgc: 0.1420617 ustep: 1 
iter: 4  value: 2308.622 mgc: 0.0002397343 ustep: 1 
iter: 5  mgc: 6.861818e-10 
iter: 1  value: 2283.383 mgc: 11.55895 ustep: 1 
iter: 2  value: 2283.345 mgc: 0.3568422 ustep: 1 
iter: 3  value: 2283.345 mgc: 0.0006990199 ustep: 1 
iter: 4  mgc: 3.438617e-09 
iter: 1  mgc: 3.438617e-09 
outer mgc:  99.62222 
iter: 1  value: 2271.255 mgc: 14.87363 ustep: 1 
iter: 2  value: 2270.752 mgc: 0.8083485 ustep: 1 
iter: 3  value: 2270.752 mgc: 0.004922637 ustep: 1 
iter: 4  value: 2270.752 mgc: 2.252745e-07 ustep: 1 
iter: 5  mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  50.40399 
iter: 1  value: 2263.089 mgc: 12.65492 ustep: 1 
iter: 2  value: 2263.011 mgc: 0.5769079 ustep: 1 
iter: 3  value: 2263.011 mgc: 0.002070908 ustep: 1 
iter: 4  value: 2263.011 mgc: 3.073904e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  41.21188 
iter: 1  value: 2263.16 mgc: 12.22373 ustep: 1 
iter: 2  value: 2262.775 mgc: 0.6358917 ustep: 1 
iter: 3  value: 2262.775 mgc: 0.007480216 ustep: 1 
iter: 4  value: 2262.775 mgc: 1.238245e-06 ustep: 1 
iter: 5  mgc: 3.108624e-14 
iter: 1  value: 2261.702 mgc: 8.059624 ustep: 1 
iter: 2  value: 2261.643 mgc: 0.2869653 ustep: 1 
iter: 3  value: 2261.643 mgc: 0.0005906658 ustep: 1 
iter: 4  mgc: 3.419468e-09 
iter: 1  mgc: 3.419468e-09 
outer mgc:  49.89808 
iter: 1  value: 2261.14 mgc: 5.53527 ustep: 1 
iter: 2  value: 2261.138 mgc: 0.0849905 ustep: 1 
iter: 3  value: 2261.138 mgc: 4.71969e-05 ustep: 1 
iter: 4  mgc: 2.325962e-11 
iter: 1  value: 2260.206 mgc: 4.139168 ustep: 1 
iter: 2  value: 2260.205 mgc: 0.04233252 ustep: 1 
iter: 3  value: 2260.205 mgc: 1.658624e-05 ustep: 1 
iter: 4  mgc: 2.680522e-12 
iter: 1  mgc: 2.680522e-12 
outer mgc:  36.22119 
iter: 1  value: 2258.811 mgc: 1.619927 ustep: 1 
iter: 2  value: 2258.811 mgc: 0.01505807 ustep: 1 
iter: 3  value: 2258.811 mgc: 5.841323e-06 ustep: 1 
iter: 4  mgc: 8.81073e-13 
iter: 1  mgc: 8.81073e-13 
outer mgc:  8.708396 
iter: 1  value: 2258.573 mgc: 1.849929 ustep: 1 
iter: 2  value: 2258.572 mgc: 0.01241034 ustep: 1 
iter: 3  value: 2258.572 mgc: 1.08523e-06 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  16.1022 
iter: 1  value: 2258.394 mgc: 3.269875 ustep: 1 
iter: 2  value: 2258.393 mgc: 0.04427676 ustep: 1 
iter: 3  value: 2258.393 mgc: 2.407605e-05 ustep: 1 
iter: 4  mgc: 8.395395e-12 
iter: 1  mgc: 8.395395e-12 
outer mgc:  20.73111 
iter: 1  value: 2258.673 mgc: 0.6760675 ustep: 1 
iter: 2  value: 2258.673 mgc: 0.01298479 ustep: 1 
iter: 3  value: 2258.673 mgc: 4.436807e-06 ustep: 1 
iter: 4  mgc: 5.213607e-13 
iter: 1  value: 2257.959 mgc: 1.1224 ustep: 1 
iter: 2  value: 2257.959 mgc: 0.004695381 ustep: 1 
iter: 3  value: 2257.959 mgc: 1.794639e-07 ustep: 1 
iter: 4  mgc: 4.662937e-14 
iter: 1  mgc: 4.662937e-14 
outer mgc:  13.13418 
iter: 1  value: 2258.448 mgc: 1.677231 ustep: 1 
iter: 2  value: 2258.448 mgc: 0.007361588 ustep: 1 
iter: 3  value: 2258.448 mgc: 3.444364e-07 ustep: 1 
iter: 4  mgc: 3.691492e-14 
iter: 1  value: 2257.888 mgc: 0.5660164 ustep: 1 
iter: 2  value: 2257.888 mgc: 0.001064602 ustep: 1 
iter: 3  value: 2257.888 mgc: 1.010368e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  5.296334 
iter: 1  value: 2257.781 mgc: 0.6233349 ustep: 1 
iter: 2  value: 2257.781 mgc: 0.001396937 ustep: 1 
iter: 3  value: 2257.781 mgc: 1.400079e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  3.953959 
iter: 1  value: 2257.763 mgc: 0.3713945 ustep: 1 
iter: 2  value: 2257.763 mgc: 0.0003100695 ustep: 1 
iter: 3  mgc: 5.059846e-10 
iter: 1  mgc: 5.059846e-10 
outer mgc:  1.557337 
iter: 1  value: 2257.714 mgc: 0.3196717 ustep: 1 
iter: 2  value: 2257.714 mgc: 0.0002768778 ustep: 1 
iter: 3  mgc: 8.003669e-10 
iter: 1  mgc: 8.003669e-10 
outer mgc:  3.656034 
iter: 1  value: 2257.774 mgc: 0.1407907 ustep: 1 
iter: 2  value: 2257.774 mgc: 7.199352e-05 ustep: 1 
iter: 3  mgc: 7.444623e-11 
iter: 1  mgc: 7.444623e-11 
outer mgc:  3.992624 
iter: 1  value: 2257.898 mgc: 0.1616936 ustep: 1 
iter: 2  value: 2257.898 mgc: 0.0007524618 ustep: 1 
iter: 3  value: 2257.898 mgc: 1.604955e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  1.651005 
iter: 1  value: 2257.731 mgc: 0.1863403 ustep: 1 
iter: 2  value: 2257.731 mgc: 0.0008417911 ustep: 1 
iter: 3  value: 2257.731 mgc: 1.974431e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  1.374718 
iter: 1  value: 2257.699 mgc: 0.5403079 ustep: 1 
iter: 2  value: 2257.699 mgc: 0.0008396532 ustep: 1 
iter: 3  mgc: 6.2699e-09 
iter: 1  value: 2257.732 mgc: 0.1281637 ustep: 1 
iter: 2  value: 2257.732 mgc: 4.218614e-05 ustep: 1 
iter: 3  mgc: 1.210809e-11 
iter: 1  mgc: 1.210809e-11 
outer mgc:  1.104907 
iter: 1  value: 2257.754 mgc: 0.1233286 ustep: 1 
iter: 2  value: 2257.754 mgc: 5.017872e-05 ustep: 1 
iter: 3  mgc: 2.057199e-11 
iter: 1  value: 2257.736 mgc: 0.04961619 ustep: 1 
iter: 2  value: 2257.736 mgc: 8.874526e-06 ustep: 1 
iter: 3  mgc: 6.42264e-13 
iter: 1  mgc: 6.42264e-13 
outer mgc:  0.4762583 
iter: 1  value: 2257.742 mgc: 0.03628057 ustep: 1 
iter: 2  value: 2257.742 mgc: 4.186442e-06 ustep: 1 
iter: 3  mgc: 9.747758e-14 
iter: 1  mgc: 9.747758e-14 
outer mgc:  0.3039639 
iter: 1  value: 2257.756 mgc: 0.02470412 ustep: 1 
iter: 2  value: 2257.756 mgc: 2.562181e-06 ustep: 1 
iter: 3  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  0.4109029 
iter: 1  value: 2257.758 mgc: 0.03111582 ustep: 1 
iter: 2  value: 2257.758 mgc: 3.192868e-06 ustep: 1 
iter: 3  mgc: 2.851053e-13 
iter: 1  mgc: 2.851053e-13 
outer mgc:  0.2476297 
iter: 1  value: 2257.752 mgc: 0.1106303 ustep: 1 
iter: 2  value: 2257.752 mgc: 3.776495e-05 ustep: 1 
iter: 3  mgc: 1.361089e-11 
iter: 1  value: 2257.757 mgc: 0.04070332 ustep: 1 
iter: 2  value: 2257.757 mgc: 5.000947e-06 ustep: 1 
iter: 3  mgc: 2.295941e-13 
iter: 1  mgc: 2.295941e-13 
outer mgc:  0.2821233 
iter: 1  value: 2257.757 mgc: 0.02640829 ustep: 1 
iter: 2  value: 2257.757 mgc: 2.406456e-06 ustep: 1 
iter: 3  mgc: 6.861178e-14 
iter: 1  mgc: 6.861178e-14 
outer mgc:  0.05958008 
iter: 1  value: 2257.756 mgc: 0.01058936 ustep: 1 
iter: 2  value: 2257.756 mgc: 2.704999e-07 ustep: 1 
iter: 3  mgc: 3.452794e-14 
iter: 1  mgc: 3.452794e-14 
outer mgc:  0.1072553 
iter: 1  value: 2257.765 mgc: 0.01898874 ustep: 1 
iter: 2  value: 2257.765 mgc: 1.223462e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.1016034 
iter: 1  value: 2257.764 mgc: 0.0326878 ustep: 1 
iter: 2  value: 2257.764 mgc: 3.414426e-06 ustep: 1 
iter: 3  mgc: 7.01661e-14 
iter: 1  value: 2257.764 mgc: 0.01092502 ustep: 1 
iter: 2  value: 2257.764 mgc: 6.508022e-07 ustep: 1 
iter: 3  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  0.1300549 
iter: 1  value: 2257.763 mgc: 0.01153375 ustep: 1 
iter: 2  value: 2257.763 mgc: 3.992237e-07 ustep: 1 
iter: 3  mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  0.02036106 
iter: 1  value: 2257.759 mgc: 0.01463264 ustep: 1 
iter: 2  value: 2257.759 mgc: 5.8978e-07 ustep: 1 
iter: 3  mgc: 4.668488e-14 
iter: 1  value: 2257.762 mgc: 0.003714683 ustep: 1 
iter: 2  value: 2257.762 mgc: 3.801628e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.01200914 
iter: 1  value: 2257.761 mgc: 0.001442328 ustep: 1 
iter: 2  mgc: 5.554455e-09 
iter: 1  mgc: 5.554455e-09 
outer mgc:  0.03325118 
iter: 1  value: 2257.761 mgc: 0.001535415 ustep: 1 
iter: 2  value: 2257.761 mgc: 1.145284e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.004851416 
iter: 1  value: 2257.761 mgc: 0.0014641 ustep: 1 
iter: 2  mgc: 7.262546e-09 
iter: 1  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.004851416 
iter: 1  value: 2257.759 mgc: 0.05348266 ustep: 1 
iter: 2  value: 2257.759 mgc: 9.151508e-06 ustep: 1 
iter: 3  mgc: 6.044054e-13 
outer mgc:  0.3072916 
iter: 1  value: 2257.763 mgc: 0.05346905 ustep: 1 
iter: 2  value: 2257.763 mgc: 9.160311e-06 ustep: 1 
iter: 3  mgc: 6.055156e-13 
outer mgc:  0.3047819 
iter: 1  value: 2257.761 mgc: 0.02631344 ustep: 1 
iter: 2  value: 2257.761 mgc: 2.840867e-06 ustep: 1 
iter: 3  mgc: 7.727152e-14 
outer mgc:  0.8523539 
iter: 1  value: 2257.762 mgc: 0.02630797 ustep: 1 
iter: 2  value: 2257.762 mgc: 2.840729e-06 ustep: 1 
iter: 3  mgc: 7.388534e-14 
outer mgc:  0.8510378 
iter: 1  value: 2257.764 mgc: 0.05645763 ustep: 1 
iter: 2  value: 2257.764 mgc: 8.396252e-06 ustep: 1 
iter: 3  mgc: 4.511946e-13 
outer mgc:  0.391067 
iter: 1  value: 2257.759 mgc: 0.05646166 ustep: 1 
iter: 2  value: 2257.759 mgc: 8.404221e-06 ustep: 1 
iter: 3  mgc: 4.427569e-13 
outer mgc:  0.3946633 
iter: 1  value: 2257.763 mgc: 0.03024994 ustep: 1 
iter: 2  value: 2257.763 mgc: 2.407558e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  1.255164 
iter: 1  value: 2257.76 mgc: 0.03024997 ustep: 1 
iter: 2  value: 2257.76 mgc: 2.407605e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  1.264868 
iter: 1  value: 2257.754 mgc: 0.005610711 ustep: 1 
iter: 2  value: 2257.754 mgc: 5.749121e-07 ustep: 1 
iter: 3  mgc: 3.704675e-14 
outer mgc:  0.04595004 
iter: 1  value: 2257.768 mgc: 0.005606891 ustep: 1 
iter: 2  value: 2257.768 mgc: 5.745103e-07 ustep: 1 
iter: 3  mgc: 4.507505e-14 
outer mgc:  0.04850702 
iter: 1  value: 2257.773 mgc: 0.01349211 ustep: 1 
iter: 2  value: 2257.773 mgc: 5.087965e-06 ustep: 1 
iter: 3  mgc: 7.247536e-13 
outer mgc:  0.2806776 
iter: 1  value: 2257.75 mgc: 0.01352156 ustep: 1 
iter: 2  value: 2257.75 mgc: 5.101555e-06 ustep: 1 
iter: 3  mgc: 7.238654e-13 
outer mgc:  0.2728984 
iter: 1  value: 2257.77 mgc: 0.01089975 ustep: 1 
iter: 2  value: 2257.77 mgc: 7.556497e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.2919472 
iter: 1  value: 2257.753 mgc: 0.01092438 ustep: 1 
iter: 2  value: 2257.753 mgc: 7.589863e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.2998701 
[Sat Aug 14 12:17:40 2021]
Finished job 0.
1 of 1 steps (100%) done

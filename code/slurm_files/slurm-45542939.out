Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 03:28:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_80_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21737.142744 
final  value 20995.119547 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 21097.87 mgc: 3.866633 ustep: 0.6827823 
iter: 2  value: 21093.87 mgc: 0.9051233 ustep: 0.8263238 
iter: 3  value: 21093.81 mgc: 0.120833 ustep: 0.9090326 
iter: 4  value: 21093.81 mgc: 0.006121494 ustep: 0.9534367 
iter: 5  value: 21093.81 mgc: 0.0002292116 ustep: 0.9764432 
iter: 6  value: 21093.81 mgc: 4.268623e-06 ustep: 0.9881526 
iter: 7  value: 21093.81 mgc: 3.980797e-08 ustep: 0.9940592 
iter: 8  mgc: 1.858407e-10 
iter: 1  mgc: 1.858407e-10 
Matching hessian patterns... Done
outer mgc:  173.2895 
iter: 1  value: 20852.31 mgc: 0.9047794 ustep: 1 
iter: 2  value: 20852.29 mgc: 0.08125454 ustep: 1 
iter: 3  value: 20852.29 mgc: 0.0003268143 ustep: 1 
iter: 4  value: 20852.29 mgc: 1.958545e-08 ustep: 1 
iter: 5  mgc: 3.524958e-15 
iter: 1  value: 20380.75 mgc: 14.49505 ustep: 1 
iter: 2  value: 20376.11 mgc: 2.73489 ustep: 1 
iter: 3  value: 20376.11 mgc: 0.04514484 ustep: 1 
iter: 4  value: 20376.11 mgc: 1.37671e-05 ustep: 1 
iter: 5  mgc: 1.777245e-12 
iter: 1  mgc: 1.777245e-12 
outer mgc:  144.4351 
iter: 1  value: 24729.26 mgc: 38.64906 ustep: 0.2494656 
iter: 2  value: 23889.16 mgc: 36.53877 ustep: 0.2925213 
iter: 3  value: 23201.94 mgc: 22.77671 ustep: 0.09269589 
iter: 4  value: 23068.02 mgc: 15.72186 ustep: 0.08677431 
iter: 5  value: 22963.87 mgc: 12.21811 ustep: 0.2946453 
iter: 6  value: 22962.64 mgc: 5.482318 ustep: 0.5428582 
iter: 7  value: 22962.64 mgc: 0.2278884 ustep: 0.7368154 
iter: 8  value: 22962.64 mgc: 0.00436139 ustep: 0.8583937 
iter: 9  value: 22962.64 mgc: 4.547622e-05 ustep: 0.9265027 
iter: 10  value: 22962.64 mgc: 2.51312e-07 ustep: 0.9625539 
iter: 11  mgc: 7.107808e-10 
iter: 1  value: 20363.24 mgc: 8.552016 ustep: 1 
iter: 2  value: 20362.71 mgc: 0.6617972 ustep: 1 
iter: 3  value: 20362.71 mgc: 0.003891825 ustep: 1 
iter: 4  value: 20362.71 mgc: 1.285084e-07 ustep: 1 
iter: 5  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  186.715 
iter: 1  value: 20421.41 mgc: 13.36868 ustep: 1 
iter: 2  value: 20420.99 mgc: 0.5538128 ustep: 1 
iter: 3  value: 20420.99 mgc: 0.003770672 ustep: 1 
iter: 4  value: 20420.99 mgc: 3.915461e-07 ustep: 1 
iter: 5  mgc: 5.662137e-14 
iter: 1  value: 20336.31 mgc: 5.244342 ustep: 1 
iter: 2  value: 20336.3 mgc: 0.08860828 ustep: 1 
iter: 3  value: 20336.3 mgc: 9.796587e-05 ustep: 1 
iter: 4  mgc: 1.168727e-10 
iter: 1  mgc: 1.168727e-10 
outer mgc:  25.651 
iter: 1  value: 20325.53 mgc: 1.885689 ustep: 1 
iter: 2  value: 20325.53 mgc: 0.02534333 ustep: 1 
iter: 3  value: 20325.53 mgc: 4.92515e-06 ustep: 1 
iter: 4  mgc: 2.158274e-13 
iter: 1  mgc: 2.158274e-13 
outer mgc:  21.05257 
iter: 1  value: 20318.89 mgc: 2.161743 ustep: 1 
iter: 2  value: 20318.89 mgc: 0.02203454 ustep: 1 
iter: 3  value: 20318.89 mgc: 2.888494e-06 ustep: 1 
iter: 4  mgc: 6.261658e-14 
iter: 1  mgc: 6.261658e-14 
outer mgc:  40.9777 
iter: 1  value: 20310.33 mgc: 3.538794 ustep: 1 
iter: 2  value: 20310.33 mgc: 0.03402912 ustep: 1 
iter: 3  value: 20310.33 mgc: 5.256385e-06 ustep: 1 
iter: 4  mgc: 1.860734e-13 
iter: 1  mgc: 1.860734e-13 
outer mgc:  61.53241 
iter: 1  value: 20306.17 mgc: 2.330251 ustep: 1 
iter: 2  value: 20306.17 mgc: 0.01849643 ustep: 1 
iter: 3  value: 20306.17 mgc: 1.827294e-06 ustep: 1 
iter: 4  mgc: 8.748557e-14 
iter: 1  mgc: 8.748557e-14 
outer mgc:  9.481518 
iter: 1  value: 20305.59 mgc: 1.762626 ustep: 1 
iter: 2  value: 20305.59 mgc: 0.01597341 ustep: 1 
iter: 3  value: 20305.59 mgc: 1.60973e-06 ustep: 1 
iter: 4  mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  8.58065 
iter: 1  value: 20303.23 mgc: 1.803283 ustep: 1 
iter: 2  value: 20303.23 mgc: 0.01094679 ustep: 1 
iter: 3  value: 20303.23 mgc: 5.591164e-07 ustep: 1 
iter: 4  mgc: 8.615331e-14 
iter: 1  mgc: 8.615331e-14 
outer mgc:  7.252271 
iter: 1  value: 20301.83 mgc: 1.594107 ustep: 1 
iter: 2  value: 20301.83 mgc: 0.00817229 ustep: 1 
iter: 3  value: 20301.83 mgc: 3.0491e-07 ustep: 1 
iter: 4  mgc: 6.550316e-14 
iter: 1  mgc: 6.550316e-14 
outer mgc:  21.78865 
iter: 1  value: 20300.09 mgc: 1.061204 ustep: 1 
iter: 2  value: 20300.09 mgc: 0.001990749 ustep: 1 
iter: 3  value: 20300.09 mgc: 3.049286e-08 ustep: 1 
mgc: 5.373479e-14 
iter: 1  mgc: 5.373479e-14 
outer mgc:  13.04689 
iter: 1  value: 20298.36 mgc: 0.7309438 ustep: 1 
iter: 2  value: 20298.36 mgc: 0.001678387 ustep: 1 
iter: 3  value: 20298.36 mgc: 1.362216e-08 ustep: 1 
mgc: 6.972201e-14 
iter: 1  mgc: 6.972201e-14 
outer mgc:  5.465911 
iter: 1  value: 20296.15 mgc: 0.9523649 ustep: 1 
iter: 2  value: 20296.15 mgc: 0.00505258 ustep: 1 
iter: 3  value: 20296.15 mgc: 7.782087e-08 ustep: 1 
iter: 4  mgc: 7.371881e-14 
iter: 1  mgc: 7.371881e-14 
outer mgc:  14.145 
iter: 1  value: 20293.57 mgc: 1.096812 ustep: 1 
iter: 2  value: 20293.57 mgc: 0.00510684 ustep: 1 
iter: 3  value: 20293.57 mgc: 9.731907e-08 ustep: 1 
iter: 4  mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  3.954122 
iter: 1  value: 20292.91 mgc: 0.980017 ustep: 1 
iter: 2  value: 20292.91 mgc: 0.001650328 ustep: 1 
iter: 3  value: 20292.91 mgc: 1.888453e-08 ustep: 1 
mgc: 7.813195e-14 
iter: 1  value: 20293.51 mgc: 0.7584513 ustep: 1 
iter: 2  value: 20293.51 mgc: 0.001086843 ustep: 1 
iter: 3  mgc: 4.826948e-09 
iter: 1  value: 20293.54 mgc: 0.3223511 ustep: 1 
iter: 2  value: 20293.54 mgc: 0.0001843929 ustep: 1 
iter: 3  mgc: 1.544807e-10 
iter: 1  mgc: 1.544807e-10 
outer mgc:  7.29823 
iter: 1  value: 20293.47 mgc: 0.2161743 ustep: 1 
iter: 2  value: 20293.47 mgc: 9.868548e-05 ustep: 1 
iter: 3  mgc: 4.367884e-11 
iter: 1  mgc: 4.367884e-11 
outer mgc:  3.658281 
iter: 1  value: 20293.34 mgc: 0.1207241 ustep: 1 
iter: 2  value: 20293.34 mgc: 2.607748e-05 ustep: 1 
iter: 3  mgc: 4.432121e-12 
iter: 1  mgc: 4.432121e-12 
outer mgc:  3.628315 
iter: 1  value: 20293.09 mgc: 0.1460368 ustep: 1 
iter: 2  value: 20293.09 mgc: 5.8447e-05 ustep: 1 
iter: 3  mgc: 9.48841e-12 
iter: 1  value: 20292.64 mgc: 0.08729935 ustep: 1 
iter: 2  value: 20292.64 mgc: 6.703485e-05 ustep: 1 
iter: 3  mgc: 9.182921e-11 
iter: 1  value: 20291.09 mgc: 0.3267506 ustep: 1 
iter: 2  value: 20291.09 mgc: 0.0009184565 ustep: 1 
iter: 3  value: 20291.09 mgc: 1.88676e-08 ustep: 1 
mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  5.501098 
iter: 1  value: 20288.53 mgc: 1.790486 ustep: 1 
iter: 2  value: 20288.53 mgc: 0.005944845 ustep: 1 
iter: 3  value: 20288.53 mgc: 8.959511e-07 ustep: 1 
iter: 4  mgc: 7.860379e-14 
iter: 1  mgc: 7.860379e-14 
outer mgc:  6.865697 
iter: 1  value: 20280.95 mgc: 2.015172 ustep: 1 
iter: 2  value: 20280.95 mgc: 0.01291796 ustep: 1 
iter: 3  value: 20280.95 mgc: 4.203942e-06 ustep: 1 
iter: 4  mgc: 5.395684e-13 
iter: 1  mgc: 5.395684e-13 
outer mgc:  8.49307 
iter: 1  value: 20288.59 mgc: 3.715463 ustep: 1 
iter: 2  value: 20288.59 mgc: 0.03236196 ustep: 1 
iter: 3  value: 20288.59 mgc: 9.077172e-06 ustep: 1 
iter: 4  mgc: 3.056222e-12 
iter: 1  value: 20281.77 mgc: 2.384678 ustep: 1 
iter: 2  value: 20281.77 mgc: 0.006646248 ustep: 1 
iter: 3  value: 20281.77 mgc: 1.871203e-07 ustep: 1 
iter: 4  mgc: 6.039613e-14 
iter: 1  value: 20281.04 mgc: 0.7272444 ustep: 1 
iter: 2  value: 20281.04 mgc: 0.0006083283 ustep: 1 
iter: 3  mgc: 1.61346e-09 
iter: 1  mgc: 1.61346e-09 
outer mgc:  6.178788 
iter: 1  value: 20281.55 mgc: 0.3666925 ustep: 1 
iter: 2  value: 20281.55 mgc: 0.000236249 ustep: 1 
iter: 3  mgc: 1.486682e-10 
iter: 1  mgc: 1.486682e-10 
outer mgc:  6.94395 
iter: 1  value: 20281.99 mgc: 0.2759739 ustep: 1 
iter: 2  value: 20281.99 mgc: 0.0002032834 ustep: 1 
iter: 3  mgc: 1.155858e-10 
iter: 1  mgc: 1.155858e-10 
outer mgc:  3.735857 
iter: 1  value: 20281.92 mgc: 0.2144254 ustep: 1 
iter: 2  value: 20281.92 mgc: 5.31343e-05 ustep: 1 
iter: 3  mgc: 7.339729e-11 
iter: 1  mgc: 7.339729e-11 
outer mgc:  3.488906 
iter: 1  value: 20281.43 mgc: 0.1771976 ustep: 1 
iter: 2  value: 20281.43 mgc: 3.902161e-05 ustep: 1 
iter: 3  mgc: 6.613043e-11 
iter: 1  value: 20280.39 mgc: 0.3398675 ustep: 1 
iter: 2  value: 20280.39 mgc: 0.0001966107 ustep: 1 
iter: 3  mgc: 1.783449e-10 
iter: 1  value: 20276.97 mgc: 1.122541 ustep: 1 
iter: 2  value: 20276.97 mgc: 0.002038776 ustep: 1 
iter: 3  value: 20276.97 mgc: 3.912282e-08 ustep: 1 
iter: 4  mgc: 7.294165e-14 
iter: 1  mgc: 7.294165e-14 
outer mgc:  6.88184 
iter: 1  value: 20275.71 mgc: 1.561608 ustep: 1 
iter: 2  value: 20275.71 mgc: 0.004179088 ustep: 1 
iter: 3  value: 20275.71 mgc: 2.883559e-08 ustep: 1 
mgc: 6.927792e-14 
iter: 1  mgc: 6.927792e-14 
outer mgc:  6.039213 
iter: 1  value: 20270.72 mgc: 4.376207 ustep: 1 
iter: 2  value: 20270.72 mgc: 0.04767659 ustep: 1 
iter: 3  value: 20270.72 mgc: 8.753568e-06 ustep: 1 
iter: 4  mgc: 9.894308e-13 
iter: 1  value: 20274.28 mgc: 0.8618126 ustep: 1 
iter: 2  value: 20274.28 mgc: 0.001687951 ustep: 1 
iter: 3  mgc: 8.61073e-09 
iter: 1  mgc: 8.61073e-09 
outer mgc:  3.043434 
iter: 1  value: 20271.73 mgc: 0.9437928 ustep: 1 
iter: 2  value: 20271.73 mgc: 0.001432433 ustep: 1 
iter: 3  mgc: 4.337906e-09 
iter: 1  mgc: 4.337906e-09 
outer mgc:  7.992983 
iter: 1  value: 20270.79 mgc: 0.5632624 ustep: 1 
iter: 2  value: 20270.79 mgc: 0.0004043984 ustep: 1 
iter: 3  mgc: 6.44901e-10 
iter: 1  value: 20269.48 mgc: 0.8780052 ustep: 1 
iter: 2  value: 20269.48 mgc: 0.0006865112 ustep: 1 
iter: 3  mgc: 1.212285e-09 
iter: 1  mgc: 1.212285e-09 
outer mgc:  11.18441 
iter: 1  value: 20265.29 mgc: 1.167279 ustep: 1 
iter: 2  value: 20265.29 mgc: 0.001136124 ustep: 1 
iter: 3  mgc: 7.100341e-09 
iter: 1  mgc: 7.100341e-09 
outer mgc:  9.626317 
iter: 1  value: 20261.36 mgc: 0.8009826 ustep: 1 
iter: 2  value: 20261.36 mgc: 0.0006037736 ustep: 1 
iter: 3  mgc: 1.058498e-09 
iter: 1  value: 20257.5 mgc: 0.8905337 ustep: 1 
iter: 2  value: 20257.5 mgc: 0.0005884253 ustep: 1 
iter: 3  mgc: 1.271048e-09 
iter: 1  mgc: 1.271048e-09 
outer mgc:  3.60211 
iter: 1  value: 20249.95 mgc: 1.866604 ustep: 1 
iter: 2  value: 20249.95 mgc: 0.002013283 ustep: 1 
iter: 3  value: 20249.95 mgc: 1.109975e-08 ustep: 1 
mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  0.9382368 
iter: 1  value: 20244 mgc: 1.361224 ustep: 1 
iter: 2  value: 20244 mgc: 0.0007571265 ustep: 1 
iter: 3  mgc: 1.980108e-09 
iter: 1  mgc: 1.980108e-09 
outer mgc:  1.296981 
iter: 1  value: 20238.89 mgc: 1.207754 ustep: 1 
iter: 2  value: 20238.89 mgc: 0.0005531015 ustep: 1 
iter: 3  mgc: 6.35735e-10 
iter: 1  mgc: 6.35735e-10 
outer mgc:  0.9578205 
iter: 1  value: 20236.79 mgc: 0.4845914 ustep: 1 
iter: 2  value: 20236.79 mgc: 7.647031e-05 ustep: 1 
iter: 3  mgc: 1.628653e-11 
iter: 1  mgc: 1.628653e-11 
outer mgc:  0.1883508 
iter: 1  value: 20235.42 mgc: 0.2866861 ustep: 1 
iter: 2  value: 20235.42 mgc: 2.488625e-05 ustep: 1 
iter: 3  mgc: 1.771028e-12 
iter: 1  mgc: 1.771028e-12 
outer mgc:  0.04498389 
iter: 1  value: 20234.91 mgc: 0.1084166 ustep: 1 
iter: 2  value: 20234.91 mgc: 3.696062e-06 ustep: 1 
iter: 3  mgc: 7.371881e-14 
iter: 1  mgc: 7.371881e-14 
outer mgc:  0.01302553 
iter: 1  value: 20234.83 mgc: 0.01619981 ustep: 1 
iter: 2  value: 20234.83 mgc: 6.845102e-08 ustep: 1 
mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  0.001595519 
iter: 1  mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  0.001595519 
iter: 1  value: 20234.83 mgc: 0.02020907 ustep: 1 
iter: 2  value: 20234.83 mgc: 5.445405e-07 ustep: 1 
iter: 3  mgc: 8.523737e-14 
outer mgc:  1.370465 
iter: 1  value: 20234.83 mgc: 0.02019879 ustep: 1 
iter: 2  value: 20234.83 mgc: 5.437137e-07 ustep: 1 
iter: 3  mgc: 7.299716e-14 
outer mgc:  1.369969 
iter: 1  value: 20234.83 mgc: 0.01046876 ustep: 1 
iter: 2  value: 20234.83 mgc: 1.702724e-07 ustep: 1 
iter: 3  mgc: 6.905587e-14 
outer mgc:  0.7570761 
iter: 1  value: 20234.83 mgc: 0.01046326 ustep: 1 
iter: 2  value: 20234.83 mgc: 1.700688e-07 ustep: 1 
iter: 3  mgc: 6.306067e-14 
outer mgc:  0.7598079 
iter: 1  value: 20234.83 mgc: 0.02406312 ustep: 1 
iter: 2  value: 20234.83 mgc: 1.243341e-06 ustep: 1 
iter: 3  mgc: 1.083578e-13 
outer mgc:  1.34606 
iter: 1  value: 20234.83 mgc: 0.02406196 ustep: 1 
iter: 2  value: 20234.83 mgc: 1.237957e-06 ustep: 1 
iter: 3  mgc: 8.615331e-14 
outer mgc:  1.346992 
iter: 1  value: 20234.83 mgc: 0.01237735 ustep: 1 
iter: 2  value: 20234.83 mgc: 4.060616e-07 ustep: 1 
iter: 3  mgc: 6.794565e-14 
outer mgc:  0.8810723 
iter: 1  value: 20234.83 mgc: 0.01237698 ustep: 1 
iter: 2  value: 20234.83 mgc: 4.052367e-07 ustep: 1 
iter: 3  mgc: 6.261658e-14 
outer mgc:  0.8786732 
iter: 1  value: 20234.9 mgc: 0.1484771 ustep: 1 
iter: 2  value: 20234.9 mgc: 5.535881e-06 ustep: 1 
iter: 3  mgc: 8.082424e-14 
outer mgc:  0.3064729 
iter: 1  value: 20234.76 mgc: 0.1489116 ustep: 1 
iter: 2  value: 20234.76 mgc: 5.536932e-06 ustep: 1 
iter: 3  mgc: 6.483702e-14 
outer mgc:  0.3054791 
iter: 1  value: 20234.87 mgc: 0.1370142 ustep: 1 
iter: 2  value: 20234.87 mgc: 3.800358e-06 ustep: 1 
iter: 3  mgc: 6.661338e-14 
outer mgc:  0.3579922 
iter: 1  value: 20234.79 mgc: 0.1371513 ustep: 1 
iter: 2  value: 20234.79 mgc: 3.797411e-06 ustep: 1 
iter: 3  mgc: 6.217249e-14 
outer mgc:  0.3594129 
iter: 1  value: 20234.82 mgc: 0.002905187 ustep: 1 
iter: 2  mgc: 2.444246e-09 
outer mgc:  0.001718287 
iter: 1  value: 20234.85 mgc: 0.002904685 ustep: 1 
iter: 2  mgc: 2.446344e-09 
outer mgc:  0.001472676 
iter: 1  value: 20234.81 mgc: 0.005553276 ustep: 1 
iter: 2  value: 20234.81 mgc: 7.502647e-08 ustep: 1 
iter: 3  mgc: 6.484396e-14 
outer mgc:  0.04377575 
iter: 1  value: 20234.85 mgc: 0.005552784 ustep: 1 
iter: 2  value: 20234.85 mgc: 7.508001e-08 ustep: 1 
iter: 3  mgc: 7.893686e-14 
outer mgc:  0.04219403 
[Sat Aug 14 03:28:52 2021]
Finished job 0.
1 of 1 steps (100%) done

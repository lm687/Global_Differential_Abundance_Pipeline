Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:10:15 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_0_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4397.744992 
final  value 4346.672429 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 320.6545 mgc: 58.57211 ustep: 1 
iter: 2  value: 290.1868 mgc: 24.87526 ustep: 1 
iter: 3  value: 289.7444 mgc: 5.757723 ustep: 1 
iter: 4  value: 289.7442 mgc: 0.1171149 ustep: 1 
iter: 5  value: 289.7442 mgc: 5.481934e-05 ustep: 1 
iter: 6  mgc: 1.172196e-11 
iter: 1  mgc: 1.172196e-11 
Matching hessian patterns... Done
outer mgc:  29.22734 
iter: 1  value: 332.4027 mgc: 26.30081 ustep: 1 
iter: 2  value: 330.7917 mgc: 3.511327 ustep: 1 
iter: 3  value: 330.7914 mgc: 0.06317295 ustep: 1 
iter: 4  value: 330.7914 mgc: 4.291444e-05 ustep: 1 
iter: 5  mgc: 1.989731e-11 
iter: 1  value: 284.3558 mgc: 7.357919 ustep: 1 
iter: 2  value: 284.3491 mgc: 0.2090357 ustep: 1 
iter: 3  value: 284.3491 mgc: 0.0003164818 ustep: 1 
iter: 4  mgc: 1.140724e-09 
iter: 1  mgc: 1.140724e-09 
outer mgc:  25.15172 
iter: 1  value: 279.8336 mgc: 4.830327 ustep: 1 
iter: 2  value: 279.8333 mgc: 0.04037601 ustep: 1 
iter: 3  value: 279.8333 mgc: 1.125439e-05 ustep: 1 
iter: 4  mgc: 1.60455e-12 
iter: 1  mgc: 1.60455e-12 
outer mgc:  23.39322 
iter: 1  value: 266.9194 mgc: 11.48282 ustep: 1 
iter: 2  value: 266.8901 mgc: 0.4020777 ustep: 1 
iter: 3  value: 266.8901 mgc: 0.001322406 ustep: 1 
iter: 4  value: 266.8901 mgc: 1.564947e-08 ustep: 1 
mgc: 1.596639e-14 
iter: 1  mgc: 1.596639e-14 
outer mgc:  18.07802 
iter: 1  value: 247.4436 mgc: 17.71096 ustep: 1 
iter: 2  value: 247.416 mgc: 0.5179584 ustep: 1 
iter: 3  value: 247.416 mgc: 0.001193872 ustep: 1 
iter: 4  value: 247.416 mgc: 4.369163e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  26.88629 
iter: 1  value: 243.0231 mgc: 31.42707 ustep: 1 
iter: 2  value: 242.9998 mgc: 0.5992118 ustep: 1 
iter: 3  value: 242.9998 mgc: 0.006922046 ustep: 1 
iter: 4  value: 242.9998 mgc: 2.280889e-07 ustep: 1 
iter: 5  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  31.08553 
iter: 1  value: 236.255 mgc: 17.89165 ustep: 1 
iter: 2  value: 236.2433 mgc: 0.3854706 ustep: 1 
iter: 3  value: 236.2433 mgc: 0.0004693617 ustep: 1 
iter: 4  mgc: 1.681139e-09 
iter: 1  mgc: 1.681139e-09 
outer mgc:  30.26197 
iter: 1  value: 256.7838 mgc: 20.14649 ustep: 1 
iter: 2  value: 256.7103 mgc: 0.5515501 ustep: 1 
iter: 3  value: 256.7103 mgc: 0.002434431 ustep: 1 
iter: 4  value: 256.7103 mgc: 4.307176e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  value: 234.2274 mgc: 4.560668 ustep: 1 
iter: 2  value: 234.2274 mgc: 0.02340932 ustep: 1 
iter: 3  value: 234.2274 mgc: 3.607815e-06 ustep: 1 
iter: 4  mgc: 8.304468e-14 
iter: 1  mgc: 8.304468e-14 
outer mgc:  14.97785 
iter: 1  value: 234.5339 mgc: 6.544662 ustep: 1 
iter: 2  value: 234.5327 mgc: 0.07277109 ustep: 1 
iter: 3  value: 234.5327 mgc: 3.230898e-05 ustep: 1 
iter: 4  mgc: 1.984191e-12 
iter: 1  value: 233.6203 mgc: 2.840506 ustep: 1 
iter: 2  value: 233.6203 mgc: 0.01369102 ustep: 1 
iter: 3  value: 233.6203 mgc: 1.098053e-06 ustep: 1 
iter: 4  mgc: 2.153833e-14 
iter: 1  mgc: 2.153833e-14 
outer mgc:  5.716574 
iter: 1  value: 233.5283 mgc: 1.768748 ustep: 1 
iter: 2  value: 233.5283 mgc: 0.002275454 ustep: 1 
iter: 3  value: 233.5283 mgc: 2.592545e-08 ustep: 1 
mgc: 3.042011e-14 
iter: 1  mgc: 3.042011e-14 
outer mgc:  7.760576 
iter: 1  value: 233.234 mgc: 2.170101 ustep: 1 
iter: 2  value: 233.2339 mgc: 0.01168541 ustep: 1 
iter: 3  value: 233.2339 mgc: 6.22886e-07 ustep: 1 
iter: 4  mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  4.293716 
iter: 1  value: 233.0956 mgc: 1.496352 ustep: 1 
iter: 2  value: 233.0956 mgc: 0.00285849 ustep: 1 
iter: 3  value: 233.0956 mgc: 4.241955e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  2.16452 
iter: 1  value: 232.9252 mgc: 1.205463 ustep: 1 
iter: 2  value: 232.9252 mgc: 0.001384096 ustep: 1 
iter: 3  mgc: 8.932315e-09 
iter: 1  mgc: 8.932315e-09 
outer mgc:  1.966398 
iter: 1  value: 232.8046 mgc: 0.9551577 ustep: 1 
iter: 2  value: 232.8046 mgc: 0.0003561454 ustep: 1 
iter: 3  mgc: 7.434764e-10 
iter: 1  mgc: 7.434764e-10 
outer mgc:  1.719811 
iter: 1  value: 232.7079 mgc: 0.8129606 ustep: 1 
iter: 2  value: 232.7079 mgc: 0.001166104 ustep: 1 
iter: 3  value: 232.7079 mgc: 1.00386e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  4.319921 
iter: 1  value: 232.6101 mgc: 1.101875 ustep: 1 
iter: 2  value: 232.6101 mgc: 0.004184026 ustep: 1 
iter: 3  value: 232.6101 mgc: 7.923396e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  3.288839 
iter: 1  value: 232.4278 mgc: 1.16465 ustep: 1 
iter: 2  value: 232.4278 mgc: 0.002897981 ustep: 1 
iter: 3  value: 232.4278 mgc: 3.112155e-08 ustep: 1 
mgc: 1.709743e-14 
iter: 1  mgc: 1.709743e-14 
outer mgc:  1.283268 
iter: 1  value: 232.3343 mgc: 1.739908 ustep: 1 
iter: 2  value: 232.3343 mgc: 0.001564241 ustep: 1 
iter: 3  value: 232.3343 mgc: 1.174836e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  value: 232.3599 mgc: 0.6764625 ustep: 1 
iter: 2  value: 232.3599 mgc: 0.0002421888 ustep: 1 
iter: 3  mgc: 2.876517e-10 
iter: 1  mgc: 2.876517e-10 
outer mgc:  1.248431 
iter: 1  value: 232.3063 mgc: 0.8172576 ustep: 1 
iter: 2  value: 232.3063 mgc: 0.000798943 ustep: 1 
iter: 3  mgc: 2.825555e-09 
iter: 1  mgc: 2.825555e-09 
outer mgc:  2.769366 
iter: 1  value: 232.2619 mgc: 0.6483374 ustep: 1 
iter: 2  value: 232.2619 mgc: 0.0006287112 ustep: 1 
iter: 3  mgc: 1.874327e-09 
iter: 1  mgc: 1.874327e-09 
outer mgc:  1.578289 
iter: 1  value: 232.209 mgc: 0.3287105 ustep: 1 
iter: 2  value: 232.209 mgc: 0.0001080095 ustep: 1 
iter: 3  mgc: 2.377165e-11 
iter: 1  mgc: 2.377165e-11 
outer mgc:  1.13614 
iter: 1  value: 232.1597 mgc: 0.3043653 ustep: 1 
iter: 2  value: 232.1597 mgc: 0.000128467 ustep: 1 
iter: 3  mgc: 8.116796e-11 
iter: 1  value: 232.0854 mgc: 0.1491536 ustep: 1 
iter: 2  value: 232.0854 mgc: 0.0001079695 ustep: 1 
iter: 3  mgc: 1.57355e-10 
iter: 1  value: 231.7694 mgc: 0.5762697 ustep: 1 
iter: 2  value: 231.7694 mgc: 0.002100037 ustep: 1 
iter: 3  value: 231.7694 mgc: 7.309041e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  value: 231.3732 mgc: 0.9842612 ustep: 1 
iter: 2  value: 231.3732 mgc: 0.004189001 ustep: 1 
iter: 3  value: 231.3732 mgc: 4.036483e-07 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  1.595867 
iter: 1  value: 230.2773 mgc: 6.41557 ustep: 1 
iter: 2  value: 230.2747 mgc: 0.1339787 ustep: 1 
iter: 3  value: 230.2747 mgc: 8.611061e-05 ustep: 1 
iter: 4  mgc: 1.359695e-10 
iter: 1  value: 230.8279 mgc: 2.281046 ustep: 1 
iter: 2  value: 230.8278 mgc: 0.01771545 ustep: 1 
iter: 3  value: 230.8278 mgc: 1.317756e-06 ustep: 1 
iter: 4  mgc: 5.151435e-14 
iter: 1  mgc: 5.151435e-14 
outer mgc:  1.474776 
iter: 1  value: 230.1303 mgc: 3.081227 ustep: 1 
iter: 2  value: 230.1303 mgc: 0.008280403 ustep: 1 
iter: 3  value: 230.1303 mgc: 1.131684e-06 ustep: 1 
iter: 4  mgc: 2.620126e-14 
iter: 1  value: 230.6407 mgc: 1.007708 ustep: 1 
iter: 2  value: 230.6407 mgc: 0.0003764094 ustep: 1 
iter: 3  mgc: 1.396844e-09 
iter: 1  mgc: 1.396844e-09 
outer mgc:  0.6928279 
iter: 1  value: 230.5737 mgc: 0.198632 ustep: 1 
iter: 2  value: 230.5737 mgc: 0.0001231125 ustep: 1 
iter: 3  mgc: 1.159135e-10 
iter: 1  value: 230.4468 mgc: 0.3793853 ustep: 1 
iter: 2  value: 230.4468 mgc: 0.0005191914 ustep: 1 
iter: 3  mgc: 2.027662e-09 
iter: 1  mgc: 2.027662e-09 
outer mgc:  0.5978037 
iter: 1  value: 230.387 mgc: 0.60094 ustep: 1 
iter: 2  value: 230.387 mgc: 0.0006158411 ustep: 1 
iter: 3  mgc: 1.108546e-09 
iter: 1  value: 230.4232 mgc: 0.4514406 ustep: 1 
iter: 2  value: 230.4232 mgc: 0.0003345583 ustep: 1 
iter: 3  mgc: 3.83775e-10 
iter: 1  value: 230.4418 mgc: 0.4272859 ustep: 1 
iter: 2  value: 230.4418 mgc: 0.0003111833 ustep: 1 
iter: 3  mgc: 3.539404e-10 
iter: 1  value: 230.4475 mgc: 0.282629 ustep: 1 
iter: 2  value: 230.4475 mgc: 0.0001312411 ustep: 1 
iter: 3  mgc: 6.664358e-11 
iter: 1  value: 230.4455 mgc: 0.1049188 ustep: 1 
iter: 2  value: 230.4455 mgc: 1.810932e-05 ustep: 1 
iter: 3  mgc: 1.271871e-12 
iter: 1  mgc: 1.271871e-12 
outer mgc:  0.5624343 
iter: 1  value: 230.4498 mgc: 0.08100859 ustep: 1 
iter: 2  value: 230.4498 mgc: 5.964354e-06 ustep: 1 
iter: 3  mgc: 6.261658e-14 
iter: 1  mgc: 6.261658e-14 
outer mgc:  0.3819923 
iter: 1  value: 230.4483 mgc: 0.07194496 ustep: 1 
iter: 2  value: 230.4483 mgc: 8.699413e-06 ustep: 1 
iter: 3  mgc: 2.717826e-13 
iter: 1  mgc: 2.717826e-13 
outer mgc:  0.2244928 
iter: 1  value: 230.4477 mgc: 0.05660355 ustep: 1 
iter: 2  value: 230.4477 mgc: 3.907317e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  value: 230.4438 mgc: 0.02327947 ustep: 1 
iter: 2  value: 230.4438 mgc: 1.241166e-06 ustep: 1 
iter: 3  mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  0.1460805 
iter: 1  value: 230.415 mgc: 0.06660639 ustep: 1 
iter: 2  value: 230.415 mgc: 5.023144e-06 ustep: 1 
iter: 3  mgc: 1.065814e-13 
iter: 1  value: 230.3526 mgc: 0.14677 ustep: 1 
iter: 2  value: 230.3526 mgc: 2.409036e-05 ustep: 1 
iter: 3  mgc: 2.059686e-12 
iter: 1  mgc: 2.059686e-12 
outer mgc:  0.1651879 
iter: 1  value: 230.3557 mgc: 0.07399892 ustep: 1 
iter: 2  value: 230.3557 mgc: 3.814344e-05 ustep: 1 
iter: 3  mgc: 7.460699e-12 
iter: 1  value: 230.3539 mgc: 0.03567888 ustep: 1 
iter: 2  value: 230.3539 mgc: 8.607315e-06 ustep: 1 
iter: 3  mgc: 3.748113e-13 
iter: 1  mgc: 3.748113e-13 
outer mgc:  0.04930128 
iter: 1  value: 230.3473 mgc: 0.01673217 ustep: 1 
iter: 2  value: 230.3473 mgc: 8.780021e-07 ustep: 1 
iter: 3  mgc: 1.953993e-14 
iter: 1  value: 230.3509 mgc: 0.007654691 ustep: 1 
iter: 2  value: 230.3509 mgc: 1.839715e-07 ustep: 1 
mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.02318319 
iter: 1  value: 230.3539 mgc: 0.00822787 ustep: 1 
iter: 2  value: 230.3539 mgc: 5.76398e-08 ustep: 1 
mgc: 1.576517e-14 
iter: 1  mgc: 1.576517e-14 
outer mgc:  0.007620117 
iter: 1  value: 230.3524 mgc: 0.004361995 ustep: 1 
iter: 2  mgc: 9.259457e-09 
iter: 1  mgc: 9.259457e-09 
outer mgc:  0.000997344 
iter: 1  value: 230.3525 mgc: 0.0003473493 ustep: 1 
iter: 2  mgc: 4.049028e-11 
iter: 1  mgc: 4.049028e-11 
outer mgc:  0.0002205874 
iter: 1  mgc: 4.049028e-11 
iter: 1  mgc: 4.049028e-11 
outer mgc:  0.0002205874 
iter: 1  value: 230.3538 mgc: 0.05520211 ustep: 1 
iter: 2  value: 230.3538 mgc: 2.8566e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.3686712 
iter: 1  value: 230.3516 mgc: 0.05519107 ustep: 1 
iter: 2  value: 230.3516 mgc: 2.86119e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.3691089 
iter: 1  value: 230.3532 mgc: 0.02848801 ustep: 1 
iter: 2  value: 230.3532 mgc: 6.615855e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.3255796 
iter: 1  value: 230.3522 mgc: 0.02848214 ustep: 1 
iter: 2  value: 230.3522 mgc: 6.623182e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.3259946 
iter: 1  value: 230.3519 mgc: 0.0479608 ustep: 1 
iter: 2  value: 230.3519 mgc: 5.223648e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
outer mgc:  0.2673154 
iter: 1  value: 230.3534 mgc: 0.04795963 ustep: 1 
iter: 2  value: 230.3534 mgc: 5.226057e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
outer mgc:  0.2668737 
iter: 1  value: 230.3522 mgc: 0.02611308 ustep: 1 
iter: 2  value: 230.3522 mgc: 1.340457e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.2470067 
iter: 1  value: 230.3531 mgc: 0.02610629 ustep: 1 
iter: 2  value: 230.3531 mgc: 1.339952e-06 ustep: 1 
iter: 3  mgc: 2.997602e-14 
outer mgc:  0.2465742 
iter: 1  value: 230.3498 mgc: 0.005447289 ustep: 1 
iter: 2  value: 230.3498 mgc: 3.681657e-08 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.002211687 
iter: 1  value: 230.3553 mgc: 0.005445477 ustep: 1 
iter: 2  value: 230.3553 mgc: 3.683282e-08 ustep: 1 
mgc: 3.730349e-14 
outer mgc:  0.002224125 
iter: 1  value: 230.3593 mgc: 0.03950115 ustep: 1 
iter: 2  value: 230.3593 mgc: 1.048055e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.1107906 
iter: 1  value: 230.3459 mgc: 0.0396033 ustep: 1 
iter: 2  value: 230.3459 mgc: 1.046955e-06 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.1108058 
iter: 1  value: 230.3564 mgc: 0.04077541 ustep: 1 
iter: 2  value: 230.3564 mgc: 2.296551e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.1204875 
iter: 1  value: 230.3487 mgc: 0.04088321 ustep: 1 
iter: 2  value: 230.3487 mgc: 2.303908e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
outer mgc:  0.1206595 
[Sun Aug 15 21:10:17 2021]
Finished job 0.
1 of 1 steps (100%) done

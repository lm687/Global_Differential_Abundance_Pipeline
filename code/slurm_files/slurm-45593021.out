Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:04:25 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21784.383072 
iter  10 value 18086.802769
iter  10 value 18086.802766
final  value 18086.802766 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8072.945 mgc: 82.65384 ustep: 1 
iter: 2  value: 7878.619 mgc: 19.01865 ustep: 1 
iter: 3  value: 7858.52 mgc: 6.273674 ustep: 1 
iter: 4  value: 7856.304 mgc: 1.857117 ustep: 1 
iter: 5  value: 7856.136 mgc: 0.5091726 ustep: 1 
iter: 6  value: 7856.132 mgc: 0.0780221 ustep: 1 
iter: 7  value: 7856.132 mgc: 0.002712446 ustep: 1 
iter: 8  value: 7856.132 mgc: 3.570662e-06 ustep: 1 
iter: 9  mgc: 6.199374e-12 
iter: 1  mgc: 6.199374e-12 
Matching hessian patterns... Done
outer mgc:  2616.871 
iter: 1  value: 5536.153 mgc: 31.84796 ustep: 1 
iter: 2  value: 5535.185 mgc: 3.747835 ustep: 1 
iter: 3  value: 5535.185 mgc: 0.03620516 ustep: 1 
iter: 4  value: 5535.185 mgc: 2.417861e-06 ustep: 1 
iter: 5  mgc: 2.232659e-13 
iter: 1  value: 4723.817 mgc: 64.67434 ustep: 1 
iter: 2  value: 4680.152 mgc: 16.2599 ustep: 1 
iter: 3  value: 4680.093 mgc: 0.4405862 ustep: 1 
iter: 4  value: 4680.093 mgc: 0.003242577 ustep: 1 
iter: 5  value: 4680.093 mgc: 2.392646e-07 ustep: 1 
iter: 6  mgc: 4.163336e-14 
iter: 1  mgc: 4.163336e-14 
outer mgc:  1839.822 
iter: 1  value: 3442.769 mgc: 68.95165 ustep: 1 
iter: 2  value: 3007.703 mgc: 40.46705 ustep: 1 
iter: 3  value: 3005.991 mgc: 5.269019 ustep: 1 
iter: 4  value: 3005.989 mgc: 0.2133753 ustep: 1 
iter: 5  value: 3005.989 mgc: 0.0004174773 ustep: 1 
iter: 6  mgc: 1.622558e-09 
iter: 1  mgc: 1.622558e-09 
outer mgc:  1210.16 
iter: 1  value: 2890.266 mgc: 71.03918 ustep: 1 
iter: 2  value: 2805.381 mgc: 18.77583 ustep: 1 
iter: 3  value: 2805.238 mgc: 0.9082325 ustep: 1 
iter: 4  value: 2805.238 mgc: 0.006017142 ustep: 1 
iter: 5  value: 2805.238 mgc: 5.87319e-07 ustep: 1 
iter: 6  mgc: 5.140333e-14 
iter: 1  mgc: 5.140333e-14 
outer mgc:  1049.617 
iter: 1  value: 7417.008 mgc: 83.43372 ustep: 0.2494656 
iter: 2  value: 2316.041 mgc: 126.8203 ustep: 0.4995153 
iter: 3  value: 2117.378 mgc: 29.32596 ustep: 0.7067933 
iter: 4  value: 2116.192 mgc: 5.188574 ustep: 0.8407259 
iter: 5  value: 2116.191 mgc: 0.1567168 ustep: 0.9169194 
iter: 6  value: 2116.191 mgc: 0.001112328 ustep: 0.9575633 
iter: 7  value: 2116.191 mgc: 3.363824e-05 ustep: 0.9785538 
iter: 8  value: 2116.191 mgc: 6.320625e-07 ustep: 0.9892199 
iter: 9  mgc: 5.995474e-09 
iter: 1  mgc: 5.995474e-09 
outer mgc:  197.2663 
iter: 1  value: 2104.705 mgc: 17.24579 ustep: 1 
iter: 2  value: 2097.66 mgc: 7.333278 ustep: 1 
iter: 3  value: 2097.523 mgc: 1.235113 ustep: 1 
iter: 4  value: 2097.522 mgc: 0.05211006 ustep: 1 
iter: 5  value: 2097.522 mgc: 0.0001045763 ustep: 1 
iter: 6  mgc: 4.224159e-10 
iter: 1  value: 2055.428 mgc: 9.684258 ustep: 1 
iter: 2  value: 2055.149 mgc: 1.042032 ustep: 1 
iter: 3  value: 2055.148 mgc: 0.06346796 ustep: 1 
iter: 4  value: 2055.148 mgc: 0.0003762264 ustep: 1 
iter: 5  value: 2055.148 mgc: 1.320601e-08 ustep: 1 
mgc: 4.651834e-14 
iter: 1  mgc: 4.651834e-14 
outer mgc:  89.30198 
iter: 1  value: 2201.519 mgc: 38.52687 ustep: 1 
iter: 2  value: 2195.741 mgc: 3.772709 ustep: 1 
iter: 3  value: 2195.739 mgc: 0.1009073 ustep: 1 
iter: 4  value: 2195.739 mgc: 8.084899e-05 ustep: 1 
iter: 5  mgc: 7.593748e-11 
iter: 1  value: 2047.745 mgc: 7.36885 ustep: 1 
iter: 2  value: 2047.732 mgc: 0.1809703 ustep: 1 
iter: 3  value: 2047.732 mgc: 0.0002458144 ustep: 1 
iter: 4  mgc: 5.043839e-10 
iter: 1  mgc: 5.043839e-10 
outer mgc:  91.82451 
iter: 1  value: 2043.381 mgc: 3.820187 ustep: 1 
iter: 2  value: 2043.381 mgc: 0.04764234 ustep: 1 
iter: 3  value: 2043.381 mgc: 3.190759e-05 ustep: 1 
iter: 4  mgc: 1.758726e-11 
iter: 1  mgc: 1.758726e-11 
outer mgc:  102.2774 
iter: 1  value: 2029.284 mgc: 13.83782 ustep: 1 
iter: 2  value: 2029.142 mgc: 0.4948503 ustep: 1 
iter: 3  value: 2029.142 mgc: 0.002074066 ustep: 1 
iter: 4  value: 2029.142 mgc: 3.960076e-08 ustep: 1 
mgc: 4.218847e-14 
iter: 1  mgc: 4.218847e-14 
outer mgc:  64.55313 
iter: 1  value: 2022.684 mgc: 9.343804 ustep: 1 
iter: 2  value: 2022.651 mgc: 0.2645984 ustep: 1 
iter: 3  value: 2022.651 mgc: 0.0004162138 ustep: 1 
iter: 4  mgc: 2.649965e-09 
iter: 1  mgc: 2.649965e-09 
outer mgc:  51.76321 
iter: 1  value: 2019.116 mgc: 5.928709 ustep: 1 
iter: 2  value: 2019.095 mgc: 0.1856856 ustep: 1 
iter: 3  value: 2019.095 mgc: 0.0005872483 ustep: 1 
iter: 4  mgc: 8.820042e-09 
iter: 1  mgc: 8.820042e-09 
outer mgc:  50.23075 
iter: 1  value: 2025.663 mgc: 8.577471 ustep: 1 
iter: 2  value: 2025.653 mgc: 0.2795672 ustep: 1 
iter: 3  value: 2025.653 mgc: 0.0006117078 ustep: 1 
iter: 4  mgc: 3.722198e-09 
iter: 1  value: 2015.4 mgc: 1.671042 ustep: 1 
iter: 2  value: 2015.4 mgc: 0.02541487 ustep: 1 
iter: 3  value: 2015.4 mgc: 2.289958e-05 ustep: 1 
iter: 4  mgc: 6.125855e-11 
iter: 1  mgc: 6.125855e-11 
outer mgc:  37.14309 
iter: 1  value: 2017.043 mgc: 4.067341 ustep: 1 
iter: 2  value: 2017.041 mgc: 0.06676336 ustep: 1 
iter: 3  value: 2017.041 mgc: 5.122256e-05 ustep: 1 
iter: 4  mgc: 4.050671e-11 
iter: 1  value: 2014.543 mgc: 1.424803 ustep: 1 
iter: 2  value: 2014.543 mgc: 0.007955703 ustep: 1 
iter: 3  value: 2014.543 mgc: 7.384739e-07 ustep: 1 
iter: 4  mgc: 5.551115e-14 
iter: 1  mgc: 5.551115e-14 
outer mgc:  20.32537 
iter: 1  value: 2013.813 mgc: 1.489611 ustep: 1 
iter: 2  value: 2013.813 mgc: 0.006298623 ustep: 1 
iter: 3  value: 2013.813 mgc: 3.159481e-07 ustep: 1 
iter: 4  mgc: 3.93019e-14 
iter: 1  mgc: 3.93019e-14 
outer mgc:  23.26793 
iter: 1  value: 2012.717 mgc: 1.212513 ustep: 1 
iter: 2  value: 2012.717 mgc: 0.004927788 ustep: 1 
iter: 3  value: 2012.717 mgc: 6.014921e-07 ustep: 1 
iter: 4  mgc: 7.727152e-14 
iter: 1  mgc: 7.727152e-14 
outer mgc:  27.95749 
iter: 1  value: 2012.38 mgc: 3.485171 ustep: 1 
iter: 2  value: 2012.377 mgc: 0.06055506 ustep: 1 
iter: 3  value: 2012.377 mgc: 5.087021e-05 ustep: 1 
iter: 4  mgc: 7.656364e-11 
iter: 1  mgc: 7.656364e-11 
outer mgc:  16.1671 
iter: 1  value: 2011.199 mgc: 7.539129 ustep: 1 
iter: 2  value: 2011.191 mgc: 0.1523082 ustep: 1 
iter: 3  value: 2011.191 mgc: 0.0001778082 ustep: 1 
iter: 4  mgc: 2.429805e-10 
iter: 1  mgc: 2.429805e-10 
outer mgc:  21.24942 
iter: 1  value: 2015.287 mgc: 7.693284 ustep: 1 
iter: 2  value: 2015.267 mgc: 0.1922268 ustep: 1 
iter: 3  value: 2015.267 mgc: 0.000287647 ustep: 1 
iter: 4  mgc: 6.472372e-10 
iter: 1  value: 2010.784 mgc: 2.867565 ustep: 1 
iter: 2  value: 2010.784 mgc: 0.02708066 ustep: 1 
iter: 3  value: 2010.784 mgc: 5.585178e-06 ustep: 1 
iter: 4  mgc: 2.433609e-13 
iter: 1  mgc: 2.433609e-13 
outer mgc:  22.78499 
iter: 1  value: 2010.573 mgc: 0.7120576 ustep: 1 
iter: 2  value: 2010.573 mgc: 0.001517275 ustep: 1 
iter: 3  value: 2010.573 mgc: 3.318481e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  17.38356 
iter: 1  value: 2010.466 mgc: 1.1712 ustep: 1 
iter: 2  value: 2010.466 mgc: 0.004582815 ustep: 1 
iter: 3  value: 2010.466 mgc: 1.797738e-07 ustep: 1 
iter: 4  mgc: 6.905587e-14 
iter: 1  mgc: 6.905587e-14 
outer mgc:  7.027027 
iter: 1  value: 2010.456 mgc: 0.2161766 ustep: 1 
iter: 2  value: 2010.456 mgc: 0.0001990499 ustep: 1 
iter: 3  mgc: 3.193293e-09 
iter: 1  mgc: 3.193293e-09 
outer mgc:  3.94805 
iter: 1  value: 2010.363 mgc: 0.7621756 ustep: 1 
iter: 2  value: 2010.363 mgc: 0.003284639 ustep: 1 
iter: 3  value: 2010.363 mgc: 3.556151e-07 ustep: 1 
iter: 4  mgc: 4.651834e-14 
iter: 1  mgc: 4.651834e-14 
outer mgc:  3.895278 
iter: 1  value: 2010.454 mgc: 0.5785456 ustep: 1 
iter: 2  value: 2010.454 mgc: 0.001369019 ustep: 1 
iter: 3  value: 2010.454 mgc: 6.871326e-08 ustep: 1 
iter: 4  mgc: 5.817569e-14 
iter: 1  value: 2010.358 mgc: 0.2856518 ustep: 1 
iter: 2  value: 2010.358 mgc: 0.0008511225 ustep: 1 
iter: 3  value: 2010.358 mgc: 3.391837e-08 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  3.83611 
iter: 1  value: 2010.323 mgc: 0.2031086 ustep: 1 
iter: 2  value: 2010.323 mgc: 9.792289e-05 ustep: 1 
iter: 3  mgc: 3.492993e-10 
iter: 1  mgc: 3.492993e-10 
outer mgc:  3.544654 
iter: 1  value: 2010.325 mgc: 0.1483199 ustep: 1 
iter: 2  value: 2010.325 mgc: 0.0001415121 ustep: 1 
iter: 3  mgc: 2.578404e-10 
iter: 1  mgc: 2.578404e-10 
outer mgc:  1.323374 
iter: 1  value: 2010.386 mgc: 0.4409001 ustep: 1 
iter: 2  value: 2010.386 mgc: 0.0006621456 ustep: 1 
iter: 3  mgc: 5.361647e-09 
iter: 1  value: 2010.349 mgc: 0.2500792 ustep: 1 
iter: 2  value: 2010.349 mgc: 0.0001538887 ustep: 1 
iter: 3  mgc: 1.574119e-10 
iter: 1  mgc: 1.574119e-10 
outer mgc:  1.983862 
iter: 1  value: 2010.348 mgc: 0.1042688 ustep: 1 
iter: 2  value: 2010.348 mgc: 6.419374e-05 ustep: 1 
iter: 3  mgc: 3.207568e-11 
iter: 1  mgc: 3.207568e-11 
outer mgc:  0.5394308 
iter: 1  value: 2010.333 mgc: 0.06787432 ustep: 1 
iter: 2  value: 2010.333 mgc: 1.494014e-05 ustep: 1 
iter: 3  mgc: 1.141309e-12 
iter: 1  mgc: 1.141309e-12 
outer mgc:  0.6683094 
iter: 1  value: 2010.319 mgc: 0.04410446 ustep: 1 
iter: 2  value: 2010.319 mgc: 2.200719e-05 ustep: 1 
iter: 3  mgc: 8.050449e-12 
iter: 1  value: 2010.328 mgc: 0.03781978 ustep: 1 
iter: 2  value: 2010.328 mgc: 7.978281e-06 ustep: 1 
iter: 3  mgc: 8.668621e-13 
iter: 1  mgc: 8.668621e-13 
outer mgc:  0.2448494 
iter: 1  value: 2010.336 mgc: 0.06062638 ustep: 1 
iter: 2  value: 2010.336 mgc: 1.326389e-05 ustep: 1 
iter: 3  mgc: 3.92486e-12 
iter: 1  mgc: 3.92486e-12 
outer mgc:  0.2732497 
iter: 1  value: 2010.339 mgc: 0.03321428 ustep: 1 
iter: 2  value: 2010.339 mgc: 3.443891e-06 ustep: 1 
iter: 3  mgc: 2.211564e-13 
iter: 1  mgc: 2.211564e-13 
outer mgc:  0.1256495 
iter: 1  value: 2010.324 mgc: 0.0453684 ustep: 1 
iter: 2  value: 2010.324 mgc: 1.411479e-05 ustep: 1 
iter: 3  mgc: 2.728928e-12 
iter: 1  value: 2010.335 mgc: 0.01279119 ustep: 1 
iter: 2  value: 2010.335 mgc: 1.045825e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  0.04067343 
iter: 1  value: 2010.331 mgc: 0.008002899 ustep: 1 
iter: 2  value: 2010.331 mgc: 2.702159e-07 ustep: 1 
iter: 3  mgc: 4.884981e-14 
iter: 1  value: 2010.333 mgc: 0.003160454 ustep: 1 
iter: 2  value: 2010.333 mgc: 4.218806e-08 ustep: 1 
iter: 3  mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  0.02120048 
iter: 1  value: 2010.334 mgc: 0.002158094 ustep: 1 
iter: 2  value: 2010.334 mgc: 3.423648e-08 ustep: 1 
iter: 3  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  0.006115166 
iter: 1  value: 2010.334 mgc: 0.001150235 ustep: 1 
iter: 2  mgc: 5.126917e-09 
iter: 1  mgc: 5.126917e-09 
outer mgc:  0.002528627 
iter: 1  mgc: 5.126917e-09 
iter: 1  mgc: 5.126917e-09 
outer mgc:  0.002528627 
iter: 1  value: 2010.336 mgc: 0.05657197 ustep: 1 
iter: 2  value: 2010.336 mgc: 8.883476e-06 ustep: 1 
iter: 3  mgc: 5.861978e-13 
outer mgc:  0.3394975 
iter: 1  value: 2010.331 mgc: 0.05657507 ustep: 1 
iter: 2  value: 2010.331 mgc: 8.875707e-06 ustep: 1 
iter: 3  mgc: 5.559997e-13 
outer mgc:  0.33544 
iter: 1  value: 2010.336 mgc: 0.03156948 ustep: 1 
iter: 2  value: 2010.336 mgc: 3.215303e-06 ustep: 1 
iter: 3  mgc: 9.547918e-14 
outer mgc:  1.057869 
iter: 1  value: 2010.332 mgc: 0.03157482 ustep: 1 
iter: 2  value: 2010.332 mgc: 3.213818e-06 ustep: 1 
iter: 3  mgc: 8.282264e-14 
outer mgc:  1.054761 
iter: 1  value: 2010.333 mgc: 0.05547375 ustep: 1 
iter: 2  value: 2010.333 mgc: 8.834118e-06 ustep: 1 
iter: 3  mgc: 6.186163e-13 
outer mgc:  0.2987312 
iter: 1  value: 2010.335 mgc: 0.05546674 ustep: 1 
iter: 2  value: 2010.335 mgc: 8.841461e-06 ustep: 1 
iter: 3  mgc: 5.973e-13 
outer mgc:  0.3021579 
iter: 1  value: 2010.335 mgc: 0.03065433 ustep: 1 
iter: 2  value: 2010.335 mgc: 3.746655e-06 ustep: 1 
iter: 3  mgc: 1.352252e-13 
outer mgc:  0.968239 
iter: 1  value: 2010.333 mgc: 0.03065261 ustep: 1 
iter: 2  value: 2010.333 mgc: 3.747786e-06 ustep: 1 
iter: 3  mgc: 1.199041e-13 
outer mgc:  0.9683975 
iter: 1  value: 2010.329 mgc: 0.004274751 ustep: 1 
iter: 2  value: 2010.329 mgc: 3.080395e-07 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.03544639 
iter: 1  value: 2010.338 mgc: 0.004272461 ustep: 1 
iter: 2  value: 2010.338 mgc: 3.078729e-07 ustep: 1 
iter: 3  mgc: 4.92939e-14 
outer mgc:  0.0369661 
iter: 1  value: 2010.343 mgc: 0.01505492 ustep: 1 
iter: 2  value: 2010.343 mgc: 3.885387e-06 ustep: 1 
iter: 3  mgc: 1.334044e-12 
outer mgc:  0.4334923 
iter: 1  value: 2010.325 mgc: 0.01509171 ustep: 1 
iter: 2  value: 2010.325 mgc: 3.911086e-06 ustep: 1 
iter: 3  mgc: 1.388223e-12 
outer mgc:  0.432647 
iter: 1  value: 2010.344 mgc: 0.01093254 ustep: 1 
iter: 2  value: 2010.344 mgc: 2.470873e-06 ustep: 1 
iter: 3  mgc: 1.234568e-13 
outer mgc:  0.4298239 
iter: 1  value: 2010.324 mgc: 0.01095566 ustep: 1 
iter: 2  value: 2010.324 mgc: 2.477879e-06 ustep: 1 
iter: 3  mgc: 1.24345e-13 
outer mgc:  0.4356645 
[Mon Aug 16 08:04:26 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 21:46:44 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4392.251930 
iter  10 value 2266.703983
final  value 2259.146019 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4367.397 mgc: 127.1894 ustep: 1 
iter: 2  value: 3822.119 mgc: 94.23982 ustep: 1 
iter: 3  value: 3812.94 mgc: 89.14677 ustep: 0.6827823 
iter: 4  value: 3801.708 mgc: 97.46938 ustep: 0.5831969 
iter: 5  value: 3796.485 mgc: 95.96862 ustep: 0.1649487 
iter: 6  value: 3791.718 mgc: 97.83391 ustep: 0.4061982 
iter: 7  value: 3789.323 mgc: 94.3975 ustep: 0.2239461 
iter: 8  value: 3758.374 mgc: 97.23992 ustep: 0.2742192 
iter: 9  value: 3732.667 mgc: 87.57096 ustep: 0.5237071 
iter: 10  value: 3675.871 mgc: 82.4735 ustep: 0.7237037 
iter: 11  value: 3651.744 mgc: 49.49734 ustep: 0.8507227 
iter: 12  value: 3651.139 mgc: 8.204985 ustep: 0.9223541 
iter: 13  value: 3651.139 mgc: 0.007694544 ustep: 0.9603966 
iter: 14  value: 3651.139 mgc: 2.454898e-05 ustep: 0.9800003 
iter: 15  value: 3651.139 mgc: 3.656882e-08 ustep: 0.9899506 
mgc: 2.731415e-11 
iter: 1  mgc: 2.731415e-11 
Matching hessian patterns... Done
outer mgc:  776.2811 
iter: 1  value: 2870.788 mgc: 31.99561 ustep: 1 
iter: 2  value: 2734.299 mgc: 22.7741 ustep: 1 
iter: 3  value: 2732.42 mgc: 3.122271 ustep: 1 
iter: 4  value: 2732.417 mgc: 0.1439291 ustep: 1 
iter: 5  value: 2732.417 mgc: 0.0003639703 ustep: 1 
iter: 6  mgc: 2.348545e-09 
iter: 1  value: 1307.327 mgc: 52.36209 ustep: 0.1336527 
iter: 2  value: 792.2804 mgc: 117.0135 ustep: 0.3656489 
iter: 3  value: 743.3199 mgc: 46.87344 ustep: 0.6047286 
iter: 4  value: 733.3872 mgc: 29.30084 ustep: 0.7776652 
iter: 5  value: 733.3385 mgc: 1.827818 ustep: 0.8818651 
iter: 6  value: 733.3385 mgc: 0.02494139 ustep: 0.9390828 
iter: 7  value: 733.3385 mgc: 5.134406e-05 ustep: 0.969066 
iter: 8  value: 733.3385 mgc: 1.292009e-07 ustep: 0.984413 
iter: 9  mgc: 2.414377e-10 
iter: 1  mgc: 2.414377e-10 
outer mgc:  295.0467 
iter: 1  value: 239.4094 mgc: 17.94113 ustep: 1 
iter: 2  value: 225.0522 mgc: 10.74989 ustep: 1 
iter: 3  value: 224.9636 mgc: 1.037795 ustep: 1 
iter: 4  value: 224.9635 mgc: 0.01652314 ustep: 1 
iter: 5  value: 224.9635 mgc: 4.480279e-06 ustep: 1 
iter: 6  mgc: 3.280709e-13 
iter: 1  mgc: 3.280709e-13 
outer mgc:  21.0688 
iter: 1  value: 883.0227 mgc: 261.8522 ustep: 1 
iter: 2  value: 811.2949 mgc: 16.79595 ustep: 1 
iter: 3  value: 810.5438 mgc: 2.279083 ustep: 1 
iter: 4  value: 810.5435 mgc: 0.05296647 ustep: 1 
iter: 5  value: 810.5435 mgc: 4.024714e-05 ustep: 1 
iter: 6  mgc: 2.323675e-11 
iter: 1  value: 212.8427 mgc: 6.912301 ustep: 1 
iter: 2  value: 212.8274 mgc: 0.2297885 ustep: 1 
iter: 3  value: 212.8274 mgc: 0.0005675979 ustep: 1 
iter: 4  mgc: 1.863732e-09 
iter: 1  mgc: 1.863732e-09 
outer mgc:  16.56872 
iter: 1  value: 202.6702 mgc: 4.738495 ustep: 1 
iter: 2  value: 202.6659 mgc: 0.1251582 ustep: 1 
iter: 3  value: 202.6659 mgc: 0.0001604084 ustep: 1 
iter: 4  mgc: 3.997218e-10 
iter: 1  value: 198.9233 mgc: 19.58266 ustep: 1 
iter: 2  value: 198.7575 mgc: 1.048416 ustep: 1 
iter: 3  value: 198.7575 mgc: 0.0086474 ustep: 1 
iter: 4  value: 198.7575 mgc: 2.642965e-07 ustep: 1 
iter: 5  mgc: 3.277933e-14 
iter: 1  mgc: 3.997218e-10 
outer mgc:  12.36464 
iter: 1  value: 186.5192 mgc: 6.327513 ustep: 1 
iter: 2  value: 186.4809 mgc: 0.4192486 ustep: 1 
iter: 3  value: 186.4809 mgc: 0.0018404 ustep: 1 
iter: 4  value: 186.4809 mgc: 3.632303e-08 ustep: 1 
mgc: 2.731149e-14 
iter: 1  value: 172.232 mgc: 26.73027 ustep: 1 
iter: 2  value: 172.1521 mgc: 1.144459 ustep: 1 
iter: 3  value: 172.1521 mgc: 0.002780094 ustep: 1 
iter: 4  value: 172.1521 mgc: 1.789965e-08 ustep: 1 
mgc: 2.475797e-14 
iter: 1  mgc: 2.475797e-14 
outer mgc:  15.52929 
iter: 1  value: 296.6871 mgc: 63.63275 ustep: 1 
iter: 2  value: 294.4058 mgc: 4.016102 ustep: 1 
iter: 3  value: 294.4057 mgc: 0.04054515 ustep: 1 
iter: 4  value: 294.4057 mgc: 9.022622e-06 ustep: 1 
iter: 5  mgc: 4.35596e-13 
iter: 1  value: 167.1096 mgc: 4.841165 ustep: 1 
iter: 2  value: 167.1085 mgc: 0.1139101 ustep: 1 
iter: 3  value: 167.1085 mgc: 7.923607e-05 ustep: 1 
iter: 4  mgc: 3.660061e-11 
iter: 1  mgc: 3.660061e-11 
outer mgc:  13.67951 
iter: 1  value: 166.217 mgc: 6.321229 ustep: 1 
iter: 2  value: 166.2162 mgc: 0.1097319 ustep: 1 
iter: 3  value: 166.2162 mgc: 2.638702e-05 ustep: 1 
iter: 4  mgc: 3.134826e-12 
iter: 1  mgc: 3.134826e-12 
outer mgc:  24.73732 
iter: 1  value: 164.6988 mgc: 4.418645 ustep: 1 
iter: 2  value: 164.6979 mgc: 0.1017177 ustep: 1 
iter: 3  value: 164.6979 mgc: 5.730441e-05 ustep: 1 
iter: 4  mgc: 1.802603e-11 
iter: 1  mgc: 1.802603e-11 
outer mgc:  6.496368 
iter: 1  value: 165.7805 mgc: 3.608531 ustep: 1 
iter: 2  value: 165.7798 mgc: 0.1023326 ustep: 1 
iter: 3  value: 165.7798 mgc: 8.099883e-05 ustep: 1 
iter: 4  mgc: 5.138889e-11 
iter: 1  mgc: 5.138889e-11 
outer mgc:  3.827104 
iter: 1  value: 163.7048 mgc: 3.684525 ustep: 1 
iter: 2  value: 163.7043 mgc: 0.06047433 ustep: 1 
iter: 3  value: 163.7043 mgc: 2.698298e-05 ustep: 1 
iter: 4  mgc: 4.5286e-12 
iter: 1  mgc: 4.5286e-12 
outer mgc:  8.784397 
iter: 1  value: 163.7719 mgc: 2.50917 ustep: 1 
iter: 2  value: 163.7718 mgc: 0.02062731 ustep: 1 
iter: 3  value: 163.7718 mgc: 1.961103e-06 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  5.717957 
iter: 1  value: 164.7641 mgc: 3.985981 ustep: 1 
iter: 2  value: 164.7639 mgc: 0.05988143 ustep: 1 
iter: 3  value: 164.7639 mgc: 4.014805e-05 ustep: 1 
iter: 4  mgc: 1.536637e-11 
iter: 1  value: 163.7063 mgc: 1.900306 ustep: 1 
iter: 2  value: 163.7063 mgc: 0.0102537 ustep: 1 
iter: 3  value: 163.7063 mgc: 1.290053e-06 ustep: 1 
iter: 4  mgc: 3.569367e-14 
iter: 1  mgc: 3.569367e-14 
outer mgc:  2.339006 
iter: 1  value: 163.1026 mgc: 1.774625 ustep: 1 
iter: 2  value: 163.1026 mgc: 0.006391927 ustep: 1 
iter: 3  value: 163.1026 mgc: 2.58831e-07 ustep: 1 
iter: 4  mgc: 3.025358e-14 
iter: 1  mgc: 3.025358e-14 
outer mgc:  3.866962 
iter: 1  value: 162.6336 mgc: 2.573878 ustep: 1 
iter: 2  value: 162.6336 mgc: 0.008174205 ustep: 1 
iter: 3  value: 162.6336 mgc: 1.975187e-07 ustep: 1 
iter: 4  mgc: 2.220446e-14 
iter: 1  value: 162.9186 mgc: 1.853513 ustep: 1 
iter: 2  value: 162.9186 mgc: 0.002998163 ustep: 1 
iter: 3  value: 162.9186 mgc: 1.007246e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  3.863513 
iter: 1  value: 162.8554 mgc: 0.4297442 ustep: 1 
iter: 2  value: 162.8554 mgc: 0.0004162647 ustep: 1 
iter: 3  mgc: 1.270039e-09 
iter: 1  mgc: 1.270039e-09 
outer mgc:  0.5619948 
iter: 1  value: 162.7194 mgc: 0.1571031 ustep: 1 
iter: 2  value: 162.7194 mgc: 7.862743e-05 ustep: 1 
iter: 3  mgc: 2.326939e-11 
iter: 1  value: 162.4353 mgc: 0.3057934 ustep: 1 
iter: 2  value: 162.4353 mgc: 0.000299932 ustep: 1 
iter: 3  mgc: 3.717472e-10 
iter: 1  mgc: 3.717472e-10 
outer mgc:  0.9641757 
iter: 1  value: 161.6918 mgc: 1.132434 ustep: 1 
iter: 2  value: 161.6918 mgc: 0.002747135 ustep: 1 
iter: 3  value: 161.6918 mgc: 2.640825e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  value: 162.0862 mgc: 0.5083032 ustep: 1 
iter: 2  value: 162.0862 mgc: 0.0005834937 ustep: 1 
iter: 3  mgc: 1.22046e-09 
iter: 1  mgc: 1.22046e-09 
outer mgc:  0.420903 
iter: 1  value: 161.7757 mgc: 0.6570924 ustep: 1 
iter: 2  value: 161.7757 mgc: 0.001726485 ustep: 1 
iter: 3  value: 161.7757 mgc: 4.607075e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  value: 161.9592 mgc: 0.2552417 ustep: 1 
iter: 2  value: 161.9592 mgc: 0.0002667268 ustep: 1 
iter: 3  mgc: 1.111367e-09 
iter: 1  mgc: 1.111367e-09 
outer mgc:  0.3364296 
iter: 1  value: 161.9706 mgc: 0.1309636 ustep: 1 
iter: 2  value: 161.9706 mgc: 3.65899e-05 ustep: 1 
iter: 3  mgc: 2.483347e-12 
iter: 1  mgc: 2.483347e-12 
outer mgc:  0.05604408 
iter: 1  value: 161.9548 mgc: 0.04157467 ustep: 1 
iter: 2  value: 161.9548 mgc: 4.743495e-06 ustep: 1 
iter: 3  mgc: 9.514611e-14 
iter: 1  mgc: 9.514611e-14 
outer mgc:  0.01250144 
iter: 1  value: 161.9556 mgc: 0.003692574 ustep: 1 
iter: 2  value: 161.9556 mgc: 3.870655e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  0.001972333 
iter: 1  value: 161.9553 mgc: 0.000641802 ustep: 1 
iter: 2  mgc: 3.337153e-10 
iter: 1  mgc: 3.337153e-10 
outer mgc:  0.0002264069 
iter: 1  value: 161.9552 mgc: 0.0001077423 ustep: 1 
iter: 2  mgc: 5.868439e-11 
iter: 1  mgc: 5.868439e-11 
outer mgc:  7.693812e-05 
iter: 1  mgc: 5.868439e-11 
iter: 1  mgc: 5.868439e-11 
outer mgc:  7.693812e-05 
iter: 1  value: 161.9552 mgc: 0.02752122 ustep: 1 
iter: 2  value: 161.9552 mgc: 1.772224e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.1694369 
iter: 1  value: 161.9554 mgc: 0.02751855 ustep: 1 
iter: 2  value: 161.9554 mgc: 1.771819e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
outer mgc:  0.1692752 
iter: 1  value: 161.9552 mgc: 0.0003303622 ustep: 1 
iter: 2  mgc: 2.101612e-10 
outer mgc:  0.004943577 
iter: 1  value: 161.9553 mgc: 0.0003300337 ustep: 1 
iter: 2  mgc: 2.097549e-10 
outer mgc:  0.004943745 
iter: 1  value: 161.9553 mgc: 0.02521848 ustep: 1 
iter: 2  value: 161.9553 mgc: 1.559307e-06 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.1475373 
iter: 1  value: 161.9553 mgc: 0.0252111 ustep: 1 
iter: 2  value: 161.9553 mgc: 1.560659e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.1476814 
iter: 1  value: 161.9561 mgc: 0.003814868 ustep: 1 
iter: 2  value: 161.9561 mgc: 5.163557e-08 ustep: 1 
mgc: 2.953193e-14 
outer mgc:  0.03345082 
iter: 1  value: 161.9543 mgc: 0.003818407 ustep: 1 
iter: 2  value: 161.9543 mgc: 5.163635e-08 ustep: 1 
mgc: 3.552714e-14 
outer mgc:  0.03344063 
iter: 1  value: 161.9509 mgc: 0.004627924 ustep: 1 
iter: 2  value: 161.9509 mgc: 4.255427e-08 ustep: 1 
mgc: 1.776357e-14 
outer mgc:  0.001490344 
iter: 1  value: 161.9595 mgc: 0.004625999 ustep: 1 
iter: 2  value: 161.9595 mgc: 4.259244e-08 ustep: 1 
mgc: 1.998401e-14 
outer mgc:  0.001608155 
iter: 1  value: 161.9628 mgc: 0.03112376 ustep: 1 
iter: 2  value: 161.9628 mgc: 8.267408e-07 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.06243442 
iter: 1  value: 161.9477 mgc: 0.03120791 ustep: 1 
iter: 2  value: 161.9477 mgc: 8.291289e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.06233104 
iter: 1  value: 161.9617 mgc: 0.02180584 ustep: 1 
iter: 2  value: 161.9617 mgc: 7.174943e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.06217414 
iter: 1  value: 161.9488 mgc: 0.02182765 ustep: 1 
iter: 2  value: 161.9488 mgc: 7.224006e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.06228737 
[Sat Aug 14 21:46:46 2021]
Finished job 0.
1 of 1 steps (100%) done

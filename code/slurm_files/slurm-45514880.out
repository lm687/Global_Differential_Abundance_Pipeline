Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 10:36:48 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4397.744992 
final  value 3777.609059 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 778.4334 mgc: 122.8517 ustep: 1 
iter: 2  value: 740.4097 mgc: 72.64229 ustep: 0.4367355 
iter: 3  value: 533.4137 mgc: 91.21231 ustep: 0.06532755 
iter: 4  value: 507.8312 mgc: 42.45949 ustep: 0.255667 
iter: 5  value: 507.0141 mgc: 6.698648 ustep: 0.5056847 
iter: 6  value: 507.0107 mgc: 0.2275745 ustep: 0.711144 
iter: 7  value: 507.0107 mgc: 0.01108422 ustep: 0.8433092 
iter: 8  value: 507.0107 mgc: 0.0002114472 ustep: 0.9183269 
iter: 9  value: 507.0107 mgc: 1.922614e-06 ustep: 0.9582979 
iter: 10  mgc: 9.254467e-09 
iter: 1  mgc: 9.254467e-09 
Matching hessian patterns... Done
outer mgc:  44.18495 
iter: 1  value: 603.8266 mgc: 36.83835 ustep: 1 
iter: 2  value: 578.9615 mgc: 12.43608 ustep: 1 
iter: 3  value: 578.8332 mgc: 0.9967213 ustep: 1 
iter: 4  value: 578.8332 mgc: 0.01152529 ustep: 1 
iter: 5  value: 578.8332 mgc: 1.666337e-06 ustep: 1 
iter: 6  mgc: 5.306866e-14 
iter: 1  value: 500.5309 mgc: 10.30552 ustep: 1 
iter: 2  value: 500.4752 mgc: 0.551389 ustep: 1 
iter: 3  value: 500.4752 mgc: 0.003426155 ustep: 1 
iter: 4  value: 500.4752 mgc: 1.393311e-07 ustep: 1 
iter: 5  mgc: 4.340972e-14 
iter: 1  mgc: 4.340972e-14 
outer mgc:  15.36752 
iter: 1  value: 496.8428 mgc: 5.196085 ustep: 1 
iter: 2  value: 496.8361 mgc: 0.1800729 ustep: 1 
iter: 3  value: 496.8361 mgc: 0.0003282989 ustep: 1 
iter: 4  mgc: 2.321792e-09 
iter: 1  mgc: 2.321792e-09 
outer mgc:  15.24436 
iter: 1  value: 490.9211 mgc: 22.62609 ustep: 1 
iter: 2  value: 488.5046 mgc: 3.778562 ustep: 1 
iter: 3  value: 488.5026 mgc: 0.1297819 ustep: 1 
iter: 4  value: 488.5026 mgc: 0.0002352866 ustep: 1 
iter: 5  mgc: 1.169396e-09 
iter: 1  mgc: 1.169396e-09 
outer mgc:  20.73711 
iter: 1  value: 485.7533 mgc: 35.3561 ustep: 1 
iter: 2  value: 469.2475 mgc: 10.33386 ustep: 1 
iter: 3  value: 469.1775 mgc: 0.7515911 ustep: 1 
iter: 4  value: 469.1775 mgc: 0.009031583 ustep: 1 
iter: 5  value: 469.1775 mgc: 1.590968e-06 ustep: 1 
iter: 6  mgc: 4.22995e-14 
iter: 1  value: 1292.963 mgc: 87.3107 ustep: 1 
iter: 2  value: 876.6114 mgc: 67.56876 ustep: 1 
iter: 3  value: 874.1907 mgc: 6.40435 ustep: 1 
iter: 4  value: 874.1889 mgc: 0.222661 ustep: 1 
iter: 5  value: 874.1889 mgc: 0.0003865769 ustep: 1 
iter: 6  mgc: 1.485073e-09 
iter: 1  mgc: 4.22995e-14 
outer mgc:  14.04814 
iter: 1  value: 535.2114 mgc: 32.05017 ustep: 1 
iter: 2  value: 511.6791 mgc: 12.1541 ustep: 1 
iter: 3  value: 511.586 mgc: 0.8002604 ustep: 1 
iter: 4  value: 511.5859 mgc: 0.00627522 ustep: 1 
iter: 5  value: 511.5859 mgc: 4.673377e-07 ustep: 1 
iter: 6  mgc: 3.252953e-14 
iter: 1  value: 461.2619 mgc: 9.839926 ustep: 1 
iter: 2  value: 461.1495 mgc: 0.7322816 ustep: 1 
iter: 3  value: 461.1495 mgc: 0.005550835 ustep: 1 
iter: 4  value: 461.1495 mgc: 5.355641e-07 ustep: 1 
iter: 5  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  28.53176 
iter: 1  value: 456.15 mgc: 20.79786 ustep: 1 
iter: 2  value: 455.3657 mgc: 2.343326 ustep: 1 
iter: 3  value: 455.3655 mgc: 0.0440381 ustep: 1 
iter: 4  value: 455.3655 mgc: 2.021257e-05 ustep: 1 
iter: 5  mgc: 6.632916e-12 
iter: 1  mgc: 6.632916e-12 
outer mgc:  25.62471 
iter: 1  value: 455.4866 mgc: 4.265137 ustep: 1 
iter: 2  value: 455.4864 mgc: 0.05993803 ustep: 1 
iter: 3  value: 455.4864 mgc: 1.308878e-05 ustep: 1 
iter: 4  mgc: 2.971179e-12 
iter: 1  value: 453.0719 mgc: 8.080833 ustep: 1 
iter: 2  value: 453.0666 mgc: 0.1944184 ustep: 1 
iter: 3  value: 453.0666 mgc: 0.000304247 ustep: 1 
iter: 4  mgc: 9.022833e-10 
iter: 1  mgc: 9.022833e-10 
outer mgc:  20.26959 
iter: 1  value: 450.6601 mgc: 3.825157 ustep: 1 
iter: 2  value: 450.6596 mgc: 0.05642984 ustep: 1 
iter: 3  value: 450.6596 mgc: 2.052084e-05 ustep: 1 
iter: 4  mgc: 2.7717e-12 
iter: 1  mgc: 2.7717e-12 
outer mgc:  6.043391 
iter: 1  value: 449.9189 mgc: 4.669485 ustep: 1 
iter: 2  value: 449.9175 mgc: 0.1169755 ustep: 1 
iter: 3  value: 449.9175 mgc: 0.0001246077 ustep: 1 
iter: 4  mgc: 1.946789e-10 
iter: 1  mgc: 1.946789e-10 
outer mgc:  7.928738 
iter: 1  value: 451.1837 mgc: 11.95696 ustep: 1 
iter: 2  value: 451.1652 mgc: 0.415998 ustep: 1 
iter: 3  value: 451.1652 mgc: 0.001014837 ustep: 1 
iter: 4  mgc: 8.099598e-09 
iter: 1  value: 449.474 mgc: 2.600633 ustep: 1 
iter: 2  value: 449.474 mgc: 0.02041236 ustep: 1 
iter: 3  value: 449.474 mgc: 2.937134e-06 ustep: 1 
iter: 4  mgc: 1.101341e-13 
iter: 1  mgc: 1.101341e-13 
outer mgc:  2.49711 
iter: 1  value: 449.3488 mgc: 1.403477 ustep: 1 
iter: 2  value: 449.3488 mgc: 0.006365523 ustep: 1 
iter: 3  value: 449.3488 mgc: 2.464508e-07 ustep: 1 
iter: 4  mgc: 3.7359e-14 
iter: 1  mgc: 3.7359e-14 
outer mgc:  2.94372 
iter: 1  value: 449.4176 mgc: 1.509171 ustep: 1 
iter: 2  value: 449.4176 mgc: 0.005368512 ustep: 1 
iter: 3  value: 449.4176 mgc: 1.874014e-07 ustep: 1 
iter: 4  mgc: 3.28626e-14 
iter: 1  value: 449.3102 mgc: 0.395398 ustep: 1 
iter: 2  value: 449.3102 mgc: 0.0003288183 ustep: 1 
iter: 3  mgc: 6.885141e-10 
iter: 1  mgc: 6.885141e-10 
outer mgc:  1.384839 
iter: 1  value: 449.3014 mgc: 0.6527713 ustep: 1 
iter: 2  value: 449.3014 mgc: 0.001291855 ustep: 1 
iter: 3  value: 449.3014 mgc: 1.325088e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  1.413444 
iter: 1  value: 449.2639 mgc: 0.4971285 ustep: 1 
iter: 2  value: 449.2639 mgc: 0.001149686 ustep: 1 
iter: 3  mgc: 7.651826e-09 
iter: 1  mgc: 7.651826e-09 
outer mgc:  1.19484 
iter: 1  value: 449.1825 mgc: 0.3806148 ustep: 1 
iter: 2  value: 449.1825 mgc: 0.001512424 ustep: 1 
iter: 3  value: 449.1825 mgc: 2.396592e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  0.9269012 
iter: 1  value: 449.101 mgc: 1.195183 ustep: 1 
iter: 2  value: 449.101 mgc: 0.004229176 ustep: 1 
iter: 3  value: 449.101 mgc: 9.892834e-08 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  value: 449.1249 mgc: 0.3767665 ustep: 1 
iter: 2  value: 449.1249 mgc: 0.0007556907 ustep: 1 
iter: 3  mgc: 1.426846e-09 
iter: 1  mgc: 1.426846e-09 
outer mgc:  0.7199733 
iter: 1  value: 449.1205 mgc: 0.45974 ustep: 1 
iter: 2  value: 449.1205 mgc: 0.001373554 ustep: 1 
iter: 3  value: 449.1205 mgc: 3.10802e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  1.077212 
iter: 1  value: 449.128 mgc: 0.6395408 ustep: 1 
iter: 2  value: 449.128 mgc: 0.00174487 ustep: 1 
iter: 3  value: 449.128 mgc: 2.579641e-08 ustep: 1 
mgc: 4.041212e-14 
iter: 1  value: 449.1072 mgc: 0.4561134 ustep: 1 
iter: 2  value: 449.1072 mgc: 0.0005382304 ustep: 1 
iter: 3  mgc: 1.800673e-09 
iter: 1  value: 449.1103 mgc: 0.2184381 ustep: 1 
iter: 2  value: 449.1103 mgc: 0.0001238656 ustep: 1 
iter: 3  mgc: 9.530776e-11 
iter: 1  mgc: 9.530776e-11 
outer mgc:  0.5750767 
iter: 1  value: 449.1062 mgc: 0.1116031 ustep: 1 
iter: 2  value: 449.1062 mgc: 6.387213e-05 ustep: 1 
iter: 3  mgc: 3.513634e-11 
iter: 1  mgc: 3.513634e-11 
outer mgc:  0.5479809 
iter: 1  value: 449.0941 mgc: 0.2512653 ustep: 1 
iter: 2  value: 449.0941 mgc: 0.0001686714 ustep: 1 
iter: 3  mgc: 1.291092e-10 
iter: 1  mgc: 1.291092e-10 
outer mgc:  0.5179646 
iter: 1  value: 449.0921 mgc: 0.2930025 ustep: 1 
iter: 2  value: 449.0921 mgc: 0.0003511587 ustep: 1 
iter: 3  mgc: 1.092361e-09 
iter: 1  mgc: 1.092361e-09 
outer mgc:  0.4337784 
iter: 1  value: 449.0864 mgc: 0.179183 ustep: 1 
iter: 2  value: 449.0864 mgc: 0.0005116473 ustep: 1 
iter: 3  mgc: 4.109979e-09 
iter: 1  value: 449.0854 mgc: 0.0547427 ustep: 1 
iter: 2  value: 449.0854 mgc: 4.803529e-05 ustep: 1 
iter: 3  mgc: 3.662226e-11 
iter: 1  mgc: 3.662226e-11 
outer mgc:  0.5381928 
iter: 1  value: 449.0736 mgc: 0.1409569 ustep: 1 
iter: 2  value: 449.0736 mgc: 4.199404e-05 ustep: 1 
iter: 3  mgc: 6.600498e-12 
iter: 1  mgc: 6.600498e-12 
outer mgc:  0.3860716 
iter: 1  value: 449.0652 mgc: 0.1023459 ustep: 1 
iter: 2  value: 449.0652 mgc: 7.520003e-05 ustep: 1 
iter: 3  mgc: 6.402123e-11 
iter: 1  value: 449.055 mgc: 0.1199572 ustep: 1 
iter: 2  value: 449.055 mgc: 4.01906e-05 ustep: 1 
iter: 3  mgc: 5.97693e-11 
iter: 1  value: 449.0392 mgc: 0.1411634 ustep: 1 
iter: 2  value: 449.0392 mgc: 0.0002327717 ustep: 1 
iter: 3  mgc: 5.848915e-10 
iter: 1  mgc: 5.848915e-10 
outer mgc:  0.4366647 
iter: 1  value: 448.9865 mgc: 1.039272 ustep: 1 
iter: 2  value: 448.9864 mgc: 0.003226294 ustep: 1 
iter: 3  value: 448.9864 mgc: 7.061224e-08 ustep: 1 
iter: 4  mgc: 3.885781e-14 
iter: 1  value: 449.0136 mgc: 0.3559178 ustep: 1 
iter: 2  value: 449.0136 mgc: 0.0006748976 ustep: 1 
iter: 3  mgc: 1.027129e-09 
iter: 1  mgc: 1.027129e-09 
outer mgc:  0.2199493 
iter: 1  value: 449.0423 mgc: 0.1665652 ustep: 1 
iter: 2  value: 449.0423 mgc: 0.0002298866 ustep: 1 
iter: 3  mgc: 2.950489e-10 
iter: 1  value: 449.0263 mgc: 0.1044936 ustep: 1 
iter: 2  value: 449.0263 mgc: 4.42894e-05 ustep: 1 
iter: 3  mgc: 1.145706e-11 
iter: 1  mgc: 1.145706e-11 
outer mgc:  0.1075002 
iter: 1  value: 449.0004 mgc: 0.1166567 ustep: 1 
iter: 2  value: 449.0004 mgc: 6.189634e-05 ustep: 1 
iter: 3  mgc: 4.356071e-11 
iter: 1  value: 449.0163 mgc: 0.06443961 ustep: 1 
iter: 2  value: 449.0163 mgc: 1.092071e-05 ustep: 1 
iter: 3  mgc: 1.367795e-12 
iter: 1  mgc: 1.367795e-12 
outer mgc:  0.05045223 
iter: 1  value: 449.0183 mgc: 0.06020955 ustep: 1 
iter: 2  value: 449.0183 mgc: 2.860818e-05 ustep: 1 
iter: 3  mgc: 1.439471e-11 
iter: 1  mgc: 1.439471e-11 
outer mgc:  0.05782535 
iter: 1  value: 449.0165 mgc: 0.02448539 ustep: 1 
iter: 2  value: 449.0165 mgc: 3.412989e-06 ustep: 1 
iter: 3  mgc: 6.972201e-14 
iter: 1  mgc: 6.972201e-14 
outer mgc:  0.03446205 
iter: 1  value: 449.0162 mgc: 0.03211191 ustep: 1 
iter: 2  value: 449.0162 mgc: 5.145248e-06 ustep: 1 
iter: 3  mgc: 1.936229e-13 
iter: 1  value: 449.0165 mgc: 0.01682542 ustep: 1 
iter: 2  value: 449.0165 mgc: 1.312398e-06 ustep: 1 
iter: 3  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  0.02007852 
iter: 1  value: 449.0165 mgc: 0.01119958 ustep: 1 
iter: 2  value: 449.0165 mgc: 6.076874e-07 ustep: 1 
iter: 3  mgc: 3.264056e-14 
iter: 1  value: 449.0164 mgc: 0.009014644 ustep: 1 
iter: 2  value: 449.0164 mgc: 2.824947e-07 ustep: 1 
iter: 3  mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  0.00281039 
iter: 1  value: 449.0161 mgc: 0.001824955 ustep: 1 
iter: 2  mgc: 8.866939e-09 
iter: 1  mgc: 8.866939e-09 
outer mgc:  0.002736506 
iter: 1  value: 449.016 mgc: 0.002119477 ustep: 1 
iter: 2  value: 449.016 mgc: 1.309309e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  value: 449.0161 mgc: 0.000949278 ustep: 1 
iter: 2  mgc: 2.626407e-09 
iter: 1  mgc: 2.626407e-09 
outer mgc:  0.0005605724 
iter: 1  value: 449.0161 mgc: 0.0001216881 ustep: 1 
iter: 2  mgc: 8.79794e-11 
iter: 1  mgc: 8.79794e-11 
outer mgc:  0.0001420291 
iter: 1  mgc: 8.79794e-11 
iter: 1  mgc: 8.79794e-11 
outer mgc:  0.0001420291 
iter: 1  value: 449.0154 mgc: 0.04164633 ustep: 1 
iter: 2  value: 449.0154 mgc: 8.404433e-06 ustep: 1 
iter: 3  mgc: 4.264367e-13 
outer mgc:  0.09751538 
iter: 1  value: 449.0168 mgc: 0.04163004 ustep: 1 
iter: 2  value: 449.0168 mgc: 8.410825e-06 ustep: 1 
iter: 3  mgc: 4.344303e-13 
outer mgc:  0.09760092 
iter: 1  value: 449.0158 mgc: 0.02317082 ustep: 1 
iter: 2  value: 449.0158 mgc: 1.868303e-06 ustep: 1 
iter: 3  mgc: 4.396483e-14 
outer mgc:  0.1730594 
iter: 1  value: 449.0166 mgc: 0.0231614 ustep: 1 
iter: 2  value: 449.0166 mgc: 1.869202e-06 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  0.1728732 
iter: 1  value: 449.0172 mgc: 0.05755843 ustep: 1 
iter: 2  value: 449.0172 mgc: 7.081357e-06 ustep: 1 
iter: 3  mgc: 2.309264e-13 
outer mgc:  0.1229205 
iter: 1  value: 449.0151 mgc: 0.05756726 ustep: 1 
iter: 2  value: 449.0151 mgc: 7.073763e-06 ustep: 1 
iter: 3  mgc: 2.429168e-13 
outer mgc:  0.1228249 
iter: 1  value: 449.0169 mgc: 0.02731528 ustep: 1 
iter: 2  value: 449.0169 mgc: 1.865966e-06 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.2593811 
iter: 1  value: 449.0156 mgc: 0.02732025 ustep: 1 
iter: 2  value: 449.0156 mgc: 1.865975e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.2594258 
iter: 1  value: 449.0143 mgc: 0.004795143 ustep: 1 
iter: 2  value: 449.0143 mgc: 2.100389e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.007328324 
iter: 1  value: 449.0179 mgc: 0.00479188 ustep: 1 
iter: 2  value: 449.0179 mgc: 2.099555e-07 ustep: 1 
iter: 3  mgc: 3.352874e-14 
outer mgc:  0.007336473 
iter: 1  value: 449.0195 mgc: 0.01439133 ustep: 1 
iter: 2  value: 449.0195 mgc: 3.16158e-06 ustep: 1 
iter: 3  mgc: 1.563194e-13 
outer mgc:  0.05454022 
iter: 1  value: 449.0127 mgc: 0.01442648 ustep: 1 
iter: 2  value: 449.0127 mgc: 3.170392e-06 ustep: 1 
iter: 3  mgc: 1.580958e-13 
outer mgc:  0.05431687 
iter: 1  value: 449.0185 mgc: 0.0121092 ustep: 1 
iter: 2  value: 449.0185 mgc: 1.054194e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.06002013 
iter: 1  value: 449.0137 mgc: 0.01213495 ustep: 1 
iter: 2  value: 449.0137 mgc: 1.057697e-06 ustep: 1 
iter: 3  mgc: 2.897682e-14 
outer mgc:  0.06022011 
[Fri Aug 13 10:36:49 2021]
Finished job 0.
1 of 1 steps (100%) done

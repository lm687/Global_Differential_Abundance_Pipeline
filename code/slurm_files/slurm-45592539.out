Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 07:14:40 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4517.493731 
final  value 4083.188348 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2241.393 mgc: 104.0128 ustep: 0.4367355 
iter: 2  value: 1185.675 mgc: 87.0389 ustep: 0.1263996 
iter: 3  value: 1110.023 mgc: 139.9109 ustep: 0.3555917 
iter: 4  value: 675.183 mgc: 119.8747 ustep: 0.1071739 
iter: 5  value: 495.1138 mgc: 114.3041 ustep: 0.3274416 
iter: 6  value: 482.7424 mgc: 71.9277 ustep: 0.3459531 
iter: 7  value: 353.0368 mgc: 97.51241 ustep: 0.5882189 
iter: 8  value: 338.5137 mgc: 31.05451 ustep: 0.7669776 
iter: 9  value: 337.7458 mgc: 8.513412 ustep: 0.875785 
iter: 10  value: 337.7452 mgc: 0.2205208 ustep: 0.9358403 
iter: 11  value: 337.7452 mgc: 0.0004858513 ustep: 0.9673916 
iter: 12  value: 337.7452 mgc: 3.662261e-07 ustep: 0.9835623 
iter: 13  mgc: 2.28743e-10 
iter: 1  mgc: 2.28743e-10 
Matching hessian patterns... Done
outer mgc:  119.8585 
iter: 1  value: 343.8695 mgc: 32.76383 ustep: 1 
iter: 2  value: 342.0928 mgc: 3.932576 ustep: 1 
iter: 3  value: 342.0918 mgc: 0.09086622 ustep: 1 
iter: 4  value: 342.0918 mgc: 0.0001019736 ustep: 1 
iter: 5  mgc: 1.814205e-10 
iter: 1  value: 307.875 mgc: 15.68565 ustep: 1 
iter: 2  value: 307.7865 mgc: 0.8561796 ustep: 1 
iter: 3  value: 307.7865 mgc: 0.005355219 ustep: 1 
iter: 4  value: 307.7865 mgc: 3.598071e-07 ustep: 1 
iter: 5  mgc: 3.003153e-14 
iter: 1  mgc: 3.003153e-14 
outer mgc:  26.78614 
iter: 1  value: 298.9104 mgc: 2.508435 ustep: 1 
iter: 2  value: 298.9101 mgc: 0.04312433 ustep: 1 
iter: 3  value: 298.9101 mgc: 2.337897e-05 ustep: 1 
iter: 4  mgc: 9.000078e-12 
iter: 1  mgc: 9.000078e-12 
outer mgc:  29.20707 
iter: 1  value: 294.2531 mgc: 15.29701 ustep: 1 
iter: 2  value: 293.7056 mgc: 1.798331 ustep: 1 
iter: 3  value: 293.7054 mgc: 0.02809803 ustep: 1 
iter: 4  value: 293.7054 mgc: 1.235708e-05 ustep: 1 
iter: 5  mgc: 2.886746e-12 
iter: 1  mgc: 2.886746e-12 
outer mgc:  46.46931 
iter: 1  value: 283.2232 mgc: 6.627139 ustep: 1 
iter: 2  value: 283.2214 mgc: 0.1791047 ustep: 1 
iter: 3  value: 283.2214 mgc: 0.000130654 ustep: 1 
iter: 4  mgc: 6.99063e-11 
iter: 1  mgc: 6.99063e-11 
outer mgc:  14.70856 
iter: 1  value: 279.2156 mgc: 3.874161 ustep: 1 
iter: 2  value: 279.2076 mgc: 0.2015902 ustep: 1 
iter: 3  value: 279.2076 mgc: 0.0007185088 ustep: 1 
iter: 4  value: 279.2076 mgc: 1.114418e-08 ustep: 1 
mgc: 2.337019e-14 
iter: 1  mgc: 2.337019e-14 
outer mgc:  19.95821 
iter: 1  value: 274.2367 mgc: 15.27766 ustep: 1 
iter: 2  value: 272.7199 mgc: 2.930365 ustep: 1 
iter: 3  value: 272.7191 mgc: 0.07022689 ustep: 1 
iter: 4  value: 272.7191 mgc: 5.387254e-05 ustep: 1 
iter: 5  mgc: 3.184653e-11 
iter: 1  mgc: 3.184653e-11 
outer mgc:  17.85964 
iter: 1  value: 268.7644 mgc: 8.73272 ustep: 1 
iter: 2  value: 268.7004 mgc: 0.6280312 ustep: 1 
iter: 3  value: 268.7004 mgc: 0.004175466 ustep: 1 
iter: 4  value: 268.7004 mgc: 2.041051e-07 ustep: 1 
iter: 5  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  39.04511 
iter: 1  value: 261.7278 mgc: 14.61977 ustep: 1 
iter: 2  value: 260.7034 mgc: 2.128481 ustep: 1 
iter: 3  value: 260.7031 mgc: 0.03885319 ustep: 1 
iter: 4  value: 260.7031 mgc: 2.024058e-05 ustep: 1 
iter: 5  mgc: 5.50382e-12 
iter: 1  mgc: 5.50382e-12 
outer mgc:  13.22788 
iter: 1  value: 253.5776 mgc: 13.52865 ustep: 1 
iter: 2  value: 253.5179 mgc: 0.7841352 ustep: 1 
iter: 3  value: 253.5179 mgc: 0.00315973 ustep: 1 
iter: 4  value: 253.5179 mgc: 8.93024e-08 ustep: 1 
mgc: 3.397282e-14 
iter: 1  value: 252.0605 mgc: 10.2575 ustep: 1 
iter: 2  value: 252.0241 mgc: 0.5235606 ustep: 1 
iter: 3  value: 252.0241 mgc: 0.001586802 ustep: 1 
iter: 4  value: 252.0241 mgc: 2.534206e-08 ustep: 1 
mgc: 4.551914e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  8.189035 
iter: 1  value: 255.9023 mgc: 7.741167 ustep: 1 
iter: 2  value: 255.8999 mgc: 0.1596249 ustep: 1 
iter: 3  value: 255.8999 mgc: 0.000121127 ustep: 1 
iter: 4  mgc: 5.488343e-11 
iter: 1  value: 251.9544 mgc: 2.37324 ustep: 1 
iter: 2  value: 251.9543 mgc: 0.01870164 ustep: 1 
iter: 3  value: 251.9543 mgc: 1.843528e-06 ustep: 1 
iter: 4  mgc: 4.218847e-14 
iter: 1  mgc: 4.218847e-14 
outer mgc:  8.533883 
iter: 1  value: 251.1224 mgc: 4.343682 ustep: 1 
iter: 2  value: 251.1221 mgc: 0.06630635 ustep: 1 
iter: 3  value: 251.1221 mgc: 1.435868e-05 ustep: 1 
iter: 4  mgc: 7.145395e-13 
iter: 1  mgc: 7.145395e-13 
outer mgc:  17.97302 
iter: 1  value: 250.3458 mgc: 4.150064 ustep: 1 
iter: 2  value: 250.3446 mgc: 0.08205813 ustep: 1 
iter: 3  value: 250.3446 mgc: 5.168891e-05 ustep: 1 
iter: 4  mgc: 2.037392e-11 
iter: 1  mgc: 2.037392e-11 
outer mgc:  14.12496 
iter: 1  value: 249.6936 mgc: 6.55467 ustep: 1 
iter: 2  value: 249.693 mgc: 0.1431079 ustep: 1 
iter: 3  value: 249.693 mgc: 6.500187e-05 ustep: 1 
iter: 4  mgc: 1.302336e-11 
iter: 1  mgc: 1.302336e-11 
outer mgc:  5.368913 
iter: 1  value: 248.8953 mgc: 3.026987 ustep: 1 
iter: 2  value: 248.8953 mgc: 0.02489415 ustep: 1 
iter: 3  value: 248.8953 mgc: 2.719818e-06 ustep: 1 
iter: 4  mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  5.175368 
iter: 1  value: 248.6016 mgc: 0.7210514 ustep: 1 
iter: 2  value: 248.6016 mgc: 0.00138443 ustep: 1 
iter: 3  value: 248.6016 mgc: 1.820325e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  8.789807 
iter: 1  value: 248.5545 mgc: 4.94081 ustep: 1 
iter: 2  value: 248.5543 mgc: 0.07387033 ustep: 1 
iter: 3  value: 248.5543 mgc: 1.661098e-05 ustep: 1 
iter: 4  mgc: 8.739676e-13 
iter: 1  mgc: 8.739676e-13 
outer mgc:  6.347325 
iter: 1  value: 248.8459 mgc: 1.680161 ustep: 1 
iter: 2  value: 248.8458 mgc: 0.01325128 ustep: 1 
iter: 3  value: 248.8458 mgc: 8.559691e-07 ustep: 1 
iter: 4  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  1.715338 
iter: 1  value: 248.6122 mgc: 1.30228 ustep: 1 
iter: 2  value: 248.6122 mgc: 0.01419296 ustep: 1 
iter: 3  value: 248.6122 mgc: 4.506911e-07 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  2.82577 
iter: 1  value: 248.5004 mgc: 3.307446 ustep: 1 
iter: 2  value: 248.5004 mgc: 0.02274141 ustep: 1 
iter: 3  value: 248.5004 mgc: 2.16367e-06 ustep: 1 
iter: 4  mgc: 6.084022e-14 
iter: 1  value: 248.6332 mgc: 1.66714 ustep: 1 
iter: 2  value: 248.6332 mgc: 0.005999732 ustep: 1 
iter: 3  value: 248.6332 mgc: 1.665458e-07 ustep: 1 
mgc: 2.559064e-14 
iter: 1  value: 248.6051 mgc: 0.7627809 ustep: 1 
iter: 2  value: 248.6051 mgc: 0.001535163 ustep: 1 
iter: 3  value: 248.6051 mgc: 1.20318e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  1.085494 
iter: 1  value: 248.5715 mgc: 0.1757971 ustep: 1 
iter: 2  value: 248.5715 mgc: 0.0001758133 ustep: 1 
iter: 3  mgc: 2.047286e-10 
iter: 1  mgc: 2.047286e-10 
outer mgc:  0.7675552 
iter: 1  value: 248.551 mgc: 0.1775382 ustep: 1 
iter: 2  value: 248.551 mgc: 9.582189e-05 ustep: 1 
iter: 3  mgc: 5.539913e-11 
iter: 1  mgc: 5.539913e-11 
outer mgc:  0.1945889 
iter: 1  value: 248.5195 mgc: 0.1696913 ustep: 1 
iter: 2  value: 248.5195 mgc: 7.195383e-05 ustep: 1 
iter: 3  mgc: 4.666845e-11 
iter: 1  mgc: 4.666845e-11 
outer mgc:  0.2118766 
iter: 1  value: 248.5085 mgc: 0.09737403 ustep: 1 
iter: 2  value: 248.5085 mgc: 4.621603e-05 ustep: 1 
iter: 3  mgc: 9.570678e-12 
iter: 1  value: 248.5113 mgc: 0.08804231 ustep: 1 
iter: 2  value: 248.5113 mgc: 2.325064e-05 ustep: 1 
iter: 3  mgc: 4.219514e-12 
iter: 1  mgc: 4.219514e-12 
outer mgc:  0.3136055 
iter: 1  value: 248.505 mgc: 0.03180591 ustep: 1 
iter: 2  value: 248.505 mgc: 6.851553e-06 ustep: 1 
iter: 3  mgc: 3.357314e-13 
iter: 1  mgc: 3.357314e-13 
outer mgc:  0.1011127 
iter: 1  value: 248.4979 mgc: 0.07217737 ustep: 1 
iter: 2  value: 248.4979 mgc: 1.158586e-05 ustep: 1 
iter: 3  mgc: 7.723822e-13 
iter: 1  mgc: 7.723822e-13 
outer mgc:  0.09073368 
iter: 1  value: 248.4708 mgc: 0.04534732 ustep: 1 
iter: 2  value: 248.4708 mgc: 1.281678e-05 ustep: 1 
iter: 3  mgc: 1.217693e-12 
iter: 1  value: 248.4883 mgc: 0.0214513 ustep: 1 
iter: 2  value: 248.4883 mgc: 3.308757e-06 ustep: 1 
iter: 3  mgc: 7.949197e-14 
iter: 1  mgc: 7.949197e-14 
outer mgc:  0.0510078 
iter: 1  value: 248.4897 mgc: 0.02130334 ustep: 1 
iter: 2  value: 248.4897 mgc: 1.213528e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.01298369 
iter: 1  value: 248.4887 mgc: 0.01162756 ustep: 1 
iter: 2  value: 248.4887 mgc: 5.63382e-07 ustep: 1 
iter: 3  mgc: 2.697842e-14 
iter: 1  mgc: 2.697842e-14 
outer mgc:  0.01137721 
iter: 1  value: 248.4892 mgc: 0.004685915 ustep: 1 
iter: 2  value: 248.4892 mgc: 6.767792e-08 ustep: 1 
mgc: 2.098322e-14 
iter: 1  mgc: 2.098322e-14 
outer mgc:  0.006409201 
iter: 1  value: 248.4899 mgc: 0.00563922 ustep: 1 
iter: 2  value: 248.4899 mgc: 1.264315e-07 ustep: 1 
iter: 3  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  0.004559991 
iter: 1  value: 248.4893 mgc: 0.001917258 ustep: 1 
iter: 2  value: 248.4893 mgc: 2.114636e-08 ustep: 1 
mgc: 2.417511e-14 
iter: 1  mgc: 2.417511e-14 
outer mgc:  0.0004995342 
iter: 1  value: 248.4895 mgc: 0.000366028 ustep: 1 
iter: 2  mgc: 4.298299e-10 
iter: 1  mgc: 4.298299e-10 
outer mgc:  0.0001453844 
iter: 1  mgc: 4.298299e-10 
iter: 1  mgc: 4.298299e-10 
outer mgc:  0.0001453844 
iter: 1  value: 248.4885 mgc: 0.03399742 ustep: 1 
iter: 2  value: 248.4885 mgc: 5.514182e-06 ustep: 1 
iter: 3  mgc: 1.465494e-13 
outer mgc:  0.1703081 
iter: 1  value: 248.4906 mgc: 0.03397673 ustep: 1 
iter: 2  value: 248.4906 mgc: 5.515786e-06 ustep: 1 
iter: 3  mgc: 1.603162e-13 
outer mgc:  0.1701726 
iter: 1  value: 248.489 mgc: 0.01893764 ustep: 1 
iter: 2  value: 248.489 mgc: 1.692882e-06 ustep: 1 
iter: 3  mgc: 4.007905e-14 
outer mgc:  0.1732205 
iter: 1  value: 248.4901 mgc: 0.0189264 ustep: 1 
iter: 2  value: 248.4901 mgc: 1.692452e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.1730576 
iter: 1  value: 248.4904 mgc: 0.05403004 ustep: 1 
iter: 2  value: 248.4904 mgc: 7.060404e-06 ustep: 1 
iter: 3  mgc: 1.603162e-13 
outer mgc:  0.1376815 
iter: 1  value: 248.4886 mgc: 0.05403507 ustep: 1 
iter: 2  value: 248.4886 mgc: 7.070296e-06 ustep: 1 
iter: 3  mgc: 1.487699e-13 
outer mgc:  0.1375138 
iter: 1  value: 248.4903 mgc: 0.02854429 ustep: 1 
iter: 2  value: 248.4903 mgc: 2.075466e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.2780302 
iter: 1  value: 248.4888 mgc: 0.02854871 ustep: 1 
iter: 2  value: 248.4888 mgc: 2.076612e-06 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.2780274 
iter: 1  value: 248.4862 mgc: 0.005678208 ustep: 1 
iter: 2  value: 248.4862 mgc: 1.490952e-07 ustep: 1 
mgc: 1.865175e-14 
outer mgc:  0.005572754 
iter: 1  value: 248.4927 mgc: 0.00567452 ustep: 1 
iter: 2  value: 248.4927 mgc: 1.490878e-07 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.005382772 
iter: 1  value: 248.4961 mgc: 0.01338571 ustep: 1 
iter: 2  value: 248.4961 mgc: 1.347502e-06 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.04264418 
iter: 1  value: 248.4828 mgc: 0.01341603 ustep: 1 
iter: 2  value: 248.4828 mgc: 1.349356e-06 ustep: 1 
iter: 3  mgc: 1.820766e-14 
outer mgc:  0.04236229 
iter: 1  value: 248.4913 mgc: 0.0147253 ustep: 1 
iter: 2  value: 248.4913 mgc: 4.543089e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.05852274 
iter: 1  value: 248.4876 mgc: 0.01476145 ustep: 1 
iter: 2  value: 248.4876 mgc: 4.564245e-07 ustep: 1 
iter: 3  mgc: 2.264855e-14 
outer mgc:  0.05880853 
[Mon Aug 16 07:14:41 2021]
Finished job 0.
1 of 1 steps (100%) done

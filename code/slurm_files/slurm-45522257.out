Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:16:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21841.510911 
final  value 19864.559830 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18970.03 mgc: 3.350015 ustep: 1 
iter: 2  value: 18968.15 mgc: 0.8628987 ustep: 1 
iter: 3  value: 18968.13 mgc: 0.1537038 ustep: 1 
iter: 4  value: 18968.13 mgc: 0.00339812 ustep: 1 
iter: 5  value: 18968.13 mgc: 1.033105e-06 ustep: 1 
iter: 6  mgc: 2.506884e-13 
iter: 1  mgc: 2.506884e-13 
Matching hessian patterns... Done
outer mgc:  88.01535 
iter: 1  value: 18775.91 mgc: 1.464709 ustep: 1 
iter: 2  value: 18775.82 mgc: 0.269881 ustep: 1 
iter: 3  value: 18775.82 mgc: 0.007494012 ustep: 1 
iter: 4  value: 18775.82 mgc: 6.424832e-06 ustep: 1 
iter: 5  mgc: 4.688472e-12 
iter: 1  value: 18812.8 mgc: 42.75807 ustep: 1 
iter: 2  value: 18747.54 mgc: 12.19394 ustep: 1 
iter: 3  value: 18747.24 mgc: 2.423539 ustep: 1 
iter: 4  value: 18747.24 mgc: 0.1037088 ustep: 1 
iter: 5  value: 18747.24 mgc: 0.0001770831 ustep: 1 
iter: 6  mgc: 5.816343e-10 
iter: 1  mgc: 4.688472e-12 
outer mgc:  75.64629 
iter: 1  value: 18561.42 mgc: 10.06446 ustep: 1 
iter: 2  value: 18551.34 mgc: 2.443856 ustep: 1 
iter: 3  value: 18551.32 mgc: 0.1756394 ustep: 1 
iter: 4  value: 18551.32 mgc: 0.002659962 ustep: 1 
iter: 5  value: 18551.32 mgc: 4.458112e-07 ustep: 1 
iter: 6  mgc: 1.054712e-14 
iter: 1  mgc: 1.054712e-14 
outer mgc:  138.5239 
iter: 1  value: 18898.39 mgc: 47.37181 ustep: 1 
iter: 2  value: 18828.55 mgc: 7.146699 ustep: 1 
iter: 3  value: 18826.85 mgc: 3.37729 ustep: 1 
iter: 4  value: 18826.85 mgc: 0.1343599 ustep: 1 
iter: 5  value: 18826.85 mgc: 8.507643e-05 ustep: 1 
iter: 6  mgc: 7.116085e-12 
iter: 1  value: 18509.12 mgc: 3.033429 ustep: 1 
iter: 2  value: 18509.11 mgc: 0.08383335 ustep: 1 
iter: 3  value: 18509.11 mgc: 0.0002790753 ustep: 1 
iter: 4  mgc: 8.74596e-10 
iter: 1  mgc: 8.74596e-10 
outer mgc:  98.22577 
iter: 1  value: 18481.6 mgc: 2.562363 ustep: 1 
iter: 2  value: 18481.5 mgc: 0.1630105 ustep: 1 
iter: 3  value: 18481.5 mgc: 0.001189551 ustep: 1 
iter: 4  value: 18481.5 mgc: 5.22246e-08 ustep: 1 
iter: 5  mgc: 6.328271e-15 
iter: 1  mgc: 6.328271e-15 
outer mgc:  59.81846 
iter: 1  value: 18436.48 mgc: 3.109657 ustep: 1 
iter: 2  value: 18436.47 mgc: 0.1214207 ustep: 1 
iter: 3  value: 18436.47 mgc: 8.912862e-05 ustep: 1 
iter: 4  mgc: 4.783807e-10 
iter: 1  mgc: 4.783807e-10 
outer mgc:  71.83794 
iter: 1  value: 18394.52 mgc: 6.436629 ustep: 1 
iter: 2  value: 18394.52 mgc: 0.04415802 ustep: 1 
iter: 3  value: 18394.52 mgc: 0.0001153135 ustep: 1 
iter: 4  mgc: 8.403434e-11 
iter: 1  mgc: 8.403434e-11 
outer mgc:  48.29984 
iter: 1  value: 18364.2 mgc: 3.886167 ustep: 1 
iter: 2  value: 18364.2 mgc: 0.04054587 ustep: 1 
iter: 3  value: 18364.2 mgc: 1.650131e-05 ustep: 1 
iter: 4  mgc: 4.3614e-12 
iter: 1  mgc: 4.3614e-12 
outer mgc:  26.06697 
iter: 1  value: 18316.62 mgc: 1.665707 ustep: 1 
iter: 2  value: 18316.62 mgc: 0.007750414 ustep: 1 
iter: 3  value: 18316.62 mgc: 1.441787e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  31.42325 
iter: 1  value: 18360.26 mgc: 4.681895 ustep: 1 
iter: 2  value: 18360.26 mgc: 0.01698763 ustep: 1 
iter: 3  value: 18360.26 mgc: 8.549148e-07 ustep: 1 
iter: 4  mgc: 6.277964e-15 
iter: 1  value: 18315.84 mgc: 0.6751846 ustep: 1 
iter: 2  value: 18315.84 mgc: 0.0004431967 ustep: 1 
iter: 3  mgc: 3.691314e-10 
iter: 1  mgc: 3.691314e-10 
outer mgc:  14.74621 
iter: 1  value: 18311.32 mgc: 0.8238679 ustep: 1 
iter: 2  value: 18311.32 mgc: 0.0004261758 ustep: 1 
iter: 3  mgc: 1.182393e-09 
iter: 1  mgc: 1.182393e-09 
outer mgc:  12.18389 
iter: 1  value: 18298 mgc: 1.914259 ustep: 1 
iter: 2  value: 18298 mgc: 0.002459869 ustep: 1 
iter: 3  value: 18298 mgc: 4.416566e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  8.490935 
iter: 1  value: 18284.85 mgc: 1.447662 ustep: 1 
iter: 2  value: 18284.85 mgc: 0.001652074 ustep: 1 
iter: 3  value: 18284.85 mgc: 1.058065e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  10.82175 
iter: 1  value: 18283.1 mgc: 0.3795137 ustep: 1 
iter: 2  value: 18283.1 mgc: 6.429984e-05 ustep: 1 
iter: 3  mgc: 1.757705e-11 
iter: 1  value: 18283.75 mgc: 0.1861998 ustep: 1 
iter: 2  value: 18283.75 mgc: 1.529111e-05 ustep: 1 
iter: 3  mgc: 1.119993e-12 
iter: 1  mgc: 1.119993e-12 
outer mgc:  10.16303 
iter: 1  value: 18281.96 mgc: 0.396806 ustep: 1 
iter: 2  value: 18281.96 mgc: 6.907533e-05 ustep: 1 
iter: 3  mgc: 7.559398e-12 
iter: 1  mgc: 7.559398e-12 
outer mgc:  7.769112 
iter: 1  value: 18277.96 mgc: 0.4900252 ustep: 1 
iter: 2  value: 18277.96 mgc: 5.385879e-05 ustep: 1 
iter: 3  mgc: 1.551737e-11 
iter: 1  mgc: 1.551737e-11 
outer mgc:  2.506892 
iter: 1  value: 18268.21 mgc: 0.8891356 ustep: 1 
iter: 2  value: 18268.21 mgc: 0.0004902586 ustep: 1 
iter: 3  mgc: 7.698489e-10 
iter: 1  value: 18258.14 mgc: 0.9591611 ustep: 1 
iter: 2  value: 18258.14 mgc: 0.000358203 ustep: 1 
iter: 3  mgc: 4.054457e-10 
iter: 1  mgc: 4.054457e-10 
outer mgc:  2.975659 
iter: 1  value: 18238.62 mgc: 1.592558 ustep: 1 
iter: 2  value: 18238.62 mgc: 0.001298688 ustep: 1 
iter: 3  mgc: 1.376095e-09 
iter: 1  mgc: 1.376095e-09 
outer mgc:  3.621597 
iter: 1  value: 18219.8 mgc: 1.619612 ustep: 1 
iter: 2  value: 18219.8 mgc: 0.001472578 ustep: 1 
iter: 3  mgc: 5.112347e-10 
iter: 1  mgc: 5.112347e-10 
outer mgc:  2.081404 
iter: 1  value: 18201.86 mgc: 1.56874 ustep: 1 
iter: 2  value: 18201.86 mgc: 0.0006684725 ustep: 1 
iter: 3  mgc: 2.38644e-10 
iter: 1  mgc: 2.38644e-10 
outer mgc:  3.216162 
iter: 1  value: 18185.3 mgc: 5.338462 ustep: 1 
iter: 2  value: 18185.3 mgc: 0.0002518354 ustep: 1 
iter: 3  mgc: 5.336087e-11 
iter: 1  mgc: 5.336087e-11 
outer mgc:  4.452637 
iter: 1  value: 18168.34 mgc: 4.821989 ustep: 1 
iter: 2  value: 18168.34 mgc: 0.0001183312 ustep: 1 
iter: 3  mgc: 1.259526e-11 
iter: 1  mgc: 1.259526e-11 
outer mgc:  3.155332 
iter: 1  value: 18148.86 mgc: 1.83909 ustep: 1 
iter: 2  value: 18148.86 mgc: 0.0005017429 ustep: 1 
iter: 3  mgc: 2.345546e-11 
iter: 1  mgc: 2.345546e-11 
outer mgc:  2.251859 
iter: 1  value: 18133.27 mgc: 4.586352 ustep: 1 
iter: 2  value: 18133.27 mgc: 0.0004279458 ustep: 1 
iter: 3  mgc: 2.079159e-11 
iter: 1  mgc: 2.079159e-11 
outer mgc:  1.791681 
iter: 1  value: 18121.37 mgc: 3.433542 ustep: 1 
iter: 2  value: 18121.37 mgc: 2.114262e-05 ustep: 1 
iter: 3  mgc: 3.261835e-13 
iter: 1  mgc: 3.261835e-13 
outer mgc:  0.4613153 
iter: 1  value: 18109.9 mgc: 1.885898 ustep: 1 
iter: 2  value: 18109.9 mgc: 2.370263e-05 ustep: 1 
iter: 3  mgc: 1.469935e-13 
iter: 1  mgc: 1.469935e-13 
outer mgc:  0.2289426 
iter: 1  value: 18099.03 mgc: 1.327351 ustep: 1 
iter: 2  value: 18099.03 mgc: 2.449413e-05 ustep: 1 
iter: 3  mgc: 6.628031e-14 
iter: 1  mgc: 6.628031e-14 
outer mgc:  0.1920324 
iter: 1  value: 18081.72 mgc: 1.954406 ustep: 1 
iter: 2  value: 18081.72 mgc: 5.159144e-05 ustep: 1 
iter: 3  mgc: 1.683098e-13 
iter: 1  mgc: 1.683098e-13 
outer mgc:  0.04616199 
iter: 1  value: 18072.94 mgc: 0.7775125 ustep: 1 
iter: 2  value: 18072.94 mgc: 8.735718e-06 ustep: 1 
iter: 3  mgc: 1.407208e-14 
iter: 1  mgc: 1.407208e-14 
outer mgc:  0.04162309 
iter: 1  value: 18061.59 mgc: 1.08667 ustep: 1 
iter: 2  value: 18061.59 mgc: 7.839462e-06 ustep: 1 
iter: 3  mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  0.08365819 
iter: 1  value: 18048.82 mgc: 1.670663 ustep: 1 
iter: 2  value: 18048.82 mgc: 1.913636e-06 ustep: 1 
iter: 3  mgc: 3.4861e-14 
iter: 1  mgc: 3.4861e-14 
outer mgc:  0.1051908 
iter: 1  value: 18034.77 mgc: 4.383622 ustep: 1 
iter: 2  value: 18034.77 mgc: 9.524538e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.1089918 
iter: 1  value: 18027.46 mgc: 13.82186 ustep: 1 
iter: 2  value: 18027.46 mgc: 0.0002853217 ustep: 1 
iter: 3  mgc: 1.512024e-11 
iter: 1  mgc: 1.512024e-11 
outer mgc:  0.09284294 
iter: 1  value: 18033.83 mgc: 19.30179 ustep: 1 
iter: 2  value: 18033.83 mgc: 0.001101984 ustep: 1 
iter: 3  mgc: 4.160201e-10 
iter: 1  mgc: 4.160201e-10 
outer mgc:  0.2104833 
iter: 1  value: 18025.76 mgc: 17.32003 ustep: 1 
iter: 2  value: 18025.76 mgc: 0.0001938321 ustep: 1 
iter: 3  mgc: 1.308909e-11 
iter: 1  mgc: 1.308909e-11 
outer mgc:  0.03075757 
iter: 1  value: 18023.18 mgc: 0.5627136 ustep: 1 
iter: 2  value: 18023.18 mgc: 4.447444e-06 ustep: 1 
iter: 3  mgc: 9.037215e-14 
iter: 1  mgc: 9.037215e-14 
outer mgc:  0.0290485 
iter: 1  value: 18011.34 mgc: 1.621136 ustep: 1 
iter: 2  value: 18011.34 mgc: 1.34205e-05 ustep: 1 
iter: 3  mgc: 1.836309e-13 
iter: 1  mgc: 1.836309e-13 
outer mgc:  0.02290033 
iter: 1  value: 17998.26 mgc: 1.579429 ustep: 1 
iter: 2  value: 17998.26 mgc: 5.122274e-08 ustep: 1 
mgc: 2.14273e-13 
iter: 1  mgc: 2.14273e-13 
outer mgc:  0.02284043 
iter: 1  value: 17974.37 mgc: 4.372453 ustep: 1 
iter: 2  value: 17974.37 mgc: 4.913464e-06 ustep: 1 
iter: 3  mgc: 2.380318e-13 
iter: 1  mgc: 2.380318e-13 
outer mgc:  0.02008974 
iter: 1  value: 17954.66 mgc: 3.423078 ustep: 1 
iter: 2  value: 17954.66 mgc: 3.503056e-06 ustep: 1 
iter: 3  mgc: 5.111467e-13 
iter: 1  mgc: 5.111467e-13 
outer mgc:  0.007383945 
iter: 1  value: 17938.8 mgc: 4.24543 ustep: 1 
iter: 2  value: 17938.8 mgc: 5.361941e-07 ustep: 1 
mgc: 6.924183e-13 
iter: 1  mgc: 6.924183e-13 
outer mgc:  0.004351923 
iter: 1  value: 17918.13 mgc: 2.985136 ustep: 1 
iter: 2  value: 17918.13 mgc: 1.131401e-08 ustep: 1 
mgc: 8.739676e-13 
iter: 1  mgc: 8.739676e-13 
outer mgc:  0.008686744 
iter: 1  value: 17901.57 mgc: 3.032346 ustep: 1 
iter: 2  value: 17901.57 mgc: 2.30627e-07 ustep: 1 
mgc: 1.481482e-12 
iter: 1  mgc: 1.481482e-12 
outer mgc:  0.004603156 
iter: 1  value: 17880.81 mgc: 5.304137 ustep: 1 
iter: 2  value: 17880.81 mgc: 5.341346e-07 ustep: 1 
iter: 3  mgc: 2.131184e-12 
iter: 1  mgc: 2.131184e-12 
outer mgc:  0.004668159 
iter: 1  value: 17863.58 mgc: 3.933469 ustep: 1 
iter: 2  value: 17863.58 mgc: 1.616128e-07 ustep: 1 
mgc: 3.084644e-12 
iter: 1  mgc: 3.084644e-12 
outer mgc:  0.002585284 
iter: 1  value: 17843.51 mgc: 5.246377 ustep: 1 
iter: 2  mgc: 8.173727e-09 
iter: 1  mgc: 8.173727e-09 
outer mgc:  0.00447232 
iter: 1  value: 17826.66 mgc: 9.078754 ustep: 1 
iter: 2  value: 17826.66 mgc: 1.367941e-08 ustep: 1 
mgc: 7.192913e-12 
iter: 1  mgc: 7.192913e-12 
outer mgc:  0.002113695 
iter: 1  value: 17805.16 mgc: 2.845371 ustep: 1 
iter: 2  value: 17805.16 mgc: 5.640268e-08 ustep: 1 
mgc: 1.007783e-11 
iter: 1  mgc: 1.007783e-11 
outer mgc:  0.002192302 
iter: 1  value: 17787.53 mgc: 13.45212 ustep: 1 
iter: 2  value: 17787.53 mgc: 1.351058e-08 ustep: 1 
mgc: 1.305522e-11 
iter: 1  mgc: 1.305522e-11 
outer mgc:  0.001173649 
iter: 1  value: 17766.97 mgc: 5.69666 ustep: 1 
iter: 2  mgc: 1.28634e-09 
iter: 1  mgc: 1.28634e-09 
outer mgc:  0.001093003 
iter: 1  value: 17750 mgc: 7.172319 ustep: 1 
iter: 2  mgc: 2.299748e-09 
iter: 1  mgc: 2.299748e-09 
outer mgc:  0.0006517224 
iter: 1  mgc: 2.299748e-09 
iter: 1  mgc: 2.299748e-09 
outer mgc:  0.0006517224 
iter: 1  value: 17750 mgc: 0.005555355 ustep: 1 
iter: 2  mgc: 1.532188e-09 
outer mgc:  0.4973667 
iter: 1  value: 17750 mgc: 0.005555118 ustep: 1 
iter: 2  mgc: 1.51141e-09 
outer mgc:  0.4984302 
iter: 1  value: 17750 mgc: 0.002896216 ustep: 1 
iter: 2  mgc: 1.628032e-09 
outer mgc:  0.2492161 
iter: 1  value: 17750 mgc: 0.002895937 ustep: 1 
iter: 2  mgc: 1.636182e-09 
outer mgc:  0.2496994 
iter: 1  value: 17750 mgc: 0.005375044 ustep: 1 
iter: 2  mgc: 7.945159e-09 
outer mgc:  0.3637415 
iter: 1  value: 17750 mgc: 0.005373068 ustep: 1 
iter: 2  mgc: 7.947247e-09 
outer mgc:  0.3630898 
iter: 1  value: 17750 mgc: 0.002621732 ustep: 1 
iter: 2  mgc: 2.091554e-09 
outer mgc:  0.147059 
iter: 1  value: 17750 mgc: 0.002620417 ustep: 1 
iter: 2  mgc: 2.090429e-09 
outer mgc:  0.1473217 
iter: 1  value: 17750.1 mgc: 114.4754 ustep: 1 
iter: 2  mgc: 6.854346e-09 
outer mgc:  0.001508706 
iter: 1  value: 17749.9 mgc: 114.8194 ustep: 1 
iter: 2  mgc: 6.838492e-09 
outer mgc:  0.0009820109 
iter: 1  value: 17750.09 mgc: 114.5887 ustep: 1 
iter: 2  value: 17750.09 mgc: 3.395866e-08 ustep: 1 
mgc: 3.429701e-11 
outer mgc:  0.005080678 
iter: 1  value: 17749.91 mgc: 114.7033 ustep: 1 
iter: 2  value: 17749.91 mgc: 3.38032e-08 ustep: 1 
mgc: 2.890349e-11 
outer mgc:  0.006373727 
iter: 1  value: 17750 mgc: 9.053975e-05 ustep: 1 
mgc: 2.458167e-11 
outer mgc:  0.0006517235 
iter: 1  value: 17750 mgc: 9.053964e-05 ustep: 1 
mgc: 2.53173e-11 
outer mgc:  0.0006517213 
iter: 1  value: 17750 mgc: 0.004223532 ustep: 1 
iter: 2  mgc: 7.256651e-09 
outer mgc:  0.1719187 
iter: 1  value: 17750 mgc: 0.004220002 ustep: 1 
iter: 2  mgc: 7.211425e-09 
outer mgc:  0.1705569 
[Fri Aug 13 12:16:51 2021]
Finished job 0.
1 of 1 steps (100%) done

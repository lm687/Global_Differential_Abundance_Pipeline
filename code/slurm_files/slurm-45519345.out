Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:33:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4476.845076 
iter  10 value 4120.260497
iter  10 value 4120.260497
final  value 4120.260497 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 607.4653 mgc: 91.2534 ustep: 1 
iter: 2  value: 536.5566 mgc: 23.47648 ustep: 1 
iter: 3  value: 533.9247 mgc: 9.397548 ustep: 1 
iter: 4  value: 533.9201 mgc: 0.3020413 ustep: 1 
iter: 5  value: 533.9201 mgc: 0.002201011 ustep: 1 
iter: 6  value: 533.9201 mgc: 2.026851e-07 ustep: 1 
iter: 7  mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
Matching hessian patterns... Done
outer mgc:  101.5624 
iter: 1  value: 451.7635 mgc: 18.06905 ustep: 1 
iter: 2  value: 451.4508 mgc: 1.111428 ustep: 1 
iter: 3  value: 451.4508 mgc: 0.01620966 ustep: 1 
iter: 4  value: 451.4508 mgc: 3.194028e-06 ustep: 1 
iter: 5  mgc: 1.935119e-13 
iter: 1  mgc: 1.935119e-13 
outer mgc:  43.72964 
iter: 1  value: 469.0515 mgc: 11.89616 ustep: 1 
iter: 2  value: 469.0011 mgc: 0.5577168 ustep: 1 
iter: 3  value: 469.0011 mgc: 0.003800339 ustep: 1 
iter: 4  value: 469.0011 mgc: 5.409671e-07 ustep: 1 
iter: 5  mgc: 2.753353e-14 
iter: 1  value: 442.5946 mgc: 3.883401 ustep: 1 
iter: 2  value: 442.5941 mgc: 0.07125846 ustep: 1 
iter: 3  value: 442.5941 mgc: 3.995816e-05 ustep: 1 
iter: 4  mgc: 6.364287e-11 
iter: 1  mgc: 6.364287e-11 
outer mgc:  30.71475 
iter: 1  value: 441.9905 mgc: 16.66215 ustep: 1 
iter: 2  value: 441.7025 mgc: 1.444846 ustep: 1 
iter: 3  value: 441.7025 mgc: 0.0162796 ustep: 1 
iter: 4  value: 441.7025 mgc: 3.838758e-06 ustep: 1 
iter: 5  mgc: 5.796474e-13 
iter: 1  mgc: 5.796474e-13 
outer mgc:  45.26117 
iter: 1  value: 430.574 mgc: 6.359841 ustep: 1 
iter: 2  value: 430.5688 mgc: 0.2119944 ustep: 1 
iter: 3  value: 430.5688 mgc: 0.000370407 ustep: 1 
iter: 4  mgc: 5.186773e-09 
iter: 1  mgc: 5.186773e-09 
outer mgc:  11.36736 
iter: 1  value: 431.5019 mgc: 30.88308 ustep: 1 
iter: 2  value: 419.0787 mgc: 9.890126 ustep: 1 
iter: 3  value: 419.027 mgc: 0.563833 ustep: 1 
iter: 4  value: 419.027 mgc: 0.004430633 ustep: 1 
iter: 5  value: 419.027 mgc: 6.716153e-07 ustep: 1 
iter: 6  mgc: 4.096723e-14 
iter: 1  mgc: 4.096723e-14 
outer mgc:  40.59682 
iter: 1  value: 424.1526 mgc: 38.78742 ustep: 1 
iter: 2  value: 418.245 mgc: 7.754098 ustep: 1 
iter: 3  value: 418.2352 mgc: 0.3174536 ustep: 1 
iter: 4  value: 418.2352 mgc: 0.001432084 ustep: 1 
iter: 5  value: 418.2352 mgc: 2.928819e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  value: 401.7843 mgc: 15.38546 ustep: 1 
iter: 2  value: 401.6114 mgc: 1.068452 ustep: 1 
iter: 3  value: 401.6114 mgc: 0.01911719 ustep: 1 
iter: 4  value: 401.6114 mgc: 9.197167e-06 ustep: 1 
iter: 5  mgc: 2.129408e-12 
iter: 1  mgc: 2.129408e-12 
outer mgc:  9.255742 
iter: 1  value: 398.7086 mgc: 9.869563 ustep: 1 
iter: 2  value: 398.7051 mgc: 0.3555084 ustep: 1 
iter: 3  value: 398.7051 mgc: 0.0005574829 ustep: 1 
iter: 4  mgc: 4.405425e-09 
iter: 1  mgc: 4.405425e-09 
outer mgc:  14.75104 
iter: 1  value: 403.3027 mgc: 17.87026 ustep: 1 
iter: 2  value: 403.1685 mgc: 1.14645 ustep: 1 
iter: 3  value: 403.1685 mgc: 0.007299324 ustep: 1 
iter: 4  value: 403.1685 mgc: 3.475787e-07 ustep: 1 
iter: 5  mgc: 3.563816e-14 
iter: 1  value: 397.9255 mgc: 6.372394 ustep: 1 
iter: 2  value: 397.9238 mgc: 0.1214587 ustep: 1 
iter: 3  value: 397.9238 mgc: 7.827102e-05 ustep: 1 
iter: 4  mgc: 3.925685e-11 
iter: 1  mgc: 3.925685e-11 
outer mgc:  12.73967 
iter: 1  value: 397.7505 mgc: 5.369675 ustep: 1 
iter: 2  value: 397.7499 mgc: 0.07073554 ustep: 1 
iter: 3  value: 397.7499 mgc: 3.357024e-05 ustep: 1 
iter: 4  mgc: 1.516032e-11 
iter: 1  mgc: 1.516032e-11 
outer mgc:  16.26476 
iter: 1  value: 397.1145 mgc: 3.728401 ustep: 1 
iter: 2  value: 397.1142 mgc: 0.03875479 ustep: 1 
iter: 3  value: 397.1142 mgc: 9.667862e-06 ustep: 1 
iter: 4  mgc: 6.699086e-13 
iter: 1  mgc: 6.699086e-13 
outer mgc:  3.836717 
iter: 1  value: 397.0546 mgc: 1.095722 ustep: 1 
iter: 2  value: 397.0545 mgc: 0.01796467 ustep: 1 
iter: 3  value: 397.0545 mgc: 6.281296e-06 ustep: 1 
iter: 4  mgc: 7.66498e-13 
iter: 1  mgc: 7.66498e-13 
outer mgc:  4.526814 
iter: 1  value: 396.7656 mgc: 1.303261 ustep: 1 
iter: 2  value: 396.7656 mgc: 0.01424106 ustep: 1 
iter: 3  value: 396.7656 mgc: 3.95543e-06 ustep: 1 
iter: 4  mgc: 3.006484e-13 
iter: 1  mgc: 3.006484e-13 
outer mgc:  1.45219 
iter: 1  value: 396.8933 mgc: 2.217996 ustep: 1 
iter: 2  value: 396.8933 mgc: 0.01632519 ustep: 1 
iter: 3  value: 396.8933 mgc: 1.573325e-06 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  1.921349 
iter: 1  value: 396.9723 mgc: 2.998154 ustep: 1 
iter: 2  value: 396.9721 mgc: 0.03654829 ustep: 1 
iter: 3  value: 396.9721 mgc: 8.819862e-06 ustep: 1 
iter: 4  mgc: 5.87419e-13 
iter: 1  value: 396.8429 mgc: 1.032693 ustep: 1 
iter: 2  value: 396.8429 mgc: 0.004519267 ustep: 1 
iter: 3  value: 396.8429 mgc: 1.357336e-07 ustep: 1 
mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  2.127948 
iter: 1  value: 396.8428 mgc: 0.5987031 ustep: 1 
iter: 2  value: 396.8428 mgc: 0.001308458 ustep: 1 
iter: 3  mgc: 6.800244e-09 
iter: 1  mgc: 6.800244e-09 
outer mgc:  1.772458 
iter: 1  value: 396.8092 mgc: 0.3569624 ustep: 1 
iter: 2  value: 396.8092 mgc: 0.0004879251 ustep: 1 
iter: 3  mgc: 1.403191e-09 
iter: 1  mgc: 1.403191e-09 
outer mgc:  0.71579 
iter: 1  value: 396.7992 mgc: 0.3991957 ustep: 1 
iter: 2  value: 396.7992 mgc: 0.0005617452 ustep: 1 
iter: 3  mgc: 1.943424e-09 
iter: 1  mgc: 1.943424e-09 
outer mgc:  0.8908072 
iter: 1  value: 396.7661 mgc: 0.2289908 ustep: 1 
iter: 2  value: 396.7661 mgc: 0.0004672784 ustep: 1 
iter: 3  mgc: 4.515917e-09 
iter: 1  mgc: 4.515917e-09 
outer mgc:  0.2711932 
iter: 1  value: 396.7973 mgc: 0.7462116 ustep: 1 
iter: 2  value: 396.7973 mgc: 0.001741944 ustep: 1 
iter: 3  value: 396.7973 mgc: 2.058414e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  value: 396.7706 mgc: 0.1994234 ustep: 1 
iter: 2  value: 396.7706 mgc: 0.0001254885 ustep: 1 
iter: 3  mgc: 1.051372e-10 
iter: 1  mgc: 1.051372e-10 
outer mgc:  0.3274142 
iter: 1  value: 396.7746 mgc: 0.2239622 ustep: 1 
iter: 2  value: 396.7746 mgc: 0.0001442973 ustep: 1 
iter: 3  mgc: 8.683809e-11 
iter: 1  mgc: 8.683809e-11 
outer mgc:  0.4263345 
iter: 1  value: 396.7729 mgc: 0.1427342 ustep: 1 
iter: 2  value: 396.7729 mgc: 0.0001018493 ustep: 1 
iter: 3  mgc: 7.14393e-11 
iter: 1  value: 396.7732 mgc: 0.1006519 ustep: 1 
iter: 2  value: 396.7732 mgc: 5.019227e-05 ustep: 1 
iter: 3  mgc: 1.918196e-11 
iter: 1  mgc: 1.918196e-11 
outer mgc:  0.1478818 
iter: 1  value: 396.7779 mgc: 0.0483469 ustep: 1 
iter: 2  value: 396.7779 mgc: 1.555389e-05 ustep: 1 
iter: 3  mgc: 2.734257e-12 
iter: 1  mgc: 2.734257e-12 
outer mgc:  0.04235168 
iter: 1  value: 396.786 mgc: 0.04347012 ustep: 1 
iter: 2  value: 396.786 mgc: 8.277538e-06 ustep: 1 
iter: 3  mgc: 2.913225e-13 
iter: 1  mgc: 2.913225e-13 
outer mgc:  0.04237762 
iter: 1  value: 396.7833 mgc: 0.05807886 ustep: 1 
iter: 2  value: 396.7833 mgc: 8.963393e-06 ustep: 1 
iter: 3  mgc: 3.561595e-13 
iter: 1  value: 396.7845 mgc: 0.03120011 ustep: 1 
iter: 2  value: 396.7845 mgc: 3.233024e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  0.03898092 
iter: 1  value: 396.7832 mgc: 0.01118953 ustep: 1 
iter: 2  value: 396.7832 mgc: 3.748765e-07 ustep: 1 
iter: 3  mgc: 1.84297e-14 
iter: 1  mgc: 1.84297e-14 
outer mgc:  0.03013171 
iter: 1  value: 396.7828 mgc: 0.005194371 ustep: 1 
iter: 2  value: 396.7828 mgc: 3.008898e-07 ustep: 1 
iter: 3  mgc: 4.662937e-14 
iter: 1  mgc: 4.662937e-14 
outer mgc:  0.01284798 
iter: 1  value: 396.7826 mgc: 0.0091941 ustep: 1 
iter: 2  value: 396.7826 mgc: 2.50076e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.01402146 
iter: 1  value: 396.7826 mgc: 0.002548436 ustep: 1 
iter: 2  value: 396.7826 mgc: 2.588239e-08 ustep: 1 
mgc: 3.075318e-14 
iter: 1  mgc: 3.075318e-14 
outer mgc:  0.004409615 
iter: 1  value: 396.7827 mgc: 0.001726497 ustep: 1 
iter: 2  mgc: 7.696491e-09 
iter: 1  mgc: 7.696491e-09 
outer mgc:  0.003136403 
iter: 1  value: 396.7826 mgc: 0.0008933714 ustep: 1 
iter: 2  mgc: 2.116505e-09 
iter: 1  mgc: 2.116505e-09 
outer mgc:  3.688982e-05 
iter: 1  value: 396.7826 mgc: 4.806578e-05 ustep: 1 
iter: 2  mgc: 9.554579e-12 
iter: 1  mgc: 9.554579e-12 
outer mgc:  2.574666e-05 
iter: 1  mgc: 9.554579e-12 
iter: 1  mgc: 9.554579e-12 
outer mgc:  2.574666e-05 
iter: 1  value: 396.7832 mgc: 0.05437802 ustep: 1 
iter: 2  value: 396.7832 mgc: 7.13597e-06 ustep: 1 
iter: 3  mgc: 2.247091e-13 
outer mgc:  0.08810269 
iter: 1  value: 396.7822 mgc: 0.05438272 ustep: 1 
iter: 2  value: 396.7822 mgc: 7.145211e-06 ustep: 1 
iter: 3  mgc: 2.335909e-13 
outer mgc:  0.08812426 
iter: 1  value: 396.7835 mgc: 0.02806189 ustep: 1 
iter: 2  value: 396.7835 mgc: 2.501113e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.2590646 
iter: 1  value: 396.782 mgc: 0.02806623 ustep: 1 
iter: 2  value: 396.782 mgc: 2.502788e-06 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.2591304 
iter: 1  value: 396.7821 mgc: 0.04401803 ustep: 1 
iter: 2  value: 396.7821 mgc: 8.52565e-06 ustep: 1 
iter: 3  mgc: 5.751788e-13 
outer mgc:  0.06482193 
iter: 1  value: 396.7832 mgc: 0.04400646 ustep: 1 
iter: 2  value: 396.7832 mgc: 8.534516e-06 ustep: 1 
iter: 3  mgc: 5.772605e-13 
outer mgc:  0.06477514 
iter: 1  value: 396.7825 mgc: 0.0245952 ustep: 1 
iter: 2  value: 396.7825 mgc: 2.673764e-06 ustep: 1 
iter: 3  mgc: 6.479539e-14 
outer mgc:  0.1545317 
iter: 1  value: 396.7829 mgc: 0.02458999 ustep: 1 
iter: 2  value: 396.7829 mgc: 2.675036e-06 ustep: 1 
iter: 3  mgc: 5.939693e-14 
outer mgc:  0.1544836 
iter: 1  value: 396.7813 mgc: 0.005598867 ustep: 1 
iter: 2  value: 396.7813 mgc: 3.984378e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.01378325 
iter: 1  value: 396.784 mgc: 0.00559288 ustep: 1 
iter: 2  value: 396.784 mgc: 3.97839e-07 ustep: 1 
iter: 3  mgc: 2.287059e-14 
outer mgc:  0.01377655 
iter: 1  value: 396.7845 mgc: 0.00926407 ustep: 1 
iter: 2  value: 396.7845 mgc: 3.771695e-07 ustep: 1 
iter: 3  mgc: 2.342571e-14 
outer mgc:  0.03961122 
iter: 1  value: 396.7808 mgc: 0.009282381 ustep: 1 
iter: 2  value: 396.7808 mgc: 3.782898e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.03966864 
iter: 1  value: 396.7855 mgc: 0.008860697 ustep: 1 
iter: 2  value: 396.7855 mgc: 1.625325e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  0.0355608 
iter: 1  value: 396.7798 mgc: 0.008880748 ustep: 1 
iter: 2  value: 396.7798 mgc: 1.630131e-06 ustep: 1 
iter: 3  mgc: 5.639933e-14 
outer mgc:  0.03560234 
[Fri Aug 13 11:33:05 2021]
Finished job 0.
1 of 1 steps (100%) done

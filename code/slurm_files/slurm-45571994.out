Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 23:24:08 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22066.726430 
final  value 20544.754225 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18806.94 mgc: 4.981144 ustep: 1 
iter: 2  value: 18795.12 mgc: 3.320914 ustep: 1 
iter: 3  value: 18794.47 mgc: 1.25611 ustep: 1 
iter: 4  value: 18794.47 mgc: 0.07379211 ustep: 1 
iter: 5  value: 18794.47 mgc: 0.000347706 ustep: 1 
iter: 6  value: 18794.47 mgc: 1.264043e-08 ustep: 1 
mgc: 1.387779e-15 
iter: 1  mgc: 1.387779e-15 
Matching hessian patterns... Done
outer mgc:  117.4073 
iter: 1  value: 18654.79 mgc: 1.808256 ustep: 1 
iter: 2  value: 18654.75 mgc: 0.1606652 ustep: 1 
iter: 3  value: 18654.75 mgc: 0.003150086 ustep: 1 
iter: 4  value: 18654.75 mgc: 6.814399e-07 ustep: 1 
iter: 5  mgc: 5.087163e-14 
iter: 1  mgc: 5.087163e-14 
outer mgc:  42.63874 
iter: 1  value: 18577.96 mgc: 3.777914 ustep: 1 
iter: 2  value: 18576.34 mgc: 0.6764232 ustep: 1 
iter: 3  value: 18576.34 mgc: 0.01381862 ustep: 1 
iter: 4  value: 18576.34 mgc: 1.611284e-05 ustep: 1 
iter: 5  mgc: 1.79724e-11 
iter: 1  mgc: 1.79724e-11 
outer mgc:  26.50635 
iter: 1  value: 18561.72 mgc: 2.278648 ustep: 1 
iter: 2  value: 18561.36 mgc: 0.4004289 ustep: 1 
iter: 3  value: 18561.36 mgc: 0.007084571 ustep: 1 
iter: 4  value: 18561.36 mgc: 3.901064e-06 ustep: 1 
iter: 5  mgc: 1.021627e-12 
iter: 1  mgc: 1.021627e-12 
outer mgc:  30.65305 
iter: 1  value: 18519.29 mgc: 4.085985 ustep: 1 
iter: 2  value: 18517.8 mgc: 1.160123 ustep: 1 
iter: 3  value: 18517.8 mgc: 0.07912853 ustep: 1 
iter: 4  value: 18517.8 mgc: 0.0004743274 ustep: 1 
iter: 5  value: 18517.8 mgc: 1.809948e-08 ustep: 1 
mgc: 8.743006e-15 
iter: 1  mgc: 8.743006e-15 
outer mgc:  62.66099 
iter: 1  value: 18498.27 mgc: 5.092967 ustep: 1 
iter: 2  value: 18495.68 mgc: 2.053919 ustep: 1 
iter: 3  value: 18495.68 mgc: 0.1010331 ustep: 1 
iter: 4  value: 18495.68 mgc: 0.0003181071 ustep: 1 
iter: 5  mgc: 3.790531e-09 
iter: 1  mgc: 3.790531e-09 
outer mgc:  67.18708 
iter: 1  value: 18511.7 mgc: 5.194389 ustep: 1 
iter: 2  value: 18510.2 mgc: 0.714112 ustep: 1 
iter: 3  value: 18510.2 mgc: 0.01938632 ustep: 1 
iter: 4  value: 18510.2 mgc: 1.587293e-05 ustep: 1 
iter: 5  mgc: 1.158892e-11 
iter: 1  mgc: 1.158892e-11 
outer mgc:  63.36638 
iter: 1  value: 18466.63 mgc: 2.440487 ustep: 1 
iter: 2  value: 18466.59 mgc: 0.1205156 ustep: 1 
iter: 3  value: 18466.59 mgc: 0.000342275 ustep: 1 
iter: 4  mgc: 4.215172e-09 
iter: 1  mgc: 4.215172e-09 
outer mgc:  15.09557 
iter: 1  value: 18458.7 mgc: 2.579758 ustep: 1 
iter: 2  value: 18458.63 mgc: 0.1918511 ustep: 1 
iter: 3  value: 18458.63 mgc: 0.0007285082 ustep: 1 
iter: 4  value: 18458.63 mgc: 1.838716e-08 ustep: 1 
mgc: 7.382983e-15 
iter: 1  value: 18459.52 mgc: 0.706828 ustep: 1 
iter: 2  value: 18459.52 mgc: 0.009240546 ustep: 1 
iter: 3  value: 18459.52 mgc: 2.479548e-06 ustep: 1 
iter: 4  mgc: 2.49134e-13 
iter: 1  mgc: 2.49134e-13 
outer mgc:  8.157202 
iter: 1  value: 18453.86 mgc: 0.7301855 ustep: 1 
iter: 2  value: 18453.86 mgc: 0.01192696 ustep: 1 
iter: 3  value: 18453.86 mgc: 5.472571e-06 ustep: 1 
iter: 4  mgc: 1.407319e-12 
iter: 1  mgc: 1.407319e-12 
outer mgc:  17.24847 
iter: 1  value: 18452.72 mgc: 0.5299101 ustep: 1 
iter: 2  value: 18452.72 mgc: 0.00641587 ustep: 1 
iter: 3  value: 18452.72 mgc: 1.153273e-06 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  6.853309 
iter: 1  value: 18446.57 mgc: 0.5212 ustep: 1 
iter: 2  value: 18446.57 mgc: 0.006000133 ustep: 1 
iter: 3  value: 18446.57 mgc: 5.230505e-07 ustep: 1 
iter: 4  mgc: 6.883383e-15 
iter: 1  value: 18433.99 mgc: 1.170017 ustep: 1 
iter: 2  value: 18433.99 mgc: 0.02186944 ustep: 1 
iter: 3  value: 18433.99 mgc: 5.836747e-06 ustep: 1 
iter: 4  mgc: 5.502265e-13 
iter: 1  mgc: 5.502265e-13 
outer mgc:  21.46096 
iter: 1  value: 18395.39 mgc: 5.382632 ustep: 1 
iter: 2  value: 18395.38 mgc: 0.2069028 ustep: 1 
iter: 3  value: 18395.38 mgc: 0.0003740528 ustep: 1 
iter: 4  mgc: 1.690162e-09 
iter: 1  value: 18417.28 mgc: 1.883768 ustep: 1 
iter: 2  value: 18417.27 mgc: 0.04914453 ustep: 1 
iter: 3  value: 18417.27 mgc: 3.124201e-05 ustep: 1 
iter: 4  mgc: 1.864908e-11 
iter: 1  mgc: 1.864908e-11 
outer mgc:  16.45506 
iter: 1  value: 18410.72 mgc: 0.9466499 ustep: 1 
iter: 2  value: 18410.72 mgc: 0.006922956 ustep: 1 
iter: 3  value: 18410.72 mgc: 5.535838e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  value: 18414.49 mgc: 0.5157209 ustep: 1 
iter: 2  value: 18414.49 mgc: 0.003396905 ustep: 1 
iter: 3  value: 18414.49 mgc: 1.276405e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  6.698903 
iter: 1  value: 18411.35 mgc: 0.390118 ustep: 1 
iter: 2  value: 18411.35 mgc: 0.002591085 ustep: 1 
iter: 3  value: 18411.35 mgc: 9.82276e-08 ustep: 1 
iter: 4  mgc: 5.884182e-15 
iter: 1  value: 18412.75 mgc: 0.1724893 ustep: 1 
iter: 2  value: 18412.75 mgc: 0.0005584812 ustep: 1 
iter: 3  mgc: 4.95166e-09 
iter: 1  mgc: 4.95166e-09 
outer mgc:  5.040905 
iter: 1  value: 18411.82 mgc: 0.3175 ustep: 1 
iter: 2  value: 18411.82 mgc: 0.001204661 ustep: 1 
iter: 3  value: 18411.82 mgc: 1.528454e-08 ustep: 1 
mgc: 5.273559e-15 
iter: 1  mgc: 5.273559e-15 
outer mgc:  7.493006 
iter: 1  value: 18411 mgc: 0.1578184 ustep: 1 
iter: 2  value: 18411 mgc: 0.0003068542 ustep: 1 
iter: 3  mgc: 1.250006e-09 
iter: 1  mgc: 1.250006e-09 
outer mgc:  2.890249 
iter: 1  value: 18408.42 mgc: 0.2125992 ustep: 1 
iter: 2  value: 18408.42 mgc: 0.000887564 ustep: 1 
iter: 3  value: 18408.42 mgc: 1.144601e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  3.243676 
iter: 1  value: 18403.63 mgc: 0.3588534 ustep: 1 
iter: 2  value: 18403.63 mgc: 0.001337973 ustep: 1 
iter: 3  value: 18403.63 mgc: 2.840437e-08 ustep: 1 
mgc: 4.496403e-15 
iter: 1  value: 18396.81 mgc: 0.508071 ustep: 1 
iter: 2  value: 18396.81 mgc: 0.004144372 ustep: 1 
iter: 3  value: 18396.81 mgc: 2.378071e-07 ustep: 1 
iter: 4  mgc: 4.57967e-15 
iter: 1  mgc: 4.57967e-15 
outer mgc:  4.401253 
iter: 1  value: 18386.19 mgc: 1.037114 ustep: 1 
iter: 2  value: 18386.19 mgc: 0.009157035 ustep: 1 
iter: 3  value: 18386.19 mgc: 1.071878e-06 ustep: 1 
iter: 4  mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  12.52428 
iter: 1  value: 18375.29 mgc: 0.8053502 ustep: 1 
iter: 2  value: 18375.29 mgc: 0.008308171 ustep: 1 
iter: 3  value: 18375.29 mgc: 6.928066e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  4.235005 
iter: 1  value: 18363.94 mgc: 0.9618924 ustep: 1 
iter: 2  value: 18363.94 mgc: 0.00700165 ustep: 1 
iter: 3  value: 18363.94 mgc: 3.764046e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  value: 18373.21 mgc: 0.3045079 ustep: 1 
iter: 2  value: 18373.21 mgc: 0.0004636553 ustep: 1 
iter: 3  mgc: 9.150196e-10 
iter: 1  value: 18374.45 mgc: 0.09878081 ustep: 1 
iter: 2  value: 18374.45 mgc: 5.113608e-05 ustep: 1 
iter: 3  mgc: 1.219513e-11 
iter: 1  mgc: 1.219513e-11 
outer mgc:  3.960944 
iter: 1  value: 18373.56 mgc: 0.134411 ustep: 1 
iter: 2  value: 18373.56 mgc: 9.903569e-05 ustep: 1 
iter: 3  mgc: 4.609957e-11 
iter: 1  mgc: 4.609957e-11 
outer mgc:  3.118267 
iter: 1  value: 18370.88 mgc: 0.201606 ustep: 1 
iter: 2  value: 18370.88 mgc: 0.0005255882 ustep: 1 
iter: 3  mgc: 2.642843e-09 
iter: 1  value: 18367.97 mgc: 0.2057346 ustep: 1 
iter: 2  value: 18367.97 mgc: 0.0004887238 ustep: 1 
iter: 3  mgc: 2.218043e-09 
iter: 1  value: 18361.07 mgc: 0.4960989 ustep: 1 
iter: 2  value: 18361.07 mgc: 0.00250644 ustep: 1 
iter: 3  value: 18361.07 mgc: 5.196155e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  3.680919 
iter: 1  value: 18347.74 mgc: 0.8499415 ustep: 1 
iter: 2  value: 18347.74 mgc: 0.005810661 ustep: 1 
iter: 3  value: 18347.74 mgc: 2.220152e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  4.112619 
iter: 1  value: 18334.16 mgc: 1.022433 ustep: 1 
iter: 2  value: 18334.16 mgc: 0.004294526 ustep: 1 
iter: 3  value: 18334.16 mgc: 9.639334e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  2.681722 
iter: 1  value: 18320.73 mgc: 1.237768 ustep: 1 
iter: 2  value: 18320.73 mgc: 0.004578364 ustep: 1 
iter: 3  value: 18320.73 mgc: 7.890112e-08 ustep: 1 
mgc: 4.662937e-15 
iter: 1  value: 18290.95 mgc: 3.031181 ustep: 1 
iter: 2  value: 18290.95 mgc: 0.01223143 ustep: 1 
iter: 3  value: 18290.95 mgc: 2.775126e-07 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  3.799454 
iter: 1  value: 18264.16 mgc: 2.235343 ustep: 1 
iter: 2  value: 18264.16 mgc: 0.003806157 ustep: 1 
iter: 3  value: 18264.16 mgc: 1.60482e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  1.21039 
iter: 1  value: 18237.73 mgc: 2.403804 ustep: 1 
iter: 2  value: 18237.73 mgc: 0.002107837 ustep: 1 
iter: 3  mgc: 2.97462e-09 
iter: 1  mgc: 2.97462e-09 
outer mgc:  0.4955238 
iter: 1  value: 18212.42 mgc: 2.520206 ustep: 1 
iter: 2  value: 18212.42 mgc: 0.0009305879 ustep: 1 
iter: 3  mgc: 3.641194e-10 
iter: 1  mgc: 3.641194e-10 
outer mgc:  0.2991857 
iter: 1  value: 18179.46 mgc: 3.803189 ustep: 1 
iter: 2  value: 18179.46 mgc: 0.0006453062 ustep: 1 
iter: 3  mgc: 1.202922e-10 
iter: 1  mgc: 1.202922e-10 
outer mgc:  0.1263949 
iter: 1  value: 18151.41 mgc: 3.380144 ustep: 1 
iter: 2  value: 18151.41 mgc: 0.0001418328 ustep: 1 
iter: 3  mgc: 4.745537e-12 
iter: 1  mgc: 4.745537e-12 
outer mgc:  0.05061724 
iter: 1  value: 18124.98 mgc: 3.388457 ustep: 1 
iter: 2  value: 18124.98 mgc: 2.473202e-05 ustep: 1 
iter: 3  mgc: 1.589839e-13 
iter: 1  mgc: 1.589839e-13 
outer mgc:  0.06826868 
iter: 1  value: 18091.22 mgc: 5.017037 ustep: 1 
iter: 2  value: 18091.22 mgc: 1.722513e-05 ustep: 1 
iter: 3  mgc: 1.518785e-13 
iter: 1  mgc: 1.518785e-13 
outer mgc:  0.0558436 
iter: 1  value: 18058.25 mgc: 5.006578 ustep: 1 
iter: 2  value: 18058.25 mgc: 4.018181e-05 ustep: 1 
iter: 3  mgc: 9.148238e-13 
iter: 1  mgc: 9.148238e-13 
outer mgc:  0.04846894 
iter: 1  value: 18031.57 mgc: 3.69164 ustep: 1 
iter: 2  value: 18031.57 mgc: 2.091757e-05 ustep: 1 
iter: 3  mgc: 2.611245e-13 
iter: 1  mgc: 2.611245e-13 
outer mgc:  0.04431629 
iter: 1  value: 18012.39 mgc: 2.31773 ustep: 1 
iter: 2  value: 18012.39 mgc: 1.440368e-06 ustep: 1 
iter: 3  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.05930181 
iter: 1  value: 17992.71 mgc: 2.318836 ustep: 1 
iter: 2  value: 17992.71 mgc: 5.918201e-08 ustep: 1 
mgc: 4.551914e-15 
iter: 1  mgc: 4.551914e-15 
outer mgc:  0.05384856 
iter: 1  value: 17950.78 mgc: 6.181692 ustep: 1 
iter: 2  value: 17950.78 mgc: 2.986345e-06 ustep: 1 
iter: 3  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.02916735 
iter: 1  value: 17916.9 mgc: 4.557719 ustep: 1 
iter: 2  value: 17916.9 mgc: 2.209706e-06 ustep: 1 
iter: 3  mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  0.009833649 
iter: 1  value: 17888.29 mgc: 3.664829 ustep: 1 
iter: 2  value: 17888.29 mgc: 6.122751e-07 ustep: 1 
iter: 3  mgc: 5.051515e-15 
iter: 1  mgc: 5.051515e-15 
outer mgc:  0.005430619 
iter: 1  value: 17861.27 mgc: 3.436272 ustep: 1 
iter: 2  value: 17861.27 mgc: 3.422825e-08 ustep: 1 
mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  0.009156853 
iter: 1  value: 17834.37 mgc: 3.43623 ustep: 1 
iter: 2  value: 17834.37 mgc: 1.912009e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.007116023 
iter: 1  value: 17795.28 mgc: 5.734816 ustep: 1 
iter: 2  value: 17795.28 mgc: 1.596804e-07 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.002237137 
iter: 1  value: 17764.59 mgc: 4.091755 ustep: 1 
iter: 2  value: 17764.59 mgc: 5.472069e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  0.001088436 
iter: 1  value: 17735.83 mgc: 3.745522 ustep: 1 
iter: 2  mgc: 6.876345e-09 
iter: 1  mgc: 6.876345e-09 
outer mgc:  0.002078757 
iter: 1  value: 17707.03 mgc: 3.745614 ustep: 1 
iter: 2  mgc: 4.027783e-10 
iter: 1  mgc: 4.027783e-10 
outer mgc:  0.001839709 
iter: 1  mgc: 4.027783e-10 
iter: 1  mgc: 4.027783e-10 
outer mgc:  0.001839709 
iter: 1  value: 17707.03 mgc: 0.004198533 ustep: 1 
iter: 2  mgc: 9.657461e-09 
outer mgc:  0.3523149 
iter: 1  value: 17707.03 mgc: 0.004196816 ustep: 1 
iter: 2  mgc: 9.701038e-09 
outer mgc:  0.3530686 
iter: 1  value: 17707.03 mgc: 0.002153526 ustep: 1 
iter: 2  mgc: 2.585671e-09 
outer mgc:  0.1854938 
iter: 1  value: 17707.03 mgc: 0.002152516 ustep: 1 
iter: 2  mgc: 2.590642e-09 
outer mgc:  0.1845531 
iter: 1  value: 17707.03 mgc: 0.004724732 ustep: 1 
iter: 2  mgc: 4.656002e-09 
outer mgc:  0.2806519 
iter: 1  value: 17707.03 mgc: 0.004723258 ustep: 1 
iter: 2  mgc: 4.671079e-09 
outer mgc:  0.2797427 
iter: 1  value: 17707.03 mgc: 0.002515153 ustep: 1 
iter: 2  mgc: 1.384298e-09 
outer mgc:  0.1421903 
iter: 1  value: 17707.03 mgc: 0.002514672 ustep: 1 
iter: 2  mgc: 1.386018e-09 
outer mgc:  0.1420514 
iter: 1  value: 17707.07 mgc: 0.004803517 ustep: 1 
iter: 2  value: 17707.07 mgc: 1.35362e-08 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.006561072 
iter: 1  value: 17706.98 mgc: 0.004808324 ustep: 1 
iter: 2  value: 17706.98 mgc: 1.351702e-08 ustep: 1 
mgc: 4.996004e-15 
outer mgc:  0.002878525 
iter: 1  value: 17707.08 mgc: 0.004807708 ustep: 1 
mgc: 3.774758e-15 
outer mgc:  0.001839741 
iter: 1  value: 17706.98 mgc: 0.004812518 ustep: 1 
mgc: 4.662937e-15 
outer mgc:  0.001839676 
iter: 1  value: 17707.02 mgc: 0.004511945 ustep: 1 
iter: 2  value: 17707.02 mgc: 1.137211e-08 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.183032 
iter: 1  value: 17707.03 mgc: 0.004508807 ustep: 1 
iter: 2  value: 17707.03 mgc: 1.13448e-08 ustep: 1 
mgc: 3.996803e-15 
outer mgc:  0.1866403 
[Sat Aug 14 23:24:12 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:27:36 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.6_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_0.6_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.6_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10963.052029 
iter  10 value 8745.008024
iter  10 value 8745.008020
final  value 8745.008020 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4554.05 mgc: 131.655 ustep: 0.2494656 
iter: 2  value: 3104.12 mgc: 106.3247 ustep: 0.4995153 
iter: 3  value: 1535.064 mgc: 115.0203 ustep: 0.0737805 
iter: 4  value: 1231.649 mgc: 125.4216 ustep: 0.2716985 
iter: 5  value: 1188.619 mgc: 87.41418 ustep: 0.5212949 
iter: 6  value: 1121.4 mgc: 83.22163 ustep: 0.7220354 
iter: 7  value: 1084.167 mgc: 60.98378 ustep: 0.8497417 
iter: 8  value: 1081.611 mgc: 16.18636 ustep: 0.9218222 
iter: 9  value: 1081.61 mgc: 0.2063773 ustep: 0.9601197 
iter: 10  value: 1081.61 mgc: 0.0005269815 ustep: 0.979859 
iter: 11  value: 1081.61 mgc: 5.90019e-07 ustep: 0.9898793 
iter: 12  mgc: 3.791818e-10 
iter: 1  mgc: 3.791818e-10 
Matching hessian patterns... Done
outer mgc:  326.3482 
iter: 1  value: 822.0784 mgc: 11.94034 ustep: 1 
iter: 2  value: 814.552 mgc: 3.6146 ustep: 1 
iter: 3  value: 814.5324 mgc: 0.2052583 ustep: 1 
iter: 4  value: 814.5324 mgc: 0.001012463 ustep: 1 
iter: 5  value: 814.5324 mgc: 2.499468e-08 ustep: 1 
mgc: 3.191891e-14 
iter: 1  value: 713.1204 mgc: 10.2855 ustep: 1 
iter: 2  value: 710.1934 mgc: 2.288424 ustep: 1 
iter: 3  value: 710.1903 mgc: 0.08353268 ustep: 1 
iter: 4  value: 710.1903 mgc: 0.0001536288 ustep: 1 
iter: 5  mgc: 5.784139e-10 
iter: 1  mgc: 5.784139e-10 
outer mgc:  50.32816 
iter: 1  value: 974.8752 mgc: 34.92673 ustep: 1 
iter: 2  value: 974.2114 mgc: 1.541231 ustep: 1 
iter: 3  value: 974.2113 mgc: 0.01520091 ustep: 1 
iter: 4  value: 974.2113 mgc: 1.010144e-06 ustep: 1 
iter: 5  mgc: 5.506706e-14 
iter: 1  value: 692.2316 mgc: 6.251358 ustep: 1 
iter: 2  value: 692.228 mgc: 0.08323834 ustep: 1 
iter: 3  value: 692.228 mgc: 7.197499e-05 ustep: 1 
iter: 4  mgc: 3.045504e-11 
iter: 1  mgc: 3.045504e-11 
outer mgc:  75.59692 
iter: 1  value: 675.2465 mgc: 9.397574 ustep: 1 
iter: 2  value: 675.2234 mgc: 0.2395589 ustep: 1 
iter: 3  value: 675.2234 mgc: 0.0005407632 ustep: 1 
iter: 4  mgc: 7.047594e-09 
iter: 1  mgc: 7.047594e-09 
outer mgc:  77.2181 
iter: 1  value: 636.926 mgc: 8.458635 ustep: 1 
iter: 2  value: 636.9073 mgc: 0.2298673 ustep: 1 
iter: 3  value: 636.9073 mgc: 0.001110796 ustep: 1 
iter: 4  value: 636.9073 mgc: 5.616934e-08 ustep: 1 
mgc: 3.064909e-14 
iter: 1  mgc: 3.064909e-14 
outer mgc:  53.57658 
iter: 1  value: 618.9776 mgc: 13.96778 ustep: 1 
iter: 2  value: 618.8596 mgc: 0.5349705 ustep: 1 
iter: 3  value: 618.8596 mgc: 0.005162555 ustep: 1 
iter: 4  value: 618.8596 mgc: 9.74007e-07 ustep: 1 
iter: 5  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  88.09757 
iter: 1  value: 608.0043 mgc: 12.39526 ustep: 1 
iter: 2  value: 598.4127 mgc: 3.995766 ustep: 1 
iter: 3  value: 598.3875 mgc: 0.1837942 ustep: 1 
iter: 4  value: 598.3875 mgc: 0.0005593626 ustep: 1 
iter: 5  mgc: 6.696641e-09 
iter: 1  mgc: 6.696641e-09 
outer mgc:  114.4588 
iter: 1  value: 741.5119 mgc: 34.36882 ustep: 1 
iter: 2  value: 741.219 mgc: 1.126155 ustep: 1 
iter: 3  value: 741.219 mgc: 0.007101434 ustep: 1 
iter: 4  value: 741.219 mgc: 3.205948e-07 ustep: 1 
iter: 5  mgc: 2.842171e-14 
iter: 1  value: 590.7693 mgc: 7.102882 ustep: 1 
iter: 2  value: 590.7688 mgc: 0.05764616 ustep: 1 
iter: 3  value: 590.7688 mgc: 1.69828e-05 ustep: 1 
iter: 4  mgc: 3.252343e-12 
iter: 1  mgc: 3.252343e-12 
outer mgc:  54.30357 
iter: 1  value: 586.2962 mgc: 6.177863 ustep: 1 
iter: 2  value: 586.2861 mgc: 0.1223463 ustep: 1 
iter: 3  value: 586.2861 mgc: 0.000233313 ustep: 1 
iter: 4  mgc: 1.39254e-09 
iter: 1  mgc: 1.39254e-09 
outer mgc:  37.48711 
iter: 1  value: 577.2277 mgc: 4.382235 ustep: 1 
iter: 2  value: 577.1285 mgc: 0.3112424 ustep: 1 
iter: 3  value: 577.1285 mgc: 0.002191079 ustep: 1 
iter: 4  value: 577.1285 mgc: 1.518969e-07 ustep: 1 
iter: 5  mgc: 2.531308e-14 
iter: 1  value: 572.8821 mgc: 10.7432 ustep: 1 
iter: 2  value: 569.3847 mgc: 2.226324 ustep: 1 
iter: 3  value: 569.3819 mgc: 0.05921217 ustep: 1 
iter: 4  value: 569.3819 mgc: 5.902388e-05 ustep: 1 
iter: 5  mgc: 9.266499e-11 
iter: 1  mgc: 9.266499e-11 
outer mgc:  80.31458 
iter: 1  value: 577.3134 mgc: 24.12374 ustep: 1 
iter: 2  value: 577.1897 mgc: 1.09129 ustep: 1 
iter: 3  value: 577.1897 mgc: 0.01021591 ustep: 1 
iter: 4  value: 577.1897 mgc: 5.34956e-07 ustep: 1 
iter: 5  mgc: 3.413936e-14 
iter: 1  value: 567.1889 mgc: 14.59456 ustep: 1 
iter: 2  value: 567.1732 mgc: 0.2575662 ustep: 1 
iter: 3  value: 567.1732 mgc: 0.0006484363 ustep: 1 
iter: 4  mgc: 3.90823e-09 
iter: 1  value: 559.3541 mgc: 7.169457 ustep: 1 
iter: 2  value: 559.3527 mgc: 0.07407726 ustep: 1 
iter: 3  value: 559.3527 mgc: 5.678169e-05 ustep: 1 
iter: 4  mgc: 3.317102e-11 
iter: 1  mgc: 3.317102e-11 
outer mgc:  49.88089 
iter: 1  value: 561.7696 mgc: 8.941026 ustep: 1 
iter: 2  value: 561.7683 mgc: 0.0870707 ustep: 1 
iter: 3  value: 561.7683 mgc: 2.589361e-05 ustep: 1 
iter: 4  mgc: 8.418932e-12 
iter: 1  value: 556.7731 mgc: 3.889533 ustep: 1 
iter: 2  value: 556.773 mgc: 0.01605764 ustep: 1 
iter: 3  value: 556.773 mgc: 1.061642e-06 ustep: 1 
iter: 4  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  33.4178 
iter: 1  value: 553.74 mgc: 2.714965 ustep: 1 
iter: 2  value: 553.74 mgc: 0.01036207 ustep: 1 
iter: 3  value: 553.74 mgc: 6.338021e-07 ustep: 1 
iter: 4  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  29.9144 
iter: 1  value: 549.9689 mgc: 4.266719 ustep: 1 
iter: 2  value: 549.9685 mgc: 0.02952194 ustep: 1 
iter: 3  value: 549.9685 mgc: 1.612192e-05 ustep: 1 
iter: 4  mgc: 4.730438e-12 
iter: 1  mgc: 4.730438e-12 
outer mgc:  32.41063 
iter: 1  value: 542.4694 mgc: 4.130061 ustep: 1 
iter: 2  value: 542.4683 mgc: 0.08725735 ustep: 1 
iter: 3  value: 542.4683 mgc: 3.111505e-05 ustep: 1 
iter: 4  mgc: 5.878187e-12 
iter: 1  mgc: 5.878187e-12 
outer mgc:  28.09742 
iter: 1  value: 537.7475 mgc: 3.946248 ustep: 1 
iter: 2  value: 537.7455 mgc: 0.0713381 ustep: 1 
iter: 3  value: 537.7455 mgc: 4.927459e-05 ustep: 1 
iter: 4  mgc: 2.381073e-11 
iter: 1  mgc: 2.381073e-11 
outer mgc:  19.92249 
iter: 1  value: 531.7418 mgc: 4.058627 ustep: 1 
iter: 2  value: 531.737 mgc: 0.1293063 ustep: 1 
iter: 3  value: 531.737 mgc: 0.0001323201 ustep: 1 
iter: 4  mgc: 1.573267e-10 
iter: 1  mgc: 1.573267e-10 
outer mgc:  14.60542 
iter: 1  value: 531.2866 mgc: 6.362199 ustep: 1 
iter: 2  value: 531.2861 mgc: 0.05642625 ustep: 1 
iter: 3  value: 531.2861 mgc: 1.38784e-05 ustep: 1 
iter: 4  mgc: 8.144596e-13 
iter: 1  value: 531.2391 mgc: 4.41863 ustep: 1 
iter: 2  value: 531.239 mgc: 0.01281738 ustep: 1 
iter: 3  value: 531.239 mgc: 1.312462e-06 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  44.53839 
iter: 1  value: 528.2395 mgc: 3.952085 ustep: 1 
iter: 2  value: 528.2393 mgc: 0.02748168 ustep: 1 
iter: 3  value: 528.2393 mgc: 2.107581e-06 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  8.424326 
iter: 1  value: 526.6818 mgc: 1.481093 ustep: 1 
iter: 2  value: 526.6818 mgc: 0.006569548 ustep: 1 
iter: 3  value: 526.6818 mgc: 1.522537e-07 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  12.3138 
iter: 1  value: 525.1537 mgc: 4.109849 ustep: 1 
iter: 2  value: 525.1519 mgc: 0.1231547 ustep: 1 
iter: 3  value: 525.1519 mgc: 8.004967e-05 ustep: 1 
iter: 4  mgc: 5.253442e-11 
iter: 1  value: 525.3515 mgc: 1.487774 ustep: 1 
iter: 2  value: 525.3515 mgc: 0.01660389 ustep: 1 
iter: 3  value: 525.3515 mgc: 2.13232e-06 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  7.210801 
iter: 1  value: 523.9214 mgc: 0.811126 ustep: 1 
iter: 2  value: 523.9214 mgc: 0.006845019 ustep: 1 
iter: 3  value: 523.9214 mgc: 4.815931e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  5.329239 
iter: 1  value: 523.5943 mgc: 0.9342005 ustep: 1 
iter: 2  value: 523.5943 mgc: 0.004681222 ustep: 1 
iter: 3  value: 523.5943 mgc: 5.952753e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  7.768809 
iter: 1  value: 521.4245 mgc: 2.702277 ustep: 1 
iter: 2  value: 521.4245 mgc: 0.005777281 ustep: 1 
iter: 3  value: 521.4245 mgc: 2.420762e-07 ustep: 1 
iter: 4  mgc: 3.375078e-14 
iter: 1  value: 522.7772 mgc: 1.986411 ustep: 1 
iter: 2  value: 522.7772 mgc: 0.002707426 ustep: 1 
iter: 3  value: 522.7772 mgc: 5.431198e-08 ustep: 1 
mgc: 3.030215e-14 
iter: 1  value: 523.3688 mgc: 1.021314 ustep: 1 
iter: 2  value: 523.3688 mgc: 0.000831774 ustep: 1 
iter: 3  mgc: 2.439527e-09 
iter: 1  mgc: 2.439527e-09 
outer mgc:  6.316826 
iter: 1  value: 523.006 mgc: 0.550768 ustep: 1 
iter: 2  value: 523.006 mgc: 0.000556127 ustep: 1 
iter: 3  mgc: 6.223413e-10 
iter: 1  mgc: 6.223413e-10 
outer mgc:  1.90951 
iter: 1  value: 522.619 mgc: 0.1693553 ustep: 1 
iter: 2  value: 522.619 mgc: 0.0002655857 ustep: 1 
iter: 3  mgc: 7.351577e-10 
iter: 1  mgc: 7.351577e-10 
outer mgc:  1.408356 
iter: 1  value: 522.1943 mgc: 0.2691027 ustep: 1 
iter: 2  value: 522.1943 mgc: 0.0002969127 ustep: 1 
iter: 3  mgc: 6.362288e-10 
iter: 1  mgc: 6.362288e-10 
outer mgc:  1.25887 
iter: 1  value: 521.9353 mgc: 0.1423545 ustep: 1 
iter: 2  value: 521.9353 mgc: 0.0001387121 ustep: 1 
iter: 3  mgc: 1.370433e-10 
iter: 1  mgc: 1.370433e-10 
outer mgc:  0.8640219 
iter: 1  value: 521.8095 mgc: 0.1684731 ustep: 1 
iter: 2  value: 521.8095 mgc: 8.135967e-05 ustep: 1 
iter: 3  mgc: 6.107614e-11 
iter: 1  mgc: 6.107614e-11 
outer mgc:  0.5885773 
iter: 1  value: 521.6211 mgc: 0.1920309 ustep: 1 
iter: 2  value: 521.6211 mgc: 0.0002571613 ustep: 1 
iter: 3  mgc: 4.677947e-10 
iter: 1  mgc: 4.677947e-10 
outer mgc:  1.031755 
iter: 1  value: 521.2182 mgc: 0.346823 ustep: 1 
iter: 2  value: 521.2182 mgc: 0.0001465004 ustep: 1 
iter: 3  mgc: 4.463807e-11 
iter: 1  mgc: 4.463807e-11 
outer mgc:  0.7059466 
iter: 1  value: 521.3148 mgc: 0.2065857 ustep: 1 
iter: 2  value: 521.3148 mgc: 0.0001631784 ustep: 1 
iter: 3  mgc: 2.617178e-10 
iter: 1  value: 521.2618 mgc: 0.09591758 ustep: 1 
iter: 2  value: 521.2618 mgc: 3.34647e-05 ustep: 1 
iter: 3  mgc: 1.092193e-11 
iter: 1  mgc: 1.092193e-11 
outer mgc:  0.1537652 
iter: 1  value: 521.3994 mgc: 0.09346968 ustep: 1 
iter: 2  value: 521.3994 mgc: 1.500838e-05 ustep: 1 
iter: 3  mgc: 3.890221e-13 
iter: 1  mgc: 3.890221e-13 
outer mgc:  0.1328204 
iter: 1  value: 521.3708 mgc: 0.02261747 ustep: 1 
iter: 2  value: 521.3708 mgc: 9.907171e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.04643136 
iter: 1  value: 521.3491 mgc: 0.02260558 ustep: 1 
iter: 2  value: 521.3491 mgc: 1.649937e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.05162213 
iter: 1  value: 521.3625 mgc: 0.01323061 ustep: 1 
iter: 2  value: 521.3625 mgc: 4.678386e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.001206459 
iter: 1  value: 521.3624 mgc: 0.0001000967 ustep: 1 
iter: 2  mgc: 4.723866e-11 
iter: 1  mgc: 4.723866e-11 
outer mgc:  0.0001348415 
iter: 1  mgc: 4.723866e-11 
iter: 1  mgc: 4.723866e-11 
outer mgc:  0.0001348415 
iter: 1  value: 521.3584 mgc: 0.02124198 ustep: 1 
iter: 2  value: 521.3584 mgc: 3.341554e-06 ustep: 1 
iter: 3  mgc: 8.348877e-14 
outer mgc:  0.3199276 
iter: 1  value: 521.3668 mgc: 0.02122722 ustep: 1 
iter: 2  value: 521.3668 mgc: 3.340941e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
outer mgc:  0.3201028 
iter: 1  value: 521.3608 mgc: 0.007568844 ustep: 1 
iter: 2  value: 521.3608 mgc: 4.04191e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.1954493 
iter: 1  value: 521.3643 mgc: 0.007562499 ustep: 1 
iter: 2  value: 521.3643 mgc: 4.036193e-07 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.1955854 
iter: 1  value: 521.3672 mgc: 0.05628261 ustep: 1 
iter: 2  value: 521.3672 mgc: 3.00934e-06 ustep: 1 
iter: 3  mgc: 3.114176e-14 
outer mgc:  0.8421577 
iter: 1  value: 521.3585 mgc: 0.05628884 ustep: 1 
iter: 2  value: 521.3585 mgc: 3.005453e-06 ustep: 1 
iter: 3  mgc: 3.042011e-14 
outer mgc:  0.8419746 
iter: 1  value: 521.3653 mgc: 0.0307916 ustep: 1 
iter: 2  value: 521.3653 mgc: 7.225128e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.7769131 
iter: 1  value: 521.3603 mgc: 0.03079621 ustep: 1 
iter: 2  value: 521.3603 mgc: 7.215916e-07 ustep: 1 
iter: 3  mgc: 3.380629e-14 
outer mgc:  0.7767463 
iter: 1  value: 521.355 mgc: 0.009963784 ustep: 1 
iter: 2  value: 521.355 mgc: 6.700275e-07 ustep: 1 
iter: 3  mgc: 3.264056e-14 
outer mgc:  0.01682693 
iter: 1  value: 521.3699 mgc: 0.009943947 ustep: 1 
iter: 2  value: 521.3699 mgc: 6.697701e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.0168354 
iter: 1  value: 521.3834 mgc: 0.01313866 ustep: 1 
iter: 2  value: 521.3834 mgc: 1.19383e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.03767569 
iter: 1  value: 521.3414 mgc: 0.01316593 ustep: 1 
iter: 2  value: 521.3414 mgc: 1.19514e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.03762254 
iter: 1  value: 521.3802 mgc: 0.02203264 ustep: 1 
iter: 2  value: 521.3802 mgc: 8.988665e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.04479067 
iter: 1  value: 521.3446 mgc: 0.02207592 ustep: 1 
iter: 2  value: 521.3446 mgc: 8.995418e-07 ustep: 1 
iter: 3  mgc: 4.002354e-14 
outer mgc:  0.04476489 
[Fri Aug 13 11:27:37 2021]
Finished job 0.
1 of 1 steps (100%) done

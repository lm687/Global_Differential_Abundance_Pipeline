Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 09:45:49 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_10_100_80_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2135.702289 
final  value 1976.126719 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2052.859 mgc: 3.729831 ustep: 1 
iter: 2  value: 2051.536 mgc: 1.543748 ustep: 1 
iter: 3  value: 2051.528 mgc: 0.106988 ustep: 1 
iter: 4  value: 2051.528 mgc: 0.001981309 ustep: 1 
iter: 5  value: 2051.528 mgc: 2.531258e-07 ustep: 1 
iter: 6  mgc: 4.940492e-15 
iter: 1  mgc: 4.940492e-15 
Matching hessian patterns... Done
outer mgc:  16.51949 
iter: 1  value: 2028.319 mgc: 0.9296985 ustep: 1 
iter: 2  value: 2028.318 mgc: 0.03159269 ustep: 1 
iter: 3  value: 2028.318 mgc: 6.037375e-05 ustep: 1 
iter: 4  mgc: 3.587159e-10 
iter: 1  value: 1977.717 mgc: 18.03139 ustep: 1 
iter: 2  value: 1976.98 mgc: 2.392853 ustep: 1 
iter: 3  value: 1976.98 mgc: 0.02342083 ustep: 1 
iter: 4  value: 1976.98 mgc: 4.504435e-06 ustep: 1 
iter: 5  mgc: 1.991463e-13 
iter: 1  mgc: 1.991463e-13 
outer mgc:  11.76016 
iter: 1  value: 2144.174 mgc: 22.71637 ustep: 1 
iter: 2  value: 2143.992 mgc: 0.9780672 ustep: 1 
iter: 3  value: 2143.992 mgc: 0.00560504 ustep: 1 
iter: 4  value: 2143.992 mgc: 2.308192e-07 ustep: 1 
iter: 5  mgc: 2.664535e-14 
iter: 1  value: 1970.577 mgc: 2.517887 ustep: 1 
iter: 2  value: 1970.577 mgc: 0.04716105 ustep: 1 
iter: 3  value: 1970.577 mgc: 1.476834e-05 ustep: 1 
iter: 4  mgc: 1.540656e-12 
iter: 1  mgc: 1.540656e-12 
outer mgc:  13.13861 
iter: 1  value: 1972.039 mgc: 13.14558 ustep: 1 
iter: 2  value: 1971.818 mgc: 1.524206 ustep: 1 
iter: 3  value: 1971.818 mgc: 0.01029402 ustep: 1 
iter: 4  value: 1971.818 mgc: 1.722518e-06 ustep: 1 
iter: 5  mgc: 5.107026e-14 
iter: 1  value: 1967.979 mgc: 5.231056 ustep: 1 
iter: 2  value: 1967.978 mgc: 0.1231955 ustep: 1 
iter: 3  value: 1967.978 mgc: 9.194967e-05 ustep: 1 
iter: 4  mgc: 1.658751e-10 
iter: 1  mgc: 1.658751e-10 
outer mgc:  8.269406 
iter: 1  value: 1966.282 mgc: 3.318292 ustep: 1 
iter: 2  value: 1966.282 mgc: 0.04873452 ustep: 1 
iter: 3  value: 1966.282 mgc: 1.080528e-05 ustep: 1 
iter: 4  mgc: 4.650724e-13 
iter: 1  mgc: 4.650724e-13 
outer mgc:  10.21646 
iter: 1  value: 1963.192 mgc: 6.020337 ustep: 1 
iter: 2  value: 1963.191 mgc: 0.09365303 ustep: 1 
iter: 3  value: 1963.191 mgc: 2.852785e-05 ustep: 1 
iter: 4  mgc: 1.641132e-11 
iter: 1  mgc: 1.641132e-11 
outer mgc:  6.791586 
iter: 1  value: 1960.138 mgc: 2.175734 ustep: 1 
iter: 2  value: 1960.138 mgc: 0.01286329 ustep: 1 
iter: 3  value: 1960.138 mgc: 7.882579e-07 ustep: 1 
iter: 4  mgc: 6.505907e-14 
iter: 1  mgc: 6.505907e-14 
outer mgc:  5.211079 
iter: 1  value: 1955.058 mgc: 8.366565 ustep: 1 
iter: 2  value: 1955.058 mgc: 0.05124104 ustep: 1 
iter: 3  value: 1955.058 mgc: 2.26504e-05 ustep: 1 
iter: 4  mgc: 2.972289e-12 
iter: 1  mgc: 2.972289e-12 
outer mgc:  11.03609 
iter: 1  value: 1951.263 mgc: 9.920634 ustep: 1 
iter: 2  value: 1951.263 mgc: 0.07705837 ustep: 1 
iter: 3  value: 1951.263 mgc: 4.461906e-06 ustep: 1 
iter: 4  mgc: 7.01661e-14 
iter: 1  value: 1952.45 mgc: 5.532244 ustep: 1 
iter: 2  value: 1952.45 mgc: 0.03468579 ustep: 1 
iter: 3  value: 1952.45 mgc: 1.744812e-06 ustep: 1 
iter: 4  mgc: 6.039613e-14 
iter: 1  mgc: 6.039613e-14 
outer mgc:  10.31905 
iter: 1  value: 1950.34 mgc: 3.8542 ustep: 1 
iter: 2  value: 1950.34 mgc: 0.01187973 ustep: 1 
iter: 3  value: 1950.34 mgc: 3.657001e-07 ustep: 1 
iter: 4  mgc: 4.801715e-14 
iter: 1  mgc: 4.801715e-14 
outer mgc:  3.493377 
iter: 1  value: 1949.536 mgc: 2.103182 ustep: 1 
iter: 2  value: 1949.536 mgc: 0.007974781 ustep: 1 
iter: 3  value: 1949.536 mgc: 3.576167e-07 ustep: 1 
iter: 4  mgc: 5.950795e-14 
iter: 1  value: 1949.605 mgc: 0.8938872 ustep: 1 
iter: 2  value: 1949.605 mgc: 0.001550851 ustep: 1 
iter: 3  value: 1949.605 mgc: 1.428165e-08 ustep: 1 
mgc: 7.34135e-14 
iter: 1  mgc: 7.34135e-14 
outer mgc:  2.138151 
iter: 1  value: 1948.696 mgc: 1.098895 ustep: 1 
iter: 2  value: 1948.696 mgc: 0.002090965 ustep: 1 
iter: 3  mgc: 7.455572e-09 
iter: 1  mgc: 7.455572e-09 
outer mgc:  3.646179 
iter: 1  value: 1947.58 mgc: 1.644275 ustep: 1 
iter: 2  value: 1947.58 mgc: 0.001123203 ustep: 1 
iter: 3  mgc: 4.834311e-10 
iter: 1  mgc: 4.834311e-10 
outer mgc:  3.824658 
iter: 1  value: 1946.495 mgc: 1.9834 ustep: 1 
iter: 2  value: 1946.495 mgc: 0.0009257501 ustep: 1 
iter: 3  mgc: 2.000749e-09 
iter: 1  mgc: 2.000749e-09 
outer mgc:  3.363754 
iter: 1  value: 1945.367 mgc: 1.927177 ustep: 1 
iter: 2  value: 1945.367 mgc: 0.0007323613 ustep: 1 
iter: 3  mgc: 9.899992e-11 
iter: 1  mgc: 9.899992e-11 
outer mgc:  1.44539 
iter: 1  value: 1944.657 mgc: 2.902794 ustep: 1 
iter: 2  value: 1944.657 mgc: 0.005480082 ustep: 1 
iter: 3  mgc: 6.664889e-09 
iter: 1  value: 1945.072 mgc: 0.9918317 ustep: 1 
iter: 2  value: 1945.072 mgc: 0.0006774536 ustep: 1 
iter: 3  mgc: 1.291247e-10 
iter: 1  mgc: 1.291247e-10 
outer mgc:  2.527896 
iter: 1  value: 1944.694 mgc: 0.5663967 ustep: 1 
iter: 2  value: 1944.694 mgc: 0.0002752263 ustep: 1 
iter: 3  mgc: 1.031246e-10 
iter: 1  mgc: 1.031246e-10 
outer mgc:  1.226754 
iter: 1  value: 1943.913 mgc: 0.7797722 ustep: 1 
iter: 2  value: 1943.913 mgc: 0.0003785287 ustep: 1 
iter: 3  mgc: 9.437029e-11 
iter: 1  value: 1942.701 mgc: 1.907965 ustep: 1 
iter: 2  value: 1942.701 mgc: 0.0006259763 ustep: 1 
iter: 3  mgc: 3.178151e-10 
iter: 1  mgc: 3.178151e-10 
outer mgc:  1.788539 
iter: 1  value: 1940.726 mgc: 2.556568 ustep: 1 
iter: 2  value: 1940.726 mgc: 0.0009656841 ustep: 1 
iter: 3  mgc: 1.404536e-09 
iter: 1  mgc: 1.404536e-09 
outer mgc:  2.730556 
iter: 1  value: 1938.621 mgc: 3.345809 ustep: 1 
iter: 2  value: 1938.621 mgc: 0.001368554 ustep: 1 
iter: 3  mgc: 2.157796e-09 
iter: 1  mgc: 2.157796e-09 
outer mgc:  2.213595 
iter: 1  value: 1936.497 mgc: 6.359998 ustep: 1 
iter: 2  value: 1936.497 mgc: 0.0008685408 ustep: 1 
iter: 3  mgc: 4.864396e-10 
iter: 1  mgc: 4.864396e-10 
outer mgc:  1.827049 
iter: 1  value: 1934.385 mgc: 8.749177 ustep: 1 
iter: 2  value: 1934.385 mgc: 0.0008755103 ustep: 1 
iter: 3  mgc: 3.991261e-10 
iter: 1  mgc: 3.991261e-10 
outer mgc:  0.7175162 
iter: 1  value: 1932.191 mgc: 8.75445 ustep: 1 
iter: 2  value: 1932.191 mgc: 0.0004263006 ustep: 1 
iter: 3  mgc: 9.222934e-11 
iter: 1  mgc: 9.222934e-11 
outer mgc:  0.4275979 
iter: 1  value: 1929.996 mgc: 11.61252 ustep: 1 
iter: 2  value: 1929.996 mgc: 0.0003292206 ustep: 1 
iter: 3  mgc: 5.000222e-11 
iter: 1  mgc: 5.000222e-11 
outer mgc:  0.2329577 
iter: 1  value: 1928.086 mgc: 12.13608 ustep: 1 
iter: 2  value: 1928.086 mgc: 0.0001645697 ustep: 1 
iter: 3  mgc: 1.029488e-11 
iter: 1  mgc: 1.029488e-11 
outer mgc:  0.1132188 
iter: 1  value: 1926.749 mgc: 10.58588 ustep: 1 
iter: 2  value: 1926.749 mgc: 6.277672e-05 ustep: 1 
iter: 3  mgc: 2.025047e-13 
iter: 1  mgc: 2.025047e-13 
outer mgc:  0.03781564 
iter: 1  value: 1926.495 mgc: 2.146286 ustep: 1 
iter: 2  value: 1926.495 mgc: 3.242941e-06 ustep: 1 
mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  0.01142119 
iter: 1  value: 1926.128 mgc: 2.681894 ustep: 1 
iter: 2  value: 1926.128 mgc: 4.719182e-06 ustep: 1 
iter: 3  mgc: 8.437695e-14 
iter: 1  mgc: 8.437695e-14 
outer mgc:  0.0116528 
iter: 1  value: 1925.835 mgc: 1.313503 ustep: 1 
iter: 2  value: 1925.835 mgc: 1.0656e-06 ustep: 1 
mgc: 1.265654e-13 
iter: 1  mgc: 1.265654e-13 
outer mgc:  0.02126018 
iter: 1  value: 1925.068 mgc: 1.585537 ustep: 1 
iter: 2  value: 1925.068 mgc: 1.007325e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
iter: 1  mgc: 8.970602e-14 
outer mgc:  0.03953931 
iter: 1  value: 1924 mgc: 3.140607 ustep: 1 
iter: 2  value: 1924 mgc: 5.216188e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
iter: 1  mgc: 8.970602e-14 
outer mgc:  0.05429643 
iter: 1  value: 1922.655 mgc: 14.70262 ustep: 1 
iter: 2  value: 1922.655 mgc: 1.970185e-05 ustep: 1 
iter: 3  mgc: 1.84297e-13 
iter: 1  mgc: 1.84297e-13 
outer mgc:  0.05606033 
iter: 1  value: 1921.33 mgc: 38.31994 ustep: 1 
iter: 2  value: 1921.33 mgc: 7.676629e-05 ustep: 1 
iter: 3  mgc: 1.049383e-12 
iter: 1  mgc: 1.049383e-12 
outer mgc:  0.0315682 
iter: 1  value: 1920.086 mgc: 28.70164 ustep: 1 
iter: 2  value: 1920.086 mgc: 3.466712e-05 ustep: 1 
iter: 3  mgc: 1.724246e-13 
iter: 1  mgc: 1.724246e-13 
outer mgc:  0.006827821 
iter: 1  value: 1918.814 mgc: 4.496097 ustep: 1 
iter: 2  value: 1918.814 mgc: 4.898833e-07 ustep: 1 
iter: 3  mgc: 1.687539e-13 
iter: 1  mgc: 1.687539e-13 
outer mgc:  0.02202602 
iter: 1  value: 1917.024 mgc: 2.73427 ustep: 1 
iter: 2  value: 1917.024 mgc: 7.589318e-07 ustep: 1 
mgc: 1.866216e-13 
iter: 1  mgc: 1.866216e-13 
outer mgc:  0.01998845 
iter: 1  value: 1914.954 mgc: 6.223209 ustep: 1 
iter: 2  value: 1914.954 mgc: 2.548078e-07 ustep: 1 
mgc: 1.805223e-13 
iter: 1  mgc: 1.805223e-13 
outer mgc:  0.01100081 
iter: 1  value: 1913.281 mgc: 5.40351 ustep: 1 
iter: 2  value: 1913.281 mgc: 3.213501e-07 ustep: 1 
mgc: 3.521627e-13 
iter: 1  mgc: 3.521627e-13 
outer mgc:  0.003036654 
iter: 1  value: 1911.347 mgc: 5.124161 ustep: 1 
iter: 2  value: 1911.347 mgc: 4.755646e-07 ustep: 1 
mgc: 6.710188e-13 
iter: 1  mgc: 6.710188e-13 
outer mgc:  0.00502123 
iter: 1  value: 1909.721 mgc: 3.82917 ustep: 1 
iter: 2  value: 1909.721 mgc: 8.111537e-08 ustep: 1 
mgc: 7.476242e-13 
iter: 1  mgc: 7.476242e-13 
outer mgc:  0.006362597 
iter: 1  value: 1907.714 mgc: 13.42196 ustep: 1 
iter: 2  value: 1907.714 mgc: 6.25254e-08 ustep: 1 
mgc: 1.334488e-12 
iter: 1  mgc: 1.334488e-12 
outer mgc:  0.004860459 
iter: 1  value: 1906.04 mgc: 19.6293 ustep: 1 
iter: 2  value: 1906.04 mgc: 6.668594e-08 ustep: 1 
mgc: 3.52296e-12 
iter: 1  mgc: 3.52296e-12 
outer mgc:  0.002135939 
iter: 1  value: 1903.991 mgc: 29.93915 ustep: 1 
iter: 2  value: 1903.991 mgc: 6.593455e-08 ustep: 1 
mgc: 3.705591e-12 
iter: 1  mgc: 3.705591e-12 
outer mgc:  0.0007824484 
iter: 1  value: 1902.29 mgc: 16.99955 ustep: 1 
iter: 2  value: 1902.29 mgc: 1.156929e-08 ustep: 1 
mgc: 5.253131e-12 
iter: 1  mgc: 5.253131e-12 
outer mgc:  0.001812804 
iter: 1  value: 1900.266 mgc: 5.424018 ustep: 1 
iter: 2  mgc: 1.016192e-09 
iter: 1  mgc: 1.016192e-09 
outer mgc:  0.001625544 
iter: 1  value: 1898.582 mgc: 13.99494 ustep: 1 
iter: 2  mgc: 2.350895e-09 
iter: 1  mgc: 2.350895e-09 
outer mgc:  0.0008230989 
iter: 1  value: 1896.478 mgc: 30.40168 ustep: 1 
iter: 2  mgc: 3.771894e-09 
iter: 1  mgc: 3.771894e-09 
outer mgc:  0.0002114654 
iter: 1  value: 1894.741 mgc: 16.84544 ustep: 1 
iter: 2  mgc: 6.660166e-10 
iter: 1  mgc: 6.660166e-10 
outer mgc:  0.0006428897 
iter: 1  value: 1892.709 mgc: 7.072435 ustep: 1 
iter: 2  mgc: 4.191492e-11 
iter: 1  mgc: 4.191492e-11 
outer mgc:  0.0006436717 
iter: 1  value: 1891.021 mgc: 33.62956 ustep: 1 
iter: 2  mgc: 4.466112e-10 
iter: 1  mgc: 4.466112e-10 
outer mgc:  0.0003777889 
iter: 1  value: 1888.909 mgc: 69.57244 ustep: 1 
iter: 2  mgc: 7.226415e-10 
iter: 1  mgc: 7.226415e-10 
outer mgc:  9.28759e-06 
iter: 1  value: 1887.166 mgc: 48.36087 ustep: 1 
iter: 2  mgc: 2.036757e-10 
iter: 1  mgc: 2.036757e-10 
outer mgc:  0.000193315 
iter: 1  mgc: 2.036757e-10 
iter: 1  mgc: 2.036757e-10 
outer mgc:  0.000193315 
iter: 1  value: 1887.166 mgc: 0.03163012 ustep: 1 
iter: 2  value: 1887.166 mgc: 2.682783e-07 ustep: 1 
mgc: 5.028888e-11 
outer mgc:  0.2140906 
iter: 1  value: 1887.166 mgc: 0.03162794 ustep: 1 
iter: 2  value: 1887.166 mgc: 2.688747e-07 ustep: 1 
mgc: 7.766499e-11 
outer mgc:  0.2137997 
iter: 1  value: 1887.166 mgc: 0.0164431 ustep: 1 
iter: 2  value: 1887.166 mgc: 6.933477e-08 ustep: 1 
mgc: 8.917525e-11 
outer mgc:  0.1284835 
iter: 1  value: 1887.166 mgc: 0.01644409 ustep: 1 
iter: 2  value: 1887.166 mgc: 6.93583e-08 ustep: 1 
mgc: 7.406742e-11 
outer mgc:  0.1284667 
iter: 1  value: 1887.167 mgc: 0.01870478 ustep: 1 
iter: 2  value: 1887.167 mgc: 1.002999e-08 ustep: 1 
mgc: 4.749356e-11 
outer mgc:  0.1648104 
iter: 1  value: 1887.166 mgc: 0.01868905 ustep: 1 
iter: 2  mgc: 9.948719e-09 
outer mgc:  0.1650404 
iter: 1  value: 1887.166 mgc: 0.009360944 ustep: 1 
iter: 2  mgc: 2.771966e-09 
outer mgc:  0.07978752 
iter: 1  value: 1887.166 mgc: 0.009353768 ustep: 1 
iter: 2  mgc: 2.728691e-09 
outer mgc:  0.08000123 
iter: 1  value: 1887.173 mgc: 331.7217 ustep: 1 
iter: 2  value: 1887.173 mgc: 2.661115e-08 ustep: 1 
mgc: 5.979928e-11 
outer mgc:  0.00198273 
iter: 1  value: 1887.16 mgc: 332.0536 ustep: 1 
iter: 2  value: 1887.16 mgc: 2.658896e-08 ustep: 1 
mgc: 1.018838e-10 
outer mgc:  0.002361665 
iter: 1  value: 1887.176 mgc: 331.3954 ustep: 1 
iter: 2  mgc: 7.378655e-09 
outer mgc:  0.0004025598 
iter: 1  value: 1887.156 mgc: 332.3911 ustep: 1 
iter: 2  mgc: 7.360533e-09 
outer mgc:  0.0001835427 
iter: 1  value: 1887.166 mgc: 0.0002297472 ustep: 1 
mgc: 4.729062e-11 
outer mgc:  0.0001933152 
iter: 1  value: 1887.166 mgc: 0.0002297452 ustep: 1 
mgc: 5.705969e-11 
outer mgc:  0.0001933149 
iter: 1  value: 1887.166 mgc: 0.002738886 ustep: 1 
iter: 2  mgc: 2.581584e-09 
outer mgc:  0.002551229 
iter: 1  value: 1887.167 mgc: 0.002739621 ustep: 1 
iter: 2  mgc: 2.548668e-09 
outer mgc:  0.002316 
[Fri Aug 13 09:45:50 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 21:46:45 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4533.972915 
iter  10 value 3478.673289
final  value 3477.106310 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3339.267 mgc: 67.57558 ustep: 1 
iter: 2  value: 3307.901 mgc: 11.28101 ustep: 1 
iter: 3  value: 3307.144 mgc: 2.096048 ustep: 1 
iter: 4  value: 3307.142 mgc: 0.1919309 ustep: 1 
iter: 5  value: 3307.142 mgc: 0.00135267 ustep: 1 
iter: 6  value: 3307.142 mgc: 6.692981e-08 ustep: 1 
mgc: 3.147482e-14 
iter: 1  mgc: 3.147482e-14 
Matching hessian patterns... Done
outer mgc:  549.2502 
iter: 1  value: 2767.449 mgc: 11.67859 ustep: 1 
iter: 2  value: 2767.426 mgc: 0.8803423 ustep: 1 
iter: 3  value: 2767.426 mgc: 0.003445084 ustep: 1 
iter: 4  value: 2767.426 mgc: 6.459241e-08 ustep: 1 
mgc: 3.009051e-14 
iter: 1  value: 1517.996 mgc: 60.09544 ustep: 1 
iter: 2  value: 1507.111 mgc: 26.65068 ustep: 1 
iter: 3  value: 1507.067 mgc: 1.466928 ustep: 1 
iter: 4  value: 1507.067 mgc: 0.01470622 ustep: 1 
iter: 5  value: 1507.067 mgc: 9.123229e-06 ustep: 1 
iter: 6  mgc: 4.401368e-12 
iter: 1  value: 5782.959 mgc: 106.1613 ustep: 1 
iter: 2  value: 4204.057 mgc: 87.50959 ustep: 1 
iter: 3  value: 4084.26 mgc: 80.82123 ustep: 1 
iter: 4  value: 4009.598 mgc: 81.61432 ustep: 0.2494656 
iter: 5  value: 3952.17 mgc: 85.81238 ustep: 0.4995153 
iter: 6  value: 3882.78 mgc: 62.61917 ustep: 0.7067933 
iter: 7  value: 3865.815 mgc: 33.28317 ustep: 0.8407259 
iter: 8  value: 3865.804 mgc: 0.8378738 ustep: 0.9169194 
iter: 9  value: 3865.804 mgc: 0.002018068 ustep: 0.9575633 
iter: 10  value: 3865.804 mgc: 2.479039e-06 ustep: 0.9785538 
iter: 11  mgc: 2.115771e-09 
iter: 1  mgc: 4.401368e-12 
outer mgc:  279.5132 
iter: 1  value: 717.588 mgc: 41.06595 ustep: 0.4367355 
iter: 2  value: 520.6044 mgc: 28.12222 ustep: 0.6608936 
iter: 3  value: 515.0165 mgc: 5.458795 ustep: 0.8129723 
iter: 4  value: 514.994 mgc: 0.2472663 ustep: 0.9016596 
iter: 5  value: 514.994 mgc: 0.003318432 ustep: 0.9495626 
iter: 6  value: 514.994 mgc: 1.384578e-05 ustep: 0.9744576 
iter: 7  value: 514.994 mgc: 4.161943e-08 ustep: 0.9871475 
iter: 8  mgc: 6.261469e-11 
iter: 1  mgc: 6.261469e-11 
outer mgc:  198.5253 
iter: 1  value: 1102.495 mgc: 396.7784 ustep: 1 
iter: 2  value: 761.5876 mgc: 76.91313 ustep: 1 
iter: 3  value: 756.1102 mgc: 13.14991 ustep: 1 
iter: 4  value: 756.1084 mgc: 0.601315 ustep: 1 
iter: 5  value: 756.1084 mgc: 0.0002186215 ustep: 1 
iter: 6  mgc: 8.924417e-11 
iter: 1  value: 435.7992 mgc: 41.04025 ustep: 1 
iter: 2  value: 434.1026 mgc: 6.575195 ustep: 1 
iter: 3  value: 434.1023 mgc: 0.05875539 ustep: 1 
iter: 4  value: 434.1023 mgc: 1.582061e-05 ustep: 1 
iter: 5  mgc: 3.330031e-12 
iter: 1  mgc: 3.330031e-12 
outer mgc:  220.8066 
iter: 1  value: 318.7756 mgc: 6.065744 ustep: 1 
iter: 2  value: 318.7747 mgc: 0.09149273 ustep: 1 
iter: 3  value: 318.7747 mgc: 0.0001466742 ustep: 1 
iter: 4  mgc: 1.036158e-09 
iter: 1  mgc: 1.036158e-09 
outer mgc:  67.65903 
iter: 1  value: 381.6508 mgc: 418.5822 ustep: 1 
iter: 2  value: 381.3993 mgc: 6.628649 ustep: 1 
iter: 3  value: 381.3993 mgc: 0.01101381 ustep: 1 
iter: 4  value: 381.3993 mgc: 4.648247e-08 ustep: 1 
mgc: 4.263256e-14 
iter: 1  value: 268.271 mgc: 9.748618 ustep: 1 
iter: 2  value: 268.2658 mgc: 0.2342807 ustep: 1 
iter: 3  value: 268.2658 mgc: 0.0002690158 ustep: 1 
iter: 4  mgc: 4.845654e-10 
iter: 1  mgc: 4.845654e-10 
outer mgc:  72.32166 
iter: 1  value: 494.2773 mgc: 61.05451 ustep: 1 
iter: 2  value: 474.2689 mgc: 12.01945 ustep: 1 
iter: 3  value: 474.2539 mgc: 0.5757414 ustep: 1 
iter: 4  value: 474.2539 mgc: 0.001176759 ustep: 1 
iter: 5  value: 474.2539 mgc: 2.070444e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  value: 258.8348 mgc: 5.453235 ustep: 1 
iter: 2  value: 258.8342 mgc: 0.07359151 ustep: 1 
iter: 3  value: 258.8342 mgc: 2.3726e-05 ustep: 1 
iter: 4  mgc: 2.443823e-12 
iter: 1  mgc: 2.443823e-12 
outer mgc:  34.93691 
iter: 1  value: 242.4593 mgc: 4.184511 ustep: 1 
iter: 2  value: 242.4592 mgc: 0.03112157 ustep: 1 
iter: 3  value: 242.4592 mgc: 4.020448e-06 ustep: 1 
iter: 4  mgc: 9.675594e-14 
iter: 1  value: 212.8681 mgc: 13.67242 ustep: 1 
iter: 2  value: 212.8646 mgc: 0.187141 ustep: 1 
iter: 3  value: 212.8646 mgc: 9.522426e-05 ustep: 1 
iter: 4  mgc: 5.770895e-11 
iter: 1  mgc: 5.770895e-11 
outer mgc:  44.19058 
iter: 1  value: 290.0064 mgc: 55.84348 ustep: 1 
iter: 2  value: 280.1114 mgc: 9.886094 ustep: 1 
iter: 3  value: 280.1073 mgc: 0.2254073 ustep: 1 
iter: 4  value: 280.1073 mgc: 0.0001850028 ustep: 1 
iter: 5  mgc: 1.496492e-10 
iter: 1  value: 208.2047 mgc: 18.60885 ustep: 1 
iter: 2  value: 208.1374 mgc: 0.7325899 ustep: 1 
iter: 3  value: 208.1374 mgc: 0.001759615 ustep: 1 
iter: 4  value: 208.1374 mgc: 1.180377e-08 ustep: 1 
mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  39.10118 
iter: 1  value: 203.2478 mgc: 8.819309 ustep: 1 
iter: 2  value: 203.2463 mgc: 0.1303092 ustep: 1 
iter: 3  value: 203.2463 mgc: 0.0001035834 ustep: 1 
iter: 4  mgc: 5.755954e-11 
iter: 1  mgc: 5.755954e-11 
outer mgc:  37.93255 
iter: 1  value: 201.1532 mgc: 4.776182 ustep: 1 
iter: 2  value: 201.1487 mgc: 0.1437449 ustep: 1 
iter: 3  value: 201.1487 mgc: 0.0002159321 ustep: 1 
iter: 4  mgc: 1.417229e-09 
iter: 1  mgc: 1.417229e-09 
outer mgc:  14.95636 
iter: 1  value: 198.009 mgc: 7.848784 ustep: 1 
iter: 2  value: 198.0084 mgc: 0.08034798 ustep: 1 
iter: 3  value: 198.0084 mgc: 1.952927e-05 ustep: 1 
iter: 4  mgc: 1.654676e-12 
iter: 1  mgc: 1.654676e-12 
outer mgc:  40.92294 
iter: 1  value: 191.7381 mgc: 14.88852 ustep: 1 
iter: 2  value: 191.7377 mgc: 0.0657073 ustep: 1 
iter: 3  value: 191.7377 mgc: 4.246803e-05 ustep: 1 
iter: 4  mgc: 2.681988e-11 
iter: 1  mgc: 2.681988e-11 
outer mgc:  38.67817 
iter: 1  value: 192.4687 mgc: 6.959515 ustep: 1 
iter: 2  value: 192.4672 mgc: 0.1019185 ustep: 1 
iter: 3  value: 192.4672 mgc: 0.0001827598 ustep: 1 
iter: 4  mgc: 1.304021e-09 
iter: 1  mgc: 1.304021e-09 
outer mgc:  24.72157 
iter: 1  value: 217.4787 mgc: 31.72434 ustep: 1 
iter: 2  value: 217.2949 mgc: 1.407906 ustep: 1 
iter: 3  value: 217.2949 mgc: 0.009067465 ustep: 1 
iter: 4  value: 217.2949 mgc: 3.984233e-07 ustep: 1 
iter: 5  mgc: 5.329071e-14 
iter: 1  value: 189.2544 mgc: 7.560578 ustep: 1 
iter: 2  value: 189.2531 mgc: 0.1062801 ustep: 1 
iter: 3  value: 189.2531 mgc: 4.861568e-05 ustep: 1 
iter: 4  mgc: 1.103428e-11 
iter: 1  mgc: 1.103428e-11 
outer mgc:  17.56857 
iter: 1  value: 187.6339 mgc: 3.658922 ustep: 1 
iter: 2  value: 187.6337 mgc: 0.04392644 ustep: 1 
iter: 3  value: 187.6337 mgc: 6.376352e-06 ustep: 1 
iter: 4  mgc: 1.385558e-13 
iter: 1  mgc: 1.385558e-13 
outer mgc:  12.576 
iter: 1  value: 186.1785 mgc: 2.934116 ustep: 1 
iter: 2  value: 186.1784 mgc: 0.01123845 ustep: 1 
iter: 3  value: 186.1784 mgc: 2.891866e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  10.76646 
iter: 1  value: 185.5669 mgc: 1.593953 ustep: 1 
iter: 2  value: 185.5669 mgc: 0.003069394 ustep: 1 
iter: 3  value: 185.5669 mgc: 5.564358e-08 ustep: 1 
mgc: 6.727952e-14 
iter: 1  value: 185.2778 mgc: 0.9715856 ustep: 1 
iter: 2  value: 185.2778 mgc: 0.005349802 ustep: 1 
iter: 3  value: 185.2778 mgc: 1.353548e-07 ustep: 1 
iter: 4  mgc: 4.241052e-14 
iter: 1  mgc: 4.241052e-14 
outer mgc:  6.331439 
iter: 1  value: 184.5738 mgc: 8.23124 ustep: 1 
iter: 2  value: 184.5733 mgc: 0.05203832 ustep: 1 
iter: 3  value: 184.5733 mgc: 0.0001162429 ustep: 1 
iter: 4  mgc: 3.576393e-10 
iter: 1  value: 184.4613 mgc: 3.30606 ustep: 1 
iter: 2  value: 184.4613 mgc: 0.005854472 ustep: 1 
iter: 3  value: 184.4613 mgc: 1.18871e-06 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  11.67764 
iter: 1  value: 182.9816 mgc: 1.584065 ustep: 1 
iter: 2  value: 182.9816 mgc: 0.006657566 ustep: 1 
iter: 3  value: 182.9816 mgc: 1.142358e-06 ustep: 1 
iter: 4  mgc: 6.239453e-14 
iter: 1  mgc: 6.239453e-14 
outer mgc:  7.031396 
iter: 1  value: 182.153 mgc: 3.67354 ustep: 1 
iter: 2  value: 182.153 mgc: 0.01772319 ustep: 1 
iter: 3  value: 182.153 mgc: 2.77247e-06 ustep: 1 
iter: 4  mgc: 1.971756e-13 
iter: 1  mgc: 1.971756e-13 
outer mgc:  8.245229 
iter: 1  value: 181.5403 mgc: 1.412545 ustep: 1 
iter: 2  value: 181.5403 mgc: 0.001334536 ustep: 1 
iter: 3  value: 181.5403 mgc: 1.010961e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  4.943261 
iter: 1  value: 180.8871 mgc: 1.133419 ustep: 1 
iter: 2  value: 180.8871 mgc: 0.00222068 ustep: 1 
iter: 3  value: 180.8871 mgc: 1.051408e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 179.6298 mgc: 4.286082 ustep: 1 
iter: 2  value: 179.6295 mgc: 0.02900309 ustep: 1 
iter: 3  value: 179.6295 mgc: 8.717088e-06 ustep: 1 
iter: 4  mgc: 2.124523e-12 
iter: 1  mgc: 2.124523e-12 
outer mgc:  8.080269 
iter: 1  value: 178.1978 mgc: 2.063618 ustep: 1 
iter: 2  value: 178.1978 mgc: 0.009687669 ustep: 1 
iter: 3  value: 178.1978 mgc: 4.190525e-06 ustep: 1 
iter: 4  mgc: 5.400125e-13 
iter: 1  mgc: 5.400125e-13 
outer mgc:  2.913346 
iter: 1  value: 176.8349 mgc: 2.533519 ustep: 1 
iter: 2  value: 176.8349 mgc: 0.0121006 ustep: 1 
iter: 3  value: 176.8349 mgc: 1.684683e-07 ustep: 1 
iter: 4  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  2.22333 
iter: 1  value: 177.1145 mgc: 1.318025 ustep: 1 
iter: 2  value: 177.1145 mgc: 0.007628925 ustep: 1 
iter: 3  value: 177.1145 mgc: 2.125079e-07 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  2.47886 
iter: 1  value: 176.9567 mgc: 0.6737927 ustep: 1 
iter: 2  value: 176.9567 mgc: 0.001559554 ustep: 1 
iter: 3  mgc: 7.962817e-09 
iter: 1  mgc: 7.962817e-09 
outer mgc:  0.1158071 
iter: 1  value: 176.9726 mgc: 0.08693662 ustep: 1 
iter: 2  value: 176.9726 mgc: 1.317063e-05 ustep: 1 
iter: 3  mgc: 2.392753e-12 
iter: 1  mgc: 2.392753e-12 
outer mgc:  0.05929523 
iter: 1  value: 177.0186 mgc: 0.08980574 ustep: 1 
iter: 2  value: 177.0186 mgc: 5.626105e-06 ustep: 1 
iter: 3  mgc: 1.048051e-13 
iter: 1  mgc: 1.048051e-13 
outer mgc:  0.03950944 
iter: 1  value: 177.0401 mgc: 0.0409449 ustep: 1 
iter: 2  value: 177.0401 mgc: 1.436001e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.006235121 
iter: 1  value: 177.0434 mgc: 0.005738539 ustep: 1 
iter: 2  value: 177.0434 mgc: 1.667194e-08 ustep: 1 
mgc: 5.240253e-14 
iter: 1  mgc: 5.240253e-14 
outer mgc:  0.001125142 
iter: 1  value: 177.0435 mgc: 0.0004843834 ustep: 1 
iter: 2  mgc: 1.337908e-10 
iter: 1  mgc: 1.337908e-10 
outer mgc:  0.0001708598 
iter: 1  value: 177.0434 mgc: 6.621714e-05 ustep: 1 
iter: 2  mgc: 1.273903e-11 
iter: 1  mgc: 1.273903e-11 
outer mgc:  1.669788e-05 
iter: 1  mgc: 1.273903e-11 
iter: 1  mgc: 1.273903e-11 
outer mgc:  1.669788e-05 
iter: 1  value: 177.045 mgc: 0.05080357 ustep: 1 
iter: 2  value: 177.045 mgc: 9.632602e-07 ustep: 1 
iter: 3  mgc: 4.807266e-14 
outer mgc:  0.4199537 
iter: 1  value: 177.0423 mgc: 0.05080357 ustep: 1 
iter: 2  value: 177.0423 mgc: 9.607929e-07 ustep: 1 
iter: 3  mgc: 4.207745e-14 
outer mgc:  0.4199559 
iter: 1  value: 177.0448 mgc: 0.02507939 ustep: 1 
iter: 2  value: 177.0448 mgc: 8.487045e-07 ustep: 1 
iter: 3  mgc: 3.741452e-14 
outer mgc:  0.2928118 
iter: 1  value: 177.0424 mgc: 0.02508885 ustep: 1 
iter: 2  value: 177.0424 mgc: 8.48748e-07 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.2928425 
iter: 1  value: 177.0428 mgc: 0.05478487 ustep: 1 
iter: 2  value: 177.0428 mgc: 4.067232e-06 ustep: 1 
iter: 3  mgc: 8.171241e-14 
outer mgc:  0.3280814 
iter: 1  value: 177.0444 mgc: 0.05477642 ustep: 1 
iter: 2  value: 177.0444 mgc: 4.070699e-06 ustep: 1 
iter: 3  mgc: 8.526513e-14 
outer mgc:  0.3280772 
iter: 1  value: 177.0424 mgc: 0.02507094 ustep: 1 
iter: 2  value: 177.0424 mgc: 8.594234e-07 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  0.29191 
iter: 1  value: 177.0448 mgc: 0.02506146 ustep: 1 
iter: 2  value: 177.0448 mgc: 8.593673e-07 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  0.2918791 
iter: 1  value: 177.0408 mgc: 0.005176026 ustep: 1 
iter: 2  value: 177.0408 mgc: 1.650714e-08 ustep: 1 
mgc: 2.664535e-14 
outer mgc:  0.00262995 
iter: 1  value: 177.0461 mgc: 0.005174586 ustep: 1 
iter: 2  value: 177.0461 mgc: 1.651614e-08 ustep: 1 
mgc: 3.119727e-14 
outer mgc:  0.002629012 
iter: 1  value: 177.0543 mgc: 0.04927312 ustep: 1 
iter: 2  value: 177.0543 mgc: 1.413783e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.1196403 
iter: 1  value: 177.0327 mgc: 0.04941521 ustep: 1 
iter: 2  value: 177.0327 mgc: 1.40985e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.1195404 
iter: 1  value: 177.0454 mgc: 0.04418495 ustep: 1 
iter: 2  value: 177.0454 mgc: 2.09105e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.1457177 
iter: 1  value: 177.0416 mgc: 0.04430015 ustep: 1 
iter: 2  value: 177.0416 mgc: 2.100928e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.1459592 
[Sat Aug 14 21:46:46 2021]
Finished job 0.
1 of 1 steps (100%) done

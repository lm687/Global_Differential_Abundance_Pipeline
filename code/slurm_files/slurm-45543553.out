Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 04:46:07 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2245.563518 
iter  10 value 1345.282423
final  value 1317.943498 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 649.1979 mgc: 117.6526 ustep: 1 
iter: 2  value: 604.4179 mgc: 14.2886 ustep: 1 
iter: 3  value: 600.4686 mgc: 7.938534 ustep: 1 
iter: 4  value: 600.4511 mgc: 0.5643531 ustep: 1 
iter: 5  value: 600.4511 mgc: 0.005793709 ustep: 1 
iter: 6  value: 600.4511 mgc: 6.339025e-07 ustep: 1 
iter: 7  mgc: 2.187139e-14 
iter: 1  mgc: 2.187139e-14 
Matching hessian patterns... Done
outer mgc:  125.0826 
iter: 1  value: 485.0631 mgc: 15.24911 ustep: 1 
iter: 2  value: 478.4057 mgc: 5.820061 ustep: 1 
iter: 3  value: 478.3545 mgc: 0.4800855 ustep: 1 
iter: 4  value: 478.3545 mgc: 0.006927344 ustep: 1 
iter: 5  value: 478.3545 mgc: 1.517074e-06 ustep: 1 
iter: 6  mgc: 1.207368e-13 
iter: 1  value: 405.2071 mgc: 23.41763 ustep: 0.6827823 
iter: 2  value: 331.62 mgc: 21.11174 ustep: 0.8263238 
iter: 3  value: 328.5689 mgc: 4.29704 ustep: 0.9090326 
iter: 4  value: 328.5453 mgc: 0.4253674 ustep: 0.9534367 
iter: 5  value: 328.5453 mgc: 0.009955961 ustep: 0.9764432 
iter: 6  value: 328.5453 mgc: 3.176958e-05 ustep: 0.9881526 
iter: 7  value: 328.5453 mgc: 5.079442e-08 ustep: 0.9940592 
mgc: 4.116796e-11 
iter: 1  mgc: 4.116796e-11 
outer mgc:  76.43659 
iter: 1  value: 404.9133 mgc: 82.46839 ustep: 1 
iter: 2  value: 393.1545 mgc: 11.49177 ustep: 1 
iter: 3  value: 392.9402 mgc: 1.512722 ustep: 1 
iter: 4  value: 392.94 mgc: 0.05741149 ustep: 1 
iter: 5  value: 392.94 mgc: 0.0001227677 ustep: 1 
iter: 6  mgc: 5.353402e-10 
iter: 1  value: 221.7811 mgc: 15.17973 ustep: 1 
iter: 2  value: 221.7711 mgc: 0.3845792 ustep: 1 
iter: 3  value: 221.7711 mgc: 0.0006373718 ustep: 1 
iter: 4  mgc: 2.465463e-09 
iter: 1  mgc: 2.465463e-09 
outer mgc:  41.04152 
iter: 1  value: 165.2539 mgc: 9.254602 ustep: 1 
iter: 2  value: 165.1803 mgc: 0.8186817 ustep: 1 
iter: 3  value: 165.1803 mgc: 0.005921238 ustep: 1 
iter: 4  value: 165.1803 mgc: 1.713852e-06 ustep: 1 
iter: 5  mgc: 1.032438e-13 
iter: 1  mgc: 1.032438e-13 
outer mgc:  25.33402 
iter: 1  value: 167.5468 mgc: 21.0331 ustep: 1 
iter: 2  value: 165.764 mgc: 3.272356 ustep: 1 
iter: 3  value: 165.7596 mgc: 0.1986511 ustep: 1 
iter: 4  value: 165.7596 mgc: 0.001321418 ustep: 1 
iter: 5  value: 165.7596 mgc: 5.782351e-08 ustep: 1 
mgc: 1.915135e-14 
iter: 1  value: 154.0712 mgc: 9.436784 ustep: 1 
iter: 2  value: 154.0601 mgc: 0.281191 ustep: 1 
iter: 3  value: 154.0601 mgc: 0.0006942209 ustep: 1 
iter: 4  value: 154.0601 mgc: 1.360872e-08 ustep: 1 
mgc: 3.785861e-14 
iter: 1  mgc: 3.785861e-14 
outer mgc:  27.99167 
iter: 1  value: 142.3947 mgc: 9.514449 ustep: 1 
iter: 2  value: 142.3222 mgc: 0.6891947 ustep: 1 
iter: 3  value: 142.3222 mgc: 0.004427658 ustep: 1 
iter: 4  value: 142.3222 mgc: 1.233327e-06 ustep: 1 
iter: 5  mgc: 1.063594e-13 
iter: 1  mgc: 1.063594e-13 
outer mgc:  10.18917 
iter: 1  value: 144.3874 mgc: 20.26888 ustep: 1 
iter: 2  value: 143.8124 mgc: 2.27906 ustep: 1 
iter: 3  value: 143.8119 mgc: 0.07446563 ustep: 1 
iter: 4  value: 143.8119 mgc: 0.0001637872 ustep: 1 
iter: 5  mgc: 9.159042e-10 
iter: 1  value: 139.1924 mgc: 8.944095 ustep: 1 
iter: 2  value: 139.1844 mgc: 0.2589534 ustep: 1 
iter: 3  value: 139.1844 mgc: 0.0007673641 ustep: 1 
iter: 4  value: 139.1844 mgc: 1.957637e-08 ustep: 1 
mgc: 1.620926e-14 
iter: 1  mgc: 1.620926e-14 
outer mgc:  12.8032 
iter: 1  value: 135.6027 mgc: 4.091463 ustep: 1 
iter: 2  value: 135.5999 mgc: 0.1641743 ustep: 1 
iter: 3  value: 135.5999 mgc: 0.0001776773 ustep: 1 
iter: 4  mgc: 8.856484e-10 
iter: 1  mgc: 8.856484e-10 
outer mgc:  8.359218 
iter: 1  value: 131.5952 mgc: 19.92496 ustep: 1 
iter: 2  value: 131.124 mgc: 2.248742 ustep: 1 
iter: 3  value: 131.1238 mgc: 0.03811045 ustep: 1 
iter: 4  value: 131.1238 mgc: 3.399694e-05 ustep: 1 
iter: 5  mgc: 5.480261e-11 
iter: 1  mgc: 5.480261e-11 
outer mgc:  15.1743 
iter: 1  value: 126.618 mgc: 6.651628 ustep: 1 
iter: 2  value: 126.4724 mgc: 0.6743791 ustep: 1 
iter: 3  value: 126.4724 mgc: 0.01087889 ustep: 1 
iter: 4  value: 126.4724 mgc: 5.347316e-06 ustep: 1 
iter: 5  mgc: 1.303901e-12 
iter: 1  mgc: 1.303901e-12 
outer mgc:  11.65091 
iter: 1  value: 127.8714 mgc: 20.59752 ustep: 1 
iter: 2  value: 127.776 mgc: 1.046103 ustep: 1 
iter: 3  value: 127.776 mgc: 0.004857469 ustep: 1 
iter: 4  value: 127.776 mgc: 1.363328e-07 ustep: 1 
mgc: 2.242651e-14 
iter: 1  value: 124.5426 mgc: 5.563202 ustep: 1 
iter: 2  value: 124.5411 mgc: 0.1193817 ustep: 1 
iter: 3  value: 124.5411 mgc: 0.000115566 ustep: 1 
iter: 4  mgc: 1.101785e-10 
iter: 1  mgc: 1.101785e-10 
outer mgc:  6.701755 
iter: 1  value: 122.9417 mgc: 3.060876 ustep: 1 
iter: 2  value: 122.9408 mgc: 0.05476631 ustep: 1 
iter: 3  value: 122.9408 mgc: 9.173296e-05 ustep: 1 
iter: 4  mgc: 3.681673e-10 
iter: 1  mgc: 3.681673e-10 
outer mgc:  7.170749 
iter: 1  value: 122.6702 mgc: 5.133222 ustep: 1 
iter: 2  value: 122.6691 mgc: 0.1222872 ustep: 1 
iter: 3  value: 122.6691 mgc: 7.621702e-05 ustep: 1 
iter: 4  mgc: 4.524692e-11 
iter: 1  mgc: 4.524692e-11 
outer mgc:  9.143852 
iter: 1  value: 121.1964 mgc: 6.876309 ustep: 1 
iter: 2  value: 121.193 mgc: 0.1904341 ustep: 1 
iter: 3  value: 121.193 mgc: 0.0002529053 ustep: 1 
iter: 4  mgc: 4.509512e-10 
iter: 1  mgc: 4.509512e-10 
outer mgc:  3.933607 
iter: 1  value: 120.7262 mgc: 4.22418 ustep: 1 
iter: 2  value: 120.7258 mgc: 0.09196513 ustep: 1 
iter: 3  value: 120.7258 mgc: 4.029795e-05 ustep: 1 
iter: 4  mgc: 7.591261e-12 
iter: 1  mgc: 7.591261e-12 
outer mgc:  3.750304 
iter: 1  value: 120.0593 mgc: 0.8626625 ustep: 1 
iter: 2  value: 120.0593 mgc: 0.01327722 ustep: 1 
iter: 3  value: 120.0593 mgc: 2.330109e-06 ustep: 1 
iter: 4  mgc: 1.64313e-13 
iter: 1  mgc: 1.64313e-13 
outer mgc:  5.203808 
iter: 1  value: 119.0746 mgc: 1.576917 ustep: 1 
iter: 2  value: 119.0746 mgc: 0.02205195 ustep: 1 
iter: 3  value: 119.0746 mgc: 6.613814e-06 ustep: 1 
iter: 4  mgc: 1.039169e-12 
iter: 1  mgc: 1.039169e-12 
outer mgc:  2.124239 
iter: 1  value: 119.1233 mgc: 1.096875 ustep: 1 
iter: 2  value: 119.1233 mgc: 0.0117437 ustep: 1 
iter: 3  value: 119.1233 mgc: 1.523692e-06 ustep: 1 
iter: 4  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  1.824962 
iter: 1  value: 119.1611 mgc: 2.288663 ustep: 1 
iter: 2  value: 119.1607 mgc: 0.03964636 ustep: 1 
iter: 3  value: 119.1607 mgc: 2.665947e-05 ustep: 1 
iter: 4  mgc: 1.507061e-11 
iter: 1  mgc: 1.507061e-11 
outer mgc:  2.629105 
iter: 1  value: 118.9647 mgc: 2.432847 ustep: 1 
iter: 2  value: 118.9646 mgc: 0.02527101 ustep: 1 
iter: 3  value: 118.9646 mgc: 3.736093e-06 ustep: 1 
iter: 4  mgc: 1.185718e-13 
iter: 1  mgc: 1.185718e-13 
outer mgc:  1.908841 
iter: 1  value: 118.9926 mgc: 2.234418 ustep: 1 
iter: 2  value: 118.9926 mgc: 0.02095394 ustep: 1 
iter: 3  value: 118.9926 mgc: 3.496678e-06 ustep: 1 
iter: 4  mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  1.411696 
iter: 1  value: 118.8736 mgc: 1.207714 ustep: 1 
iter: 2  value: 118.8736 mgc: 0.006994105 ustep: 1 
iter: 3  value: 118.8736 mgc: 4.495159e-07 ustep: 1 
iter: 4  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.2772413 
iter: 1  value: 118.8948 mgc: 0.2026723 ustep: 1 
iter: 2  value: 118.8948 mgc: 0.0002036943 ustep: 1 
iter: 3  mgc: 2.802913e-10 
iter: 1  mgc: 2.802913e-10 
outer mgc:  0.1870938 
iter: 1  value: 118.8892 mgc: 0.1370014 ustep: 1 
iter: 2  value: 118.8892 mgc: 9.989678e-05 ustep: 1 
iter: 3  mgc: 1.368892e-10 
iter: 1  mgc: 1.368892e-10 
outer mgc:  0.07855098 
iter: 1  value: 118.886 mgc: 0.08625195 ustep: 1 
iter: 2  value: 118.886 mgc: 5.063203e-05 ustep: 1 
iter: 3  mgc: 3.283329e-11 
iter: 1  mgc: 3.283329e-11 
outer mgc:  0.01577439 
iter: 1  value: 118.8873 mgc: 0.01187519 ustep: 1 
iter: 2  value: 118.8873 mgc: 8.747745e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.003027779 
iter: 1  value: 118.8871 mgc: 0.001169565 ustep: 1 
iter: 2  mgc: 8.319009e-09 
iter: 1  mgc: 8.319009e-09 
outer mgc:  5.702202e-05 
iter: 1  value: 118.8871 mgc: 8.066891e-05 ustep: 1 
iter: 2  mgc: 3.261569e-11 
iter: 1  mgc: 3.261569e-11 
outer mgc:  4.598908e-06 
iter: 1  value: 118.8871 mgc: 3.689687e-06 ustep: 1 
iter: 2  mgc: 1.14353e-13 
iter: 1  mgc: 3.261569e-11 
iter: 1  mgc: 3.261569e-11 
outer mgc:  4.598908e-06 
iter: 1  value: 118.8876 mgc: 0.03957177 ustep: 1 
iter: 2  value: 118.8876 mgc: 4.590753e-06 ustep: 1 
iter: 3  mgc: 1.132427e-13 
outer mgc:  0.04539048 
iter: 1  value: 118.8866 mgc: 0.03957687 ustep: 1 
iter: 2  value: 118.8866 mgc: 4.585817e-06 ustep: 1 
iter: 3  mgc: 1.181277e-13 
outer mgc:  0.04538162 
iter: 1  value: 118.8877 mgc: 0.01257048 ustep: 1 
iter: 2  value: 118.8877 mgc: 7.48204e-07 ustep: 1 
iter: 3  mgc: 3.319567e-14 
outer mgc:  0.05811102 
iter: 1  value: 118.8866 mgc: 0.01257988 ustep: 1 
iter: 2  value: 118.8866 mgc: 7.490749e-07 ustep: 1 
iter: 3  mgc: 2.464695e-14 
outer mgc:  0.05814309 
iter: 1  value: 118.887 mgc: 0.03588199 ustep: 1 
iter: 2  value: 118.887 mgc: 5.934736e-06 ustep: 1 
iter: 3  mgc: 1.908473e-13 
outer mgc:  0.05312738 
iter: 1  value: 118.8873 mgc: 0.03586521 ustep: 1 
iter: 2  value: 118.8873 mgc: 5.940581e-06 ustep: 1 
iter: 3  mgc: 1.909584e-13 
outer mgc:  0.05313271 
iter: 1  value: 118.8866 mgc: 0.01218392 ustep: 1 
iter: 2  value: 118.8866 mgc: 7.604706e-07 ustep: 1 
iter: 3  mgc: 4.241052e-14 
outer mgc:  0.05498639 
iter: 1  value: 118.8876 mgc: 0.0121747 ustep: 1 
iter: 2  value: 118.8876 mgc: 7.59575e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.05496082 
iter: 1  value: 118.8863 mgc: 0.004289904 ustep: 1 
iter: 2  value: 118.8863 mgc: 1.361406e-07 ustep: 1 
mgc: 2.575717e-14 
outer mgc:  0.005853973 
iter: 1  value: 118.8879 mgc: 0.00428521 ustep: 1 
iter: 2  value: 118.8879 mgc: 1.359865e-07 ustep: 1 
mgc: 1.24345e-14 
outer mgc:  0.005853439 
iter: 1  value: 118.8887 mgc: 0.006964215 ustep: 1 
iter: 2  value: 118.8887 mgc: 3.6897e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.01695274 
iter: 1  value: 118.8855 mgc: 0.006980243 ustep: 1 
iter: 2  value: 118.8855 mgc: 3.700273e-07 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.01696534 
iter: 1  value: 118.8901 mgc: 0.009319638 ustep: 1 
iter: 2  value: 118.8901 mgc: 8.187331e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.01277649 
iter: 1  value: 118.8841 mgc: 0.009340564 ustep: 1 
iter: 2  value: 118.8841 mgc: 8.204633e-07 ustep: 1 
iter: 3  mgc: 2.331468e-14 
outer mgc:  0.01276806 
[Sat Aug 14 04:46:12 2021]
Finished job 0.
1 of 1 steps (100%) done

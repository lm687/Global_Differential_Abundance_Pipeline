Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 01:27:21 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22054.641695 
iter  10 value 15474.797979
iter  10 value 15474.797953
final  value 15474.797953 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 16326.79 mgc: 127.8667 ustep: 1 
iter: 2  value: 15803.81 mgc: 27.5573 ustep: 1 
iter: 3  value: 15783.6 mgc: 12.37952 ustep: 1 
iter: 4  value: 15783.42 mgc: 0.9344633 ustep: 1 
iter: 5  value: 15783.42 mgc: 0.0738671 ustep: 1 
iter: 6  value: 15783.42 mgc: 0.0005750499 ustep: 1 
iter: 7  value: 15783.42 mgc: 3.558915e-08 ustep: 1 
mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
Matching hessian patterns... Done
outer mgc:  4659.355 
iter: 1  value: 11566.49 mgc: 30.36764 ustep: 1 
iter: 2  value: 11543.89 mgc: 7.294958 ustep: 1 
iter: 3  value: 11543.82 mgc: 0.6261773 ustep: 1 
iter: 4  value: 11543.82 mgc: 0.008712179 ustep: 1 
iter: 5  value: 11543.82 mgc: 1.688996e-06 ustep: 1 
iter: 6  mgc: 6.594725e-14 
iter: 1  value: 7624.519 mgc: 69.09787 ustep: 0.6827823 
iter: 2  value: 4403.461 mgc: 69.69133 ustep: 0.8263238 
iter: 3  value: 4348.149 mgc: 10.6433 ustep: 0.9090326 
iter: 4  value: 4347.356 mgc: 1.526869 ustep: 0.9534367 
iter: 5  value: 4347.355 mgc: 0.06487088 ustep: 0.9764432 
iter: 6  value: 4347.355 mgc: 0.0003060833 ustep: 0.9881526 
iter: 7  value: 4347.355 mgc: 4.239256e-07 ustep: 0.9940592 
iter: 8  mgc: 3.347278e-10 
iter: 1  mgc: 3.347278e-10 
outer mgc:  1066.883 
iter: 1  value: 2169.036 mgc: 42.38831 ustep: 1 
iter: 2  value: 2145.77 mgc: 9.901254 ustep: 1 
iter: 3  value: 2145.74 mgc: 0.6019313 ustep: 1 
iter: 4  value: 2145.74 mgc: 0.002458248 ustep: 1 
iter: 5  value: 2145.74 mgc: 5.814381e-08 ustep: 1 
mgc: 3.053113e-14 
iter: 1  mgc: 3.053113e-14 
outer mgc:  328.0914 
iter: 1  value: 18027.9 mgc: 104.0631 ustep: 0.2494656 
iter: 2  value: 13119.61 mgc: 138.1319 ustep: 0.08285847 
iter: 3  value: 9709.729 mgc: 141.9576 ustep: 0.08137205 
iter: 4  value: 8844.935 mgc: 120.8033 ustep: 0.08053699 
iter: 5  value: 8340.544 mgc: 124.0454 ustep: 0.08006551 
iter: 6  value: 8135.8 mgc: 100.5213 ustep: 0.07979855 
iter: 7  value: 8073.609 mgc: 104.7923 ustep: 0.1529653 
iter: 8  value: 8060.354 mgc: 88.83439 ustep: 0.3911687 
iter: 9  value: 8056.559 mgc: 82.42404 ustep: 0.3879745 
iter: 10  value: 8029.122 mgc: 85.29756 ustep: 0.6229137 
iter: 11  value: 7993.453 mgc: 74.61223 ustep: 0.7892699 
iter: 12  value: 7953.15 mgc: 61.98549 ustep: 0.8884198 
iter: 13  value: 7949.148 mgc: 19.94875 ustep: 0.942566 
iter: 14  value: 7949.143 mgc: 0.6188118 ustep: 0.9708613 
iter: 15  value: 7949.143 mgc: 0.0004821579 ustep: 0.9853244 
iter: 16  value: 7949.143 mgc: 3.465176e-07 ustep: 0.9926358 
iter: 17  mgc: 1.53709e-10 
iter: 1  value: 1992.863 mgc: 11.92567 ustep: 1 
iter: 2  value: 1992.851 mgc: 0.2839931 ustep: 1 
iter: 3  value: 1992.851 mgc: 0.0005680198 ustep: 1 
iter: 4  mgc: 2.379404e-09 
iter: 1  mgc: 2.379404e-09 
outer mgc:  183.8769 
iter: 1  value: 1941.128 mgc: 9.515035 ustep: 1 
iter: 2  value: 1941.123 mgc: 0.2090653 ustep: 1 
iter: 3  value: 1941.123 mgc: 0.0002768428 ustep: 1 
iter: 4  mgc: 5.74776e-10 
iter: 1  mgc: 5.74776e-10 
outer mgc:  117.4861 
iter: 1  value: 1940.546 mgc: 9.246464 ustep: 1 
iter: 2  value: 1940.43 mgc: 0.5293454 ustep: 1 
iter: 3  value: 1940.43 mgc: 0.00216339 ustep: 1 
iter: 4  value: 1940.43 mgc: 3.573233e-08 ustep: 1 
mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  135.2794 
iter: 1  value: 1906.22 mgc: 10.15343 ustep: 1 
iter: 2  value: 1906.157 mgc: 0.3769651 ustep: 1 
iter: 3  value: 1906.157 mgc: 0.006472081 ustep: 1 
iter: 4  value: 1906.157 mgc: 2.025216e-06 ustep: 1 
iter: 5  mgc: 2.002842e-13 
iter: 1  mgc: 2.002842e-13 
outer mgc:  80.88077 
iter: 1  value: 1895.195 mgc: 13.73066 ustep: 1 
iter: 2  value: 1894.101 mgc: 1.204658 ustep: 1 
iter: 3  value: 1894.101 mgc: 0.01067503 ustep: 1 
iter: 4  value: 1894.101 mgc: 1.583391e-06 ustep: 1 
iter: 5  mgc: 4.373585e-14 
iter: 1  mgc: 4.373585e-14 
outer mgc:  65.13984 
iter: 1  value: 1874.061 mgc: 7.594635 ustep: 1 
iter: 2  value: 1873.941 mgc: 0.4502383 ustep: 1 
iter: 3  value: 1873.941 mgc: 0.00908598 ustep: 1 
iter: 4  value: 1873.941 mgc: 3.910666e-06 ustep: 1 
iter: 5  mgc: 7.229772e-13 
iter: 1  mgc: 7.229772e-13 
outer mgc:  33.27087 
iter: 1  value: 1895.47 mgc: 13.56933 ustep: 1 
iter: 2  value: 1895.458 mgc: 0.2767584 ustep: 1 
iter: 3  value: 1895.458 mgc: 0.0001305836 ustep: 1 
iter: 4  mgc: 1.061911e-10 
iter: 1  value: 1868.983 mgc: 3.089924 ustep: 1 
iter: 2  value: 1868.983 mgc: 0.01275082 ustep: 1 
iter: 3  value: 1868.983 mgc: 3.17584e-07 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  23.15282 
iter: 1  value: 1867.242 mgc: 2.681485 ustep: 1 
iter: 2  value: 1867.241 mgc: 0.04221882 ustep: 1 
iter: 3  value: 1867.241 mgc: 1.307567e-05 ustep: 1 
iter: 4  mgc: 2.151168e-12 
iter: 1  mgc: 2.151168e-12 
outer mgc:  27.85169 
iter: 1  value: 1863.419 mgc: 3.532329 ustep: 1 
iter: 2  value: 1863.419 mgc: 0.01732447 ustep: 1 
iter: 3  value: 1863.419 mgc: 1.781438e-06 ustep: 1 
iter: 4  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  24.09698 
iter: 1  value: 1859.252 mgc: 4.105179 ustep: 1 
iter: 2  value: 1859.245 mgc: 0.101525 ustep: 1 
iter: 3  value: 1859.245 mgc: 0.0001145705 ustep: 1 
iter: 4  mgc: 2.106142e-10 
iter: 1  mgc: 2.106142e-10 
outer mgc:  17.35355 
iter: 1  value: 1857.95 mgc: 6.583434 ustep: 1 
iter: 2  value: 1857.891 mgc: 0.3053684 ustep: 1 
iter: 3  value: 1857.891 mgc: 0.001484075 ustep: 1 
iter: 4  value: 1857.891 mgc: 3.56679e-08 ustep: 1 
mgc: 4.743428e-14 
iter: 1  mgc: 4.743428e-14 
outer mgc:  31.64473 
iter: 1  value: 1860.545 mgc: 9.158731 ustep: 1 
iter: 2  value: 1860.526 mgc: 0.2189517 ustep: 1 
iter: 3  value: 1860.526 mgc: 0.0005282007 ustep: 1 
iter: 4  mgc: 3.106896e-09 
iter: 1  value: 1855.94 mgc: 2.779074 ustep: 1 
iter: 2  value: 1855.94 mgc: 0.02947094 ustep: 1 
iter: 3  value: 1855.94 mgc: 9.373844e-06 ustep: 1 
iter: 4  mgc: 9.525714e-13 
iter: 1  mgc: 9.525714e-13 
outer mgc:  31.07536 
iter: 1  value: 1854.14 mgc: 5.291597 ustep: 1 
iter: 2  value: 1854.139 mgc: 0.04305753 ustep: 1 
iter: 3  value: 1854.139 mgc: 1.385901e-05 ustep: 1 
iter: 4  mgc: 1.371792e-12 
iter: 1  value: 1853.953 mgc: 2.11336 ustep: 1 
iter: 2  value: 1853.953 mgc: 0.01202617 ustep: 1 
iter: 3  value: 1853.953 mgc: 1.085537e-06 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  16.84033 
iter: 1  value: 1853.203 mgc: 1.595775 ustep: 1 
iter: 2  value: 1853.203 mgc: 0.01336333 ustep: 1 
iter: 3  value: 1853.203 mgc: 6.412177e-06 ustep: 1 
iter: 4  mgc: 1.459277e-12 
iter: 1  mgc: 1.459277e-12 
outer mgc:  6.438681 
iter: 1  value: 1853.215 mgc: 1.686064 ustep: 1 
iter: 2  value: 1853.215 mgc: 0.005962935 ustep: 1 
iter: 3  value: 1853.215 mgc: 2.191786e-07 ustep: 1 
iter: 4  mgc: 3.608225e-14 
iter: 1  mgc: 3.608225e-14 
outer mgc:  5.844989 
iter: 1  value: 1853.035 mgc: 0.7369578 ustep: 1 
iter: 2  value: 1853.035 mgc: 0.002843045 ustep: 1 
iter: 3  value: 1853.035 mgc: 8.523974e-08 ustep: 1 
iter: 4  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  5.98857 
iter: 1  value: 1853.749 mgc: 0.8385984 ustep: 1 
iter: 2  value: 1853.749 mgc: 0.00347641 ustep: 1 
iter: 3  value: 1853.749 mgc: 8.885153e-08 ustep: 1 
mgc: 3.474998e-14 
iter: 1  value: 1853.189 mgc: 0.3093411 ustep: 1 
iter: 2  value: 1853.189 mgc: 0.000268734 ustep: 1 
iter: 3  mgc: 4.978429e-10 
iter: 1  mgc: 4.978429e-10 
outer mgc:  2.283275 
iter: 1  value: 1853.161 mgc: 0.1932139 ustep: 1 
iter: 2  value: 1853.161 mgc: 9.121399e-05 ustep: 1 
iter: 3  mgc: 2.935816e-10 
iter: 1  mgc: 2.935816e-10 
outer mgc:  0.7051266 
iter: 1  value: 1853.155 mgc: 0.03896697 ustep: 1 
iter: 2  value: 1853.155 mgc: 2.282771e-05 ustep: 1 
iter: 3  mgc: 1.906519e-11 
iter: 1  value: 1853.173 mgc: 0.03326373 ustep: 1 
iter: 2  value: 1853.173 mgc: 2.722314e-06 ustep: 1 
iter: 3  mgc: 2.713385e-13 
iter: 1  mgc: 2.713385e-13 
outer mgc:  0.6275457 
iter: 1  value: 1853.149 mgc: 0.1402192 ustep: 1 
iter: 2  value: 1853.149 mgc: 0.0001042984 ustep: 1 
iter: 3  mgc: 1.052581e-10 
iter: 1  mgc: 1.052581e-10 
outer mgc:  0.3622093 
iter: 1  value: 1853.164 mgc: 0.09358363 ustep: 1 
iter: 2  value: 1853.164 mgc: 4.325164e-05 ustep: 1 
iter: 3  mgc: 1.35838e-11 
iter: 1  mgc: 1.35838e-11 
outer mgc:  0.2495049 
iter: 1  value: 1853.151 mgc: 0.05950264 ustep: 1 
iter: 2  value: 1853.151 mgc: 6.78394e-06 ustep: 1 
iter: 3  mgc: 3.479439e-13 
iter: 1  mgc: 3.479439e-13 
outer mgc:  0.4961673 
iter: 1  value: 1853.17 mgc: 0.02723536 ustep: 1 
iter: 2  value: 1853.17 mgc: 1.992597e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  0.108222 
iter: 1  value: 1853.156 mgc: 0.01060091 ustep: 1 
iter: 2  value: 1853.156 mgc: 4.600454e-06 ustep: 1 
iter: 3  mgc: 8.832934e-13 
iter: 1  value: 1853.163 mgc: 0.004768703 ustep: 1 
iter: 2  value: 1853.163 mgc: 1.014515e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  0.04304368 
iter: 1  value: 1853.162 mgc: 0.009361812 ustep: 1 
iter: 2  value: 1853.162 mgc: 4.497322e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  value: 1853.164 mgc: 0.002644955 ustep: 1 
iter: 2  value: 1853.164 mgc: 3.393756e-08 ustep: 1 
mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  0.0382871 
iter: 1  value: 1853.161 mgc: 0.003843024 ustep: 1 
iter: 2  value: 1853.161 mgc: 2.131984e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  0.02117062 
iter: 1  value: 1853.163 mgc: 0.002221671 ustep: 1 
iter: 2  value: 1853.163 mgc: 1.217131e-08 ustep: 1 
mgc: 3.363976e-14 
iter: 1  mgc: 3.363976e-14 
outer mgc:  0.008324965 
iter: 1  value: 1853.163 mgc: 0.004415849 ustep: 1 
iter: 2  value: 1853.163 mgc: 1.123312e-07 ustep: 1 
iter: 3  mgc: 3.314016e-14 
iter: 1  value: 1853.163 mgc: 0.001371108 ustep: 1 
iter: 2  mgc: 9.976861e-09 
iter: 1  mgc: 9.976861e-09 
outer mgc:  0.01034174 
iter: 1  value: 1853.163 mgc: 0.0006785938 ustep: 1 
iter: 2  mgc: 1.525997e-09 
iter: 1  mgc: 1.525997e-09 
outer mgc:  0.001503593 
iter: 1  value: 1853.163 mgc: 0.0006043877 ustep: 1 
iter: 2  mgc: 1.029119e-09 
iter: 1  mgc: 1.029119e-09 
outer mgc:  0.002777866 
iter: 1  mgc: 1.029119e-09 
iter: 1  mgc: 1.029119e-09 
outer mgc:  0.002777866 
iter: 1  value: 1853.165 mgc: 0.0337909 ustep: 1 
iter: 2  value: 1853.165 mgc: 2.945724e-06 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.2198511 
iter: 1  value: 1853.161 mgc: 0.03378853 ustep: 1 
iter: 2  value: 1853.161 mgc: 2.938852e-06 ustep: 1 
iter: 3  mgc: 3.630429e-14 
outer mgc:  0.2193681 
iter: 1  value: 1853.176 mgc: 0.02455897 ustep: 1 
iter: 2  value: 1853.176 mgc: 9.973368e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.6237638 
iter: 1  value: 1853.15 mgc: 0.0245652 ustep: 1 
iter: 2  value: 1853.15 mgc: 9.930379e-07 ustep: 1 
iter: 3  mgc: 3.308465e-14 
outer mgc:  0.6295649 
iter: 1  value: 1853.16 mgc: 0.03868276 ustep: 1 
iter: 2  value: 1853.16 mgc: 8.022645e-06 ustep: 1 
iter: 3  mgc: 6.122602e-13 
outer mgc:  0.2130211 
iter: 1  value: 1853.165 mgc: 0.0386752 ustep: 1 
iter: 2  value: 1853.165 mgc: 8.030803e-06 ustep: 1 
iter: 3  mgc: 6.05932e-13 
outer mgc:  0.2120892 
iter: 1  value: 1853.157 mgc: 0.01645911 ustep: 1 
iter: 2  value: 1853.157 mgc: 1.608202e-06 ustep: 1 
iter: 3  mgc: 3.130829e-14 
outer mgc:  0.4046394 
iter: 1  value: 1853.168 mgc: 0.01644958 ustep: 1 
iter: 2  value: 1853.168 mgc: 1.607694e-06 ustep: 1 
iter: 3  mgc: 3.005929e-14 
outer mgc:  0.4059489 
iter: 1  value: 1853.156 mgc: 0.004251569 ustep: 1 
iter: 2  value: 1853.156 mgc: 5.535472e-07 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.05949313 
iter: 1  value: 1853.169 mgc: 0.004247955 ustep: 1 
iter: 2  value: 1853.169 mgc: 5.529403e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.05847961 
iter: 1  value: 1853.169 mgc: 0.007977641 ustep: 1 
iter: 2  value: 1853.169 mgc: 4.014513e-07 ustep: 1 
iter: 3  mgc: 3.252953e-14 
outer mgc:  0.2510429 
iter: 1  value: 1853.156 mgc: 0.007995166 ustep: 1 
iter: 2  value: 1853.156 mgc: 4.019785e-07 ustep: 1 
iter: 3  mgc: 4.701795e-14 
outer mgc:  0.2521987 
iter: 1  value: 1853.175 mgc: 0.0084751 ustep: 1 
iter: 2  value: 1853.175 mgc: 2.981727e-06 ustep: 1 
iter: 3  mgc: 3.721468e-13 
outer mgc:  0.2265885 
iter: 1  value: 1853.151 mgc: 0.008495304 ustep: 1 
iter: 2  value: 1853.151 mgc: 2.990654e-06 ustep: 1 
iter: 3  mgc: 3.761436e-13 
outer mgc:  0.2270041 
[Sat Aug 14 01:27:23 2021]
Finished job 0.
1 of 1 steps (100%) done

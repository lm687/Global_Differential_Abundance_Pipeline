Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:35:29 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22070.022267 
final  value 20602.476694 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19588.74 mgc: 4.637996 ustep: 1 
iter: 2  value: 19562.49 mgc: 6.097258 ustep: 0.8994163 
iter: 3  value: 19508.05 mgc: 5.747421 ustep: 0.523213 
iter: 4  value: 19484.33 mgc: 3.655136 ustep: 0.473989 
iter: 5  value: 19471.66 mgc: 3.02006 ustep: 0.4418337 
iter: 6  value: 19464.69 mgc: 1.369159 ustep: 0.6647393 
iter: 7  value: 19463.7 mgc: 1.014964 ustep: 0.8153339 
iter: 8  value: 19463.68 mgc: 0.17385 ustep: 0.9029681 
iter: 9  value: 19463.68 mgc: 0.01415255 ustep: 0.9502513 
iter: 10  value: 19463.68 mgc: 0.0005806686 ustep: 0.9748109 
iter: 11  value: 19463.68 mgc: 1.18314e-05 ustep: 0.9873264 
iter: 12  value: 19463.68 mgc: 1.204758e-07 ustep: 0.9936436 
iter: 13  mgc: 6.438743e-10 
iter: 1  mgc: 6.438743e-10 
Matching hessian patterns... Done
outer mgc:  131.7626 
iter: 1  value: 19269.69 mgc: 1.491575 ustep: 1 
iter: 2  value: 19269.65 mgc: 0.1357272 ustep: 1 
iter: 3  value: 19269.65 mgc: 0.001969522 ustep: 1 
iter: 4  value: 19269.65 mgc: 4.208993e-07 ustep: 1 
iter: 5  mgc: 2.043504e-14 
iter: 1  value: 19110.35 mgc: 9.167859 ustep: 1 
iter: 2  value: 19109.36 mgc: 1.142932 ustep: 1 
iter: 3  value: 19109.36 mgc: 0.03816632 ustep: 1 
iter: 4  value: 19109.36 mgc: 0.0001228008 ustep: 1 
iter: 5  mgc: 1.0459e-09 
iter: 1  mgc: 1.0459e-09 
outer mgc:  173.9161 
iter: 1  value: 20115.28 mgc: 59.8963 ustep: 1 
iter: 2  value: 20004.66 mgc: 7.820517 ustep: 1 
iter: 3  value: 20004.08 mgc: 0.6862527 ustep: 1 
iter: 4  value: 20004.08 mgc: 0.00693142 ustep: 1 
iter: 5  value: 20004.08 mgc: 2.016074e-06 ustep: 1 
iter: 6  mgc: 1.74083e-13 
iter: 1  value: 19088.13 mgc: 5.118242 ustep: 1 
iter: 2  value: 19088.11 mgc: 0.1789881 ustep: 1 
iter: 3  value: 19088.11 mgc: 0.001239745 ustep: 1 
iter: 4  value: 19088.11 mgc: 5.343503e-08 ustep: 1 
mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  150.8956 
iter: 1  value: 19054.61 mgc: 5.168221 ustep: 1 
iter: 2  value: 19053.09 mgc: 0.9925103 ustep: 1 
iter: 3  value: 19053.09 mgc: 0.0250843 ustep: 1 
iter: 4  value: 19053.09 mgc: 3.141346e-05 ustep: 1 
iter: 5  mgc: 1.040728e-10 
iter: 1  mgc: 1.040728e-10 
outer mgc:  79.69668 
iter: 1  value: 19023.99 mgc: 3.499575 ustep: 1 
iter: 2  value: 19023.81 mgc: 0.3344682 ustep: 1 
iter: 3  value: 19023.81 mgc: 0.008758216 ustep: 1 
iter: 4  value: 19023.81 mgc: 1.032275e-05 ustep: 1 
iter: 5  mgc: 1.248335e-11 
iter: 1  mgc: 1.248335e-11 
outer mgc:  29.86446 
iter: 1  value: 19003.96 mgc: 8.06048 ustep: 1 
iter: 2  value: 19003.92 mgc: 0.365649 ustep: 1 
iter: 3  value: 19003.92 mgc: 0.001257497 ustep: 1 
iter: 4  value: 19003.92 mgc: 1.158357e-07 ustep: 1 
iter: 5  mgc: 1.021405e-14 
iter: 1  value: 19007.01 mgc: 1.947206 ustep: 1 
iter: 2  value: 19007.01 mgc: 0.02380708 ustep: 1 
iter: 3  value: 19007.01 mgc: 1.001183e-05 ustep: 1 
iter: 4  mgc: 1.149969e-11 
iter: 1  mgc: 1.149969e-11 
outer mgc:  27.01218 
iter: 1  value: 18999.92 mgc: 1.974372 ustep: 1 
iter: 2  value: 18999.92 mgc: 0.02773116 ustep: 1 
iter: 3  value: 18999.92 mgc: 2.019429e-05 ustep: 1 
iter: 4  mgc: 1.723111e-11 
iter: 1  value: 19001.19 mgc: 0.9152985 ustep: 1 
iter: 2  value: 19001.19 mgc: 0.005722517 ustep: 1 
iter: 3  value: 19001.19 mgc: 9.888177e-07 ustep: 1 
iter: 4  mgc: 5.506706e-14 
iter: 1  mgc: 5.506706e-14 
outer mgc:  16.7793 
iter: 1  value: 18994.51 mgc: 1.065997 ustep: 1 
iter: 2  value: 18994.51 mgc: 0.004590894 ustep: 1 
iter: 3  value: 18994.51 mgc: 4.97072e-07 ustep: 1 
iter: 4  mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  18.19593 
iter: 1  value: 18981.49 mgc: 2.729582 ustep: 1 
iter: 2  value: 18981.49 mgc: 0.03716066 ustep: 1 
iter: 3  value: 18981.49 mgc: 8.068773e-06 ustep: 1 
iter: 4  mgc: 1.493028e-12 
iter: 1  mgc: 1.493028e-12 
outer mgc:  22.76355 
iter: 1  value: 18970.96 mgc: 2.267184 ustep: 1 
iter: 2  value: 18970.96 mgc: 0.02430463 ustep: 1 
iter: 3  value: 18970.96 mgc: 1.723732e-05 ustep: 1 
iter: 4  mgc: 4.737266e-12 
iter: 1  mgc: 4.737266e-12 
outer mgc:  14.38227 
iter: 1  value: 18962.23 mgc: 1.354108 ustep: 1 
iter: 2  value: 18962.23 mgc: 0.00954594 ustep: 1 
iter: 3  value: 18962.23 mgc: 1.673992e-06 ustep: 1 
iter: 4  mgc: 1.589839e-13 
iter: 1  mgc: 1.589839e-13 
outer mgc:  12.87885 
iter: 1  value: 18965.4 mgc: 1.964598 ustep: 1 
iter: 2  value: 18965.4 mgc: 0.01103913 ustep: 1 
iter: 3  value: 18965.4 mgc: 8.877684e-07 ustep: 1 
iter: 4  mgc: 4.973799e-14 
iter: 1  value: 18961.74 mgc: 0.5077687 ustep: 1 
iter: 2  value: 18961.74 mgc: 0.001060079 ustep: 1 
iter: 3  mgc: 4.559342e-09 
iter: 1  mgc: 4.559342e-09 
outer mgc:  10.27706 
iter: 1  value: 18960.16 mgc: 0.6027677 ustep: 1 
iter: 2  value: 18960.16 mgc: 0.0008650836 ustep: 1 
iter: 3  value: 18960.16 mgc: 2.668364e-08 ustep: 1 
iter: 4  mgc: 9.992007e-15 
iter: 1  mgc: 9.992007e-15 
outer mgc:  8.106739 
iter: 1  value: 18957.82 mgc: 0.5333788 ustep: 1 
iter: 2  value: 18957.82 mgc: 0.001451632 ustep: 1 
iter: 3  value: 18957.82 mgc: 1.120943e-07 ustep: 1 
iter: 4  mgc: 7.21645e-15 
iter: 1  mgc: 7.21645e-15 
outer mgc:  3.952487 
iter: 1  value: 18951.48 mgc: 1.094785 ustep: 1 
iter: 2  value: 18951.48 mgc: 0.004058063 ustep: 1 
iter: 3  value: 18951.48 mgc: 2.062168e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  6.089073 
iter: 1  value: 18945.81 mgc: 1.368277 ustep: 1 
iter: 2  value: 18945.81 mgc: 0.006127335 ustep: 1 
iter: 3  value: 18945.81 mgc: 1.021168e-07 ustep: 1 
iter: 4  mgc: 8.770762e-15 
iter: 1  mgc: 8.770762e-15 
outer mgc:  2.183128 
iter: 1  value: 18942.13 mgc: 1.079788 ustep: 1 
iter: 2  value: 18942.13 mgc: 0.005437618 ustep: 1 
iter: 3  value: 18942.13 mgc: 1.357115e-06 ustep: 1 
iter: 4  mgc: 5.861978e-14 
iter: 1  value: 18944.61 mgc: 0.3235628 ustep: 1 
iter: 2  value: 18944.61 mgc: 0.0005333549 ustep: 1 
iter: 3  value: 18944.61 mgc: 1.355863e-08 ustep: 1 
mgc: 8.049117e-15 
iter: 1  mgc: 8.049117e-15 
outer mgc:  3.282404 
iter: 1  value: 18943.21 mgc: 0.2477561 ustep: 1 
iter: 2  value: 18943.21 mgc: 0.00011606 ustep: 1 
iter: 3  mgc: 1.476455e-10 
iter: 1  mgc: 1.476455e-10 
outer mgc:  4.044542 
iter: 1  value: 18941.73 mgc: 0.2591038 ustep: 1 
iter: 2  value: 18941.73 mgc: 3.476377e-05 ustep: 1 
iter: 3  mgc: 3.30953e-11 
iter: 1  mgc: 3.30953e-11 
outer mgc:  1.053211 
iter: 1  value: 18937.43 mgc: 0.5674236 ustep: 1 
iter: 2  value: 18937.43 mgc: 0.001233854 ustep: 1 
iter: 3  value: 18937.43 mgc: 9.386252e-08 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  4.591315 
iter: 1  value: 18932.06 mgc: 0.9286657 ustep: 1 
iter: 2  value: 18932.06 mgc: 0.0009315296 ustep: 1 
iter: 3  value: 18932.06 mgc: 1.800241e-08 ustep: 1 
mgc: 6.439294e-15 
iter: 1  value: 18925.89 mgc: 1.152147 ustep: 1 
iter: 2  value: 18925.89 mgc: 0.001282548 ustep: 1 
iter: 3  value: 18925.89 mgc: 4.112565e-08 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  6.220098 
iter: 1  value: 18921.91 mgc: 1.582886 ustep: 1 
iter: 2  value: 18921.91 mgc: 0.002108981 ustep: 1 
iter: 3  value: 18921.91 mgc: 3.111652e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  1.439939 
iter: 1  value: 18915.46 mgc: 1.207741 ustep: 1 
iter: 2  value: 18915.46 mgc: 0.0005522742 ustep: 1 
iter: 3  mgc: 4.527247e-09 
iter: 1  value: 18919.83 mgc: 0.3305618 ustep: 1 
iter: 2  value: 18919.83 mgc: 7.077585e-05 ustep: 1 
iter: 3  mgc: 4.119372e-11 
iter: 1  mgc: 4.119372e-11 
outer mgc:  1.572562 
iter: 1  value: 18917.67 mgc: 0.3327044 ustep: 1 
iter: 2  value: 18917.67 mgc: 0.0001284662 ustep: 1 
iter: 3  mgc: 2.508918e-10 
iter: 1  mgc: 2.508918e-10 
outer mgc:  0.7035646 
iter: 1  value: 18913.97 mgc: 0.6794715 ustep: 1 
iter: 2  value: 18913.97 mgc: 0.0004379717 ustep: 1 
iter: 3  mgc: 1.047968e-09 
iter: 1  mgc: 1.047968e-09 
outer mgc:  2.595936 
iter: 1  value: 18911.54 mgc: 0.3711758 ustep: 1 
iter: 2  value: 18911.54 mgc: 7.633401e-05 ustep: 1 
iter: 3  mgc: 4.787815e-11 
iter: 1  mgc: 4.787815e-11 
outer mgc:  1.4795 
iter: 1  value: 18909.33 mgc: 0.443918 ustep: 1 
iter: 2  value: 18909.33 mgc: 8.507964e-05 ustep: 1 
iter: 3  mgc: 4.068479e-11 
iter: 1  mgc: 4.068479e-11 
outer mgc:  0.5885412 
iter: 1  value: 18906.98 mgc: 0.4758799 ustep: 1 
iter: 2  value: 18906.98 mgc: 0.0001073257 ustep: 1 
iter: 3  mgc: 3.455289e-10 
iter: 1  mgc: 3.455289e-10 
outer mgc:  1.108745 
iter: 1  value: 18904.94 mgc: 0.3484744 ustep: 1 
iter: 2  value: 18904.94 mgc: 4.055153e-05 ustep: 1 
iter: 3  mgc: 9.007017e-12 
iter: 1  value: 18899.04 mgc: 1.072415 ustep: 1 
iter: 2  value: 18899.04 mgc: 0.0002849004 ustep: 1 
iter: 3  mgc: 6.113936e-10 
iter: 1  mgc: 6.113936e-10 
outer mgc:  0.8702757 
iter: 1  value: 18881.38 mgc: 2.786595 ustep: 1 
iter: 2  value: 18881.38 mgc: 0.002038353 ustep: 1 
iter: 3  value: 18881.38 mgc: 1.669803e-07 ustep: 1 
iter: 4  mgc: 1.665335e-14 
iter: 1  mgc: 1.665335e-14 
outer mgc:  0.7439909 
iter: 1  value: 18872.07 mgc: 1.659249 ustep: 1 
iter: 2  value: 18872.07 mgc: 0.000363281 ustep: 1 
iter: 3  mgc: 3.193145e-09 
iter: 1  mgc: 3.193145e-09 
outer mgc:  0.7106553 
iter: 1  value: 18866.62 mgc: 1.246093 ustep: 1 
iter: 2  value: 18866.62 mgc: 0.0002029332 ustep: 1 
iter: 3  mgc: 2.758309e-10 
iter: 1  mgc: 2.758309e-10 
outer mgc:  0.1857391 
iter: 1  value: 18860.49 mgc: 0.9818231 ustep: 1 
iter: 2  value: 18860.49 mgc: 4.120977e-05 ustep: 1 
iter: 3  mgc: 2.668088e-11 
iter: 1  mgc: 2.668088e-11 
outer mgc:  0.1374953 
iter: 1  value: 18847.11 mgc: 2.208616 ustep: 1 
iter: 2  value: 18847.11 mgc: 0.000146218 ustep: 1 
iter: 3  mgc: 2.655209e-10 
iter: 1  mgc: 2.655209e-10 
outer mgc:  0.1509583 
iter: 1  value: 18837.17 mgc: 1.599315 ustep: 1 
iter: 2  value: 18837.17 mgc: 5.124073e-05 ustep: 1 
iter: 3  mgc: 3.985701e-13 
iter: 1  mgc: 3.985701e-13 
outer mgc:  0.1563153 
iter: 1  value: 18827.88 mgc: 1.55492 ustep: 1 
iter: 2  value: 18827.88 mgc: 3.236193e-05 ustep: 1 
iter: 3  mgc: 1.448175e-11 
iter: 1  mgc: 1.448175e-11 
outer mgc:  0.1193296 
iter: 1  value: 18819.62 mgc: 1.386352 ustep: 1 
iter: 2  value: 18819.62 mgc: 1.770717e-05 ustep: 1 
iter: 3  mgc: 1.471712e-12 
iter: 1  mgc: 1.471712e-12 
outer mgc:  0.04297243 
iter: 1  value: 18811.87 mgc: 1.288405 ustep: 1 
iter: 2  value: 18811.87 mgc: 1.058684e-05 ustep: 1 
iter: 3  mgc: 1.206146e-12 
iter: 1  mgc: 1.206146e-12 
outer mgc:  0.03205147 
iter: 1  value: 18805.11 mgc: 1.101608 ustep: 1 
iter: 2  value: 18805.11 mgc: 5.969869e-06 ustep: 1 
iter: 3  mgc: 2.406964e-13 
iter: 1  mgc: 2.406964e-13 
outer mgc:  0.008653748 
iter: 1  value: 18799.96 mgc: 0.8173033 ustep: 1 
iter: 2  value: 18799.96 mgc: 2.555325e-06 ustep: 1 
iter: 3  mgc: 6.794565e-14 
iter: 1  mgc: 6.794565e-14 
outer mgc:  0.01224692 
iter: 1  value: 18796.83 mgc: 0.4938319 ustep: 1 
iter: 2  value: 18796.83 mgc: 8.731835e-07 ustep: 1 
iter: 3  mgc: 7.549517e-14 
iter: 1  mgc: 7.549517e-14 
outer mgc:  0.001552841 
iter: 1  value: 18795.41 mgc: 0.2176074 ustep: 1 
iter: 2  value: 18795.41 mgc: 1.497775e-07 ustep: 1 
iter: 3  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.002028691 
iter: 1  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.002028691 
iter: 1  value: 18795.42 mgc: 0.006450626 ustep: 1 
iter: 2  value: 18795.42 mgc: 1.501918e-08 ustep: 1 
mgc: 1.314504e-13 
outer mgc:  0.4878912 
iter: 1  value: 18795.4 mgc: 0.006449905 ustep: 1 
iter: 2  value: 18795.4 mgc: 1.498144e-08 ustep: 1 
mgc: 8.493206e-14 
outer mgc:  0.486983 
iter: 1  value: 18795.42 mgc: 0.003338061 ustep: 1 
iter: 2  value: 18795.42 mgc: 1.052005e-08 ustep: 1 
mgc: 9.592327e-14 
outer mgc:  0.2573629 
iter: 1  value: 18795.41 mgc: 0.003338407 ustep: 1 
iter: 2  value: 18795.41 mgc: 1.050039e-08 ustep: 1 
mgc: 1.076916e-13 
outer mgc:  0.257363 
iter: 1  value: 18795.41 mgc: 0.006148578 ustep: 1 
iter: 2  value: 18795.41 mgc: 2.261748e-07 ustep: 1 
iter: 3  mgc: 1.136868e-13 
outer mgc:  0.4258118 
iter: 1  value: 18795.41 mgc: 0.006147784 ustep: 1 
iter: 2  value: 18795.41 mgc: 2.262403e-07 ustep: 1 
iter: 3  mgc: 1.167955e-13 
outer mgc:  0.4265638 
iter: 1  value: 18795.41 mgc: 0.003172788 ustep: 1 
iter: 2  value: 18795.41 mgc: 6.023252e-08 ustep: 1 
iter: 3  mgc: 6.328271e-14 
outer mgc:  0.2439194 
iter: 1  value: 18795.41 mgc: 0.003173474 ustep: 1 
iter: 2  value: 18795.41 mgc: 6.023734e-08 ustep: 1 
iter: 3  mgc: 6.27276e-14 
outer mgc:  0.2433881 
iter: 1  value: 18795.51 mgc: 0.3776266 ustep: 1 
iter: 2  value: 18795.51 mgc: 1.148841e-06 ustep: 1 
iter: 3  mgc: 1.039169e-13 
outer mgc:  0.03373741 
iter: 1  value: 18795.32 mgc: 0.3787577 ustep: 1 
iter: 2  value: 18795.32 mgc: 1.146793e-06 ustep: 1 
iter: 3  mgc: 1.136868e-13 
outer mgc:  0.03459981 
iter: 1  value: 18795.47 mgc: 0.3792729 ustep: 1 
iter: 2  value: 18795.47 mgc: 1.820441e-06 ustep: 1 
iter: 3  mgc: 1.134648e-13 
outer mgc:  0.06619762 
iter: 1  value: 18795.35 mgc: 0.3796524 ustep: 1 
iter: 2  value: 18795.35 mgc: 1.817008e-06 ustep: 1 
iter: 3  mgc: 8.792966e-14 
outer mgc:  0.06507296 
iter: 1  value: 18795.4 mgc: 0.001733168 ustep: 1 
iter: 2  mgc: 1.141842e-11 
outer mgc:  0.001939117 
iter: 1  value: 18795.42 mgc: 0.00173298 ustep: 1 
iter: 2  mgc: 1.143796e-11 
outer mgc:  0.002118293 
iter: 1  value: 18795.4 mgc: 0.006220972 ustep: 1 
iter: 2  value: 18795.4 mgc: 2.376772e-07 ustep: 1 
iter: 3  mgc: 7.283063e-14 
outer mgc:  0.1425931 
iter: 1  value: 18795.43 mgc: 0.006216739 ustep: 1 
iter: 2  value: 18795.43 mgc: 2.371574e-07 ustep: 1 
iter: 3  mgc: 6.927792e-14 
outer mgc:  0.1466181 
[Sun Aug 15 23:35:33 2021]
Finished job 0.
1 of 1 steps (100%) done

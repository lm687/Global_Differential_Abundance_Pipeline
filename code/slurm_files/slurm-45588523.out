Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:47:36 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4412.026951 
final  value 4317.118402 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4106.283 mgc: 2.742262 ustep: 1 
iter: 2  value: 4103.877 mgc: 2.052807 ustep: 1 
iter: 3  value: 4098.789 mgc: 2.713962 ustep: 0.6827823 
iter: 4  value: 4098.758 mgc: 0.2825761 ustep: 0.8263238 
iter: 5  value: 4098.757 mgc: 0.02800046 ustep: 0.9090326 
iter: 6  value: 4098.757 mgc: 0.002150441 ustep: 0.9534367 
iter: 7  value: 4098.757 mgc: 8.247653e-05 ustep: 0.9764432 
iter: 8  value: 4098.757 mgc: 1.574446e-06 ustep: 0.9881526 
iter: 9  value: 4098.757 mgc: 1.5001e-08 ustep: 0.9940592 
iter: 10  mgc: 7.143802e-11 
iter: 1  mgc: 7.143802e-11 
Matching hessian patterns... Done
outer mgc:  29.78021 
iter: 1  value: 4055.832 mgc: 0.9681024 ustep: 1 
iter: 2  value: 4055.83 mgc: 0.06456682 ustep: 1 
iter: 3  value: 4055.83 mgc: 0.0003917924 ustep: 1 
iter: 4  value: 4055.83 mgc: 1.906825e-08 ustep: 1 
iter: 5  mgc: 2.109424e-15 
iter: 1  value: 4011.914 mgc: 4.446391 ustep: 1 
iter: 2  value: 4011.904 mgc: 0.2607771 ustep: 1 
iter: 3  value: 4011.904 mgc: 0.001442321 ustep: 1 
iter: 4  value: 4011.904 mgc: 4.875445e-08 ustep: 1 
mgc: 1.176836e-14 
iter: 1  mgc: 1.176836e-14 
outer mgc:  20.04882 
iter: 1  value: 4041.679 mgc: 105.2528 ustep: 1 
iter: 2  value: 4032.033 mgc: 3.765006 ustep: 1 
iter: 3  value: 4032.028 mgc: 0.2055959 ustep: 1 
iter: 4  value: 4032.028 mgc: 0.0002271361 ustep: 1 
iter: 5  mgc: 1.21531e-09 
iter: 1  value: 4006.573 mgc: 3.628909 ustep: 1 
iter: 2  value: 4006.054 mgc: 0.6358543 ustep: 1 
iter: 3  value: 4006.054 mgc: 0.02276828 ustep: 1 
iter: 4  value: 4006.054 mgc: 2.943839e-05 ustep: 1 
iter: 5  mgc: 6.201617e-11 
iter: 1  mgc: 6.201617e-11 
outer mgc:  11.84355 
iter: 1  value: 4001.261 mgc: 25.47942 ustep: 1 
iter: 2  value: 4001.167 mgc: 1.303081 ustep: 1 
iter: 3  value: 4001.167 mgc: 0.005575935 ustep: 1 
iter: 4  value: 4001.167 mgc: 3.671952e-07 ustep: 1 
iter: 5  mgc: 7.105427e-15 
iter: 1  value: 4001.265 mgc: 4.885848 ustep: 1 
iter: 2  value: 4001.262 mgc: 0.2258894 ustep: 1 
iter: 3  value: 4001.262 mgc: 0.0008421464 ustep: 1 
iter: 4  mgc: 5.859121e-09 
iter: 1  mgc: 5.859121e-09 
outer mgc:  7.043515 
iter: 1  value: 4006.663 mgc: 4.866272 ustep: 1 
iter: 2  value: 4006.659 mgc: 0.09617924 ustep: 1 
iter: 3  value: 4006.659 mgc: 0.0002023044 ustep: 1 
iter: 4  mgc: 1.927185e-09 
iter: 1  value: 4000.239 mgc: 0.9082043 ustep: 1 
iter: 2  value: 4000.239 mgc: 0.003604173 ustep: 1 
iter: 3  value: 4000.239 mgc: 3.200085e-07 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  4.099999 
iter: 1  value: 3999.013 mgc: 1.116757 ustep: 1 
iter: 2  value: 3999.013 mgc: 0.004393435 ustep: 1 
iter: 3  value: 3999.013 mgc: 6.293411e-08 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  3.486499 
iter: 1  value: 3996.189 mgc: 1.466631 ustep: 1 
iter: 2  value: 3996.189 mgc: 0.009184467 ustep: 1 
iter: 3  value: 3996.189 mgc: 3.135641e-06 ustep: 1 
iter: 4  mgc: 3.863576e-13 
iter: 1  mgc: 3.863576e-13 
outer mgc:  5.550239 
iter: 1  value: 3994.134 mgc: 2.027484 ustep: 1 
iter: 2  value: 3994.134 mgc: 0.01774268 ustep: 1 
iter: 3  value: 3994.134 mgc: 2.578132e-06 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  2.104749 
iter: 1  value: 3993.269 mgc: 2.21156 ustep: 1 
iter: 2  value: 3993.269 mgc: 0.008440547 ustep: 1 
iter: 3  value: 3993.269 mgc: 5.739187e-07 ustep: 1 
iter: 4  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  2.263212 
iter: 1  value: 3991.358 mgc: 0.9407929 ustep: 1 
iter: 2  value: 3991.358 mgc: 0.001284401 ustep: 1 
iter: 3  value: 3991.358 mgc: 4.196745e-08 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  4.655702 
iter: 1  value: 3989.893 mgc: 1.119695 ustep: 1 
iter: 2  value: 3989.893 mgc: 0.00419539 ustep: 1 
iter: 3  value: 3989.893 mgc: 1.237817e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  2.126718 
iter: 1  value: 3990.091 mgc: 1.189437 ustep: 1 
iter: 2  value: 3990.091 mgc: 0.001407957 ustep: 1 
iter: 3  value: 3990.091 mgc: 1.97257e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  value: 3990.021 mgc: 0.6794405 ustep: 1 
iter: 2  value: 3990.021 mgc: 0.0004116554 ustep: 1 
iter: 3  mgc: 5.627002e-09 
iter: 1  value: 3989.903 mgc: 0.2701236 ustep: 1 
iter: 2  value: 3989.903 mgc: 6.459624e-05 ustep: 1 
iter: 3  mgc: 1.413403e-10 
iter: 1  mgc: 1.413403e-10 
outer mgc:  1.262726 
iter: 1  value: 3989.837 mgc: 0.1868411 ustep: 1 
iter: 2  value: 3989.837 mgc: 0.0001410833 ustep: 1 
iter: 3  mgc: 1.139058e-10 
iter: 1  mgc: 1.139058e-10 
outer mgc:  1.552767 
iter: 1  value: 3989.757 mgc: 0.2611168 ustep: 1 
iter: 2  value: 3989.757 mgc: 6.927772e-05 ustep: 1 
iter: 3  mgc: 2.52891e-11 
iter: 1  mgc: 2.52891e-11 
outer mgc:  0.5771782 
iter: 1  value: 3989.359 mgc: 0.181505 ustep: 1 
iter: 2  value: 3989.359 mgc: 0.0005859774 ustep: 1 
iter: 3  mgc: 5.166352e-09 
iter: 1  value: 3988.816 mgc: 0.2444083 ustep: 1 
iter: 2  value: 3988.816 mgc: 0.001940153 ustep: 1 
iter: 3  value: 3988.816 mgc: 5.751539e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  1.222177 
iter: 1  value: 3987.986 mgc: 0.6550164 ustep: 1 
iter: 2  value: 3987.986 mgc: 0.0001728666 ustep: 1 
iter: 3  mgc: 1.385103e-09 
iter: 1  mgc: 1.385103e-09 
outer mgc:  1.153238 
iter: 1  value: 3986.832 mgc: 3.116235 ustep: 1 
iter: 2  value: 3986.832 mgc: 0.006794223 ustep: 1 
iter: 3  value: 3986.832 mgc: 7.528562e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  1.19974 
iter: 1  value: 3985.356 mgc: 2.635393 ustep: 1 
iter: 2  value: 3985.356 mgc: 0.001876178 ustep: 1 
iter: 3  value: 3985.356 mgc: 1.370659e-07 ustep: 1 
iter: 4  mgc: 1.44329e-14 
iter: 1  mgc: 1.44329e-14 
outer mgc:  3.750817 
iter: 1  value: 3984.002 mgc: 0.7382104 ustep: 1 
iter: 2  value: 3984.002 mgc: 0.0001534684 ustep: 1 
iter: 3  mgc: 7.76752e-10 
iter: 1  mgc: 7.76752e-10 
outer mgc:  1.049441 
iter: 1  value: 3982.243 mgc: 0.9855952 ustep: 1 
iter: 2  value: 3982.243 mgc: 0.0009157164 ustep: 1 
iter: 3  value: 3982.243 mgc: 1.372076e-08 ustep: 1 
mgc: 1.576517e-14 
iter: 1  mgc: 1.576517e-14 
outer mgc:  0.645921 
iter: 1  value: 3980.164 mgc: 1.088562 ustep: 1 
iter: 2  value: 3980.164 mgc: 0.0001311769 ustep: 1 
iter: 3  mgc: 6.926242e-10 
iter: 1  mgc: 6.926242e-10 
outer mgc:  0.7370147 
iter: 1  value: 3978.051 mgc: 0.9125289 ustep: 1 
iter: 2  value: 3978.051 mgc: 5.924724e-05 ustep: 1 
iter: 3  mgc: 1.878497e-11 
iter: 1  value: 3975.902 mgc: 0.9294285 ustep: 1 
iter: 2  value: 3975.902 mgc: 4.459435e-05 ustep: 1 
iter: 3  mgc: 2.291634e-11 
iter: 1  mgc: 2.291634e-11 
outer mgc:  0.7616675 
iter: 1  value: 3973.189 mgc: 1.401932 ustep: 1 
iter: 2  value: 3973.189 mgc: 0.0003260453 ustep: 1 
iter: 3  mgc: 2.362468e-09 
iter: 1  mgc: 2.362468e-09 
outer mgc:  0.2178398 
iter: 1  value: 3970.453 mgc: 1.667805 ustep: 1 
iter: 2  value: 3970.453 mgc: 7.085306e-05 ustep: 1 
iter: 3  mgc: 8.439072e-11 
iter: 1  mgc: 8.439072e-11 
outer mgc:  0.1230691 
iter: 1  value: 3965.754 mgc: 3.289185 ustep: 1 
iter: 2  value: 3965.754 mgc: 0.0002308413 ustep: 1 
iter: 3  mgc: 5.628231e-10 
iter: 1  mgc: 5.628231e-10 
outer mgc:  0.1355119 
iter: 1  value: 3962.508 mgc: 5.338123 ustep: 1 
iter: 2  value: 3962.508 mgc: 0.0003633086 ustep: 1 
iter: 3  mgc: 3.819262e-09 
iter: 1  mgc: 3.819262e-09 
outer mgc:  0.08066654 
iter: 1  value: 3959.309 mgc: 1.591511 ustep: 1 
iter: 2  value: 3959.309 mgc: 3.653558e-05 ustep: 1 
iter: 3  mgc: 3.93503e-11 
iter: 1  mgc: 3.93503e-11 
outer mgc:  0.03428169 
iter: 1  value: 3955.003 mgc: 2.476367 ustep: 1 
iter: 2  value: 3955.003 mgc: 7.561222e-06 ustep: 1 
iter: 3  mgc: 3.044232e-13 
iter: 1  mgc: 3.044232e-13 
outer mgc:  0.02630168 
iter: 1  value: 3951.465 mgc: 2.232153 ustep: 1 
iter: 2  value: 3951.465 mgc: 2.567965e-06 ustep: 1 
iter: 3  mgc: 3.889111e-13 
iter: 1  mgc: 3.889111e-13 
outer mgc:  0.006941633 
iter: 1  value: 3947.326 mgc: 2.189286 ustep: 1 
iter: 2  value: 3947.326 mgc: 9.313116e-07 ustep: 1 
iter: 3  mgc: 6.96887e-13 
iter: 1  mgc: 6.96887e-13 
outer mgc:  0.0135836 
iter: 1  value: 3943.883 mgc: 2.338299 ustep: 1 
iter: 2  value: 3943.883 mgc: 5.791669e-07 ustep: 1 
iter: 3  mgc: 8.185674e-13 
iter: 1  mgc: 8.185674e-13 
outer mgc:  0.004505922 
iter: 1  value: 3939.689 mgc: 2.216098 ustep: 1 
iter: 2  value: 3939.689 mgc: 2.149077e-07 ustep: 1 
iter: 3  mgc: 8.46434e-13 
iter: 1  mgc: 8.46434e-13 
outer mgc:  0.006698995 
iter: 1  value: 3936.218 mgc: 2.452384 ustep: 1 
iter: 2  value: 3936.218 mgc: 1.344347e-07 ustep: 1 
iter: 3  mgc: 1.46394e-12 
iter: 1  mgc: 1.46394e-12 
outer mgc:  0.001678834 
iter: 1  value: 3932.03 mgc: 2.207571 ustep: 1 
iter: 2  value: 3932.03 mgc: 4.855522e-08 ustep: 1 
iter: 3  mgc: 1.298628e-12 
iter: 1  mgc: 1.298628e-12 
outer mgc:  0.003187401 
iter: 1  value: 3928.566 mgc: 2.477964 ustep: 1 
iter: 2  value: 3928.566 mgc: 2.956077e-08 ustep: 1 
mgc: 1.892264e-12 
iter: 1  mgc: 1.892264e-12 
outer mgc:  0.0007702303 
iter: 1  value: 3924.372 mgc: 2.211651 ustep: 1 
iter: 2  value: 3924.372 mgc: 1.027043e-08 ustep: 1 
mgc: 4.145129e-12 
iter: 1  mgc: 4.145129e-12 
outer mgc:  0.001489779 
iter: 1  value: 3920.906 mgc: 2.486425 ustep: 1 
iter: 2  mgc: 6.443051e-09 
iter: 1  mgc: 6.443051e-09 
outer mgc:  0.0003545675 
iter: 1  value: 3916.712 mgc: 2.213 ustep: 1 
iter: 2  mgc: 2.203044e-09 
iter: 1  mgc: 2.203044e-09 
outer mgc:  0.0006878988 
iter: 1  value: 3913.247 mgc: 2.468131 ustep: 1 
iter: 2  mgc: 1.375977e-09 
iter: 1  mgc: 1.375977e-09 
outer mgc:  0.0001629518 
iter: 1  value: 3909.052 mgc: 2.214889 ustep: 1 
iter: 2  mgc: 4.78297e-10 
iter: 1  mgc: 4.78297e-10 
outer mgc:  0.0003164705 
iter: 1  value: 3905.586 mgc: 2.444089 ustep: 1 
iter: 2  mgc: 2.947593e-10 
iter: 1  mgc: 2.947593e-10 
outer mgc:  7.466198e-05 
iter: 1  value: 3901.392 mgc: 2.216763 ustep: 1 
iter: 2  mgc: 9.66045e-11 
iter: 1  mgc: 9.66045e-11 
outer mgc:  0.0001453066 
iter: 1  value: 3897.926 mgc: 2.417611 ustep: 1 
iter: 2  mgc: 1.355187e-10 
iter: 1  mgc: 1.355187e-10 
outer mgc:  3.42283e-05 
iter: 1  value: 3893.731 mgc: 2.2186 ustep: 1 
iter: 2  mgc: 4.212802e-11 
iter: 1  mgc: 4.212802e-11 
outer mgc:  6.665629e-05 
iter: 1  value: 3890.266 mgc: 2.389743 ustep: 1 
iter: 2  mgc: 1.480345e-10 
iter: 1  mgc: 1.480345e-10 
outer mgc:  1.569317e-05 
iter: 1  mgc: 1.480345e-10 
iter: 1  mgc: 1.480345e-10 
outer mgc:  1.569317e-05 
iter: 1  value: 3890.269 mgc: 0.007254903 ustep: 1 
iter: 2  value: 3890.269 mgc: 8.128979e-08 ustep: 1 
iter: 3  mgc: 1.70802e-10 
outer mgc:  0.1206192 
iter: 1  value: 3890.263 mgc: 0.007253831 ustep: 1 
iter: 2  value: 3890.263 mgc: 8.105378e-08 ustep: 1 
iter: 3  mgc: 6.16841e-11 
outer mgc:  0.1205396 
iter: 1  value: 3890.267 mgc: 0.00392963 ustep: 1 
iter: 2  value: 3890.267 mgc: 6.023098e-08 ustep: 1 
iter: 3  mgc: 1.811715e-10 
outer mgc:  0.06256357 
iter: 1  value: 3890.264 mgc: 0.003929983 ustep: 1 
iter: 2  value: 3890.264 mgc: 6.011054e-08 ustep: 1 
iter: 3  mgc: 1.475879e-10 
outer mgc:  0.06252648 
iter: 1  value: 3890.265 mgc: 0.006930724 ustep: 1 
iter: 2  value: 3890.265 mgc: 3.591124e-07 ustep: 1 
iter: 3  mgc: 1.137731e-10 
outer mgc:  0.09379078 
iter: 1  value: 3890.266 mgc: 0.006930017 ustep: 1 
iter: 2  value: 3890.266 mgc: 3.589655e-07 ustep: 1 
iter: 3  mgc: 1.157514e-10 
outer mgc:  0.09380971 
iter: 1  value: 3890.265 mgc: 0.003725224 ustep: 1 
iter: 2  value: 3890.265 mgc: 1.240985e-07 ustep: 1 
iter: 3  mgc: 1.488867e-10 
outer mgc:  0.0548864 
iter: 1  value: 3890.266 mgc: 0.003724595 ustep: 1 
iter: 2  value: 3890.266 mgc: 1.240009e-07 ustep: 1 
iter: 3  mgc: 1.503881e-10 
outer mgc:  0.05488209 
iter: 1  value: 3890.283 mgc: 696.9787 ustep: 1 
iter: 2  value: 3890.283 mgc: 1.260351e-06 ustep: 1 
iter: 3  mgc: 9.597789e-11 
outer mgc:  0.02107973 
iter: 1  value: 3890.248 mgc: 699.0728 ustep: 1 
iter: 2  value: 3890.248 mgc: 1.259441e-06 ustep: 1 
iter: 3  mgc: 1.208438e-10 
outer mgc:  0.02099343 
iter: 1  value: 3890.276 mgc: 697.6772 ustep: 1 
iter: 2  value: 3890.276 mgc: 1.683774e-06 ustep: 1 
iter: 3  mgc: 3.339766e-10 
outer mgc:  0.03119538 
iter: 1  value: 3890.255 mgc: 698.3753 ustep: 1 
iter: 2  value: 3890.255 mgc: 1.68416e-06 ustep: 1 
iter: 3  mgc: 1.243473e-10 
outer mgc:  0.03116575 
iter: 1  value: 3890.266 mgc: 2.00571e-05 ustep: 1 
mgc: 2.641756e-10 
outer mgc:  1.569332e-05 
iter: 1  value: 3890.266 mgc: 2.00574e-05 ustep: 1 
mgc: 1.037141e-10 
outer mgc:  1.569263e-05 
iter: 1  value: 3890.261 mgc: 0.003523483 ustep: 1 
iter: 2  value: 3890.261 mgc: 1.212427e-07 ustep: 1 
iter: 3  mgc: 6.825529e-11 
outer mgc:  0.02613693 
iter: 1  value: 3890.27 mgc: 0.003521017 ustep: 1 
iter: 2  value: 3890.27 mgc: 1.212224e-07 ustep: 1 
iter: 3  mgc: 2.766697e-10 
outer mgc:  0.02615833 
[Sun Aug 15 23:47:38 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:32:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.8_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_0.8_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.8_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10853.190800 
final  value 9954.727089 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2794.886 mgc: 97.35801 ustep: 1 
iter: 2  value: 1806.957 mgc: 64.17891 ustep: 1 
iter: 3  value: 1780.137 mgc: 23.53876 ustep: 1 
iter: 4  value: 1780.117 mgc: 0.6138161 ustep: 1 
iter: 5  value: 1780.117 mgc: 0.005464303 ustep: 1 
iter: 6  value: 1780.117 mgc: 4.455942e-07 ustep: 1 
iter: 7  mgc: 2.448042e-14 
iter: 1  mgc: 2.448042e-14 
Matching hessian patterns... Done
outer mgc:  1098.89 
iter: 1  value: 986.5964 mgc: 31.24889 ustep: 1 
iter: 2  value: 980.0384 mgc: 4.588212 ustep: 1 
iter: 3  value: 980.0335 mgc: 0.1881596 ustep: 1 
iter: 4  value: 980.0335 mgc: 0.0003787224 ustep: 1 
iter: 5  mgc: 1.549194e-09 
iter: 1  mgc: 1.549194e-09 
outer mgc:  455.116 
iter: 1  value: 758.9695 mgc: 25.07639 ustep: 1 
iter: 2  value: 758.6558 mgc: 1.424339 ustep: 1 
iter: 3  value: 758.6558 mgc: 0.005039863 ustep: 1 
iter: 4  value: 758.6558 mgc: 2.7701e-07 ustep: 1 
iter: 5  mgc: 3.490264e-14 
iter: 1  mgc: 3.490264e-14 
outer mgc:  163.8952 
iter: 1  value: 830.2819 mgc: 24.51226 ustep: 1 
iter: 2  value: 828.2416 mgc: 1.845688 ustep: 1 
iter: 3  value: 828.2413 mgc: 0.03314729 ustep: 1 
iter: 4  value: 828.2413 mgc: 1.327312e-05 ustep: 1 
iter: 5  mgc: 2.240319e-12 
iter: 1  value: 724.0905 mgc: 8.159078 ustep: 1 
iter: 2  value: 724.0515 mgc: 0.2905416 ustep: 1 
iter: 3  value: 724.0515 mgc: 0.0007327967 ustep: 1 
iter: 4  mgc: 5.897235e-09 
iter: 1  mgc: 5.897235e-09 
outer mgc:  91.99908 
iter: 1  value: 707.902 mgc: 9.977619 ustep: 1 
iter: 2  value: 707.8716 mgc: 0.2607663 ustep: 1 
iter: 3  value: 707.8716 mgc: 0.0007058074 ustep: 1 
iter: 4  mgc: 5.675418e-09 
iter: 1  mgc: 5.675418e-09 
outer mgc:  77.16361 
iter: 1  value: 686.7056 mgc: 6.518748 ustep: 1 
iter: 2  value: 686.7036 mgc: 0.06859159 ustep: 1 
iter: 3  value: 686.7036 mgc: 3.386486e-05 ustep: 1 
iter: 4  mgc: 1.006006e-11 
iter: 1  mgc: 1.006006e-11 
outer mgc:  72.07204 
iter: 1  value: 666.3729 mgc: 9.159747 ustep: 1 
iter: 2  value: 666.2488 mgc: 0.4809087 ustep: 1 
iter: 3  value: 666.2488 mgc: 0.002142972 ustep: 1 
iter: 4  value: 666.2488 mgc: 5.653168e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  43.87262 
iter: 1  value: 632.2554 mgc: 15.51622 ustep: 1 
iter: 2  value: 632.1596 mgc: 0.5010254 ustep: 1 
iter: 3  value: 632.1596 mgc: 0.001217111 ustep: 1 
iter: 4  mgc: 7.74002e-09 
iter: 1  mgc: 7.74002e-09 
outer mgc:  74.38682 
iter: 1  value: 623.4873 mgc: 22.06472 ustep: 1 
iter: 2  value: 619.457 mgc: 2.998456 ustep: 1 
iter: 3  value: 619.4559 mgc: 0.06105647 ustep: 1 
iter: 4  value: 619.4559 mgc: 2.717776e-05 ustep: 1 
iter: 5  mgc: 5.493384e-12 
iter: 1  mgc: 5.493384e-12 
outer mgc:  188.9506 
iter: 1  value: 589.738 mgc: 28.80567 ustep: 1 
iter: 2  value: 589.2498 mgc: 1.058261 ustep: 1 
iter: 3  value: 589.2498 mgc: 0.005669553 ustep: 1 
iter: 4  value: 589.2498 mgc: 1.210468e-07 ustep: 1 
iter: 5  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  134.4001 
iter: 1  value: 635.2016 mgc: 16.69931 ustep: 1 
iter: 2  value: 634.7604 mgc: 1.686557 ustep: 1 
iter: 3  value: 634.7603 mgc: 0.01373718 ustep: 1 
iter: 4  value: 634.7603 mgc: 9.246553e-07 ustep: 1 
iter: 5  mgc: 2.4869e-14 
iter: 1  value: 582.8538 mgc: 13.38095 ustep: 1 
iter: 2  value: 582.8016 mgc: 0.3395147 ustep: 1 
iter: 3  value: 582.8016 mgc: 0.0007506104 ustep: 1 
iter: 4  mgc: 3.421682e-09 
iter: 1  mgc: 3.421682e-09 
outer mgc:  80.92083 
iter: 1  value: 569.8396 mgc: 7.804381 ustep: 1 
iter: 2  value: 569.8342 mgc: 0.1412609 ustep: 1 
iter: 3  value: 569.8342 mgc: 7.393828e-05 ustep: 1 
iter: 4  mgc: 1.617773e-11 
iter: 1  mgc: 1.617773e-11 
outer mgc:  24.70173 
iter: 1  value: 563.4161 mgc: 3.608976 ustep: 1 
iter: 2  value: 563.416 mgc: 0.01751067 ustep: 1 
iter: 3  value: 563.416 mgc: 2.43093e-06 ustep: 1 
iter: 4  mgc: 3.85976e-14 
iter: 1  mgc: 3.85976e-14 
outer mgc:  62.83838 
iter: 1  value: 546.2459 mgc: 7.486183 ustep: 1 
iter: 2  value: 546.2456 mgc: 0.05573896 ustep: 1 
iter: 3  value: 546.2456 mgc: 9.125766e-06 ustep: 1 
iter: 4  mgc: 7.460699e-14 
iter: 1  mgc: 7.460699e-14 
outer mgc:  39.12238 
iter: 1  value: 553.8298 mgc: 9.805091 ustep: 1 
iter: 2  value: 553.8232 mgc: 0.2686842 ustep: 1 
iter: 3  value: 553.8232 mgc: 0.0002226167 ustep: 1 
iter: 4  mgc: 1.448113e-10 
iter: 1  value: 545.285 mgc: 4.018765 ustep: 1 
iter: 2  value: 545.2848 mgc: 0.02218937 ustep: 1 
iter: 3  value: 545.2848 mgc: 2.178535e-06 ustep: 1 
iter: 4  mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  54.61916 
iter: 1  value: 543.1675 mgc: 2.420908 ustep: 1 
iter: 2  value: 543.1674 mgc: 0.01091518 ustep: 1 
iter: 3  value: 543.1674 mgc: 3.439346e-07 ustep: 1 
iter: 4  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  15.09232 
iter: 1  value: 542.0068 mgc: 1.840139 ustep: 1 
iter: 2  value: 542.0068 mgc: 0.001962819 ustep: 1 
iter: 3  value: 542.0068 mgc: 4.516775e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  37.76932 
iter: 1  value: 538.3092 mgc: 2.934199 ustep: 1 
iter: 2  value: 538.3091 mgc: 0.03255064 ustep: 1 
iter: 3  value: 538.3091 mgc: 5.617539e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  18.14962 
iter: 1  value: 536.6534 mgc: 3.027575 ustep: 1 
iter: 2  value: 536.6529 mgc: 0.05036515 ustep: 1 
iter: 3  value: 536.6529 mgc: 5.427692e-06 ustep: 1 
iter: 4  mgc: 1.190159e-13 
iter: 1  mgc: 1.190159e-13 
outer mgc:  21.71289 
iter: 1  value: 533.8504 mgc: 2.534315 ustep: 1 
iter: 2  value: 533.8503 mgc: 0.01362681 ustep: 1 
iter: 3  value: 533.8503 mgc: 1.084821e-07 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  15.81634 
iter: 1  value: 533.7152 mgc: 3.513804 ustep: 1 
iter: 2  value: 533.7152 mgc: 0.006077065 ustep: 1 
iter: 3  value: 533.7152 mgc: 1.130385e-07 ustep: 1 
mgc: 2.220446e-14 
iter: 1  value: 534.8329 mgc: 2.570364 ustep: 1 
iter: 2  value: 534.8329 mgc: 0.007724995 ustep: 1 
iter: 3  value: 534.8329 mgc: 1.545044e-07 ustep: 1 
mgc: 3.463896e-14 
iter: 1  value: 533.6028 mgc: 0.6651881 ustep: 1 
iter: 2  value: 533.6028 mgc: 0.0005616632 ustep: 1 
iter: 3  mgc: 8.114416e-10 
iter: 1  mgc: 8.114416e-10 
outer mgc:  10.32334 
iter: 1  value: 533.5211 mgc: 0.801409 ustep: 1 
iter: 2  value: 533.5211 mgc: 0.0005907048 ustep: 1 
iter: 3  mgc: 1.078363e-09 
iter: 1  mgc: 1.078363e-09 
outer mgc:  10.10934 
iter: 1  value: 533.2889 mgc: 0.5402696 ustep: 1 
iter: 2  value: 533.2889 mgc: 0.000290812 ustep: 1 
iter: 3  mgc: 2.305116e-10 
iter: 1  mgc: 2.305116e-10 
outer mgc:  4.687901 
iter: 1  value: 533.1948 mgc: 0.4222838 ustep: 1 
iter: 2  value: 533.1948 mgc: 0.0002148589 ustep: 1 
iter: 3  mgc: 1.548148e-10 
iter: 1  mgc: 1.548148e-10 
outer mgc:  5.116645 
iter: 1  value: 533.0418 mgc: 0.4971278 ustep: 1 
iter: 2  value: 533.0418 mgc: 0.0001977727 ustep: 1 
iter: 3  mgc: 1.166773e-10 
iter: 1  mgc: 1.166773e-10 
outer mgc:  4.391527 
iter: 1  value: 533.0627 mgc: 0.680064 ustep: 1 
iter: 2  value: 533.0627 mgc: 0.0003354612 ustep: 1 
iter: 3  mgc: 3.165717e-10 
iter: 1  value: 533.2074 mgc: 1.175449 ustep: 1 
iter: 2  value: 533.2074 mgc: 0.002016737 ustep: 1 
iter: 3  value: 533.2074 mgc: 1.260347e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  value: 533.415 mgc: 1.809805 ustep: 1 
iter: 2  value: 533.415 mgc: 0.005058432 ustep: 1 
iter: 3  value: 533.415 mgc: 8.439404e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  6.888661 
iter: 1  value: 533.1485 mgc: 6.056194 ustep: 1 
iter: 2  value: 533.1483 mgc: 0.03977501 ustep: 1 
iter: 3  value: 533.1483 mgc: 3.041591e-06 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  value: 533.0519 mgc: 0.8283997 ustep: 1 
iter: 2  value: 533.0519 mgc: 0.00159975 ustep: 1 
iter: 3  mgc: 6.663792e-09 
iter: 1  value: 533.1541 mgc: 0.3991584 ustep: 1 
iter: 2  value: 533.1541 mgc: 0.0003762909 ustep: 1 
iter: 3  mgc: 3.721166e-10 
iter: 1  mgc: 3.721166e-10 
outer mgc:  5.125415 
iter: 1  value: 532.6652 mgc: 0.6828489 ustep: 1 
iter: 2  value: 532.6652 mgc: 0.0006704044 ustep: 1 
iter: 3  mgc: 1.440916e-09 
iter: 1  mgc: 1.440916e-09 
outer mgc:  4.758029 
iter: 1  value: 532.002 mgc: 0.5920295 ustep: 1 
iter: 2  value: 532.002 mgc: 0.0004461921 ustep: 1 
iter: 3  mgc: 4.522676e-10 
iter: 1  mgc: 4.522676e-10 
outer mgc:  3.498693 
iter: 1  value: 531.5005 mgc: 0.4899086 ustep: 1 
iter: 2  value: 531.5005 mgc: 0.0005094888 ustep: 1 
iter: 3  mgc: 5.702301e-10 
iter: 1  value: 531.781 mgc: 0.1676765 ustep: 1 
iter: 2  value: 531.781 mgc: 6.283179e-05 ustep: 1 
iter: 3  mgc: 8.387069e-12 
iter: 1  mgc: 8.387069e-12 
outer mgc:  1.008433 
iter: 1  value: 531.5689 mgc: 0.24504 ustep: 1 
iter: 2  value: 531.5689 mgc: 2.731992e-05 ustep: 1 
iter: 3  mgc: 5.574208e-12 
iter: 1  mgc: 5.574208e-12 
outer mgc:  0.4825889 
iter: 1  value: 531.4406 mgc: 0.2203982 ustep: 1 
iter: 2  value: 531.4406 mgc: 0.0001689591 ustep: 1 
iter: 3  mgc: 9.901591e-11 
iter: 1  value: 531.5066 mgc: 0.1228949 ustep: 1 
iter: 2  value: 531.5066 mgc: 5.245217e-05 ustep: 1 
iter: 3  mgc: 9.690027e-12 
iter: 1  mgc: 9.690027e-12 
outer mgc:  1.187218 
iter: 1  value: 531.5189 mgc: 0.107774 ustep: 1 
iter: 2  value: 531.5189 mgc: 5.544564e-06 ustep: 1 
iter: 3  mgc: 9.814372e-14 
iter: 1  mgc: 9.814372e-14 
outer mgc:  0.2780003 
iter: 1  value: 531.3662 mgc: 0.08686748 ustep: 1 
iter: 2  value: 531.3662 mgc: 1.59315e-05 ustep: 1 
iter: 3  mgc: 5.27578e-13 
iter: 1  mgc: 5.27578e-13 
outer mgc:  0.6259224 
iter: 1  value: 531.257 mgc: 0.1275429 ustep: 1 
iter: 2  value: 531.257 mgc: 4.722696e-06 ustep: 1 
iter: 3  mgc: 1.687539e-13 
iter: 1  mgc: 1.687539e-13 
outer mgc:  0.3030225 
iter: 1  value: 531.2898 mgc: 0.04615179 ustep: 1 
iter: 2  value: 531.2898 mgc: 1.987933e-06 ustep: 1 
iter: 3  mgc: 2.864375e-14 
iter: 1  mgc: 2.864375e-14 
outer mgc:  0.1729419 
iter: 1  value: 531.3035 mgc: 0.02091621 ustep: 1 
iter: 2  value: 531.3035 mgc: 3.274587e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.06144796 
iter: 1  value: 531.3021 mgc: 0.007722939 ustep: 1 
iter: 2  value: 531.3021 mgc: 8.047481e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.01039307 
iter: 1  value: 531.3009 mgc: 0.001754319 ustep: 1 
iter: 2  mgc: 7.470196e-09 
iter: 1  mgc: 7.470196e-09 
outer mgc:  0.004223478 
iter: 1  value: 531.3013 mgc: 0.0005435705 ustep: 1 
iter: 2  mgc: 4.020588e-10 
iter: 1  mgc: 4.020588e-10 
outer mgc:  6.879715e-05 
iter: 1  mgc: 4.020588e-10 
iter: 1  mgc: 4.020588e-10 
outer mgc:  6.879715e-05 
iter: 1  value: 531.2991 mgc: 0.04337134 ustep: 1 
iter: 2  value: 531.2991 mgc: 4.026024e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.6956103 
iter: 1  value: 531.3042 mgc: 0.0433521 ustep: 1 
iter: 2  value: 531.3042 mgc: 4.028114e-06 ustep: 1 
iter: 3  mgc: 4.396483e-14 
outer mgc:  0.6955114 
iter: 1  value: 531.3003 mgc: 0.02137427 ustep: 1 
iter: 2  value: 531.3003 mgc: 1.117654e-06 ustep: 1 
iter: 3  mgc: 2.420286e-14 
outer mgc:  0.5921141 
iter: 1  value: 531.3029 mgc: 0.02136487 ustep: 1 
iter: 2  value: 531.3029 mgc: 1.117479e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.5918827 
iter: 1  value: 531.3054 mgc: 0.05295978 ustep: 1 
iter: 2  value: 531.3054 mgc: 5.884577e-07 ustep: 1 
iter: 3  mgc: 2.287059e-14 
outer mgc:  1.231151 
iter: 1  value: 531.2985 mgc: 0.05296075 ustep: 1 
iter: 2  value: 531.2985 mgc: 5.867158e-07 ustep: 1 
iter: 3  mgc: 4.285461e-14 
outer mgc:  1.231282 
iter: 1  value: 531.3047 mgc: 0.02811993 ustep: 1 
iter: 2  value: 531.3047 mgc: 3.525755e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.8847732 
iter: 1  value: 531.2988 mgc: 0.02812317 ustep: 1 
iter: 2  value: 531.2988 mgc: 3.521704e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.8850135 
iter: 1  value: 531.2895 mgc: 0.01368549 ustep: 1 
iter: 2  value: 531.2895 mgc: 2.040806e-07 ustep: 1 
mgc: 2.930989e-14 
outer mgc:  0.01181347 
iter: 1  value: 531.3131 mgc: 0.01367088 ustep: 1 
iter: 2  value: 531.3131 mgc: 2.042135e-07 ustep: 1 
mgc: 2.975398e-14 
outer mgc:  0.01182917 
iter: 1  value: 531.3212 mgc: 0.01880604 ustep: 1 
iter: 2  value: 531.3212 mgc: 1.257901e-06 ustep: 1 
iter: 3  mgc: 2.431388e-14 
outer mgc:  0.04318225 
iter: 1  value: 531.2814 mgc: 0.01884586 ustep: 1 
iter: 2  value: 531.2814 mgc: 1.258595e-06 ustep: 1 
iter: 3  mgc: 3.441691e-14 
outer mgc:  0.04312329 
iter: 1  value: 531.3284 mgc: 0.02586254 ustep: 1 
iter: 2  value: 531.3284 mgc: 2.590482e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.02726503 
iter: 1  value: 531.2742 mgc: 0.02591578 ustep: 1 
iter: 2  value: 531.2742 mgc: 2.592165e-07 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.02719439 
[Fri Aug 13 11:32:54 2021]
Finished job 0.
1 of 1 steps (100%) done

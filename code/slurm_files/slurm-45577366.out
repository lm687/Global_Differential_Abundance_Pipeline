Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 08:35:17 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_10_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10932.290885 
final  value 10273.753618 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6990.061 mgc: 94.96542 ustep: 0.6827823 
iter: 2  value: 6802.311 mgc: 85.28922 ustep: 0.1964641 
iter: 3  value: 3960.797 mgc: 137.8398 ustep: 0.1361868 
iter: 4  value: 1682.723 mgc: 92.80521 ustep: 0.1087462 
iter: 5  value: 1661.866 mgc: 99.496 ustep: 0.1813451 
iter: 6  value: 1509.528 mgc: 125.9557 ustep: 0.1295184 
iter: 7  value: 1174.905 mgc: 95.82991 ustep: 0.1055339 
iter: 8  value: 1119.852 mgc: 51.92757 ustep: 0.3249273 
iter: 9  value: 1113.966 mgc: 23.43627 ustep: 0.5700669 
iter: 10  value: 1113.965 mgc: 0.2922543 ustep: 0.7550523 
iter: 11  value: 1113.965 mgc: 0.00186898 ustep: 0.8689505 
iter: 12  value: 1113.965 mgc: 2.597752e-05 ustep: 0.9321819 
iter: 13  value: 1113.965 mgc: 2.069313e-07 ustep: 0.9654991 
iter: 14  mgc: 1.164267e-09 
iter: 1  mgc: 1.164267e-09 
Matching hessian patterns... Done
outer mgc:  230.523 
iter: 1  value: 1092.111 mgc: 25.98932 ustep: 1 
iter: 2  value: 1089.771 mgc: 2.415055 ustep: 1 
iter: 3  value: 1089.77 mgc: 0.07288621 ustep: 1 
iter: 4  value: 1089.77 mgc: 0.0001078559 ustep: 1 
iter: 5  mgc: 2.894347e-10 
iter: 1  mgc: 2.894347e-10 
outer mgc:  199.1996 
iter: 1  value: 1028.725 mgc: 15.22279 ustep: 1 
iter: 2  value: 1028.128 mgc: 1.616637 ustep: 1 
iter: 3  value: 1028.128 mgc: 0.0251549 ustep: 1 
iter: 4  value: 1028.128 mgc: 9.940745e-06 ustep: 1 
iter: 5  mgc: 2.34357e-12 
iter: 1  mgc: 2.34357e-12 
outer mgc:  29.2716 
iter: 1  value: 1015.156 mgc: 8.390245 ustep: 1 
iter: 2  value: 1015.129 mgc: 0.288687 ustep: 1 
iter: 3  value: 1015.129 mgc: 0.002414386 ustep: 1 
iter: 4  value: 1015.129 mgc: 1.905857e-07 ustep: 1 
iter: 5  mgc: 2.287059e-14 
iter: 1  mgc: 2.287059e-14 
outer mgc:  65.77812 
iter: 1  value: 1019.337 mgc: 7.795263 ustep: 1 
iter: 2  value: 1018.909 mgc: 1.800988 ustep: 1 
iter: 3  value: 1018.909 mgc: 0.08040763 ustep: 1 
iter: 4  value: 1018.909 mgc: 0.0001789665 ustep: 1 
iter: 5  mgc: 8.919461e-10 
iter: 1  value: 1007.309 mgc: 6.27638 ustep: 1 
iter: 2  value: 1007.274 mgc: 0.2481417 ustep: 1 
iter: 3  value: 1007.274 mgc: 0.002348672 ustep: 1 
iter: 4  value: 1007.274 mgc: 2.515417e-07 ustep: 1 
iter: 5  mgc: 3.352874e-14 
iter: 1  mgc: 3.352874e-14 
outer mgc:  72.02197 
iter: 1  value: 996.5069 mgc: 18.84124 ustep: 1 
iter: 2  value: 996.0666 mgc: 1.262221 ustep: 1 
iter: 3  value: 996.0666 mgc: 0.01188738 ustep: 1 
iter: 4  value: 996.0666 mgc: 1.687771e-06 ustep: 1 
iter: 5  mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  31.92544 
iter: 1  value: 993.3884 mgc: 15.13492 ustep: 1 
iter: 2  value: 992.6318 mgc: 1.346865 ustep: 1 
iter: 3  value: 992.6317 mgc: 0.01357915 ustep: 1 
iter: 4  value: 992.6317 mgc: 2.405822e-06 ustep: 1 
iter: 5  mgc: 7.31637e-14 
iter: 1  mgc: 7.31637e-14 
outer mgc:  35.70028 
iter: 1  value: 985.9201 mgc: 15.20106 ustep: 1 
iter: 2  value: 985.713 mgc: 0.7338844 ustep: 1 
iter: 3  value: 985.713 mgc: 0.004749396 ustep: 1 
iter: 4  value: 985.713 mgc: 2.508336e-07 ustep: 1 
iter: 5  mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  57.80239 
iter: 1  value: 978.5408 mgc: 11.44161 ustep: 1 
iter: 2  value: 978.2343 mgc: 0.893432 ustep: 1 
iter: 3  value: 978.2343 mgc: 0.009427921 ustep: 1 
iter: 4  value: 978.2343 mgc: 1.83253e-06 ustep: 1 
iter: 5  mgc: 1.181277e-13 
iter: 1  mgc: 1.181277e-13 
outer mgc:  46.23521 
iter: 1  value: 968.4338 mgc: 9.190129 ustep: 1 
iter: 2  value: 968.4044 mgc: 0.2883608 ustep: 1 
iter: 3  value: 968.4044 mgc: 0.001416423 ustep: 1 
iter: 4  value: 968.4044 mgc: 3.478029e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  21.10631 
iter: 1  value: 964.8246 mgc: 4.085533 ustep: 1 
iter: 2  value: 964.8215 mgc: 0.07652629 ustep: 1 
iter: 3  value: 964.8215 mgc: 0.000138209 ustep: 1 
iter: 4  mgc: 4.46243e-10 
iter: 1  mgc: 4.46243e-10 
outer mgc:  46.03189 
iter: 1  value: 962.4976 mgc: 15.16816 ustep: 1 
iter: 2  value: 962.2999 mgc: 0.8247958 ustep: 1 
iter: 3  value: 962.2998 mgc: 0.005314256 ustep: 1 
iter: 4  value: 962.2998 mgc: 2.976734e-07 ustep: 1 
iter: 5  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  26.88332 
iter: 1  value: 962.7269 mgc: 12.78145 ustep: 1 
iter: 2  value: 962.4114 mgc: 0.7912132 ustep: 1 
iter: 3  value: 962.4114 mgc: 0.004786901 ustep: 1 
iter: 4  value: 962.4114 mgc: 4.338512e-07 ustep: 1 
iter: 5  mgc: 2.708944e-14 
iter: 1  value: 960.5534 mgc: 8.960775 ustep: 1 
iter: 2  value: 960.5075 mgc: 0.3274475 ustep: 1 
iter: 3  value: 960.5075 mgc: 0.0007900229 ustep: 1 
iter: 4  mgc: 8.601838e-09 
iter: 1  mgc: 8.601838e-09 
outer mgc:  25.35965 
iter: 1  value: 961.7397 mgc: 2.019541 ustep: 1 
iter: 2  value: 961.7396 mgc: 0.02836717 ustep: 1 
iter: 3  value: 961.7396 mgc: 9.349184e-06 ustep: 1 
iter: 4  mgc: 2.181366e-12 
iter: 1  value: 959.7045 mgc: 2.811945 ustep: 1 
iter: 2  value: 959.704 mgc: 0.03751291 ustep: 1 
iter: 3  value: 959.704 mgc: 1.163774e-05 ustep: 1 
iter: 4  mgc: 1.853406e-12 
iter: 1  mgc: 1.853406e-12 
outer mgc:  14.13485 
iter: 1  value: 959.3104 mgc: 2.76177 ustep: 1 
iter: 2  value: 959.3102 mgc: 0.01998845 ustep: 1 
iter: 3  value: 959.3102 mgc: 4.425923e-06 ustep: 1 
iter: 4  mgc: 1.341149e-13 
iter: 1  mgc: 1.341149e-13 
outer mgc:  2.332025 
iter: 1  value: 959.5172 mgc: 3.199215 ustep: 1 
iter: 2  value: 959.5159 mgc: 0.04900852 ustep: 1 
iter: 3  value: 959.5159 mgc: 2.732935e-05 ustep: 1 
iter: 4  mgc: 1.608891e-11 
iter: 1  value: 959.3 mgc: 0.6513928 ustep: 1 
iter: 2  value: 959.3 mgc: 0.002101117 ustep: 1 
iter: 3  value: 959.3 mgc: 5.36969e-08 ustep: 1 
mgc: 2.692291e-14 
iter: 1  mgc: 2.692291e-14 
outer mgc:  2.450125 
iter: 1  value: 959.3071 mgc: 0.4757589 ustep: 1 
iter: 2  value: 959.3071 mgc: 0.0009969658 ustep: 1 
iter: 3  mgc: 9.033175e-09 
iter: 1  mgc: 9.033175e-09 
outer mgc:  4.030825 
iter: 1  value: 959.3318 mgc: 1.004537 ustep: 1 
iter: 2  value: 959.3318 mgc: 0.002788032 ustep: 1 
iter: 3  value: 959.3318 mgc: 7.666934e-08 ustep: 1 
mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  1.52045 
iter: 1  value: 959.2911 mgc: 0.6854316 ustep: 1 
iter: 2  value: 959.2911 mgc: 0.001703364 ustep: 1 
iter: 3  value: 959.2911 mgc: 2.72751e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  1.535542 
iter: 1  value: 959.2943 mgc: 0.111517 ustep: 1 
iter: 2  value: 959.2943 mgc: 3.468275e-05 ustep: 1 
iter: 3  mgc: 3.333644e-11 
iter: 1  value: 959.2868 mgc: 0.05166351 ustep: 1 
iter: 2  value: 959.2868 mgc: 7.44339e-06 ustep: 1 
iter: 3  mgc: 1.537881e-12 
iter: 1  mgc: 1.537881e-12 
outer mgc:  0.6480428 
iter: 1  value: 959.2891 mgc: 0.1924577 ustep: 1 
iter: 2  value: 959.2891 mgc: 0.0001740182 ustep: 1 
iter: 3  mgc: 3.345872e-10 
iter: 1  mgc: 3.345872e-10 
outer mgc:  0.7553636 
iter: 1  value: 959.2948 mgc: 0.2092169 ustep: 1 
iter: 2  value: 959.2948 mgc: 0.0001225489 ustep: 1 
iter: 3  mgc: 9.191936e-11 
iter: 1  mgc: 9.191936e-11 
outer mgc:  0.4638871 
iter: 1  value: 959.2984 mgc: 0.193425 ustep: 1 
iter: 2  value: 959.2984 mgc: 0.0001921483 ustep: 1 
iter: 3  mgc: 5.510516e-10 
iter: 1  mgc: 5.510516e-10 
outer mgc:  0.5857833 
iter: 1  value: 959.2768 mgc: 0.2680223 ustep: 1 
iter: 2  value: 959.2768 mgc: 0.0002824492 ustep: 1 
iter: 3  mgc: 7.492702e-10 
iter: 1  value: 959.2934 mgc: 0.1043831 ustep: 1 
iter: 2  value: 959.2934 mgc: 3.365883e-05 ustep: 1 
iter: 3  mgc: 1.058631e-11 
iter: 1  mgc: 1.058631e-11 
outer mgc:  0.4693698 
iter: 1  value: 959.2981 mgc: 0.1318422 ustep: 1 
iter: 2  value: 959.2981 mgc: 7.185025e-05 ustep: 1 
iter: 3  mgc: 4.120726e-11 
iter: 1  mgc: 4.120726e-11 
outer mgc:  0.1254467 
iter: 1  value: 959.2895 mgc: 0.04378462 ustep: 1 
iter: 2  value: 959.2895 mgc: 5.431538e-06 ustep: 1 
iter: 3  mgc: 9.698908e-13 
iter: 1  value: 959.2949 mgc: 0.02793585 ustep: 1 
iter: 2  value: 959.2949 mgc: 2.602278e-06 ustep: 1 
iter: 3  mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
outer mgc:  0.2193948 
iter: 1  value: 959.2978 mgc: 0.03407924 ustep: 1 
iter: 2  value: 959.2978 mgc: 3.685457e-06 ustep: 1 
iter: 3  mgc: 3.23741e-13 
iter: 1  mgc: 3.23741e-13 
outer mgc:  0.06343028 
iter: 1  value: 959.2942 mgc: 0.04354987 ustep: 1 
iter: 2  value: 959.2942 mgc: 6.759013e-06 ustep: 1 
iter: 3  mgc: 6.403766e-13 
iter: 1  value: 959.2969 mgc: 0.01220367 ustep: 1 
iter: 2  value: 959.2969 mgc: 5.210875e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  0.04839522 
iter: 1  value: 959.2949 mgc: 0.008213169 ustep: 1 
iter: 2  value: 959.2949 mgc: 1.361962e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.01647526 
iter: 1  value: 959.2948 mgc: 0.009013782 ustep: 1 
iter: 2  value: 959.2948 mgc: 3.071272e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.01756465 
iter: 1  value: 959.2943 mgc: 0.002078199 ustep: 1 
iter: 2  value: 959.2943 mgc: 5.3181e-08 ustep: 1 
mgc: 2.059464e-14 
iter: 1  mgc: 2.059464e-14 
outer mgc:  0.01822702 
iter: 1  value: 959.2948 mgc: 0.002819352 ustep: 1 
iter: 2  value: 959.2948 mgc: 3.385825e-08 ustep: 1 
mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  0.01109829 
iter: 1  value: 959.2945 mgc: 0.00163735 ustep: 1 
iter: 2  mgc: 9.84825e-09 
iter: 1  value: 959.2947 mgc: 0.001141326 ustep: 1 
iter: 2  mgc: 6.22088e-09 
iter: 1  mgc: 6.22088e-09 
outer mgc:  0.003642845 
iter: 1  value: 959.2946 mgc: 0.0003320787 ustep: 1 
iter: 2  mgc: 1.546744e-09 
iter: 1  mgc: 1.546744e-09 
outer mgc:  0.0009423709 
iter: 1  mgc: 1.546744e-09 
iter: 1  mgc: 1.546744e-09 
outer mgc:  0.0009423709 
iter: 1  value: 959.2939 mgc: 0.0468822 ustep: 1 
iter: 2  value: 959.2939 mgc: 9.319382e-06 ustep: 1 
iter: 3  mgc: 7.260859e-13 
outer mgc:  0.09523497 
iter: 1  value: 959.2953 mgc: 0.04686738 ustep: 1 
iter: 2  value: 959.2953 mgc: 9.328667e-06 ustep: 1 
iter: 3  mgc: 7.280843e-13 
outer mgc:  0.0960875 
iter: 1  value: 959.2949 mgc: 0.02529094 ustep: 1 
iter: 2  value: 959.2949 mgc: 3.453002e-06 ustep: 1 
iter: 3  mgc: 1.156297e-13 
outer mgc:  0.4006808 
iter: 1  value: 959.2946 mgc: 0.02528457 ustep: 1 
iter: 2  value: 959.2946 mgc: 3.453645e-06 ustep: 1 
iter: 3  mgc: 1.124656e-13 
outer mgc:  0.4012393 
iter: 1  value: 959.2946 mgc: 0.05426667 ustep: 1 
iter: 2  value: 959.2946 mgc: 9.11959e-06 ustep: 1 
iter: 3  mgc: 6.727952e-13 
outer mgc:  0.1141854 
iter: 1  value: 959.2947 mgc: 0.05426252 ustep: 1 
iter: 2  value: 959.2947 mgc: 9.128626e-06 ustep: 1 
iter: 3  mgc: 6.76792e-13 
outer mgc:  0.113221 
iter: 1  value: 959.2942 mgc: 0.02877566 ustep: 1 
iter: 2  value: 959.2942 mgc: 2.605742e-06 ustep: 1 
iter: 3  mgc: 5.306866e-14 
outer mgc:  0.5102834 
iter: 1  value: 959.2954 mgc: 0.02877199 ustep: 1 
iter: 2  value: 959.2954 mgc: 2.606597e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.5083605 
iter: 1  value: 959.2925 mgc: 0.004380483 ustep: 1 
iter: 2  value: 959.2925 mgc: 3.29681e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
outer mgc:  0.04019223 
iter: 1  value: 959.2967 mgc: 0.004376092 ustep: 1 
iter: 2  value: 959.2967 mgc: 3.285342e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.03992315 
iter: 1  value: 959.2993 mgc: 0.007389707 ustep: 1 
iter: 2  value: 959.2993 mgc: 1.82767e-06 ustep: 1 
iter: 3  mgc: 1.159073e-13 
outer mgc:  0.08493022 
iter: 1  value: 959.2899 mgc: 0.007404782 ustep: 1 
iter: 2  value: 959.2899 mgc: 1.832674e-06 ustep: 1 
iter: 3  mgc: 1.190159e-13 
outer mgc:  0.08637246 
iter: 1  value: 959.2984 mgc: 0.008238831 ustep: 1 
iter: 2  value: 959.2984 mgc: 1.601256e-06 ustep: 1 
iter: 3  mgc: 6.217249e-14 
outer mgc:  0.09385866 
iter: 1  value: 959.2908 mgc: 0.008256202 ustep: 1 
iter: 2  value: 959.2908 mgc: 1.606367e-06 ustep: 1 
iter: 3  mgc: 6.084022e-14 
outer mgc:  0.09320887 
[Sun Aug 15 08:35:20 2021]
Finished job 0.
1 of 1 steps (100%) done

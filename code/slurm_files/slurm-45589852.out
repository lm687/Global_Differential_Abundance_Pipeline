Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 02:00:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_0.4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_4_0.4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=4, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_0.4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2804.473493 
iter  10 value 2181.239703
final  value 2181.199200 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1713.874 mgc: 134.648 ustep: 1 
iter: 2  value: 831.3937 mgc: 87.44806 ustep: 0.0692153 
iter: 3  value: 454.4259 mgc: 89.03445 ustep: 0.2631617 
iter: 4  value: 419.81 mgc: 31.16152 ustep: 0.5130416 
iter: 5  value: 418.6259 mgc: 7.127734 ustep: 0.7162976 
iter: 6  value: 418.6166 mgc: 0.4673683 ustep: 0.846359 
iter: 7  value: 418.6166 mgc: 0.01100895 ustep: 0.9199857 
iter: 8  value: 418.6166 mgc: 0.0001617559 ustep: 0.959163 
iter: 9  value: 418.6166 mgc: 2.427571e-06 ustep: 0.9793707 
iter: 10  value: 418.6166 mgc: 2.118977e-08 ustep: 0.9896326 
iter: 11  mgc: 9.397549e-11 
iter: 1  mgc: 9.397549e-11 
Matching hessian patterns... Done
outer mgc:  193.1654 
iter: 1  value: 250.0447 mgc: 31.65695 ustep: 1 
iter: 2  value: 241.3919 mgc: 9.825913 ustep: 1 
iter: 3  value: 241.3437 mgc: 0.6242783 ustep: 1 
iter: 4  value: 241.3436 mgc: 0.008639926 ustep: 1 
iter: 5  value: 241.3436 mgc: 1.734893e-06 ustep: 1 
iter: 6  mgc: 6.794565e-14 
iter: 1  mgc: 6.794565e-14 
outer mgc:  71.62939 
iter: 1  value: 198.86 mgc: 25.35453 ustep: 1 
iter: 2  value: 196.3754 mgc: 5.223165 ustep: 1 
iter: 3  value: 196.3718 mgc: 0.1960345 ustep: 1 
iter: 4  value: 196.3718 mgc: 0.0006367874 ustep: 1 
iter: 5  mgc: 8.825634e-09 
iter: 1  mgc: 8.825634e-09 
outer mgc:  10.01405 
iter: 1  value: 189.1674 mgc: 27.59589 ustep: 1 
iter: 2  value: 188.4708 mgc: 2.942762 ustep: 1 
iter: 3  value: 188.4705 mgc: 0.06633236 ustep: 1 
iter: 4  value: 188.4705 mgc: 7.184279e-05 ustep: 1 
iter: 5  mgc: 8.496914e-11 
iter: 1  mgc: 8.496914e-11 
outer mgc:  21.90658 
iter: 1  value: 182.8716 mgc: 9.476331 ustep: 1 
iter: 2  value: 182.8367 mgc: 0.6549701 ustep: 1 
iter: 3  value: 182.8367 mgc: 0.004433759 ustep: 1 
iter: 4  value: 182.8367 mgc: 2.257351e-07 ustep: 1 
iter: 5  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  27.84112 
iter: 1  value: 182.1909 mgc: 19.93705 ustep: 1 
iter: 2  value: 180.7514 mgc: 3.833876 ustep: 1 
iter: 3  value: 180.7505 mgc: 0.1123945 ustep: 1 
iter: 4  value: 180.7505 mgc: 0.000100378 ustep: 1 
iter: 5  mgc: 8.145162e-11 
iter: 1  mgc: 8.145162e-11 
outer mgc:  35.59052 
iter: 1  value: 170.1449 mgc: 20.43705 ustep: 1 
iter: 2  value: 169.989 mgc: 1.492667 ustep: 1 
iter: 3  value: 169.989 mgc: 0.008313864 ustep: 1 
iter: 4  value: 169.989 mgc: 3.542052e-07 ustep: 1 
iter: 5  mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  8.761494 
iter: 1  value: 166.5807 mgc: 9.811391 ustep: 1 
iter: 2  value: 166.5418 mgc: 0.7958426 ustep: 1 
iter: 3  value: 166.5418 mgc: 0.004155156 ustep: 1 
iter: 4  value: 166.5418 mgc: 1.550159e-07 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  8.741092 
iter: 1  value: 165.4602 mgc: 24.946 ustep: 1 
iter: 2  value: 165.2557 mgc: 2.32923 ustep: 1 
iter: 3  value: 165.2557 mgc: 0.02155687 ustep: 1 
iter: 4  value: 165.2557 mgc: 3.289092e-06 ustep: 1 
iter: 5  mgc: 2.187139e-13 
iter: 1  mgc: 2.187139e-13 
outer mgc:  11.74178 
iter: 1  value: 161.3168 mgc: 7.858284 ustep: 1 
iter: 2  value: 161.3059 mgc: 0.3712645 ustep: 1 
iter: 3  value: 161.3059 mgc: 0.001066861 ustep: 1 
iter: 4  mgc: 8.947054e-09 
iter: 1  mgc: 8.947054e-09 
outer mgc:  8.485127 
iter: 1  value: 159.2314 mgc: 6.651744 ustep: 1 
iter: 2  value: 159.2171 mgc: 0.1648324 ustep: 1 
iter: 3  value: 159.2171 mgc: 0.000819623 ustep: 1 
iter: 4  value: 159.2171 mgc: 2.231168e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  5.524564 
iter: 1  value: 158.3739 mgc: 9.172653 ustep: 1 
iter: 2  value: 158.3644 mgc: 0.3175738 ustep: 1 
iter: 3  value: 158.3644 mgc: 0.001408689 ustep: 1 
iter: 4  value: 158.3644 mgc: 4.69353e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  value: 158.447 mgc: 5.223149 ustep: 1 
iter: 2  value: 158.4463 mgc: 0.1185214 ustep: 1 
iter: 3  value: 158.4463 mgc: 0.0001067735 ustep: 1 
iter: 4  mgc: 8.536177e-11 
iter: 1  mgc: 8.536177e-11 
outer mgc:  3.16878 
iter: 1  value: 157.9115 mgc: 2.759615 ustep: 1 
iter: 2  value: 157.9114 mgc: 0.01231964 ustep: 1 
iter: 3  value: 157.9114 mgc: 3.387515e-06 ustep: 1 
iter: 4  mgc: 2.433609e-13 
iter: 1  mgc: 2.433609e-13 
outer mgc:  3.176807 
iter: 1  value: 157.4843 mgc: 4.80285 ustep: 1 
iter: 2  value: 157.4836 mgc: 0.09363234 ustep: 1 
iter: 3  value: 157.4836 mgc: 9.53453e-05 ustep: 1 
iter: 4  mgc: 1.023126e-10 
iter: 1  value: 157.6438 mgc: 3.25089 ustep: 1 
iter: 2  value: 157.6437 mgc: 0.03237247 ustep: 1 
iter: 3  value: 157.6437 mgc: 9.907332e-06 ustep: 1 
iter: 4  mgc: 1.048051e-12 
iter: 1  mgc: 1.048051e-12 
outer mgc:  5.280768 
iter: 1  value: 157.5023 mgc: 2.676173 ustep: 1 
iter: 2  value: 157.5023 mgc: 0.01803715 ustep: 1 
iter: 3  value: 157.5023 mgc: 1.661367e-06 ustep: 1 
iter: 4  mgc: 2.16771e-14 
iter: 1  mgc: 2.16771e-14 
outer mgc:  2.544211 
iter: 1  value: 157.1249 mgc: 2.63806 ustep: 1 
iter: 2  value: 157.1249 mgc: 0.02324811 ustep: 1 
iter: 3  value: 157.1249 mgc: 2.52682e-06 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  1.608803 
iter: 1  value: 156.9712 mgc: 1.577829 ustep: 1 
iter: 2  value: 156.9712 mgc: 0.005665911 ustep: 1 
iter: 3  value: 156.9712 mgc: 1.235808e-07 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  1.626177 
iter: 1  value: 156.6917 mgc: 0.823945 ustep: 1 
iter: 2  value: 156.6917 mgc: 0.002317086 ustep: 1 
iter: 3  value: 156.6917 mgc: 3.017115e-08 ustep: 1 
mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  1.224577 
iter: 1  value: 156.6708 mgc: 0.6026187 ustep: 1 
iter: 2  value: 156.6708 mgc: 0.00235568 ustep: 1 
iter: 3  value: 156.6708 mgc: 5.976073e-08 ustep: 1 
mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  0.6077747 
iter: 1  value: 156.4586 mgc: 1.202533 ustep: 1 
iter: 2  value: 156.4586 mgc: 0.004463327 ustep: 1 
iter: 3  value: 156.4586 mgc: 9.253776e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.405214 
iter: 1  value: 156.1741 mgc: 0.5221224 ustep: 1 
iter: 2  value: 156.1741 mgc: 0.001098648 ustep: 1 
iter: 3  mgc: 8.687742e-09 
iter: 1  mgc: 8.687742e-09 
outer mgc:  0.4238767 
iter: 1  value: 156.0183 mgc: 0.4926939 ustep: 1 
iter: 2  value: 156.0183 mgc: 0.0005497925 ustep: 1 
iter: 3  mgc: 4.394151e-09 
iter: 1  value: 155.8636 mgc: 0.5369239 ustep: 1 
iter: 2  value: 155.8636 mgc: 0.0005929797 ustep: 1 
iter: 3  mgc: 5.512246e-09 
iter: 1  mgc: 5.512246e-09 
outer mgc:  0.3498952 
iter: 1  value: 155.5769 mgc: 1.171011 ustep: 1 
iter: 2  value: 155.5769 mgc: 0.003215152 ustep: 1 
iter: 3  value: 155.5769 mgc: 1.701197e-07 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.4865572 
iter: 1  value: 154.9047 mgc: 1.410083 ustep: 1 
iter: 2  value: 154.9047 mgc: 0.003930926 ustep: 1 
iter: 3  value: 154.9047 mgc: 7.733496e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  value: 155.3418 mgc: 0.4637218 ustep: 1 
iter: 2  value: 155.3418 mgc: 0.0004566327 ustep: 1 
iter: 3  mgc: 1.145241e-09 
iter: 1  mgc: 1.145241e-09 
outer mgc:  0.2745523 
iter: 1  value: 155.2727 mgc: 0.3400106 ustep: 1 
iter: 2  value: 155.2727 mgc: 0.0002391444 ustep: 1 
iter: 3  mgc: 4.300862e-10 
iter: 1  mgc: 4.300862e-10 
outer mgc:  0.3387015 
iter: 1  value: 155.2095 mgc: 0.8083878 ustep: 1 
iter: 2  value: 155.2095 mgc: 0.001088393 ustep: 1 
iter: 3  value: 155.2095 mgc: 1.481892e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  value: 155.2456 mgc: 0.4827464 ustep: 1 
iter: 2  value: 155.2456 mgc: 0.0003669083 ustep: 1 
iter: 3  mgc: 1.421562e-09 
iter: 1  mgc: 1.421562e-09 
outer mgc:  0.3625022 
iter: 1  value: 155.2317 mgc: 0.160281 ustep: 1 
iter: 2  value: 155.2317 mgc: 5.531361e-05 ustep: 1 
iter: 3  mgc: 1.517098e-11 
iter: 1  mgc: 1.517098e-11 
outer mgc:  0.02993947 
iter: 1  value: 155.2128 mgc: 0.05265335 ustep: 1 
iter: 2  value: 155.2128 mgc: 5.931115e-06 ustep: 1 
iter: 3  mgc: 7.753798e-13 
iter: 1  mgc: 7.753798e-13 
outer mgc:  0.03233989 
iter: 1  value: 155.207 mgc: 0.01596327 ustep: 1 
iter: 2  value: 155.207 mgc: 8.884256e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
iter: 1  value: 155.1975 mgc: 0.02243628 ustep: 1 
iter: 2  value: 155.1975 mgc: 1.62306e-06 ustep: 1 
iter: 3  mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  0.01251815 
iter: 1  value: 155.1896 mgc: 0.02188285 ustep: 1 
iter: 2  value: 155.1896 mgc: 7.324907e-07 ustep: 1 
iter: 3  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.006062943 
iter: 1  value: 155.1837 mgc: 0.01295046 ustep: 1 
iter: 2  value: 155.1837 mgc: 2.896203e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  value: 155.1869 mgc: 0.005892824 ustep: 1 
iter: 2  value: 155.1869 mgc: 1.111178e-07 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.004369411 
iter: 1  value: 155.1872 mgc: 0.001304375 ustep: 1 
iter: 2  mgc: 2.765652e-09 
iter: 1  mgc: 2.765652e-09 
outer mgc:  0.0008213696 
iter: 1  value: 155.1872 mgc: 0.0004769891 ustep: 1 
iter: 2  mgc: 3.199432e-10 
iter: 1  mgc: 3.199432e-10 
outer mgc:  0.0002571549 
iter: 1  value: 155.1873 mgc: 0.0002465803 ustep: 1 
iter: 2  mgc: 2.167813e-10 
iter: 1  mgc: 2.167813e-10 
outer mgc:  3.913841e-05 
iter: 1  mgc: 2.167813e-10 
iter: 1  mgc: 2.167813e-10 
outer mgc:  3.913841e-05 
iter: 1  value: 155.1871 mgc: 0.03085424 ustep: 1 
iter: 2  value: 155.1871 mgc: 3.670992e-06 ustep: 1 
iter: 3  mgc: 4.837797e-14 
outer mgc:  0.09833854 
iter: 1  value: 155.1875 mgc: 0.0308368 ustep: 1 
iter: 2  value: 155.1875 mgc: 3.67219e-06 ustep: 1 
iter: 3  mgc: 6.528111e-14 
outer mgc:  0.09825051 
iter: 1  value: 155.1871 mgc: 0.01174652 ustep: 1 
iter: 2  value: 155.1871 mgc: 5.253773e-07 ustep: 1 
iter: 3  mgc: 1.620926e-14 
outer mgc:  0.06877045 
iter: 1  value: 155.1875 mgc: 0.01173804 ustep: 1 
iter: 2  value: 155.1875 mgc: 5.247868e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.06877589 
iter: 1  value: 155.1874 mgc: 0.04533409 ustep: 1 
iter: 2  value: 155.1874 mgc: 5.064405e-06 ustep: 1 
iter: 3  mgc: 1.785239e-13 
outer mgc:  0.07268524 
iter: 1  value: 155.1872 mgc: 0.04531887 ustep: 1 
iter: 2  value: 155.1872 mgc: 5.066832e-06 ustep: 1 
iter: 3  mgc: 1.698641e-13 
outer mgc:  0.07270181 
iter: 1  value: 155.187 mgc: 0.01461982 ustep: 1 
iter: 2  value: 155.187 mgc: 6.612715e-07 ustep: 1 
iter: 3  mgc: 3.164136e-14 
outer mgc:  0.07055538 
iter: 1  value: 155.1875 mgc: 0.01461075 ustep: 1 
iter: 2  value: 155.1875 mgc: 6.605105e-07 ustep: 1 
iter: 3  mgc: 2.464695e-14 
outer mgc:  0.0704603 
iter: 1  value: 155.1877 mgc: 0.050722 ustep: 1 
iter: 2  value: 155.1877 mgc: 5.18777e-06 ustep: 1 
iter: 3  mgc: 2.229328e-13 
outer mgc:  0.09776866 
iter: 1  value: 155.1869 mgc: 0.05072046 ustep: 1 
iter: 2  value: 155.1869 mgc: 5.179486e-06 ustep: 1 
iter: 3  mgc: 1.971756e-13 
outer mgc:  0.09780268 
iter: 1  value: 155.188 mgc: 0.02313445 ustep: 1 
iter: 2  value: 155.188 mgc: 6.314946e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.1238503 
iter: 1  value: 155.1866 mgc: 0.02314213 ustep: 1 
iter: 2  value: 155.1866 mgc: 6.317987e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.123873 
iter: 1  value: 155.1881 mgc: 0.01203589 ustep: 1 
iter: 2  value: 155.1881 mgc: 4.122276e-07 ustep: 1 
iter: 3  mgc: 3.630429e-14 
outer mgc:  0.009308962 
iter: 1  value: 155.1864 mgc: 0.01202443 ustep: 1 
iter: 2  value: 155.1864 mgc: 4.117926e-07 ustep: 1 
iter: 3  mgc: 1.976197e-14 
outer mgc:  0.009298177 
iter: 1  value: 155.1857 mgc: 0.004933654 ustep: 1 
iter: 2  value: 155.1857 mgc: 5.26919e-08 ustep: 1 
mgc: 2.803313e-14 
outer mgc:  0.001041393 
iter: 1  value: 155.1888 mgc: 0.004930947 ustep: 1 
iter: 2  value: 155.1888 mgc: 5.271284e-08 ustep: 1 
mgc: 1.998401e-14 
outer mgc:  0.001031744 
iter: 1  value: 155.1863 mgc: 0.007572537 ustep: 1 
iter: 2  value: 155.1863 mgc: 8.783825e-08 ustep: 1 
mgc: 3.197442e-14 
outer mgc:  0.002683108 
iter: 1  value: 155.1882 mgc: 0.007570191 ustep: 1 
iter: 2  value: 155.1882 mgc: 8.796357e-08 ustep: 1 
mgc: 2.131628e-14 
outer mgc:  0.002690375 
iter: 1  value: 155.1936 mgc: 0.02957345 ustep: 1 
iter: 2  value: 155.1936 mgc: 2.166765e-06 ustep: 1 
iter: 3  mgc: 4.840572e-14 
outer mgc:  0.02747202 
iter: 1  value: 155.1809 mgc: 0.02964957 ustep: 1 
iter: 2  value: 155.1809 mgc: 2.168472e-06 ustep: 1 
iter: 3  mgc: 2.819966e-14 
outer mgc:  0.02739847 
iter: 1  value: 155.1924 mgc: 0.01322207 ustep: 1 
iter: 2  value: 155.1924 mgc: 5.951314e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.01202618 
iter: 1  value: 155.1821 mgc: 0.01324817 ustep: 1 
iter: 2  value: 155.1821 mgc: 5.955808e-07 ustep: 1 
iter: 3  mgc: 2.658984e-14 
outer mgc:  0.01202179 
iter: 1  value: 155.1862 mgc: 0.03141553 ustep: 1 
iter: 2  value: 155.1862 mgc: 1.463341e-06 ustep: 1 
iter: 3  mgc: 1.498801e-14 
outer mgc:  0.05559811 
iter: 1  value: 155.1883 mgc: 0.03149836 ustep: 1 
iter: 2  value: 155.1883 mgc: 1.467129e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.05579723 
[Mon Aug 16 02:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

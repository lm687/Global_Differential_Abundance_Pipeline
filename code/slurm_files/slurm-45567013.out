Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 18:49:23 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4394.449155 
iter  10 value 2151.662848
iter  20 value 2146.668095
iter  30 value 2146.652331
final  value 2146.652246 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2413.103 mgc: 2.546639 ustep: 0.6827823 
iter: 2  value: 2392.358 mgc: 1.159502 ustep: 0.5831969 
iter: 3  value: 2379.962 mgc: 2.330585 ustep: 0.5138385 
iter: 4  value: 2368.584 mgc: 1.151304 ustep: 0.4678382 
iter: 5  value: 2358.638 mgc: 1.125032 ustep: 0.437834 
iter: 6  value: 2342.831 mgc: 1.113027 ustep: 0.6617241 
iter: 7  value: 2335.704 mgc: 1.181034 ustep: 0.5680669 
iter: 8  value: 2333.484 mgc: 1.975137 ustep: 0.7537268 
iter: 9  value: 2332.849 mgc: 1.188899 ustep: 0.6368765 
iter: 10  value: 2331.981 mgc: 0.3762491 ustep: 0.5505738 
iter: 11  value: 2329.603 mgc: 0.8675469 ustep: 0.4920457 
iter: 12  value: 2328.284 mgc: 0.9753368 ustep: 0.7014896 
iter: 13  value: 2327.996 mgc: 0.4470381 ustep: 0.5969093 
iter: 14  value: 2327.596 mgc: 0.3076296 ustep: 0.5231057 
iter: 15  value: 2326.541 mgc: 0.5588514 ustep: 0.4739185 
iter: 16  value: 2324.69 mgc: 0.9866609 ustep: 0.4417879 
iter: 17  value: 2323.293 mgc: 1.029398 ustep: 0.6647048 
iter: 18  value: 2323.086 mgc: 0.5730001 ustep: 0.8153128 
iter: 19  value: 2323.071 mgc: 0.1051721 ustep: 0.9029564 
iter: 20  value: 2323.071 mgc: 0.01613262 ustep: 0.9502452 
iter: 21  value: 2323.071 mgc: 0.001342623 ustep: 0.9748077 
iter: 22  value: 2323.071 mgc: 5.660802e-05 ustep: 0.9873248 
iter: 23  value: 2323.071 mgc: 1.192048e-06 ustep: 0.9936428 
iter: 24  value: 2323.071 mgc: 1.257889e-08 ustep: 0.9968167 
iter: 25  mgc: 6.653988e-11 
iter: 1  mgc: 6.653988e-11 
Matching hessian patterns... Done
outer mgc:  79.59151 
iter: 1  value: 2270.415 mgc: 0.9339086 ustep: 1 
iter: 2  value: 2269.014 mgc: 0.2014591 ustep: 1 
iter: 3  value: 2267.707 mgc: 0.4360019 ustep: 0.6827823 
iter: 4  value: 2266.578 mgc: 0.4948389 ustep: 0.5831969 
iter: 5  value: 2262.792 mgc: 0.4493077 ustep: 0.7636969 
iter: 6  value: 2262.256 mgc: 0.6825051 ustep: 0.8739102 
iter: 7  value: 2261.618 mgc: 1.161848 ustep: 0.9348381 
iter: 8  value: 2261.595 mgc: 0.2652408 ustep: 0.9668736 
iter: 9  value: 2261.595 mgc: 0.01046132 ustep: 0.983299 
iter: 10  value: 2261.595 mgc: 0.0001116875 ustep: 0.9916152 
iter: 11  value: 2261.595 mgc: 1.074567e-06 ustep: 0.9957992 
iter: 12  mgc: 8.795659e-09 
iter: 1  mgc: 8.795659e-09 
outer mgc:  24.95987 
iter: 1  value: 2245.234 mgc: 1.380292 ustep: 1 
iter: 2  value: 2245.158 mgc: 0.1294794 ustep: 1 
iter: 3  value: 2245.158 mgc: 0.002579924 ustep: 1 
iter: 4  value: 2245.158 mgc: 6.859906e-06 ustep: 1 
iter: 5  mgc: 3.369038e-11 
iter: 1  mgc: 3.369038e-11 
outer mgc:  22.26177 
iter: 1  value: 2226.548 mgc: 1.359718 ustep: 1 
iter: 2  value: 2226.443 mgc: 0.1491917 ustep: 1 
iter: 3  value: 2226.443 mgc: 0.007450067 ustep: 1 
iter: 4  value: 2226.443 mgc: 1.946412e-05 ustep: 1 
iter: 5  mgc: 5.283243e-10 
iter: 1  mgc: 5.283243e-10 
outer mgc:  19.85696 
iter: 1  value: 2202.901 mgc: 1.261316 ustep: 1 
iter: 2  value: 2202.817 mgc: 0.0438649 ustep: 1 
iter: 3  value: 2202.817 mgc: 0.004573245 ustep: 1 
iter: 4  value: 2202.817 mgc: 1.5919e-05 ustep: 1 
iter: 5  mgc: 1.888844e-10 
iter: 1  value: 2173.519 mgc: 7.704769 ustep: 1 
iter: 2  value: 2173.429 mgc: 0.2517677 ustep: 1 
iter: 3  value: 2173.429 mgc: 0.001510158 ustep: 1 
iter: 4  value: 2173.429 mgc: 2.293051e-07 ustep: 1 
iter: 5  mgc: 4.746203e-15 
iter: 1  mgc: 4.746203e-15 
outer mgc:  19.55218 
iter: 1  value: 2116.624 mgc: 3.928618 ustep: 1 
iter: 2  value: 2116.621 mgc: 0.04869087 ustep: 1 
iter: 3  value: 2116.621 mgc: 0.0001005682 ustep: 1 
iter: 4  mgc: 1.144356e-10 
iter: 1  mgc: 1.144356e-10 
outer mgc:  22.2619 
iter: 1  value: 2091.915 mgc: 4.324351 ustep: 1 
iter: 2  value: 2091.895 mgc: 0.2192046 ustep: 1 
iter: 3  value: 2091.895 mgc: 0.001373055 ustep: 1 
iter: 4  value: 2091.895 mgc: 2.362705e-07 ustep: 1 
iter: 5  mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  30.74172 
iter: 1  value: 2063.056 mgc: 2.182221 ustep: 1 
iter: 2  value: 2063.047 mgc: 0.1008362 ustep: 1 
iter: 3  value: 2063.047 mgc: 0.001197987 ustep: 1 
iter: 4  value: 2063.047 mgc: 7.689229e-08 ustep: 1 
iter: 5  mgc: 1.665335e-15 
iter: 1  mgc: 1.665335e-15 
outer mgc:  13.13048 
iter: 1  value: 2046.203 mgc: 25.32436 ustep: 1 
iter: 2  value: 2046.149 mgc: 0.2913508 ustep: 1 
iter: 3  value: 2046.149 mgc: 0.007762632 ustep: 1 
iter: 4  value: 2046.149 mgc: 2.781762e-06 ustep: 1 
iter: 5  mgc: 5.901946e-13 
iter: 1  mgc: 5.901946e-13 
outer mgc:  11.50978 
iter: 1  value: 2024.152 mgc: 3.208714 ustep: 1 
iter: 2  value: 2024.151 mgc: 0.03381513 ustep: 1 
iter: 3  value: 2024.151 mgc: 1.71267e-05 ustep: 1 
iter: 4  mgc: 1.242006e-12 
iter: 1  mgc: 1.242006e-12 
outer mgc:  12.02641 
iter: 1  value: 2006.081 mgc: 19.9087 ustep: 1 
iter: 2  value: 2006.01 mgc: 0.4723334 ustep: 1 
iter: 3  value: 2006.01 mgc: 0.005751589 ustep: 1 
iter: 4  value: 2006.01 mgc: 2.526021e-07 ustep: 1 
iter: 5  mgc: 8.65974e-15 
iter: 1  mgc: 8.65974e-15 
outer mgc:  28.21384 
iter: 1  value: 1993.467 mgc: 3.131468 ustep: 1 
iter: 2  value: 1993.465 mgc: 0.06469595 ustep: 1 
iter: 3  value: 1993.465 mgc: 3.120897e-05 ustep: 1 
iter: 4  mgc: 5.361322e-12 
iter: 1  mgc: 5.361322e-12 
outer mgc:  16.45143 
iter: 1  value: 1987.591 mgc: 2.277936 ustep: 1 
iter: 2  value: 1987.591 mgc: 0.0468397 ustep: 1 
iter: 3  value: 1987.591 mgc: 1.94709e-05 ustep: 1 
iter: 4  mgc: 2.775558e-12 
iter: 1  mgc: 2.775558e-12 
outer mgc:  5.627563 
iter: 1  value: 1985.428 mgc: 11.56357 ustep: 1 
iter: 2  value: 1985.426 mgc: 0.0763035 ustep: 1 
iter: 3  value: 1985.426 mgc: 3.636364e-05 ustep: 1 
iter: 4  mgc: 8.890444e-12 
iter: 1  mgc: 8.890444e-12 
outer mgc:  18.8022 
iter: 1  value: 1976.857 mgc: 3.019755 ustep: 1 
iter: 2  value: 1976.857 mgc: 0.004889288 ustep: 1 
iter: 3  value: 1976.857 mgc: 4.589309e-08 ustep: 1 
mgc: 4.163336e-15 
iter: 1  value: 1968.431 mgc: 4.231732 ustep: 1 
iter: 2  value: 1968.431 mgc: 0.009871367 ustep: 1 
iter: 3  value: 1968.431 mgc: 5.808109e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  value: 1952.125 mgc: 14.29064 ustep: 1 
iter: 2  value: 1952.123 mgc: 0.108968 ustep: 1 
iter: 3  value: 1952.123 mgc: 0.0001508888 ustep: 1 
iter: 4  mgc: 2.156688e-10 
iter: 1  mgc: 2.156688e-10 
outer mgc:  11.74256 
iter: 1  value: 1965.097 mgc: 4.563273 ustep: 1 
iter: 2  value: 1965.092 mgc: 0.0868713 ustep: 1 
iter: 3  value: 1965.092 mgc: 0.0003695123 ustep: 1 
iter: 4  mgc: 6.803592e-09 
iter: 1  value: 1955.198 mgc: 2.148754 ustep: 1 
iter: 2  value: 1955.198 mgc: 0.01894001 ustep: 1 
iter: 3  value: 1955.198 mgc: 5.236307e-06 ustep: 1 
iter: 4  mgc: 4.087841e-13 
iter: 1  mgc: 4.087841e-13 
outer mgc:  5.820029 
iter: 1  value: 1957.938 mgc: 5.836497 ustep: 1 
iter: 2  value: 1957.938 mgc: 0.02774158 ustep: 1 
iter: 3  value: 1957.938 mgc: 1.305734e-05 ustep: 1 
iter: 4  mgc: 1.43574e-12 
iter: 1  mgc: 1.43574e-12 
outer mgc:  2.348433 
iter: 1  value: 1958.589 mgc: 3.340642 ustep: 1 
iter: 2  value: 1958.589 mgc: 0.008337459 ustep: 1 
iter: 3  value: 1958.589 mgc: 1.290342e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  value: 1960.974 mgc: 4.447085 ustep: 1 
iter: 2  value: 1960.974 mgc: 0.05721167 ustep: 1 
iter: 3  value: 1960.974 mgc: 1.727723e-05 ustep: 1 
iter: 4  mgc: 2.860823e-12 
iter: 1  mgc: 2.860823e-12 
outer mgc:  2.4947 
iter: 1  value: 1957.929 mgc: 1.274716 ustep: 1 
iter: 2  value: 1957.929 mgc: 0.005663229 ustep: 1 
iter: 3  value: 1957.929 mgc: 2.744929e-07 ustep: 1 
iter: 4  mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  3.034335 
iter: 1  value: 1956.361 mgc: 10.52498 ustep: 1 
iter: 2  value: 1956.359 mgc: 0.08636832 ustep: 1 
iter: 3  value: 1956.359 mgc: 0.0001587821 ustep: 1 
iter: 4  mgc: 2.684146e-10 
iter: 1  mgc: 2.684146e-10 
outer mgc:  2.489416 
iter: 1  value: 1957.359 mgc: 4.20843 ustep: 1 
iter: 2  value: 1957.358 mgc: 0.02107574 ustep: 1 
iter: 3  value: 1957.358 mgc: 2.222839e-06 ustep: 1 
iter: 4  mgc: 2.626788e-13 
iter: 1  mgc: 2.626788e-13 
outer mgc:  0.522352 
iter: 1  value: 1956.463 mgc: 0.6459758 ustep: 1 
iter: 2  value: 1956.463 mgc: 0.0004440008 ustep: 1 
iter: 3  mgc: 4.40242e-09 
iter: 1  mgc: 4.40242e-09 
outer mgc:  0.6327662 
iter: 1  value: 1953.436 mgc: 1.426162 ustep: 1 
iter: 2  value: 1953.436 mgc: 0.001497665 ustep: 1 
iter: 3  value: 1953.436 mgc: 3.36214e-08 ustep: 1 
mgc: 7.244205e-15 
iter: 1  mgc: 7.244205e-15 
outer mgc:  0.529184 
iter: 1  value: 1950.761 mgc: 1.945468 ustep: 1 
iter: 2  value: 1950.761 mgc: 0.001249758 ustep: 1 
iter: 3  mgc: 8.219435e-09 
iter: 1  mgc: 8.219435e-09 
outer mgc:  0.2996613 
iter: 1  value: 1948.279 mgc: 1.787338 ustep: 1 
iter: 2  value: 1948.279 mgc: 0.0007463504 ustep: 1 
iter: 3  mgc: 2.709506e-09 
iter: 1  mgc: 2.709506e-09 
outer mgc:  0.05365028 
iter: 1  value: 1946.29 mgc: 1.34649 ustep: 1 
iter: 2  value: 1946.29 mgc: 8.658297e-05 ustep: 1 
iter: 3  mgc: 4.256371e-10 
iter: 1  mgc: 4.256371e-10 
outer mgc:  0.1447866 
iter: 1  value: 1944.337 mgc: 0.7406225 ustep: 1 
iter: 2  value: 1944.337 mgc: 3.93064e-05 ustep: 1 
iter: 3  mgc: 1.613243e-11 
iter: 1  mgc: 1.613243e-11 
outer mgc:  0.122262 
iter: 1  value: 1941.712 mgc: 1.053668 ustep: 1 
iter: 2  value: 1941.712 mgc: 0.0001062171 ustep: 1 
iter: 3  mgc: 1.913727e-10 
iter: 1  mgc: 1.913727e-10 
outer mgc:  0.09155632 
iter: 1  value: 1939.206 mgc: 1.04156 ustep: 1 
iter: 2  value: 1939.206 mgc: 6.76645e-05 ustep: 1 
iter: 3  mgc: 6.046097e-11 
iter: 1  mgc: 6.046097e-11 
outer mgc:  0.04610104 
iter: 1  value: 1936.108 mgc: 1.258734 ustep: 1 
iter: 2  value: 1936.108 mgc: 4.858061e-05 ustep: 1 
iter: 3  mgc: 3.604783e-11 
iter: 1  mgc: 3.604783e-11 
outer mgc:  0.06830023 
iter: 1  value: 1933.344 mgc: 1.106192 ustep: 1 
iter: 2  value: 1933.344 mgc: 1.680503e-05 ustep: 1 
iter: 3  mgc: 1.879608e-12 
iter: 1  mgc: 1.879608e-12 
outer mgc:  0.02785373 
iter: 1  value: 1929.261 mgc: 2.109662 ustep: 1 
iter: 2  value: 1929.261 mgc: 1.583553e-05 ustep: 1 
iter: 3  mgc: 2.353007e-12 
iter: 1  mgc: 2.353007e-12 
outer mgc:  0.03030411 
iter: 1  value: 1925.863 mgc: 1.506906 ustep: 1 
iter: 2  value: 1925.863 mgc: 3.92328e-06 ustep: 1 
iter: 3  mgc: 1.867395e-13 
iter: 1  mgc: 1.867395e-13 
outer mgc:  0.01369822 
iter: 1  value: 1921.733 mgc: 1.888953 ustep: 1 
iter: 2  value: 1921.733 mgc: 2.45933e-06 ustep: 1 
iter: 3  mgc: 2.73559e-13 
iter: 1  mgc: 2.73559e-13 
outer mgc:  0.01052876 
iter: 1  value: 1918.318 mgc: 1.401483 ustep: 1 
iter: 2  value: 1918.318 mgc: 9.192683e-07 ustep: 1 
iter: 3  mgc: 2.591816e-13 
iter: 1  mgc: 2.591816e-13 
outer mgc:  0.01116569 
iter: 1  value: 1914.136 mgc: 1.818163 ustep: 1 
iter: 2  value: 1914.136 mgc: 8.901278e-07 ustep: 1 
iter: 3  mgc: 4.665157e-13 
iter: 1  mgc: 4.665157e-13 
outer mgc:  0.01240168 
iter: 1  value: 1910.69 mgc: 1.455263 ustep: 1 
iter: 2  value: 1910.69 mgc: 4.353339e-07 ustep: 1 
iter: 3  mgc: 6.526446e-13 
iter: 1  mgc: 6.526446e-13 
outer mgc:  0.004232345 
iter: 1  value: 1906.5 mgc: 1.836881 ustep: 1 
iter: 2  value: 1906.5 mgc: 4.034117e-07 ustep: 1 
iter: 3  mgc: 6.963319e-13 
iter: 1  mgc: 6.963319e-13 
outer mgc:  0.006653834 
iter: 1  value: 1903.049 mgc: 1.412298 ustep: 1 
iter: 2  value: 1903.049 mgc: 1.15063e-07 ustep: 1 
iter: 3  mgc: 1.081357e-12 
iter: 1  mgc: 1.081357e-12 
outer mgc:  0.005816188 
iter: 1  value: 1898.841 mgc: 1.866118 ustep: 1 
iter: 2  value: 1898.841 mgc: 6.790562e-08 ustep: 1 
iter: 3  mgc: 1.703138e-12 
iter: 1  mgc: 1.703138e-12 
outer mgc:  0.005444843 
iter: 1  value: 1895.375 mgc: 1.954296 ustep: 1 
iter: 2  value: 1895.375 mgc: 5.076348e-08 ustep: 1 
iter: 3  mgc: 3.011813e-12 
iter: 1  mgc: 3.011813e-12 
outer mgc:  0.002456999 
iter: 1  value: 1891.169 mgc: 2.326828 ustep: 1 
iter: 2  value: 1891.169 mgc: 3.666734e-08 ustep: 1 
iter: 3  mgc: 3.428813e-12 
iter: 1  mgc: 3.428813e-12 
outer mgc:  0.002692669 
iter: 1  value: 1887.702 mgc: 1.672862 ustep: 1 
iter: 2  value: 1887.702 mgc: 1.142592e-08 ustep: 1 
mgc: 6.691425e-12 
iter: 1  mgc: 6.691425e-12 
outer mgc:  0.001984568 
iter: 1  value: 1883.498 mgc: 1.851423 ustep: 1 
iter: 2  mgc: 8.334452e-09 
iter: 1  mgc: 8.334452e-09 
outer mgc:  0.001906751 
iter: 1  value: 1880.03 mgc: 1.516084 ustep: 1 
iter: 2  mgc: 4.656556e-09 
iter: 1  mgc: 4.656556e-09 
outer mgc:  0.0007457981 
iter: 1  value: 1875.833 mgc: 2.214315 ustep: 1 
iter: 2  mgc: 4.339596e-09 
iter: 1  mgc: 4.339596e-09 
outer mgc:  NaN 
Error in nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) : 
  NA/NaN gradient evaluation
[Sat Aug 14 18:49:27 2021]
Finished job 0.
1 of 1 steps (100%) done

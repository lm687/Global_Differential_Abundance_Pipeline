Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:53:38 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.6_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.6_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.6, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.6_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.6_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.6_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.6_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22001.908305 
iter  10 value 16356.588726
iter  10 value 16356.588721
final  value 16356.588721 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 15826.68 mgc: 2.612125 ustep: 1 
iter: 2  value: 15708.57 mgc: 4.42011 ustep: 0.8994163 
iter: 3  value: 15692.08 mgc: 3.30673 ustep: 0.6095513 
iter: 4  value: 15681.18 mgc: 3.961158 ustep: 0.7807596 
iter: 5  value: 15671.65 mgc: 4.350278 ustep: 0.3492159 
iter: 6  value: 15669.72 mgc: 2.21241 ustep: 0.5909858 
iter: 7  value: 15669.65 mgc: 0.3478889 ustep: 0.7687792 
iter: 8  value: 15669.65 mgc: 0.05542973 ustep: 0.8768128 
iter: 9  value: 15669.65 mgc: 0.00640786 ustep: 0.9363892 
iter: 10  value: 15669.65 mgc: 0.0005239116 ustep: 0.9676753 
iter: 11  value: 15669.65 mgc: 2.534636e-05 ustep: 0.9837065 
iter: 12  value: 15669.65 mgc: 6.461467e-07 ustep: 0.9918206 
iter: 13  mgc: 8.366492e-09 
iter: 1  mgc: 8.366492e-09 
Matching hessian patterns... Done
outer mgc:  139.8257 
iter: 1  value: 15548.19 mgc: 2.024239 ustep: 1 
iter: 2  value: 15546.47 mgc: 0.3988084 ustep: 1 
iter: 3  value: 15546.47 mgc: 0.0122775 ustep: 1 
iter: 4  value: 15546.47 mgc: 4.651964e-05 ustep: 1 
iter: 5  mgc: 3.20984e-10 
iter: 1  mgc: 3.20984e-10 
outer mgc:  82.75553 
iter: 1  value: 15404.43 mgc: 2.262966 ustep: 1 
iter: 2  value: 15404.28 mgc: 0.1226415 ustep: 1 
iter: 3  value: 15404.28 mgc: 0.003093698 ustep: 1 
iter: 4  value: 15404.28 mgc: 4.432065e-07 ustep: 1 
iter: 5  mgc: 5.373479e-14 
iter: 1  mgc: 5.373479e-14 
outer mgc:  124.5477 
iter: 1  value: 15326.07 mgc: 1.815646 ustep: 1 
iter: 2  value: 15323.72 mgc: 0.540693 ustep: 1 
iter: 3  value: 15323.72 mgc: 0.01196596 ustep: 1 
iter: 4  value: 15323.72 mgc: 2.105508e-05 ustep: 1 
iter: 5  mgc: 2.449196e-11 
iter: 1  mgc: 2.449196e-11 
outer mgc:  103.1127 
iter: 1  value: 15065.09 mgc: 4.15143 ustep: 1 
iter: 2  value: 15061.48 mgc: 1.203869 ustep: 1 
iter: 3  value: 15061.47 mgc: 0.1031877 ustep: 1 
iter: 4  value: 15061.47 mgc: 0.001032747 ustep: 1 
iter: 5  value: 15061.47 mgc: 1.115539e-07 ustep: 1 
iter: 6  mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  64.78316 
iter: 1  value: 14904.07 mgc: 69.52417 ustep: 1 
iter: 2  value: 14903.56 mgc: 0.7285808 ustep: 1 
iter: 3  value: 14903.56 mgc: 0.0165418 ustep: 1 
iter: 4  value: 14903.56 mgc: 2.496234e-06 ustep: 1 
iter: 5  mgc: 7.638334e-14 
iter: 1  mgc: 7.638334e-14 
outer mgc:  107.6247 
iter: 1  value: 15183.63 mgc: 28.06118 ustep: 1 
iter: 2  value: 15183.3 mgc: 0.884712 ustep: 1 
iter: 3  value: 15183.3 mgc: 0.005499337 ustep: 1 
iter: 4  value: 15183.3 mgc: 2.99112e-07 ustep: 1 
iter: 5  mgc: 1.376677e-14 
iter: 1  value: 14877.01 mgc: 3.763055 ustep: 1 
iter: 2  value: 14877 mgc: 0.03539395 ustep: 1 
iter: 3  value: 14877 mgc: 1.622477e-05 ustep: 1 
iter: 4  mgc: 6.958656e-12 
iter: 1  mgc: 6.958656e-12 
outer mgc:  34.33928 
iter: 1  value: 14865.83 mgc: 5.956497 ustep: 1 
iter: 2  value: 14865.83 mgc: 0.03147686 ustep: 1 
iter: 3  value: 14865.83 mgc: 8.520856e-06 ustep: 1 
iter: 4  mgc: 1.799894e-12 
iter: 1  mgc: 1.799894e-12 
outer mgc:  69.53151 
iter: 1  value: 14844.01 mgc: 2.820743 ustep: 1 
iter: 2  value: 14844.01 mgc: 0.01702155 ustep: 1 
iter: 3  value: 14844.01 mgc: 4.139939e-06 ustep: 1 
iter: 4  mgc: 4.238832e-13 
iter: 1  mgc: 4.238832e-13 
outer mgc:  41.28269 
iter: 1  value: 14830.24 mgc: 1.839218 ustep: 1 
iter: 2  value: 14830.24 mgc: 0.02534453 ustep: 1 
iter: 3  value: 14830.24 mgc: 4.631358e-06 ustep: 1 
iter: 4  mgc: 3.503864e-13 
iter: 1  mgc: 3.503864e-13 
outer mgc:  9.972856 
iter: 1  value: 14805.24 mgc: 1.212705 ustep: 1 
iter: 2  value: 14805.24 mgc: 0.001096844 ustep: 1 
iter: 3  value: 14805.24 mgc: 1.333656e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  value: 14823.14 mgc: 1.394131 ustep: 1 
iter: 2  value: 14823.14 mgc: 0.0008042263 ustep: 1 
iter: 3  mgc: 9.562734e-09 
iter: 1  mgc: 9.562734e-09 
outer mgc:  12.20595 
iter: 1  value: 14816.81 mgc: 0.9778962 ustep: 1 
iter: 2  value: 14816.81 mgc: 0.001001788 ustep: 1 
iter: 3  mgc: 9.136015e-09 
iter: 1  value: 14823.12 mgc: 0.6328092 ustep: 1 
iter: 2  value: 14823.12 mgc: 0.0002599614 ustep: 1 
iter: 3  mgc: 1.230876e-09 
iter: 1  mgc: 1.230876e-09 
outer mgc:  5.708347 
iter: 1  value: 14824.57 mgc: 0.6836124 ustep: 1 
iter: 2  value: 14824.57 mgc: 0.0002508475 ustep: 1 
iter: 3  mgc: 2.59003e-10 
iter: 1  mgc: 2.59003e-10 
outer mgc:  3.212717 
iter: 1  value: 14826.28 mgc: 0.9481016 ustep: 1 
iter: 2  value: 14826.28 mgc: 0.0002327892 ustep: 1 
iter: 3  mgc: 5.649898e-10 
iter: 1  mgc: 5.649898e-10 
outer mgc:  4.028318 
iter: 1  value: 14829.54 mgc: 0.5636419 ustep: 1 
iter: 2  value: 14829.54 mgc: 0.000845821 ustep: 1 
iter: 3  value: 14829.54 mgc: 2.064297e-08 ustep: 1 
mgc: 8.854029e-15 
iter: 1  mgc: 8.854029e-15 
outer mgc:  4.149185 
iter: 1  value: 14832.46 mgc: 0.8427603 ustep: 1 
iter: 2  value: 14832.46 mgc: 0.0006539915 ustep: 1 
iter: 3  value: 14832.46 mgc: 1.544425e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  2.042691 
iter: 1  value: 14837.39 mgc: 1.336759 ustep: 1 
iter: 2  value: 14837.39 mgc: 0.0007150263 ustep: 1 
iter: 3  mgc: 4.891529e-09 
iter: 1  mgc: 4.891529e-09 
outer mgc:  6.142729 
iter: 1  value: 14840.03 mgc: 1.196058 ustep: 1 
iter: 2  value: 14840.03 mgc: 0.0005467704 ustep: 1 
iter: 3  mgc: 1.644853e-09 
iter: 1  mgc: 1.644853e-09 
outer mgc:  6.286945 
iter: 1  value: 14838.27 mgc: 0.4691179 ustep: 1 
iter: 2  value: 14838.27 mgc: 0.0002881258 ustep: 1 
iter: 3  mgc: 3.252351e-09 
iter: 1  mgc: 3.252351e-09 
outer mgc:  1.74329 
iter: 1  value: 14837.27 mgc: 0.5979775 ustep: 1 
iter: 2  value: 14837.27 mgc: 0.0005481684 ustep: 1 
iter: 3  mgc: 2.954907e-09 
iter: 1  value: 14838 mgc: 0.1165008 ustep: 1 
iter: 2  value: 14838 mgc: 2.143112e-05 ustep: 1 
iter: 3  mgc: 4.313883e-12 
iter: 1  mgc: 4.313883e-12 
outer mgc:  1.260708 
iter: 1  value: 14837.89 mgc: 0.08268303 ustep: 1 
iter: 2  value: 14837.89 mgc: 1.425489e-05 ustep: 1 
iter: 3  mgc: 1.636913e-12 
iter: 1  mgc: 1.636913e-12 
outer mgc:  0.9450593 
iter: 1  value: 14837.53 mgc: 0.1242814 ustep: 1 
iter: 2  value: 14837.53 mgc: 4.2271e-05 ustep: 1 
iter: 3  mgc: 6.614442e-11 
iter: 1  value: 14837.09 mgc: 0.1338147 ustep: 1 
iter: 2  value: 14837.09 mgc: 5.351361e-05 ustep: 1 
iter: 3  mgc: 1.043805e-10 
iter: 1  value: 14836.31 mgc: 0.2565409 ustep: 1 
iter: 2  value: 14836.31 mgc: 0.0001836551 ustep: 1 
iter: 3  mgc: 1.206904e-09 
iter: 1  mgc: 1.206904e-09 
outer mgc:  1.38233 
iter: 1  value: 14831.97 mgc: 0.6772486 ustep: 1 
iter: 2  value: 14831.97 mgc: 0.0001443077 ustep: 1 
iter: 3  mgc: 4.178813e-11 
iter: 1  value: 14823.7 mgc: 1.125614 ustep: 1 
iter: 2  value: 14823.7 mgc: 0.0003906631 ustep: 1 
iter: 3  mgc: 1.924838e-09 
iter: 1  mgc: 1.924838e-09 
outer mgc:  2.605859 
iter: 1  value: 14808.95 mgc: 1.937325 ustep: 1 
iter: 2  value: 14808.95 mgc: 0.0006783633 ustep: 1 
iter: 3  value: 14808.95 mgc: 1.224512e-08 ustep: 1 
mgc: 1.432188e-14 
iter: 1  mgc: 1.432188e-14 
outer mgc:  0.8513332 
iter: 1  value: 14814.08 mgc: 2.874289 ustep: 1 
iter: 2  value: 14814.08 mgc: 0.006612088 ustep: 1 
iter: 3  value: 14814.08 mgc: 2.237291e-06 ustep: 1 
iter: 4  mgc: 1.854628e-13 
iter: 1  mgc: 1.854628e-13 
outer mgc:  1.57592 
iter: 1  value: 14798.9 mgc: 1.771328 ustep: 1 
iter: 2  value: 14798.9 mgc: 0.0005388283 ustep: 1 
iter: 3  value: 14798.9 mgc: 1.46044e-08 ustep: 1 
mgc: 1.804112e-14 
iter: 1  mgc: 1.804112e-14 
outer mgc:  0.9855736 
iter: 1  value: 14787 mgc: 1.436315 ustep: 1 
iter: 2  value: 14787 mgc: 0.000194591 ustep: 1 
iter: 3  mgc: 1.535172e-09 
iter: 1  mgc: 1.535172e-09 
outer mgc:  1.418191 
iter: 1  value: 14775.91 mgc: 1.553331 ustep: 1 
iter: 2  value: 14775.91 mgc: 0.0001361787 ustep: 1 
iter: 3  mgc: 2.093055e-10 
iter: 1  value: 14762.9 mgc: 2.553591 ustep: 1 
iter: 2  value: 14762.9 mgc: 0.0001857027 ustep: 1 
iter: 3  mgc: 5.282428e-10 
iter: 1  mgc: 5.282428e-10 
outer mgc:  0.6963089 
iter: 1  value: 14750.53 mgc: 7.758311 ustep: 1 
iter: 2  value: 14750.53 mgc: 0.0007177921 ustep: 1 
iter: 3  mgc: 1.027387e-09 
iter: 1  mgc: 1.027387e-09 
outer mgc:  0.6250614 
iter: 1  value: 14738.75 mgc: 1.45819 ustep: 1 
iter: 2  value: 14738.75 mgc: 4.859365e-05 ustep: 1 
iter: 3  mgc: 6.503331e-11 
iter: 1  mgc: 6.503331e-11 
outer mgc:  0.2830637 
iter: 1  value: 14718.54 mgc: 2.626074 ustep: 1 
iter: 2  value: 14718.54 mgc: 6.65798e-05 ustep: 1 
iter: 3  mgc: 1.406217e-10 
iter: 1  mgc: 1.406217e-10 
outer mgc:  0.1311198 
iter: 1  value: 14701.87 mgc: 2.146791 ustep: 1 
iter: 2  value: 14701.87 mgc: 6.074604e-06 ustep: 1 
iter: 3  mgc: 2.78888e-13 
iter: 1  mgc: 2.78888e-13 
outer mgc:  0.1609148 
iter: 1  value: 14681.24 mgc: 2.7445 ustep: 1 
iter: 2  value: 14681.24 mgc: 3.37921e-06 ustep: 1 
iter: 3  mgc: 1.761924e-13 
iter: 1  mgc: 1.761924e-13 
outer mgc:  0.08225399 
iter: 1  value: 14664.08 mgc: 2.182395 ustep: 1 
iter: 2  value: 14664.08 mgc: 1.140639e-06 ustep: 1 
iter: 3  mgc: 2.624567e-13 
iter: 1  mgc: 2.624567e-13 
outer mgc:  0.02524417 
iter: 1  value: 14643.34 mgc: 2.764592 ustep: 1 
iter: 2  value: 14643.34 mgc: 7.71636e-07 ustep: 1 
iter: 3  mgc: 4.356515e-13 
iter: 1  mgc: 4.356515e-13 
outer mgc:  0.017963 
iter: 1  value: 14626.26 mgc: 2.23501 ustep: 1 
iter: 2  value: 14626.26 mgc: 3.196697e-07 ustep: 1 
iter: 3  mgc: 9.630075e-13 
iter: 1  mgc: 9.630075e-13 
outer mgc:  0.01284992 
iter: 1  value: 14605.35 mgc: 2.878347 ustep: 1 
iter: 2  value: 14605.35 mgc: 4.029988e-07 ustep: 1 
iter: 3  mgc: 1.008305e-12 
iter: 1  mgc: 1.008305e-12 
outer mgc:  0.006059246 
iter: 1  value: 14588.03 mgc: 2.284832 ustep: 1 
iter: 2  value: 14588.03 mgc: 9.779205e-08 ustep: 1 
iter: 3  mgc: 8.877343e-13 
iter: 1  mgc: 8.877343e-13 
outer mgc:  0.008031422 
iter: 1  value: 14567.13 mgc: 2.831059 ustep: 1 
iter: 2  value: 14567.13 mgc: 4.362917e-08 ustep: 1 
mgc: 2.948142e-12 
iter: 1  mgc: 2.948142e-12 
outer mgc:  0.006307732 
iter: 1  value: 14549.84 mgc: 2.237028 ustep: 1 
iter: 2  value: 14549.84 mgc: 1.199094e-08 ustep: 1 
mgc: 3.100076e-12 
iter: 1  mgc: 3.100076e-12 
outer mgc:  0.003476423 
iter: 1  value: 14528.87 mgc: 2.816898 ustep: 1 
iter: 2  mgc: 7.967998e-09 
iter: 1  mgc: 7.967998e-09 
outer mgc:  0.001248679 
iter: 1  value: 14511.55 mgc: 2.257524 ustep: 1 
iter: 2  mgc: 3.035992e-09 
iter: 1  mgc: 3.035992e-09 
outer mgc:  0.0006009984 
iter: 1  value: 14490.58 mgc: 2.854794 ustep: 1 
iter: 2  mgc: 2.186945e-09 
iter: 1  mgc: 2.186945e-09 
outer mgc:  0.0005328268 
iter: 1  value: 14473.26 mgc: 2.275523 ustep: 1 
iter: 2  mgc: 7.691074e-10 
iter: 1  mgc: 7.691074e-10 
outer mgc:  0.0005328704 
iter: 1  value: 14452.29 mgc: 2.851691 ustep: 1 
iter: 2  mgc: 4.513692e-10 
iter: 1  mgc: 4.513692e-10 
outer mgc:  0.0004685094 
iter: 1  value: 14434.97 mgc: 2.258123 ustep: 1 
iter: 2  mgc: 1.617764e-10 
iter: 1  mgc: 1.617764e-10 
outer mgc:  0.0003210923 
iter: 1  value: 14413.99 mgc: 2.831031 ustep: 1 
iter: 2  mgc: 1.285114e-10 
iter: 1  mgc: 1.285114e-10 
outer mgc:  0.0001696513 
iter: 1  value: 14396.67 mgc: 2.25652 ustep: 1 
iter: 2  mgc: 7.074452e-11 
iter: 1  mgc: 7.074452e-11 
outer mgc:  9.767252e-05 
iter: 1  mgc: 7.074452e-11 
iter: 1  mgc: 7.074452e-11 
outer mgc:  9.767252e-05 
iter: 1  value: 14396.67 mgc: 0.006276827 ustep: 1 
iter: 2  value: 14396.67 mgc: 2.249611e-07 ustep: 1 
iter: 3  mgc: 5.077033e-11 
outer mgc:  0.3364425 
iter: 1  value: 14396.67 mgc: 0.006277532 ustep: 1 
iter: 2  value: 14396.67 mgc: 2.251759e-07 ustep: 1 
iter: 3  mgc: 5.525846e-11 
outer mgc:  0.3364454 
iter: 1  value: 14396.67 mgc: 0.002839574 ustep: 1 
iter: 2  value: 14396.67 mgc: 6.308211e-08 ustep: 1 
iter: 3  mgc: 7.678658e-11 
outer mgc:  0.1702946 
iter: 1  value: 14396.66 mgc: 0.002840943 ustep: 1 
iter: 2  value: 14396.66 mgc: 6.314705e-08 ustep: 1 
iter: 3  mgc: 7.733689e-11 
outer mgc:  0.1704181 
iter: 1  value: 14396.68 mgc: 0.005275863 ustep: 1 
iter: 2  value: 14396.68 mgc: 1.40299e-08 ustep: 1 
iter: 3  mgc: 5.649925e-11 
outer mgc:  0.411277 
iter: 1  value: 14396.66 mgc: 0.005273722 ustep: 1 
iter: 2  value: 14396.66 mgc: 1.399979e-08 ustep: 1 
iter: 3  mgc: 5.452655e-11 
outer mgc:  0.4110757 
iter: 1  value: 14396.67 mgc: 0.002421412 ustep: 1 
iter: 2  mgc: 9.442999e-09 
outer mgc:  0.1295554 
iter: 1  value: 14396.66 mgc: 0.002419908 ustep: 1 
iter: 2  mgc: 9.430465e-09 
outer mgc:  0.1294161 
iter: 1  value: 14396.72 mgc: 249.4797 ustep: 1 
iter: 2  value: 14396.72 mgc: 6.251592e-07 ustep: 1 
iter: 3  mgc: 7.68729e-11 
outer mgc:  0.06306886 
iter: 1  value: 14396.61 mgc: 249.7293 ustep: 1 
iter: 2  value: 14396.61 mgc: 6.25964e-07 ustep: 1 
iter: 3  mgc: 5.215828e-11 
outer mgc:  0.06270232 
iter: 1  value: 14396.77 mgc: 249.2245 ustep: 1 
iter: 2  value: 14396.77 mgc: 5.160367e-07 ustep: 1 
iter: 3  mgc: 9.084516e-11 
outer mgc:  0.02748316 
iter: 1  value: 14396.57 mgc: 249.9733 ustep: 1 
iter: 2  value: 14396.57 mgc: 5.156144e-07 ustep: 1 
iter: 3  mgc: 4.904666e-11 
outer mgc:  0.02747989 
iter: 1  value: 14396.67 mgc: 4.69185e-05 ustep: 1 
mgc: 6.126788e-11 
outer mgc:  9.767035e-05 
iter: 1  value: 14396.67 mgc: 4.691837e-05 ustep: 1 
mgc: 3.884604e-11 
outer mgc:  9.767499e-05 
iter: 1  value: 14396.65 mgc: 0.003798152 ustep: 1 
iter: 2  value: 14396.65 mgc: 9.507287e-08 ustep: 1 
iter: 3  mgc: 9.840884e-11 
outer mgc:  0.13907 
iter: 1  value: 14396.68 mgc: 0.003795375 ustep: 1 
iter: 2  value: 14396.68 mgc: 9.48243e-08 ustep: 1 
iter: 3  mgc: 6.424243e-11 
outer mgc:  0.1392402 
[Sun Aug 15 23:53:43 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:05:40 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21801.960869 
final  value 20444.167479 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2159.152 mgc: 103.5224 ustep: 1 
iter: 2  value: 1695.829 mgc: 49.27535 ustep: 1 
iter: 3  value: 1645.995 mgc: 44.34894 ustep: 1 
iter: 4  value: 1645.723 mgc: 3.264184 ustep: 1 
iter: 5  value: 1645.723 mgc: 0.08595766 ustep: 1 
iter: 6  value: 1645.723 mgc: 5.390649e-05 ustep: 1 
iter: 7  mgc: 2.125744e-11 
iter: 1  mgc: 2.125744e-11 
Matching hessian patterns... Done
outer mgc:  560.3366 
iter: 1  value: 1809.062 mgc: 38.75561 ustep: 1 
iter: 2  value: 1795.537 mgc: 5.902478 ustep: 1 
iter: 3  value: 1795.532 mgc: 0.1731791 ustep: 1 
iter: 4  value: 1795.532 mgc: 0.000194246 ustep: 1 
iter: 5  mgc: 4.823103e-10 
iter: 1  value: 1526.324 mgc: 16.72634 ustep: 1 
iter: 2  value: 1526.053 mgc: 0.866396 ustep: 1 
iter: 3  value: 1526.053 mgc: 0.004387538 ustep: 1 
iter: 4  value: 1526.053 mgc: 1.520575e-07 ustep: 1 
mgc: 4.42979e-14 
iter: 1  mgc: 4.42979e-14 
outer mgc:  185.0273 
iter: 1  value: 1479.639 mgc: 3.75984 ustep: 1 
iter: 2  value: 1479.628 mgc: 0.1479338 ustep: 1 
iter: 3  value: 1479.628 mgc: 0.0001105944 ustep: 1 
iter: 4  mgc: 2.622444e-10 
iter: 1  mgc: 2.622444e-10 
outer mgc:  190.0833 
iter: 1  value: 1476.769 mgc: 20.52276 ustep: 1 
iter: 2  value: 1475.387 mgc: 1.662339 ustep: 1 
iter: 3  value: 1475.387 mgc: 0.01575816 ustep: 1 
iter: 4  value: 1475.387 mgc: 2.670932e-06 ustep: 1 
iter: 5  mgc: 1.09468e-13 
iter: 1  mgc: 1.09468e-13 
outer mgc:  265.4563 
iter: 1  value: 1430.825 mgc: 5.354851 ustep: 1 
iter: 2  value: 1430.822 mgc: 0.08106985 ustep: 1 
iter: 3  value: 1430.822 mgc: 4.661768e-05 ustep: 1 
iter: 4  mgc: 9.613754e-12 
iter: 1  mgc: 9.613754e-12 
outer mgc:  70.47476 
iter: 1  value: 1385.546 mgc: 12.57637 ustep: 1 
iter: 2  value: 1385.292 mgc: 0.7301384 ustep: 1 
iter: 3  value: 1385.292 mgc: 0.003292248 ustep: 1 
iter: 4  value: 1385.292 mgc: 1.355516e-07 ustep: 1 
mgc: 3.191891e-14 
iter: 1  value: 1352.702 mgc: 36.00925 ustep: 1 
iter: 2  value: 1329.293 mgc: 7.440155 ustep: 1 
iter: 3  value: 1329.279 mgc: 0.2667226 ustep: 1 
iter: 4  value: 1329.279 mgc: 0.000634574 ustep: 1 
iter: 5  mgc: 3.619069e-09 
iter: 1  mgc: 3.619069e-09 
outer mgc:  307.1507 
iter: 1  value: 1534.334 mgc: 2120.734 ustep: 1 
iter: 2  value: 1531.423 mgc: 7.803677 ustep: 1 
iter: 3  value: 1531.423 mgc: 0.103026 ustep: 1 
iter: 4  value: 1531.423 mgc: 1.027986e-05 ustep: 1 
iter: 5  mgc: 1.829648e-13 
iter: 1  value: 1386.873 mgc: 19.18357 ustep: 1 
iter: 2  value: 1386.746 mgc: 0.766579 ustep: 1 
iter: 3  value: 1386.746 mgc: 0.002414059 ustep: 1 
iter: 4  value: 1386.746 mgc: 2.545739e-08 ustep: 1 
mgc: 3.497203e-14 
iter: 1  value: 1283.111 mgc: 10.22041 ustep: 1 
iter: 2  value: 1283.071 mgc: 0.352288 ustep: 1 
iter: 3  value: 1283.071 mgc: 0.0006423642 ustep: 1 
iter: 4  mgc: 2.13289e-09 
iter: 1  mgc: 2.13289e-09 
outer mgc:  194.3877 
iter: 1  value: 1249.08 mgc: 21.27252 ustep: 1 
iter: 2  value: 1248.577 mgc: 0.8410024 ustep: 1 
iter: 3  value: 1248.577 mgc: 0.003343799 ustep: 1 
iter: 4  value: 1248.577 mgc: 5.856932e-08 ustep: 1 
iter: 5  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  128.5329 
iter: 1  value: 1230.788 mgc: 13.84115 ustep: 1 
iter: 2  value: 1230.776 mgc: 0.3766502 ustep: 1 
iter: 3  value: 1230.776 mgc: 0.0002835386 ustep: 1 
iter: 4  mgc: 2.345522e-09 
iter: 1  mgc: 2.345522e-09 
outer mgc:  64.46519 
iter: 1  value: 1233.944 mgc: 14.22474 ustep: 1 
iter: 2  value: 1233.934 mgc: 0.3267077 ustep: 1 
iter: 3  value: 1233.934 mgc: 0.0002369711 ustep: 1 
iter: 4  mgc: 9.448575e-11 
iter: 1  value: 1225.838 mgc: 7.369186 ustep: 1 
iter: 2  value: 1225.836 mgc: 0.08403217 ustep: 1 
iter: 3  value: 1225.836 mgc: 1.93422e-05 ustep: 1 
iter: 4  mgc: 1.032952e-12 
iter: 1  mgc: 1.032952e-12 
outer mgc:  53.42793 
iter: 1  value: 1226.666 mgc: 5.850107 ustep: 1 
iter: 2  value: 1226.665 mgc: 0.05619735 ustep: 1 
iter: 3  value: 1226.665 mgc: 1.376697e-05 ustep: 1 
iter: 4  mgc: 1.028511e-12 
iter: 1  value: 1225.045 mgc: 3.849627 ustep: 1 
iter: 2  value: 1225.045 mgc: 0.0279929 ustep: 1 
iter: 3  value: 1225.045 mgc: 2.962514e-06 ustep: 1 
iter: 4  mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  38.34449 
iter: 1  value: 1224.257 mgc: 1.113781 ustep: 1 
iter: 2  value: 1224.257 mgc: 0.004725619 ustep: 1 
iter: 3  value: 1224.257 mgc: 1.10111e-07 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  9.425462 
iter: 1  value: 1223.583 mgc: 0.321526 ustep: 1 
iter: 2  value: 1223.583 mgc: 0.0005016764 ustep: 1 
iter: 3  mgc: 3.970669e-09 
iter: 1  mgc: 3.970669e-09 
outer mgc:  15.81632 
iter: 1  value: 1222.732 mgc: 0.7286022 ustep: 1 
iter: 2  value: 1222.732 mgc: 0.001086451 ustep: 1 
iter: 3  mgc: 6.365557e-09 
iter: 1  mgc: 6.365557e-09 
outer mgc:  12.83065 
iter: 1  value: 1222.52 mgc: 1.511912 ustep: 1 
iter: 2  value: 1222.52 mgc: 0.005252628 ustep: 1 
iter: 3  value: 1222.52 mgc: 9.21919e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  21.52984 
iter: 1  value: 1221.409 mgc: 1.678215 ustep: 1 
iter: 2  value: 1221.409 mgc: 0.00468401 ustep: 1 
iter: 3  value: 1221.409 mgc: 6.17103e-08 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  5.903882 
iter: 1  value: 1221.015 mgc: 0.9796732 ustep: 1 
iter: 2  value: 1221.015 mgc: 0.003134319 ustep: 1 
iter: 3  value: 1221.015 mgc: 1.215973e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  10.01273 
iter: 1  value: 1220.669 mgc: 0.7022364 ustep: 1 
iter: 2  value: 1220.669 mgc: 0.0008040542 ustep: 1 
iter: 3  mgc: 9.049046e-09 
iter: 1  mgc: 9.049046e-09 
outer mgc:  10.67767 
iter: 1  value: 1220.436 mgc: 1.454289 ustep: 1 
iter: 2  value: 1220.436 mgc: 0.003182203 ustep: 1 
iter: 3  value: 1220.436 mgc: 7.842949e-08 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  17.90047 
iter: 1  value: 1219.904 mgc: 1.537366 ustep: 1 
iter: 2  value: 1219.904 mgc: 0.01020992 ustep: 1 
iter: 3  value: 1219.904 mgc: 4.374991e-07 ustep: 1 
iter: 4  mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  13.05534 
iter: 1  value: 1218.723 mgc: 0.7862523 ustep: 1 
iter: 2  value: 1218.723 mgc: 0.006883763 ustep: 1 
iter: 3  value: 1218.723 mgc: 1.330694e-07 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  6.058984 
iter: 1  value: 1221.285 mgc: 2.658816 ustep: 1 
iter: 2  value: 1221.284 mgc: 0.01387925 ustep: 1 
iter: 3  value: 1221.284 mgc: 5.116346e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  value: 1218.787 mgc: 0.2902137 ustep: 1 
iter: 2  value: 1218.787 mgc: 0.0001573545 ustep: 1 
iter: 3  mgc: 6.558221e-11 
iter: 1  mgc: 6.558221e-11 
outer mgc:  6.049798 
iter: 1  value: 1218.814 mgc: 0.2975655 ustep: 1 
iter: 2  value: 1218.814 mgc: 0.0001320682 ustep: 1 
iter: 3  mgc: 5.611778e-11 
iter: 1  mgc: 5.611778e-11 
outer mgc:  4.940078 
iter: 1  value: 1218.985 mgc: 0.3429578 ustep: 1 
iter: 2  value: 1218.985 mgc: 0.0002703593 ustep: 1 
iter: 3  mgc: 1.532707e-10 
iter: 1  mgc: 1.532707e-10 
outer mgc:  4.329991 
iter: 1  value: 1218.81 mgc: 0.2846864 ustep: 1 
iter: 2  value: 1218.81 mgc: 0.0001351877 ustep: 1 
iter: 3  mgc: 2.816032e-10 
iter: 1  mgc: 2.816032e-10 
outer mgc:  5.613264 
iter: 1  value: 1218.441 mgc: 0.3915606 ustep: 1 
iter: 2  value: 1218.441 mgc: 0.0001216074 ustep: 1 
iter: 3  mgc: 7.887824e-11 
iter: 1  mgc: 7.887824e-11 
outer mgc:  2.900841 
iter: 1  value: 1218.56 mgc: 0.2538634 ustep: 1 
iter: 2  value: 1218.56 mgc: 0.0002864965 ustep: 1 
iter: 3  mgc: 4.150214e-10 
iter: 1  mgc: 4.150214e-10 
outer mgc:  3.450245 
iter: 1  value: 1218.366 mgc: 0.3850377 ustep: 1 
iter: 2  value: 1218.366 mgc: 0.0004316766 ustep: 1 
iter: 3  mgc: 6.087157e-10 
iter: 1  mgc: 6.087157e-10 
outer mgc:  4.913577 
iter: 1  value: 1218.131 mgc: 0.4029892 ustep: 1 
iter: 2  value: 1218.131 mgc: 0.0002119371 ustep: 1 
iter: 3  mgc: 5.054588e-10 
iter: 1  mgc: 5.054588e-10 
outer mgc:  2.693813 
iter: 1  value: 1217.892 mgc: 0.1859987 ustep: 1 
iter: 2  value: 1217.892 mgc: 0.0001090743 ustep: 1 
iter: 3  mgc: 3.815614e-11 
iter: 1  value: 1217.597 mgc: 0.2167454 ustep: 1 
iter: 2  value: 1217.597 mgc: 7.016147e-05 ustep: 1 
iter: 3  mgc: 9.309886e-12 
iter: 1  mgc: 9.309886e-12 
outer mgc:  1.604713 
iter: 1  value: 1217.612 mgc: 0.5947505 ustep: 1 
iter: 2  value: 1217.612 mgc: 0.000600541 ustep: 1 
iter: 3  mgc: 1.033349e-09 
iter: 1  mgc: 1.033349e-09 
outer mgc:  6.790657 
iter: 1  value: 1217.16 mgc: 0.4953253 ustep: 1 
iter: 2  value: 1217.16 mgc: 0.0008211076 ustep: 1 
iter: 3  mgc: 2.843576e-09 
iter: 1  mgc: 2.843576e-09 
outer mgc:  9.200598 
iter: 1  value: 1218.395 mgc: 1.412373 ustep: 1 
iter: 2  value: 1218.395 mgc: 0.003392743 ustep: 1 
iter: 3  value: 1218.395 mgc: 3.537784e-07 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  value: 1217.413 mgc: 0.2590937 ustep: 1 
iter: 2  value: 1217.413 mgc: 0.0001889009 ustep: 1 
iter: 3  mgc: 1.124976e-09 
iter: 1  mgc: 1.124976e-09 
outer mgc:  3.247165 
iter: 1  value: 1217.196 mgc: 0.2728817 ustep: 1 
iter: 2  value: 1217.196 mgc: 0.0002237596 ustep: 1 
iter: 3  mgc: 2.393872e-10 
iter: 1  mgc: 2.393872e-10 
outer mgc:  4.057745 
iter: 1  value: 1217.082 mgc: 0.2126305 ustep: 1 
iter: 2  value: 1217.082 mgc: 3.84171e-05 ustep: 1 
iter: 3  mgc: 7.127632e-12 
iter: 1  mgc: 7.127632e-12 
outer mgc:  1.211956 
iter: 1  value: 1217.102 mgc: 0.1958864 ustep: 1 
iter: 2  value: 1217.102 mgc: 0.0001332806 ustep: 1 
iter: 3  mgc: 2.839249e-10 
iter: 1  value: 1217.089 mgc: 0.1029289 ustep: 1 
iter: 2  value: 1217.089 mgc: 2.764066e-05 ustep: 1 
iter: 3  mgc: 1.442935e-11 
iter: 1  mgc: 1.442935e-11 
outer mgc:  0.6847796 
iter: 1  value: 1217.051 mgc: 0.06440134 ustep: 1 
iter: 2  value: 1217.051 mgc: 2.465074e-05 ustep: 1 
iter: 3  mgc: 3.648637e-12 
iter: 1  mgc: 3.648637e-12 
outer mgc:  0.4478656 
iter: 1  value: 1217.048 mgc: 0.02153923 ustep: 1 
iter: 2  value: 1217.048 mgc: 1.853967e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  0.0342443 
iter: 1  value: 1217.046 mgc: 0.002475362 ustep: 1 
iter: 2  mgc: 9.951431e-09 
iter: 1  mgc: 9.951431e-09 
outer mgc:  0.004453511 
iter: 1  value: 1217.047 mgc: 0.0003551155 ustep: 1 
iter: 2  mgc: 2.810987e-10 
iter: 1  mgc: 2.810987e-10 
outer mgc:  0.0008632296 
iter: 1  mgc: 2.810987e-10 
iter: 1  mgc: 2.810987e-10 
outer mgc:  0.0008632296 
iter: 1  value: 1217.044 mgc: 0.04996614 ustep: 1 
iter: 2  value: 1217.044 mgc: 5.676581e-06 ustep: 1 
iter: 3  mgc: 1.314504e-13 
outer mgc:  1.107375 
iter: 1  value: 1217.051 mgc: 0.04994832 ustep: 1 
iter: 2  value: 1217.051 mgc: 5.678863e-06 ustep: 1 
iter: 3  mgc: 1.283418e-13 
outer mgc:  1.106186 
iter: 1  value: 1217.046 mgc: 0.02833067 ustep: 1 
iter: 2  value: 1217.046 mgc: 1.948821e-06 ustep: 1 
iter: 3  mgc: 3.441691e-14 
outer mgc:  1.242553 
iter: 1  value: 1217.049 mgc: 0.02832078 ustep: 1 
iter: 2  value: 1217.049 mgc: 1.949138e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  1.240638 
iter: 1  value: 1217.053 mgc: 0.05716087 ustep: 1 
iter: 2  value: 1217.053 mgc: 4.738369e-06 ustep: 1 
iter: 3  mgc: 7.81597e-14 
outer mgc:  1.303509 
iter: 1  value: 1217.042 mgc: 0.05716201 ustep: 1 
iter: 2  value: 1217.042 mgc: 4.747412e-06 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  1.304586 
iter: 1  value: 1217.051 mgc: 0.03216911 ustep: 1 
iter: 2  value: 1217.051 mgc: 1.545878e-06 ustep: 1 
iter: 3  mgc: 3.619327e-14 
outer mgc:  1.546822 
iter: 1  value: 1217.044 mgc: 0.03217072 ustep: 1 
iter: 2  value: 1217.044 mgc: 1.54734e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  1.548583 
iter: 1  value: 1217.034 mgc: 0.00647724 ustep: 1 
iter: 2  value: 1217.034 mgc: 1.442088e-07 ustep: 1 
mgc: 2.867151e-14 
outer mgc:  0.01538437 
iter: 1  value: 1217.059 mgc: 0.006474575 ustep: 1 
iter: 2  value: 1217.059 mgc: 1.442436e-07 ustep: 1 
mgc: 4.440892e-14 
outer mgc:  0.01609854 
iter: 1  value: 1217.07 mgc: 0.02348882 ustep: 1 
iter: 2  value: 1217.07 mgc: 2.535354e-06 ustep: 1 
iter: 3  mgc: 4.019007e-14 
outer mgc:  0.4640375 
iter: 1  value: 1217.023 mgc: 0.02354447 ustep: 1 
iter: 2  value: 1217.023 mgc: 2.541811e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.4645462 
iter: 1  value: 1217.067 mgc: 0.03148322 ustep: 1 
iter: 2  value: 1217.067 mgc: 1.589319e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.4713447 
iter: 1  value: 1217.026 mgc: 0.03156273 ustep: 1 
iter: 2  value: 1217.026 mgc: 1.594514e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.4711359 
[Sun Aug 15 22:05:42 2021]
Finished job 0.
1 of 1 steps (100%) done

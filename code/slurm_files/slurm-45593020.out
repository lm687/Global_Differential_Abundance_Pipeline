Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:04:24 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22007.401367 
final  value 18504.305556 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17520.96 mgc: 6.064803 ustep: 0.6115688 
iter: 2  value: 17443.72 mgc: 5.534017 ustep: 0.7820505 
iter: 3  value: 17430.75 mgc: 5.360597 ustep: 0.5092123 
iter: 4  value: 17416.68 mgc: 5.934546 ustep: 0.7136198 
iter: 5  value: 17408.17 mgc: 4.087631 ustep: 0.6059543 
iter: 6  value: 17407.18 mgc: 4.394588 ustep: 0.7784528 
iter: 7  value: 17403.74 mgc: 4.293729 ustep: 0.4141913 
iter: 8  value: 17401.98 mgc: 2.98313 ustep: 0.6436126 
iter: 9  value: 17401.92 mgc: 0.5415402 ustep: 0.8022745 
iter: 10  value: 17401.91 mgc: 0.07681854 ustep: 0.8957082 
iter: 11  value: 17401.91 mgc: 0.006539863 ustep: 0.946424 
iter: 12  value: 17401.91 mgc: 0.0003368317 ustep: 0.972846 
iter: 13  value: 17401.91 mgc: 9.938791e-06 ustep: 0.9863309 
iter: 14  value: 17401.91 mgc: 1.54083e-07 ustep: 0.9931426 
iter: 15  mgc: 1.211468e-09 
iter: 1  mgc: 1.211468e-09 
Matching hessian patterns... Done
outer mgc:  72.87811 
iter: 1  value: 17263.3 mgc: 2.233353 ustep: 1 
iter: 2  value: 17261.81 mgc: 0.6462408 ustep: 1 
iter: 3  value: 17261.81 mgc: 0.02493765 ustep: 1 
iter: 4  value: 17261.81 mgc: 4.372958e-05 ustep: 1 
iter: 5  mgc: 1.355245e-10 
iter: 1  value: 16988.15 mgc: 50.21626 ustep: 1 
iter: 2  value: 16986.39 mgc: 1.100948 ustep: 1 
iter: 3  value: 16986.38 mgc: 0.03941128 ustep: 1 
iter: 4  value: 16986.38 mgc: 2.219425e-05 ustep: 1 
iter: 5  mgc: 6.909695e-12 
iter: 1  mgc: 6.909695e-12 
outer mgc:  138.104 
iter: 1  value: 17686.17 mgc: 54.35132 ustep: 1 
iter: 2  value: 17686.16 mgc: 0.5424983 ustep: 1 
iter: 3  value: 17686.16 mgc: 0.0002369879 ustep: 1 
iter: 4  mgc: 4.828316e-11 
iter: 1  value: 16849.26 mgc: 2.781155 ustep: 1 
iter: 2  value: 16849.26 mgc: 0.02380173 ustep: 1 
iter: 3  value: 16849.26 mgc: 1.18508e-05 ustep: 1 
iter: 4  mgc: 3.162692e-12 
iter: 1  mgc: 3.162692e-12 
outer mgc:  61.62094 
iter: 1  value: 16791.1 mgc: 2.632696 ustep: 1 
iter: 2  value: 16791.1 mgc: 0.04508805 ustep: 1 
iter: 3  value: 16791.1 mgc: 2.609415e-06 ustep: 1 
iter: 4  mgc: 5.195844e-14 
iter: 1  mgc: 5.195844e-14 
outer mgc:  64.25698 
iter: 1  value: 16778.47 mgc: 4.370184 ustep: 1 
iter: 2  value: 16778.47 mgc: 0.0700375 ustep: 1 
iter: 3  value: 16778.47 mgc: 2.552284e-05 ustep: 1 
iter: 4  mgc: 2.229994e-12 
iter: 1  value: 16769.36 mgc: 2.188075 ustep: 1 
iter: 2  value: 16769.36 mgc: 0.01046681 ustep: 1 
iter: 3  value: 16769.36 mgc: 4.020435e-07 ustep: 1 
iter: 4  mgc: 3.774758e-15 
iter: 1  mgc: 3.774758e-15 
outer mgc:  61.33609 
iter: 1  value: 16743.51 mgc: 2.478691 ustep: 1 
iter: 2  value: 16743.51 mgc: 0.01695365 ustep: 1 
iter: 3  value: 16743.51 mgc: 1.965981e-06 ustep: 1 
iter: 4  mgc: 1.887379e-14 
iter: 1  mgc: 1.887379e-14 
outer mgc:  58.01888 
iter: 1  value: 16688.88 mgc: 4.504693 ustep: 1 
iter: 2  value: 16688.88 mgc: 0.01628067 ustep: 1 
iter: 3  value: 16688.88 mgc: 3.841548e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  73.50038 
iter: 1  value: 16675.58 mgc: 3.779797 ustep: 1 
iter: 2  value: 16675.58 mgc: 0.009079237 ustep: 1 
iter: 3  value: 16675.58 mgc: 1.864286e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  52.94395 
iter: 1  value: 16706.84 mgc: 3.023808 ustep: 1 
iter: 2  value: 16706.84 mgc: 0.04038136 ustep: 1 
iter: 3  value: 16706.84 mgc: 7.966514e-06 ustep: 1 
iter: 4  mgc: 2.153833e-13 
iter: 1  value: 16668.9 mgc: 0.9567757 ustep: 1 
iter: 2  value: 16668.9 mgc: 0.002229966 ustep: 1 
iter: 3  mgc: 1.927251e-09 
iter: 1  mgc: 1.927251e-09 
outer mgc:  17.5395 
iter: 1  value: 16666.16 mgc: 0.8132317 ustep: 1 
iter: 2  value: 16666.16 mgc: 0.001207835 ustep: 1 
iter: 3  mgc: 3.422912e-09 
iter: 1  mgc: 3.422912e-09 
outer mgc:  14.57949 
iter: 1  value: 16673.91 mgc: 0.8116114 ustep: 1 
iter: 2  value: 16673.91 mgc: 0.001262252 ustep: 1 
iter: 3  mgc: 2.762624e-09 
iter: 1  mgc: 2.762624e-09 
outer mgc:  8.496069 
iter: 1  value: 16686.76 mgc: 1.574754 ustep: 1 
iter: 2  value: 16686.76 mgc: 0.001144429 ustep: 1 
iter: 3  mgc: 4.512893e-09 
iter: 1  mgc: 4.512893e-09 
outer mgc:  3.255897 
iter: 1  value: 16697.79 mgc: 1.490899 ustep: 1 
iter: 2  value: 16697.79 mgc: 0.001643388 ustep: 1 
iter: 3  value: 16697.79 mgc: 1.007463e-08 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  6.058952 
iter: 1  value: 16708.99 mgc: 2.000569 ustep: 1 
iter: 2  value: 16708.99 mgc: 0.004050506 ustep: 1 
iter: 3  value: 16708.99 mgc: 2.763823e-08 ustep: 1 
mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  9.382021 
iter: 1  value: 16719.18 mgc: 1.624489 ustep: 1 
iter: 2  value: 16719.18 mgc: 0.004100955 ustep: 1 
iter: 3  value: 16719.18 mgc: 2.659835e-08 ustep: 1 
mgc: 6.671746e-15 
iter: 1  mgc: 6.671746e-15 
outer mgc:  6.369858 
iter: 1  value: 16721.91 mgc: 1.748588 ustep: 1 
iter: 2  value: 16721.91 mgc: 0.006530555 ustep: 1 
iter: 3  value: 16721.91 mgc: 6.198926e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  value: 16720.19 mgc: 0.8074738 ustep: 1 
iter: 2  value: 16720.19 mgc: 0.001221653 ustep: 1 
iter: 3  mgc: 1.972618e-09 
iter: 1  mgc: 1.972618e-09 
outer mgc:  1.497001 
iter: 1  value: 16716.45 mgc: 0.3918814 ustep: 1 
iter: 2  value: 16716.45 mgc: 0.000207412 ustep: 1 
iter: 3  mgc: 1.520792e-10 
iter: 1  value: 16719.37 mgc: 0.1074189 ustep: 1 
iter: 2  value: 16719.37 mgc: 1.708436e-05 ustep: 1 
iter: 3  mgc: 7.611689e-13 
iter: 1  mgc: 7.611689e-13 
outer mgc:  2.077037 
iter: 1  value: 16717.52 mgc: 0.271598 ustep: 1 
iter: 2  value: 16717.52 mgc: 7.096551e-05 ustep: 1 
iter: 3  mgc: 6.642464e-12 
iter: 1  mgc: 6.642464e-12 
outer mgc:  2.214747 
iter: 1  value: 16715.64 mgc: 0.2547405 ustep: 1 
iter: 2  value: 16715.64 mgc: 6.898467e-05 ustep: 1 
iter: 3  mgc: 5.401457e-12 
iter: 1  mgc: 5.401457e-12 
outer mgc:  0.3883685 
iter: 1  value: 16714.11 mgc: 0.1476561 ustep: 1 
iter: 2  value: 16714.11 mgc: 1.967049e-05 ustep: 1 
iter: 3  mgc: 5.593304e-13 
iter: 1  value: 16710.28 mgc: 0.3505262 ustep: 1 
iter: 2  value: 16710.28 mgc: 0.0001003308 ustep: 1 
iter: 3  mgc: 1.031308e-11 
iter: 1  value: 16701.91 mgc: 0.8445252 ustep: 1 
iter: 2  value: 16701.91 mgc: 0.0004230207 ustep: 1 
iter: 3  mgc: 1.154947e-10 
iter: 1  mgc: 1.154947e-10 
outer mgc:  1.917817 
iter: 1  value: 16692.27 mgc: 1.212444 ustep: 1 
iter: 2  value: 16692.27 mgc: 0.0003771363 ustep: 1 
iter: 3  mgc: 1.144247e-09 
iter: 1  mgc: 1.144247e-09 
outer mgc:  1.027773 
iter: 1  value: 16687.75 mgc: 1.671421 ustep: 1 
iter: 2  value: 16687.75 mgc: 0.001076604 ustep: 1 
iter: 3  mgc: 8.30501e-10 
iter: 1  mgc: 8.30501e-10 
outer mgc:  1.644019 
iter: 1  value: 16679.21 mgc: 1.03447 ustep: 1 
iter: 2  value: 16679.21 mgc: 0.0002654534 ustep: 1 
iter: 3  mgc: 5.747403e-11 
iter: 1  mgc: 5.747403e-11 
outer mgc:  0.5207002 
iter: 1  value: 16665.1 mgc: 1.570588 ustep: 1 
iter: 2  value: 16665.1 mgc: 0.0007070084 ustep: 1 
iter: 3  mgc: 1.482934e-09 
iter: 1  mgc: 1.482934e-09 
outer mgc:  0.5671154 
iter: 1  value: 16656.83 mgc: 0.9655488 ustep: 1 
iter: 2  value: 16656.83 mgc: 9.716124e-05 ustep: 1 
iter: 3  mgc: 4.967582e-12 
iter: 1  mgc: 4.967582e-12 
outer mgc:  0.4608905 
iter: 1  value: 16649.14 mgc: 0.7840527 ustep: 1 
iter: 2  value: 16649.14 mgc: 4.272341e-05 ustep: 1 
iter: 3  mgc: 1.13598e-12 
iter: 1  mgc: 1.13598e-12 
outer mgc:  0.5049172 
iter: 1  value: 16642.1 mgc: 0.7559332 ustep: 1 
iter: 2  value: 16642.1 mgc: 3.259634e-05 ustep: 1 
iter: 3  mgc: 1.89182e-13 
iter: 1  value: 16631.53 mgc: 1.23201 ustep: 1 
iter: 2  value: 16631.53 mgc: 5.763051e-05 ustep: 1 
iter: 3  mgc: 2.067679e-12 
iter: 1  mgc: 2.067679e-12 
outer mgc:  0.3797156 
iter: 1  value: 16622.44 mgc: 1.304149 ustep: 1 
iter: 2  value: 16622.44 mgc: 2.521103e-05 ustep: 1 
iter: 3  mgc: 6.928236e-12 
iter: 1  mgc: 6.928236e-12 
outer mgc:  0.1988079 
iter: 1  value: 16604.97 mgc: 2.490261 ustep: 1 
iter: 2  value: 16604.97 mgc: 5.278045e-05 ustep: 1 
iter: 3  mgc: 1.850875e-11 
iter: 1  mgc: 1.850875e-11 
outer mgc:  0.06195636 
iter: 1  value: 16590.08 mgc: 1.6145 ustep: 1 
iter: 2  value: 16590.08 mgc: 1.251382e-05 ustep: 1 
iter: 3  mgc: 7.061018e-13 
iter: 1  mgc: 7.061018e-13 
outer mgc:  0.06966604 
iter: 1  value: 16571 mgc: 2.167277 ustep: 1 
iter: 2  value: 16571 mgc: 1.520983e-05 ustep: 1 
iter: 3  mgc: 1.003642e-13 
iter: 1  mgc: 1.003642e-13 
outer mgc:  0.04825643 
iter: 1  value: 16555.02 mgc: 1.742575 ustep: 1 
iter: 2  value: 16555.02 mgc: 5.030412e-06 ustep: 1 
iter: 3  mgc: 6.861178e-14 
iter: 1  mgc: 6.861178e-14 
outer mgc:  0.03130893 
iter: 1  value: 16535.46 mgc: 2.172752 ustep: 1 
iter: 2  value: 16535.46 mgc: 3.525358e-06 ustep: 1 
iter: 3  mgc: 1.637301e-13 
iter: 1  mgc: 1.637301e-13 
outer mgc:  0.02711804 
iter: 1  value: 16519.14 mgc: 1.781529 ustep: 1 
iter: 2  value: 16519.14 mgc: 9.647097e-07 ustep: 1 
iter: 3  mgc: 2.180478e-13 
iter: 1  mgc: 2.180478e-13 
outer mgc:  0.01560266 
iter: 1  value: 16498.88 mgc: 2.296798 ustep: 1 
iter: 2  value: 16498.88 mgc: 6.882935e-07 ustep: 1 
iter: 3  mgc: 3.83471e-13 
iter: 1  mgc: 3.83471e-13 
outer mgc:  0.01417843 
iter: 1  value: 16482.06 mgc: 1.857831 ustep: 1 
iter: 2  value: 16482.06 mgc: 2.373602e-07 ustep: 1 
iter: 3  mgc: 3.503864e-13 
iter: 1  mgc: 3.503864e-13 
outer mgc:  0.007652709 
iter: 1  value: 16461.42 mgc: 2.264517 ustep: 1 
iter: 2  value: 16461.42 mgc: 1.90378e-07 ustep: 1 
iter: 3  mgc: 4.6807e-13 
iter: 1  mgc: 4.6807e-13 
outer mgc:  0.007547213 
iter: 1  value: 16444.33 mgc: 1.837946 ustep: 1 
iter: 2  value: 16444.33 mgc: 5.642447e-08 ustep: 1 
mgc: 1.508349e-12 
iter: 1  mgc: 1.508349e-12 
outer mgc:  0.003517271 
iter: 1  value: 16423.51 mgc: 2.315885 ustep: 1 
iter: 2  value: 16423.51 mgc: 4.490483e-08 ustep: 1 
mgc: 1.274314e-12 
iter: 1  mgc: 1.274314e-12 
outer mgc:  0.003934495 
iter: 1  value: 16406.3 mgc: 1.915823 ustep: 1 
iter: 2  value: 16406.3 mgc: 1.348872e-08 ustep: 1 
mgc: 1.554756e-12 
iter: 1  mgc: 1.554756e-12 
outer mgc:  0.001504636 
iter: 1  value: 16385.4 mgc: 2.29467 ustep: 1 
iter: 2  mgc: 9.436376e-09 
iter: 1  mgc: 9.436376e-09 
outer mgc:  0.002084649 
iter: 1  value: 16368.13 mgc: 1.966705 ustep: 1 
iter: 2  mgc: 3.427899e-09 
iter: 1  mgc: 3.427899e-09 
outer mgc:  0.0006059432 
iter: 1  value: 16347.19 mgc: 2.34948 ustep: 1 
iter: 2  mgc: 2.246662e-09 
iter: 1  mgc: 2.246662e-09 
outer mgc:  0.001122187 
iter: 1  value: 16329.89 mgc: 1.987301 ustep: 1 
iter: 2  mgc: 8.322747e-10 
iter: 1  mgc: 8.322747e-10 
outer mgc:  0.0002139179 
iter: 1  value: 16308.93 mgc: 2.405192 ustep: 1 
iter: 2  mgc: 5.286918e-10 
iter: 1  mgc: 5.286918e-10 
outer mgc:  0.0006124792 
iter: 1  value: 16291.61 mgc: 2.080455 ustep: 1 
iter: 2  mgc: 2.308078e-10 
iter: 1  mgc: 2.308078e-10 
outer mgc:  8.455401e-05 
iter: 1  mgc: 2.308078e-10 
iter: 1  mgc: 2.308078e-10 
outer mgc:  8.455401e-05 
iter: 1  value: 16291.61 mgc: 0.00607042 ustep: 1 
iter: 2  value: 16291.61 mgc: 1.354659e-07 ustep: 1 
iter: 3  mgc: 2.455702e-11 
outer mgc:  0.3179948 
iter: 1  value: 16291.61 mgc: 0.006069938 ustep: 1 
iter: 2  value: 16291.61 mgc: 1.354498e-07 ustep: 1 
iter: 3  mgc: 1.960901e-11 
outer mgc:  0.318064 
iter: 1  value: 16291.6 mgc: 0.00302165 ustep: 1 
iter: 2  value: 16291.6 mgc: 3.968665e-08 ustep: 1 
iter: 3  mgc: 1.821343e-11 
outer mgc:  0.1727994 
iter: 1  value: 16291.61 mgc: 0.003020556 ustep: 1 
iter: 2  value: 16291.61 mgc: 3.964955e-08 ustep: 1 
iter: 3  mgc: 2.050182e-11 
outer mgc:  0.1728453 
iter: 1  value: 16291.61 mgc: 0.005129449 ustep: 1 
iter: 2  mgc: 8.408151e-09 
outer mgc:  0.2945308 
iter: 1  value: 16291.6 mgc: 0.00512633 ustep: 1 
iter: 2  mgc: 8.379401e-09 
outer mgc:  0.2941828 
iter: 1  value: 16291.61 mgc: 0.002723965 ustep: 1 
iter: 2  mgc: 8.979961e-09 
outer mgc:  0.1577949 
iter: 1  value: 16291.61 mgc: 0.00272245 ustep: 1 
iter: 2  mgc: 8.956623e-09 
outer mgc:  0.1575934 
iter: 1  value: 16291.67 mgc: 71.52739 ustep: 1 
iter: 2  value: 16291.67 mgc: 3.734176e-07 ustep: 1 
iter: 3  mgc: 2.239542e-11 
outer mgc:  0.04091927 
iter: 1  value: 16291.55 mgc: 71.59896 ustep: 1 
iter: 2  value: 16291.55 mgc: 3.730108e-07 ustep: 1 
iter: 3  mgc: 3.187095e-11 
outer mgc:  0.04063552 
iter: 1  value: 16291.71 mgc: 71.45714 ustep: 1 
iter: 2  value: 16291.71 mgc: 2.819846e-07 ustep: 1 
iter: 3  mgc: 1.491429e-11 
outer mgc:  0.0115697 
iter: 1  value: 16291.51 mgc: 71.67183 ustep: 1 
iter: 2  value: 16291.51 mgc: 2.811102e-07 ustep: 1 
iter: 3  mgc: 2.210476e-11 
outer mgc:  0.0116774 
iter: 1  value: 16291.61 mgc: 7.829423e-05 ustep: 1 
mgc: 1.613998e-11 
outer mgc:  8.455033e-05 
iter: 1  value: 16291.61 mgc: 7.829386e-05 ustep: 1 
mgc: 1.875025e-11 
outer mgc:  8.455829e-05 
iter: 1  value: 16291.59 mgc: 0.00443653 ustep: 1 
iter: 2  value: 16291.59 mgc: 6.537233e-08 ustep: 1 
iter: 3  mgc: 1.768474e-11 
outer mgc:  0.151489 
iter: 1  value: 16291.62 mgc: 0.004433267 ustep: 1 
iter: 2  value: 16291.62 mgc: 6.528174e-08 ustep: 1 
iter: 3  mgc: 1.899525e-11 
outer mgc:  0.1515711 
[Mon Aug 16 08:04:29 2021]
Finished job 0.
1 of 1 steps (100%) done

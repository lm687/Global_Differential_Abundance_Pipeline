Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 21:46:45 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_4_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_4_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_4_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4392.251930 
iter  10 value 2266.703983
final  value 2259.146019 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8366.431 mgc: 91.25927 ustep: 0.12958 
iter: 2  value: 7023.637 mgc: 72.64424 ustep: 0.05432697 
iter: 3  value: 6717.093 mgc: 36.66742 ustep: 0.04260371 
iter: 4  value: 6453.358 mgc: 47.87727 ustep: 0.06343458 
iter: 5  value: 6128.323 mgc: 26.51058 ustep: 0.251937 
iter: 6  value: 5894.948 mgc: 20.8855 ustep: 0.2672385 
iter: 7  value: 5657.537 mgc: 51.43353 ustep: 0.0378828 
iter: 8  value: 5537.051 mgc: 36.59352 ustep: 0.1947156 
iter: 9  value: 5391.91 mgc: 32.43551 ustep: 0.05174718 
iter: 10  value: 5350.497 mgc: 38.24849 ustep: 0.2275573 
iter: 11  value: 5281.498 mgc: 44.77079 ustep: 0.477082 
iter: 12  value: 5273.498 mgc: 4.598256 ustep: 0.443846 
iter: 13  value: 5273.246 mgc: 3.632058 ustep: 0.6662511 
iter: 14  value: 5273.245 mgc: 0.1255843 ustep: 0.8162604 
iter: 15  value: 5273.245 mgc: 0.006520792 ustep: 0.903481 
iter: 16  value: 5273.245 mgc: 0.0001450802 ustep: 0.9505211 
iter: 17  value: 5273.245 mgc: 1.588529e-06 ustep: 0.9749492 
iter: 18  mgc: 8.670443e-09 
iter: 1  mgc: 8.670443e-09 
Matching hessian patterns... Done
outer mgc:  513.3612 
iter: 1  value: 4640.084 mgc: 15.62648 ustep: 0.1447185 
iter: 2  value: 4624.694 mgc: 19.83799 ustep: 0.3804808 
iter: 3  value: 4624.327 mgc: 1.878422 ustep: 0.6168696 
iter: 4  value: 4624.324 mgc: 0.067869 ustep: 0.7854319 
iter: 5  value: 4624.324 mgc: 0.001930745 ustep: 0.8862573 
iter: 6  value: 4624.324 mgc: 5.37736e-05 ustep: 0.9414183 
iter: 7  value: 4624.324 mgc: 7.31434e-07 ustep: 0.9702701 
iter: 8  mgc: 4.921355e-09 
iter: 1  value: 3526.558 mgc: 22.65959 ustep: 0.06066134 
iter: 2  value: 3219.207 mgc: 97.5231 ustep: 0.124067 
iter: 3  value: 3097.638 mgc: 46.14772 ustep: 0.03095094 
iter: 4  value: 3029.912 mgc: 14.4485 ustep: 0.1760112 
iter: 5  value: 3018.916 mgc: 3.991356 ustep: 0.4195949 
iter: 6  value: 3018.729 mgc: 1.709248 ustep: 0.6477967 
iter: 7  value: 3018.728 mgc: 0.07127629 ustep: 0.8048777 
iter: 8  value: 3018.728 mgc: 0.002179515 ustep: 0.8971601 
iter: 9  value: 3018.728 mgc: 3.560681e-05 ustep: 0.9471906 
iter: 10  value: 3018.728 mgc: 3.082598e-07 ustep: 0.9732399 
iter: 11  mgc: 1.345352e-09 
iter: 1  value: 2408.127 mgc: 6.37683 ustep: 0.2910325 
iter: 2  value: 2383.284 mgc: 6.299982 ustep: 0.3213813 
iter: 3  value: 2371.131 mgc: 7.429541 ustep: 0.1517487 
iter: 4  value: 2368.634 mgc: 1.351652 ustep: 0.3896105 
iter: 5  value: 2365.925 mgc: 1.492165 ustep: 0.3846968 
iter: 6  value: 2364.964 mgc: 1.537438 ustep: 0.6202773 
iter: 7  value: 2364.904 mgc: 0.6774476 ustep: 0.7875981 
iter: 8  value: 2364.902 mgc: 0.08701198 ustep: 0.8874785 
iter: 9  value: 2364.902 mgc: 0.0040754 ustep: 0.9420666 
iter: 10  value: 2364.902 mgc: 0.0003507751 ustep: 0.9706041 
iter: 11  value: 2364.902 mgc: 1.674692e-05 ustep: 0.9851939 
iter: 12  value: 2364.902 mgc: 4.023221e-07 ustep: 0.9925701 
iter: 13  mgc: 4.869038e-09 
iter: 1  mgc: 4.869038e-09 
outer mgc:  25.83773 
iter: 1  value: 3194.258 mgc: 59.18591 ustep: 0.03838517 
iter: 2  value: 2925.639 mgc: 27.83845 ustep: 0.05418453 
iter: 3  value: 2768.323 mgc: 32.71255 ustep: 0.02814786 
iter: 4  value: 2558.402 mgc: 61.84501 ustep: 0.06853023 
iter: 5  value: 2489.512 mgc: 7.978988 ustep: 0.2618566 
iter: 6  value: 2449.863 mgc: 4.007315 ustep: 0.5117681 
iter: 7  value: 2436.979 mgc: 3.515082 ustep: 0.7154081 
iter: 8  value: 2434.781 mgc: 0.7400778 ustep: 0.8458335 
iter: 9  value: 2434.664 mgc: 0.1466544 ustep: 0.9197001 
iter: 10  value: 2434.662 mgc: 0.01747418 ustep: 0.959014 
iter: 11  value: 2434.662 mgc: 0.001080621 ustep: 0.9792947 
iter: 12  value: 2434.662 mgc: 3.396366e-05 ustep: 0.9895942 
iter: 13  value: 2434.662 mgc: 5.509478e-07 ustep: 0.994784 
iter: 14  mgc: 4.694044e-09 
iter: 1  value: 2337.233 mgc: 68.46587 ustep: 1 
iter: 2  value: 2324.736 mgc: 5.149341 ustep: 1 
iter: 3  value: 2324.049 mgc: 1.06827 ustep: 1 
iter: 4  value: 2324.043 mgc: 0.1078139 ustep: 1 
iter: 5  value: 2324.043 mgc: 0.00300844 ustep: 1 
iter: 6  value: 2324.043 mgc: 3.228284e-06 ustep: 1 
iter: 7  mgc: 3.712058e-12 
iter: 1  mgc: 3.712058e-12 
outer mgc:  16.7161 
iter: 1  value: 2316.347 mgc: 39.23814 ustep: 1 
iter: 2  value: 2288.177 mgc: 9.020622 ustep: 0.5079229 
iter: 3  value: 2279.527 mgc: 3.628303 ustep: 0.7127158 
iter: 4  value: 2279.143 mgc: 0.4769034 ustep: 0.8442406 
iter: 5  value: 2279.124 mgc: 0.1363816 ustep: 0.9188338 
iter: 6  value: 2279.123 mgc: 0.03182921 ustep: 0.9585623 
iter: 7  value: 2279.122 mgc: 0.003861999 ustep: 0.979064 
iter: 8  value: 2279.122 mgc: 0.0001907498 ustep: 0.9894777 
iter: 9  value: 2279.122 mgc: 4.279645e-06 ustep: 0.9947255 
iter: 10  value: 2279.122 mgc: 4.801684e-08 ustep: 0.9973595 
iter: 11  mgc: 2.708054e-10 
iter: 1  mgc: 2.708054e-10 
outer mgc:  10.42548 
iter: 1  value: 2342.924 mgc: 15.66657 ustep: 1 
iter: 2  value: 2336.47 mgc: 3.936077 ustep: 1 
iter: 3  value: 2336.242 mgc: 0.736646 ustep: 1 
iter: 4  value: 2336.241 mgc: 0.05089132 ustep: 1 
iter: 5  value: 2336.241 mgc: 0.0003057093 ustep: 1 
iter: 6  value: 2336.241 mgc: 1.499226e-08 ustep: 1 
iter: 7  mgc: 1.065814e-14 
iter: 1  value: 2262.207 mgc: 2.45041 ustep: 1 
iter: 2  value: 2262.083 mgc: 0.3683068 ustep: 1 
iter: 3  value: 2262.082 mgc: 0.04890742 ustep: 1 
iter: 4  value: 2262.082 mgc: 0.001223359 ustep: 1 
iter: 5  value: 2262.082 mgc: 2.115615e-06 ustep: 1 
iter: 6  mgc: 6.734058e-12 
iter: 1  mgc: 6.734058e-12 
outer mgc:  6.283295 
iter: 1  value: 2246.454 mgc: 1.197881 ustep: 1 
iter: 2  value: 2246.446 mgc: 0.1128932 ustep: 1 
iter: 3  value: 2246.446 mgc: 0.001084735 ustep: 1 
iter: 4  value: 2246.446 mgc: 1.991515e-07 ustep: 1 
iter: 5  mgc: 1.873501e-14 
iter: 1  value: 2240.347 mgc: 5.529968 ustep: 1 
iter: 2  value: 2239.066 mgc: 1.76567 ustep: 1 
iter: 3  value: 2239.065 mgc: 0.08425533 ustep: 1 
iter: 4  value: 2239.065 mgc: 5.79849e-05 ustep: 1 
iter: 5  mgc: 3.36966e-11 
iter: 1  mgc: 1.873501e-14 
outer mgc:  6.27993 
iter: 1  value: 2236.619 mgc: 9.013207 ustep: 1 
iter: 2  value: 2226.196 mgc: 6.070547 ustep: 1 
iter: 3  value: 2220.569 mgc: 6.380775 ustep: 1 
iter: 4  value: 2220.023 mgc: 2.179806 ustep: 1 
iter: 5  value: 2220.012 mgc: 0.3466348 ustep: 1 
iter: 6  value: 2220.012 mgc: 0.002970641 ustep: 1 
iter: 7  value: 2220.012 mgc: 2.42963e-07 ustep: 1 
iter: 8  mgc: 1.179612e-14 
iter: 1  mgc: 1.179612e-14 
outer mgc:  13.00337 
iter: 1  value: 2209.442 mgc: 10.6357 ustep: 1 
iter: 2  value: 2207.365 mgc: 2.176011 ustep: 1 
iter: 3  value: 2207.363 mgc: 0.124144 ustep: 1 
iter: 4  value: 2207.363 mgc: 0.0001708973 ustep: 1 
iter: 5  mgc: 7.964709e-10 
iter: 1  mgc: 7.964709e-10 
outer mgc:  31.85642 
iter: 1  value: 2193.282 mgc: 7.544408 ustep: 1 
iter: 2  value: 2192.989 mgc: 0.8879361 ustep: 1 
iter: 3  value: 2192.989 mgc: 0.0125577 ustep: 1 
iter: 4  value: 2192.989 mgc: 2.050778e-06 ustep: 1 
iter: 5  mgc: 4.313216e-14 
iter: 1  mgc: 4.313216e-14 
outer mgc:  14.61377 
iter: 1  value: 2202.362 mgc: 7.870121 ustep: 1 
iter: 2  value: 2199.908 mgc: 2.743523 ustep: 1 
iter: 3  value: 2199.898 mgc: 0.1854702 ustep: 1 
iter: 4  value: 2199.898 mgc: 0.001327966 ustep: 1 
iter: 5  value: 2199.898 mgc: 8.331516e-08 ustep: 1 
iter: 6  mgc: 7.993606e-15 
iter: 1  value: 2187.415 mgc: 4.873416 ustep: 1 
iter: 2  value: 2186.322 mgc: 1.398461 ustep: 1 
iter: 3  value: 2186.321 mgc: 0.07955288 ustep: 1 
iter: 4  value: 2186.321 mgc: 0.0003403838 ustep: 1 
iter: 5  mgc: 6.345306e-09 
iter: 1  mgc: 6.345306e-09 
outer mgc:  4.740069 
iter: 1  value: 2181.85 mgc: 1.953949 ustep: 1 
iter: 2  value: 2181.85 mgc: 0.02579714 ustep: 1 
iter: 3  value: 2181.85 mgc: 2.181838e-05 ustep: 1 
iter: 4  mgc: 1.492872e-11 
iter: 1  mgc: 1.492872e-11 
outer mgc:  2.716861 
iter: 1  value: 2179.596 mgc: 1.981267 ustep: 1 
iter: 2  value: 2179.596 mgc: 0.04990387 ustep: 1 
iter: 3  value: 2179.596 mgc: 5.023658e-05 ustep: 1 
iter: 4  mgc: 4.811107e-11 
iter: 1  mgc: 4.811107e-11 
outer mgc:  5.633857 
iter: 1  value: 2172.008 mgc: 3.007762 ustep: 1 
iter: 2  value: 2172.008 mgc: 0.04668046 ustep: 1 
iter: 3  value: 2172.008 mgc: 2.054975e-05 ustep: 1 
iter: 4  mgc: 3.920642e-12 
iter: 1  mgc: 3.920642e-12 
outer mgc:  4.053865 
iter: 1  value: 2163.729 mgc: 1.943922 ustep: 1 
iter: 2  value: 2163.729 mgc: 0.01088703 ustep: 1 
iter: 3  value: 2163.729 mgc: 4.447664e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  3.122552 
iter: 1  value: 2162.767 mgc: 1.037076 ustep: 1 
iter: 2  value: 2162.767 mgc: 0.002766863 ustep: 1 
iter: 3  value: 2162.767 mgc: 2.790684e-08 ustep: 1 
mgc: 7.327472e-15 
iter: 1  value: 2163.096 mgc: 0.5151841 ustep: 1 
iter: 2  value: 2163.096 mgc: 0.0004747191 ustep: 1 
iter: 3  mgc: 9.281873e-10 
iter: 1  mgc: 9.281873e-10 
outer mgc:  4.091568 
iter: 1  value: 2162.475 mgc: 0.7803643 ustep: 1 
iter: 2  value: 2162.475 mgc: 0.0006008849 ustep: 1 
iter: 3  mgc: 1.33333e-09 
iter: 1  mgc: 1.33333e-09 
outer mgc:  0.9340603 
iter: 1  value: 2159.06 mgc: 0.7566588 ustep: 1 
iter: 2  value: 2159.06 mgc: 0.001132972 ustep: 1 
iter: 3  mgc: 3.264726e-09 
iter: 1  mgc: 3.264726e-09 
outer mgc:  0.5204076 
iter: 1  value: 2155.65 mgc: 1.009207 ustep: 1 
iter: 2  value: 2155.65 mgc: 0.0007029865 ustep: 1 
iter: 3  mgc: 9.288144e-10 
iter: 1  value: 2148.868 mgc: 2.141579 ustep: 1 
iter: 2  value: 2148.868 mgc: 0.001756257 ustep: 1 
iter: 3  mgc: 3.051457e-09 
iter: 1  mgc: 3.051457e-09 
outer mgc:  0.5815366 
iter: 1  value: 2139.869 mgc: 2.756459 ustep: 1 
iter: 2  value: 2139.869 mgc: 0.001473214 ustep: 1 
iter: 3  mgc: 9.111809e-10 
iter: 1  mgc: 9.111809e-10 
outer mgc:  0.4944105 
iter: 1  value: 2130.673 mgc: 2.780334 ustep: 1 
iter: 2  value: 2130.673 mgc: 0.0006017808 ustep: 1 
iter: 3  mgc: 6.37983e-11 
iter: 1  mgc: 6.37983e-11 
outer mgc:  0.1124267 
iter: 1  value: 2121.358 mgc: 2.788375 ustep: 1 
iter: 2  value: 2121.358 mgc: 0.0002433873 ustep: 1 
iter: 3  mgc: 4.440448e-12 
iter: 1  mgc: 4.440448e-12 
outer mgc:  0.2101698 
iter: 1  value: 2111.974 mgc: 2.790847 ustep: 1 
iter: 2  value: 2111.974 mgc: 0.0001038333 ustep: 1 
iter: 3  mgc: 3.459455e-13 
iter: 1  mgc: 3.459455e-13 
outer mgc:  0.1490861 
iter: 1  value: 2102.549 mgc: 2.791747 ustep: 1 
iter: 2  value: 2102.549 mgc: 4.300605e-05 ustep: 1 
iter: 3  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.06400091 
iter: 1  value: 2093.089 mgc: 2.806118 ustep: 1 
iter: 2  value: 2093.089 mgc: 1.910393e-05 ustep: 1 
iter: 3  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.04359412 
iter: 1  value: 2083.612 mgc: 2.792145 ustep: 1 
iter: 2  value: 2083.612 mgc: 7.879952e-06 ustep: 1 
iter: 3  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.01670694 
iter: 1  value: 2074.119 mgc: 2.802966 ustep: 1 
iter: 2  value: 2074.119 mgc: 3.442768e-06 ustep: 1 
mgc: 5.440093e-15 
iter: 1  mgc: 5.440093e-15 
outer mgc:  0.01332928 
iter: 1  value: 2064.619 mgc: 2.795589 ustep: 1 
iter: 2  value: 2064.619 mgc: 1.449538e-06 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.004151144 
iter: 1  value: 2055.114 mgc: 2.798492 ustep: 1 
iter: 2  value: 2055.114 mgc: 6.188857e-07 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.005177027 
iter: 1  value: 2046.259 mgc: 2.55437 ustep: 1 
iter: 2  value: 2046.259 mgc: 2.349046e-07 ustep: 1 
mgc: 3.915705e-15 
iter: 1  mgc: 3.915705e-15 
outer mgc:  0.003482372 
iter: 1  value: 2038.212 mgc: 2.266355 ustep: 1 
iter: 2  value: 2038.212 mgc: 9.078969e-08 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.001152942 
iter: 1  value: 2031.308 mgc: 1.878859 ustep: 1 
iter: 2  value: 2031.308 mgc: 3.411739e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.0004485074 
iter: 1  value: 2025.857 mgc: 1.421773 ustep: 1 
iter: 2  value: 2025.857 mgc: 1.220163e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  0.0002860418 
iter: 1  value: 2022.187 mgc: 0.9089854 ustep: 1 
iter: 2  mgc: 3.68643e-09 
iter: 1  mgc: 3.68643e-09 
outer mgc:  0.0001884232 
iter: 1  value: 2020.323 mgc: 0.4387732 ustep: 1 
iter: 2  mgc: 7.441381e-10 
iter: 1  mgc: 7.441381e-10 
outer mgc:  0.0001516738 
iter: 1  mgc: 7.441381e-10 
iter: 1  mgc: 7.441381e-10 
outer mgc:  0.0001516738 
iter: 1  value: 2020.323 mgc: 0.004835591 ustep: 1 
iter: 2  mgc: 4.218847e-14 
outer mgc:  0.08078946 
iter: 1  value: 2020.323 mgc: 0.004833132 ustep: 1 
iter: 2  mgc: 3.641532e-14 
outer mgc:  0.0807747 
iter: 1  value: 2020.323 mgc: 0.0001812283 ustep: 1 
iter: 2  mgc: 5.384582e-15 
outer mgc:  0.002994527 
iter: 1  value: 2020.323 mgc: 0.0001810489 ustep: 1 
iter: 2  mgc: 7.993606e-15 
outer mgc:  0.003095373 
iter: 1  value: 2020.323 mgc: 0.005868692 ustep: 1 
iter: 2  mgc: 1.785239e-13 
outer mgc:  0.08510523 
iter: 1  value: 2020.323 mgc: 0.005867257 ustep: 1 
iter: 2  mgc: 1.79412e-13 
outer mgc:  0.08499334 
iter: 1  value: 2020.323 mgc: 0.001160167 ustep: 1 
iter: 2  mgc: 1.199041e-14 
outer mgc:  0.01749036 
iter: 1  value: 2020.323 mgc: 0.001161269 ustep: 1 
iter: 2  mgc: 1.221245e-14 
outer mgc:  0.01736621 
iter: 1  value: 2020.333 mgc: 0.004014504 ustep: 1 
iter: 2  mgc: 9.769963e-15 
outer mgc:  0.0001516739 
iter: 1  value: 2020.313 mgc: 0.00401852 ustep: 1 
iter: 2  mgc: 8.881784e-15 
outer mgc:  0.0001516738 
iter: 1  value: 2020.333 mgc: 0.003618992 ustep: 1 
iter: 2  mgc: 1.079137e-13 
outer mgc:  0.0001518243 
iter: 1  value: 2020.313 mgc: 0.003622614 ustep: 1 
iter: 2  mgc: 1.0969e-13 
outer mgc:  0.0001515235 
iter: 1  value: 2020.323 mgc: 0.003273619 ustep: 1 
iter: 2  mgc: 5.195844e-14 
outer mgc:  0.01423344 
iter: 1  value: 2020.323 mgc: 0.003271604 ustep: 1 
iter: 2  mgc: 5.107026e-14 
outer mgc:  0.01419409 
iter: 1  value: 2020.323 mgc: 0.0006024671 ustep: 1 
iter: 2  mgc: 5.440093e-15 
outer mgc:  0.003481753 
iter: 1  value: 2020.323 mgc: 0.0006020048 ustep: 1 
iter: 2  mgc: 6.217249e-15 
outer mgc:  0.003476286 
[Sat Aug 14 21:46:47 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 08:48:12 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_4_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_4_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_4_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=4, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_4_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_4_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_4_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_4_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_4_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 27499.921242 
iter  10 value 23014.788053
final  value 23014.774815 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 9266.172 mgc: 115.8129 ustep: 1 
iter: 2  value: 9021.465 mgc: 61.7958 ustep: 1 
iter: 3  value: 7776.855 mgc: 134.9868 ustep: 1 
iter: 4  value: 7365.963 mgc: 62.59982 ustep: 0.1336527 
iter: 5  value: 6773.994 mgc: 138.3567 ustep: 0.1075309 
iter: 6  value: 6558.451 mgc: 82.51068 ustep: 0.09457213 
iter: 7  value: 6477.002 mgc: 70.83992 ustep: 0.3075951 
iter: 8  value: 6472.41 mgc: 9.265269 ustep: 0.5546571 
iter: 9  value: 6472.239 mgc: 1.864372 ustep: 0.7447786 
iter: 10  value: 6472.238 mgc: 0.1474505 ustep: 0.8630192 
iter: 11  value: 6472.238 mgc: 0.002869157 ustep: 0.9289954 
iter: 12  value: 6472.238 mgc: 4.150725e-05 ustep: 0.9638477 
iter: 13  value: 6472.238 mgc: 5.951629e-07 ustep: 0.9817593 
iter: 14  mgc: 4.262127e-09 
iter: 1  mgc: 4.262127e-09 
Matching hessian patterns... Done
outer mgc:  2649.718 
iter: 1  value: 4358.832 mgc: 32.98407 ustep: 1 
iter: 2  value: 4352.455 mgc: 5.152075 ustep: 1 
iter: 3  value: 4352.451 mgc: 0.1829996 ustep: 1 
iter: 4  value: 4352.451 mgc: 0.000601657 ustep: 1 
iter: 5  mgc: 7.883709e-09 
iter: 1  value: 3379.521 mgc: 39.9328 ustep: 1 
iter: 2  value: 3361.677 mgc: 5.474873 ustep: 1 
iter: 3  value: 3361.656 mgc: 0.2301194 ustep: 1 
iter: 4  value: 3361.656 mgc: 0.001189381 ustep: 1 
iter: 5  value: 3361.656 mgc: 4.073968e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  271.0216 
iter: 1  value: 2960.371 mgc: 26.4384 ustep: 1 
iter: 2  value: 2953.644 mgc: 2.16837 ustep: 1 
iter: 3  value: 2953.642 mgc: 0.05838026 ustep: 1 
iter: 4  value: 2953.642 mgc: 8.03206e-05 ustep: 1 
iter: 5  mgc: 2.357097e-10 
iter: 1  mgc: 2.357097e-10 
outer mgc:  116.4646 
iter: 1  value: 3651.058 mgc: 59.87628 ustep: 1 
iter: 2  value: 3181.364 mgc: 24.92193 ustep: 1 
iter: 3  value: 3174.102 mgc: 2.784526 ustep: 1 
iter: 4  value: 3174.095 mgc: 0.1287907 ustep: 1 
iter: 5  value: 3174.095 mgc: 0.0003196891 ustep: 1 
iter: 6  mgc: 1.941291e-09 
iter: 1  value: 2900.442 mgc: 16.52723 ustep: 1 
iter: 2  value: 2898.841 mgc: 1.33963 ustep: 1 
iter: 3  value: 2898.841 mgc: 0.01641308 ustep: 1 
iter: 4  value: 2898.841 mgc: 3.714252e-06 ustep: 1 
iter: 5  mgc: 3.718276e-13 
iter: 1  mgc: 3.718276e-13 
outer mgc:  89.78007 
iter: 1  value: 2864.018 mgc: 25.53114 ustep: 1 
iter: 2  value: 2860.871 mgc: 2.107405 ustep: 1 
iter: 3  value: 2860.87 mgc: 0.03649942 ustep: 1 
iter: 4  value: 2860.87 mgc: 2.850671e-05 ustep: 1 
iter: 5  mgc: 2.135311e-11 
iter: 1  mgc: 2.135311e-11 
outer mgc:  145.2682 
iter: 1  value: 2822.956 mgc: 14.61201 ustep: 1 
iter: 2  value: 2821.866 mgc: 1.081653 ustep: 1 
iter: 3  value: 2821.865 mgc: 0.01805789 ustep: 1 
iter: 4  value: 2821.865 mgc: 7.534333e-06 ustep: 1 
iter: 5  mgc: 1.381117e-12 
iter: 1  mgc: 1.381117e-12 
outer mgc:  106.7078 
iter: 1  value: 2809.051 mgc: 3.527327 ustep: 1 
iter: 2  value: 2809.049 mgc: 0.06465659 ustep: 1 
iter: 3  value: 2809.049 mgc: 0.0002803634 ustep: 1 
iter: 4  mgc: 5.289793e-09 
iter: 1  mgc: 5.289793e-09 
outer mgc:  139.9008 
iter: 1  value: 2796.773 mgc: 13.74888 ustep: 1 
iter: 2  value: 2796.623 mgc: 0.5681288 ustep: 1 
iter: 3  value: 2796.623 mgc: 0.005239344 ustep: 1 
iter: 4  value: 2796.623 mgc: 1.427731e-06 ustep: 1 
iter: 5  mgc: 1.034728e-13 
iter: 1  mgc: 1.034728e-13 
outer mgc:  117.1369 
iter: 1  value: 2800.391 mgc: 21.49652 ustep: 1 
iter: 2  value: 2798.204 mgc: 1.930945 ustep: 1 
iter: 3  value: 2798.203 mgc: 0.02901433 ustep: 1 
iter: 4  value: 2798.203 mgc: 8.938568e-06 ustep: 1 
iter: 5  mgc: 1.050438e-12 
iter: 1  mgc: 1.050438e-12 
outer mgc:  52.41115 
iter: 1  value: 2793.692 mgc: 10.98282 ustep: 1 
iter: 2  value: 2793.139 mgc: 0.4569161 ustep: 1 
iter: 3  value: 2793.138 mgc: 0.02092229 ustep: 1 
iter: 4  value: 2793.138 mgc: 4.868075e-05 ustep: 1 
iter: 5  mgc: 2.649856e-10 
iter: 1  mgc: 2.649856e-10 
outer mgc:  51.64426 
iter: 1  value: 2826.409 mgc: 12.7895 ustep: 1 
iter: 2  value: 2826.116 mgc: 0.6627094 ustep: 1 
iter: 3  value: 2826.116 mgc: 0.003605876 ustep: 1 
iter: 4  value: 2826.116 mgc: 5.53966e-07 ustep: 1 
iter: 5  mgc: 2.975398e-14 
iter: 1  value: 2791.132 mgc: 6.244188 ustep: 1 
iter: 2  value: 2791.129 mgc: 0.08331971 ustep: 1 
iter: 3  value: 2791.129 mgc: 5.258044e-05 ustep: 1 
iter: 4  mgc: 2.770626e-10 
iter: 1  mgc: 2.770626e-10 
outer mgc:  95.24579 
iter: 1  value: 2781.195 mgc: 3.157862 ustep: 1 
iter: 2  value: 2781.194 mgc: 0.03119265 ustep: 1 
iter: 3  value: 2781.194 mgc: 9.712385e-06 ustep: 1 
iter: 4  mgc: 8.31446e-12 
iter: 1  mgc: 8.31446e-12 
outer mgc:  28.59623 
iter: 1  value: 2778.143 mgc: 1.160601 ustep: 1 
iter: 2  value: 2778.143 mgc: 0.02038553 ustep: 1 
iter: 3  value: 2778.143 mgc: 3.118492e-05 ustep: 1 
iter: 4  mgc: 7.335776e-11 
iter: 1  mgc: 7.335776e-11 
outer mgc:  32.97488 
iter: 1  value: 2777.003 mgc: 3.403788 ustep: 1 
iter: 2  value: 2777.001 mgc: 0.04976986 ustep: 1 
iter: 3  value: 2777.001 mgc: 3.865796e-05 ustep: 1 
iter: 4  mgc: 2.379963e-11 
iter: 1  mgc: 2.379963e-11 
outer mgc:  13.8342 
iter: 1  value: 2776.723 mgc: 4.948435 ustep: 1 
iter: 2  value: 2776.72 mgc: 0.06450388 ustep: 1 
iter: 3  value: 2776.72 mgc: 3.821193e-05 ustep: 1 
iter: 4  mgc: 2.696263e-11 
iter: 1  value: 2776.208 mgc: 1.232866 ustep: 1 
iter: 2  value: 2776.208 mgc: 0.003597672 ustep: 1 
iter: 3  value: 2776.208 mgc: 1.041363e-07 ustep: 1 
iter: 4  mgc: 5.240253e-14 
iter: 1  mgc: 5.240253e-14 
outer mgc:  9.999309 
iter: 1  value: 2775.937 mgc: 2.459511 ustep: 1 
iter: 2  value: 2775.936 mgc: 0.01958124 ustep: 1 
iter: 3  value: 2775.936 mgc: 4.245844e-06 ustep: 1 
iter: 4  mgc: 2.83551e-13 
iter: 1  value: 2775.91 mgc: 0.6817091 ustep: 1 
iter: 2  value: 2775.91 mgc: 0.000950601 ustep: 1 
iter: 3  mgc: 6.905653e-09 
iter: 1  mgc: 6.905653e-09 
outer mgc:  7.129472 
iter: 1  value: 2775.797 mgc: 0.45541 ustep: 1 
iter: 2  value: 2775.797 mgc: 0.0007201597 ustep: 1 
iter: 3  value: 2775.797 mgc: 1.084431e-08 ustep: 1 
mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  3.016847 
iter: 1  value: 2775.597 mgc: 0.3236042 ustep: 1 
iter: 2  value: 2775.597 mgc: 0.0004432202 ustep: 1 
iter: 3  mgc: 2.164284e-09 
iter: 1  mgc: 2.164284e-09 
outer mgc:  3.758445 
iter: 1  value: 2775.61 mgc: 0.1563588 ustep: 1 
iter: 2  value: 2775.61 mgc: 0.0001077698 ustep: 1 
iter: 3  mgc: 5.653291e-10 
iter: 1  value: 2775.616 mgc: 0.1529207 ustep: 1 
iter: 2  value: 2775.616 mgc: 5.252436e-05 ustep: 1 
iter: 3  mgc: 2.155587e-11 
iter: 1  mgc: 2.155587e-11 
outer mgc:  2.54455 
iter: 1  value: 2775.55 mgc: 0.1419312 ustep: 1 
iter: 2  value: 2775.55 mgc: 8.319178e-05 ustep: 1 
iter: 3  mgc: 1.779612e-10 
iter: 1  mgc: 1.779612e-10 
outer mgc:  0.5006738 
iter: 1  value: 2775.514 mgc: 0.09584485 ustep: 1 
iter: 2  value: 2775.514 mgc: 4.887917e-05 ustep: 1 
iter: 3  mgc: 1.496718e-10 
iter: 1  mgc: 1.496718e-10 
outer mgc:  0.3721106 
iter: 1  value: 2775.514 mgc: 0.1068784 ustep: 1 
iter: 2  value: 2775.514 mgc: 8.194751e-05 ustep: 1 
iter: 3  mgc: 2.79039e-11 
iter: 1  value: 2775.498 mgc: 0.09731804 ustep: 1 
iter: 2  value: 2775.498 mgc: 2.480665e-05 ustep: 1 
iter: 3  mgc: 2.500222e-12 
iter: 1  mgc: 2.500222e-12 
outer mgc:  0.4972474 
iter: 1  value: 2775.519 mgc: 0.09215125 ustep: 1 
iter: 2  value: 2775.519 mgc: 1.945799e-05 ustep: 1 
iter: 3  mgc: 4.988898e-12 
iter: 1  value: 2775.509 mgc: 0.06492854 ustep: 1 
iter: 2  value: 2775.509 mgc: 9.806877e-06 ustep: 1 
iter: 3  mgc: 6.614154e-13 
iter: 1  mgc: 6.614154e-13 
outer mgc:  0.7642223 
iter: 1  value: 2775.506 mgc: 0.03203841 ustep: 1 
iter: 2  value: 2775.506 mgc: 3.024619e-06 ustep: 1 
iter: 3  mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  0.3351622 
iter: 1  value: 2775.517 mgc: 0.02537895 ustep: 1 
iter: 2  value: 2775.517 mgc: 1.416465e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.08999401 
iter: 1  value: 2775.508 mgc: 0.02633601 ustep: 1 
iter: 2  value: 2775.508 mgc: 2.231816e-06 ustep: 1 
iter: 3  mgc: 7.283063e-14 
iter: 1  value: 2775.512 mgc: 0.01246874 ustep: 1 
iter: 2  value: 2775.512 mgc: 3.529849e-07 ustep: 1 
iter: 3  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.08817176 
iter: 1  value: 2775.511 mgc: 0.006663062 ustep: 1 
iter: 2  value: 2775.511 mgc: 2.24978e-07 ustep: 1 
iter: 3  mgc: 2.940703e-14 
iter: 1  value: 2775.512 mgc: 0.004161262 ustep: 1 
iter: 2  value: 2775.512 mgc: 5.305404e-08 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.05883162 
iter: 1  value: 2775.511 mgc: 0.003988315 ustep: 1 
iter: 2  value: 2775.511 mgc: 8.017691e-08 ustep: 1 
iter: 3  mgc: 2.853273e-14 
iter: 1  mgc: 2.853273e-14 
outer mgc:  0.008050104 
iter: 1  value: 2775.509 mgc: 0.001597452 ustep: 1 
iter: 2  value: 2775.509 mgc: 3.310093e-08 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  value: 2775.51 mgc: 0.0007506066 ustep: 1 
iter: 2  mgc: 7.307498e-09 
iter: 1  mgc: 7.307498e-09 
outer mgc:  0.01017405 
iter: 1  value: 2775.51 mgc: 0.001186741 ustep: 1 
iter: 2  mgc: 2.852436e-09 
iter: 1  value: 2775.51 mgc: 0.001098136 ustep: 1 
iter: 2  mgc: 3.222571e-09 
iter: 1  mgc: 3.222571e-09 
outer mgc:  0.01982622 
iter: 1  value: 2775.51 mgc: 0.0009977059 ustep: 1 
iter: 2  mgc: 3.25363e-09 
iter: 1  mgc: 3.25363e-09 
outer mgc:  0.004957577 
iter: 1  value: 2775.509 mgc: 0.0008888588 ustep: 1 
iter: 2  mgc: 3.097101e-09 
iter: 1  mgc: 3.097101e-09 
outer mgc:  0.002185236 
iter: 1  value: 2775.509 mgc: 0.0006243358 ustep: 1 
iter: 2  mgc: 1.43475e-09 
iter: 1  value: 2775.509 mgc: 0.0001725251 ustep: 1 
iter: 2  mgc: 1.095612e-10 
iter: 1  mgc: 1.095612e-10 
outer mgc:  0.004041598 
iter: 1  value: 2775.51 mgc: 0.0001648195 ustep: 1 
iter: 2  mgc: 1.229041e-10 
iter: 1  mgc: 1.229041e-10 
outer mgc:  0.002080931 
iter: 1  mgc: 1.229041e-10 
iter: 1  mgc: 1.229041e-10 
outer mgc:  0.002080931 
iter: 1  value: 2775.513 mgc: 0.05115301 ustep: 1 
iter: 2  value: 2775.513 mgc: 5.53873e-06 ustep: 1 
iter: 3  mgc: 1.29674e-13 
outer mgc:  0.3427157 
iter: 1  value: 2775.506 mgc: 0.05115458 ustep: 1 
iter: 2  value: 2775.506 mgc: 5.547223e-06 ustep: 1 
iter: 3  mgc: 1.070255e-13 
outer mgc:  0.343078 
iter: 1  value: 2775.519 mgc: 0.03106507 ustep: 1 
iter: 2  value: 2775.519 mgc: 2.55799e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  1.109611 
iter: 1  value: 2775.501 mgc: 0.03106962 ustep: 1 
iter: 2  value: 2775.501 mgc: 2.56238e-06 ustep: 1 
iter: 3  mgc: 4.840572e-14 
outer mgc:  1.105637 
iter: 1  value: 2775.507 mgc: 0.04239486 ustep: 1 
iter: 2  value: 2775.507 mgc: 8.804522e-06 ustep: 1 
iter: 3  mgc: 8.011369e-13 
outer mgc:  0.1254339 
iter: 1  value: 2775.513 mgc: 0.04238268 ustep: 1 
iter: 2  value: 2775.513 mgc: 8.813103e-06 ustep: 1 
iter: 3  mgc: 8.048007e-13 
outer mgc:  0.1268164 
iter: 1  value: 2775.507 mgc: 0.01530947 ustep: 1 
iter: 2  value: 2775.507 mgc: 1.526756e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.3731895 
iter: 1  value: 2775.512 mgc: 0.01530062 ustep: 1 
iter: 2  value: 2775.512 mgc: 1.525792e-06 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.3730814 
iter: 1  value: 2775.507 mgc: 0.04778827 ustep: 1 
iter: 2  value: 2775.507 mgc: 7.967031e-06 ustep: 1 
iter: 3  mgc: 6.3477e-13 
outer mgc:  0.1970691 
iter: 1  value: 2775.512 mgc: 0.04777883 ustep: 1 
iter: 2  value: 2775.512 mgc: 7.974962e-06 ustep: 1 
iter: 3  mgc: 6.327716e-13 
outer mgc:  0.1971665 
iter: 1  value: 2775.507 mgc: 0.01803849 ustep: 1 
iter: 2  value: 2775.507 mgc: 1.426238e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.4726458 
iter: 1  value: 2775.513 mgc: 0.01802897 ustep: 1 
iter: 2  value: 2775.513 mgc: 1.425291e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.4739364 
iter: 1  value: 2775.505 mgc: 0.004728895 ustep: 1 
iter: 2  value: 2775.505 mgc: 7.141286e-07 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.07851397 
iter: 1  value: 2775.514 mgc: 0.004721064 ustep: 1 
iter: 2  value: 2775.514 mgc: 7.123671e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.07580213 
iter: 1  value: 2775.507 mgc: 0.004946994 ustep: 1 
iter: 2  value: 2775.507 mgc: 3.136455e-07 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.07849514 
iter: 1  value: 2775.512 mgc: 0.004942476 ustep: 1 
iter: 2  value: 2775.512 mgc: 3.122642e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.07782356 
iter: 1  value: 2775.508 mgc: 0.003077597 ustep: 1 
iter: 2  value: 2775.508 mgc: 4.258392e-07 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.07800375 
iter: 1  value: 2775.511 mgc: 0.003075087 ustep: 1 
iter: 2  value: 2775.511 mgc: 4.24743e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.07941157 
iter: 1  value: 2775.519 mgc: 0.009109513 ustep: 1 
iter: 2  value: 2775.519 mgc: 4.838409e-07 ustep: 1 
iter: 3  mgc: 2.742251e-14 
outer mgc:  0.1808326 
iter: 1  value: 2775.5 mgc: 0.00912828 ustep: 1 
iter: 2  value: 2775.5 mgc: 4.855587e-07 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.1808629 
iter: 1  value: 2775.524 mgc: 0.005418797 ustep: 1 
iter: 2  value: 2775.524 mgc: 2.101783e-06 ustep: 1 
iter: 3  mgc: 3.175238e-13 
outer mgc:  0.1469791 
iter: 1  value: 2775.495 mgc: 0.005430362 ustep: 1 
iter: 2  value: 2775.495 mgc: 2.107178e-06 ustep: 1 
iter: 3  mgc: 3.179679e-13 
outer mgc:  0.145794 
iter: 1  value: 2775.524 mgc: 0.008057593 ustep: 1 
iter: 2  value: 2775.524 mgc: 2.403307e-06 ustep: 1 
iter: 3  mgc: 2.695622e-13 
outer mgc:  0.1541726 
iter: 1  value: 2775.496 mgc: 0.008074295 ustep: 1 
iter: 2  value: 2775.496 mgc: 2.407796e-06 ustep: 1 
iter: 3  mgc: 2.695622e-13 
outer mgc:  0.1548791 
[Fri Aug 13 08:48:14 2021]
Finished job 0.
1 of 1 steps (100%) done

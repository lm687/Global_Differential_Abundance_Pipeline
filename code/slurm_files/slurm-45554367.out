Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 13:28:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22126.051494 
iter  10 value 20000.854206
iter  10 value 20000.854205
final  value 20000.854205 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18564.3 mgc: 7.831045 ustep: 0.6434197 
iter: 2  value: 18505.46 mgc: 6.213709 ustep: 0.8021543 
iter: 3  value: 18464.9 mgc: 6.787147 ustep: 0.4168526 
iter: 4  value: 18463.53 mgc: 1.159461 ustep: 0.6456766 
iter: 5  value: 18463.45 mgc: 0.294399 ustep: 0.8035597 
iter: 6  value: 18463.45 mgc: 0.04588966 ustep: 0.8964253 
iter: 7  value: 18463.45 mgc: 0.004086284 ustep: 0.9468027 
iter: 8  value: 18463.45 mgc: 0.0001824653 ustep: 0.9730406 
iter: 9  value: 18463.45 mgc: 3.992574e-06 ustep: 0.9864295 
iter: 10  value: 18463.45 mgc: 4.308784e-08 ustep: 0.9931923 
iter: 11  mgc: 2.311286e-10 
iter: 1  mgc: 2.311286e-10 
Matching hessian patterns... Done
outer mgc:  121.9732 
iter: 1  value: 18315.31 mgc: 2.436283 ustep: 1 
iter: 2  value: 18315.17 mgc: 0.2946754 ustep: 1 
iter: 3  value: 18315.17 mgc: 0.005169317 ustep: 1 
iter: 4  value: 18315.17 mgc: 2.431456e-06 ustep: 1 
iter: 5  mgc: 5.815166e-13 
iter: 1  value: 18245.24 mgc: 4.684942 ustep: 1 
iter: 2  value: 18243.95 mgc: 1.300675 ustep: 1 
iter: 3  value: 18243.95 mgc: 0.07925877 ustep: 1 
iter: 4  value: 18243.95 mgc: 0.0004096444 ustep: 1 
iter: 5  value: 18243.95 mgc: 1.11226e-08 ustep: 1 
mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  62.91786 
iter: 1  value: 18257.66 mgc: 4.875143 ustep: 1 
iter: 2  value: 18235.67 mgc: 2.609547 ustep: 1 
iter: 3  value: 18235.44 mgc: 0.3019822 ustep: 1 
iter: 4  value: 18235.44 mgc: 0.008693648 ustep: 1 
iter: 5  value: 18235.44 mgc: 9.306344e-06 ustep: 1 
iter: 6  mgc: 1.05439e-11 
iter: 1  mgc: 1.05439e-11 
outer mgc:  88.9872 
iter: 1  value: 18348.18 mgc: 5.870543 ustep: 1 
iter: 2  value: 18327.36 mgc: 2.804725 ustep: 1 
iter: 3  value: 18327.34 mgc: 0.1117132 ustep: 1 
iter: 4  value: 18327.34 mgc: 0.0005631058 ustep: 1 
iter: 5  value: 18327.34 mgc: 2.539288e-08 ustep: 1 
iter: 6  mgc: 3.108624e-15 
iter: 1  value: 18185.94 mgc: 2.185835 ustep: 1 
iter: 2  value: 18185.82 mgc: 0.2740333 ustep: 1 
iter: 3  value: 18185.82 mgc: 0.002531824 ustep: 1 
iter: 4  value: 18185.82 mgc: 3.695412e-07 ustep: 1 
iter: 5  mgc: 1.521006e-14 
iter: 1  mgc: 1.521006e-14 
outer mgc:  26.40233 
iter: 1  value: 18142.98 mgc: 2.375462 ustep: 1 
iter: 2  value: 18142.69 mgc: 0.2089476 ustep: 1 
iter: 3  value: 18142.69 mgc: 0.003164916 ustep: 1 
iter: 4  value: 18142.69 mgc: 8.914691e-07 ustep: 1 
iter: 5  mgc: 6.833423e-14 
iter: 1  mgc: 6.833423e-14 
outer mgc:  24.5383 
iter: 1  value: 18141.27 mgc: 2.248989 ustep: 1 
iter: 2  value: 18141.09 mgc: 0.221932 ustep: 1 
iter: 3  value: 18141.09 mgc: 0.002723535 ustep: 1 
iter: 4  value: 18141.09 mgc: 4.3993e-07 ustep: 1 
iter: 5  mgc: 1.237899e-14 
iter: 1  mgc: 1.237899e-14 
outer mgc:  27.04861 
iter: 1  value: 18113.62 mgc: 3.125698 ustep: 1 
iter: 2  value: 18113.51 mgc: 0.1947587 ustep: 1 
iter: 3  value: 18113.51 mgc: 0.001793502 ustep: 1 
iter: 4  value: 18113.51 mgc: 1.778251e-07 ustep: 1 
iter: 5  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  31.40714 
iter: 1  value: 18099.53 mgc: 3.550808 ustep: 1 
iter: 2  value: 18099.47 mgc: 0.1498673 ustep: 1 
iter: 3  value: 18099.47 mgc: 0.000636769 ustep: 1 
iter: 4  value: 18099.47 mgc: 1.14839e-08 ustep: 1 
mgc: 6.050715e-15 
iter: 1  value: 18107.32 mgc: 1.679857 ustep: 1 
iter: 2  value: 18107.31 mgc: 0.05872897 ustep: 1 
iter: 3  value: 18107.31 mgc: 0.0001593273 ustep: 1 
iter: 4  mgc: 1.264468e-09 
iter: 1  mgc: 1.264468e-09 
outer mgc:  27.78122 
iter: 1  value: 18098.29 mgc: 1.271147 ustep: 1 
iter: 2  value: 18098.29 mgc: 0.01457749 ustep: 1 
iter: 3  value: 18098.29 mgc: 2.312002e-06 ustep: 1 
iter: 4  mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  17.6406 
iter: 1  value: 18090.13 mgc: 0.9997998 ustep: 1 
iter: 2  value: 18090.13 mgc: 0.02263252 ustep: 1 
iter: 3  value: 18090.13 mgc: 2.67831e-05 ustep: 1 
iter: 4  mgc: 2.902167e-11 
iter: 1  mgc: 2.902167e-11 
outer mgc:  4.979568 
iter: 1  value: 18085.05 mgc: 0.911299 ustep: 1 
iter: 2  value: 18085.05 mgc: 0.01731497 ustep: 1 
iter: 3  value: 18085.05 mgc: 7.40301e-06 ustep: 1 
iter: 4  mgc: 1.375566e-12 
iter: 1  value: 18087.79 mgc: 0.2720269 ustep: 1 
iter: 2  value: 18087.79 mgc: 0.001678114 ustep: 1 
iter: 3  value: 18087.79 mgc: 7.525322e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  5.072568 
iter: 1  value: 18084.41 mgc: 0.5020132 ustep: 1 
iter: 2  value: 18084.41 mgc: 0.003075945 ustep: 1 
iter: 3  value: 18084.41 mgc: 2.937479e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  7.458357 
iter: 1  value: 18081.53 mgc: 0.4093058 ustep: 1 
iter: 2  value: 18081.53 mgc: 0.002165837 ustep: 1 
iter: 3  value: 18081.53 mgc: 9.969863e-08 ustep: 1 
iter: 4  mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  3.549561 
iter: 1  value: 18075.57 mgc: 0.7715713 ustep: 1 
iter: 2  value: 18075.57 mgc: 0.01037264 ustep: 1 
iter: 3  value: 18075.57 mgc: 3.874062e-06 ustep: 1 
iter: 4  mgc: 5.351275e-13 
iter: 1  mgc: 5.351275e-13 
outer mgc:  6.230143 
iter: 1  value: 18067.6 mgc: 0.3585891 ustep: 1 
iter: 2  value: 18067.6 mgc: 0.001721613 ustep: 1 
iter: 3  value: 18067.6 mgc: 5.147273e-08 ustep: 1 
mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  5.197522 
iter: 1  value: 18068.58 mgc: 0.7931653 ustep: 1 
iter: 2  value: 18068.58 mgc: 0.004360248 ustep: 1 
iter: 3  value: 18068.58 mgc: 2.937863e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  value: 18067.46 mgc: 0.2395944 ustep: 1 
iter: 2  value: 18067.46 mgc: 0.000395516 ustep: 1 
iter: 3  mgc: 2.45762e-09 
iter: 1  mgc: 2.45762e-09 
outer mgc:  5.258581 
iter: 1  value: 18065.71 mgc: 0.3322278 ustep: 1 
iter: 2  value: 18065.71 mgc: 0.0009320281 ustep: 1 
iter: 3  value: 18065.71 mgc: 2.350004e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  4.991673 
iter: 1  value: 18063.82 mgc: 0.21819 ustep: 1 
iter: 2  value: 18063.82 mgc: 0.0006297708 ustep: 1 
iter: 3  mgc: 6.094012e-09 
iter: 1  mgc: 6.094012e-09 
outer mgc:  2.126403 
iter: 1  value: 18059.35 mgc: 0.3691524 ustep: 1 
iter: 2  value: 18059.35 mgc: 0.001531972 ustep: 1 
iter: 3  value: 18059.35 mgc: 6.566762e-08 ustep: 1 
iter: 4  mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  3.380272 
iter: 1  value: 18055.44 mgc: 0.3687686 ustep: 1 
iter: 2  value: 18055.44 mgc: 0.001296863 ustep: 1 
iter: 3  value: 18055.44 mgc: 2.034983e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  1.667145 
iter: 1  value: 18051.42 mgc: 0.2664002 ustep: 1 
iter: 2  value: 18051.42 mgc: 0.0008982983 ustep: 1 
iter: 3  value: 18051.42 mgc: 1.88363e-08 ustep: 1 
mgc: 5.599687e-15 
iter: 1  mgc: 5.599687e-15 
outer mgc:  1.93332 
iter: 1  value: 18047.08 mgc: 0.3831912 ustep: 1 
iter: 2  value: 18047.08 mgc: 0.001259847 ustep: 1 
iter: 3  value: 18047.08 mgc: 3.40357e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  value: 18036.31 mgc: 0.8479733 ustep: 1 
iter: 2  value: 18036.31 mgc: 0.007154182 ustep: 1 
iter: 3  value: 18036.31 mgc: 7.66108e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  6.006879 
iter: 1  value: 18020.36 mgc: 1.587121 ustep: 1 
iter: 2  value: 18020.36 mgc: 0.009789142 ustep: 1 
iter: 3  value: 18020.36 mgc: 5.129892e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  5.717033 
iter: 1  value: 18003.43 mgc: 1.700665 ustep: 1 
iter: 2  value: 18003.43 mgc: 0.00307368 ustep: 1 
iter: 3  value: 18003.43 mgc: 5.657649e-08 ustep: 1 
mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  6.661078 
iter: 1  value: 17994.62 mgc: 0.588179 ustep: 1 
iter: 2  value: 17994.62 mgc: 0.0008913339 ustep: 1 
iter: 3  mgc: 4.534468e-09 
iter: 1  mgc: 4.534468e-09 
outer mgc:  2.832859 
iter: 1  value: 17995.46 mgc: 0.5844121 ustep: 1 
iter: 2  value: 17995.46 mgc: 0.0005019686 ustep: 1 
iter: 3  mgc: 9.862662e-10 
iter: 1  mgc: 9.862662e-10 
outer mgc:  0.5205016 
iter: 1  value: 17994.48 mgc: 0.04958323 ustep: 1 
iter: 2  value: 17994.48 mgc: 7.724081e-06 ustep: 1 
iter: 3  mgc: 1.803002e-13 
iter: 1  value: 17995.07 mgc: 0.02100142 ustep: 1 
iter: 2  value: 17995.07 mgc: 1.44987e-06 ustep: 1 
iter: 3  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.2450693 
iter: 1  value: 17994.58 mgc: 0.03821491 ustep: 1 
iter: 2  value: 17994.58 mgc: 3.306202e-06 ustep: 1 
iter: 3  mgc: 6.039613e-14 
iter: 1  value: 17993.59 mgc: 0.06948204 ustep: 1 
iter: 2  value: 17993.59 mgc: 1.092417e-05 ustep: 1 
iter: 3  mgc: 6.146195e-13 
iter: 1  mgc: 6.146195e-13 
outer mgc:  0.1028898 
iter: 1  value: 17992.21 mgc: 0.1186466 ustep: 1 
iter: 2  value: 17992.21 mgc: 2.335584e-05 ustep: 1 
iter: 3  mgc: 2.403855e-12 
iter: 1  mgc: 2.403855e-12 
outer mgc:  0.04190838 
iter: 1  value: 17991.1 mgc: 0.09830375 ustep: 1 
iter: 2  value: 17991.1 mgc: 1.591625e-05 ustep: 1 
iter: 3  mgc: 9.370282e-13 
iter: 1  mgc: 9.370282e-13 
outer mgc:  0.01043923 
iter: 1  value: 17991.03 mgc: 0.007347334 ustep: 1 
iter: 2  value: 17991.03 mgc: 9.229123e-08 ustep: 1 
iter: 3  mgc: 4.773959e-15 
iter: 1  mgc: 4.773959e-15 
outer mgc:  0.004327811 
iter: 1  mgc: 4.773959e-15 
iter: 1  mgc: 4.773959e-15 
outer mgc:  0.004327811 
iter: 1  value: 17991.03 mgc: 0.005042636 ustep: 1 
iter: 2  value: 17991.03 mgc: 4.129839e-08 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.3415034 
iter: 1  value: 17991.03 mgc: 0.005043385 ustep: 1 
iter: 2  value: 17991.03 mgc: 4.11827e-08 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.3479467 
iter: 1  value: 17991.03 mgc: 0.002532902 ustep: 1 
iter: 2  value: 17991.03 mgc: 1.305512e-08 ustep: 1 
mgc: 5.578871e-15 
outer mgc:  0.1934458 
iter: 1  value: 17991.03 mgc: 0.00253315 ustep: 1 
iter: 2  value: 17991.03 mgc: 1.303532e-08 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.202088 
iter: 1  value: 17991.03 mgc: 0.00383917 ustep: 1 
iter: 2  value: 17991.03 mgc: 5.610666e-08 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.2204336 
iter: 1  value: 17991.04 mgc: 0.003836638 ustep: 1 
iter: 2  value: 17991.04 mgc: 5.605595e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.2210565 
iter: 1  value: 17991.03 mgc: 0.002206012 ustep: 1 
iter: 2  value: 17991.03 mgc: 1.927111e-08 ustep: 1 
mgc: 5.107026e-15 
outer mgc:  0.1192348 
iter: 1  value: 17991.03 mgc: 0.002204788 ustep: 1 
iter: 2  value: 17991.03 mgc: 1.925879e-08 ustep: 1 
mgc: 6.439294e-15 
outer mgc:  0.1168367 
iter: 1  value: 17991.07 mgc: 0.004762839 ustep: 1 
iter: 2  value: 17991.07 mgc: 2.974683e-08 ustep: 1 
mgc: 5.107026e-15 
outer mgc:  0.008482097 
iter: 1  value: 17990.99 mgc: 0.004767604 ustep: 1 
iter: 2  value: 17990.99 mgc: 2.973344e-08 ustep: 1 
mgc: 5.134781e-15 
outer mgc:  0.01081432 
iter: 1  value: 17991.08 mgc: 0.004631106 ustep: 1 
iter: 2  value: 17991.08 mgc: 3.628587e-08 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.004418274 
iter: 1  value: 17990.99 mgc: 0.004635739 ustep: 1 
iter: 2  value: 17990.99 mgc: 3.62343e-08 ustep: 1 
mgc: 7.327472e-15 
outer mgc:  0.005506346 
iter: 1  value: 17991.02 mgc: 0.003917535 ustep: 1 
iter: 2  value: 17991.02 mgc: 3.154341e-08 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.1637946 
iter: 1  value: 17991.04 mgc: 0.003914321 ustep: 1 
iter: 2  value: 17991.04 mgc: 3.145793e-08 ustep: 1 
mgc: 4.760081e-15 
outer mgc:  0.1614227 
[Sat Aug 14 13:28:33 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 09:05:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.005_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_80_3_0.005_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_10_100_80_3_0.005_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.005_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_80_3_0.005_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.005_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.005_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_80_3_0.005_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2214.802374 
iter  10 value 1898.492329
iter  10 value 1898.492328
final  value 1898.492328 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 500.3821 mgc: 93.85111 ustep: 1 
iter: 2  value: 387.5527 mgc: 35.99141 ustep: 1 
iter: 3  value: 380.6626 mgc: 12.63402 ustep: 1 
iter: 4  value: 380.6553 mgc: 0.6146968 ustep: 1 
iter: 5  value: 380.6553 mgc: 0.0003779682 ustep: 1 
iter: 6  mgc: 2.777622e-09 
iter: 1  mgc: 2.777622e-09 
Matching hessian patterns... Done
outer mgc:  203.6405 
iter: 1  value: 208.4571 mgc: 30.67523 ustep: 1 
iter: 2  value: 205.4284 mgc: 5.550593 ustep: 1 
iter: 3  value: 205.4175 mgc: 0.4127836 ustep: 1 
iter: 4  value: 205.4175 mgc: 0.00331275 ustep: 1 
iter: 5  value: 205.4175 mgc: 2.187909e-07 ustep: 1 
iter: 6  mgc: 2.209344e-14 
iter: 1  mgc: 2.209344e-14 
outer mgc:  86.82095 
iter: 1  value: 152.5924 mgc: 26.78705 ustep: 1 
iter: 2  value: 151.1358 mgc: 3.660429 ustep: 1 
iter: 3  value: 151.1335 mgc: 0.1809473 ustep: 1 
iter: 4  value: 151.1335 mgc: 0.0006160151 ustep: 1 
iter: 5  mgc: 7.219457e-09 
iter: 1  mgc: 7.219457e-09 
outer mgc:  10.4636 
iter: 1  value: 148.7722 mgc: 10.65087 ustep: 1 
iter: 2  value: 148.4041 mgc: 1.534151 ustep: 1 
iter: 3  value: 148.4039 mgc: 0.0263882 ustep: 1 
iter: 4  value: 148.4039 mgc: 1.978126e-05 ustep: 1 
iter: 5  mgc: 1.113976e-11 
iter: 1  mgc: 1.113976e-11 
outer mgc:  39.40191 
iter: 1  value: 134.0259 mgc: 34.47711 ustep: 1 
iter: 2  value: 133.2235 mgc: 3.58989 ustep: 1 
iter: 3  value: 133.2234 mgc: 0.04415774 ustep: 1 
iter: 4  value: 133.2234 mgc: 2.99722e-05 ustep: 1 
iter: 5  mgc: 1.396305e-11 
iter: 1  mgc: 1.396305e-11 
outer mgc:  10.82093 
iter: 1  value: 132.3453 mgc: 16.20204 ustep: 1 
iter: 2  value: 132.2371 mgc: 1.200699 ustep: 1 
iter: 3  value: 132.2371 mgc: 0.006830204 ustep: 1 
iter: 4  value: 132.2371 mgc: 3.666787e-07 ustep: 1 
iter: 5  mgc: 3.375078e-14 
iter: 1  value: 131.5259 mgc: 10.74179 ustep: 1 
iter: 2  value: 131.4827 mgc: 0.6239222 ustep: 1 
iter: 3  value: 131.4827 mgc: 0.002984942 ustep: 1 
iter: 4  value: 131.4827 mgc: 1.043159e-07 ustep: 1 
mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  17.38188 
iter: 1  value: 125.8493 mgc: 25.76346 ustep: 1 
iter: 2  value: 125.7503 mgc: 1.456448 ustep: 1 
iter: 3  value: 125.7503 mgc: 0.003108345 ustep: 1 
iter: 4  value: 125.7503 mgc: 1.153377e-07 ustep: 1 
mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  14.75816 
iter: 1  value: 120.872 mgc: 11.70931 ustep: 1 
iter: 2  value: 120.871 mgc: 0.1691685 ustep: 1 
iter: 3  value: 120.871 mgc: 3.167068e-05 ustep: 1 
iter: 4  mgc: 1.111233e-11 
iter: 1  mgc: 1.111233e-11 
outer mgc:  10.89571 
iter: 1  value: 123.7087 mgc: 17.97394 ustep: 1 
iter: 2  value: 123.6581 mgc: 0.6347372 ustep: 1 
iter: 3  value: 123.6581 mgc: 0.002843956 ustep: 1 
iter: 4  value: 123.6581 mgc: 6.297407e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  value: 119.0445 mgc: 6.223585 ustep: 1 
iter: 2  value: 119.0438 mgc: 0.08590348 ustep: 1 
iter: 3  value: 119.0438 mgc: 4.826058e-05 ustep: 1 
iter: 4  mgc: 1.689643e-11 
iter: 1  mgc: 1.689643e-11 
outer mgc:  7.877032 
iter: 1  value: 118.0525 mgc: 7.523619 ustep: 1 
iter: 2  value: 118.0523 mgc: 0.05957177 ustep: 1 
iter: 3  value: 118.0523 mgc: 1.377416e-05 ustep: 1 
iter: 4  mgc: 6.824541e-13 
iter: 1  mgc: 6.824541e-13 
outer mgc:  10.70848 
iter: 1  value: 115.9697 mgc: 5.668263 ustep: 1 
iter: 2  value: 115.9696 mgc: 0.02739405 ustep: 1 
iter: 3  value: 115.9696 mgc: 5.000671e-06 ustep: 1 
iter: 4  mgc: 1.270095e-13 
iter: 1  mgc: 1.270095e-13 
outer mgc:  7.015763 
iter: 1  value: 112.6173 mgc: 8.601496 ustep: 1 
iter: 2  value: 112.617 mgc: 0.05358871 ustep: 1 
iter: 3  value: 112.617 mgc: 2.594308e-05 ustep: 1 
iter: 4  mgc: 3.213541e-13 
iter: 1  mgc: 3.213541e-13 
outer mgc:  10.40095 
iter: 1  value: 109.1518 mgc: 10.09719 ustep: 1 
iter: 2  value: 109.1517 mgc: 0.02067412 ustep: 1 
iter: 3  value: 109.1517 mgc: 3.516996e-06 ustep: 1 
iter: 4  mgc: 7.609538e-14 
iter: 1  mgc: 7.609538e-14 
outer mgc:  15.26783 
iter: 1  value: 107.0519 mgc: 6.329578 ustep: 1 
iter: 2  value: 107.0509 mgc: 0.212497 ustep: 1 
iter: 3  value: 107.0509 mgc: 3.85751e-05 ustep: 1 
iter: 4  mgc: 7.909673e-12 
iter: 1  mgc: 7.909673e-12 
outer mgc:  5.821724 
iter: 1  value: 107.4339 mgc: 7.597038 ustep: 1 
iter: 2  value: 107.4278 mgc: 0.3431253 ustep: 1 
iter: 3  value: 107.4278 mgc: 0.000520676 ustep: 1 
iter: 4  mgc: 1.25843e-09 
iter: 1  value: 106.3891 mgc: 2.978324 ustep: 1 
iter: 2  value: 106.389 mgc: 0.04525967 ustep: 1 
iter: 3  value: 106.389 mgc: 8.380929e-06 ustep: 1 
iter: 4  mgc: 3.028688e-13 
iter: 1  mgc: 3.028688e-13 
outer mgc:  9.918813 
iter: 1  value: 105.1209 mgc: 5.006482 ustep: 1 
iter: 2  value: 105.1209 mgc: 0.001663513 ustep: 1 
iter: 3  value: 105.1209 mgc: 2.627041e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  2.211741 
iter: 1  value: 102.8593 mgc: 3.943692 ustep: 1 
iter: 2  value: 102.8592 mgc: 0.01990794 ustep: 1 
iter: 3  value: 102.8592 mgc: 1.882691e-06 ustep: 1 
iter: 4  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  1.751069 
iter: 1  value: 100.7274 mgc: 11.8646 ustep: 1 
iter: 2  value: 100.7274 mgc: 0.008890998 ustep: 1 
iter: 3  value: 100.7274 mgc: 5.436882e-07 ustep: 1 
iter: 4  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  8.613024 
iter: 1  value: 98.5638 mgc: 12.00871 ustep: 1 
iter: 2  value: 98.5638 mgc: 0.01013122 ustep: 1 
iter: 3  value: 98.5638 mgc: 4.864419e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  4.021558 
iter: 1  value: 98.4421 mgc: 1.334204 ustep: 1 
iter: 2  value: 98.4421 mgc: 0.007975953 ustep: 1 
iter: 3  value: 98.4421 mgc: 4.681274e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  value: 98.45805 mgc: 0.5192745 ustep: 1 
iter: 2  value: 98.45805 mgc: 0.00105795 ustep: 1 
iter: 3  mgc: 7.718623e-09 
iter: 1  mgc: 7.718623e-09 
outer mgc:  2.569711 
iter: 1  value: 98.44684 mgc: 4.288194 ustep: 1 
iter: 2  value: 98.44684 mgc: 0.001353833 ustep: 1 
iter: 3  value: 98.44684 mgc: 1.189486e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  0.7812516 
iter: 1  value: 98.19077 mgc: 0.6074602 ustep: 1 
iter: 2  value: 98.19077 mgc: 1.620775e-05 ustep: 1 
iter: 3  mgc: 1.598721e-12 
iter: 1  mgc: 1.598721e-12 
outer mgc:  0.484682 
iter: 1  value: 97.26019 mgc: 2.387277 ustep: 1 
iter: 2  value: 97.26019 mgc: 6.58283e-05 ustep: 1 
iter: 3  mgc: 2.836084e-11 
iter: 1  value: 96.08898 mgc: 2.969672 ustep: 1 
iter: 2  value: 96.08898 mgc: 7.057147e-05 ustep: 1 
iter: 3  mgc: 3.244913e-11 
iter: 1  mgc: 3.244913e-11 
outer mgc:  0.648463 
iter: 1  value: 94.59434 mgc: 4.395578 ustep: 1 
iter: 2  value: 94.59434 mgc: 0.0001220492 ustep: 1 
iter: 3  mgc: 9.108309e-11 
iter: 1  mgc: 9.108309e-11 
outer mgc:  0.2189826 
iter: 1  value: 93.2469 mgc: 3.35224 ustep: 1 
iter: 2  value: 93.2469 mgc: 0.0001269061 ustep: 1 
iter: 3  mgc: 8.816348e-11 
iter: 1  mgc: 8.816348e-11 
outer mgc:  0.2015524 
iter: 1  value: 92.01658 mgc: 2.981302 ustep: 1 
iter: 2  value: 92.01658 mgc: 2.591962e-05 ustep: 1 
iter: 3  mgc: 4.164502e-12 
iter: 1  mgc: 4.164502e-12 
outer mgc:  0.04076863 
iter: 1  value: 89.87583 mgc: 5.58283 ustep: 1 
iter: 2  value: 89.87583 mgc: 1.266903e-05 ustep: 1 
iter: 3  mgc: 1.052103e-12 
iter: 1  mgc: 1.052103e-12 
outer mgc:  0.03978502 
iter: 1  value: 88.09145 mgc: 4.460689 ustep: 1 
iter: 2  value: 88.09145 mgc: 4.579777e-06 ustep: 1 
iter: 3  mgc: 1.283418e-13 
iter: 1  mgc: 1.283418e-13 
outer mgc:  0.01072293 
iter: 1  value: 86.10236 mgc: 5.110626 ustep: 1 
iter: 2  value: 86.10236 mgc: 2.111305e-06 ustep: 1 
iter: 3  mgc: 2.438605e-13 
iter: 1  mgc: 2.438605e-13 
outer mgc:  0.01188006 
iter: 1  value: 84.45237 mgc: 4.225714 ustep: 1 
iter: 2  value: 84.45237 mgc: 9.230445e-07 ustep: 1 
iter: 3  mgc: 1.136868e-13 
iter: 1  mgc: 1.136868e-13 
outer mgc:  0.008602105 
iter: 1  value: 82.39236 mgc: 6.212293 ustep: 1 
iter: 2  value: 82.39236 mgc: 9.544919e-07 ustep: 1 
iter: 3  mgc: 2.63789e-13 
iter: 1  mgc: 2.63789e-13 
outer mgc:  0.003373664 
iter: 1  value: 80.68269 mgc: 5.360438 ustep: 1 
iter: 2  value: 80.68269 mgc: 3.468603e-07 ustep: 1 
iter: 3  mgc: 7.238654e-13 
iter: 1  mgc: 7.238654e-13 
outer mgc:  0.002667223 
iter: 1  value: 78.61444 mgc: 6.102264 ustep: 1 
iter: 2  value: 78.61444 mgc: 2.152891e-07 ustep: 1 
iter: 3  mgc: 6.146195e-13 
iter: 1  mgc: 6.146195e-13 
outer mgc:  0.002177769 
iter: 1  value: 76.8963 mgc: 4.374458 ustep: 1 
iter: 2  value: 76.8963 mgc: 4.218282e-08 ustep: 1 
mgc: 1.286082e-12 
iter: 1  mgc: 1.286082e-12 
outer mgc:  0.001505441 
iter: 1  value: 74.80218 mgc: 5.352588 ustep: 1 
iter: 2  value: 74.80218 mgc: 1.5819e-08 ustep: 1 
mgc: 1.979306e-12 
iter: 1  mgc: 1.979306e-12 
outer mgc:  0.000926455 
iter: 1  value: 73.07117 mgc: 4.26011 ustep: 1 
iter: 2  mgc: 5.007421e-09 
iter: 1  mgc: 5.007421e-09 
outer mgc:  0.0005194522 
iter: 1  value: 70.97863 mgc: 5.476322 ustep: 1 
iter: 2  mgc: 5.353236e-09 
iter: 1  mgc: 5.353236e-09 
outer mgc:  0.0005144054 
iter: 1  value: 69.24974 mgc: 4.99984 ustep: 1 
iter: 2  mgc: 3.15592e-09 
iter: 1  mgc: 3.15592e-09 
outer mgc:  0.0003533782 
iter: 1  value: 67.15498 mgc: 7.262099 ustep: 1 
iter: 2  mgc: 3.000481e-09 
iter: 1  mgc: 3.000481e-09 
outer mgc:  0.0001791768 
iter: 1  value: 65.42362 mgc: 5.693034 ustep: 1 
iter: 2  mgc: 8.799065e-10 
iter: 1  mgc: 8.799065e-10 
outer mgc:  0.0001456139 
iter: 1  value: 63.32748 mgc: 5.765077 ustep: 1 
iter: 2  mgc: 4.184303e-10 
iter: 1  mgc: 4.184303e-10 
outer mgc:  0.0001310437 
iter: 1  value: 61.59519 mgc: 4.298946 ustep: 1 
iter: 2  mgc: 5.768896e-11 
iter: 1  mgc: 5.768896e-11 
outer mgc:  7.711395e-05 
iter: 1  value: 59.49784 mgc: 5.228713 ustep: 1 
iter: 2  mgc: 5.545431e-11 
iter: 1  mgc: 5.545431e-11 
outer mgc:  4.052401e-05 
iter: 1  value: 57.76505 mgc: 4.255529 ustep: 1 
iter: 2  mgc: 6.019674e-11 
iter: 1  mgc: 6.019674e-11 
outer mgc:  3.494068e-05 
iter: 1  value: 55.66792 mgc: 5.61022 ustep: 1 
iter: 2  mgc: 1.025517e-10 
iter: 1  mgc: 1.025517e-10 
outer mgc:  2.944586e-05 
iter: 1  value: 53.93528 mgc: 5.899237 ustep: 1 
iter: 2  mgc: 1.292164e-10 
iter: 1  mgc: 1.292164e-10 
outer mgc:  1.670274e-05 
iter: 1  value: 51.83799 mgc: 8.107863 ustep: 1 
iter: 2  mgc: 8.014123e-11 
iter: 1  mgc: 8.014123e-11 
outer mgc:  9.529472e-06 
iter: 1  value: 50.10519 mgc: 5.609683 ustep: 1 
iter: 2  mgc: 3.453815e-10 
iter: 1  mgc: 3.453815e-10 
outer mgc:  8.950076e-06 
iter: 1  value: 48.00772 mgc: 5.518265 ustep: 1 
iter: 2  mgc: 4.045466e-10 
iter: 1  mgc: 4.045466e-10 
outer mgc:  7.138518e-06 
iter: 1  value: 46.2748 mgc: 4.173411 ustep: 1 
iter: 2  mgc: 4.05326e-10 
iter: 1  mgc: 4.05326e-10 
outer mgc:  3.359833e-06 
iter: 1  value: 44.17744 mgc: 5.620511 ustep: 1 
iter: 2  mgc: 1.096862e-09 
iter: 1  mgc: 1.096862e-09 
outer mgc:  2.084021e-06 
iter: 1  value: 42.44462 mgc: 4.306831 ustep: 1 
iter: 2  mgc: 7.800556e-10 
iter: 1  mgc: 7.800556e-10 
outer mgc:  2.328546e-06 
iter: 1  mgc: 7.800556e-10 
iter: 1  mgc: 7.800556e-10 
outer mgc:  2.328546e-06 
iter: 1  value: 42.44651 mgc: 0.05444265 ustep: 1 
iter: 2  value: 42.44651 mgc: 8.97559e-08 ustep: 1 
mgc: 5.680478e-10 
outer mgc:  0.4981507 
iter: 1  value: 42.44323 mgc: 0.05444502 ustep: 1 
iter: 2  value: 42.44323 mgc: 8.997237e-08 ustep: 1 
mgc: 1.094787e-09 
outer mgc:  0.4981719 
iter: 1  value: 42.44547 mgc: 0.02914191 ustep: 1 
iter: 2  value: 42.44547 mgc: 1.514284e-07 ustep: 1 
iter: 3  mgc: 1.170763e-09 
outer mgc:  0.254499 
iter: 1  value: 42.44403 mgc: 0.02914511 ustep: 1 
iter: 2  value: 42.44403 mgc: 1.514803e-07 ustep: 1 
mgc: 6.038707e-10 
outer mgc:  0.2545247 
iter: 1  value: 42.44377 mgc: 0.02737695 ustep: 1 
iter: 2  value: 42.44377 mgc: 3.207961e-06 ustep: 1 
iter: 3  mgc: 1.143548e-09 
outer mgc:  0.1241483 
iter: 1  value: 42.44556 mgc: 0.02736046 ustep: 1 
iter: 2  value: 42.44556 mgc: 3.208176e-06 ustep: 1 
iter: 3  mgc: 1.750242e-09 
outer mgc:  0.1241399 
iter: 1  value: 42.44426 mgc: 0.007810675 ustep: 1 
iter: 2  value: 42.44426 mgc: 2.65537e-07 ustep: 1 
iter: 3  mgc: 1.268417e-09 
outer mgc:  0.0453334 
iter: 1  value: 42.44503 mgc: 0.007803991 ustep: 1 
iter: 2  value: 42.44503 mgc: 2.651253e-07 ustep: 1 
iter: 3  mgc: 1.148569e-09 
outer mgc:  0.04530118 
iter: 1  value: 42.44461 mgc: 4.198527e-05 ustep: 1 
mgc: 6.927392e-10 
outer mgc:  2.328576e-06 
iter: 1  value: 42.44464 mgc: 4.198513e-05 ustep: 1 
mgc: 1.444715e-09 
outer mgc:  2.328714e-06 
iter: 1  value: 42.45459 mgc: 4947.89 ustep: 1 
iter: 2  value: 42.45459 mgc: 7.435684e-08 ustep: 1 
mgc: 1.412585e-09 
outer mgc:  0.002708541 
iter: 1  value: 42.43466 mgc: 4962.756 ustep: 1 
iter: 2  value: 42.43466 mgc: 7.46155e-08 ustep: 1 
mgc: 6.88273e-10 
outer mgc:  0.002705121 
iter: 1  value: 42.44798 mgc: 4952.84 ustep: 1 
iter: 2  value: 42.44798 mgc: 9.121261e-07 ustep: 1 
iter: 3  mgc: 7.991359e-10 
outer mgc:  0.01108824 
iter: 1  value: 42.44127 mgc: 4957.795 ustep: 1 
iter: 2  value: 42.44127 mgc: 9.127191e-07 ustep: 1 
iter: 3  mgc: 1.373762e-09 
outer mgc:  0.01108065 
[Fri Aug 13 09:05:58 2021]
Finished job 0.
1 of 1 steps (100%) done

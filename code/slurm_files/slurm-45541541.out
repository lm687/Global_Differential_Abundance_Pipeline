Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 01:27:22 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22233.715498 
iter  10 value 12326.377401
final  value 12325.632011 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 12122.74 mgc: 4.451314 ustep: 0.3596338 
iter: 2  value: 11927.55 mgc: 2.166718 ustep: 0.5997348 
iter: 3  value: 11886.53 mgc: 1.255592 ustep: 0.774448 
iter: 4  value: 11882.33 mgc: 0.2912513 ustep: 0.8800393 
iter: 5  value: 11882.16 mgc: 0.04297934 ustep: 0.9381103 
iter: 6  value: 11882.16 mgc: 0.004516859 ustep: 0.9685641 
iter: 7  value: 11882.16 mgc: 0.0002487626 ustep: 0.9841581 
iter: 8  value: 11882.16 mgc: 7.132989e-06 ustep: 0.9920482 
iter: 9  value: 11882.16 mgc: 1.105592e-07 ustep: 0.9960166 
iter: 10  mgc: 8.581209e-10 
iter: 1  mgc: 8.581209e-10 
Matching hessian patterns... Done
outer mgc:  196.5573 
iter: 1  value: 11847.91 mgc: 1.111517 ustep: 1 
iter: 2  value: 11845.12 mgc: 0.4390774 ustep: 1 
iter: 3  value: 11845.12 mgc: 0.01517723 ustep: 1 
iter: 4  value: 11845.12 mgc: 4.076369e-05 ustep: 1 
iter: 5  mgc: 2.724721e-10 
iter: 1  mgc: 2.724721e-10 
outer mgc:  121.9167 
iter: 1  value: 11748.28 mgc: 0.9312079 ustep: 1 
iter: 2  value: 11748.15 mgc: 0.1235918 ustep: 1 
iter: 3  value: 11748.15 mgc: 0.001916028 ustep: 1 
iter: 4  value: 11748.15 mgc: 9.403925e-07 ustep: 1 
iter: 5  mgc: 2.790546e-13 
iter: 1  mgc: 2.790546e-13 
outer mgc:  78.08872 
iter: 1  value: 11644.4 mgc: 1.797025 ustep: 1 
iter: 2  value: 11640.78 mgc: 0.597153 ustep: 1 
iter: 3  value: 11640.78 mgc: 0.0224722 ustep: 1 
iter: 4  value: 11640.78 mgc: 9.340598e-05 ustep: 1 
iter: 5  mgc: 1.588105e-09 
iter: 1  mgc: 1.588105e-09 
outer mgc:  98.39649 
iter: 1  value: 11480.66 mgc: 5.110713 ustep: 1 
iter: 2  value: 11465.17 mgc: 1.534627 ustep: 1 
iter: 3  value: 11465.04 mgc: 0.2273982 ustep: 1 
iter: 4  value: 11465.04 mgc: 0.003148752 ustep: 1 
iter: 5  value: 11465.04 mgc: 2.43603e-06 ustep: 1 
iter: 6  mgc: 1.500577e-12 
iter: 1  mgc: 1.500577e-12 
outer mgc:  197.1801 
iter: 1  value: 11272.51 mgc: 4.218389 ustep: 1 
iter: 2  value: 11235.45 mgc: 2.746335 ustep: 1 
iter: 3  value: 11234.96 mgc: 0.2185509 ustep: 1 
iter: 4  value: 11234.96 mgc: 0.01139493 ustep: 1 
iter: 5  value: 11234.96 mgc: 2.341041e-05 ustep: 1 
iter: 6  mgc: 1.030864e-10 
iter: 1  mgc: 1.030864e-10 
outer mgc:  60.80488 
iter: 1  value: 11074.74 mgc: 2.884958 ustep: 1 
iter: 2  value: 11074.33 mgc: 0.5293022 ustep: 1 
iter: 3  value: 11074.33 mgc: 0.02606882 ustep: 1 
iter: 4  value: 11074.33 mgc: 7.709461e-05 ustep: 1 
iter: 5  mgc: 6.837717e-10 
iter: 1  mgc: 6.837717e-10 
outer mgc:  54.91088 
iter: 1  value: 11345.95 mgc: 9.147639 ustep: 1 
iter: 2  value: 11345.86 mgc: 0.3866425 ustep: 1 
iter: 3  value: 11345.86 mgc: 0.002066786 ustep: 1 
iter: 4  value: 11345.86 mgc: 3.863561e-07 ustep: 1 
iter: 5  mgc: 1.110223e-14 
iter: 1  value: 11049.5 mgc: 1.180855 ustep: 1 
iter: 2  value: 11049.5 mgc: 0.01974306 ustep: 1 
iter: 3  value: 11049.5 mgc: 4.509455e-05 ustep: 1 
iter: 4  mgc: 2.162877e-10 
iter: 1  mgc: 2.162877e-10 
outer mgc:  36.34834 
iter: 1  value: 11028.8 mgc: 1.362761 ustep: 1 
iter: 2  value: 11028.8 mgc: 0.02204149 ustep: 1 
iter: 3  value: 11028.8 mgc: 4.289183e-05 ustep: 1 
iter: 4  mgc: 1.368456e-10 
iter: 1  mgc: 1.368456e-10 
outer mgc:  37.74224 
iter: 1  value: 10996.85 mgc: 2.215581 ustep: 1 
iter: 2  value: 10996.85 mgc: 0.02148041 ustep: 1 
iter: 3  value: 10996.85 mgc: 3.499328e-05 ustep: 1 
iter: 4  mgc: 7.563578e-11 
iter: 1  mgc: 7.563578e-11 
outer mgc:  81.50739 
iter: 1  value: 10967.91 mgc: 1.36916 ustep: 1 
iter: 2  value: 10967.91 mgc: 0.01448108 ustep: 1 
iter: 3  value: 10967.91 mgc: 8.861715e-07 ustep: 1 
iter: 4  mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  26.5801 
iter: 1  value: 10943.77 mgc: 1.019958 ustep: 1 
iter: 2  value: 10943.77 mgc: 0.00296863 ustep: 1 
iter: 3  value: 10943.77 mgc: 8.963236e-08 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  26.42237 
iter: 1  value: 10969.81 mgc: 3.281647 ustep: 1 
iter: 2  value: 10969.79 mgc: 0.2406618 ustep: 1 
iter: 3  value: 10969.79 mgc: 0.001319288 ustep: 1 
iter: 4  value: 10969.79 mgc: 6.862625e-08 ustep: 1 
iter: 5  mgc: 3.441691e-15 
iter: 1  value: 10940.37 mgc: 1.402001 ustep: 1 
iter: 2  value: 10940.37 mgc: 0.01254372 ustep: 1 
iter: 3  value: 10940.37 mgc: 4.78924e-06 ustep: 1 
iter: 4  mgc: 8.126833e-13 
iter: 1  mgc: 8.126833e-13 
outer mgc:  27.05891 
iter: 1  value: 10923.02 mgc: 1.300589 ustep: 1 
iter: 2  value: 10923.02 mgc: 0.009072146 ustep: 1 
iter: 3  value: 10923.02 mgc: 2.610149e-06 ustep: 1 
iter: 4  mgc: 1.656453e-13 
iter: 1  mgc: 1.656453e-13 
outer mgc:  15.07268 
iter: 1  value: 10909.77 mgc: 1.466633 ustep: 1 
iter: 2  value: 10909.77 mgc: 0.01015847 ustep: 1 
iter: 3  value: 10909.77 mgc: 5.274704e-07 ustep: 1 
iter: 4  mgc: 1.010303e-14 
iter: 1  mgc: 1.010303e-14 
outer mgc:  35.50959 
iter: 1  value: 10905.82 mgc: 1.606298 ustep: 1 
iter: 2  value: 10905.82 mgc: 0.006713182 ustep: 1 
iter: 3  value: 10905.82 mgc: 1.559674e-07 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  50.19715 
iter: 1  value: 10903.4 mgc: 1.101402 ustep: 1 
iter: 2  value: 10903.4 mgc: 0.005214871 ustep: 1 
iter: 3  value: 10903.4 mgc: 3.328247e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  14.73996 
iter: 1  value: 10897.76 mgc: 0.6163314 ustep: 1 
iter: 2  value: 10897.76 mgc: 0.001894695 ustep: 1 
iter: 3  value: 10897.76 mgc: 5.801521e-08 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  19.89428 
iter: 1  value: 10898.26 mgc: 0.6276344 ustep: 1 
iter: 2  value: 10898.26 mgc: 0.002367765 ustep: 1 
iter: 3  value: 10898.26 mgc: 1.850639e-07 ustep: 1 
iter: 4  mgc: 4.218847e-15 
iter: 1  mgc: 4.218847e-15 
outer mgc:  20.36248 
iter: 1  value: 10899.95 mgc: 1.664172 ustep: 1 
iter: 2  value: 10899.95 mgc: 0.003991886 ustep: 1 
iter: 3  value: 10899.95 mgc: 1.211939e-07 ustep: 1 
iter: 4  mgc: 3.580469e-15 
iter: 1  value: 10896.64 mgc: 0.598655 ustep: 1 
iter: 2  value: 10896.64 mgc: 0.0005563937 ustep: 1 
iter: 3  mgc: 2.961807e-09 
iter: 1  mgc: 2.961807e-09 
outer mgc:  20.57476 
iter: 1  value: 10891.83 mgc: 0.4209663 ustep: 1 
iter: 2  value: 10891.83 mgc: 0.0002098758 ustep: 1 
iter: 3  mgc: 2.064617e-10 
iter: 1  mgc: 2.064617e-10 
outer mgc:  7.550283 
iter: 1  value: 10881.92 mgc: 0.584822 ustep: 1 
iter: 2  value: 10881.92 mgc: 0.0006994705 ustep: 1 
iter: 3  mgc: 2.989792e-09 
iter: 1  mgc: 2.989792e-09 
outer mgc:  4.293742 
iter: 1  value: 10853.56 mgc: 4.083758 ustep: 1 
iter: 2  value: 10853.56 mgc: 0.01662875 ustep: 1 
iter: 3  value: 10853.56 mgc: 6.641833e-06 ustep: 1 
iter: 4  mgc: 8.935075e-13 
iter: 1  mgc: 8.935075e-13 
outer mgc:  13.8367 
iter: 1  value: 10841.6 mgc: 0.9668286 ustep: 1 
iter: 2  value: 10841.6 mgc: 0.001216179 ustep: 1 
iter: 3  value: 10841.6 mgc: 2.359011e-08 ustep: 1 
mgc: 5.440093e-15 
iter: 1  mgc: 5.440093e-15 
outer mgc:  6.631286 
iter: 1  value: 10831.98 mgc: 1.433565 ustep: 1 
iter: 2  value: 10831.98 mgc: 0.0009056694 ustep: 1 
iter: 3  mgc: 1.814564e-09 
iter: 1  mgc: 1.814564e-09 
outer mgc:  2.959712 
iter: 1  value: 10826.03 mgc: 0.9879073 ustep: 1 
iter: 2  value: 10826.03 mgc: 0.0005882231 ustep: 1 
iter: 3  mgc: 3.725903e-09 
iter: 1  mgc: 3.725903e-09 
outer mgc:  2.171782 
iter: 1  value: 10821.07 mgc: 1.364352 ustep: 1 
iter: 2  value: 10821.07 mgc: 0.0008715722 ustep: 1 
iter: 3  value: 10821.07 mgc: 1.060984e-08 ustep: 1 
mgc: 4.996004e-15 
iter: 1  mgc: 4.996004e-15 
outer mgc:  0.9246904 
iter: 1  value: 10814.83 mgc: 0.5417816 ustep: 1 
iter: 2  value: 10814.83 mgc: 0.0001005891 ustep: 1 
iter: 3  mgc: 1.286748e-10 
iter: 1  mgc: 1.286748e-10 
outer mgc:  0.5942077 
iter: 1  value: 10812.06 mgc: 0.4612718 ustep: 1 
iter: 2  value: 10812.06 mgc: 2.961702e-05 ustep: 1 
iter: 3  mgc: 9.359402e-12 
iter: 1  mgc: 9.359402e-12 
outer mgc:  0.2607702 
iter: 1  value: 10803.72 mgc: 0.8941933 ustep: 1 
iter: 2  value: 10803.72 mgc: 7.136864e-05 ustep: 1 
iter: 3  mgc: 6.132783e-11 
iter: 1  mgc: 6.132783e-11 
outer mgc:  0.3389077 
iter: 1  value: 10785.61 mgc: 1.653867 ustep: 1 
iter: 2  value: 10785.61 mgc: 0.0001174324 ustep: 1 
iter: 3  mgc: 5.493828e-12 
iter: 1  mgc: 5.493828e-12 
outer mgc:  0.1853032 
iter: 1  value: 10769.69 mgc: 1.526506 ustep: 1 
iter: 2  value: 10769.69 mgc: 4.87256e-05 ustep: 1 
iter: 3  mgc: 1.17284e-12 
iter: 1  mgc: 1.17284e-12 
outer mgc:  0.1370972 
iter: 1  value: 10747.35 mgc: 1.908048 ustep: 1 
iter: 2  value: 10747.35 mgc: 6.013725e-05 ustep: 1 
iter: 3  mgc: 8.473e-11 
iter: 1  mgc: 8.473e-11 
outer mgc:  0.09730813 
iter: 1  value: 10731.96 mgc: 2.421976 ustep: 1 
iter: 2  value: 10731.96 mgc: 3.064675e-05 ustep: 1 
iter: 3  mgc: 8.915535e-12 
iter: 1  mgc: 8.915535e-12 
outer mgc:  0.04802661 
iter: 1  value: 10716.05 mgc: 1.511202 ustep: 1 
iter: 2  value: 10716.05 mgc: 2.62912e-05 ustep: 1 
iter: 3  mgc: 1.156053e-11 
iter: 1  mgc: 1.156053e-11 
outer mgc:  0.0852306 
iter: 1  value: 10694.89 mgc: 2.469208 ustep: 1 
iter: 2  value: 10694.89 mgc: 9.420084e-06 ustep: 1 
iter: 3  mgc: 1.617817e-12 
iter: 1  mgc: 1.617817e-12 
outer mgc:  0.03037161 
iter: 1  value: 10676.99 mgc: 1.518228 ustep: 1 
iter: 2  value: 10676.99 mgc: 1.438121e-06 ustep: 1 
iter: 3  mgc: 8.361367e-14 
iter: 1  mgc: 8.361367e-14 
outer mgc:  0.02220581 
iter: 1  value: 10657.08 mgc: 1.807663 ustep: 1 
iter: 2  value: 10657.08 mgc: 9.722233e-07 ustep: 1 
iter: 3  mgc: 2.047251e-13 
iter: 1  mgc: 2.047251e-13 
outer mgc:  0.01776281 
iter: 1  value: 10640.32 mgc: 1.488387 ustep: 1 
iter: 2  value: 10640.32 mgc: 2.790294e-07 ustep: 1 
iter: 3  mgc: 2.267075e-13 
iter: 1  mgc: 2.267075e-13 
outer mgc:  0.01593875 
iter: 1  value: 10619.19 mgc: 2.224284 ustep: 1 
iter: 2  value: 10619.19 mgc: 2.308247e-07 ustep: 1 
iter: 3  mgc: 3.370637e-13 
iter: 1  mgc: 3.370637e-13 
outer mgc:  0.00765849 
iter: 1  value: 10601.73 mgc: 1.806433 ustep: 1 
iter: 2  value: 10601.73 mgc: 9.237613e-08 ustep: 1 
iter: 3  mgc: 8.698597e-13 
iter: 1  mgc: 8.698597e-13 
outer mgc:  0.004625286 
iter: 1  value: 10580.95 mgc: 2.151015 ustep: 1 
iter: 2  value: 10580.95 mgc: 4.338915e-08 ustep: 1 
mgc: 7.287504e-13 
iter: 1  mgc: 7.287504e-13 
outer mgc:  0.005096034 
iter: 1  value: 10563.77 mgc: 1.549077 ustep: 1 
iter: 2  value: 10563.77 mgc: 1.488479e-08 ustep: 1 
mgc: 8.769652e-13 
iter: 1  mgc: 8.769652e-13 
outer mgc:  0.003848268 
iter: 1  value: 10542.79 mgc: 1.797254 ustep: 1 
iter: 2  value: 10542.79 mgc: 1.288255e-08 ustep: 1 
mgc: 1.477707e-12 
iter: 1  mgc: 1.477707e-12 
outer mgc:  0.001876154 
iter: 1  value: 10525.44 mgc: 1.42877 ustep: 1 
iter: 2  mgc: 4.986319e-09 
iter: 1  mgc: 4.986319e-09 
outer mgc:  0.0009518832 
iter: 1  value: 10504.54 mgc: 1.87073 ustep: 1 
iter: 2  mgc: 2.018654e-09 
iter: 1  mgc: 2.018654e-09 
outer mgc:  0.001244386 
iter: 1  value: 10487.25 mgc: 1.715169 ustep: 1 
iter: 2  mgc: 6.674021e-10 
iter: 1  mgc: 6.674021e-10 
outer mgc:  0.0008811648 
iter: 1  value: 10466.26 mgc: 2.336128 ustep: 1 
iter: 2  mgc: 8.588952e-10 
iter: 1  mgc: 8.588952e-10 
outer mgc:  0.0002841625 
iter: 1  value: 10448.92 mgc: 1.860355 ustep: 1 
iter: 2  mgc: 2.541602e-10 
iter: 1  mgc: 2.541602e-10 
outer mgc:  0.000313562 
iter: 1  value: 10427.96 mgc: 2.109539 ustep: 1 
iter: 2  mgc: 9.689449e-11 
iter: 1  mgc: 9.689449e-11 
outer mgc:  0.0003092075 
iter: 1  value: 10410.65 mgc: 1.451044 ustep: 1 
iter: 2  mgc: 4.123724e-11 
iter: 1  mgc: 4.123724e-11 
outer mgc:  0.0001984234 
iter: 1  mgc: 4.123724e-11 
iter: 1  mgc: 4.123724e-11 
outer mgc:  0.0001984234 
iter: 1  value: 10410.65 mgc: 0.003616531 ustep: 1 
iter: 2  value: 10410.65 mgc: 5.318784e-08 ustep: 1 
iter: 3  mgc: 2.951772e-11 
outer mgc:  0.2624454 
iter: 1  value: 10410.64 mgc: 0.003616676 ustep: 1 
iter: 2  value: 10410.64 mgc: 5.308729e-08 ustep: 1 
iter: 3  mgc: 2.984657e-11 
outer mgc:  0.2621981 
iter: 1  value: 10410.65 mgc: 0.001148388 ustep: 1 
iter: 2  mgc: 1.532046e-09 
outer mgc:  0.07178634 
iter: 1  value: 10410.65 mgc: 0.00114932 ustep: 1 
iter: 2  mgc: 1.528506e-09 
outer mgc:  0.07173502 
iter: 1  value: 10410.65 mgc: 0.003686987 ustep: 1 
iter: 2  mgc: 2.252587e-09 
outer mgc:  0.2203993 
iter: 1  value: 10410.64 mgc: 0.003684869 ustep: 1 
iter: 2  mgc: 2.250924e-09 
outer mgc:  0.2199418 
iter: 1  value: 10410.65 mgc: 0.001075286 ustep: 1 
iter: 2  mgc: 8.582854e-10 
outer mgc:  0.06736268 
iter: 1  value: 10410.65 mgc: 0.001074399 ustep: 1 
iter: 2  mgc: 8.509868e-10 
outer mgc:  0.06705272 
iter: 1  value: 10410.72 mgc: 103.3009 ustep: 1 
iter: 2  value: 10410.72 mgc: 3.448697e-07 ustep: 1 
iter: 3  mgc: 2.665757e-11 
outer mgc:  0.01927908 
iter: 1  value: 10410.57 mgc: 103.4043 ustep: 1 
iter: 2  value: 10410.57 mgc: 3.442559e-07 ustep: 1 
iter: 3  mgc: 1.659062e-11 
outer mgc:  0.01887423 
iter: 1  value: 10410.75 mgc: 103.1994 ustep: 1 
iter: 2  value: 10410.75 mgc: 1.541354e-07 ustep: 1 
iter: 3  mgc: 2.897149e-11 
outer mgc:  0.006992143 
iter: 1  value: 10410.55 mgc: 103.5095 ustep: 1 
iter: 2  value: 10410.55 mgc: 1.537858e-07 ustep: 1 
iter: 3  mgc: 2.536171e-11 
outer mgc:  0.006978305 
iter: 1  value: 10410.65 mgc: 5.304229e-05 ustep: 1 
mgc: 2.143419e-11 
outer mgc:  0.0001984203 
iter: 1  value: 10410.65 mgc: 5.304207e-05 ustep: 1 
mgc: 2.013278e-11 
outer mgc:  0.0001984265 
iter: 1  value: 10410.64 mgc: 0.003583822 ustep: 1 
iter: 2  value: 10410.64 mgc: 7.026551e-08 ustep: 1 
iter: 3  mgc: 3.624812e-11 
outer mgc:  0.1150737 
iter: 1  value: 10410.66 mgc: 0.00358159 ustep: 1 
iter: 2  value: 10410.66 mgc: 7.007509e-08 ustep: 1 
iter: 3  mgc: 1.654943e-11 
outer mgc:  0.1154485 
[Sat Aug 14 01:27:28 2021]
Finished job 0.
1 of 1 steps (100%) done

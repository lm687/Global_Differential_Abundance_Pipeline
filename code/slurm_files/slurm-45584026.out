Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:14:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_4_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_4_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_80_4_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=80, d=4, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_4_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_4_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_4_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_4_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_4_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2834.971968 
iter  10 value 2634.703179
iter  10 value 2634.703179
iter  10 value 2634.703179
final  value 2634.703179 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 558.4807 mgc: 88.63505 ustep: 1 
iter: 2  value: 490.8299 mgc: 60.29672 ustep: 1 
iter: 3  value: 434.3251 mgc: 57.18283 ustep: 0.2494656 
iter: 4  value: 379.0076 mgc: 48.70714 ustep: 0.1588666 
iter: 5  value: 292.6575 mgc: 104.7818 ustep: 0.3986409 
iter: 6  value: 266.5029 mgc: 38.43484 ustep: 0.631417 
iter: 7  value: 227.9663 mgc: 55.56913 ustep: 0.7946381 
iter: 8  value: 226.295 mgc: 6.762387 ustep: 0.8914356 
iter: 9  value: 226.286 mgc: 0.6353455 ustep: 0.9441643 
iter: 10  value: 226.286 mgc: 0.005918633 ustep: 0.971684 
iter: 11  value: 226.286 mgc: 7.581427e-06 ustep: 0.9857417 
iter: 12  mgc: 5.208424e-09 
iter: 1  mgc: 5.208424e-09 
Matching hessian patterns... Done
outer mgc:  23.84607 
iter: 1  value: 234.9702 mgc: 7.167854 ustep: 1 
iter: 2  value: 234.898 mgc: 0.7989825 ustep: 1 
iter: 3  value: 234.898 mgc: 0.008487858 ustep: 1 
iter: 4  value: 234.898 mgc: 1.254926e-06 ustep: 1 
iter: 5  mgc: 2.842171e-14 
iter: 1  value: 219.0563 mgc: 2.945651 ustep: 1 
iter: 2  value: 219.0549 mgc: 0.1092781 ustep: 1 
iter: 3  value: 219.0549 mgc: 0.0001567327 ustep: 1 
iter: 4  mgc: 4.219309e-10 
iter: 1  mgc: 4.219309e-10 
outer mgc:  11.12044 
iter: 1  value: 216.0373 mgc: 17.66237 ustep: 1 
iter: 2  value: 215.9669 mgc: 0.6477213 ustep: 1 
iter: 3  value: 215.9669 mgc: 0.004222235 ustep: 1 
iter: 4  value: 215.9669 mgc: 4.063678e-07 ustep: 1 
iter: 5  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  21.07639 
iter: 1  value: 209.6826 mgc: 2.719158 ustep: 1 
iter: 2  value: 209.6812 mgc: 0.09834848 ustep: 1 
iter: 3  value: 209.6812 mgc: 0.0001640828 ustep: 1 
iter: 4  mgc: 4.595387e-10 
iter: 1  mgc: 4.595387e-10 
outer mgc:  9.160139 
iter: 1  value: 199.1068 mgc: 24.03734 ustep: 1 
iter: 2  value: 198.8038 mgc: 1.26616 ustep: 1 
iter: 3  value: 198.8037 mgc: 0.02114601 ustep: 1 
iter: 4  value: 198.8037 mgc: 1.164507e-05 ustep: 1 
iter: 5  mgc: 3.543332e-12 
iter: 1  value: 183.9887 mgc: 33.76704 ustep: 1 
iter: 2  value: 182.3759 mgc: 4.494847 ustep: 1 
iter: 3  value: 182.3746 mgc: 0.15856 ustep: 1 
iter: 4  value: 182.3746 mgc: 0.0002595454 ustep: 1 
iter: 5  mgc: 9.685226e-10 
iter: 1  mgc: 9.685226e-10 
outer mgc:  27.38061 
iter: 1  value: 328.2739 mgc: 89.39185 ustep: 1 
iter: 2  value: 296.3599 mgc: 19.46475 ustep: 1 
iter: 3  value: 296.2868 mgc: 0.974263 ustep: 1 
iter: 4  value: 296.2868 mgc: 0.00525003 ustep: 1 
iter: 5  value: 296.2868 mgc: 1.81404e-07 ustep: 1 
mgc: 3.197442e-14 
iter: 1  value: 179.3717 mgc: 15.9141 ustep: 1 
iter: 2  value: 179.3197 mgc: 1.130753 ustep: 1 
iter: 3  value: 179.3197 mgc: 0.004094959 ustep: 1 
iter: 4  value: 179.3197 mgc: 5.497114e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  18.82299 
iter: 1  value: 174.196 mgc: 8.124191 ustep: 1 
iter: 2  value: 174.173 mgc: 0.5407903 ustep: 1 
iter: 3  value: 174.173 mgc: 0.002089241 ustep: 1 
iter: 4  value: 174.173 mgc: 3.205321e-08 ustep: 1 
mgc: 2.675637e-14 
iter: 1  mgc: 2.675637e-14 
outer mgc:  7.240057 
iter: 1  value: 171.6396 mgc: 9.451365 ustep: 1 
iter: 2  value: 171.6309 mgc: 0.3181028 ustep: 1 
iter: 3  value: 171.6309 mgc: 0.000710976 ustep: 1 
iter: 4  mgc: 5.516728e-09 
iter: 1  mgc: 5.516728e-09 
outer mgc:  7.146973 
iter: 1  value: 169.6717 mgc: 10.79875 ustep: 1 
iter: 2  value: 169.6693 mgc: 0.2282181 ustep: 1 
iter: 3  value: 169.6693 mgc: 0.0001561106 ustep: 1 
iter: 4  mgc: 1.088805e-10 
iter: 1  mgc: 1.088805e-10 
outer mgc:  10.21248 
iter: 1  value: 169.8004 mgc: 8.380063 ustep: 1 
iter: 2  value: 169.7987 mgc: 0.1661135 ustep: 1 
iter: 3  value: 169.7987 mgc: 8.577389e-05 ustep: 1 
iter: 4  mgc: 2.39585e-11 
iter: 1  value: 169.0935 mgc: 4.024532 ustep: 1 
iter: 2  value: 169.0934 mgc: 0.03698132 ustep: 1 
iter: 3  value: 169.0934 mgc: 3.163498e-06 ustep: 1 
iter: 4  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  7.230932 
iter: 1  value: 168.2674 mgc: 2.922869 ustep: 1 
iter: 2  value: 168.2674 mgc: 0.02008215 ustep: 1 
iter: 3  value: 168.2674 mgc: 2.923108e-06 ustep: 1 
iter: 4  mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  1.858211 
iter: 1  value: 168.0978 mgc: 2.577165 ustep: 1 
iter: 2  value: 168.0978 mgc: 0.009928921 ustep: 1 
iter: 3  value: 168.0978 mgc: 4.384249e-07 ustep: 1 
iter: 4  mgc: 1.854072e-14 
iter: 1  value: 168.1364 mgc: 1.197645 ustep: 1 
iter: 2  value: 168.1364 mgc: 0.002631659 ustep: 1 
iter: 3  value: 168.1364 mgc: 4.718355e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  1.20211 
iter: 1  value: 168.2724 mgc: 1.251103 ustep: 1 
iter: 2  value: 168.2724 mgc: 0.005352514 ustep: 1 
iter: 3  value: 168.2724 mgc: 2.461823e-07 ustep: 1 
iter: 4  mgc: 2.825518e-14 
iter: 1  mgc: 2.825518e-14 
outer mgc:  2.210699 
iter: 1  value: 168.1368 mgc: 1.17463 ustep: 1 
iter: 2  value: 168.1368 mgc: 0.00330468 ustep: 1 
iter: 3  value: 168.1368 mgc: 3.976408e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.4703292 
iter: 1  value: 167.8444 mgc: 0.7812673 ustep: 1 
iter: 2  value: 167.8444 mgc: 0.003124342 ustep: 1 
iter: 3  value: 167.8444 mgc: 6.250289e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.753507 
iter: 1  value: 167.8004 mgc: 0.8239552 ustep: 1 
iter: 2  value: 167.8004 mgc: 0.001616269 ustep: 1 
iter: 3  mgc: 6.722537e-09 
iter: 1  mgc: 6.722537e-09 
outer mgc:  0.3414788 
iter: 1  value: 167.8877 mgc: 0.9640782 ustep: 1 
iter: 2  value: 167.8877 mgc: 0.001093746 ustep: 1 
iter: 3  mgc: 7.728151e-09 
iter: 1  mgc: 7.728151e-09 
outer mgc:  0.4453828 
iter: 1  value: 168.0419 mgc: 1.576082 ustep: 1 
iter: 2  value: 168.0419 mgc: 0.00769849 ustep: 1 
iter: 3  value: 168.0419 mgc: 4.137672e-07 ustep: 1 
iter: 4  mgc: 1.654232e-14 
iter: 1  value: 167.9184 mgc: 0.4084461 ustep: 1 
iter: 2  value: 167.9184 mgc: 0.0002759311 ustep: 1 
iter: 3  mgc: 4.9087e-10 
iter: 1  mgc: 4.9087e-10 
outer mgc:  0.701823 
iter: 1  value: 167.9447 mgc: 0.3461776 ustep: 1 
iter: 2  value: 167.9447 mgc: 0.0002776569 ustep: 1 
iter: 3  mgc: 1.220859e-10 
iter: 1  mgc: 1.220859e-10 
outer mgc:  0.53389 
iter: 1  value: 167.943 mgc: 0.1616152 ustep: 1 
iter: 2  value: 167.943 mgc: 0.0001063438 ustep: 1 
iter: 3  mgc: 9.698464e-11 
iter: 1  mgc: 9.698464e-11 
outer mgc:  0.1720459 
iter: 1  value: 167.913 mgc: 0.1799349 ustep: 1 
iter: 2  value: 167.913 mgc: 0.0002100602 ustep: 1 
iter: 3  mgc: 8.959278e-11 
iter: 1  mgc: 8.959278e-11 
outer mgc:  0.1608357 
iter: 1  value: 167.9337 mgc: 0.2130533 ustep: 1 
iter: 2  value: 167.9337 mgc: 9.29311e-05 ustep: 1 
iter: 3  mgc: 3.970424e-11 
iter: 1  mgc: 3.970424e-11 
outer mgc:  0.1184876 
iter: 1  value: 167.9516 mgc: 0.2600836 ustep: 1 
iter: 2  value: 167.9516 mgc: 0.0002221365 ustep: 1 
iter: 3  mgc: 3.989573e-10 
iter: 1  mgc: 3.989573e-10 
outer mgc:  0.1581055 
iter: 1  value: 167.976 mgc: 0.1952652 ustep: 1 
iter: 2  value: 167.976 mgc: 0.0001195294 ustep: 1 
iter: 3  mgc: 7.170087e-11 
iter: 1  mgc: 7.170087e-11 
outer mgc:  0.2052798 
iter: 1  value: 168.0193 mgc: 0.1752342 ustep: 1 
iter: 2  value: 168.0193 mgc: 4.190689e-05 ustep: 1 
iter: 3  mgc: 4.567902e-12 
iter: 1  mgc: 4.567902e-12 
outer mgc:  0.04227368 
iter: 1  value: 168.0142 mgc: 0.1409055 ustep: 1 
iter: 2  value: 168.0142 mgc: 4.179148e-05 ustep: 1 
iter: 3  mgc: 3.93019e-12 
iter: 1  mgc: 3.93019e-12 
outer mgc:  0.1398343 
iter: 1  value: 168.0542 mgc: 0.1015402 ustep: 1 
iter: 2  value: 168.0542 mgc: 1.892801e-05 ustep: 1 
iter: 3  mgc: 8.499867e-13 
iter: 1  mgc: 8.499867e-13 
outer mgc:  0.05078176 
iter: 1  value: 168.076 mgc: 0.0613123 ustep: 1 
iter: 2  value: 168.076 mgc: 6.361244e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
iter: 1  mgc: 9.325873e-14 
outer mgc:  0.01675724 
iter: 1  value: 168.115 mgc: 0.08895495 ustep: 1 
iter: 2  value: 168.115 mgc: 1.639708e-05 ustep: 1 
iter: 3  mgc: 6.146195e-13 
iter: 1  mgc: 6.146195e-13 
outer mgc:  0.02270897 
iter: 1  value: 168.1305 mgc: 0.06143568 ustep: 1 
iter: 2  value: 168.1305 mgc: 8.210219e-06 ustep: 1 
iter: 3  mgc: 1.412204e-13 
iter: 1  mgc: 1.412204e-13 
outer mgc:  0.019444 
iter: 1  value: 168.1233 mgc: 0.02830935 ustep: 1 
iter: 2  value: 168.1233 mgc: 1.303626e-06 ustep: 1 
iter: 3  mgc: 1.332268e-14 
iter: 1  mgc: 1.332268e-14 
outer mgc:  0.004500693 
iter: 1  value: 168.1202 mgc: 0.01120481 ustep: 1 
iter: 2  value: 168.1202 mgc: 4.177012e-07 ustep: 1 
iter: 3  mgc: 2.045586e-14 
iter: 1  mgc: 2.045586e-14 
outer mgc:  0.004614058 
iter: 1  value: 168.1222 mgc: 0.005291855 ustep: 1 
iter: 2  value: 168.1222 mgc: 8.890546e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  0.0001388869 
iter: 1  value: 168.1222 mgc: 8.98736e-05 ustep: 1 
iter: 2  mgc: 2.165279e-11 
iter: 1  mgc: 2.165279e-11 
outer mgc:  3.512649e-05 
iter: 1  mgc: 2.165279e-11 
iter: 1  mgc: 2.165279e-11 
outer mgc:  3.512649e-05 
iter: 1  value: 168.1222 mgc: 0.04402524 ustep: 1 
iter: 2  value: 168.1222 mgc: 6.276028e-06 ustep: 1 
iter: 3  mgc: 1.576517e-13 
outer mgc:  0.08457349 
iter: 1  value: 168.1222 mgc: 0.0440054 ustep: 1 
iter: 2  value: 168.1222 mgc: 6.279666e-06 ustep: 1 
iter: 3  mgc: 1.650069e-13 
outer mgc:  0.08458039 
iter: 1  value: 168.1222 mgc: 0.02216236 ustep: 1 
iter: 2  value: 168.1222 mgc: 1.486173e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.1058206 
iter: 1  value: 168.1222 mgc: 0.02215409 ustep: 1 
iter: 2  value: 168.1222 mgc: 1.485742e-06 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.1058122 
iter: 1  value: 168.1223 mgc: 0.05470424 ustep: 1 
iter: 2  value: 168.1223 mgc: 7.422699e-06 ustep: 1 
iter: 3  mgc: 3.512746e-13 
outer mgc:  0.04082065 
iter: 1  value: 168.1221 mgc: 0.05469235 ustep: 1 
iter: 2  value: 168.1221 mgc: 7.432488e-06 ustep: 1 
iter: 3  mgc: 3.641532e-13 
outer mgc:  0.04080513 
iter: 1  value: 168.1222 mgc: 0.0268118 ustep: 1 
iter: 2  value: 168.1222 mgc: 1.595424e-06 ustep: 1 
iter: 3  mgc: 1.754152e-14 
outer mgc:  0.1256132 
iter: 1  value: 168.1222 mgc: 0.02680956 ustep: 1 
iter: 2  value: 168.1222 mgc: 1.595465e-06 ustep: 1 
iter: 3  mgc: 2.353673e-14 
outer mgc:  0.125537 
iter: 1  value: 168.122 mgc: 0.02360006 ustep: 1 
iter: 2  value: 168.122 mgc: 1.28921e-06 ustep: 1 
iter: 3  mgc: 1.24345e-14 
outer mgc:  0.1208187 
iter: 1  value: 168.1224 mgc: 0.0235827 ustep: 1 
iter: 2  value: 168.1224 mgc: 1.287824e-06 ustep: 1 
iter: 3  mgc: 1.465494e-14 
outer mgc:  0.1208014 
iter: 1  value: 168.1221 mgc: 0.01176572 ustep: 1 
iter: 2  value: 168.1221 mgc: 3.201889e-07 ustep: 1 
iter: 3  mgc: 2.220446e-14 
outer mgc:  0.07863674 
iter: 1  value: 168.1223 mgc: 0.0117572 ustep: 1 
iter: 2  value: 168.1223 mgc: 3.197965e-07 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.07861135 
iter: 1  value: 168.1221 mgc: 0.008095572 ustep: 1 
iter: 2  value: 168.1221 mgc: 2.318583e-07 ustep: 1 
iter: 3  mgc: 3.663736e-14 
outer mgc:  0.008797584 
iter: 1  value: 168.1222 mgc: 0.008093852 ustep: 1 
iter: 2  value: 168.1222 mgc: 2.316627e-07 ustep: 1 
iter: 3  mgc: 2.120526e-14 
outer mgc:  0.008795306 
iter: 1  value: 168.1194 mgc: 0.005986949 ustep: 1 
iter: 2  value: 168.1194 mgc: 6.232716e-08 ustep: 1 
mgc: 1.998401e-14 
outer mgc:  0.0008263411 
iter: 1  value: 168.1249 mgc: 0.005982579 ustep: 1 
iter: 2  value: 168.1249 mgc: 6.237505e-08 ustep: 1 
mgc: 2.176037e-14 
outer mgc:  0.0008428873 
iter: 1  value: 168.1216 mgc: 0.01045675 ustep: 1 
iter: 2  value: 168.1216 mgc: 1.966763e-07 ustep: 1 
mgc: 4.218847e-14 
outer mgc:  0.002302811 
iter: 1  value: 168.1228 mgc: 0.01045059 ustep: 1 
iter: 2  value: 168.1228 mgc: 1.965324e-07 ustep: 1 
mgc: 1.354472e-14 
outer mgc:  0.002304478 
iter: 1  value: 168.1246 mgc: 0.01873831 ustep: 1 
iter: 2  value: 168.1246 mgc: 1.016894e-06 ustep: 1 
iter: 3  mgc: 1.365574e-14 
outer mgc:  0.01908642 
iter: 1  value: 168.1197 mgc: 0.01878818 ustep: 1 
iter: 2  value: 168.1197 mgc: 1.019114e-06 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.01907794 
iter: 1  value: 168.1231 mgc: 0.01023496 ustep: 1 
iter: 2  value: 168.1231 mgc: 5.457461e-07 ustep: 1 
iter: 3  mgc: 1.64313e-14 
outer mgc:  0.01900785 
iter: 1  value: 168.1213 mgc: 0.0102452 ustep: 1 
iter: 2  value: 168.1213 mgc: 5.477637e-07 ustep: 1 
iter: 3  mgc: 1.587619e-14 
outer mgc:  0.01902218 
iter: 1  value: 168.1285 mgc: 0.02910217 ustep: 1 
iter: 2  value: 168.1285 mgc: 1.776948e-06 ustep: 1 
iter: 3  mgc: 1.84297e-14 
outer mgc:  0.01321763 
iter: 1  value: 168.1158 mgc: 0.02917879 ustep: 1 
iter: 2  value: 168.1158 mgc: 1.77661e-06 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.01320415 
[Sun Aug 15 20:14:45 2021]
Finished job 0.
1 of 1 steps (100%) done

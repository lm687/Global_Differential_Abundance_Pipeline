Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:03:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11103.674402 
iter  10 value 8616.793902
final  value 8565.203877 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 9056.998 mgc: 3.232139 ustep: 1 
iter: 2  value: 9055.454 mgc: 0.720561 ustep: 1 
iter: 3  value: 9055.452 mgc: 0.04692666 ustep: 1 
iter: 4  value: 9055.452 mgc: 0.0001217018 ustep: 1 
iter: 5  mgc: 8.866121e-10 
iter: 1  mgc: 8.866121e-10 
Matching hessian patterns... Done
outer mgc:  50.83037 
iter: 1  value: 9001.57 mgc: 1.278027 ustep: 1 
iter: 2  value: 9001.388 mgc: 0.1456971 ustep: 1 
iter: 3  value: 9001.387 mgc: 0.003384913 ustep: 1 
iter: 4  value: 9001.387 mgc: 2.160199e-06 ustep: 1 
iter: 5  mgc: 8.46434e-13 
iter: 1  mgc: 8.46434e-13 
outer mgc:  50.78621 
iter: 1  value: 8950.67 mgc: 1.044583 ustep: 1 
iter: 2  value: 8950.402 mgc: 0.1932291 ustep: 1 
iter: 3  value: 8950.401 mgc: 0.003236438 ustep: 1 
iter: 4  value: 8950.401 mgc: 2.889578e-06 ustep: 1 
iter: 5  mgc: 1.893374e-12 
iter: 1  mgc: 1.893374e-12 
outer mgc:  59.31214 
iter: 1  value: 8818.337 mgc: 3.23643 ustep: 1 
iter: 2  value: 8816.222 mgc: 0.5332039 ustep: 1 
iter: 3  value: 8816.217 mgc: 0.0493474 ustep: 1 
iter: 4  value: 8816.217 mgc: 0.0002674159 ustep: 1 
iter: 5  value: 8816.217 mgc: 1.242342e-08 ustep: 1 
iter: 6  mgc: 2.442491e-15 
iter: 1  value: 8708.284 mgc: 3.29924 ustep: 1 
iter: 2  value: 8705.904 mgc: 0.7176275 ustep: 1 
iter: 3  value: 8705.901 mgc: 0.03130877 ustep: 1 
iter: 4  value: 8705.901 mgc: 3.418844e-05 ustep: 1 
iter: 5  mgc: 1.029439e-10 
iter: 1  mgc: 1.029439e-10 
outer mgc:  47.1414 
iter: 1  value: 8734.875 mgc: 66.7269 ustep: 1 
iter: 2  value: 8733.634 mgc: 1.295075 ustep: 1 
iter: 3  value: 8733.634 mgc: 0.03170789 ustep: 1 
iter: 4  value: 8733.634 mgc: 2.369153e-05 ustep: 1 
iter: 5  mgc: 1.30651e-11 
iter: 1  value: 8637.866 mgc: 8.643168 ustep: 1 
iter: 2  value: 8637.719 mgc: 0.3111993 ustep: 1 
iter: 3  value: 8637.719 mgc: 0.006494888 ustep: 1 
iter: 4  value: 8637.719 mgc: 5.310854e-06 ustep: 1 
iter: 5  mgc: 3.46656e-12 
iter: 1  mgc: 3.46656e-12 
outer mgc:  93.32163 
iter: 1  value: 8649.685 mgc: 15.49949 ustep: 1 
iter: 2  value: 8648.712 mgc: 2.154551 ustep: 1 
iter: 3  value: 8648.712 mgc: 0.004714908 ustep: 1 
iter: 4  value: 8648.712 mgc: 1.33735e-07 ustep: 1 
iter: 5  mgc: 1.065814e-14 
iter: 1  value: 8595.586 mgc: 4.41631 ustep: 1 
iter: 2  value: 8595.579 mgc: 0.06163725 ustep: 1 
iter: 3  value: 8595.579 mgc: 0.0001088244 ustep: 1 
iter: 4  mgc: 1.461358e-09 
iter: 1  mgc: 1.461358e-09 
outer mgc:  37.45524 
iter: 1  value: 8557.321 mgc: 3.2955 ustep: 1 
iter: 2  value: 8557.316 mgc: 0.03335919 ustep: 1 
iter: 3  value: 8557.316 mgc: 9.26678e-05 ustep: 1 
iter: 4  mgc: 9.434804e-10 
iter: 1  mgc: 9.434804e-10 
outer mgc:  36.07699 
iter: 1  value: 8495.553 mgc: 6.178803 ustep: 1 
iter: 2  value: 8495.553 mgc: 0.02663167 ustep: 1 
iter: 3  value: 8495.553 mgc: 2.426156e-05 ustep: 1 
iter: 4  mgc: 3.00453e-11 
iter: 1  mgc: 3.00453e-11 
outer mgc:  106.1992 
iter: 1  value: 8436.526 mgc: 16.49008 ustep: 1 
iter: 2  value: 8436.525 mgc: 0.05517846 ustep: 1 
iter: 3  value: 8436.525 mgc: 6.148843e-05 ustep: 1 
iter: 4  mgc: 4.184564e-11 
iter: 1  mgc: 4.184564e-11 
outer mgc:  84.42631 
iter: 1  value: 8442.85 mgc: 8.620301 ustep: 1 
iter: 2  value: 8442.85 mgc: 0.02118649 ustep: 1 
iter: 3  value: 8442.85 mgc: 5.602219e-06 ustep: 1 
iter: 4  mgc: 1.64313e-13 
iter: 1  value: 8423.075 mgc: 4.087074 ustep: 1 
iter: 2  value: 8423.075 mgc: 0.00272361 ustep: 1 
iter: 3  value: 8423.075 mgc: 1.561011e-07 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  55.42283 
iter: 1  value: 8407.166 mgc: 8.944992 ustep: 1 
iter: 2  value: 8407.166 mgc: 0.0133088 ustep: 1 
iter: 3  value: 8407.166 mgc: 1.633033e-06 ustep: 1 
iter: 4  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  21.77884 
iter: 1  value: 8400.621 mgc: 7.196308 ustep: 1 
iter: 2  value: 8400.621 mgc: 0.01076081 ustep: 1 
iter: 3  value: 8400.621 mgc: 1.16846e-06 ustep: 1 
iter: 4  mgc: 3.375078e-14 
iter: 1  value: 8403.958 mgc: 3.338177 ustep: 1 
iter: 2  value: 8403.958 mgc: 0.0023576 ustep: 1 
iter: 3  value: 8403.958 mgc: 5.802728e-08 ustep: 1 
mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  54.265 
iter: 1  value: 8401.326 mgc: 2.271602 ustep: 1 
iter: 2  value: 8401.326 mgc: 0.0003524887 ustep: 1 
iter: 3  mgc: 7.087042e-11 
iter: 1  mgc: 7.087042e-11 
outer mgc:  27.95304 
iter: 1  value: 8397.84 mgc: 2.429976 ustep: 1 
iter: 2  value: 8397.84 mgc: 0.00125186 ustep: 1 
iter: 3  value: 8397.84 mgc: 1.240607e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  9.32111 
iter: 1  value: 8391.746 mgc: 4.349327 ustep: 1 
iter: 2  value: 8391.746 mgc: 0.0009663872 ustep: 1 
iter: 3  mgc: 5.789344e-09 
iter: 1  mgc: 5.789344e-09 
outer mgc:  30.30324 
iter: 1  value: 8377.82 mgc: 5.05648 ustep: 1 
iter: 2  value: 8377.82 mgc: 0.001983637 ustep: 1 
iter: 3  value: 8377.82 mgc: 4.641616e-08 ustep: 1 
mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  14.80345 
iter: 1  value: 8369.641 mgc: 8.665436 ustep: 1 
iter: 2  value: 8369.641 mgc: 0.01157018 ustep: 1 
iter: 3  value: 8369.641 mgc: 5.943532e-07 ustep: 1 
iter: 4  mgc: 3.93019e-14 
iter: 1  value: 8374.735 mgc: 1.634097 ustep: 1 
iter: 2  value: 8374.735 mgc: 0.001895322 ustep: 1 
iter: 3  value: 8374.735 mgc: 1.075502e-08 ustep: 1 
mgc: 4.107825e-14 
iter: 1  mgc: 4.107825e-14 
outer mgc:  20.09605 
iter: 1  value: 8372.644 mgc: 6.947809 ustep: 1 
iter: 2  value: 8372.644 mgc: 0.0007290647 ustep: 1 
iter: 3  mgc: 1.488006e-09 
iter: 1  value: 8374.433 mgc: 1.220676 ustep: 1 
iter: 2  value: 8374.433 mgc: 0.0002849827 ustep: 1 
iter: 3  mgc: 3.199285e-11 
iter: 1  value: 8374.214 mgc: 0.6064022 ustep: 1 
iter: 2  value: 8374.214 mgc: 7.079996e-05 ustep: 1 
iter: 3  mgc: 2.236655e-12 
iter: 1  mgc: 2.236655e-12 
outer mgc:  16.27082 
iter: 1  value: 8373.609 mgc: 0.5087469 ustep: 1 
iter: 2  value: 8373.609 mgc: 5.126297e-05 ustep: 1 
iter: 3  mgc: 1.06759e-12 
iter: 1  mgc: 1.06759e-12 
outer mgc:  14.57644 
iter: 1  value: 8371.453 mgc: 1.820155 ustep: 1 
iter: 2  value: 8371.453 mgc: 0.0001119688 ustep: 1 
iter: 3  mgc: 1.031371e-10 
iter: 1  mgc: 1.031371e-10 
outer mgc:  10.20338 
iter: 1  value: 8368.738 mgc: 0.7496835 ustep: 1 
iter: 2  value: 8368.738 mgc: 0.0002093324 ustep: 1 
iter: 3  mgc: 1.029772e-10 
iter: 1  mgc: 1.029772e-10 
outer mgc:  8.792183 
iter: 1  value: 8363.309 mgc: 2.025367 ustep: 1 
iter: 2  value: 8363.309 mgc: 0.001727129 ustep: 1 
iter: 3  mgc: 3.434514e-09 
iter: 1  mgc: 3.434514e-09 
outer mgc:  8.656326 
iter: 1  value: 8353.621 mgc: 3.202147 ustep: 1 
iter: 2  value: 8353.621 mgc: 0.001854129 ustep: 1 
iter: 3  mgc: 6.911818e-09 
iter: 1  mgc: 6.911818e-09 
outer mgc:  10.2051 
iter: 1  value: 8344.649 mgc: 2.491458 ustep: 1 
iter: 2  value: 8344.649 mgc: 0.0006572131 ustep: 1 
iter: 3  mgc: 6.949166e-10 
iter: 1  mgc: 6.949166e-10 
outer mgc:  36.16076 
iter: 1  value: 8340.29 mgc: 6.991821 ustep: 1 
iter: 2  value: 8340.29 mgc: 0.0004152843 ustep: 1 
iter: 3  mgc: 2.206804e-10 
iter: 1  mgc: 2.206804e-10 
outer mgc:  5.414652 
iter: 1  value: 8327.679 mgc: 9.869062 ustep: 1 
iter: 2  value: 8327.679 mgc: 0.004823581 ustep: 1 
iter: 3  mgc: 2.292973e-09 
iter: 1  mgc: 2.292973e-09 
outer mgc:  2.820218 
iter: 1  value: 8314.334 mgc: 6.713415 ustep: 1 
iter: 2  value: 8314.334 mgc: 0.001009684 ustep: 1 
iter: 3  mgc: 5.812919e-10 
iter: 1  value: 8300.788 mgc: 7.026582 ustep: 1 
iter: 2  value: 8300.788 mgc: 0.0006880237 ustep: 1 
iter: 3  mgc: 1.531375e-10 
iter: 1  mgc: 1.531375e-10 
outer mgc:  2.555502 
iter: 1  value: 8284.248 mgc: 34.95558 ustep: 1 
iter: 2  value: 8284.248 mgc: 0.0009694215 ustep: 1 
iter: 3  mgc: 1.33169e-10 
iter: 1  mgc: 1.33169e-10 
outer mgc:  4.088017 
iter: 1  value: 8269.91 mgc: 12.53222 ustep: 1 
iter: 2  value: 8269.91 mgc: 0.001619076 ustep: 1 
iter: 3  mgc: 2.445688e-11 
iter: 1  mgc: 2.445688e-11 
outer mgc:  2.794679 
iter: 1  value: 8254.228 mgc: 4.855369 ustep: 1 
iter: 2  value: 8254.228 mgc: 0.0005659398 ustep: 1 
iter: 3  mgc: 2.077005e-12 
iter: 1  mgc: 2.077005e-12 
outer mgc:  3.516472 
iter: 1  value: 8246.653 mgc: 3.738136 ustep: 1 
iter: 2  value: 8246.653 mgc: 4.363313e-05 ustep: 1 
iter: 3  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.5259071 
iter: 1  value: 8237.904 mgc: 3.683302 ustep: 1 
iter: 2  value: 8237.904 mgc: 5.53233e-05 ustep: 1 
iter: 3  mgc: 7.682743e-14 
iter: 1  mgc: 7.682743e-14 
outer mgc:  0.127892 
iter: 1  value: 8208.4 mgc: 17.35224 ustep: 1 
iter: 2  value: 8208.4 mgc: 0.000388848 ustep: 1 
iter: 3  mgc: 2.198242e-13 
iter: 1  mgc: 2.198242e-13 
outer mgc:  0.4932339 
iter: 1  value: 8181.681 mgc: 14.88346 ustep: 1 
iter: 2  value: 8181.681 mgc: 0.0001365298 ustep: 1 
iter: 3  mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.273799 
iter: 1  value: 8154.899 mgc: 15.40489 ustep: 1 
iter: 2  value: 8154.899 mgc: 5.719864e-05 ustep: 1 
iter: 3  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  0.04573672 
iter: 1  value: 8128.08 mgc: 16.03018 ustep: 1 
iter: 2  value: 8128.08 mgc: 2.349785e-05 ustep: 1 
iter: 3  mgc: 6.794565e-14 
iter: 1  mgc: 6.794565e-14 
outer mgc:  0.06295517 
iter: 1  value: 8093.025 mgc: 27.30182 ustep: 1 
iter: 2  value: 8093.025 mgc: 1.440117e-05 ustep: 1 
mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  0.06956515 
iter: 1  value: 8058.025 mgc: 31.06765 ustep: 1 
iter: 2  value: 8058.025 mgc: 4.417962e-06 ustep: 1 
mgc: 5.664913e-14 
iter: 1  mgc: 5.664913e-14 
outer mgc:  0.03118772 
iter: 1  value: 8023.033 mgc: 35.25514 ustep: 1 
iter: 2  value: 8023.033 mgc: 1.401626e-06 ustep: 1 
mgc: 1.283418e-13 
iter: 1  mgc: 1.283418e-13 
outer mgc:  0.01186611 
iter: 1  value: 7988.057 mgc: 39.96475 ustep: 1 
iter: 2  value: 7988.057 mgc: 4.416171e-07 ustep: 1 
mgc: 6.794565e-14 
iter: 1  mgc: 6.794565e-14 
outer mgc:  0.006523746 
iter: 1  value: 7945.031 mgc: 70.98791 ustep: 1 
iter: 2  value: 7945.031 mgc: 1.85448e-07 ustep: 1 
mgc: 1.731948e-13 
iter: 1  mgc: 1.731948e-13 
outer mgc:  0.004188873 
iter: 1  value: 7903.361 mgc: 81.22599 ustep: 1 
iter: 2  value: 7903.361 mgc: 4.204433e-08 ustep: 1 
mgc: 9.325873e-14 
iter: 1  mgc: 9.325873e-14 
outer mgc:  0.001980938 
iter: 1  value: 7861.722 mgc: 97.17275 ustep: 1 
iter: 2  value: 7861.722 mgc: 1.032505e-08 ustep: 1 
mgc: 1.065814e-13 
iter: 1  mgc: 1.065814e-13 
outer mgc:  0.001566562 
iter: 1  value: 7820.112 mgc: 115.1779 ustep: 1 
iter: 2  mgc: 2.519096e-09 
iter: 1  mgc: 2.519096e-09 
outer mgc:  0.001338789 
iter: 1  value: 7778.531 mgc: 135.411 ustep: 1 
iter: 2  mgc: 6.102763e-10 
iter: 1  mgc: 6.102763e-10 
outer mgc:  0.0003836923 
iter: 1  value: 7736.977 mgc: 158.157 ustep: 1 
iter: 2  mgc: 1.481126e-10 
iter: 1  mgc: 1.481126e-10 
outer mgc:  0.0001128213 
iter: 1  value: 7695.449 mgc: 183.6528 ustep: 1 
iter: 2  mgc: 3.460521e-11 
iter: 1  mgc: 3.460521e-11 
outer mgc:  0.0002027218 
iter: 1  value: 7653.947 mgc: 212.2204 ustep: 1 
iter: 2  mgc: 8.748557e-12 
iter: 1  mgc: 8.748557e-12 
outer mgc:  6.017471e-05 
iter: 1  value: 7612.469 mgc: 244.1589 ustep: 1 
iter: 2  mgc: 2.575717e-12 
iter: 1  mgc: 2.575717e-12 
outer mgc:  2.80727e-05 
iter: 1  value: 7571.014 mgc: 279.8391 ustep: 1 
iter: 2  mgc: 1.415756e-12 
iter: 1  mgc: 1.415756e-12 
outer mgc:  4.552657e-05 
iter: 1  mgc: 1.415756e-12 
iter: 1  mgc: 1.415756e-12 
outer mgc:  4.552657e-05 
iter: 1  value: 7571.015 mgc: 0.01914021 ustep: 1 
mgc: 3.330669e-13 
outer mgc:  0.8817966 
iter: 1  value: 7571.015 mgc: 0.01914303 ustep: 1 
mgc: 2.593481e-13 
outer mgc:  0.8819771 
iter: 1  value: 7571.014 mgc: 0.009097902 ustep: 1 
mgc: 2.833289e-13 
outer mgc:  0.3964081 
iter: 1  value: 7571.014 mgc: 0.009102124 ustep: 1 
mgc: 4.725109e-13 
outer mgc:  0.3966374 
iter: 1  value: 7571.015 mgc: 0.01816035 ustep: 1 
mgc: 4.298784e-13 
outer mgc:  0.8113382 
iter: 1  value: 7571.015 mgc: 0.01815416 ustep: 1 
mgc: 5.204726e-13 
outer mgc:  0.8107315 
iter: 1  value: 7571.014 mgc: 0.009068695 ustep: 1 
mgc: 4.405365e-13 
outer mgc:  0.3913802 
iter: 1  value: 7571.014 mgc: 0.009064384 ustep: 1 
mgc: 3.801404e-13 
outer mgc:  0.39109 
iter: 1  value: 7571.064 mgc: 2.044297 ustep: 1 
mgc: 2.500222e-13 
outer mgc:  4.55254e-05 
iter: 1  value: 7570.964 mgc: 2.050462 ustep: 1 
mgc: 3.836931e-13 
outer mgc:  4.552773e-05 
iter: 1  value: 7571.064 mgc: 2.069204 ustep: 1 
mgc: 3.481659e-13 
outer mgc:  4.553278e-05 
iter: 1  value: 7570.964 mgc: 2.071274 ustep: 1 
mgc: 3.28626e-13 
outer mgc:  4.552036e-05 
iter: 1  value: 7571.006 mgc: 0.01261349 ustep: 1 
mgc: 3.965717e-13 
outer mgc:  4.552656e-05 
iter: 1  value: 7571.022 mgc: 0.01261146 ustep: 1 
mgc: 4.050094e-13 
outer mgc:  4.552657e-05 
iter: 1  value: 7571.014 mgc: 0.006674838 ustep: 1 
mgc: 3.299583e-13 
outer mgc:  0.03272628 
iter: 1  value: 7571.014 mgc: 0.006673728 ustep: 1 
mgc: 3.215206e-13 
outer mgc:  0.03275332 
[Fri Aug 13 12:03:17 2021]
Finished job 0.
1 of 1 steps (100%) done

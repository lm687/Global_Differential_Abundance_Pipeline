Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:14:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_80_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2284.014948 
iter  10 value 1475.161884
final  value 1462.138982 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1577.071 mgc: 1.64094 ustep: 1 
iter: 2  value: 1577.031 mgc: 0.2292731 ustep: 1 
iter: 3  value: 1577.031 mgc: 0.01005343 ustep: 1 
iter: 4  value: 1577.031 mgc: 2.31618e-05 ustep: 1 
iter: 5  mgc: 1.234702e-10 
iter: 1  mgc: 1.234702e-10 
Matching hessian patterns... Done
outer mgc:  51.66222 
iter: 1  value: 1548.962 mgc: 0.5408573 ustep: 1 
iter: 2  value: 1548.96 mgc: 0.04001773 ustep: 1 
iter: 3  value: 1548.96 mgc: 0.0001230454 ustep: 1 
iter: 4  mgc: 1.326655e-09 
iter: 1  mgc: 1.326655e-09 
outer mgc:  10.64378 
iter: 1  value: 1534.599 mgc: 0.3797492 ustep: 1 
iter: 2  value: 1534.599 mgc: 0.008294886 ustep: 1 
iter: 3  value: 1534.599 mgc: 3.856058e-06 ustep: 1 
iter: 4  mgc: 8.663834e-13 
iter: 1  value: 1522.624 mgc: 2.504938 ustep: 1 
iter: 2  value: 1522.624 mgc: 0.03589189 ustep: 1 
iter: 3  value: 1522.624 mgc: 1.025469e-05 ustep: 1 
iter: 4  mgc: 8.604228e-13 
iter: 1  mgc: 8.604228e-13 
outer mgc:  14.325 
iter: 1  value: 1489.514 mgc: 6.547231 ustep: 1 
iter: 2  value: 1489.513 mgc: 0.09330433 ustep: 1 
iter: 3  value: 1489.513 mgc: 2.887824e-05 ustep: 1 
iter: 4  mgc: 2.261857e-12 
iter: 1  value: 1485.364 mgc: 41.33994 ustep: 1 
iter: 2  value: 1485.363 mgc: 0.03037922 ustep: 1 
iter: 3  value: 1485.363 mgc: 2.330465e-06 ustep: 1 
iter: 4  mgc: 4.773959e-15 
iter: 1  mgc: 2.261857e-12 
outer mgc:  9.863937 
iter: 1  value: 1465.784 mgc: 2.428202 ustep: 1 
iter: 2  value: 1465.772 mgc: 0.2339759 ustep: 1 
iter: 3  value: 1465.772 mgc: 0.00138579 ustep: 1 
iter: 4  value: 1465.772 mgc: 5.864904e-08 ustep: 1 
iter: 5  mgc: 1.44329e-15 
iter: 1  mgc: 1.44329e-15 
outer mgc:  11.36906 
iter: 1  value: 1447.777 mgc: 3.363043 ustep: 1 
iter: 2  value: 1447.775 mgc: 0.06450609 ustep: 1 
iter: 3  value: 1447.775 mgc: 0.0001513518 ustep: 1 
iter: 4  mgc: 1.2305e-09 
iter: 1  mgc: 1.2305e-09 
outer mgc:  9.366135 
iter: 1  value: 1423.796 mgc: 4.144882 ustep: 1 
iter: 2  value: 1423.783 mgc: 0.2561435 ustep: 1 
iter: 3  value: 1423.783 mgc: 0.0004508274 ustep: 1 
iter: 4  mgc: 3.940014e-09 
iter: 1  value: 1453.772 mgc: 27.23908 ustep: 1 
iter: 2  value: 1453.58 mgc: 1.451205 ustep: 1 
iter: 3  value: 1453.58 mgc: 0.01309828 ustep: 1 
iter: 4  value: 1453.58 mgc: 2.441089e-06 ustep: 1 
iter: 5  mgc: 1.012523e-13 
iter: 1  mgc: 3.940014e-09 
outer mgc:  5.580709 
iter: 1  value: 1492.128 mgc: 21.2737 ustep: 1 
iter: 2  value: 1491.329 mgc: 2.528007 ustep: 1 
iter: 3  value: 1491.329 mgc: 0.03781742 ustep: 1 
iter: 4  value: 1491.329 mgc: 1.638189e-05 ustep: 1 
iter: 5  mgc: 2.888356e-12 
iter: 1  value: 1421.312 mgc: 1.6131 ustep: 1 
iter: 2  value: 1421.312 mgc: 0.02043133 ustep: 1 
iter: 3  value: 1421.312 mgc: 9.409591e-06 ustep: 1 
iter: 4  mgc: 2.01239e-12 
iter: 1  mgc: 2.01239e-12 
outer mgc:  5.929415 
iter: 1  value: 1419.039 mgc: 2.342141 ustep: 1 
iter: 2  value: 1419.039 mgc: 0.00387559 ustep: 1 
iter: 3  value: 1419.039 mgc: 1.666496e-07 ustep: 1 
iter: 4  mgc: 6.883383e-15 
iter: 1  value: 1416.122 mgc: 7.570525 ustep: 1 
iter: 2  value: 1416.122 mgc: 0.03780312 ustep: 1 
iter: 3  value: 1416.122 mgc: 1.40832e-05 ustep: 1 
iter: 4  mgc: 4.076739e-12 
iter: 1  mgc: 4.076739e-12 
outer mgc:  12.75796 
iter: 1  value: 1412.117 mgc: 13.63712 ustep: 1 
iter: 2  value: 1412.117 mgc: 0.06447122 ustep: 1 
iter: 3  value: 1412.117 mgc: 1.374136e-05 ustep: 1 
iter: 4  mgc: 1.808442e-12 
iter: 1  mgc: 1.808442e-12 
outer mgc:  4.21476 
iter: 1  value: 1415.46 mgc: 12.9416 ustep: 1 
iter: 2  value: 1415.455 mgc: 0.3348119 ustep: 1 
iter: 3  value: 1415.455 mgc: 0.0007218921 ustep: 1 
iter: 4  value: 1415.455 mgc: 1.355812e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  7.133389 
iter: 1  value: 1417.564 mgc: 5.083497 ustep: 1 
iter: 2  value: 1417.562 mgc: 0.100488 ustep: 1 
iter: 3  value: 1417.562 mgc: 0.0001697113 ustep: 1 
iter: 4  mgc: 1.959801e-10 
iter: 1  value: 1415.589 mgc: 3.056565 ustep: 1 
iter: 2  value: 1415.589 mgc: 0.02200313 ustep: 1 
iter: 3  value: 1415.589 mgc: 2.954213e-06 ustep: 1 
iter: 4  mgc: 1.505462e-13 
iter: 1  mgc: 1.505462e-13 
outer mgc:  5.844642 
iter: 1  value: 1414.046 mgc: 4.831847 ustep: 1 
iter: 2  value: 1414.046 mgc: 0.04047306 ustep: 1 
iter: 3  value: 1414.046 mgc: 3.497437e-05 ustep: 1 
iter: 4  mgc: 3.584688e-11 
iter: 1  value: 1414.76 mgc: 1.773511 ustep: 1 
iter: 2  value: 1414.76 mgc: 0.005799951 ustep: 1 
iter: 3  value: 1414.76 mgc: 5.508866e-07 ustep: 1 
iter: 4  mgc: 4.685141e-14 
iter: 1  mgc: 4.685141e-14 
outer mgc:  1.21019 
iter: 1  value: 1414.415 mgc: 1.494032 ustep: 1 
iter: 2  value: 1414.415 mgc: 0.003460301 ustep: 1 
iter: 3  value: 1414.415 mgc: 2.455136e-07 ustep: 1 
iter: 4  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  2.452187 
iter: 1  value: 1414.234 mgc: 1.152438 ustep: 1 
iter: 2  value: 1414.234 mgc: 0.003527365 ustep: 1 
iter: 3  value: 1414.234 mgc: 3.164474e-08 ustep: 1 
mgc: 7.105427e-14 
iter: 1  value: 1414.313 mgc: 0.973654 ustep: 1 
iter: 2  value: 1414.313 mgc: 0.001726243 ustep: 1 
iter: 3  value: 1414.313 mgc: 1.791928e-08 ustep: 1 
mgc: 3.458345e-14 
iter: 1  mgc: 3.458345e-14 
outer mgc:  2.617002 
iter: 1  value: 1414.224 mgc: 0.508384 ustep: 1 
iter: 2  value: 1414.224 mgc: 0.0004663958 ustep: 1 
iter: 3  mgc: 1.146949e-09 
iter: 1  mgc: 1.146949e-09 
outer mgc:  0.7297475 
iter: 1  value: 1413.964 mgc: 0.4709185 ustep: 1 
iter: 2  value: 1413.964 mgc: 0.001046 ustep: 1 
iter: 3  value: 1413.964 mgc: 1.94199e-08 ustep: 1 
mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
outer mgc:  1.02491 
iter: 1  value: 1413.88 mgc: 0.4780595 ustep: 1 
iter: 2  value: 1413.88 mgc: 0.002248423 ustep: 1 
iter: 3  value: 1413.88 mgc: 2.318467e-08 ustep: 1 
mgc: 7.027712e-14 
iter: 1  value: 1413.812 mgc: 0.6201262 ustep: 1 
iter: 2  value: 1413.812 mgc: 0.003540707 ustep: 1 
iter: 3  value: 1413.812 mgc: 4.994276e-08 ustep: 1 
mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  0.9495103 
iter: 1  value: 1412.834 mgc: 1.249787 ustep: 1 
iter: 2  value: 1412.834 mgc: 0.004136433 ustep: 1 
iter: 3  value: 1412.834 mgc: 6.456159e-08 ustep: 1 
iter: 4  mgc: 5.151435e-14 
iter: 1  value: 1413.353 mgc: 0.4924585 ustep: 1 
iter: 2  value: 1413.353 mgc: 0.0007153793 ustep: 1 
iter: 3  mgc: 2.051374e-09 
iter: 1  mgc: 2.051374e-09 
outer mgc:  0.3321657 
iter: 1  value: 1413.326 mgc: 0.5509028 ustep: 1 
iter: 2  value: 1413.326 mgc: 0.001132777 ustep: 1 
iter: 3  value: 1413.326 mgc: 1.882157e-08 ustep: 1 
mgc: 4.940492e-14 
iter: 1  mgc: 4.940492e-14 
outer mgc:  0.5738577 
iter: 1  value: 1413.514 mgc: 0.7905913 ustep: 1 
iter: 2  value: 1413.514 mgc: 0.001299504 ustep: 1 
iter: 3  mgc: 4.359887e-09 
iter: 1  mgc: 4.359887e-09 
outer mgc:  0.1523358 
iter: 1  value: 1413.655 mgc: 0.3402169 ustep: 1 
iter: 2  value: 1413.655 mgc: 0.0001985546 ustep: 1 
iter: 3  mgc: 3.149001e-10 
iter: 1  mgc: 3.149001e-10 
outer mgc:  0.07858114 
iter: 1  value: 1413.62 mgc: 0.3776684 ustep: 1 
iter: 2  value: 1413.62 mgc: 0.0003537271 ustep: 1 
iter: 3  mgc: 2.829598e-09 
iter: 1  value: 1413.642 mgc: 0.1318977 ustep: 1 
iter: 2  value: 1413.642 mgc: 4.476651e-05 ustep: 1 
iter: 3  mgc: 4.373302e-11 
iter: 1  mgc: 4.373302e-11 
outer mgc:  0.0509807 
iter: 1  value: 1413.616 mgc: 0.06701835 ustep: 1 
iter: 2  value: 1413.616 mgc: 5.708207e-06 ustep: 1 
iter: 3  mgc: 3.348433e-13 
iter: 1  mgc: 3.348433e-13 
outer mgc:  0.00447331 
iter: 1  value: 1413.616 mgc: 0.007522691 ustep: 1 
iter: 2  value: 1413.616 mgc: 1.347076e-07 ustep: 1 
mgc: 8.992806e-14 
iter: 1  mgc: 8.992806e-14 
outer mgc:  0.0003584755 
iter: 1  value: 1413.615 mgc: 0.001532678 ustep: 1 
iter: 2  mgc: 5.600773e-09 
iter: 1  mgc: 5.600773e-09 
outer mgc:  3.679993e-05 
iter: 1  mgc: 5.600773e-09 
iter: 1  mgc: 5.600773e-09 
outer mgc:  3.679993e-05 
iter: 1  value: 1413.616 mgc: 0.02152584 ustep: 1 
iter: 2  value: 1413.616 mgc: 1.744361e-06 ustep: 1 
iter: 3  mgc: 9.814372e-14 
outer mgc:  0.06139882 
iter: 1  value: 1413.615 mgc: 0.02152761 ustep: 1 
iter: 2  value: 1413.615 mgc: 1.74535e-06 ustep: 1 
iter: 3  mgc: 1.267875e-13 
outer mgc:  0.06133071 
iter: 1  value: 1413.616 mgc: 0.01172721 ustep: 1 
iter: 2  value: 1413.616 mgc: 5.073427e-07 ustep: 1 
iter: 3  mgc: 8.226753e-14 
outer mgc:  0.03660422 
iter: 1  value: 1413.614 mgc: 0.01173618 ustep: 1 
iter: 2  value: 1413.614 mgc: 5.070866e-07 ustep: 1 
iter: 3  mgc: 8.837375e-14 
outer mgc:  0.03662512 
iter: 1  value: 1413.616 mgc: 0.01842108 ustep: 1 
iter: 2  value: 1413.616 mgc: 7.699311e-07 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  0.0855998 
iter: 1  value: 1413.615 mgc: 0.01841573 ustep: 1 
iter: 2  value: 1413.615 mgc: 7.728939e-07 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.08562324 
iter: 1  value: 1413.615 mgc: 0.0007853449 ustep: 1 
iter: 2  mgc: 1.105327e-09 
outer mgc:  0.004465948 
iter: 1  value: 1413.615 mgc: 0.0007845658 ustep: 1 
iter: 2  mgc: 1.10269e-09 
outer mgc:  0.004496586 
iter: 1  value: 1413.618 mgc: 0.01587242 ustep: 1 
iter: 2  value: 1413.618 mgc: 3.753376e-07 ustep: 1 
iter: 3  mgc: 7.793766e-14 
outer mgc:  0.02155942 
iter: 1  value: 1413.613 mgc: 0.01591533 ustep: 1 
iter: 2  value: 1413.613 mgc: 3.749245e-07 ustep: 1 
iter: 3  mgc: 8.21565e-14 
outer mgc:  0.02164677 
iter: 1  value: 1413.621 mgc: 0.01878851 ustep: 1 
iter: 2  value: 1413.621 mgc: 1.156331e-06 ustep: 1 
iter: 3  mgc: 6.750156e-14 
outer mgc:  0.01367283 
iter: 1  value: 1413.61 mgc: 0.01884086 ustep: 1 
iter: 2  value: 1413.61 mgc: 1.157434e-06 ustep: 1 
iter: 3  mgc: 9.070522e-14 
outer mgc:  0.01366723 
iter: 1  value: 1413.613 mgc: 0.00590056 ustep: 1 
iter: 2  value: 1413.613 mgc: 7.27621e-08 ustep: 1 
mgc: 7.349676e-14 
outer mgc:  0.001329226 
iter: 1  value: 1413.618 mgc: 0.005897141 ustep: 1 
iter: 2  value: 1413.618 mgc: 7.281618e-08 ustep: 1 
mgc: 5.817569e-14 
outer mgc:  0.001256508 
iter: 1  value: 1413.613 mgc: 0.001698401 ustep: 1 
iter: 2  mgc: 8.181777e-09 
outer mgc:  0.001150875 
iter: 1  value: 1413.618 mgc: 0.001698971 ustep: 1 
iter: 2  mgc: 8.19434e-09 
outer mgc:  0.001191183 
[Sun Aug 15 20:14:45 2021]
Finished job 0.
1 of 1 steps (100%) done

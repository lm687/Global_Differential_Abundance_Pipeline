Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:03:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_10_4_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_10_4_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_10_4_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=10, d=4, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_10_4_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_10_4_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_10_4_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_10_4_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_10_4_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 13900.373559 
iter  10 value 13082.546410
final  value 13082.545709 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 12534.95 mgc: 2.838997 ustep: 1 
iter: 2  value: 12525.34 mgc: 2.469342 ustep: 1 
iter: 3  value: 12520.9 mgc: 1.770223 ustep: 0.6827823 
iter: 4  value: 12519.7 mgc: 0.6882306 ustep: 0.8263238 
iter: 5  value: 12519.68 mgc: 0.1698204 ustep: 0.9090326 
iter: 6  value: 12519.68 mgc: 0.01140717 ustep: 0.9534367 
iter: 7  value: 12519.68 mgc: 0.0006393178 ustep: 0.9764432 
iter: 8  value: 12519.68 mgc: 1.778704e-05 ustep: 0.9881526 
iter: 9  value: 12519.68 mgc: 2.489276e-07 ustep: 0.9940592 
iter: 10  mgc: 1.749608e-09 
iter: 1  mgc: 1.749608e-09 
Matching hessian patterns... Done
outer mgc:  85.22634 
iter: 1  value: 12400.55 mgc: 1.226991 ustep: 1 
iter: 2  value: 12400.53 mgc: 0.09295165 ustep: 1 
iter: 3  value: 12400.53 mgc: 0.0004330598 ustep: 1 
iter: 4  value: 12400.53 mgc: 2.033731e-08 ustep: 1 
iter: 5  mgc: 2.88658e-15 
iter: 1  mgc: 2.88658e-15 
outer mgc:  38.52941 
iter: 1  value: 12310.38 mgc: 2.486115 ustep: 1 
iter: 2  value: 12310.27 mgc: 0.1600721 ustep: 1 
iter: 3  value: 12310.27 mgc: 0.00257889 ustep: 1 
iter: 4  value: 12310.27 mgc: 9.378484e-07 ustep: 1 
iter: 5  mgc: 2.189637e-13 
iter: 1  value: 12154.45 mgc: 31.44221 ustep: 1 
iter: 2  value: 12151.3 mgc: 1.704711 ustep: 1 
iter: 3  value: 12151.3 mgc: 0.05882128 ustep: 1 
iter: 4  value: 12151.3 mgc: 1.153713e-05 ustep: 1 
iter: 5  mgc: 1.203482e-12 
iter: 1  mgc: 1.203482e-12 
outer mgc:  68.89627 
iter: 1  value: 12431.42 mgc: 77.03188 ustep: 1 
iter: 2  value: 12431.31 mgc: 0.4898952 ustep: 1 
iter: 3  value: 12431.31 mgc: 0.003319727 ustep: 1 
iter: 4  value: 12431.31 mgc: 1.866162e-07 ustep: 1 
iter: 5  mgc: 1.776357e-14 
iter: 1  value: 12119.46 mgc: 3.8106 ustep: 1 
iter: 2  value: 12118.9 mgc: 0.5620707 ustep: 1 
iter: 3  value: 12118.9 mgc: 0.00936313 ustep: 1 
iter: 4  value: 12118.9 mgc: 2.931921e-06 ustep: 1 
iter: 5  mgc: 2.978173e-13 
iter: 1  mgc: 2.978173e-13 
outer mgc:  48.50797 
iter: 1  value: 12084.73 mgc: 10.44238 ustep: 1 
iter: 2  value: 12084.73 mgc: 0.1074115 ustep: 1 
iter: 3  value: 12084.73 mgc: 3.912126e-05 ustep: 1 
iter: 4  mgc: 9.482637e-12 
iter: 1  mgc: 9.482637e-12 
outer mgc:  60.6348 
iter: 1  value: 12049.32 mgc: 14.69979 ustep: 1 
iter: 2  value: 12049.32 mgc: 0.06398385 ustep: 1 
iter: 3  value: 12049.32 mgc: 1.355026e-05 ustep: 1 
iter: 4  mgc: 1.202149e-12 
iter: 1  mgc: 1.202149e-12 
outer mgc:  53.44711 
iter: 1  value: 12053.51 mgc: 11.05294 ustep: 1 
iter: 2  value: 12053.51 mgc: 0.07684704 ustep: 1 
iter: 3  value: 12053.51 mgc: 2.305542e-06 ustep: 1 
iter: 4  mgc: 7.593925e-14 
iter: 1  value: 12037.6 mgc: 1.774629 ustep: 1 
iter: 2  value: 12037.6 mgc: 0.007658981 ustep: 1 
iter: 3  value: 12037.6 mgc: 1.09943e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  22.63828 
iter: 1  value: 12027.82 mgc: 1.84881 ustep: 1 
iter: 2  value: 12027.82 mgc: 0.001267121 ustep: 1 
iter: 3  mgc: 7.382763e-10 
iter: 1  mgc: 7.382763e-10 
outer mgc:  36.48215 
iter: 1  value: 12013.29 mgc: 2.252358 ustep: 1 
iter: 2  value: 12013.29 mgc: 0.009160564 ustep: 1 
iter: 3  value: 12013.29 mgc: 1.856476e-07 ustep: 1 
iter: 4  mgc: 8.271162e-15 
iter: 1  mgc: 8.271162e-15 
outer mgc:  12.41224 
iter: 1  value: 11996.5 mgc: 2.962593 ustep: 1 
iter: 2  value: 11996.5 mgc: 0.001217429 ustep: 1 
iter: 3  mgc: 4.961461e-09 
iter: 1  mgc: 4.961461e-09 
outer mgc:  12.58361 
iter: 1  value: 11983.29 mgc: 1.705541 ustep: 1 
iter: 2  value: 11983.29 mgc: 0.00325177 ustep: 1 
iter: 3  value: 11983.29 mgc: 2.561029e-08 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  12.50723 
iter: 1  value: 11960.45 mgc: 8.204431 ustep: 1 
iter: 2  value: 11960.45 mgc: 0.009371709 ustep: 1 
iter: 3  value: 11960.45 mgc: 2.880722e-08 ustep: 1 
mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  14.18005 
iter: 1  value: 11938.7 mgc: 2.429207 ustep: 1 
iter: 2  value: 11938.7 mgc: 0.002540178 ustep: 1 
iter: 3  mgc: 8.75905e-09 
iter: 1  mgc: 8.75905e-09 
outer mgc:  13.2926 
iter: 1  value: 11929.66 mgc: 1.224694 ustep: 1 
iter: 2  value: 11929.66 mgc: 0.0001876267 ustep: 1 
iter: 3  mgc: 5.651479e-11 
iter: 1  mgc: 5.651479e-11 
outer mgc:  11.73685 
iter: 1  value: 11922.44 mgc: 1.36907 ustep: 1 
iter: 2  value: 11922.44 mgc: 6.868234e-05 ustep: 1 
iter: 3  mgc: 8.950618e-12 
iter: 1  value: 11927.73 mgc: 0.5739692 ustep: 1 
iter: 2  value: 11927.73 mgc: 8.612981e-06 ustep: 1 
iter: 3  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  7.759245 
iter: 1  value: 11923.86 mgc: 0.6090806 ustep: 1 
iter: 2  value: 11923.86 mgc: 5.618954e-05 ustep: 1 
iter: 3  mgc: 5.354828e-12 
iter: 1  mgc: 5.354828e-12 
outer mgc:  1.390934 
iter: 1  value: 11918.31 mgc: 0.9535707 ustep: 1 
iter: 2  value: 11918.31 mgc: 3.185324e-05 ustep: 1 
iter: 3  mgc: 2.676082e-12 
iter: 1  mgc: 2.676082e-12 
outer mgc:  1.081174 
iter: 1  value: 11913.52 mgc: 0.4126749 ustep: 1 
iter: 2  value: 11913.52 mgc: 7.173629e-05 ustep: 1 
iter: 3  mgc: 5.005774e-12 
iter: 1  value: 11917.5 mgc: 0.1588955 ustep: 1 
iter: 2  value: 11917.5 mgc: 4.88307e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  1.85269 
iter: 1  value: 11917.29 mgc: 0.07429054 ustep: 1 
iter: 2  value: 11917.29 mgc: 4.757809e-07 ustep: 1 
iter: 3  mgc: 1.287859e-14 
iter: 1  mgc: 1.287859e-14 
outer mgc:  0.479942 
iter: 1  value: 11916.65 mgc: 0.1023009 ustep: 1 
iter: 2  value: 11916.65 mgc: 1.656272e-06 ustep: 1 
iter: 3  mgc: 7.21645e-15 
iter: 1  mgc: 7.21645e-15 
outer mgc:  1.229357 
iter: 1  value: 11915.88 mgc: 0.09480771 ustep: 1 
iter: 2  value: 11915.88 mgc: 7.562185e-07 ustep: 1 
iter: 3  mgc: 1.332268e-14 
iter: 1  mgc: 1.332268e-14 
outer mgc:  0.463624 
iter: 1  value: 11914.15 mgc: 0.1213267 ustep: 1 
iter: 2  value: 11914.15 mgc: 7.294512e-06 ustep: 1 
iter: 3  mgc: 5.195844e-14 
iter: 1  value: 11911.94 mgc: 0.2275674 ustep: 1 
iter: 2  value: 11911.94 mgc: 7.812794e-06 ustep: 1 
iter: 3  mgc: 7.460699e-14 
iter: 1  value: 11902.64 mgc: 1.037231 ustep: 1 
iter: 2  value: 11902.64 mgc: 0.000120938 ustep: 1 
iter: 3  mgc: 1.534994e-11 
iter: 1  mgc: 1.534994e-11 
outer mgc:  1.469867 
iter: 1  value: 11889.37 mgc: 1.313228 ustep: 1 
iter: 2  value: 11889.37 mgc: 0.0002212681 ustep: 1 
iter: 3  mgc: 3.091705e-11 
iter: 1  mgc: 3.091705e-11 
outer mgc:  0.7455072 
iter: 1  value: 11876.05 mgc: 1.600237 ustep: 1 
iter: 2  value: 11876.05 mgc: 0.000158272 ustep: 1 
iter: 3  mgc: 1.239231e-11 
iter: 1  mgc: 1.239231e-11 
outer mgc:  1.460061 
iter: 1  value: 11862.9 mgc: 2.314838 ustep: 1 
iter: 2  value: 11862.9 mgc: 7.357713e-05 ustep: 1 
iter: 3  mgc: 2.764011e-12 
iter: 1  mgc: 2.764011e-12 
outer mgc:  0.8995063 
iter: 1  value: 11849.59 mgc: 1.754971 ustep: 1 
iter: 2  value: 11849.59 mgc: 7.711659e-05 ustep: 1 
iter: 3  mgc: 1.49436e-12 
iter: 1  mgc: 1.49436e-12 
outer mgc:  1.196773 
iter: 1  value: 11836.04 mgc: 1.565254 ustep: 1 
iter: 2  value: 11836.04 mgc: 6.183836e-05 ustep: 1 
iter: 3  mgc: 5.528911e-13 
iter: 1  value: 11804.82 mgc: 4.637715 ustep: 1 
iter: 2  value: 11804.82 mgc: 0.0002037619 ustep: 1 
iter: 3  mgc: 2.501555e-12 
iter: 1  mgc: 2.501555e-12 
outer mgc:  0.9082073 
iter: 1  value: 11760.41 mgc: 11.91368 ustep: 1 
iter: 2  value: 11760.41 mgc: 0.0001428381 ustep: 1 
iter: 3  mgc: 5.120349e-13 
iter: 1  mgc: 5.120349e-13 
outer mgc:  2.376475 
iter: 1  value: 11717.42 mgc: 9.994631 ustep: 1 
iter: 2  value: 11717.42 mgc: 6.760626e-05 ustep: 1 
iter: 3  mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  0.3727316 
iter: 1  value: 11675.12 mgc: 12.14592 ustep: 1 
iter: 2  value: 11675.12 mgc: 2.334635e-05 ustep: 1 
iter: 3  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  0.3013407 
iter: 1  value: 11632.73 mgc: 13.35321 ustep: 1 
iter: 2  value: 11632.73 mgc: 1.016146e-05 ustep: 1 
iter: 3  mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.2906725 
iter: 1  value: 11590.38 mgc: 15.29423 ustep: 1 
iter: 2  value: 11590.38 mgc: 4.794965e-06 ustep: 1 
mgc: 1.709743e-14 
iter: 1  mgc: 1.709743e-14 
outer mgc:  0.108414 
iter: 1  value: 11548 mgc: 16.8726 ustep: 1 
iter: 2  value: 11548 mgc: 2.489477e-06 ustep: 1 
mgc: 2.464695e-14 
iter: 1  mgc: 2.464695e-14 
outer mgc:  0.06600186 
iter: 1  value: 11505.62 mgc: 20.28429 ustep: 1 
iter: 2  value: 11505.62 mgc: 1.230096e-06 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.04401727 
iter: 1  value: 11463.23 mgc: 24.41105 ustep: 1 
iter: 2  value: 11463.23 mgc: 6.081975e-07 ustep: 1 
mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  0.01585359 
iter: 1  value: 11411.03 mgc: 41.64662 ustep: 1 
iter: 2  value: 11411.03 mgc: 4.136762e-07 ustep: 1 
mgc: 2.969847e-14 
iter: 1  mgc: 2.969847e-14 
outer mgc:  0.004766106 
iter: 1  value: 11363.38 mgc: 44.08471 ustep: 1 
iter: 2  value: 11363.38 mgc: 1.450607e-07 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.003957412 
iter: 1  value: 11315.73 mgc: 53.29208 ustep: 1 
iter: 2  value: 11315.73 mgc: 6.304753e-08 ustep: 1 
mgc: 8.149037e-14 
iter: 1  mgc: 8.149037e-14 
outer mgc:  0.002327077 
iter: 1  value: 11268.25 mgc: 63.69617 ustep: 1 
iter: 2  value: 11268.25 mgc: 2.705299e-08 ustep: 1 
mgc: 3.602674e-14 
iter: 1  mgc: 3.602674e-14 
outer mgc:  0.001644079 
iter: 1  value: 11222.16 mgc: 72.48009 ustep: 1 
iter: 2  value: 11222.16 mgc: 1.10845e-08 ustep: 1 
mgc: 5.551115e-14 
iter: 1  mgc: 5.551115e-14 
outer mgc:  0.001014781 
iter: 1  value: 11177.42 mgc: 81.76025 ustep: 1 
iter: 2  mgc: 4.628525e-09 
iter: 1  mgc: 4.628525e-09 
outer mgc:  0.0006582113 
iter: 1  value: 11134.65 mgc: 89.38073 ustep: 1 
iter: 2  mgc: 1.924557e-09 
iter: 1  mgc: 1.924557e-09 
outer mgc:  0.000403929 
iter: 1  value: 11094.37 mgc: 94.51154 ustep: 1 
iter: 2  mgc: 8.044387e-10 
iter: 1  mgc: 8.044387e-10 
outer mgc:  0.0002492828 
iter: 1  value: 11057.44 mgc: 95.10483 ustep: 1 
iter: 2  mgc: 3.353011e-10 
iter: 1  mgc: 3.353011e-10 
outer mgc:  0.0001468116 
iter: 1  mgc: 3.353011e-10 
iter: 1  mgc: 3.353011e-10 
outer mgc:  0.0001468116 
iter: 1  value: 11057.44 mgc: 0.006114942 ustep: 1 
iter: 2  mgc: 9.720003e-14 
outer mgc:  0.2401844 
iter: 1  value: 11057.44 mgc: 0.006112766 ustep: 1 
iter: 2  mgc: 1.89182e-13 
outer mgc:  0.2400041 
iter: 1  value: 11057.44 mgc: 0.003335458 ustep: 1 
iter: 2  mgc: 1.24345e-13 
outer mgc:  0.1311707 
iter: 1  value: 11057.44 mgc: 0.003335359 ustep: 1 
iter: 2  mgc: 1.234568e-13 
outer mgc:  0.1310722 
iter: 1  value: 11057.44 mgc: 0.006579992 ustep: 1 
iter: 2  mgc: 8.304468e-14 
outer mgc:  0.2410289 
iter: 1  value: 11057.44 mgc: 0.006578619 ustep: 1 
iter: 2  mgc: 1.676437e-13 
outer mgc:  0.2408678 
iter: 1  value: 11057.44 mgc: 0.003410199 ustep: 1 
iter: 2  mgc: 1.027511e-13 
outer mgc:  0.1307682 
iter: 1  value: 11057.44 mgc: 0.003411004 ustep: 1 
iter: 2  mgc: 1.173228e-13 
outer mgc:  0.1307096 
iter: 1  value: 11057.44 mgc: 0.005167134 ustep: 1 
iter: 2  mgc: 1.567635e-13 
outer mgc:  0.1648203 
iter: 1  value: 11057.44 mgc: 0.005163781 ustep: 1 
iter: 2  mgc: 1.117439e-13 
outer mgc:  0.1646662 
iter: 1  value: 11057.44 mgc: 0.00296681 ustep: 1 
iter: 2  mgc: 1.111333e-13 
outer mgc:  0.08809078 
iter: 1  value: 11057.44 mgc: 0.002965353 ustep: 1 
iter: 2  mgc: 1.478817e-13 
outer mgc:  0.08801232 
iter: 1  value: 11057.49 mgc: 0.4147546 ustep: 1 
iter: 2  mgc: 1.107447e-13 
outer mgc:  0.0001467297 
iter: 1  value: 11057.39 mgc: 0.4160086 ustep: 1 
iter: 2  mgc: 1.217082e-13 
outer mgc:  0.0001468935 
iter: 1  value: 11057.49 mgc: 0.4422291 ustep: 1 
iter: 2  mgc: 1.354472e-13 
outer mgc:  0.0001489165 
iter: 1  value: 11057.39 mgc: 0.4426715 ustep: 1 
iter: 2  mgc: 1.496581e-13 
outer mgc:  0.0001447111 
iter: 1  value: 11057.49 mgc: 0.7028012 ustep: 1 
mgc: 1.612599e-13 
outer mgc:  0.0001467705 
iter: 1  value: 11057.39 mgc: 0.7049156 ustep: 1 
mgc: 1.629807e-13 
outer mgc:  0.0001468528 
iter: 1  value: 11057.42 mgc: 0.01710986 ustep: 1 
mgc: 1.836864e-13 
outer mgc:  0.0001468071 
iter: 1  value: 11057.45 mgc: 0.01710501 ustep: 1 
mgc: 1.163514e-13 
outer mgc:  0.0001468162 
iter: 1  value: 11057.42 mgc: 0.02467023 ustep: 1 
mgc: 1.469935e-13 
outer mgc:  0.00014681 
iter: 1  value: 11057.45 mgc: 0.02466882 ustep: 1 
mgc: 1.649791e-13 
outer mgc:  0.0001468133 
iter: 1  value: 11057.44 mgc: 0.05000224 ustep: 1 
mgc: 1.452172e-13 
outer mgc:  0.000146809 
iter: 1  value: 11057.44 mgc: 0.05008038 ustep: 1 
mgc: 1.985079e-13 
outer mgc:  0.0001468142 
iter: 1  value: 11057.44 mgc: 0.004462657 ustep: 1 
iter: 2  mgc: 1.398881e-13 
outer mgc:  0.1302586 
iter: 1  value: 11057.44 mgc: 0.004459448 ustep: 1 
iter: 2  mgc: 9.503509e-14 
outer mgc:  0.130506 
[Fri Aug 13 12:03:18 2021]
Finished job 0.
1 of 1 steps (100%) done

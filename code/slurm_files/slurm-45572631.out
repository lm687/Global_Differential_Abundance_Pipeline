Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:00:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2141.195351 
final  value 1815.338541 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 362.484 mgc: 113.2784 ustep: 1 
iter: 2  value: 246.1822 mgc: 68.12809 ustep: 1 
iter: 3  value: 219.0275 mgc: 47.28042 ustep: 1 
iter: 4  value: 218.4595 mgc: 6.821282 ustep: 1 
iter: 5  value: 218.4594 mgc: 0.06137603 ustep: 1 
iter: 6  value: 218.4594 mgc: 6.412884e-05 ustep: 1 
iter: 7  mgc: 6.976131e-11 
iter: 1  mgc: 6.976131e-11 
Matching hessian patterns... Done
outer mgc:  66.03825 
iter: 1  value: 162.5075 mgc: 9.486642 ustep: 1 
iter: 2  value: 162.2026 mgc: 1.662854 ustep: 1 
iter: 3  value: 162.2025 mgc: 0.02308691 ustep: 1 
iter: 4  value: 162.2025 mgc: 3.471905e-05 ustep: 1 
iter: 5  mgc: 7.5147e-11 
iter: 1  value: 142.6233 mgc: 10.41956 ustep: 1 
iter: 2  value: 142.3635 mgc: 1.766341 ustep: 1 
iter: 3  value: 142.3635 mgc: 0.01708708 ustep: 1 
iter: 4  value: 142.3635 mgc: 1.83726e-05 ustep: 1 
iter: 5  mgc: 2.091771e-11 
iter: 1  mgc: 2.091771e-11 
outer mgc:  34.6635 
iter: 1  value: 751.7185 mgc: 59.1848 ustep: 0.4367355 
iter: 2  value: 348.729 mgc: 89.37113 ustep: 0.6608936 
iter: 3  value: 342.455 mgc: 8.4275 ustep: 0.8129723 
iter: 4  value: 342.423 mgc: 0.723455 ustep: 0.9016596 
iter: 5  value: 342.423 mgc: 0.009790813 ustep: 0.9495626 
iter: 6  value: 342.423 mgc: 5.443309e-05 ustep: 0.9744576 
iter: 7  value: 342.423 mgc: 3.331688e-07 ustep: 0.9871475 
iter: 8  mgc: 9.859566e-10 
iter: 1  value: 135.8558 mgc: 12.59287 ustep: 1 
iter: 2  value: 135.7365 mgc: 1.340038 ustep: 1 
iter: 3  value: 135.7365 mgc: 0.01717695 ustep: 1 
iter: 4  value: 135.7365 mgc: 2.968334e-06 ustep: 1 
iter: 5  mgc: 1.030287e-13 
iter: 1  mgc: 1.030287e-13 
outer mgc:  7.361807 
iter: 1  value: 132.8548 mgc: 7.680305 ustep: 1 
iter: 2  value: 132.8483 mgc: 0.2902178 ustep: 1 
iter: 3  value: 132.8483 mgc: 0.0005990044 ustep: 1 
iter: 4  mgc: 3.585587e-09 
iter: 1  value: 131.5507 mgc: 9.51173 ustep: 1 
iter: 2  value: 131.5353 mgc: 0.4402472 ustep: 1 
iter: 3  value: 131.5353 mgc: 0.001355102 ustep: 1 
iter: 4  value: 131.5353 mgc: 1.727228e-08 ustep: 1 
mgc: 2.964295e-14 
iter: 1  mgc: 2.964295e-14 
outer mgc:  18.01378 
iter: 1  value: 182.9113 mgc: 42.14217 ustep: 1 
iter: 2  value: 124.2976 mgc: 29.18471 ustep: 1 
iter: 3  value: 123.504 mgc: 3.398031 ustep: 1 
iter: 4  value: 123.5035 mgc: 0.0978645 ustep: 1 
iter: 5  value: 123.5035 mgc: 0.0001222089 ustep: 1 
iter: 6  mgc: 1.971327e-10 
iter: 1  mgc: 1.971327e-10 
outer mgc:  18.70734 
iter: 1  value: 112.3753 mgc: 18.66347 ustep: 1 
iter: 2  value: 110.6708 mgc: 5.356716 ustep: 1 
iter: 3  value: 110.6692 mgc: 0.2564372 ustep: 1 
iter: 4  value: 110.6692 mgc: 0.0006959255 ustep: 1 
iter: 5  mgc: 5.185545e-09 
iter: 1  mgc: 5.185545e-09 
outer mgc:  7.846272 
iter: 1  value: 164.2543 mgc: 34.04433 ustep: 1 
iter: 2  value: 161.3376 mgc: 7.099897 ustep: 1 
iter: 3  value: 161.3359 mgc: 0.2045165 ustep: 1 
iter: 4  value: 161.3359 mgc: 0.0001946305 ustep: 1 
iter: 5  mgc: 1.77921e-10 
iter: 1  value: 109.5708 mgc: 6.041396 ustep: 1 
iter: 2  value: 109.5656 mgc: 0.2479426 ustep: 1 
iter: 3  value: 109.5656 mgc: 0.0005020322 ustep: 1 
iter: 4  mgc: 2.054814e-09 
iter: 1  mgc: 2.054814e-09 
outer mgc:  5.208184 
iter: 1  value: 108.7889 mgc: 2.708643 ustep: 1 
iter: 2  value: 108.7888 mgc: 0.01995898 ustep: 1 
iter: 3  value: 108.7888 mgc: 3.089976e-06 ustep: 1 
iter: 4  mgc: 9.148238e-14 
iter: 1  mgc: 9.148238e-14 
outer mgc:  6.99381 
iter: 1  value: 106.8201 mgc: 3.844644 ustep: 1 
iter: 2  value: 106.8191 mgc: 0.1165386 ustep: 1 
iter: 3  value: 106.8191 mgc: 0.0001152796 ustep: 1 
iter: 4  mgc: 1.135452e-10 
iter: 1  mgc: 1.135452e-10 
outer mgc:  5.988942 
iter: 1  value: 105.9698 mgc: 7.957836 ustep: 1 
iter: 2  value: 105.9694 mgc: 0.08117256 ustep: 1 
iter: 3  value: 105.9694 mgc: 2.336387e-05 ustep: 1 
iter: 4  mgc: 2.317591e-12 
iter: 1  mgc: 2.317591e-12 
outer mgc:  7.258845 
iter: 1  value: 104.5295 mgc: 6.107834 ustep: 1 
iter: 2  value: 104.5285 mgc: 0.185446 ustep: 1 
iter: 3  value: 104.5285 mgc: 0.0002011073 ustep: 1 
iter: 4  mgc: 2.33018e-10 
iter: 1  mgc: 2.33018e-10 
outer mgc:  2.757082 
iter: 1  value: 104.241 mgc: 2.460076 ustep: 1 
iter: 2  value: 104.241 mgc: 0.04832051 ustep: 1 
iter: 3  value: 104.241 mgc: 5.768492e-06 ustep: 1 
iter: 4  mgc: 4.52971e-13 
iter: 1  mgc: 4.52971e-13 
outer mgc:  6.771284 
iter: 1  value: 103.8496 mgc: 5.571429 ustep: 1 
iter: 2  value: 103.8492 mgc: 0.07991424 ustep: 1 
iter: 3  value: 103.8492 mgc: 2.318201e-05 ustep: 1 
iter: 4  mgc: 1.959544e-12 
iter: 1  mgc: 1.959544e-12 
outer mgc:  10.90213 
iter: 1  value: 102.9415 mgc: 3.387577 ustep: 1 
iter: 2  value: 102.9414 mgc: 0.04724703 ustep: 1 
iter: 3  value: 102.9414 mgc: 9.157663e-06 ustep: 1 
iter: 4  mgc: 3.362866e-13 
iter: 1  mgc: 3.362866e-13 
outer mgc:  2.03626 
iter: 1  value: 102.451 mgc: 3.859693 ustep: 1 
iter: 2  value: 102.451 mgc: 0.0545316 ustep: 1 
iter: 3  value: 102.451 mgc: 1.171728e-05 ustep: 1 
iter: 4  mgc: 5.044853e-13 
iter: 1  value: 102.6243 mgc: 1.682464 ustep: 1 
iter: 2  value: 102.6243 mgc: 0.01117804 ustep: 1 
iter: 3  value: 102.6243 mgc: 5.734085e-07 ustep: 1 
iter: 4  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  1.84828 
iter: 1  value: 102.3961 mgc: 0.7386216 ustep: 1 
iter: 2  value: 102.3961 mgc: 0.001606727 ustep: 1 
iter: 3  mgc: 7.945938e-09 
iter: 1  value: 101.9958 mgc: 1.371084 ustep: 1 
iter: 2  value: 101.9958 mgc: 0.004889177 ustep: 1 
iter: 3  value: 101.9958 mgc: 8.043905e-08 ustep: 1 
mgc: 3.352874e-14 
iter: 1  value: 101.0199 mgc: 2.839653 ustep: 1 
iter: 2  value: 101.0198 mgc: 0.01949108 ustep: 1 
iter: 3  value: 101.0198 mgc: 1.40843e-06 ustep: 1 
iter: 4  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  5.215818 
iter: 1  value: 99.84452 mgc: 7.234871 ustep: 1 
iter: 2  value: 99.83927 mgc: 0.1583829 ustep: 1 
iter: 3  value: 99.83927 mgc: 0.0003700874 ustep: 1 
iter: 4  mgc: 4.227839e-09 
iter: 1  mgc: 4.227839e-09 
outer mgc:  3.03717 
iter: 1  value: 99.93498 mgc: 3.668442 ustep: 1 
iter: 2  value: 99.93479 mgc: 0.03945476 ustep: 1 
iter: 3  value: 99.93479 mgc: 1.38603e-05 ustep: 1 
iter: 4  mgc: 1.652012e-12 
iter: 1  mgc: 1.652012e-12 
outer mgc:  2.433605 
iter: 1  value: 98.23314 mgc: 5.544372 ustep: 1 
iter: 2  value: 98.23294 mgc: 0.05149439 ustep: 1 
iter: 3  value: 98.23294 mgc: 3.788944e-05 ustep: 1 
iter: 4  mgc: 4.509904e-11 
iter: 1  mgc: 4.509904e-11 
outer mgc:  4.334706 
iter: 1  value: 97.56549 mgc: 4.010763 ustep: 1 
iter: 2  value: 97.56547 mgc: 0.01377453 ustep: 1 
iter: 3  value: 97.56547 mgc: 1.538483e-06 ustep: 1 
iter: 4  mgc: 5.528911e-14 
iter: 1  mgc: 5.528911e-14 
outer mgc:  2.397468 
iter: 1  value: 97.61676 mgc: 2.778043 ustep: 1 
iter: 2  value: 97.61676 mgc: 0.006985217 ustep: 1 
iter: 3  value: 97.61676 mgc: 6.556201e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  value: 97.7046 mgc: 2.02464 ustep: 1 
iter: 2  value: 97.7046 mgc: 0.002619042 ustep: 1 
iter: 3  mgc: 8.694321e-09 
iter: 1  value: 97.59904 mgc: 1.860814 ustep: 1 
iter: 2  value: 97.59904 mgc: 0.001691407 ustep: 1 
iter: 3  value: 97.59904 mgc: 2.29471e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  value: 97.53091 mgc: 0.8563925 ustep: 1 
iter: 2  value: 97.53091 mgc: 0.0003419801 ustep: 1 
iter: 3  mgc: 9.145662e-10 
iter: 1  mgc: 9.145662e-10 
outer mgc:  3.104794 
iter: 1  value: 97.51168 mgc: 0.4931429 ustep: 1 
iter: 2  value: 97.51168 mgc: 0.0003045586 ustep: 1 
iter: 3  mgc: 1.261832e-09 
iter: 1  mgc: 1.261832e-09 
outer mgc:  1.157602 
iter: 1  value: 97.49491 mgc: 0.2354572 ustep: 1 
iter: 2  value: 97.49491 mgc: 4.626807e-05 ustep: 1 
iter: 3  mgc: 7.696732e-12 
iter: 1  value: 97.46712 mgc: 0.2469651 ustep: 1 
iter: 2  value: 97.46712 mgc: 9.773165e-05 ustep: 1 
iter: 3  mgc: 2.474003e-10 
iter: 1  value: 97.39217 mgc: 0.9856524 ustep: 1 
iter: 2  value: 97.39217 mgc: 0.001742438 ustep: 1 
iter: 3  value: 97.39217 mgc: 3.701122e-08 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.7749243 
iter: 1  value: 96.8428 mgc: 1.795755 ustep: 1 
iter: 2  value: 96.8428 mgc: 0.001153823 ustep: 1 
iter: 3  mgc: 3.026249e-09 
iter: 1  mgc: 3.026249e-09 
outer mgc:  0.4790327 
iter: 1  value: 95.70649 mgc: 2.551935 ustep: 1 
iter: 2  value: 95.70649 mgc: 0.002669336 ustep: 1 
iter: 3  mgc: 4.228822e-09 
iter: 1  mgc: 4.228822e-09 
outer mgc:  0.5838746 
iter: 1  value: 94.57817 mgc: 3.011303 ustep: 1 
iter: 2  value: 94.57817 mgc: 0.001819355 ustep: 1 
iter: 3  mgc: 4.129523e-09 
iter: 1  mgc: 4.129523e-09 
outer mgc:  0.5360049 
iter: 1  value: 93.51275 mgc: 2.387864 ustep: 1 
iter: 2  value: 93.51275 mgc: 0.001025828 ustep: 1 
iter: 3  mgc: 1.831051e-10 
iter: 1  mgc: 1.831051e-10 
outer mgc:  0.1428055 
iter: 1  value: 92.57815 mgc: 1.999969 ustep: 1 
iter: 2  value: 92.57815 mgc: 0.0004937424 ustep: 1 
iter: 3  mgc: 6.606449e-11 
iter: 1  mgc: 6.606449e-11 
outer mgc:  0.06987156 
iter: 1  value: 91.44259 mgc: 2.419576 ustep: 1 
iter: 2  value: 91.44259 mgc: 0.0004428925 ustep: 1 
iter: 3  mgc: 9.110757e-11 
iter: 1  mgc: 9.110757e-11 
outer mgc:  0.07188354 
iter: 1  value: 90.46678 mgc: 2.114457 ustep: 1 
iter: 2  value: 90.46678 mgc: 0.000230307 ustep: 1 
iter: 3  mgc: 1.159783e-11 
iter: 1  mgc: 1.159783e-11 
outer mgc:  0.03828779 
iter: 1  value: 89.5592 mgc: 1.953926 ustep: 1 
iter: 2  value: 89.5592 mgc: 0.0001257794 ustep: 1 
iter: 3  mgc: 7.304379e-12 
iter: 1  mgc: 7.304379e-12 
outer mgc:  0.05179855 
iter: 1  value: 88.72726 mgc: 1.784493 ustep: 1 
iter: 2  value: 88.72726 mgc: 8.323818e-05 ustep: 1 
iter: 3  mgc: 1.040945e-12 
iter: 1  mgc: 1.040945e-12 
outer mgc:  0.02529665 
iter: 1  value: 88.04871 mgc: 1.451188 ustep: 1 
iter: 2  value: 88.04871 mgc: 4.102344e-05 ustep: 1 
iter: 3  mgc: 6.02185e-13 
iter: 1  mgc: 6.02185e-13 
outer mgc:  0.02021326 
iter: 1  value: 87.55888 mgc: 1.01505 ustep: 1 
iter: 2  value: 87.55888 mgc: 1.698097e-05 ustep: 1 
iter: 3  mgc: 1.119105e-13 
iter: 1  mgc: 1.119105e-13 
outer mgc:  0.0110258 
iter: 1  value: 87.2772 mgc: 0.5632781 ustep: 1 
iter: 2  value: 87.2772 mgc: 4.331879e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
iter: 1  mgc: 8.704149e-14 
outer mgc:  0.003523366 
iter: 1  value: 87.17193 mgc: 0.2094832 ustep: 1 
iter: 2  value: 87.17193 mgc: 6.177623e-07 ustep: 1 
mgc: 1.225686e-13 
iter: 1  mgc: 1.225686e-13 
outer mgc:  0.001887906 
iter: 1  value: 87.15314 mgc: 0.03706676 ustep: 1 
iter: 2  value: 87.15314 mgc: 1.72534e-08 ustep: 1 
mgc: 1.056932e-13 
iter: 1  mgc: 1.056932e-13 
outer mgc:  0.0004948467 
iter: 1  value: 87.1523 mgc: 0.001609484 ustep: 1 
iter: 2  mgc: 4.02256e-11 
iter: 1  mgc: 4.02256e-11 
outer mgc:  7.269403e-05 
iter: 1  mgc: 4.02256e-11 
iter: 1  mgc: 4.02256e-11 
outer mgc:  7.269403e-05 
iter: 1  value: 87.15296 mgc: 0.03257956 ustep: 1 
iter: 2  value: 87.15296 mgc: 1.816803e-07 ustep: 1 
iter: 3  mgc: 1.616485e-13 
outer mgc:  0.2763487 
iter: 1  value: 87.15192 mgc: 0.03256094 ustep: 1 
iter: 2  value: 87.15192 mgc: 1.814135e-07 ustep: 1 
iter: 3  mgc: 1.776357e-13 
outer mgc:  0.2760621 
iter: 1  value: 87.15274 mgc: 0.02109159 ustep: 1 
iter: 2  value: 87.15274 mgc: 6.277951e-08 ustep: 1 
mgc: 1.456613e-13 
outer mgc:  0.1755495 
iter: 1  value: 87.15205 mgc: 0.02108141 ustep: 1 
iter: 2  value: 87.15205 mgc: 6.271467e-08 ustep: 1 
mgc: 9.237056e-14 
outer mgc:  0.1753471 
iter: 1  value: 87.15218 mgc: 0.05333517 ustep: 1 
iter: 2  value: 87.15218 mgc: 4.585977e-06 ustep: 1 
iter: 3  mgc: 4.707346e-13 
outer mgc:  0.2376571 
iter: 1  value: 87.15265 mgc: 0.05333685 ustep: 1 
iter: 2  value: 87.15265 mgc: 4.579316e-06 ustep: 1 
iter: 3  mgc: 4.041212e-13 
outer mgc:  0.2379063 
iter: 1  value: 87.15229 mgc: 0.02741642 ustep: 1 
iter: 2  value: 87.15229 mgc: 8.252945e-07 ustep: 1 
iter: 3  mgc: 1.376677e-13 
outer mgc:  0.1866157 
iter: 1  value: 87.15251 mgc: 0.02741792 ustep: 1 
iter: 2  value: 87.15251 mgc: 8.250146e-07 ustep: 1 
iter: 3  mgc: 1.199041e-13 
outer mgc:  0.1867398 
iter: 1  value: 87.15172 mgc: 0.001162852 ustep: 1 
iter: 2  mgc: 1.888623e-11 
outer mgc:  5.378835e-05 
iter: 1  value: 87.15289 mgc: 0.001162781 ustep: 1 
iter: 2  mgc: 1.890754e-11 
outer mgc:  9.160294e-05 
iter: 1  value: 87.16144 mgc: 0.8240104 ustep: 1 
iter: 2  value: 87.16144 mgc: 1.01703e-05 ustep: 1 
iter: 3  mgc: 1.74083e-13 
outer mgc:  0.09586516 
iter: 1  value: 87.14325 mgc: 0.8264937 ustep: 1 
iter: 2  value: 87.14325 mgc: 1.015221e-05 ustep: 1 
iter: 3  mgc: 1.341149e-13 
outer mgc:  0.09563997 
iter: 1  value: 87.15383 mgc: 0.8323474 ustep: 1 
iter: 2  value: 87.15383 mgc: 1.056056e-05 ustep: 1 
iter: 3  mgc: 1.723066e-13 
outer mgc:  0.1096301 
iter: 1  value: 87.15088 mgc: 0.8331802 ustep: 1 
iter: 2  value: 87.15088 mgc: 1.056476e-05 ustep: 1 
iter: 3  mgc: 1.74083e-13 
outer mgc:  0.109763 
[Sun Aug 15 00:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

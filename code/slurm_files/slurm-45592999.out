Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:04:23 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_4_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22007.401367 
final  value 18504.305556 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17558.09 mgc: 6.353404 ustep: 0.7271117 
iter: 2  value: 17443.26 mgc: 8.025595 ustep: 0.8527232 
iter: 3  value: 17361.79 mgc: 5.643783 ustep: 0.4738622 
iter: 4  value: 17344.23 mgc: 3.507183 ustep: 0.4417513 
iter: 5  value: 17341.61 mgc: 2.310207 ustep: 0.6646772 
iter: 6  value: 17341.45 mgc: 0.7303376 ustep: 0.8152959 
iter: 7  value: 17341.45 mgc: 0.04445749 ustep: 0.9029471 
iter: 8  value: 17341.45 mgc: 0.002107779 ustep: 0.9502402 
iter: 9  value: 17341.45 mgc: 8.951422e-05 ustep: 0.9748052 
iter: 10  value: 17341.45 mgc: 2.337096e-06 ustep: 0.9873235 
iter: 11  value: 17341.45 mgc: 3.067063e-08 ustep: 0.9936422 
iter: 12  mgc: 2.017793e-10 
iter: 1  mgc: 2.017793e-10 
Matching hessian patterns... Done
outer mgc:  48.23269 
iter: 1  value: 17249.06 mgc: 1.449616 ustep: 1 
iter: 2  value: 17248.34 mgc: 0.2584903 ustep: 1 
iter: 3  value: 17248.34 mgc: 0.005538648 ustep: 1 
iter: 4  value: 17248.34 mgc: 4.478526e-06 ustep: 1 
iter: 5  mgc: 2.884026e-12 
iter: 1  value: 17142.76 mgc: 3.250831 ustep: 1 
iter: 2  value: 17136.31 mgc: 1.040822 ustep: 1 
iter: 3  value: 17136.3 mgc: 0.06476898 ustep: 1 
iter: 4  value: 17136.3 mgc: 0.0002938835 ustep: 1 
iter: 5  mgc: 6.252974e-09 
iter: 1  mgc: 6.252974e-09 
outer mgc:  144.4618 
iter: 1  value: 16972.27 mgc: 13.28514 ustep: 1 
iter: 2  value: 16964.28 mgc: 4.007208 ustep: 1 
iter: 3  value: 16964.27 mgc: 0.2243606 ustep: 1 
iter: 4  value: 16964.27 mgc: 0.0007772155 ustep: 1 
iter: 5  value: 16964.27 mgc: 2.154087e-08 ustep: 1 
mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  195.1747 
iter: 1  value: 16882.47 mgc: 5.767131 ustep: 1 
iter: 2  value: 16880.76 mgc: 2.197966 ustep: 1 
iter: 3  value: 16880.76 mgc: 0.04036217 ustep: 1 
iter: 4  value: 16880.76 mgc: 6.627218e-05 ustep: 1 
iter: 5  mgc: 2.45401e-10 
iter: 1  mgc: 2.45401e-10 
outer mgc:  100.5538 
iter: 1  value: 17052.49 mgc: 5.552124 ustep: 1 
iter: 2  value: 17021.27 mgc: 4.987474 ustep: 1 
iter: 3  value: 17021.26 mgc: 0.08336513 ustep: 1 
iter: 4  value: 17021.26 mgc: 0.0001366954 ustep: 1 
iter: 5  mgc: 5.107828e-10 
iter: 1  value: 16850.3 mgc: 3.986311 ustep: 1 
iter: 2  value: 16849.74 mgc: 0.5722073 ustep: 1 
iter: 3  value: 16849.74 mgc: 0.006292587 ustep: 1 
iter: 4  value: 16849.74 mgc: 8.828499e-07 ustep: 1 
iter: 5  mgc: 1.532108e-14 
iter: 1  mgc: 1.532108e-14 
outer mgc:  17.59362 
iter: 1  value: 16825.59 mgc: 1.709982 ustep: 1 
iter: 2  value: 16825.54 mgc: 0.1475537 ustep: 1 
iter: 3  value: 16825.54 mgc: 0.0009410827 ustep: 1 
iter: 4  value: 16825.54 mgc: 4.057142e-08 ustep: 1 
mgc: 7.882583e-15 
iter: 1  mgc: 7.882583e-15 
outer mgc:  42.10106 
iter: 1  value: 16807.38 mgc: 3.644318 ustep: 1 
iter: 2  value: 16807.32 mgc: 0.2150666 ustep: 1 
iter: 3  value: 16807.32 mgc: 0.001331486 ustep: 1 
iter: 4  value: 16807.32 mgc: 4.885731e-08 ustep: 1 
mgc: 5.606626e-15 
iter: 1  value: 16817.55 mgc: 1.880033 ustep: 1 
iter: 2  value: 16817.53 mgc: 0.0975501 ustep: 1 
iter: 3  value: 16817.53 mgc: 0.0003340915 ustep: 1 
iter: 4  mgc: 4.243804e-09 
iter: 1  mgc: 4.243804e-09 
outer mgc:  14.88742 
iter: 1  value: 16812.24 mgc: 1.691476 ustep: 1 
iter: 2  value: 16812.24 mgc: 0.04692494 ustep: 1 
iter: 3  value: 16812.24 mgc: 5.060219e-05 ustep: 1 
iter: 4  mgc: 6.225842e-11 
iter: 1  mgc: 6.225842e-11 
outer mgc:  17.61028 
iter: 1  value: 16797.47 mgc: 1.341057 ustep: 1 
iter: 2  value: 16797.46 mgc: 0.02502022 ustep: 1 
iter: 3  value: 16797.46 mgc: 1.364417e-05 ustep: 1 
iter: 4  mgc: 6.954881e-12 
iter: 1  mgc: 6.954881e-12 
outer mgc:  15.09403 
iter: 1  value: 16786.51 mgc: 1.426503 ustep: 1 
iter: 2  value: 16786.51 mgc: 0.0107448 ustep: 1 
iter: 3  value: 16786.51 mgc: 1.628266e-06 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  16.29233 
iter: 1  value: 16787.61 mgc: 1.28172 ustep: 1 
iter: 2  value: 16787.61 mgc: 0.02744537 ustep: 1 
iter: 3  value: 16787.61 mgc: 1.432948e-05 ustep: 1 
iter: 4  mgc: 4.791278e-12 
iter: 1  value: 16786.71 mgc: 0.6777018 ustep: 1 
iter: 2  value: 16786.71 mgc: 0.002913197 ustep: 1 
iter: 3  value: 16786.71 mgc: 1.269343e-07 ustep: 1 
iter: 4  mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  8.898537 
iter: 1  value: 16781.7 mgc: 0.544193 ustep: 1 
iter: 2  value: 16781.7 mgc: 0.002830428 ustep: 1 
iter: 3  value: 16781.7 mgc: 9.454309e-08 ustep: 1 
iter: 4  mgc: 7.001344e-15 
iter: 1  mgc: 7.001344e-15 
outer mgc:  8.232083 
iter: 1  value: 16775.84 mgc: 0.6037313 ustep: 1 
iter: 2  value: 16775.84 mgc: 0.008174433 ustep: 1 
iter: 3  value: 16775.84 mgc: 1.304954e-06 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  8.204865 
iter: 1  value: 16769.53 mgc: 0.5136216 ustep: 1 
iter: 2  value: 16769.53 mgc: 0.002580173 ustep: 1 
iter: 3  value: 16769.53 mgc: 7.02113e-08 ustep: 1 
iter: 4  mgc: 5.273559e-15 
iter: 1  mgc: 5.273559e-15 
outer mgc:  2.517236 
iter: 1  value: 16766.29 mgc: 0.6022441 ustep: 1 
iter: 2  value: 16766.29 mgc: 0.004509297 ustep: 1 
iter: 3  value: 16766.29 mgc: 3.4032e-07 ustep: 1 
iter: 4  mgc: 4.773959e-15 
iter: 1  mgc: 4.773959e-15 
outer mgc:  7.045812 
iter: 1  value: 16764.32 mgc: 0.316519 ustep: 1 
iter: 2  value: 16764.32 mgc: 0.0003262229 ustep: 1 
iter: 3  mgc: 5.78114e-10 
iter: 1  mgc: 5.78114e-10 
outer mgc:  4.086953 
iter: 1  value: 16761.36 mgc: 0.2985666 ustep: 1 
iter: 2  value: 16761.36 mgc: 0.0004987745 ustep: 1 
iter: 3  mgc: 1.401624e-09 
iter: 1  mgc: 1.401624e-09 
outer mgc:  6.992405 
iter: 1  value: 16758.23 mgc: 0.2723004 ustep: 1 
iter: 2  value: 16758.23 mgc: 0.001205082 ustep: 1 
iter: 3  value: 16758.23 mgc: 1.748435e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  2.765809 
iter: 1  value: 16756.52 mgc: 0.378143 ustep: 1 
iter: 2  value: 16756.52 mgc: 0.0009792347 ustep: 1 
iter: 3  mgc: 7.293621e-09 
iter: 1  mgc: 7.293621e-09 
outer mgc:  6.57126 
iter: 1  value: 16755.02 mgc: 0.119245 ustep: 1 
iter: 2  value: 16755.02 mgc: 0.0001647583 ustep: 1 
iter: 3  mgc: 2.21168e-10 
iter: 1  mgc: 2.21168e-10 
outer mgc:  1.676365 
iter: 1  value: 16753.64 mgc: 0.1665949 ustep: 1 
iter: 2  value: 16753.64 mgc: 0.000166653 ustep: 1 
iter: 3  mgc: 1.190159e-10 
iter: 1  value: 16754.34 mgc: 0.08501267 ustep: 1 
iter: 2  value: 16754.34 mgc: 4.097917e-05 ustep: 1 
iter: 3  mgc: 6.684875e-12 
iter: 1  mgc: 6.684875e-12 
outer mgc:  1.943865 
iter: 1  value: 16753.64 mgc: 0.08477984 ustep: 1 
iter: 2  value: 16753.64 mgc: 6.002429e-05 ustep: 1 
iter: 3  mgc: 3.364375e-11 
iter: 1  mgc: 3.364375e-11 
outer mgc:  1.60748 
iter: 1  value: 16752.06 mgc: 0.142654 ustep: 1 
iter: 2  value: 16752.06 mgc: 0.0001366377 ustep: 1 
iter: 3  mgc: 1.171707e-10 
iter: 1  value: 16749.48 mgc: 0.2029663 ustep: 1 
iter: 2  value: 16749.48 mgc: 0.0003816068 ustep: 1 
iter: 3  mgc: 1.507168e-09 
iter: 1  value: 16736.72 mgc: 1.061863 ustep: 1 
iter: 2  value: 16736.72 mgc: 0.006582316 ustep: 1 
iter: 3  value: 16736.72 mgc: 2.983769e-07 ustep: 1 
iter: 4  mgc: 4.690692e-15 
iter: 1  value: 16715.29 mgc: 1.833503 ustep: 1 
iter: 2  value: 16715.29 mgc: 0.009438361 ustep: 1 
iter: 3  value: 16715.29 mgc: 3.05077e-07 ustep: 1 
iter: 4  mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  3.457776 
iter: 1  value: 16685.68 mgc: 2.660862 ustep: 1 
iter: 2  value: 16685.68 mgc: 0.005764297 ustep: 1 
iter: 3  value: 16685.68 mgc: 5.816331e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  value: 16711.49 mgc: 0.2918382 ustep: 1 
iter: 2  value: 16711.49 mgc: 0.0001098188 ustep: 1 
iter: 3  mgc: 3.43463e-11 
iter: 1  mgc: 3.43463e-11 
outer mgc:  2.31733 
iter: 1  value: 16706.93 mgc: 0.3467824 ustep: 1 
iter: 2  value: 16706.93 mgc: 0.000182079 ustep: 1 
iter: 3  mgc: 1.032538e-10 
iter: 1  mgc: 1.032538e-10 
outer mgc:  0.9412053 
iter: 1  value: 16702.85 mgc: 0.3896681 ustep: 1 
iter: 2  value: 16702.85 mgc: 0.0002140905 ustep: 1 
iter: 3  mgc: 1.174021e-10 
iter: 1  mgc: 1.174021e-10 
outer mgc:  0.9769759 
iter: 1  value: 16698.54 mgc: 0.3810024 ustep: 1 
iter: 2  value: 16698.54 mgc: 0.0001697258 ustep: 1 
iter: 3  mgc: 5.45195e-11 
iter: 1  mgc: 5.45195e-11 
outer mgc:  1.437796 
iter: 1  value: 16693.56 mgc: 0.3630336 ustep: 1 
iter: 2  value: 16693.56 mgc: 0.0001566154 ustep: 1 
iter: 3  mgc: 4.209433e-11 
iter: 1  value: 16683.14 mgc: 0.8554486 ustep: 1 
iter: 2  value: 16683.14 mgc: 0.0005401239 ustep: 1 
iter: 3  mgc: 3.545169e-10 
iter: 1  mgc: 3.545169e-10 
outer mgc:  1.723773 
iter: 1  value: 16668.46 mgc: 1.278415 ustep: 1 
iter: 2  value: 16668.46 mgc: 0.0005623463 ustep: 1 
iter: 3  mgc: 2.864109e-10 
iter: 1  value: 16652.83 mgc: 1.39668 ustep: 1 
iter: 2  value: 16652.83 mgc: 0.0003640893 ustep: 1 
iter: 3  mgc: 8.272982e-11 
iter: 1  mgc: 8.272982e-11 
outer mgc:  1.014068 
iter: 1  value: 16629.43 mgc: 2.696478 ustep: 1 
iter: 2  value: 16629.43 mgc: 0.0003347466 ustep: 1 
iter: 3  mgc: 1.832736e-10 
iter: 1  mgc: 1.832736e-10 
outer mgc:  0.5296391 
iter: 1  value: 16601.82 mgc: 2.683957 ustep: 1 
iter: 2  value: 16601.82 mgc: 0.00041789 ustep: 1 
iter: 3  mgc: 4.842908e-10 
iter: 1  mgc: 4.842908e-10 
outer mgc:  0.9204818 
iter: 1  value: 16580.73 mgc: 2.218611 ustep: 1 
iter: 2  value: 16580.73 mgc: 3.906047e-05 ustep: 1 
iter: 3  mgc: 2.042366e-12 
iter: 1  mgc: 2.042366e-12 
outer mgc:  0.3424321 
iter: 1  value: 16548.87 mgc: 3.771013 ustep: 1 
iter: 2  value: 16548.87 mgc: 2.947534e-05 ustep: 1 
iter: 3  mgc: 1.319611e-12 
iter: 1  mgc: 1.319611e-12 
outer mgc:  0.06971244 
iter: 1  value: 16517.67 mgc: 3.621409 ustep: 1 
iter: 2  value: 16517.67 mgc: 8.917253e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  0.05628265 
iter: 1  value: 16486.43 mgc: 3.633204 ustep: 1 
iter: 2  value: 16486.43 mgc: 3.012304e-06 ustep: 1 
iter: 3  mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  0.03873726 
iter: 1  value: 16455.17 mgc: 3.635778 ustep: 1 
iter: 2  value: 16455.17 mgc: 8.546209e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  0.03553815 
iter: 1  value: 16423.95 mgc: 3.639707 ustep: 1 
iter: 2  value: 16423.95 mgc: 2.344643e-07 ustep: 1 
iter: 3  mgc: 5.911938e-15 
iter: 1  mgc: 5.911938e-15 
outer mgc:  0.04119905 
iter: 1  value: 16392.7 mgc: 3.639731 ustep: 1 
iter: 2  value: 16392.7 mgc: 8.575806e-08 ustep: 1 
mgc: 5.162537e-15 
iter: 1  mgc: 5.162537e-15 
outer mgc:  0.02502558 
iter: 1  value: 16361.46 mgc: 3.641693 ustep: 1 
iter: 2  value: 16361.46 mgc: 2.539872e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.01351563 
iter: 1  value: 16330.21 mgc: 3.641533 ustep: 1 
iter: 2  mgc: 7.283085e-09 
iter: 1  mgc: 7.283085e-09 
outer mgc:  0.005484898 
iter: 1  value: 16298.96 mgc: 3.642062 ustep: 1 
iter: 2  mgc: 1.686411e-09 
iter: 1  mgc: 1.686411e-09 
outer mgc:  0.002187278 
iter: 1  value: 16267.71 mgc: 3.642069 ustep: 1 
iter: 2  mgc: 4.881993e-10 
iter: 1  mgc: 4.881993e-10 
outer mgc:  0.0007858719 
iter: 1  value: 16236.46 mgc: 3.64218 ustep: 1 
iter: 2  mgc: 1.24464e-10 
iter: 1  mgc: 1.24464e-10 
outer mgc:  0.0003297119 
iter: 1  value: 16205.21 mgc: 3.642199 ustep: 1 
iter: 2  mgc: 3.4444e-11 
iter: 1  mgc: 3.4444e-11 
outer mgc:  0.0001933585 
iter: 1  value: 16173.96 mgc: 3.642225 ustep: 1 
iter: 2  mgc: 9.898748e-12 
iter: 1  mgc: 9.898748e-12 
outer mgc:  8.397552e-05 
iter: 1  value: 16142.71 mgc: 3.642234 ustep: 1 
iter: 2  mgc: 2.692957e-12 
iter: 1  mgc: 2.692957e-12 
outer mgc:  5.192301e-05 
iter: 1  value: 16111.46 mgc: 3.64224 ustep: 1 
iter: 2  mgc: 8.020251e-13 
iter: 1  mgc: 8.020251e-13 
outer mgc:  2.517741e-05 
iter: 1  mgc: 8.020251e-13 
iter: 1  mgc: 8.020251e-13 
outer mgc:  2.517741e-05 
iter: 1  value: 16111.45 mgc: 0.005835906 ustep: 1 
iter: 2  value: 16111.45 mgc: 7.962609e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.3086495 
iter: 1  value: 16111.46 mgc: 0.005834776 ustep: 1 
iter: 2  value: 16111.46 mgc: 8.013776e-08 ustep: 1 
iter: 3  mgc: 4.440892e-15 
outer mgc:  0.308609 
iter: 1  value: 16111.45 mgc: 0.00295177 ustep: 1 
iter: 2  value: 16111.45 mgc: 1.782841e-08 ustep: 1 
mgc: 5.245804e-15 
outer mgc:  0.168577 
iter: 1  value: 16111.46 mgc: 0.002950994 ustep: 1 
iter: 2  value: 16111.46 mgc: 1.788447e-08 ustep: 1 
mgc: 5.107026e-15 
outer mgc:  0.1684691 
iter: 1  value: 16111.46 mgc: 0.004842562 ustep: 1 
iter: 2  value: 16111.46 mgc: 1.264149e-08 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.2698657 
iter: 1  value: 16111.46 mgc: 0.004839654 ustep: 1 
iter: 2  value: 16111.46 mgc: 1.258768e-08 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.2696254 
iter: 1  value: 16111.46 mgc: 0.002740586 ustep: 1 
iter: 2  mgc: 1.921307e-09 
outer mgc:  0.1507413 
iter: 1  value: 16111.46 mgc: 0.002739243 ustep: 1 
iter: 2  mgc: 1.917202e-09 
outer mgc:  0.150599 
iter: 1  value: 16111.49 mgc: 0.003938649 ustep: 1 
iter: 2  value: 16111.49 mgc: 4.223208e-08 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.01164043 
iter: 1  value: 16111.42 mgc: 0.003942589 ustep: 1 
iter: 2  value: 16111.42 mgc: 4.221243e-08 ustep: 1 
mgc: 6.661338e-15 
outer mgc:  0.01158932 
iter: 1  value: 16111.51 mgc: 0.004192748 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  2.520379e-05 
iter: 1  value: 16111.41 mgc: 0.004196943 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  2.515106e-05 
iter: 1  value: 16111.45 mgc: 0.004118898 ustep: 1 
iter: 2  value: 16111.45 mgc: 4.813703e-08 ustep: 1 
mgc: 5.551115e-15 
outer mgc:  0.1638927 
iter: 1  value: 16111.47 mgc: 0.004115751 ustep: 1 
iter: 2  value: 16111.47 mgc: 4.803738e-08 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.163904 
[Mon Aug 16 08:04:27 2021]
Finished job 0.
1 of 1 steps (100%) done

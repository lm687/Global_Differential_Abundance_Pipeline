Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 09:32:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4469.154790 
iter  10 value 3290.146014
final  value 3290.145887 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2801.675 mgc: 146.6797 ustep: 1 
iter: 2  value: 2712.698 mgc: 57.88901 ustep: 1 
iter: 3  value: 2704.79 mgc: 25.24423 ustep: 1 
iter: 4  value: 2704.774 mgc: 0.5889815 ustep: 1 
iter: 5  value: 2704.774 mgc: 0.003726012 ustep: 1 
iter: 6  value: 2704.774 mgc: 1.063324e-07 ustep: 1 
iter: 7  mgc: 4.22995e-14 
iter: 1  mgc: 4.22995e-14 
Matching hessian patterns... Done
outer mgc:  935.5557 
iter: 1  value: 1733.605 mgc: 37.71442 ustep: 1 
iter: 2  value: 1697.985 mgc: 17.07284 ustep: 1 
iter: 3  value: 1697.641 mgc: 1.765456 ustep: 1 
iter: 4  value: 1697.641 mgc: 0.07962032 ustep: 1 
iter: 5  value: 1697.641 mgc: 0.0001855985 ustep: 1 
iter: 6  mgc: 1.015441e-09 
iter: 1  value: 1383.234 mgc: 65.75521 ustep: 0.6827823 
iter: 2  value: 478.0151 mgc: 85.28851 ustep: 0.8263238 
iter: 3  value: 440.2244 mgc: 16.60108 ustep: 0.9090326 
iter: 4  value: 439.4884 mgc: 3.280924 ustep: 0.9534367 
iter: 5  value: 439.4851 mgc: 0.2600806 ustep: 0.9764432 
iter: 6  value: 439.4851 mgc: 0.002466792 ustep: 0.9881526 
iter: 7  value: 439.4851 mgc: 2.459403e-06 ustep: 0.9940592 
iter: 8  mgc: 1.220309e-09 
iter: 1  mgc: 1.220309e-09 
outer mgc:  38.54152 
iter: 1  value: 607.8766 mgc: 67.8895 ustep: 1 
iter: 2  value: 603.1611 mgc: 6.248751 ustep: 1 
iter: 3  value: 603.1339 mgc: 0.4098471 ustep: 1 
iter: 4  value: 603.1339 mgc: 0.007429094 ustep: 1 
iter: 5  value: 603.1339 mgc: 3.507163e-06 ustep: 1 
iter: 6  mgc: 7.691625e-13 
iter: 1  value: 409.5251 mgc: 13.2247 ustep: 1 
iter: 2  value: 409.4991 mgc: 0.4459713 ustep: 1 
iter: 3  value: 409.4991 mgc: 0.00326279 ustep: 1 
iter: 4  value: 409.4991 mgc: 1.78362e-07 ustep: 1 
iter: 5  mgc: 3.319567e-14 
iter: 1  mgc: 3.319567e-14 
outer mgc:  38.18938 
iter: 1  value: 416.4804 mgc: 8.544189 ustep: 1 
iter: 2  value: 416.4669 mgc: 0.259481 ustep: 1 
iter: 3  value: 416.4669 mgc: 0.005249961 ustep: 1 
iter: 4  value: 416.4669 mgc: 3.251986e-06 ustep: 1 
iter: 5  mgc: 1.199041e-12 
iter: 1  value: 407.6462 mgc: 9.106166 ustep: 1 
iter: 2  value: 407.6416 mgc: 0.2297836 ustep: 1 
iter: 3  value: 407.6416 mgc: 0.0006925472 ustep: 1 
iter: 4  mgc: 7.842733e-09 
iter: 1  mgc: 7.842733e-09 
outer mgc:  38.19839 
iter: 1  value: 392.9112 mgc: 14.14508 ustep: 1 
iter: 2  value: 392.8778 mgc: 0.4547682 ustep: 1 
iter: 3  value: 392.8778 mgc: 0.002398668 ustep: 1 
iter: 4  value: 392.8778 mgc: 8.875127e-08 ustep: 1 
mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  11.48863 
iter: 1  value: 393.8919 mgc: 6.021652 ustep: 1 
iter: 2  value: 393.8153 mgc: 0.731237 ustep: 1 
iter: 3  value: 393.8152 mgc: 0.02605509 ustep: 1 
iter: 4  value: 393.8152 mgc: 3.830475e-05 ustep: 1 
iter: 5  mgc: 8.183476e-11 
iter: 1  value: 390.1258 mgc: 1.552152 ustep: 1 
iter: 2  value: 390.1249 mgc: 0.06246817 ustep: 1 
iter: 3  value: 390.1249 mgc: 0.0003891309 ustep: 1 
iter: 4  value: 390.1249 mgc: 1.626833e-08 ustep: 1 
mgc: 2.775558e-14 
iter: 1  mgc: 2.775558e-14 
outer mgc:  23.29526 
iter: 1  value: 397.9417 mgc: 22.6309 ustep: 1 
iter: 2  value: 397.865 mgc: 0.8180162 ustep: 1 
iter: 3  value: 397.865 mgc: 0.00804348 ustep: 1 
iter: 4  value: 397.865 mgc: 3.134579e-06 ustep: 1 
iter: 5  mgc: 5.688783e-13 
iter: 1  value: 387.902 mgc: 7.04215 ustep: 1 
iter: 2  value: 387.9006 mgc: 0.1171979 ustep: 1 
iter: 3  value: 387.9006 mgc: 9.601953e-05 ustep: 1 
iter: 4  mgc: 1.281866e-10 
iter: 1  mgc: 1.281866e-10 
outer mgc:  14.1552 
iter: 1  value: 387.1353 mgc: 6.808881 ustep: 1 
iter: 2  value: 387.127 mgc: 0.1884597 ustep: 1 
iter: 3  value: 387.127 mgc: 0.0006180852 ustep: 1 
iter: 4  mgc: 6.668517e-09 
iter: 1  mgc: 6.668517e-09 
outer mgc:  9.181934 
iter: 1  value: 386.3302 mgc: 7.584997 ustep: 1 
iter: 2  value: 386.3226 mgc: 0.2041783 ustep: 1 
iter: 3  value: 386.3226 mgc: 0.0002898382 ustep: 1 
iter: 4  mgc: 1.095223e-09 
iter: 1  mgc: 1.095223e-09 
outer mgc:  7.474851 
iter: 1  value: 386.5209 mgc: 5.990479 ustep: 1 
iter: 2  value: 386.5205 mgc: 0.05699924 ustep: 1 
iter: 3  value: 386.5205 mgc: 1.154483e-05 ustep: 1 
iter: 4  mgc: 4.694023e-13 
iter: 1  value: 386.0589 mgc: 3.478674 ustep: 1 
iter: 2  value: 386.0585 mgc: 0.04420949 ustep: 1 
iter: 3  value: 386.0585 mgc: 1.166626e-05 ustep: 1 
iter: 4  mgc: 2.327472e-12 
iter: 1  mgc: 2.327472e-12 
outer mgc:  3.60423 
iter: 1  value: 386.1519 mgc: 2.433797 ustep: 1 
iter: 2  value: 386.1519 mgc: 0.01592371 ustep: 1 
iter: 3  value: 386.1519 mgc: 8.685373e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  value: 385.9433 mgc: 0.857809 ustep: 1 
iter: 2  value: 385.9433 mgc: 0.002004073 ustep: 1 
iter: 3  value: 385.9433 mgc: 2.02384e-08 ustep: 1 
mgc: 2.758904e-14 
iter: 1  mgc: 2.758904e-14 
outer mgc:  1.217535 
iter: 1  value: 385.9259 mgc: 0.3218634 ustep: 1 
iter: 2  value: 385.9259 mgc: 0.0004068267 ustep: 1 
iter: 3  mgc: 2.710956e-09 
iter: 1  mgc: 2.710956e-09 
outer mgc:  1.112142 
iter: 1  value: 385.8689 mgc: 0.3517514 ustep: 1 
iter: 2  value: 385.8689 mgc: 0.0006566736 ustep: 1 
iter: 3  value: 385.8689 mgc: 2.442844e-08 ustep: 1 
mgc: 3.18634e-14 
iter: 1  mgc: 3.18634e-14 
outer mgc:  1.357211 
iter: 1  value: 385.8409 mgc: 0.6399961 ustep: 1 
iter: 2  value: 385.8409 mgc: 0.00048492 ustep: 1 
iter: 3  mgc: 1.992958e-09 
iter: 1  mgc: 1.992958e-09 
outer mgc:  0.7876312 
iter: 1  value: 385.8681 mgc: 0.4605132 ustep: 1 
iter: 2  value: 385.8681 mgc: 0.0005056731 ustep: 1 
iter: 3  mgc: 2.266373e-09 
iter: 1  mgc: 2.266373e-09 
outer mgc:  0.669218 
iter: 1  value: 385.8196 mgc: 0.5561243 ustep: 1 
iter: 2  value: 385.8196 mgc: 0.0003815806 ustep: 1 
iter: 3  value: 385.8196 mgc: 1.213965e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  value: 385.8314 mgc: 0.3376032 ustep: 1 
iter: 2  value: 385.8314 mgc: 0.0002253225 ustep: 1 
iter: 3  mgc: 2.198922e-10 
iter: 1  value: 385.843 mgc: 0.2449851 ustep: 1 
iter: 2  value: 385.843 mgc: 0.0001523139 ustep: 1 
iter: 3  mgc: 1.453839e-10 
iter: 1  mgc: 1.453839e-10 
outer mgc:  0.6189828 
iter: 1  value: 385.8378 mgc: 0.1491596 ustep: 1 
iter: 2  value: 385.8378 mgc: 8.157259e-05 ustep: 1 
iter: 3  mgc: 5.903684e-11 
iter: 1  mgc: 5.903684e-11 
outer mgc:  0.1337757 
iter: 1  value: 385.8197 mgc: 0.06460591 ustep: 1 
iter: 2  value: 385.8197 mgc: 3.949002e-05 ustep: 1 
iter: 3  mgc: 2.683098e-11 
iter: 1  mgc: 2.683098e-11 
outer mgc:  0.09751449 
iter: 1  value: 385.8203 mgc: 0.08184667 ustep: 1 
iter: 2  value: 385.8203 mgc: 2.64802e-05 ustep: 1 
iter: 3  mgc: 1.210365e-11 
iter: 1  mgc: 1.210365e-11 
outer mgc:  0.08154698 
iter: 1  value: 385.8242 mgc: 0.07708549 ustep: 1 
iter: 2  value: 385.8242 mgc: 2.933473e-05 ustep: 1 
iter: 3  mgc: 8.530426e-12 
iter: 1  mgc: 8.530426e-12 
outer mgc:  0.05172869 
iter: 1  value: 385.8236 mgc: 0.1073895 ustep: 1 
iter: 2  value: 385.8236 mgc: 7.60546e-05 ustep: 1 
iter: 3  mgc: 7.095924e-11 
iter: 1  value: 385.8247 mgc: 0.02132907 ustep: 1 
iter: 2  value: 385.8247 mgc: 3.131404e-06 ustep: 1 
iter: 3  mgc: 1.207923e-13 
iter: 1  mgc: 1.207923e-13 
outer mgc:  0.04039881 
iter: 1  value: 385.8204 mgc: 0.02529424 ustep: 1 
iter: 2  value: 385.8204 mgc: 1.771445e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
iter: 1  value: 385.8229 mgc: 0.01400381 ustep: 1 
iter: 2  value: 385.8229 mgc: 1.633534e-07 ustep: 1 
iter: 3  mgc: 3.640144e-14 
iter: 1  mgc: 3.640144e-14 
outer mgc:  0.01372594 
iter: 1  value: 385.8234 mgc: 0.008754306 ustep: 1 
iter: 2  value: 385.8234 mgc: 4.088961e-07 ustep: 1 
iter: 3  mgc: 1.731948e-14 
iter: 1  value: 385.8232 mgc: 0.003736355 ustep: 1 
iter: 2  value: 385.8232 mgc: 5.871977e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.00440707 
iter: 1  value: 385.8233 mgc: 0.001728265 ustep: 1 
iter: 2  value: 385.8233 mgc: 2.560012e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  0.001456517 
iter: 1  value: 385.8235 mgc: 0.002036005 ustep: 1 
iter: 2  value: 385.8235 mgc: 1.185411e-08 ustep: 1 
mgc: 3.064216e-14 
iter: 1  value: 385.8233 mgc: 0.0009261747 ustep: 1 
iter: 2  mgc: 1.786504e-09 
iter: 1  mgc: 1.786504e-09 
outer mgc:  0.001970516 
iter: 1  value: 385.8233 mgc: 0.0004863199 ustep: 1 
iter: 2  mgc: 6.230803e-10 
iter: 1  mgc: 6.230803e-10 
outer mgc:  0.0002487917 
iter: 1  mgc: 6.230803e-10 
iter: 1  mgc: 6.230803e-10 
outer mgc:  0.0002487917 
iter: 1  value: 385.823 mgc: 0.03971845 ustep: 1 
iter: 2  value: 385.823 mgc: 7.809692e-06 ustep: 1 
iter: 3  mgc: 4.221623e-13 
outer mgc:  0.06124793 
iter: 1  value: 385.8238 mgc: 0.03970889 ustep: 1 
iter: 2  value: 385.8238 mgc: 7.81867e-06 ustep: 1 
iter: 3  mgc: 4.237721e-13 
outer mgc:  0.06142788 
iter: 1  value: 385.8221 mgc: 0.01786956 ustep: 1 
iter: 2  value: 385.8221 mgc: 9.467885e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.1263349 
iter: 1  value: 385.8247 mgc: 0.0178582 ustep: 1 
iter: 2  value: 385.8247 mgc: 9.461986e-07 ustep: 1 
iter: 3  mgc: 3.042011e-14 
outer mgc:  0.1263933 
iter: 1  value: 385.8241 mgc: 0.03814732 ustep: 1 
iter: 2  value: 385.8241 mgc: 1.698932e-06 ustep: 1 
iter: 3  mgc: 2.287059e-14 
outer mgc:  0.09226915 
iter: 1  value: 385.8227 mgc: 0.03814577 ustep: 1 
iter: 2  value: 385.8227 mgc: 1.697645e-06 ustep: 1 
iter: 3  mgc: 2.775558e-14 
outer mgc:  0.09247795 
iter: 1  value: 385.8258 mgc: 0.0201566 ustep: 1 
iter: 2  value: 385.8258 mgc: 7.488079e-07 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.1654988 
iter: 1  value: 385.8211 mgc: 0.02016815 ustep: 1 
iter: 2  value: 385.8211 mgc: 7.48891e-07 ustep: 1 
iter: 3  mgc: 4.03011e-14 
outer mgc:  0.1650578 
iter: 1  value: 385.8218 mgc: 0.003829819 ustep: 1 
iter: 2  value: 385.8218 mgc: 1.238554e-07 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.008562068 
iter: 1  value: 385.8249 mgc: 0.00382723 ustep: 1 
iter: 2  value: 385.8249 mgc: 1.237547e-07 ustep: 1 
iter: 3  mgc: 3.657838e-14 
outer mgc:  0.00858103 
iter: 1  value: 385.8253 mgc: 0.0102015 ustep: 1 
iter: 2  value: 385.8253 mgc: 1.349575e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.05902216 
iter: 1  value: 385.8214 mgc: 0.01022845 ustep: 1 
iter: 2  value: 385.8214 mgc: 1.353916e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.05926435 
iter: 1  value: 385.8264 mgc: 0.01208466 ustep: 1 
iter: 2  value: 385.8264 mgc: 8.359423e-07 ustep: 1 
iter: 3  mgc: 3.619327e-14 
outer mgc:  0.05451968 
iter: 1  value: 385.8204 mgc: 0.01211714 ustep: 1 
iter: 2  value: 385.8204 mgc: 8.417568e-07 ustep: 1 
iter: 3  mgc: 5.040413e-14 
outer mgc:  0.05441318 
[Mon Aug 16 09:32:18 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:29:41 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22063.430593 
final  value 21317.564304 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4115.775 mgc: 110.0219 ustep: 1 
iter: 2  value: 3315.125 mgc: 50.94335 ustep: 1 
iter: 3  value: 2866.468 mgc: 87.60712 ustep: 1 
iter: 4  value: 2863.605 mgc: 5.680845 ustep: 1 
iter: 5  value: 2863.595 mgc: 0.4407809 ustep: 1 
iter: 6  value: 2863.595 mgc: 0.004199474 ustep: 1 
iter: 7  value: 2863.595 mgc: 3.938395e-07 ustep: 1 
iter: 8  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
Matching hessian patterns... Done
outer mgc:  970.5704 
iter: 1  value: 2437.681 mgc: 34.30798 ustep: 1 
iter: 2  value: 2435.123 mgc: 2.997908 ustep: 1 
iter: 3  value: 2435.122 mgc: 0.05036268 ustep: 1 
iter: 4  value: 2435.122 mgc: 5.30985e-05 ustep: 1 
iter: 5  mgc: 7.371437e-11 
iter: 1  mgc: 7.371437e-11 
outer mgc:  338.9037 
iter: 1  value: 2476.592 mgc: 26.13578 ustep: 1 
iter: 2  value: 2475.097 mgc: 1.673515 ustep: 1 
iter: 3  value: 2475.097 mgc: 0.02446431 ustep: 1 
iter: 4  value: 2475.097 mgc: 9.884197e-06 ustep: 1 
iter: 5  mgc: 2.078893e-12 
iter: 1  value: 2357.921 mgc: 11.91747 ustep: 1 
iter: 2  value: 2357.844 mgc: 0.3593133 ustep: 1 
iter: 3  value: 2357.844 mgc: 0.000954606 ustep: 1 
iter: 4  value: 2357.844 mgc: 1.401805e-08 ustep: 1 
mgc: 3.114176e-14 
iter: 1  mgc: 3.114176e-14 
outer mgc:  172.358 
iter: 1  value: 2349.781 mgc: 15.89725 ustep: 1 
iter: 2  value: 2349.487 mgc: 0.6812016 ustep: 1 
iter: 3  value: 2349.487 mgc: 0.003751547 ustep: 1 
iter: 4  value: 2349.487 mgc: 2.431934e-07 ustep: 1 
iter: 5  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  236.834 
iter: 1  value: 2284.893 mgc: 5.805238 ustep: 1 
iter: 2  value: 2284.875 mgc: 0.3516044 ustep: 1 
iter: 3  value: 2284.875 mgc: 0.005792408 ustep: 1 
iter: 4  value: 2284.875 mgc: 1.640362e-06 ustep: 1 
iter: 5  mgc: 1.310063e-13 
iter: 1  mgc: 1.310063e-13 
outer mgc:  58.89624 
iter: 1  value: 2269.764 mgc: 17.00762 ustep: 1 
iter: 2  value: 2268.534 mgc: 1.323891 ustep: 1 
iter: 3  value: 2268.534 mgc: 0.01803357 ustep: 1 
iter: 4  value: 2268.534 mgc: 6.078778e-06 ustep: 1 
iter: 5  mgc: 8.180123e-13 
iter: 1  mgc: 8.180123e-13 
outer mgc:  123.1713 
iter: 1  value: 2243.53 mgc: 11.03824 ustep: 1 
iter: 2  value: 2243.422 mgc: 0.4008387 ustep: 1 
iter: 3  value: 2243.422 mgc: 0.001514665 ustep: 1 
iter: 4  value: 2243.422 mgc: 5.506273e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  72.03376 
iter: 1  value: 2234.14 mgc: 20.06496 ustep: 1 
iter: 2  value: 2231.89 mgc: 1.860386 ustep: 1 
iter: 3  value: 2231.89 mgc: 0.02095219 ustep: 1 
iter: 4  value: 2231.89 mgc: 3.98853e-06 ustep: 1 
iter: 5  mgc: 2.222666e-13 
iter: 1  mgc: 2.222666e-13 
outer mgc:  44.47907 
iter: 1  value: 2222.19 mgc: 19.24888 ustep: 1 
iter: 2  value: 2221.135 mgc: 1.363541 ustep: 1 
iter: 3  value: 2221.135 mgc: 0.01599485 ustep: 1 
iter: 4  value: 2221.135 mgc: 4.308915e-06 ustep: 1 
iter: 5  mgc: 3.925749e-13 
iter: 1  mgc: 3.925749e-13 
outer mgc:  24.44748 
iter: 1  value: 2223.907 mgc: 10.29595 ustep: 1 
iter: 2  value: 2223.761 mgc: 0.3907727 ustep: 1 
iter: 3  value: 2223.761 mgc: 0.002101305 ustep: 1 
iter: 4  value: 2223.761 mgc: 9.266705e-08 ustep: 1 
mgc: 2.814415e-14 
iter: 1  value: 2221.828 mgc: 10.43903 ustep: 1 
iter: 2  value: 2221.74 mgc: 0.3426522 ustep: 1 
iter: 3  value: 2221.74 mgc: 0.000794816 ustep: 1 
iter: 4  value: 2221.74 mgc: 1.006693e-08 ustep: 1 
mgc: 4.13003e-14 
iter: 1  value: 2219.298 mgc: 4.844152 ustep: 1 
iter: 2  value: 2219.294 mgc: 0.06859743 ustep: 1 
iter: 3  value: 2219.294 mgc: 3.37552e-05 ustep: 1 
iter: 4  mgc: 1.865708e-11 
iter: 1  mgc: 1.865708e-11 
outer mgc:  28.87333 
iter: 1  value: 2219.197 mgc: 2.03561 ustep: 1 
iter: 2  value: 2219.197 mgc: 0.01529617 ustep: 1 
iter: 3  value: 2219.197 mgc: 1.368356e-06 ustep: 1 
iter: 4  mgc: 2.620126e-14 
iter: 1  value: 2218.311 mgc: 0.9355618 ustep: 1 
iter: 2  value: 2218.311 mgc: 0.003153193 ustep: 1 
iter: 3  value: 2218.311 mgc: 5.878293e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  12.04054 
iter: 1  value: 2217.719 mgc: 1.439083 ustep: 1 
iter: 2  value: 2217.719 mgc: 0.005860412 ustep: 1 
iter: 3  value: 2217.719 mgc: 2.363002e-07 ustep: 1 
iter: 4  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  13.26 
iter: 1  value: 2216.671 mgc: 1.250332 ustep: 1 
iter: 2  value: 2216.671 mgc: 0.005575501 ustep: 1 
iter: 3  value: 2216.671 mgc: 2.099731e-07 ustep: 1 
iter: 4  mgc: 2.237099e-14 
iter: 1  mgc: 2.237099e-14 
outer mgc:  22.19777 
iter: 1  value: 2215.218 mgc: 1.229266 ustep: 1 
iter: 2  value: 2215.217 mgc: 0.006855746 ustep: 1 
iter: 3  value: 2215.217 mgc: 1.477815e-06 ustep: 1 
iter: 4  mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  15.96561 
iter: 1  value: 2215.425 mgc: 2.059759 ustep: 1 
iter: 2  value: 2215.424 mgc: 0.01448659 ustep: 1 
iter: 3  value: 2215.424 mgc: 1.097922e-06 ustep: 1 
iter: 4  mgc: 2.88658e-14 
iter: 1  value: 2214.833 mgc: 0.6646753 ustep: 1 
iter: 2  value: 2214.833 mgc: 0.002859982 ustep: 1 
iter: 3  value: 2214.833 mgc: 2.520895e-07 ustep: 1 
iter: 4  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  18.84891 
iter: 1  value: 2214.07 mgc: 1.410634 ustep: 1 
iter: 2  value: 2214.07 mgc: 0.005825637 ustep: 1 
iter: 3  value: 2214.07 mgc: 3.585106e-07 ustep: 1 
iter: 4  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  4.121559 
iter: 1  value: 2214.246 mgc: 2.480948 ustep: 1 
iter: 2  value: 2214.246 mgc: 0.01496004 ustep: 1 
iter: 3  value: 2214.246 mgc: 1.93268e-06 ustep: 1 
iter: 4  mgc: 4.307665e-14 
iter: 1  value: 2213.994 mgc: 0.9954062 ustep: 1 
iter: 2  value: 2213.994 mgc: 0.002449326 ustep: 1 
iter: 3  value: 2213.994 mgc: 5.173041e-08 ustep: 1 
mgc: 3.169687e-14 
iter: 1  mgc: 3.169687e-14 
outer mgc:  5.534517 
iter: 1  value: 2214.155 mgc: 0.6366183 ustep: 1 
iter: 2  value: 2214.155 mgc: 0.001333391 ustep: 1 
iter: 3  value: 2214.155 mgc: 1.149377e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  value: 2213.982 mgc: 0.2038313 ustep: 1 
iter: 2  value: 2213.982 mgc: 0.0001233753 ustep: 1 
iter: 3  mgc: 9.998358e-11 
iter: 1  mgc: 9.998358e-11 
outer mgc:  3.724136 
iter: 1  value: 2213.944 mgc: 0.329388 ustep: 1 
iter: 2  value: 2213.944 mgc: 0.000334162 ustep: 1 
iter: 3  mgc: 9.0643e-10 
iter: 1  mgc: 9.0643e-10 
outer mgc:  4.52217 
iter: 1  value: 2213.933 mgc: 0.2548179 ustep: 1 
iter: 2  value: 2213.933 mgc: 0.0002208692 ustep: 1 
iter: 3  mgc: 4.198282e-10 
iter: 1  mgc: 4.198282e-10 
outer mgc:  2.272765 
iter: 1  value: 2213.915 mgc: 0.3642549 ustep: 1 
iter: 2  value: 2213.915 mgc: 0.0004731089 ustep: 1 
iter: 3  mgc: 2.769263e-09 
iter: 1  mgc: 2.769263e-09 
outer mgc:  3.292437 
iter: 1  value: 2213.954 mgc: 0.7476246 ustep: 1 
iter: 2  value: 2213.954 mgc: 0.00180769 ustep: 1 
iter: 3  value: 2213.954 mgc: 2.08916e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  3.011093 
iter: 1  value: 2213.888 mgc: 0.6244508 ustep: 1 
iter: 2  value: 2213.888 mgc: 0.001273592 ustep: 1 
iter: 3  value: 2213.888 mgc: 1.128674e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  4.016911 
iter: 1  value: 2213.773 mgc: 0.1509664 ustep: 1 
iter: 2  value: 2213.773 mgc: 0.0001537857 ustep: 1 
iter: 3  mgc: 6.110481e-10 
iter: 1  mgc: 6.110481e-10 
outer mgc:  4.735219 
iter: 1  value: 2213.823 mgc: 0.4779102 ustep: 1 
iter: 2  value: 2213.823 mgc: 0.0006772632 ustep: 1 
iter: 3  mgc: 2.973245e-09 
iter: 1  mgc: 2.973245e-09 
outer mgc:  4.418811 
iter: 1  value: 2213.857 mgc: 0.06191071 ustep: 1 
iter: 2  value: 2213.857 mgc: 7.032142e-05 ustep: 1 
iter: 3  mgc: 1.213136e-10 
iter: 1  mgc: 1.213136e-10 
outer mgc:  0.6699731 
iter: 1  value: 2213.881 mgc: 0.3526164 ustep: 1 
iter: 2  value: 2213.881 mgc: 0.0003590368 ustep: 1 
iter: 3  mgc: 9.231366e-10 
iter: 1  value: 2213.864 mgc: 0.1488053 ustep: 1 
iter: 2  value: 2213.864 mgc: 6.058797e-05 ustep: 1 
iter: 3  mgc: 2.45326e-11 
iter: 1  mgc: 2.45326e-11 
outer mgc:  0.3136983 
iter: 1  value: 2213.818 mgc: 0.1685727 ustep: 1 
iter: 2  value: 2213.818 mgc: 8.232414e-05 ustep: 1 
iter: 3  mgc: 4.19885e-11 
iter: 1  value: 2213.849 mgc: 0.0801831 ustep: 1 
iter: 2  value: 2213.849 mgc: 1.887249e-05 ustep: 1 
iter: 3  mgc: 2.163159e-12 
iter: 1  mgc: 2.163159e-12 
outer mgc:  0.8294105 
iter: 1  value: 2213.849 mgc: 0.03488203 ustep: 1 
iter: 2  value: 2213.849 mgc: 4.011237e-06 ustep: 1 
iter: 3  mgc: 8.926193e-14 
iter: 1  mgc: 8.926193e-14 
outer mgc:  0.1483579 
iter: 1  value: 2213.843 mgc: 0.007838758 ustep: 1 
iter: 2  value: 2213.843 mgc: 5.238313e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
iter: 1  value: 2213.836 mgc: 0.01030281 ustep: 1 
iter: 2  value: 2213.836 mgc: 9.056146e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.2843464 
iter: 1  value: 2213.843 mgc: 0.03606045 ustep: 1 
iter: 2  value: 2213.843 mgc: 1.428451e-05 ustep: 1 
iter: 3  mgc: 6.28031e-12 
iter: 1  mgc: 6.28031e-12 
outer mgc:  0.2110494 
iter: 1  value: 2213.841 mgc: 0.01013396 ustep: 1 
iter: 2  value: 2213.841 mgc: 3.130672e-06 ustep: 1 
iter: 3  mgc: 3.019807e-13 
iter: 1  mgc: 3.019807e-13 
outer mgc:  0.3233634 
iter: 1  value: 2213.84 mgc: 0.01687597 ustep: 1 
iter: 2  value: 2213.84 mgc: 9.771498e-07 ustep: 1 
iter: 3  mgc: 3.130829e-14 
iter: 1  mgc: 3.130829e-14 
outer mgc:  0.05963631 
iter: 1  value: 2213.836 mgc: 0.03822442 ustep: 1 
iter: 2  value: 2213.836 mgc: 5.514913e-06 ustep: 1 
iter: 3  mgc: 1.817435e-13 
iter: 1  value: 2213.838 mgc: 0.01547227 ustep: 1 
iter: 2  value: 2213.838 mgc: 7.722823e-07 ustep: 1 
iter: 3  mgc: 3.030909e-14 
iter: 1  mgc: 3.030909e-14 
outer mgc:  0.06674773 
iter: 1  value: 2213.836 mgc: 0.01277961 ustep: 1 
iter: 2  value: 2213.836 mgc: 7.327507e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.04679176 
iter: 1  value: 2213.84 mgc: 0.01471879 ustep: 1 
iter: 2  value: 2213.84 mgc: 7.27568e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.03807211 
iter: 1  value: 2213.839 mgc: 0.006781287 ustep: 1 
iter: 2  value: 2213.839 mgc: 1.331281e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.01693634 
iter: 1  value: 2213.838 mgc: 0.007695493 ustep: 1 
iter: 2  value: 2213.838 mgc: 2.000977e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
iter: 1  value: 2213.838 mgc: 0.005449397 ustep: 1 
iter: 2  value: 2213.838 mgc: 9.747102e-08 ustep: 1 
iter: 3  mgc: 2.864375e-14 
iter: 1  mgc: 2.864375e-14 
outer mgc:  0.02720649 
iter: 1  value: 2213.838 mgc: 0.001243162 ustep: 1 
iter: 2  mgc: 6.095175e-09 
iter: 1  mgc: 6.095175e-09 
outer mgc:  0.01164932 
iter: 1  value: 2213.838 mgc: 0.001003018 ustep: 1 
iter: 2  mgc: 3.098167e-09 
iter: 1  mgc: 3.098167e-09 
outer mgc:  0.001789305 
iter: 1  mgc: 3.098167e-09 
iter: 1  mgc: 3.098167e-09 
outer mgc:  0.001789305 
iter: 1  value: 2213.839 mgc: 0.05838809 ustep: 1 
iter: 2  value: 2213.839 mgc: 8.958298e-06 ustep: 1 
iter: 3  mgc: 7.132073e-13 
outer mgc:  0.2291249 
iter: 1  value: 2213.838 mgc: 0.05838248 ustep: 1 
iter: 2  value: 2213.838 mgc: 8.965499e-06 ustep: 1 
iter: 3  mgc: 7.185363e-13 
outer mgc:  0.2256164 
iter: 1  value: 2213.841 mgc: 0.03199007 ustep: 1 
iter: 2  value: 2213.841 mgc: 3.293627e-06 ustep: 1 
iter: 3  mgc: 9.281464e-14 
outer mgc:  1.089026 
iter: 1  value: 2213.836 mgc: 0.03198384 ustep: 1 
iter: 2  value: 2213.836 mgc: 3.294733e-06 ustep: 1 
iter: 3  mgc: 9.436896e-14 
outer mgc:  1.090517 
iter: 1  value: 2213.837 mgc: 0.05506999 ustep: 1 
iter: 2  value: 2213.837 mgc: 9.995937e-06 ustep: 1 
iter: 3  mgc: 7.089884e-13 
outer mgc:  0.2357339 
iter: 1  value: 2213.84 mgc: 0.05505667 ustep: 1 
iter: 2  value: 2213.84 mgc: 1.000602e-05 ustep: 1 
iter: 3  mgc: 7.027712e-13 
outer mgc:  0.2373008 
iter: 1  value: 2213.837 mgc: 0.02825945 ustep: 1 
iter: 2  value: 2213.837 mgc: 2.599909e-06 ustep: 1 
iter: 3  mgc: 4.851675e-14 
outer mgc:  0.8678857 
iter: 1  value: 2213.84 mgc: 0.02825038 ustep: 1 
iter: 2  value: 2213.84 mgc: 2.599355e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.8713593 
iter: 1  value: 2213.834 mgc: 0.006114708 ustep: 1 
iter: 2  value: 2213.834 mgc: 6.008049e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.07715766 
iter: 1  value: 2213.843 mgc: 0.006109305 ustep: 1 
iter: 2  value: 2213.843 mgc: 5.989908e-07 ustep: 1 
iter: 3  mgc: 2.527145e-14 
outer mgc:  0.07746248 
iter: 1  value: 2213.845 mgc: 0.01162471 ustep: 1 
iter: 2  value: 2213.845 mgc: 4.156768e-06 ustep: 1 
iter: 3  mgc: 5.329071e-13 
outer mgc:  0.1926624 
iter: 1  value: 2213.831 mgc: 0.01164829 ustep: 1 
iter: 2  value: 2213.831 mgc: 4.168912e-06 ustep: 1 
iter: 3  mgc: 5.320189e-13 
outer mgc:  0.1929342 
iter: 1  value: 2213.848 mgc: 0.007753696 ustep: 1 
iter: 2  value: 2213.848 mgc: 1.417665e-06 ustep: 1 
iter: 3  mgc: 5.240253e-14 
outer mgc:  0.1917414 
iter: 1  value: 2213.829 mgc: 0.007769492 ustep: 1 
iter: 2  value: 2213.829 mgc: 1.421889e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.1909205 
[Sun Aug 15 23:29:42 2021]
Finished job 0.
1 of 1 steps (100%) done

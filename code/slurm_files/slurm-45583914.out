Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:10:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_0_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_50_100_10_3_0_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_0_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10971.840927 
final  value 9088.511951 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3650.856 mgc: 150.515 ustep: 1 
iter: 2  value: 2690.135 mgc: 101.459 ustep: 0.2494656 
iter: 3  value: 1956.223 mgc: 127.562 ustep: 0.08285847 
iter: 4  value: 1658.744 mgc: 152.8129 ustep: 0.08137205 
iter: 5  value: 1259.974 mgc: 127.1552 ustep: 0.08053699 
iter: 6  value: 1062.094 mgc: 64.31289 ustep: 0.08006551 
iter: 7  value: 1046.492 mgc: 32.23259 ustep: 0.2830302 
iter: 8  value: 1045.614 mgc: 7.307877 ustep: 0.5320526 
iter: 9  value: 1045.597 mgc: 0.5243296 ustep: 0.7294464 
iter: 10  value: 1045.595 mgc: 0.03633446 ustep: 0.854091 
iter: 11  value: 1045.595 mgc: 0.006458441 ustep: 0.924178 
iter: 12  value: 1045.595 mgc: 0.0005878377 ustep: 0.9613456 
iter: 13  value: 1045.595 mgc: 2.723944e-05 ustep: 0.9804843 
iter: 14  value: 1045.595 mgc: 6.442503e-07 ustep: 0.9901951 
iter: 15  mgc: 7.648779e-09 
iter: 1  mgc: 7.648779e-09 
Matching hessian patterns... Done
outer mgc:  149.9138 
iter: 1  value: 1202.179 mgc: 37.28464 ustep: 1 
iter: 2  value: 1169.327 mgc: 10.29052 ustep: 1 
iter: 3  value: 1169.182 mgc: 0.7085027 ustep: 1 
iter: 4  value: 1169.182 mgc: 0.007926528 ustep: 1 
iter: 5  value: 1169.182 mgc: 1.387075e-06 ustep: 1 
iter: 6  mgc: 7.555068e-14 
iter: 1  value: 1022.29 mgc: 12.05591 ustep: 1 
iter: 2  value: 1022.13 mgc: 0.7397913 ustep: 1 
iter: 3  value: 1022.13 mgc: 0.004867568 ustep: 1 
iter: 4  value: 1022.13 mgc: 5.03915e-07 ustep: 1 
iter: 5  mgc: 4.107825e-14 
iter: 1  mgc: 4.107825e-14 
outer mgc:  42.04684 
iter: 1  value: 1010.439 mgc: 5.818895 ustep: 1 
iter: 2  value: 1010.436 mgc: 0.147833 ustep: 1 
iter: 3  value: 1010.436 mgc: 0.0001483478 ustep: 1 
iter: 4  mgc: 1.127662e-09 
iter: 1  mgc: 1.127662e-09 
outer mgc:  54.25837 
iter: 1  value: 998.2157 mgc: 25.51995 ustep: 1 
iter: 2  value: 988.2189 mgc: 6.040066 ustep: 1 
iter: 3  value: 988.1987 mgc: 0.2383131 ustep: 1 
iter: 4  value: 988.1987 mgc: 0.001232649 ustep: 1 
iter: 5  value: 988.1987 mgc: 4.348342e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  75.80638 
iter: 1  value: 958.8486 mgc: 17.41123 ustep: 1 
iter: 2  value: 957.5138 mgc: 2.310927 ustep: 1 
iter: 3  value: 957.5133 mgc: 0.0358295 ustep: 1 
iter: 4  value: 957.5133 mgc: 2.841298e-05 ustep: 1 
iter: 5  mgc: 2.992151e-11 
iter: 1  value: 952.9028 mgc: 25.35669 ustep: 1 
iter: 2  value: 946.968 mgc: 4.855169 ustep: 1 
iter: 3  value: 946.9606 mgc: 0.1451336 ustep: 1 
iter: 4  value: 946.9606 mgc: 0.0004333192 ustep: 1 
iter: 5  mgc: 6.239363e-09 
iter: 1  mgc: 6.239363e-09 
outer mgc:  38.31928 
iter: 1  value: 1093.645 mgc: 39.74479 ustep: 1 
iter: 2  value: 1091.242 mgc: 3.507201 ustep: 1 
iter: 3  value: 1091.241 mgc: 0.1272515 ustep: 1 
iter: 4  value: 1091.241 mgc: 0.0002113942 ustep: 1 
iter: 5  mgc: 8.786838e-10 
iter: 1  value: 940.3161 mgc: 6.618375 ustep: 1 
iter: 2  value: 940.3119 mgc: 0.1544107 ustep: 1 
iter: 3  value: 940.3119 mgc: 0.0001673307 ustep: 1 
iter: 4  mgc: 4.114762e-10 
iter: 1  mgc: 4.114762e-10 
outer mgc:  49.56596 
iter: 1  value: 937.802 mgc: 7.988842 ustep: 1 
iter: 2  value: 937.7439 mgc: 0.3553452 ustep: 1 
iter: 3  value: 937.7439 mgc: 0.001403644 ustep: 1 
iter: 4  value: 937.7439 mgc: 4.526865e-08 ustep: 1 
iter: 5  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  53.96283 
iter: 1  value: 929.9476 mgc: 2.294393 ustep: 1 
iter: 2  value: 929.9458 mgc: 0.08064364 ustep: 1 
iter: 3  value: 929.9458 mgc: 0.0005208002 ustep: 1 
iter: 4  value: 929.9458 mgc: 2.21759e-08 ustep: 1 
mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  23.02385 
iter: 1  value: 923.4177 mgc: 14.58343 ustep: 1 
iter: 2  value: 921.6778 mgc: 1.760428 ustep: 1 
iter: 3  value: 921.6772 mgc: 0.03027729 ustep: 1 
iter: 4  value: 921.6772 mgc: 2.808625e-05 ustep: 1 
iter: 5  mgc: 4.711165e-11 
iter: 1  mgc: 4.711165e-11 
outer mgc:  39.5962 
iter: 1  value: 915.743 mgc: 23.64182 ustep: 1 
iter: 2  value: 914.3276 mgc: 2.028278 ustep: 1 
iter: 3  value: 914.3273 mgc: 0.02186742 ustep: 1 
iter: 4  value: 914.3273 mgc: 7.511923e-06 ustep: 1 
iter: 5  mgc: 1.322498e-12 
iter: 1  mgc: 1.322498e-12 
outer mgc:  48.69251 
iter: 1  value: 970.0089 mgc: 29.05711 ustep: 1 
iter: 2  value: 965.8337 mgc: 3.561784 ustep: 1 
iter: 3  value: 965.832 mgc: 0.06863362 ustep: 1 
iter: 4  value: 965.832 mgc: 5.879073e-05 ustep: 1 
iter: 5  mgc: 6.167511e-11 
iter: 1  value: 912.0645 mgc: 6.135949 ustep: 1 
iter: 2  value: 912.063 mgc: 0.07754808 ustep: 1 
iter: 3  value: 912.063 mgc: 3.681496e-05 ustep: 1 
iter: 4  mgc: 1.413774e-11 
iter: 1  mgc: 1.413774e-11 
outer mgc:  30.40929 
iter: 1  value: 911.2346 mgc: 3.258133 ustep: 1 
iter: 2  value: 911.2343 mgc: 0.04300915 ustep: 1 
iter: 3  value: 911.2343 mgc: 1.679727e-05 ustep: 1 
iter: 4  mgc: 3.097522e-12 
iter: 1  mgc: 3.097522e-12 
outer mgc:  36.75722 
iter: 1  value: 910.6771 mgc: 0.8588608 ustep: 1 
iter: 2  value: 910.677 mgc: 0.03066989 ustep: 1 
iter: 3  value: 910.677 mgc: 4.238432e-05 ustep: 1 
iter: 4  mgc: 8.115952e-11 
iter: 1  mgc: 8.115952e-11 
outer mgc:  8.109449 
iter: 1  value: 909.8908 mgc: 2.623991 ustep: 1 
iter: 2  value: 909.8905 mgc: 0.02263304 ustep: 1 
iter: 3  value: 909.8905 mgc: 1.999777e-05 ustep: 1 
iter: 4  mgc: 1.577316e-11 
iter: 1  mgc: 1.577316e-11 
outer mgc:  3.867169 
iter: 1  value: 910.4975 mgc: 1.328522 ustep: 1 
iter: 2  value: 910.4975 mgc: 0.007318049 ustep: 1 
iter: 3  value: 910.4975 mgc: 5.395544e-07 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  value: 910.0059 mgc: 0.7395136 ustep: 1 
iter: 2  value: 910.0059 mgc: 0.004153471 ustep: 1 
iter: 3  value: 910.0059 mgc: 7.2059e-07 ustep: 1 
iter: 4  mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  6.278368 
iter: 1  value: 910.3975 mgc: 1.403823 ustep: 1 
iter: 2  value: 910.3975 mgc: 0.009052862 ustep: 1 
iter: 3  value: 910.3975 mgc: 1.764598e-06 ustep: 1 
iter: 4  mgc: 1.376677e-13 
iter: 1  value: 909.96 mgc: 0.5442879 ustep: 1 
iter: 2  value: 909.96 mgc: 0.001381814 ustep: 1 
iter: 3  value: 909.96 mgc: 1.993738e-08 ustep: 1 
mgc: 3.93019e-14 
iter: 1  mgc: 3.93019e-14 
outer mgc:  3.628904 
iter: 1  value: 910.0725 mgc: 0.5914433 ustep: 1 
iter: 2  value: 910.0725 mgc: 0.001815904 ustep: 1 
iter: 3  value: 910.0725 mgc: 1.902277e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  1.151305 
iter: 1  value: 910.0449 mgc: 0.5690438 ustep: 1 
iter: 2  value: 910.0449 mgc: 0.001844948 ustep: 1 
iter: 3  value: 910.0449 mgc: 3.814719e-08 ustep: 1 
mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  2.133456 
iter: 1  value: 910.0215 mgc: 0.3498704 ustep: 1 
iter: 2  value: 910.0215 mgc: 0.0003506074 ustep: 1 
iter: 3  mgc: 2.410807e-09 
iter: 1  mgc: 2.410807e-09 
outer mgc:  2.557728 
iter: 1  value: 910.0292 mgc: 0.08035647 ustep: 1 
iter: 2  value: 910.0292 mgc: 5.414284e-05 ustep: 1 
iter: 3  mgc: 5.090728e-11 
iter: 1  mgc: 5.090728e-11 
outer mgc:  1.67428 
iter: 1  value: 910.0481 mgc: 0.1215361 ustep: 1 
iter: 2  value: 910.0481 mgc: 0.000165268 ustep: 1 
iter: 3  mgc: 3.924008e-10 
iter: 1  mgc: 3.924008e-10 
outer mgc:  1.249909 
iter: 1  value: 910.0709 mgc: 0.218991 ustep: 1 
iter: 2  value: 910.0709 mgc: 0.0002011634 ustep: 1 
iter: 3  mgc: 1.447651e-09 
iter: 1  value: 910.057 mgc: 0.176233 ustep: 1 
iter: 2  value: 910.057 mgc: 0.0001027434 ustep: 1 
iter: 3  mgc: 1.109782e-10 
iter: 1  value: 910.0499 mgc: 0.07626831 ustep: 1 
iter: 2  value: 910.0499 mgc: 1.922368e-05 ustep: 1 
iter: 3  mgc: 3.889972e-12 
iter: 1  mgc: 3.889972e-12 
outer mgc:  0.1650707 
iter: 1  value: 910.046 mgc: 0.07791114 ustep: 1 
iter: 2  value: 910.046 mgc: 3.269169e-05 ustep: 1 
iter: 3  mgc: 8.025136e-12 
iter: 1  mgc: 8.025136e-12 
outer mgc:  0.2057958 
iter: 1  value: 910.0425 mgc: 0.03350771 ustep: 1 
iter: 2  value: 910.0425 mgc: 6.451635e-06 ustep: 1 
iter: 3  mgc: 1.034284e-12 
iter: 1  mgc: 1.034284e-12 
outer mgc:  0.131534 
iter: 1  value: 910.041 mgc: 0.009938443 ustep: 1 
iter: 2  value: 910.041 mgc: 1.937739e-06 ustep: 1 
iter: 3  mgc: 2.309264e-13 
iter: 1  mgc: 2.309264e-13 
outer mgc:  0.2225847 
iter: 1  value: 910.0489 mgc: 0.04148945 ustep: 1 
iter: 2  value: 910.0489 mgc: 5.412998e-06 ustep: 1 
iter: 3  mgc: 2.222666e-13 
iter: 1  mgc: 2.222666e-13 
outer mgc:  0.1257117 
iter: 1  value: 910.0437 mgc: 0.02137047 ustep: 1 
iter: 2  value: 910.0437 mgc: 7.37529e-06 ustep: 1 
iter: 3  mgc: 1.342926e-12 
iter: 1  mgc: 1.342926e-12 
outer mgc:  0.02457818 
iter: 1  value: 910.0451 mgc: 0.03079409 ustep: 1 
iter: 2  value: 910.0451 mgc: 7.821898e-06 ustep: 1 
iter: 3  mgc: 2.209344e-13 
iter: 1  value: 910.0441 mgc: 0.01182573 ustep: 1 
iter: 2  value: 910.0441 mgc: 1.087618e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.0208258 
iter: 1  value: 910.0408 mgc: 0.008843515 ustep: 1 
iter: 2  value: 910.0408 mgc: 6.890356e-07 ustep: 1 
iter: 3  mgc: 4.463097e-14 
iter: 1  value: 910.0426 mgc: 0.00351805 ustep: 1 
iter: 2  value: 910.0426 mgc: 1.492797e-07 ustep: 1 
iter: 3  mgc: 4.152234e-14 
iter: 1  mgc: 4.152234e-14 
outer mgc:  0.01082047 
iter: 1  value: 910.0433 mgc: 0.006111376 ustep: 1 
iter: 2  value: 910.0433 mgc: 2.199113e-07 ustep: 1 
iter: 3  mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  0.01821291 
iter: 1  value: 910.0429 mgc: 0.002999844 ustep: 1 
iter: 2  value: 910.0429 mgc: 3.782341e-08 ustep: 1 
mgc: 4.03011e-14 
iter: 1  mgc: 4.03011e-14 
outer mgc:  0.003200156 
iter: 1  value: 910.043 mgc: 0.0003218206 ustep: 1 
iter: 2  mgc: 7.082455e-10 
iter: 1  mgc: 7.082455e-10 
outer mgc:  0.0001217084 
iter: 1  mgc: 7.082455e-10 
iter: 1  mgc: 7.082455e-10 
outer mgc:  0.0001217084 
iter: 1  value: 910.0416 mgc: 0.04184943 ustep: 1 
iter: 2  value: 910.0416 mgc: 9.559487e-06 ustep: 1 
iter: 3  mgc: 7.848167e-13 
outer mgc:  0.107551 
iter: 1  value: 910.0445 mgc: 0.04183253 ustep: 1 
iter: 2  value: 910.0445 mgc: 9.567365e-06 ustep: 1 
iter: 3  mgc: 7.784884e-13 
outer mgc:  0.1076801 
iter: 1  value: 910.0424 mgc: 0.02116951 ustep: 1 
iter: 2  value: 910.0424 mgc: 2.703971e-06 ustep: 1 
iter: 3  mgc: 6.949996e-14 
outer mgc:  0.3267606 
iter: 1  value: 910.0438 mgc: 0.02115891 ustep: 1 
iter: 2  value: 910.0438 mgc: 2.704704e-06 ustep: 1 
iter: 3  mgc: 7.31637e-14 
outer mgc:  0.3264934 
iter: 1  value: 910.0452 mgc: 0.05795502 ustep: 1 
iter: 2  value: 910.0452 mgc: 8.607156e-06 ustep: 1 
iter: 3  mgc: 4.520828e-13 
outer mgc:  0.1783226 
iter: 1  value: 910.0409 mgc: 0.05796258 ustep: 1 
iter: 2  value: 910.0409 mgc: 8.596257e-06 ustep: 1 
iter: 3  mgc: 4.849454e-13 
outer mgc:  0.1783043 
iter: 1  value: 910.0446 mgc: 0.03017244 ustep: 1 
iter: 2  value: 910.0446 mgc: 2.261943e-06 ustep: 1 
iter: 3  mgc: 5.57332e-14 
outer mgc:  0.5972931 
iter: 1  value: 910.0419 mgc: 0.03017555 ustep: 1 
iter: 2  value: 910.0419 mgc: 2.261299e-06 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  0.5973823 
iter: 1  value: 910.0397 mgc: 0.004976737 ustep: 1 
iter: 2  value: 910.0397 mgc: 4.771377e-07 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  0.03026951 
iter: 1  value: 910.0462 mgc: 0.004972819 ustep: 1 
iter: 2  value: 910.0462 mgc: 4.765027e-07 ustep: 1 
iter: 3  mgc: 4.676814e-14 
outer mgc:  0.03021456 
iter: 1  value: 910.0494 mgc: 0.008996708 ustep: 1 
iter: 2  value: 910.0494 mgc: 3.534332e-06 ustep: 1 
iter: 3  mgc: 5.431211e-13 
outer mgc:  0.1015854 
iter: 1  value: 910.0366 mgc: 0.009015722 ustep: 1 
iter: 2  value: 910.0366 mgc: 3.542402e-06 ustep: 1 
iter: 3  mgc: 5.462297e-13 
outer mgc:  0.101845 
iter: 1  value: 910.0478 mgc: 0.01122306 ustep: 1 
iter: 2  value: 910.0478 mgc: 1.50012e-06 ustep: 1 
iter: 3  mgc: 1.056932e-13 
outer mgc:  0.1100905 
iter: 1  value: 910.0383 mgc: 0.01125099 ustep: 1 
iter: 2  value: 910.0383 mgc: 1.507484e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
outer mgc:  0.1100573 
[Sun Aug 15 20:10:49 2021]
Finished job 0.
1 of 1 steps (100%) done

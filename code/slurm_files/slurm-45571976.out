Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 23:24:06 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22066.726430 
final  value 20544.754225 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2573.697 mgc: 104.3203 ustep: 1 
iter: 2  value: 2445.381 mgc: 18.82862 ustep: 1 
iter: 3  value: 2440.467 mgc: 5.224895 ustep: 1 
iter: 4  value: 2440.36 mgc: 0.9960544 ustep: 1 
iter: 5  value: 2440.359 mgc: 0.06321319 ustep: 1 
iter: 6  value: 2440.359 mgc: 0.0003034214 ustep: 1 
iter: 7  mgc: 7.081688e-09 
iter: 1  mgc: 7.081688e-09 
Matching hessian patterns... Done
outer mgc:  95.14592 
iter: 1  value: 2398.664 mgc: 18.57755 ustep: 1 
iter: 2  value: 2394.401 mgc: 2.139121 ustep: 1 
iter: 3  value: 2394.398 mgc: 0.1021725 ustep: 1 
iter: 4  value: 2394.398 mgc: 0.0004805513 ustep: 1 
iter: 5  value: 2394.398 mgc: 1.075966e-08 ustep: 1 
mgc: 3.517672e-14 
iter: 1  mgc: 3.517672e-14 
outer mgc:  136.8297 
iter: 1  value: 2381.21 mgc: 29.82621 ustep: 1 
iter: 2  value: 2370.751 mgc: 4.081678 ustep: 1 
iter: 3  value: 2370.736 mgc: 0.1404113 ustep: 1 
iter: 4  value: 2370.736 mgc: 0.0009786077 ustep: 1 
iter: 5  value: 2370.736 mgc: 6.027268e-08 ustep: 1 
iter: 6  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  310.1797 
iter: 1  value: 2763.678 mgc: 26.47985 ustep: 1 
iter: 2  value: 2761.704 mgc: 1.97935 ustep: 1 
iter: 3  value: 2761.704 mgc: 0.03067221 ustep: 1 
iter: 4  value: 2761.704 mgc: 1.208234e-05 ustep: 1 
iter: 5  mgc: 2.907452e-12 
iter: 1  value: 2330.816 mgc: 6.099296 ustep: 1 
iter: 2  value: 2330.809 mgc: 0.1042386 ustep: 1 
iter: 3  value: 2330.809 mgc: 9.790837e-05 ustep: 1 
iter: 4  mgc: 1.162315e-10 
iter: 1  mgc: 1.162315e-10 
outer mgc:  70.07176 
iter: 1  value: 2314.581 mgc: 8.468647 ustep: 1 
iter: 2  value: 2314.543 mgc: 0.2944374 ustep: 1 
iter: 3  value: 2314.543 mgc: 0.0007266106 ustep: 1 
iter: 4  mgc: 6.568504e-09 
iter: 1  mgc: 6.568504e-09 
outer mgc:  52.11212 
iter: 1  value: 2306.169 mgc: 6.835267 ustep: 1 
iter: 2  value: 2306.162 mgc: 0.1517914 ustep: 1 
iter: 3  value: 2306.162 mgc: 0.0002031213 ustep: 1 
iter: 4  mgc: 4.852843e-10 
iter: 1  mgc: 4.852843e-10 
outer mgc:  68.91043 
iter: 1  value: 2289.509 mgc: 23.58925 ustep: 1 
iter: 2  value: 2288.236 mgc: 2.107787 ustep: 1 
iter: 3  value: 2288.236 mgc: 0.03427531 ustep: 1 
iter: 4  value: 2288.236 mgc: 1.272182e-05 ustep: 1 
iter: 5  mgc: 4.174883e-12 
iter: 1  mgc: 4.174883e-12 
outer mgc:  58.72189 
iter: 1  value: 2276.287 mgc: 12.14261 ustep: 1 
iter: 2  value: 2275.971 mgc: 0.6491873 ustep: 1 
iter: 3  value: 2275.971 mgc: 0.003671508 ustep: 1 
iter: 4  value: 2275.971 mgc: 3.371741e-07 ustep: 1 
iter: 5  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  52.41662 
iter: 1  value: 2270.832 mgc: 13.15559 ustep: 1 
iter: 2  value: 2270.417 mgc: 0.7398398 ustep: 1 
iter: 3  value: 2270.417 mgc: 0.003468797 ustep: 1 
iter: 4  value: 2270.417 mgc: 2.224348e-07 ustep: 1 
iter: 5  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  66.39952 
iter: 1  value: 2318.451 mgc: 10.78587 ustep: 1 
iter: 2  value: 2318.323 mgc: 0.4555903 ustep: 1 
iter: 3  value: 2318.323 mgc: 0.002964255 ustep: 1 
iter: 4  value: 2318.323 mgc: 1.997908e-07 ustep: 1 
iter: 5  mgc: 4.418688e-14 
iter: 1  value: 2267.383 mgc: 1.843451 ustep: 1 
iter: 2  value: 2267.383 mgc: 0.01582791 ustep: 1 
iter: 3  value: 2267.383 mgc: 2.248715e-06 ustep: 1 
iter: 4  mgc: 6.350476e-14 
iter: 1  mgc: 6.350476e-14 
outer mgc:  29.99205 
iter: 1  value: 2266.716 mgc: 3.795261 ustep: 1 
iter: 2  value: 2266.714 mgc: 0.05072858 ustep: 1 
iter: 3  value: 2266.714 mgc: 2.133297e-05 ustep: 1 
iter: 4  mgc: 7.077006e-12 
iter: 1  mgc: 7.077006e-12 
outer mgc:  53.10381 
iter: 1  value: 2264.624 mgc: 2.909628 ustep: 1 
iter: 2  value: 2264.623 mgc: 0.02836171 ustep: 1 
iter: 3  value: 2264.623 mgc: 6.774132e-06 ustep: 1 
iter: 4  mgc: 5.879741e-13 
iter: 1  mgc: 5.879741e-13 
outer mgc:  10.5792 
iter: 1  value: 2263.788 mgc: 1.577279 ustep: 1 
iter: 2  value: 2263.788 mgc: 0.01022886 ustep: 1 
iter: 3  value: 2263.788 mgc: 7.543591e-07 ustep: 1 
iter: 4  mgc: 3.042011e-14 
iter: 1  mgc: 3.042011e-14 
outer mgc:  9.375438 
iter: 1  value: 2264.175 mgc: 3.367937 ustep: 1 
iter: 2  value: 2264.174 mgc: 0.04457998 ustep: 1 
iter: 3  value: 2264.174 mgc: 1.701549e-05 ustep: 1 
iter: 4  mgc: 4.693135e-12 
iter: 1  mgc: 4.693135e-12 
outer mgc:  14.46698 
iter: 1  value: 2263.674 mgc: 4.101447 ustep: 1 
iter: 2  value: 2263.672 mgc: 0.05558405 ustep: 1 
iter: 3  value: 2263.672 mgc: 2.548474e-05 ustep: 1 
iter: 4  mgc: 7.811529e-12 
iter: 1  value: 2263.194 mgc: 3.185576 ustep: 1 
iter: 2  value: 2263.194 mgc: 0.03146562 ustep: 1 
iter: 3  value: 2263.194 mgc: 9.103052e-06 ustep: 1 
iter: 4  mgc: 9.85434e-13 
iter: 1  mgc: 9.85434e-13 
outer mgc:  5.708247 
iter: 1  value: 2262.821 mgc: 1.979974 ustep: 1 
iter: 2  value: 2262.82 mgc: 0.01702736 ustep: 1 
iter: 3  value: 2262.82 mgc: 2.994221e-06 ustep: 1 
iter: 4  mgc: 1.98952e-13 
iter: 1  value: 2263.2 mgc: 0.8141133 ustep: 1 
iter: 2  value: 2263.2 mgc: 0.002202435 ustep: 1 
iter: 3  value: 2263.2 mgc: 4.086597e-08 ustep: 1 
mgc: 3.216871e-14 
iter: 1  value: 2263.158 mgc: 0.2978641 ustep: 1 
iter: 2  value: 2263.158 mgc: 0.0002932756 ustep: 1 
iter: 3  mgc: 7.26236e-10 
iter: 1  mgc: 7.26236e-10 
outer mgc:  2.734213 
iter: 1  value: 2263.104 mgc: 0.09229065 ustep: 1 
iter: 2  value: 2263.104 mgc: 4.174759e-05 ustep: 1 
iter: 3  mgc: 1.489298e-11 
iter: 1  mgc: 1.489298e-11 
outer mgc:  2.593897 
iter: 1  value: 2263.055 mgc: 0.2531006 ustep: 1 
iter: 2  value: 2263.055 mgc: 0.0002237057 ustep: 1 
iter: 3  mgc: 4.87743e-10 
iter: 1  mgc: 4.87743e-10 
outer mgc:  2.366405 
iter: 1  value: 2262.989 mgc: 0.108852 ustep: 1 
iter: 2  value: 2262.989 mgc: 5.840551e-05 ustep: 1 
iter: 3  mgc: 2.910649e-11 
iter: 1  mgc: 2.910649e-11 
outer mgc:  1.863935 
iter: 1  value: 2263.004 mgc: 0.1563739 ustep: 1 
iter: 2  value: 2263.004 mgc: 0.0001480406 ustep: 1 
iter: 3  mgc: 1.783746e-10 
iter: 1  mgc: 1.783746e-10 
outer mgc:  0.4569786 
iter: 1  value: 2262.981 mgc: 0.1695942 ustep: 1 
iter: 2  value: 2262.981 mgc: 9.27357e-05 ustep: 1 
iter: 3  mgc: 6.764678e-11 
iter: 1  value: 2262.995 mgc: 0.07588297 ustep: 1 
iter: 2  value: 2262.995 mgc: 2.381606e-05 ustep: 1 
iter: 3  mgc: 5.763834e-12 
iter: 1  mgc: 5.763834e-12 
outer mgc:  0.4935111 
iter: 1  value: 2262.988 mgc: 0.03940997 ustep: 1 
iter: 2  value: 2262.988 mgc: 5.553271e-06 ustep: 1 
iter: 3  mgc: 3.530509e-13 
iter: 1  mgc: 3.530509e-13 
outer mgc:  0.3052418 
iter: 1  value: 2262.978 mgc: 0.0221889 ustep: 1 
iter: 2  value: 2262.978 mgc: 3.073037e-06 ustep: 1 
iter: 3  mgc: 2.842171e-13 
iter: 1  value: 2262.984 mgc: 0.01906202 ustep: 1 
iter: 2  value: 2262.984 mgc: 1.447155e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  0.2526972 
iter: 1  value: 2262.984 mgc: 0.01821568 ustep: 1 
iter: 2  value: 2262.984 mgc: 1.075742e-06 ustep: 1 
iter: 3  mgc: 4.146683e-14 
iter: 1  mgc: 4.146683e-14 
outer mgc:  0.07806405 
iter: 1  value: 2262.988 mgc: 0.04447112 ustep: 1 
iter: 2  value: 2262.988 mgc: 5.904772e-06 ustep: 1 
iter: 3  mgc: 2.429168e-13 
iter: 1  value: 2262.986 mgc: 0.01979197 ustep: 1 
iter: 2  value: 2262.986 mgc: 1.219035e-06 ustep: 1 
iter: 3  mgc: 4.252154e-14 
iter: 1  mgc: 4.252154e-14 
outer mgc:  0.06522394 
iter: 1  value: 2262.986 mgc: 0.01060332 ustep: 1 
iter: 2  value: 2262.986 mgc: 6.317996e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  0.02245808 
iter: 1  value: 2262.987 mgc: 0.004315291 ustep: 1 
iter: 2  value: 2262.987 mgc: 8.670517e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  value: 2262.986 mgc: 0.004445481 ustep: 1 
iter: 2  value: 2262.986 mgc: 7.890042e-08 ustep: 1 
mgc: 3.58602e-14 
iter: 1  mgc: 3.58602e-14 
outer mgc:  0.02253894 
iter: 1  value: 2262.988 mgc: 0.003918944 ustep: 1 
iter: 2  value: 2262.988 mgc: 5.369993e-08 ustep: 1 
iter: 3  mgc: 2.992051e-14 
iter: 1  value: 2262.987 mgc: 0.001227242 ustep: 1 
iter: 2  mgc: 8.26689e-09 
iter: 1  mgc: 8.26689e-09 
outer mgc:  0.01862263 
iter: 1  value: 2262.986 mgc: 0.001635956 ustep: 1 
iter: 2  mgc: 8.80506e-09 
iter: 1  mgc: 8.80506e-09 
outer mgc:  0.01894007 
iter: 1  value: 2262.987 mgc: 0.0009862618 ustep: 1 
iter: 2  mgc: 5.650168e-09 
iter: 1  mgc: 5.650168e-09 
outer mgc:  0.006414764 
iter: 1  value: 2262.987 mgc: 0.0004368692 ustep: 1 
iter: 2  mgc: 5.700116e-09 
iter: 1  mgc: 5.650168e-09 
iter: 1  mgc: 5.650168e-09 
outer mgc:  0.006414764 
iter: 1  value: 2262.989 mgc: 0.05871358 ustep: 1 
iter: 2  value: 2262.989 mgc: 8.506635e-06 ustep: 1 
iter: 3  mgc: 5.333511e-13 
outer mgc:  0.2991337 
iter: 1  value: 2262.984 mgc: 0.05871436 ustep: 1 
iter: 2  value: 2262.984 mgc: 8.515547e-06 ustep: 1 
iter: 3  mgc: 5.17808e-13 
outer mgc:  0.2978541 
iter: 1  value: 2262.988 mgc: 0.03151657 ustep: 1 
iter: 2  value: 2262.988 mgc: 2.530943e-06 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  1.22391 
iter: 1  value: 2262.986 mgc: 0.03151927 ustep: 1 
iter: 2  value: 2262.986 mgc: 2.530296e-06 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  1.236732 
iter: 1  value: 2262.985 mgc: 0.05088698 ustep: 1 
iter: 2  value: 2262.985 mgc: 9.518451e-06 ustep: 1 
iter: 3  mgc: 7.392975e-13 
outer mgc:  0.2482889 
iter: 1  value: 2262.988 mgc: 0.05087523 ustep: 1 
iter: 2  value: 2262.988 mgc: 9.528292e-06 ustep: 1 
iter: 3  mgc: 7.398526e-13 
outer mgc:  0.2501189 
iter: 1  value: 2262.986 mgc: 0.02600193 ustep: 1 
iter: 2  value: 2262.986 mgc: 2.850573e-06 ustep: 1 
iter: 3  mgc: 8.348877e-14 
outer mgc:  0.8675982 
iter: 1  value: 2262.988 mgc: 0.02599107 ustep: 1 
iter: 2  value: 2262.988 mgc: 2.850255e-06 ustep: 1 
iter: 3  mgc: 7.871481e-14 
outer mgc:  0.864338 
iter: 1  value: 2262.981 mgc: 0.006621868 ustep: 1 
iter: 2  value: 2262.981 mgc: 3.714505e-07 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.05650171 
iter: 1  value: 2262.992 mgc: 0.006616492 ustep: 1 
iter: 2  value: 2262.992 mgc: 3.709914e-07 ustep: 1 
iter: 3  mgc: 3.502754e-14 
outer mgc:  0.05210166 
iter: 1  value: 2262.994 mgc: 0.009672446 ustep: 1 
iter: 2  value: 2262.994 mgc: 1.01255e-06 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.2834641 
iter: 1  value: 2262.979 mgc: 0.00969415 ustep: 1 
iter: 2  value: 2262.979 mgc: 1.017259e-06 ustep: 1 
iter: 3  mgc: 4.92939e-14 
outer mgc:  0.2853994 
iter: 1  value: 2262.997 mgc: 0.01046941 ustep: 1 
iter: 2  value: 2262.997 mgc: 3.316626e-06 ustep: 1 
iter: 3  mgc: 3.330669e-13 
outer mgc:  0.2679397 
iter: 1  value: 2262.976 mgc: 0.01049254 ustep: 1 
iter: 2  value: 2262.976 mgc: 3.326656e-06 ustep: 1 
iter: 3  mgc: 3.348433e-13 
outer mgc:  0.2727874 
[Sat Aug 14 23:24:09 2021]
Finished job 0.
1 of 1 steps (100%) done

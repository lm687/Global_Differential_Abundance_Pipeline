Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 09:40:50 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_4_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_4_2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_4_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=4, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_4_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_4_2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_4_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_4_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_4_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 5459.227194 
iter  10 value 4783.601229
final  value 4783.598103 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4580.973 mgc: 4.721649 ustep: 0.6827823 
iter: 2  value: 4570.848 mgc: 4.942461 ustep: 0.8263238 
iter: 3  value: 4568.273 mgc: 2.390332 ustep: 0.4507029 
iter: 4  value: 4567.99 mgc: 1.157647 ustep: 0.671377 
iter: 5  value: 4567.953 mgc: 0.1808491 ustep: 0.819394 
iter: 6  value: 4567.949 mgc: 0.02808411 ustep: 0.9052133 
iter: 7  value: 4567.948 mgc: 0.005096136 ustep: 0.9514319 
iter: 8  value: 4567.948 mgc: 0.0005569221 ustep: 0.9754161 
iter: 9  value: 4567.948 mgc: 3.155393e-05 ustep: 0.9876328 
iter: 10  value: 4567.948 mgc: 9.236728e-07 ustep: 0.9937978 
iter: 11  value: 4567.948 mgc: 1.374071e-08 ustep: 0.9968944 
iter: 12  mgc: 1.02915e-10 
iter: 1  mgc: 1.02915e-10 
Matching hessian patterns... Done
outer mgc:  24.70332 
iter: 1  value: 4537.287 mgc: 1.752952 ustep: 1 
iter: 2  value: 4537.237 mgc: 0.2807298 ustep: 1 
iter: 3  value: 4537.237 mgc: 0.004780139 ustep: 1 
iter: 4  value: 4537.237 mgc: 1.504295e-06 ustep: 1 
iter: 5  mgc: 1.409983e-13 
iter: 1  mgc: 1.409983e-13 
outer mgc:  16.76594 
iter: 1  value: 4502.38 mgc: 0.9631744 ustep: 1 
iter: 2  value: 4502.376 mgc: 0.04772537 ustep: 1 
iter: 3  value: 4502.376 mgc: 0.0001226567 ustep: 1 
iter: 4  mgc: 1.904836e-09 
iter: 1  value: 4481.164 mgc: 3.838506 ustep: 1 
iter: 2  value: 4481.071 mgc: 0.2114402 ustep: 1 
iter: 3  value: 4481.071 mgc: 0.003097036 ustep: 1 
iter: 4  value: 4481.071 mgc: 1.010351e-06 ustep: 1 
iter: 5  mgc: 7.349676e-14 
iter: 1  mgc: 7.349676e-14 
outer mgc:  36.61639 
iter: 1  value: 4402.633 mgc: 65.00789 ustep: 1 
iter: 2  value: 4402.622 mgc: 0.1740189 ustep: 1 
iter: 3  value: 4402.622 mgc: 0.0005157176 ustep: 1 
iter: 4  mgc: 5.38106e-09 
iter: 1  mgc: 5.38106e-09 
outer mgc:  37.165 
iter: 1  value: 4493.949 mgc: 58.61321 ustep: 1 
iter: 2  value: 4493.949 mgc: 0.1214449 ustep: 1 
iter: 3  value: 4493.949 mgc: 2.204801e-06 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 4366.986 mgc: 3.468377 ustep: 1 
iter: 2  value: 4366.983 mgc: 0.14291 ustep: 1 
iter: 3  value: 4366.983 mgc: 0.0001762916 ustep: 1 
iter: 4  mgc: 1.124226e-09 
iter: 1  mgc: 1.124226e-09 
outer mgc:  29.54557 
iter: 1  value: 4375.817 mgc: 6.641683 ustep: 1 
iter: 2  value: 4375.816 mgc: 0.0475495 ustep: 1 
iter: 3  value: 4375.816 mgc: 2.515845e-05 ustep: 1 
iter: 4  mgc: 9.501316e-12 
iter: 1  value: 4357.975 mgc: 2.788339 ustep: 1 
iter: 2  value: 4357.975 mgc: 0.01041159 ustep: 1 
iter: 3  value: 4357.975 mgc: 3.786838e-06 ustep: 1 
iter: 4  mgc: 3.868017e-13 
iter: 1  mgc: 3.868017e-13 
outer mgc:  14.09026 
iter: 1  value: 4353.246 mgc: 3.632295 ustep: 1 
iter: 2  value: 4353.246 mgc: 0.03243793 ustep: 1 
iter: 3  value: 4353.246 mgc: 1.701037e-05 ustep: 1 
iter: 4  mgc: 4.828027e-12 
iter: 1  mgc: 4.828027e-12 
outer mgc:  14.24931 
iter: 1  value: 4347.157 mgc: 3.491186 ustep: 1 
iter: 2  value: 4347.157 mgc: 0.01224142 ustep: 1 
iter: 3  value: 4347.157 mgc: 1.350563e-06 ustep: 1 
iter: 4  mgc: 1.132427e-14 
iter: 1  mgc: 1.132427e-14 
outer mgc:  10.0685 
iter: 1  value: 4341.182 mgc: 2.048529 ustep: 1 
iter: 2  value: 4341.182 mgc: 0.007057796 ustep: 1 
iter: 3  value: 4341.182 mgc: 3.022212e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  9.444916 
iter: 1  value: 4330.911 mgc: 4.199855 ustep: 1 
iter: 2  value: 4330.911 mgc: 0.01253651 ustep: 1 
iter: 3  value: 4330.911 mgc: 2.943095e-07 ustep: 1 
iter: 4  mgc: 5.551115e-15 
iter: 1  value: 4317.779 mgc: 5.134231 ustep: 1 
iter: 2  value: 4317.779 mgc: 0.01854637 ustep: 1 
iter: 3  value: 4317.779 mgc: 1.864724e-07 ustep: 1 
iter: 4  mgc: 5.162537e-15 
iter: 1  mgc: 5.162537e-15 
outer mgc:  10.65431 
iter: 1  value: 4325.237 mgc: 5.033351 ustep: 1 
iter: 2  value: 4325.237 mgc: 0.002963419 ustep: 1 
iter: 3  mgc: 3.075306e-09 
iter: 1  value: 4319.647 mgc: 2.518223 ustep: 1 
iter: 2  value: 4319.647 mgc: 0.003754615 ustep: 1 
iter: 3  value: 4319.647 mgc: 2.011136e-08 ustep: 1 
mgc: 3.774758e-15 
iter: 1  value: 4315.237 mgc: 0.8223856 ustep: 1 
iter: 2  value: 4315.237 mgc: 0.0002865041 ustep: 1 
iter: 3  mgc: 8.150547e-11 
iter: 1  mgc: 8.150547e-11 
outer mgc:  4.680202 
iter: 1  value: 4313.198 mgc: 0.8056416 ustep: 1 
iter: 2  value: 4313.198 mgc: 0.0001509074 ustep: 1 
iter: 3  mgc: 1.541836e-10 
iter: 1  mgc: 1.541836e-10 
outer mgc:  8.633914 
iter: 1  value: 4309.307 mgc: 1.005517 ustep: 1 
iter: 2  value: 4309.307 mgc: 0.0002851833 ustep: 1 
iter: 3  mgc: 2.027978e-11 
iter: 1  mgc: 2.027978e-11 
outer mgc:  3.876141 
iter: 1  value: 4306.487 mgc: 1.081424 ustep: 1 
iter: 2  value: 4306.487 mgc: 0.0002167865 ustep: 1 
iter: 3  mgc: 4.749667e-10 
iter: 1  mgc: 4.749667e-10 
outer mgc:  4.071892 
iter: 1  value: 4300.839 mgc: 1.554334 ustep: 1 
iter: 2  value: 4300.839 mgc: 0.0003447919 ustep: 1 
iter: 3  mgc: 1.133051e-09 
iter: 1  mgc: 1.133051e-09 
outer mgc:  2.331418 
iter: 1  value: 4299.665 mgc: 1.771851 ustep: 1 
iter: 2  value: 4299.665 mgc: 0.000339687 ustep: 1 
iter: 3  mgc: 4.259082e-11 
iter: 1  value: 4300.008 mgc: 0.2361341 ustep: 1 
iter: 2  value: 4300.008 mgc: 6.612439e-06 ustep: 1 
iter: 3  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  2.345871 
iter: 1  value: 4298.962 mgc: 0.2455563 ustep: 1 
iter: 2  value: 4298.962 mgc: 9.035878e-06 ustep: 1 
iter: 3  mgc: 1.367795e-13 
iter: 1  mgc: 1.367795e-13 
outer mgc:  2.051586 
iter: 1  value: 4296.554 mgc: 0.5468373 ustep: 1 
iter: 2  value: 4296.554 mgc: 7.28696e-05 ustep: 1 
iter: 3  mgc: 7.793766e-13 
iter: 1  value: 4293.074 mgc: 1.021691 ustep: 1 
iter: 2  value: 4293.074 mgc: 0.0001559252 ustep: 1 
iter: 3  mgc: 9.820589e-12 
iter: 1  value: 4285.27 mgc: 2.591261 ustep: 1 
iter: 2  value: 4285.27 mgc: 0.000437533 ustep: 1 
iter: 3  mgc: 1.074469e-10 
iter: 1  mgc: 1.074469e-10 
outer mgc:  2.154825 
iter: 1  value: 4272.461 mgc: 2.658856 ustep: 1 
iter: 2  value: 4272.461 mgc: 0.0005134275 ustep: 1 
iter: 3  mgc: 2.464429e-10 
iter: 1  mgc: 2.464429e-10 
outer mgc:  5.373256 
iter: 1  value: 4260.29 mgc: 4.00932 ustep: 1 
iter: 2  value: 4260.29 mgc: 0.0001455283 ustep: 1 
iter: 3  mgc: 4.226397e-12 
iter: 1  value: 4268.875 mgc: 1.01687 ustep: 1 
iter: 2  value: 4268.875 mgc: 2.634951e-05 ustep: 1 
iter: 3  mgc: 1.350031e-13 
iter: 1  mgc: 1.350031e-13 
outer mgc:  2.768911 
iter: 1  value: 4263.152 mgc: 2.016593 ustep: 1 
iter: 2  value: 4263.152 mgc: 0.0001047379 ustep: 1 
iter: 3  mgc: 1.814549e-12 
iter: 1  value: 4267.181 mgc: 0.4221543 ustep: 1 
iter: 2  value: 4267.181 mgc: 1.25406e-05 ustep: 1 
iter: 3  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  1.079145 
iter: 1  value: 4265.682 mgc: 0.369338 ustep: 1 
iter: 2  value: 4265.682 mgc: 5.359841e-06 ustep: 1 
iter: 3  mgc: 5.884182e-15 
iter: 1  mgc: 5.884182e-15 
outer mgc:  1.15155 
iter: 1  value: 4262.713 mgc: 0.4247826 ustep: 1 
iter: 2  value: 4262.713 mgc: 4.646129e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  1.176895 
iter: 1  value: 4259.686 mgc: 0.4533566 ustep: 1 
iter: 2  value: 4259.686 mgc: 4.405316e-06 ustep: 1 
iter: 3  mgc: 7.993606e-15 
iter: 1  value: 4256.374 mgc: 0.5146606 ustep: 1 
iter: 2  value: 4256.374 mgc: 4.294809e-06 ustep: 1 
iter: 3  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.8731894 
iter: 1  value: 4250.008 mgc: 1.176621 ustep: 1 
iter: 2  value: 4250.008 mgc: 1.285921e-05 ustep: 1 
iter: 3  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  1.033208 
iter: 1  value: 4243.416 mgc: 1.089742 ustep: 1 
iter: 2  value: 4243.416 mgc: 7.590678e-06 ustep: 1 
iter: 3  mgc: 4.440892e-15 
iter: 1  value: 4229.227 mgc: 2.869933 ustep: 1 
iter: 2  value: 4229.227 mgc: 1.772081e-05 ustep: 1 
iter: 3  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  1.237137 
iter: 1  value: 4208.821 mgc: 5.488466 ustep: 1 
iter: 2  value: 4208.821 mgc: 1.001081e-05 ustep: 1 
iter: 3  mgc: 5.662137e-15 
iter: 1  mgc: 5.662137e-15 
outer mgc:  0.6024925 
iter: 1  value: 4192.277 mgc: 3.084426 ustep: 1 
iter: 2  value: 4192.277 mgc: 6.441031e-06 ustep: 1 
iter: 3  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.2468535 
iter: 1  value: 4175.843 mgc: 3.34877 ustep: 1 
iter: 2  value: 4175.843 mgc: 2.75113e-06 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.06057856 
iter: 1  value: 4159.448 mgc: 3.282684 ustep: 1 
iter: 2  value: 4159.448 mgc: 1.402222e-06 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.02315299 
iter: 1  value: 4139.431 mgc: 4.389061 ustep: 1 
iter: 2  value: 4139.431 mgc: 9.938021e-07 ustep: 1 
mgc: 4.773959e-15 
iter: 1  mgc: 4.773959e-15 
outer mgc:  0.008915389 
iter: 1  value: 4120.962 mgc: 3.884062 ustep: 1 
iter: 2  value: 4120.962 mgc: 3.756059e-07 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  0.004698487 
iter: 1  value: 4102.48 mgc: 4.220893 ustep: 1 
iter: 2  value: 4102.48 mgc: 1.667661e-07 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.001067657 
iter: 1  value: 4083.958 mgc: 4.505813 ustep: 1 
iter: 2  value: 4083.958 mgc: 7.224482e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.0004859275 
iter: 1  value: 4065.673 mgc: 4.570051 ustep: 1 
iter: 2  value: 4065.673 mgc: 2.985724e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.000494785 
iter: 1  value: 4047.686 mgc: 4.455448 ustep: 1 
iter: 2  value: 4047.686 mgc: 1.221042e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  0.0004344723 
iter: 1  value: 4030.093 mgc: 4.109511 ustep: 1 
iter: 2  mgc: 4.961688e-09 
iter: 1  mgc: 4.961688e-09 
outer mgc:  0.000275777 
iter: 1  value: 4013.025 mgc: 3.496617 ustep: 1 
iter: 2  mgc: 2.012474e-09 
iter: 1  mgc: 2.012474e-09 
outer mgc:  0.0001645322 
iter: 1  value: 3996.656 mgc: 2.976677 ustep: 1 
iter: 2  mgc: 8.18063e-10 
iter: 1  mgc: 8.18063e-10 
outer mgc:  9.808945e-05 
iter: 1  value: 3981.203 mgc: 2.599099 ustep: 1 
iter: 2  mgc: 3.343952e-10 
iter: 1  mgc: 3.343952e-10 
outer mgc:  6.081885e-05 
iter: 1  value: 3966.934 mgc: 2.300105 ustep: 1 
iter: 2  mgc: 1.375464e-10 
iter: 1  mgc: 1.375464e-10 
outer mgc:  3.628289e-05 
iter: 1  value: 3954.184 mgc: 2.01574 ustep: 1 
iter: 2  mgc: 5.658629e-11 
iter: 1  mgc: 5.658629e-11 
outer mgc:  2.056352e-05 
iter: 1  value: 3943.375 mgc: 2.112169 ustep: 1 
iter: 2  mgc: 2.280087e-11 
iter: 1  mgc: 2.280087e-11 
outer mgc:  1.040115e-05 
iter: 1  mgc: 2.280087e-11 
iter: 1  mgc: 2.280087e-11 
outer mgc:  1.040115e-05 
iter: 1  value: 3943.375 mgc: 0.005396985 ustep: 1 
iter: 2  mgc: 1.64313e-14 
outer mgc:  0.09207885 
iter: 1  value: 3943.375 mgc: 0.005395333 ustep: 1 
iter: 2  mgc: 1.110223e-14 
outer mgc:  0.09204565 
iter: 1  value: 3943.375 mgc: 0.002931166 ustep: 1 
iter: 2  mgc: 1.298961e-14 
outer mgc:  0.05304978 
iter: 1  value: 3943.375 mgc: 0.002930491 ustep: 1 
iter: 2  mgc: 1.076916e-14 
outer mgc:  0.0530512 
iter: 1  value: 3943.375 mgc: 0.004267908 ustep: 1 
iter: 2  mgc: 1.24345e-14 
outer mgc:  0.05534812 
iter: 1  value: 3943.375 mgc: 0.004264934 ustep: 1 
iter: 2  mgc: 1.598721e-14 
outer mgc:  0.0552882 
iter: 1  value: 3943.375 mgc: 0.001961581 ustep: 1 
mgc: 1.221245e-14 
outer mgc:  0.02439102 
iter: 1  value: 3943.375 mgc: 0.001960274 ustep: 1 
mgc: 2.04281e-14 
outer mgc:  0.02436457 
iter: 1  value: 3943.375 mgc: 0.006093291 ustep: 1 
iter: 2  mgc: 2.842171e-14 
outer mgc:  0.08882173 
iter: 1  value: 3943.375 mgc: 0.006092034 ustep: 1 
iter: 2  mgc: 1.554312e-14 
outer mgc:  0.08876092 
iter: 1  value: 3943.375 mgc: 0.002996671 ustep: 1 
iter: 2  mgc: 1.088019e-14 
outer mgc:  0.04682888 
iter: 1  value: 3943.375 mgc: 0.002996418 ustep: 1 
iter: 2  mgc: 9.214851e-15 
outer mgc:  0.04680159 
iter: 1  value: 3943.395 mgc: 0.04134104 ustep: 1 
mgc: 1.421085e-14 
outer mgc:  1.04082e-05 
iter: 1  value: 3943.355 mgc: 0.0413824 ustep: 1 
mgc: 1.021405e-14 
outer mgc:  1.039411e-05 
iter: 1  value: 3943.395 mgc: 0.08727581 ustep: 1 
mgc: 1.909584e-14 
outer mgc:  1.040543e-05 
iter: 1  value: 3943.355 mgc: 0.08753487 ustep: 1 
mgc: 2.864375e-14 
outer mgc:  1.039687e-05 
iter: 1  value: 3943.395 mgc: 0.04287133 ustep: 1 
iter: 2  mgc: 6.328271e-15 
outer mgc:  1.066751e-05 
iter: 1  value: 3943.355 mgc: 0.04291422 ustep: 1 
iter: 2  mgc: 1.332268e-14 
outer mgc:  1.013532e-05 
iter: 1  value: 3943.367 mgc: 0.01397479 ustep: 1 
mgc: 1.354472e-14 
outer mgc:  1.040039e-05 
iter: 1  value: 3943.384 mgc: 0.01395942 ustep: 1 
mgc: 2.264855e-14 
outer mgc:  1.04019e-05 
iter: 1  value: 3943.376 mgc: 0.02683571 ustep: 1 
mgc: 1.287859e-14 
outer mgc:  1.036266e-05 
iter: 1  value: 3943.374 mgc: 0.02681218 ustep: 1 
mgc: 9.325873e-15 
outer mgc:  1.043963e-05 
iter: 1  value: 3943.382 mgc: 0.09268738 ustep: 1 
mgc: 1.199041e-14 
outer mgc:  1.039718e-05 
iter: 1  value: 3943.369 mgc: 0.09271735 ustep: 1 
mgc: 1.687539e-14 
outer mgc:  1.040512e-05 
iter: 1  value: 3943.375 mgc: 0.004403346 ustep: 1 
iter: 2  mgc: 1.354472e-14 
outer mgc:  0.04999757 
iter: 1  value: 3943.375 mgc: 0.004400371 ustep: 1 
iter: 2  mgc: 1.754152e-14 
outer mgc:  0.04999824 
[Fri Aug 13 09:40:52 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 00:12:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4366.983847 
final  value 4167.580097 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2629.491 mgc: 76.29578 ustep: 1 
iter: 2  value: 1104.538 mgc: 77.79793 ustep: 0.1336527 
iter: 3  value: 644.6279 mgc: 104.0923 ustep: 0.3656489 
iter: 4  value: 515.8242 mgc: 73.62621 ustep: 0.6047286 
iter: 5  value: 470.4774 mgc: 55.95894 ustep: 0.7776652 
iter: 6  value: 469.5845 mgc: 3.64527 ustep: 0.8818651 
iter: 7  value: 469.5793 mgc: 0.3772847 ustep: 0.9390828 
iter: 8  value: 469.5793 mgc: 0.004898918 ustep: 0.969066 
iter: 9  value: 469.5793 mgc: 1.051587e-05 ustep: 0.984413 
iter: 10  value: 469.5793 mgc: 1.099113e-08 ustep: 0.9921767 
mgc: 7.957301e-12 
iter: 1  mgc: 7.957301e-12 
Matching hessian patterns... Done
outer mgc:  100.1504 
iter: 1  value: 382.5826 mgc: 12.24538 ustep: 1 
iter: 2  value: 382.3318 mgc: 1.206866 ustep: 1 
iter: 3  value: 382.3318 mgc: 0.01511789 ustep: 1 
iter: 4  value: 382.3318 mgc: 4.432035e-06 ustep: 1 
iter: 5  mgc: 4.343192e-13 
iter: 1  mgc: 4.343192e-13 
outer mgc:  35.95433 
iter: 1  value: 380.2756 mgc: 20.15797 ustep: 1 
iter: 2  value: 379.7472 mgc: 1.815938 ustep: 1 
iter: 3  value: 379.7471 mgc: 0.0240406 ustep: 1 
iter: 4  value: 379.7471 mgc: 1.775413e-05 ustep: 1 
iter: 5  mgc: 1.196976e-11 
iter: 1  mgc: 1.196976e-11 
outer mgc:  64.62821 
iter: 1  value: 364.9856 mgc: 16.57524 ustep: 1 
iter: 2  value: 364.9134 mgc: 1.125828 ustep: 1 
iter: 3  value: 364.9134 mgc: 0.004723524 ustep: 1 
iter: 4  value: 364.9134 mgc: 1.083702e-07 ustep: 1 
mgc: 2.853273e-14 
iter: 1  mgc: 2.853273e-14 
outer mgc:  35.08564 
iter: 1  value: 359.364 mgc: 13.18904 ustep: 1 
iter: 2  value: 359.2454 mgc: 0.9314136 ustep: 1 
iter: 3  value: 359.2454 mgc: 0.01244661 ustep: 1 
iter: 4  value: 359.2454 mgc: 3.219896e-06 ustep: 1 
iter: 5  mgc: 2.158274e-13 
iter: 1  mgc: 2.158274e-13 
outer mgc:  7.913094 
iter: 1  value: 361.2688 mgc: 19.73417 ustep: 1 
iter: 2  value: 361.0376 mgc: 1.329924 ustep: 1 
iter: 3  value: 361.0376 mgc: 0.01436932 ustep: 1 
iter: 4  value: 361.0376 mgc: 2.096244e-06 ustep: 1 
iter: 5  mgc: 4.951595e-14 
iter: 1  value: 358.7133 mgc: 8.430119 ustep: 1 
iter: 2  value: 358.7077 mgc: 0.206337 ustep: 1 
iter: 3  value: 358.7077 mgc: 0.0003122228 ustep: 1 
iter: 4  mgc: 1.06233e-09 
iter: 1  mgc: 1.06233e-09 
outer mgc:  7.896404 
iter: 1  value: 358.0895 mgc: 4.649142 ustep: 1 
iter: 2  value: 358.088 mgc: 0.10164 ustep: 1 
iter: 3  value: 358.088 mgc: 8.203603e-05 ustep: 1 
iter: 4  mgc: 8.398315e-11 
iter: 1  mgc: 8.398315e-11 
outer mgc:  5.224218 
iter: 1  value: 357.9301 mgc: 5.806626 ustep: 1 
iter: 2  value: 357.9271 mgc: 0.1437037 ustep: 1 
iter: 3  value: 357.9271 mgc: 0.0001942397 ustep: 1 
iter: 4  mgc: 5.365766e-10 
iter: 1  mgc: 5.365766e-10 
outer mgc:  11.11715 
iter: 1  value: 357.2335 mgc: 3.048079 ustep: 1 
iter: 2  value: 357.2326 mgc: 0.06816498 ustep: 1 
iter: 3  value: 357.2326 mgc: 0.0001079634 ustep: 1 
iter: 4  mgc: 3.535467e-10 
iter: 1  mgc: 3.535467e-10 
outer mgc:  1.864481 
iter: 1  value: 357.5258 mgc: 5.942727 ustep: 1 
iter: 2  value: 357.5235 mgc: 0.1194267 ustep: 1 
iter: 3  value: 357.5235 mgc: 0.0001878792 ustep: 1 
iter: 4  mgc: 6.75783e-10 
iter: 1  value: 357.1764 mgc: 1.620558 ustep: 1 
iter: 2  value: 357.1764 mgc: 0.009465179 ustep: 1 
iter: 3  value: 357.1764 mgc: 1.765981e-06 ustep: 1 
iter: 4  mgc: 5.995204e-14 
iter: 1  mgc: 5.995204e-14 
outer mgc:  1.249083 
iter: 1  value: 357.1433 mgc: 0.9916288 ustep: 1 
iter: 2  value: 357.1433 mgc: 0.006129335 ustep: 1 
iter: 3  value: 357.1433 mgc: 7.751305e-07 ustep: 1 
iter: 4  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  3.306395 
iter: 1  value: 357.0932 mgc: 1.1157 ustep: 1 
iter: 2  value: 357.0932 mgc: 0.004602592 ustep: 1 
iter: 3  value: 357.0932 mgc: 2.503551e-07 ustep: 1 
iter: 4  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  1.460051 
iter: 1  value: 357.0381 mgc: 0.8354953 ustep: 1 
iter: 2  value: 357.0381 mgc: 0.004525872 ustep: 1 
iter: 3  value: 357.0381 mgc: 1.605712e-07 ustep: 1 
iter: 4  mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.979783 
iter: 1  value: 357.1086 mgc: 0.8142744 ustep: 1 
iter: 2  value: 357.1086 mgc: 0.002891464 ustep: 1 
iter: 3  value: 357.1086 mgc: 1.834941e-07 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  value: 357.036 mgc: 0.2979727 ustep: 1 
iter: 2  value: 357.036 mgc: 0.0003915024 ustep: 1 
iter: 3  mgc: 3.334465e-09 
iter: 1  mgc: 3.334465e-09 
outer mgc:  0.5454214 
iter: 1  value: 357.051 mgc: 0.640532 ustep: 1 
iter: 2  value: 357.051 mgc: 0.001452607 ustep: 1 
iter: 3  value: 357.051 mgc: 2.146328e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  1.138559 
iter: 1  value: 357.0648 mgc: 0.562875 ustep: 1 
iter: 2  value: 357.0648 mgc: 0.001321379 ustep: 1 
iter: 3  value: 357.0648 mgc: 1.817705e-08 ustep: 1 
mgc: 1.56819e-14 
iter: 1  mgc: 1.56819e-14 
outer mgc:  0.944428 
iter: 1  value: 357.0369 mgc: 0.9814721 ustep: 1 
iter: 2  value: 357.0369 mgc: 0.003051194 ustep: 1 
iter: 3  value: 357.0369 mgc: 7.790705e-08 ustep: 1 
mgc: 1.798561e-14 
iter: 1  mgc: 1.798561e-14 
outer mgc:  0.3944685 
iter: 1  value: 357.0562 mgc: 0.3846474 ustep: 1 
iter: 2  value: 357.0562 mgc: 0.0004862601 ustep: 1 
iter: 3  mgc: 1.380055e-09 
iter: 1  value: 357.0389 mgc: 0.1339221 ustep: 1 
iter: 2  value: 357.0389 mgc: 5.875203e-05 ustep: 1 
iter: 3  mgc: 2.010875e-11 
iter: 1  mgc: 2.010875e-11 
outer mgc:  0.3873666 
iter: 1  value: 357.0423 mgc: 0.2455113 ustep: 1 
iter: 2  value: 357.0423 mgc: 0.0002951651 ustep: 1 
iter: 3  mgc: 9.375196e-10 
iter: 1  mgc: 9.375196e-10 
outer mgc:  0.141547 
iter: 1  value: 357.0567 mgc: 0.09625616 ustep: 1 
iter: 2  value: 357.0567 mgc: 6.194391e-05 ustep: 1 
iter: 3  mgc: 4.450884e-11 
iter: 1  value: 357.0461 mgc: 0.1231481 ustep: 1 
iter: 2  value: 357.0461 mgc: 5.139039e-05 ustep: 1 
iter: 3  mgc: 1.546091e-11 
iter: 1  mgc: 1.546091e-11 
outer mgc:  0.1977716 
iter: 1  value: 357.0487 mgc: 0.07153579 ustep: 1 
iter: 2  value: 357.0487 mgc: 2.048424e-05 ustep: 1 
iter: 3  mgc: 5.190071e-12 
iter: 1  mgc: 5.190071e-12 
outer mgc:  0.07880295 
iter: 1  value: 357.0466 mgc: 0.1269351 ustep: 1 
iter: 2  value: 357.0466 mgc: 6.469164e-05 ustep: 1 
iter: 3  mgc: 4.978151e-11 
iter: 1  mgc: 4.978151e-11 
outer mgc:  0.02812134 
iter: 1  value: 357.0485 mgc: 0.03261631 ustep: 1 
iter: 2  value: 357.0485 mgc: 7.731312e-06 ustep: 1 
iter: 3  mgc: 1.320277e-12 
iter: 1  value: 357.0473 mgc: 0.01026472 ustep: 1 
iter: 2  value: 357.0473 mgc: 8.485259e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  0.01602887 
iter: 1  value: 357.0472 mgc: 0.0111586 ustep: 1 
iter: 2  value: 357.0472 mgc: 6.751227e-07 ustep: 1 
iter: 3  mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.005545099 
iter: 1  value: 357.0476 mgc: 0.007767636 ustep: 1 
iter: 2  value: 357.0476 mgc: 1.817235e-07 ustep: 1 
iter: 3  mgc: 1.820766e-14 
iter: 1  value: 357.0474 mgc: 0.003331336 ustep: 1 
iter: 2  value: 357.0474 mgc: 3.486849e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  0.003190383 
iter: 1  value: 357.0475 mgc: 0.006181686 ustep: 1 
iter: 2  value: 357.0475 mgc: 1.510595e-07 ustep: 1 
iter: 3  mgc: 2.869927e-14 
iter: 1  mgc: 2.869927e-14 
outer mgc:  0.002838303 
iter: 1  value: 357.0474 mgc: 0.003169506 ustep: 1 
iter: 2  value: 357.0474 mgc: 3.577115e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  0.0006412748 
iter: 1  value: 357.0474 mgc: 0.0002853171 ustep: 1 
iter: 2  mgc: 5.000935e-10 
iter: 1  mgc: 5.000935e-10 
outer mgc:  0.000375259 
iter: 1  mgc: 5.000935e-10 
iter: 1  mgc: 5.000935e-10 
outer mgc:  0.000375259 
iter: 1  value: 357.0472 mgc: 0.04916504 ustep: 1 
iter: 2  value: 357.0472 mgc: 8.83429e-06 ustep: 1 
iter: 3  mgc: 8.191225e-13 
outer mgc:  0.03366445 
iter: 1  value: 357.0476 mgc: 0.04915446 ustep: 1 
iter: 2  value: 357.0476 mgc: 8.845071e-06 ustep: 1 
iter: 3  mgc: 8.244516e-13 
outer mgc:  0.0335564 
iter: 1  value: 357.047 mgc: 0.02506776 ustep: 1 
iter: 2  value: 357.047 mgc: 2.013675e-06 ustep: 1 
iter: 3  mgc: 4.818368e-14 
outer mgc:  0.1495738 
iter: 1  value: 357.0479 mgc: 0.02506562 ustep: 1 
iter: 2  value: 357.0479 mgc: 2.013227e-06 ustep: 1 
iter: 3  mgc: 2.509104e-14 
outer mgc:  0.1487985 
iter: 1  value: 357.0476 mgc: 0.05652674 ustep: 1 
iter: 2  value: 357.0476 mgc: 9.375663e-06 ustep: 1 
iter: 3  mgc: 6.759038e-13 
outer mgc:  0.03571624 
iter: 1  value: 357.0473 mgc: 0.05652053 ustep: 1 
iter: 2  value: 357.0473 mgc: 9.385692e-06 ustep: 1 
iter: 3  mgc: 6.74627e-13 
outer mgc:  0.03572045 
iter: 1  value: 357.0475 mgc: 0.0284244 ustep: 1 
iter: 2  value: 357.0475 mgc: 2.394983e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.2041853 
iter: 1  value: 357.0474 mgc: 0.02842293 ustep: 1 
iter: 2  value: 357.0474 mgc: 2.39574e-06 ustep: 1 
iter: 3  mgc: 4.884981e-14 
outer mgc:  0.2044451 
iter: 1  value: 357.0463 mgc: 0.003050056 ustep: 1 
iter: 2  value: 357.0463 mgc: 2.04273e-07 ustep: 1 
iter: 3  mgc: 3.441691e-14 
outer mgc:  0.01098369 
iter: 1  value: 357.0485 mgc: 0.003047723 ustep: 1 
iter: 2  value: 357.0485 mgc: 2.040371e-07 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.0111014 
iter: 1  value: 357.0492 mgc: 0.006541558 ustep: 1 
iter: 2  value: 357.0492 mgc: 8.505377e-07 ustep: 1 
iter: 3  mgc: 2.242651e-14 
outer mgc:  0.05680061 
iter: 1  value: 357.0457 mgc: 0.006556645 ustep: 1 
iter: 2  value: 357.0457 mgc: 8.536924e-07 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.05690209 
iter: 1  value: 357.0486 mgc: 0.006139477 ustep: 1 
iter: 2  value: 357.0486 mgc: 5.734745e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.0592438 
iter: 1  value: 357.0463 mgc: 0.006151816 ustep: 1 
iter: 2  value: 357.0463 mgc: 5.757426e-07 ustep: 1 
iter: 3  mgc: 2.642331e-14 
outer mgc:  0.05895082 
[Mon Aug 16 00:12:03 2021]
Finished job 0.
1 of 1 steps (100%) done

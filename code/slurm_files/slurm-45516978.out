Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:03:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.02_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.02_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.02_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4321.940744 
final  value 4000.819037 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 692.7504 mgc: 93.94697 ustep: 1 
iter: 2  value: 574.5751 mgc: 38.49817 ustep: 1 
iter: 3  value: 559.0214 mgc: 32.79151 ustep: 1 
iter: 4  value: 558.7224 mgc: 4.400929 ustep: 1 
iter: 5  value: 558.7222 mgc: 0.1212105 ustep: 1 
iter: 6  value: 558.7222 mgc: 7.900228e-05 ustep: 1 
iter: 7  mgc: 3.078299e-11 
iter: 1  mgc: 3.078299e-11 
Matching hessian patterns... Done
outer mgc:  169.5418 
iter: 1  value: 491.6416 mgc: 26.79212 ustep: 1 
iter: 2  value: 490.8921 mgc: 1.84705 ustep: 1 
iter: 3  value: 490.8919 mgc: 0.02897814 ustep: 1 
iter: 4  value: 490.8919 mgc: 1.006133e-05 ustep: 1 
iter: 5  mgc: 1.397327e-12 
iter: 1  mgc: 1.397327e-12 
outer mgc:  82.28145 
iter: 1  value: 483.6348 mgc: 43.72755 ustep: 1 
iter: 2  value: 466.1561 mgc: 11.42025 ustep: 1 
iter: 3  value: 466.1087 mgc: 0.6427525 ustep: 1 
iter: 4  value: 466.1087 mgc: 0.004336899 ustep: 1 
iter: 5  value: 466.1087 mgc: 2.556994e-07 ustep: 1 
iter: 6  mgc: 2.964295e-14 
iter: 1  mgc: 2.964295e-14 
outer mgc:  29.30668 
iter: 1  value: 463.4397 mgc: 28.14484 ustep: 1 
iter: 2  value: 453.8555 mgc: 7.103882 ustep: 1 
iter: 3  value: 453.8371 mgc: 0.3852785 ustep: 1 
iter: 4  value: 453.8371 mgc: 0.00177455 ustep: 1 
iter: 5  value: 453.8371 mgc: 3.823824e-08 ustep: 1 
mgc: 2.242651e-14 
iter: 1  mgc: 2.242651e-14 
outer mgc:  42.60274 
iter: 1  value: 428.0012 mgc: 25.15852 ustep: 1 
iter: 2  value: 427.7039 mgc: 1.779672 ustep: 1 
iter: 3  value: 427.7039 mgc: 0.009165647 ustep: 1 
iter: 4  value: 427.7039 mgc: 9.550523e-07 ustep: 1 
iter: 5  mgc: 2.461226e-14 
iter: 1  mgc: 2.461226e-14 
outer mgc:  34.53708 
iter: 1  value: 458.9611 mgc: 25.82419 ustep: 1 
iter: 2  value: 457.8955 mgc: 2.838009 ustep: 1 
iter: 3  value: 457.8953 mgc: 0.05186331 ustep: 1 
iter: 4  value: 457.8953 mgc: 1.928174e-05 ustep: 1 
iter: 5  mgc: 2.669587e-12 
iter: 1  value: 424.8612 mgc: 7.877077 ustep: 1 
iter: 2  value: 424.847 mgc: 0.3200127 ustep: 1 
iter: 3  value: 424.847 mgc: 0.0007080384 ustep: 1 
iter: 4  mgc: 5.51659e-09 
iter: 1  mgc: 5.51659e-09 
outer mgc:  32.75756 
iter: 1  value: 418.2758 mgc: 9.333273 ustep: 1 
iter: 2  value: 418.2716 mgc: 0.2060752 ustep: 1 
iter: 3  value: 418.2716 mgc: 0.0001745983 ustep: 1 
iter: 4  mgc: 1.8793e-10 
iter: 1  mgc: 1.8793e-10 
outer mgc:  10.7737 
iter: 1  value: 415.0928 mgc: 6.290553 ustep: 1 
iter: 2  value: 415.0859 mgc: 0.2296151 ustep: 1 
iter: 3  value: 415.0859 mgc: 0.0004384045 ustep: 1 
iter: 4  mgc: 1.596296e-09 
iter: 1  mgc: 1.596296e-09 
outer mgc:  20.43451 
iter: 1  value: 413.1096 mgc: 18.92878 ustep: 1 
iter: 2  value: 413.0957 mgc: 0.7668929 ustep: 1 
iter: 3  value: 413.0957 mgc: 0.001110241 ustep: 1 
iter: 4  mgc: 3.368139e-09 
iter: 1  value: 412.0431 mgc: 10.80954 ustep: 1 
iter: 2  value: 412.04 mgc: 0.223715 ustep: 1 
iter: 3  value: 412.04 mgc: 0.0001324954 ustep: 1 
iter: 4  mgc: 9.475976e-11 
iter: 1  mgc: 9.475976e-11 
outer mgc:  15.51209 
iter: 1  value: 411.198 mgc: 7.378009 ustep: 1 
iter: 2  value: 411.1906 mgc: 0.2251207 ustep: 1 
iter: 3  value: 411.1906 mgc: 0.0002953472 ustep: 1 
iter: 4  mgc: 5.034373e-10 
iter: 1  mgc: 5.034373e-10 
outer mgc:  14.51338 
iter: 1  value: 409.566 mgc: 4.503141 ustep: 1 
iter: 2  value: 409.5658 mgc: 0.03967577 ustep: 1 
iter: 3  value: 409.5658 mgc: 6.759349e-06 ustep: 1 
iter: 4  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  3.814104 
iter: 1  value: 411.2994 mgc: 5.840762 ustep: 1 
iter: 2  value: 411.2986 mgc: 0.07749368 ustep: 1 
iter: 3  value: 411.2986 mgc: 2.619036e-05 ustep: 1 
iter: 4  mgc: 3.422151e-12 
iter: 1  value: 409.4582 mgc: 0.8650952 ustep: 1 
iter: 2  value: 409.4582 mgc: 0.00163518 ustep: 1 
iter: 3  value: 409.4582 mgc: 1.184104e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  2.910109 
iter: 1  value: 409.3169 mgc: 0.6540383 ustep: 1 
iter: 2  value: 409.3169 mgc: 0.0007778145 ustep: 1 
iter: 3  mgc: 2.600786e-09 
iter: 1  mgc: 2.600786e-09 
outer mgc:  2.564975 
iter: 1  value: 409.1215 mgc: 1.109668 ustep: 1 
iter: 2  value: 409.1215 mgc: 0.001755446 ustep: 1 
iter: 3  mgc: 5.690965e-09 
iter: 1  mgc: 5.690965e-09 
outer mgc:  3.598716 
iter: 1  value: 408.8144 mgc: 1.046905 ustep: 1 
iter: 2  value: 408.8144 mgc: 0.003557516 ustep: 1 
iter: 3  value: 408.8144 mgc: 3.320611e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  1.908609 
iter: 1  value: 408.6587 mgc: 1.141902 ustep: 1 
iter: 2  value: 408.6587 mgc: 0.006334681 ustep: 1 
iter: 3  value: 408.6587 mgc: 5.995044e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  1.994421 
iter: 1  value: 408.5185 mgc: 0.4918197 ustep: 1 
iter: 2  value: 408.5185 mgc: 0.003077802 ustep: 1 
iter: 3  value: 408.5185 mgc: 1.128746e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.9588221 
iter: 1  value: 408.2745 mgc: 2.341664 ustep: 1 
iter: 2  value: 408.2745 mgc: 0.013564 ustep: 1 
iter: 3  value: 408.2745 mgc: 5.37569e-07 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  value: 408.41 mgc: 0.6781512 ustep: 1 
iter: 2  value: 408.41 mgc: 0.001031573 ustep: 1 
iter: 3  mgc: 3.216732e-09 
iter: 1  mgc: 3.216732e-09 
outer mgc:  2.093858 
iter: 1  value: 408.3599 mgc: 0.5610049 ustep: 1 
iter: 2  value: 408.3599 mgc: 0.0005938924 ustep: 1 
iter: 3  mgc: 1.410424e-09 
iter: 1  mgc: 1.410424e-09 
outer mgc:  0.8695372 
iter: 1  value: 408.3307 mgc: 0.288859 ustep: 1 
iter: 2  value: 408.3307 mgc: 0.0001742024 ustep: 1 
iter: 3  mgc: 1.025677e-10 
iter: 1  value: 408.329 mgc: 0.2691858 ustep: 1 
iter: 2  value: 408.329 mgc: 0.00016179 ustep: 1 
iter: 3  mgc: 5.724843e-11 
iter: 1  mgc: 5.724843e-11 
outer mgc:  0.7837159 
iter: 1  value: 408.2668 mgc: 0.5601893 ustep: 1 
iter: 2  value: 408.2668 mgc: 0.00101003 ustep: 1 
iter: 3  mgc: 4.321589e-09 
iter: 1  mgc: 4.321589e-09 
outer mgc:  1.998172 
iter: 1  value: 408.2278 mgc: 0.4706389 ustep: 1 
iter: 2  value: 408.2278 mgc: 0.0005274963 ustep: 1 
iter: 3  mgc: 1.279808e-09 
iter: 1  mgc: 1.279808e-09 
outer mgc:  0.5207541 
iter: 1  value: 407.9779 mgc: 0.6654033 ustep: 1 
iter: 2  value: 407.9779 mgc: 0.0008559763 ustep: 1 
iter: 3  mgc: 2.804469e-09 
iter: 1  value: 408.1393 mgc: 0.2273245 ustep: 1 
iter: 2  value: 408.1393 mgc: 0.0001034502 ustep: 1 
iter: 3  mgc: 3.740119e-11 
iter: 1  mgc: 3.740119e-11 
outer mgc:  0.3061962 
iter: 1  value: 408.1458 mgc: 0.1568553 ustep: 1 
iter: 2  value: 408.1458 mgc: 8.580085e-05 ustep: 1 
iter: 3  mgc: 2.139533e-11 
iter: 1  mgc: 2.139533e-11 
outer mgc:  0.1986024 
iter: 1  value: 408.1156 mgc: 0.1473248 ustep: 1 
iter: 2  value: 408.1156 mgc: 9.441068e-05 ustep: 1 
iter: 3  mgc: 1.225686e-11 
iter: 1  value: 408.1343 mgc: 0.08799593 ustep: 1 
iter: 2  value: 408.1343 mgc: 2.120807e-05 ustep: 1 
iter: 3  mgc: 1.509903e-12 
iter: 1  mgc: 1.509903e-12 
outer mgc:  0.1709451 
iter: 1  value: 408.1384 mgc: 0.04813038 ustep: 1 
iter: 2  value: 408.1384 mgc: 7.002261e-06 ustep: 1 
iter: 3  mgc: 1.465494e-13 
iter: 1  mgc: 1.465494e-13 
outer mgc:  0.0399245 
iter: 1  value: 408.1351 mgc: 0.02024873 ustep: 1 
iter: 2  value: 408.1351 mgc: 1.641158e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
iter: 1  value: 408.1378 mgc: 0.01399419 ustep: 1 
iter: 2  value: 408.1378 mgc: 3.748542e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.0384787 
iter: 1  value: 408.1358 mgc: 0.01383726 ustep: 1 
iter: 2  value: 408.1358 mgc: 7.726405e-07 ustep: 1 
iter: 3  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  0.01772322 
iter: 1  value: 408.136 mgc: 0.007473396 ustep: 1 
iter: 2  value: 408.136 mgc: 3.049631e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  0.00991899 
iter: 1  value: 408.1363 mgc: 0.003362324 ustep: 1 
iter: 2  value: 408.1363 mgc: 3.400288e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.001427 
iter: 1  value: 408.1362 mgc: 0.0004231279 ustep: 1 
iter: 2  mgc: 1.04864e-09 
iter: 1  mgc: 1.04864e-09 
outer mgc:  0.0001472758 
iter: 1  mgc: 1.04864e-09 
iter: 1  mgc: 1.04864e-09 
outer mgc:  0.0001472758 
iter: 1  value: 408.1357 mgc: 0.04612407 ustep: 1 
iter: 2  value: 408.1357 mgc: 5.842499e-06 ustep: 1 
iter: 3  mgc: 1.284667e-13 
outer mgc:  0.1824053 
iter: 1  value: 408.1369 mgc: 0.04610883 ustep: 1 
iter: 2  value: 408.1369 mgc: 5.846945e-06 ustep: 1 
iter: 3  mgc: 1.273009e-13 
outer mgc:  0.1826928 
iter: 1  value: 408.1363 mgc: 0.02354105 ustep: 1 
iter: 2  value: 408.1363 mgc: 1.93169e-06 ustep: 1 
iter: 3  mgc: 3.051726e-14 
outer mgc:  0.2239453 
iter: 1  value: 408.1364 mgc: 0.02353536 ustep: 1 
iter: 2  value: 408.1364 mgc: 1.932134e-06 ustep: 1 
iter: 3  mgc: 4.77951e-14 
outer mgc:  0.2241628 
iter: 1  value: 408.1374 mgc: 0.05367318 ustep: 1 
iter: 2  value: 408.1374 mgc: 3.591218e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.224875 
iter: 1  value: 408.1353 mgc: 0.05367608 ustep: 1 
iter: 2  value: 408.1353 mgc: 3.598209e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.2249316 
iter: 1  value: 408.1364 mgc: 0.02837236 ustep: 1 
iter: 2  value: 408.1364 mgc: 9.159114e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.2932826 
iter: 1  value: 408.1363 mgc: 0.02837045 ustep: 1 
iter: 2  value: 408.1363 mgc: 9.161576e-07 ustep: 1 
iter: 3  mgc: 2.020606e-14 
outer mgc:  0.2931503 
iter: 1  value: 408.1333 mgc: 0.008401596 ustep: 1 
iter: 2  value: 408.1333 mgc: 2.218824e-07 ustep: 1 
mgc: 2.797762e-14 
outer mgc:  0.008222461 
iter: 1  value: 408.1391 mgc: 0.008395443 ustep: 1 
iter: 2  value: 408.1391 mgc: 2.21895e-07 ustep: 1 
mgc: 2.364775e-14 
outer mgc:  0.00821175 
iter: 1  value: 408.1415 mgc: 0.01364167 ustep: 1 
iter: 2  value: 408.1415 mgc: 7.009673e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.0318685 
iter: 1  value: 408.1309 mgc: 0.01367437 ustep: 1 
iter: 2  value: 408.1309 mgc: 7.034759e-07 ustep: 1 
iter: 3  mgc: 2.703393e-14 
outer mgc:  0.03193869 
iter: 1  value: 408.1406 mgc: 0.02384069 ustep: 1 
iter: 2  value: 408.1406 mgc: 1.144011e-06 ustep: 1 
iter: 3  mgc: 1.998401e-14 
outer mgc:  0.03375357 
iter: 1  value: 408.1318 mgc: 0.02389232 ustep: 1 
iter: 2  value: 408.1318 mgc: 1.146123e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.03378353 
[Fri Aug 13 11:03:29 2021]
Finished job 0.
1 of 1 steps (100%) done

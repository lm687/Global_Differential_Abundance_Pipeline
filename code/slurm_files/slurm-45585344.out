Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:10:16 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4492.225648 
final  value 3886.803151 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 500.1551 mgc: 116.3949 ustep: 1 
iter: 2  value: 325.2616 mgc: 30.18722 ustep: 1 
iter: 3  value: 309.3495 mgc: 12.75675 ustep: 1 
iter: 4  value: 309.2704 mgc: 1.098215 ustep: 1 
iter: 5  value: 309.2704 mgc: 0.01715414 ustep: 1 
iter: 6  value: 309.2704 mgc: 4.408531e-06 ustep: 1 
iter: 7  mgc: 2.846612e-13 
iter: 1  mgc: 2.846612e-13 
Matching hessian patterns... Done
outer mgc:  43.6626 
iter: 1  value: 331.2661 mgc: 9.206668 ustep: 1 
iter: 2  value: 331.2054 mgc: 0.556555 ustep: 1 
iter: 3  value: 331.2054 mgc: 0.005069718 ustep: 1 
iter: 4  value: 331.2054 mgc: 9.335398e-07 ustep: 1 
iter: 5  mgc: 3.341771e-14 
iter: 1  value: 300.2756 mgc: 3.226279 ustep: 1 
iter: 2  value: 300.2748 mgc: 0.07094246 ustep: 1 
iter: 3  value: 300.2748 mgc: 4.962476e-05 ustep: 1 
iter: 4  mgc: 9.331946e-11 
iter: 1  mgc: 9.331946e-11 
outer mgc:  25.80975 
iter: 1  value: 297.0476 mgc: 13.46806 ustep: 1 
iter: 2  value: 296.6725 mgc: 1.265517 ustep: 1 
iter: 3  value: 296.6724 mgc: 0.02103625 ustep: 1 
iter: 4  value: 296.6724 mgc: 6.616134e-06 ustep: 1 
iter: 5  mgc: 6.53963e-13 
iter: 1  mgc: 6.53963e-13 
outer mgc:  41.06698 
iter: 1  value: 288.1311 mgc: 2.81784 ustep: 1 
iter: 2  value: 288.1299 mgc: 0.06916844 ustep: 1 
iter: 3  value: 288.1299 mgc: 0.0001366013 ustep: 1 
iter: 4  mgc: 6.421976e-10 
iter: 1  mgc: 6.421976e-10 
outer mgc:  15.54735 
iter: 1  value: 282.8075 mgc: 13.0255 ustep: 1 
iter: 2  value: 282.6428 mgc: 0.9315711 ustep: 1 
iter: 3  value: 282.6428 mgc: 0.009034874 ustep: 1 
iter: 4  value: 282.6428 mgc: 1.189826e-06 ustep: 1 
iter: 5  mgc: 3.227973e-14 
iter: 1  mgc: 3.227973e-14 
outer mgc:  22.92114 
iter: 1  value: 273.1686 mgc: 15.16345 ustep: 1 
iter: 2  value: 272.9255 mgc: 1.136865 ustep: 1 
iter: 3  value: 272.9254 mgc: 0.01777154 ustep: 1 
iter: 4  value: 272.9254 mgc: 5.68528e-06 ustep: 1 
iter: 5  mgc: 5.804246e-13 
iter: 1  mgc: 5.804246e-13 
outer mgc:  13.88493 
iter: 1  value: 266.6628 mgc: 29.59646 ustep: 1 
iter: 2  value: 264.1805 mgc: 5.253916 ustep: 1 
iter: 3  value: 264.1784 mgc: 0.2082315 ustep: 1 
iter: 4  value: 264.1784 mgc: 0.0005287265 ustep: 1 
iter: 5  mgc: 3.406917e-09 
iter: 1  value: 259.1551 mgc: 28.21918 ustep: 1 
iter: 2  value: 257.872 mgc: 5.064247 ustep: 1 
iter: 3  value: 257.8714 mgc: 0.1317288 ustep: 1 
iter: 4  value: 257.8714 mgc: 0.00017432 ustep: 1 
iter: 5  mgc: 3.249739e-10 
iter: 1  mgc: 3.249739e-10 
outer mgc:  21.09016 
iter: 1  value: 410.1759 mgc: 70.94128 ustep: 1 
iter: 2  value: 365.4197 mgc: 22.96085 ustep: 1 
iter: 3  value: 365.2941 mgc: 1.075062 ustep: 1 
iter: 4  value: 365.2941 mgc: 0.009172883 ustep: 1 
iter: 5  value: 365.2941 mgc: 4.64644e-07 ustep: 1 
iter: 6  mgc: 2.664535e-14 
iter: 1  value: 253.8447 mgc: 6.096834 ustep: 1 
iter: 2  value: 253.8424 mgc: 0.09643262 ustep: 1 
iter: 3  value: 253.8424 mgc: 8.17123e-05 ustep: 1 
iter: 4  mgc: 6.296252e-11 
iter: 1  mgc: 6.296252e-11 
outer mgc:  14.51583 
iter: 1  value: 251.3102 mgc: 3.385086 ustep: 1 
iter: 2  value: 251.3086 mgc: 0.1110495 ustep: 1 
iter: 3  value: 251.3086 mgc: 7.166611e-05 ustep: 1 
iter: 4  mgc: 1.097283e-10 
iter: 1  mgc: 1.097283e-10 
outer mgc:  15.22552 
iter: 1  value: 250.695 mgc: 9.088648 ustep: 1 
iter: 2  value: 250.69 mgc: 0.1776531 ustep: 1 
iter: 3  value: 250.69 mgc: 0.0001884367 ustep: 1 
iter: 4  mgc: 4.156115e-10 
iter: 1  mgc: 4.156115e-10 
outer mgc:  19.80447 
iter: 1  value: 248.158 mgc: 2.61372 ustep: 1 
iter: 2  value: 248.1576 mgc: 0.05157784 ustep: 1 
iter: 3  value: 248.1576 mgc: 5.566378e-05 ustep: 1 
iter: 4  mgc: 6.51441e-11 
iter: 1  mgc: 6.51441e-11 
outer mgc:  8.067912 
iter: 1  value: 246.6488 mgc: 13.13778 ustep: 1 
iter: 2  value: 246.5964 mgc: 0.4476142 ustep: 1 
iter: 3  value: 246.5964 mgc: 0.002591374 ustep: 1 
iter: 4  value: 246.5964 mgc: 1.544658e-07 ustep: 1 
iter: 5  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  23.42233 
iter: 1  value: 243.7607 mgc: 13.97356 ustep: 1 
iter: 2  value: 243.6641 mgc: 0.8670658 ustep: 1 
iter: 3  value: 243.6641 mgc: 0.005623367 ustep: 1 
iter: 4  value: 243.6641 mgc: 2.695344e-07 ustep: 1 
iter: 5  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  15.66861 
iter: 1  value: 246.3178 mgc: 9.229223 ustep: 1 
iter: 2  value: 246.3132 mgc: 0.4015588 ustep: 1 
iter: 3  value: 246.3132 mgc: 0.0006668098 ustep: 1 
iter: 4  mgc: 3.198288e-09 
iter: 1  value: 242.9923 mgc: 5.354101 ustep: 1 
iter: 2  value: 242.9915 mgc: 0.1069293 ustep: 1 
iter: 3  value: 242.9915 mgc: 7.053134e-05 ustep: 1 
iter: 4  mgc: 4.30328e-11 
iter: 1  mgc: 4.30328e-11 
outer mgc:  9.461325 
iter: 1  value: 244.1111 mgc: 3.494446 ustep: 1 
iter: 2  value: 244.111 mgc: 0.04906756 ustep: 1 
iter: 3  value: 244.111 mgc: 4.358005e-05 ustep: 1 
iter: 4  mgc: 3.105832e-11 
iter: 1  value: 242.6261 mgc: 1.95262 ustep: 1 
iter: 2  value: 242.6261 mgc: 0.01329546 ustep: 1 
iter: 3  value: 242.6261 mgc: 1.353312e-06 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  7.774691 
iter: 1  value: 242.2336 mgc: 3.200777 ustep: 1 
iter: 2  value: 242.2336 mgc: 0.03103875 ustep: 1 
iter: 3  value: 242.2336 mgc: 5.054276e-06 ustep: 1 
iter: 4  mgc: 2.655653e-13 
iter: 1  mgc: 2.655653e-13 
outer mgc:  4.501642 
iter: 1  value: 241.8369 mgc: 1.904865 ustep: 1 
iter: 2  value: 241.8368 mgc: 0.02165049 ustep: 1 
iter: 3  value: 241.8368 mgc: 2.837755e-06 ustep: 1 
iter: 4  mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  4.817268 
iter: 1  value: 241.4156 mgc: 4.08195 ustep: 1 
iter: 2  value: 241.4152 mgc: 0.03598429 ustep: 1 
iter: 3  value: 241.4152 mgc: 1.364053e-05 ustep: 1 
iter: 4  mgc: 3.823074e-12 
iter: 1  mgc: 3.823074e-12 
outer mgc:  5.352069 
iter: 1  value: 241.4504 mgc: 3.224479 ustep: 1 
iter: 2  value: 241.4504 mgc: 0.04288037 ustep: 1 
iter: 3  value: 241.4504 mgc: 7.363034e-06 ustep: 1 
iter: 4  mgc: 2.975398e-13 
iter: 1  value: 241.2475 mgc: 0.8114255 ustep: 1 
iter: 2  value: 241.2475 mgc: 0.003538581 ustep: 1 
iter: 3  value: 241.2475 mgc: 1.746733e-07 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  3.639197 
iter: 1  value: 241.1189 mgc: 1.493384 ustep: 1 
iter: 2  value: 241.1189 mgc: 0.009195621 ustep: 1 
iter: 3  value: 241.1189 mgc: 3.402119e-07 ustep: 1 
mgc: 3.005929e-14 
iter: 1  mgc: 3.005929e-14 
outer mgc:  2.763498 
iter: 1  value: 241.0137 mgc: 0.9807279 ustep: 1 
iter: 2  value: 241.0137 mgc: 0.003058423 ustep: 1 
iter: 3  value: 241.0137 mgc: 5.290572e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.249644 
iter: 1  value: 241.0165 mgc: 0.4524643 ustep: 1 
iter: 2  value: 241.0165 mgc: 0.0004493625 ustep: 1 
iter: 3  mgc: 5.732339e-10 
iter: 1  mgc: 5.732339e-10 
outer mgc:  0.7127647 
iter: 1  value: 240.9799 mgc: 0.2642075 ustep: 1 
iter: 2  value: 240.9799 mgc: 0.0002877246 ustep: 1 
iter: 3  mgc: 4.963336e-10 
iter: 1  mgc: 4.963336e-10 
outer mgc:  0.8452393 
iter: 1  value: 240.9289 mgc: 0.1574152 ustep: 1 
iter: 2  value: 240.9289 mgc: 4.801904e-05 ustep: 1 
iter: 3  mgc: 1.688738e-11 
iter: 1  mgc: 1.688738e-11 
outer mgc:  0.5459049 
iter: 1  value: 240.8973 mgc: 0.2660643 ustep: 1 
iter: 2  value: 240.8973 mgc: 0.0001200245 ustep: 1 
iter: 3  mgc: 7.808332e-11 
iter: 1  mgc: 7.808332e-11 
outer mgc:  0.4911433 
iter: 1  value: 240.8705 mgc: 0.1806709 ustep: 1 
iter: 2  value: 240.8705 mgc: 0.0001916391 ustep: 1 
iter: 3  mgc: 1.924372e-10 
iter: 1  value: 240.8368 mgc: 0.2032651 ustep: 1 
iter: 2  value: 240.8368 mgc: 0.0002571731 ustep: 1 
iter: 3  mgc: 2.831229e-10 
iter: 1  mgc: 2.831229e-10 
outer mgc:  0.5140662 
iter: 1  value: 240.7935 mgc: 0.4108792 ustep: 1 
iter: 2  value: 240.7935 mgc: 0.0003791039 ustep: 1 
iter: 3  mgc: 4.051284e-10 
iter: 1  mgc: 4.051284e-10 
outer mgc:  0.5350089 
iter: 1  value: 240.8019 mgc: 0.2591715 ustep: 1 
iter: 2  value: 240.8019 mgc: 0.0001664022 ustep: 1 
iter: 3  mgc: 9.373102e-11 
iter: 1  mgc: 9.373102e-11 
outer mgc:  0.04203627 
iter: 1  value: 240.813 mgc: 0.06328369 ustep: 1 
iter: 2  value: 240.813 mgc: 1.241266e-05 ustep: 1 
iter: 3  mgc: 1.232237e-12 
iter: 1  mgc: 1.232237e-12 
outer mgc:  0.03982685 
iter: 1  value: 240.8099 mgc: 0.01123234 ustep: 1 
iter: 2  value: 240.8099 mgc: 9.063724e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.0317059 
iter: 1  value: 240.8052 mgc: 0.00988285 ustep: 1 
iter: 2  value: 240.8052 mgc: 5.140196e-07 ustep: 1 
iter: 3  mgc: 2.819966e-14 
iter: 1  value: 240.8078 mgc: 0.00447877 ustep: 1 
iter: 2  value: 240.8078 mgc: 1.052495e-07 ustep: 1 
mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  0.0104509 
iter: 1  value: 240.8098 mgc: 0.003306806 ustep: 1 
iter: 2  value: 240.8098 mgc: 8.25386e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.003585236 
iter: 1  value: 240.8092 mgc: 0.001614942 ustep: 1 
iter: 2  value: 240.8092 mgc: 1.251507e-08 ustep: 1 
mgc: 3.56104e-14 
iter: 1  mgc: 3.56104e-14 
outer mgc:  0.0009632022 
iter: 1  value: 240.8092 mgc: 0.0004969908 ustep: 1 
iter: 2  mgc: 3.125155e-09 
iter: 1  mgc: 3.125155e-09 
outer mgc:  0.0005290699 
iter: 1  mgc: 3.125155e-09 
iter: 1  mgc: 3.125155e-09 
outer mgc:  0.0005290699 
iter: 1  value: 240.8109 mgc: 0.05699409 ustep: 1 
iter: 2  value: 240.8109 mgc: 5.886145e-06 ustep: 1 
iter: 3  mgc: 1.647571e-13 
outer mgc:  0.1855834 
iter: 1  value: 240.8076 mgc: 0.05698811 ustep: 1 
iter: 2  value: 240.8076 mgc: 5.895049e-06 ustep: 1 
iter: 3  mgc: 1.24345e-13 
outer mgc:  0.1853314 
iter: 1  value: 240.81 mgc: 0.02908818 ustep: 1 
iter: 2  value: 240.81 mgc: 1.407932e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.2882333 
iter: 1  value: 240.8086 mgc: 0.02909325 ustep: 1 
iter: 2  value: 240.8086 mgc: 1.408218e-06 ustep: 1 
iter: 3  mgc: 1.709743e-14 
outer mgc:  0.2877175 
iter: 1  value: 240.8079 mgc: 0.0317005 ustep: 1 
iter: 2  value: 240.8079 mgc: 5.849864e-06 ustep: 1 
iter: 3  mgc: 1.945111e-13 
outer mgc:  0.1373317 
iter: 1  value: 240.8106 mgc: 0.03168055 ustep: 1 
iter: 2  value: 240.8106 mgc: 5.852469e-06 ustep: 1 
iter: 3  mgc: 1.918465e-13 
outer mgc:  0.1375836 
iter: 1  value: 240.8085 mgc: 0.01612074 ustep: 1 
iter: 2  value: 240.8085 mgc: 1.648779e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.1522002 
iter: 1  value: 240.8099 mgc: 0.01611018 ustep: 1 
iter: 2  value: 240.8099 mgc: 1.648116e-06 ustep: 1 
iter: 3  mgc: 3.297362e-14 
outer mgc:  0.1532234 
iter: 1  value: 240.8065 mgc: 0.005965843 ustep: 1 
iter: 2  value: 240.8065 mgc: 1.294703e-07 ustep: 1 
mgc: 2.053913e-14 
outer mgc:  0.004044 
iter: 1  value: 240.8119 mgc: 0.005963001 ustep: 1 
iter: 2  value: 240.8119 mgc: 1.294664e-07 ustep: 1 
mgc: 3.064216e-14 
outer mgc:  0.004885047 
iter: 1  value: 240.812 mgc: 0.02476042 ustep: 1 
iter: 2  value: 240.812 mgc: 2.525378e-06 ustep: 1 
iter: 3  mgc: 5.861978e-14 
outer mgc:  0.0801523 
iter: 1  value: 240.8064 mgc: 0.02482315 ustep: 1 
iter: 2  value: 240.8064 mgc: 2.534232e-06 ustep: 1 
iter: 3  mgc: 5.528911e-14 
outer mgc:  0.07941281 
iter: 1  value: 240.8146 mgc: 0.01800662 ustep: 1 
iter: 2  value: 240.8146 mgc: 3.20716e-06 ustep: 1 
iter: 3  mgc: 1.232348e-13 
outer mgc:  0.06950869 
iter: 1  value: 240.8038 mgc: 0.01805824 ustep: 1 
iter: 2  value: 240.8038 mgc: 3.216066e-06 ustep: 1 
iter: 3  mgc: 1.225686e-13 
outer mgc:  0.07042526 
[Sun Aug 15 21:10:18 2021]
Finished job 0.
1 of 1 steps (100%) done

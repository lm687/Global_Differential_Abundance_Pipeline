Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:04:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22081.008390 
final  value 21846.942760 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5292.349 mgc: 79.51918 ustep: 1 
iter: 2  value: 3722.26 mgc: 62.82531 ustep: 0.2494656 
iter: 3  value: 2888.698 mgc: 124.0285 ustep: 0.4995153 
iter: 4  value: 2575.061 mgc: 51.58625 ustep: 0.1421311 
iter: 5  value: 2528.661 mgc: 58.31377 ustep: 0.3770651 
iter: 6  value: 2528.426 mgc: 3.183691 ustep: 0.6140949 
iter: 7  value: 2528.425 mgc: 0.1075972 ustep: 0.7836637 
iter: 8  value: 2528.425 mgc: 0.001581468 ustep: 0.8852593 
iter: 9  value: 2528.425 mgc: 7.262882e-05 ustep: 0.9408881 
iter: 10  value: 2528.425 mgc: 1.647557e-06 ustep: 0.9699969 
iter: 11  value: 2528.425 mgc: 1.860215e-08 ustep: 0.9848857 
mgc: 1.047707e-10 
iter: 1  mgc: 1.047707e-10 
Matching hessian patterns... Done
outer mgc:  205.0318 
iter: 1  value: 2607.992 mgc: 20.5135 ustep: 1 
iter: 2  value: 2606.975 mgc: 1.512402 ustep: 1 
iter: 3  value: 2606.975 mgc: 0.01983914 ustep: 1 
iter: 4  value: 2606.975 mgc: 5.337517e-06 ustep: 1 
iter: 5  mgc: 6.17284e-13 
iter: 1  value: 2482.06 mgc: 7.699459 ustep: 1 
iter: 2  value: 2482.036 mgc: 0.2258661 ustep: 1 
iter: 3  value: 2482.036 mgc: 0.0004834162 ustep: 1 
iter: 4  mgc: 2.236541e-09 
iter: 1  mgc: 2.236541e-09 
outer mgc:  151.8962 
iter: 1  value: 2472.725 mgc: 13.81827 ustep: 1 
iter: 2  value: 2472.476 mgc: 0.606739 ustep: 1 
iter: 3  value: 2472.476 mgc: 0.005543404 ustep: 1 
iter: 4  value: 2472.476 mgc: 5.629519e-07 ustep: 1 
iter: 5  mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  220.1974 
iter: 1  value: 2413.52 mgc: 4.867206 ustep: 1 
iter: 2  value: 2413.517 mgc: 0.08941344 ustep: 1 
iter: 3  value: 2413.517 mgc: 7.240154e-05 ustep: 1 
iter: 4  mgc: 7.12792e-11 
iter: 1  mgc: 7.12792e-11 
outer mgc:  74.82646 
iter: 1  value: 2387.157 mgc: 25.41494 ustep: 1 
iter: 2  value: 2382.701 mgc: 2.801346 ustep: 1 
iter: 3  value: 2382.699 mgc: 0.1030747 ustep: 1 
iter: 4  value: 2382.699 mgc: 0.0001570449 ustep: 1 
iter: 5  mgc: 3.661009e-10 
iter: 1  mgc: 3.661009e-10 
outer mgc:  192.0412 
iter: 1  value: 2405.146 mgc: 29.28437 ustep: 1 
iter: 2  value: 2402.711 mgc: 2.535571 ustep: 1 
iter: 3  value: 2402.711 mgc: 0.02910265 ustep: 1 
iter: 4  value: 2402.711 mgc: 5.986658e-06 ustep: 1 
iter: 5  mgc: 2.833289e-13 
iter: 1  value: 2373.25 mgc: 15.27167 ustep: 1 
iter: 2  value: 2373.043 mgc: 0.5599493 ustep: 1 
iter: 3  value: 2373.043 mgc: 0.002093655 ustep: 1 
iter: 4  value: 2373.043 mgc: 6.147371e-08 ustep: 1 
mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  190.1261 
iter: 1  value: 2351.086 mgc: 6.564229 ustep: 1 
iter: 2  value: 2351.032 mgc: 0.316299 ustep: 1 
iter: 3  value: 2351.032 mgc: 0.002118262 ustep: 1 
iter: 4  value: 2351.032 mgc: 1.003903e-07 ustep: 1 
mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  47.80775 
iter: 1  value: 2346.722 mgc: 11.40193 ustep: 1 
iter: 2  value: 2346.564 mgc: 0.5096959 ustep: 1 
iter: 3  value: 2346.564 mgc: 0.001951099 ustep: 1 
iter: 4  value: 2346.564 mgc: 5.065155e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  34.02787 
iter: 1  value: 2341.979 mgc: 10.77767 ustep: 1 
iter: 2  value: 2341.918 mgc: 0.3843501 ustep: 1 
iter: 3  value: 2341.918 mgc: 0.001523823 ustep: 1 
iter: 4  value: 2341.918 mgc: 3.160156e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  31.79019 
iter: 1  value: 2348.203 mgc: 12.51163 ustep: 1 
iter: 2  value: 2347.88 mgc: 0.6563574 ustep: 1 
iter: 3  value: 2347.88 mgc: 0.004151135 ustep: 1 
iter: 4  value: 2347.88 mgc: 3.625409e-07 ustep: 1 
iter: 5  mgc: 3.375078e-14 
iter: 1  value: 2340.473 mgc: 6.3746 ustep: 1 
iter: 2  value: 2340.459 mgc: 0.1295245 ustep: 1 
iter: 3  value: 2340.459 mgc: 0.0001617391 ustep: 1 
iter: 4  mgc: 3.451652e-10 
iter: 1  mgc: 3.451652e-10 
outer mgc:  47.25354 
iter: 1  value: 2340.317 mgc: 3.803997 ustep: 1 
iter: 2  value: 2340.316 mgc: 0.03076719 ustep: 1 
iter: 3  value: 2340.316 mgc: 4.969176e-06 ustep: 1 
iter: 4  mgc: 2.056133e-13 
iter: 1  value: 2339.399 mgc: 2.566682 ustep: 1 
iter: 2  value: 2339.398 mgc: 0.01412926 ustep: 1 
iter: 3  value: 2339.398 mgc: 2.312629e-06 ustep: 1 
iter: 4  mgc: 7.061018e-14 
iter: 1  mgc: 7.061018e-14 
outer mgc:  20.55575 
iter: 1  value: 2338.7 mgc: 0.838713 ustep: 1 
iter: 2  value: 2338.7 mgc: 0.003605479 ustep: 1 
iter: 3  value: 2338.7 mgc: 2.586333e-07 ustep: 1 
iter: 4  mgc: 4.13003e-14 
iter: 1  mgc: 4.13003e-14 
outer mgc:  6.992194 
iter: 1  value: 2338.522 mgc: 0.3853928 ustep: 1 
iter: 2  value: 2338.522 mgc: 0.001259196 ustep: 1 
iter: 3  value: 2338.522 mgc: 2.300979e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  12.82881 
iter: 1  value: 2338.466 mgc: 0.5342575 ustep: 1 
iter: 2  value: 2338.466 mgc: 0.002352639 ustep: 1 
iter: 3  value: 2338.466 mgc: 2.275808e-07 ustep: 1 
iter: 4  mgc: 2.331468e-14 
iter: 1  mgc: 2.331468e-14 
outer mgc:  20.65313 
iter: 1  value: 2338.397 mgc: 1.120949 ustep: 1 
iter: 2  value: 2338.397 mgc: 0.005487666 ustep: 1 
iter: 3  value: 2338.397 mgc: 3.035779e-07 ustep: 1 
iter: 4  mgc: 3.491651e-14 
iter: 1  mgc: 3.491651e-14 
outer mgc:  17.54206 
iter: 1  value: 2339.97 mgc: 4.600586 ustep: 1 
iter: 2  value: 2339.968 mgc: 0.06621689 ustep: 1 
iter: 3  value: 2339.968 mgc: 3.050645e-05 ustep: 1 
iter: 4  mgc: 1.214362e-11 
iter: 1  value: 2338.03 mgc: 1.186637 ustep: 1 
iter: 2  value: 2338.03 mgc: 0.004477151 ustep: 1 
iter: 3  value: 2338.03 mgc: 1.509495e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  11.46118 
iter: 1  value: 2338.195 mgc: 1.014075 ustep: 1 
iter: 2  value: 2338.194 mgc: 0.003441809 ustep: 1 
iter: 3  value: 2338.194 mgc: 1.023844e-07 ustep: 1 
iter: 4  mgc: 2.353673e-14 
iter: 1  value: 2337.949 mgc: 0.3254424 ustep: 1 
iter: 2  value: 2337.949 mgc: 0.0003531427 ustep: 1 
iter: 3  mgc: 1.094626e-09 
iter: 1  mgc: 1.094626e-09 
outer mgc:  3.254112 
iter: 1  value: 2337.889 mgc: 0.4350464 ustep: 1 
iter: 2  value: 2337.889 mgc: 0.0006485588 ustep: 1 
iter: 3  mgc: 4.183826e-09 
iter: 1  mgc: 4.183826e-09 
outer mgc:  3.944438 
iter: 1  value: 2337.815 mgc: 0.2129234 ustep: 1 
iter: 2  value: 2337.815 mgc: 0.0002652332 ustep: 1 
iter: 3  mgc: 1.641335e-09 
iter: 1  mgc: 1.641335e-09 
outer mgc:  1.491221 
iter: 1  value: 2337.834 mgc: 0.2124103 ustep: 1 
iter: 2  value: 2337.834 mgc: 6.894601e-05 ustep: 1 
iter: 3  mgc: 1.165525e-10 
iter: 1  value: 2337.817 mgc: 0.04635249 ustep: 1 
iter: 2  value: 2337.817 mgc: 2.833519e-05 ustep: 1 
iter: 3  mgc: 1.9869e-11 
iter: 1  mgc: 1.9869e-11 
outer mgc:  0.4932457 
iter: 1  value: 2337.816 mgc: 0.0988554 ustep: 1 
iter: 2  value: 2337.816 mgc: 2.660734e-05 ustep: 1 
iter: 3  mgc: 5.393463e-12 
iter: 1  mgc: 5.393463e-12 
outer mgc:  0.875236 
iter: 1  value: 2337.795 mgc: 0.06472008 ustep: 1 
iter: 2  value: 2337.795 mgc: 1.158822e-05 ustep: 1 
iter: 3  mgc: 1.423306e-12 
iter: 1  value: 2337.808 mgc: 0.03262352 ustep: 1 
iter: 2  value: 2337.808 mgc: 3.596234e-06 ustep: 1 
iter: 3  mgc: 8.926193e-14 
iter: 1  mgc: 8.926193e-14 
outer mgc:  0.7345554 
iter: 1  value: 2337.804 mgc: 0.1198898 ustep: 1 
iter: 2  value: 2337.804 mgc: 3.236488e-05 ustep: 1 
iter: 3  mgc: 6.322942e-12 
iter: 1  mgc: 6.322942e-12 
outer mgc:  0.3188152 
iter: 1  value: 2337.8 mgc: 0.04794856 ustep: 1 
iter: 2  value: 2337.8 mgc: 4.930869e-06 ustep: 1 
iter: 3  mgc: 3.166356e-13 
iter: 1  mgc: 3.166356e-13 
outer mgc:  0.1537269 
iter: 1  value: 2337.812 mgc: 0.04829892 ustep: 1 
iter: 2  value: 2337.812 mgc: 1.219418e-05 ustep: 1 
iter: 3  mgc: 3.098855e-12 
iter: 1  value: 2337.803 mgc: 0.009326514 ustep: 1 
iter: 2  value: 2337.803 mgc: 4.549654e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.1592136 
iter: 1  value: 2337.805 mgc: 0.01257947 ustep: 1 
iter: 2  value: 2337.805 mgc: 4.953109e-07 ustep: 1 
iter: 3  mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  0.1187945 
iter: 1  value: 2337.807 mgc: 0.01086964 ustep: 1 
iter: 2  value: 2337.807 mgc: 3.389185e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  0.07486949 
iter: 1  value: 2337.807 mgc: 0.008448721 ustep: 1 
iter: 2  value: 2337.807 mgc: 3.116578e-07 ustep: 1 
iter: 3  mgc: 2.68674e-14 
iter: 1  mgc: 2.68674e-14 
outer mgc:  0.04633146 
iter: 1  value: 2337.806 mgc: 0.01422959 ustep: 1 
iter: 2  value: 2337.806 mgc: 1.027484e-06 ustep: 1 
iter: 3  mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  0.04800634 
iter: 1  value: 2337.808 mgc: 0.0190049 ustep: 1 
iter: 2  value: 2337.808 mgc: 1.684174e-06 ustep: 1 
iter: 3  mgc: 6.483702e-14 
iter: 1  value: 2337.807 mgc: 0.01455579 ustep: 1 
iter: 2  value: 2337.807 mgc: 8.03589e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
iter: 1  value: 2337.806 mgc: 0.005194955 ustep: 1 
iter: 2  value: 2337.806 mgc: 1.023674e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.04424522 
iter: 1  value: 2337.807 mgc: 0.002528289 ustep: 1 
iter: 2  value: 2337.807 mgc: 2.439013e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.03247134 
iter: 1  value: 2337.807 mgc: 0.001568444 ustep: 1 
iter: 2  value: 2337.807 mgc: 2.88808e-08 ustep: 1 
mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  0.02341455 
iter: 1  value: 2337.807 mgc: 0.008658243 ustep: 1 
iter: 2  value: 2337.807 mgc: 2.966776e-07 ustep: 1 
iter: 3  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  0.04595356 
iter: 1  value: 2337.809 mgc: 0.007255187 ustep: 1 
iter: 2  value: 2337.809 mgc: 2.405719e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.03818107 
iter: 1  value: 2337.808 mgc: 0.004252847 ustep: 1 
iter: 2  value: 2337.808 mgc: 6.582905e-08 ustep: 1 
iter: 3  mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  0.03265322 
iter: 1  value: 2337.808 mgc: 0.004513488 ustep: 1 
iter: 2  value: 2337.808 mgc: 5.685058e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.02337916 
iter: 1  value: 2337.808 mgc: 0.001691481 ustep: 1 
iter: 2  value: 2337.808 mgc: 1.271747e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  0.003671684 
iter: 1  value: 2337.808 mgc: 0.0004069609 ustep: 1 
iter: 2  mgc: 5.615066e-10 
iter: 1  mgc: 5.615066e-10 
outer mgc:  0.001151861 
iter: 1  mgc: 5.615066e-10 
iter: 1  mgc: 5.615066e-10 
outer mgc:  0.001151861 
iter: 1  value: 2337.807 mgc: 0.05512903 ustep: 1 
iter: 2  value: 2337.807 mgc: 9.656051e-06 ustep: 1 
iter: 3  mgc: 7.229772e-13 
outer mgc:  0.2552269 
iter: 1  value: 2337.809 mgc: 0.0551304 ustep: 1 
iter: 2  value: 2337.809 mgc: 9.664587e-06 ustep: 1 
iter: 3  mgc: 7.164269e-13 
outer mgc:  0.2547077 
iter: 1  value: 2337.809 mgc: 0.02850659 ustep: 1 
iter: 2  value: 2337.809 mgc: 3.255234e-06 ustep: 1 
iter: 3  mgc: 9.015011e-14 
outer mgc:  0.9751314 
iter: 1  value: 2337.808 mgc: 0.02850204 ustep: 1 
iter: 2  value: 2337.808 mgc: 3.255281e-06 ustep: 1 
iter: 3  mgc: 8.582024e-14 
outer mgc:  0.977422 
iter: 1  value: 2337.809 mgc: 0.05890604 ustep: 1 
iter: 2  value: 2337.809 mgc: 8.770997e-06 ustep: 1 
iter: 3  mgc: 5.462297e-13 
outer mgc:  0.3116644 
iter: 1  value: 2337.807 mgc: 0.0589038 ustep: 1 
iter: 2  value: 2337.807 mgc: 8.779009e-06 ustep: 1 
iter: 3  mgc: 5.453415e-13 
outer mgc:  0.3125579 
iter: 1  value: 2337.809 mgc: 0.02967421 ustep: 1 
iter: 2  value: 2337.809 mgc: 2.66392e-06 ustep: 1 
iter: 3  mgc: 5.639933e-14 
outer mgc:  1.178836 
iter: 1  value: 2337.809 mgc: 0.0296727 ustep: 1 
iter: 2  value: 2337.809 mgc: 2.665411e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  1.178785 
iter: 1  value: 2337.803 mgc: 0.004702022 ustep: 1 
iter: 2  value: 2337.803 mgc: 2.745177e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.06218657 
iter: 1  value: 2337.814 mgc: 0.004697208 ustep: 1 
iter: 2  value: 2337.814 mgc: 2.741666e-07 ustep: 1 
iter: 3  mgc: 2.731149e-14 
outer mgc:  0.06228628 
iter: 1  value: 2337.817 mgc: 0.009955535 ustep: 1 
iter: 2  value: 2337.817 mgc: 1.943164e-06 ustep: 1 
iter: 3  mgc: 9.370282e-14 
outer mgc:  0.24617 
iter: 1  value: 2337.8 mgc: 0.009980072 ustep: 1 
iter: 2  value: 2337.8 mgc: 1.949545e-06 ustep: 1 
iter: 3  mgc: 8.792966e-14 
outer mgc:  0.2466243 
iter: 1  value: 2337.816 mgc: 0.01073871 ustep: 1 
iter: 2  value: 2337.816 mgc: 1.579813e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.2478041 
iter: 1  value: 2337.8 mgc: 0.01076393 ustep: 1 
iter: 2  value: 2337.8 mgc: 1.585791e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.2482024 
[Sun Aug 15 23:04:47 2021]
Finished job 0.
1 of 1 steps (100%) done

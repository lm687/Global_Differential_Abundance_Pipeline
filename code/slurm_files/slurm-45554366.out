Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 13:28:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0_ModeldiagREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset0.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21853.595646 
final  value 20703.401061 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19273.57 mgc: 6.721285 ustep: 0.8994163 
iter: 2  value: 19162.86 mgc: 4.530973 ustep: 0.9483808 
iter: 3  value: 19120.42 mgc: 4.753501 ustep: 0.8382098 
iter: 4  value: 19104.58 mgc: 6.200569 ustep: 0.4608065 
iter: 5  value: 19101.6 mgc: 2.587417 ustep: 0.6788594 
iter: 6  value: 19101.5 mgc: 0.3650469 ustep: 0.8239469 
iter: 7  value: 19101.5 mgc: 0.04159243 ustep: 0.9077244 
iter: 8  value: 19101.5 mgc: 0.002280284 ustep: 0.9527505 
iter: 9  value: 19101.5 mgc: 6.529479e-05 ustep: 0.9760918 
iter: 10  value: 19101.5 mgc: 1.032714e-06 ustep: 0.9879748 
iter: 11  mgc: 8.721357e-09 
iter: 1  mgc: 8.721357e-09 
Matching hessian patterns... Done
outer mgc:  131.969 
iter: 1  value: 18952.04 mgc: 1.867158 ustep: 1 
iter: 2  value: 18951.98 mgc: 0.224228 ustep: 1 
iter: 3  value: 18951.98 mgc: 0.002288166 ustep: 1 
iter: 4  value: 18951.98 mgc: 3.680599e-07 ustep: 1 
iter: 5  mgc: 4.898859e-15 
iter: 1  mgc: 4.898859e-15 
outer mgc:  41.18408 
iter: 1  value: 18875.17 mgc: 3.959928 ustep: 1 
iter: 2  value: 18870.19 mgc: 1.361489 ustep: 1 
iter: 3  value: 18870.18 mgc: 0.07058288 ustep: 1 
iter: 4  value: 18870.18 mgc: 0.0003108755 ustep: 1 
iter: 5  mgc: 6.277497e-09 
iter: 1  mgc: 6.277497e-09 
outer mgc:  32.2954 
iter: 1  value: 18856.46 mgc: 3.849006 ustep: 1 
iter: 2  value: 18855.07 mgc: 1.142353 ustep: 1 
iter: 3  value: 18855.07 mgc: 0.05630164 ustep: 1 
iter: 4  value: 18855.07 mgc: 0.0001483755 ustep: 1 
iter: 5  mgc: 1.319872e-09 
iter: 1  mgc: 1.319872e-09 
outer mgc:  53.16954 
iter: 1  value: 18844.19 mgc: 5.027642 ustep: 1 
iter: 2  value: 18843.65 mgc: 0.7652494 ustep: 1 
iter: 3  value: 18843.65 mgc: 0.01457517 ustep: 1 
iter: 4  value: 18843.65 mgc: 5.232344e-06 ustep: 1 
iter: 5  mgc: 6.894485e-13 
iter: 1  value: 18798.58 mgc: 2.514337 ustep: 1 
iter: 2  value: 18798.5 mgc: 0.2749453 ustep: 1 
iter: 3  value: 18798.5 mgc: 0.003667381 ustep: 1 
iter: 4  value: 18798.5 mgc: 8.68407e-07 ustep: 1 
iter: 5  mgc: 6.017409e-14 
iter: 1  mgc: 6.017409e-14 
outer mgc:  29.16961 
iter: 1  value: 18812.03 mgc: 4.50448 ustep: 1 
iter: 2  value: 18809.04 mgc: 1.016514 ustep: 1 
iter: 3  value: 18809.04 mgc: 0.02133347 ustep: 1 
iter: 4  value: 18809.04 mgc: 1.260209e-05 ustep: 1 
iter: 5  mgc: 4.25171e-12 
iter: 1  value: 18789 mgc: 1.25982 ustep: 1 
iter: 2  value: 18788.99 mgc: 0.04868375 ustep: 1 
iter: 3  value: 18788.99 mgc: 0.000141321 ustep: 1 
iter: 4  mgc: 1.482809e-09 
iter: 1  mgc: 1.482809e-09 
outer mgc:  14.95659 
iter: 1  value: 18781.52 mgc: 0.6023361 ustep: 1 
iter: 2  value: 18781.52 mgc: 0.009877998 ustep: 1 
iter: 3  value: 18781.52 mgc: 4.841024e-06 ustep: 1 
iter: 4  mgc: 1.136868e-12 
iter: 1  mgc: 1.136868e-12 
outer mgc:  13.22119 
iter: 1  value: 18774.52 mgc: 1.142498 ustep: 1 
iter: 2  value: 18774.51 mgc: 0.03094265 ustep: 1 
iter: 3  value: 18774.51 mgc: 4.817888e-05 ustep: 1 
iter: 4  mgc: 1.377296e-10 
iter: 1  mgc: 1.377296e-10 
outer mgc:  16.25911 
iter: 1  value: 18769.19 mgc: 1.126493 ustep: 1 
iter: 2  value: 18769.19 mgc: 0.03608882 ustep: 1 
iter: 3  value: 18769.19 mgc: 3.97387e-05 ustep: 1 
iter: 4  mgc: 5.043876e-11 
iter: 1  mgc: 5.043876e-11 
outer mgc:  10.70378 
iter: 1  value: 18753.05 mgc: 1.607651 ustep: 1 
iter: 2  value: 18753.05 mgc: 0.05679172 ustep: 1 
iter: 3  value: 18753.05 mgc: 0.0001051464 ustep: 1 
iter: 4  mgc: 4.204797e-10 
iter: 1  mgc: 4.204797e-10 
outer mgc:  16.04505 
iter: 1  value: 18741.33 mgc: 1.445616 ustep: 1 
iter: 2  value: 18741.33 mgc: 0.02977149 ustep: 1 
iter: 3  value: 18741.33 mgc: 1.763954e-05 ustep: 1 
iter: 4  mgc: 4.755751e-12 
iter: 1  mgc: 4.755751e-12 
outer mgc:  28.15208 
iter: 1  value: 18735.4 mgc: 0.7663643 ustep: 1 
iter: 2  value: 18735.4 mgc: 0.01093201 ustep: 1 
iter: 3  value: 18735.4 mgc: 3.854691e-06 ustep: 1 
iter: 4  mgc: 3.619327e-13 
iter: 1  mgc: 3.619327e-13 
outer mgc:  8.313664 
iter: 1  value: 18734.56 mgc: 1.277951 ustep: 1 
iter: 2  value: 18734.56 mgc: 0.02971425 ustep: 1 
iter: 3  value: 18734.56 mgc: 1.33911e-05 ustep: 1 
iter: 4  mgc: 2.842615e-12 
iter: 1  value: 18734.13 mgc: 0.3606049 ustep: 1 
iter: 2  value: 18734.13 mgc: 0.002334873 ustep: 1 
iter: 3  value: 18734.13 mgc: 8.134782e-08 ustep: 1 
iter: 4  mgc: 4.898859e-15 
iter: 1  mgc: 4.898859e-15 
outer mgc:  5.835877 
iter: 1  value: 18731.73 mgc: 0.328614 ustep: 1 
iter: 2  value: 18731.73 mgc: 0.001561589 ustep: 1 
iter: 3  value: 18731.73 mgc: 5.735857e-08 ustep: 1 
iter: 4  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  5.74894 
iter: 1  value: 18727.03 mgc: 0.5167903 ustep: 1 
iter: 2  value: 18727.03 mgc: 0.00211383 ustep: 1 
iter: 3  value: 18727.03 mgc: 6.522206e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  6.821102 
iter: 1  value: 18719.98 mgc: 1.221454 ustep: 1 
iter: 2  value: 18719.98 mgc: 0.01014408 ustep: 1 
iter: 3  value: 18719.98 mgc: 2.497837e-06 ustep: 1 
iter: 4  mgc: 1.478817e-13 
iter: 1  mgc: 1.478817e-13 
outer mgc:  8.729066 
iter: 1  value: 18707.36 mgc: 0.3978573 ustep: 1 
iter: 2  value: 18707.36 mgc: 0.0007454844 ustep: 1 
iter: 3  mgc: 7.076108e-09 
iter: 1  mgc: 7.076108e-09 
outer mgc:  6.05142 
iter: 1  value: 18702.89 mgc: 1.381218 ustep: 1 
iter: 2  value: 18702.89 mgc: 0.01420922 ustep: 1 
iter: 3  value: 18702.89 mgc: 2.117098e-06 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 18706.14 mgc: 0.7343642 ustep: 1 
iter: 2  value: 18706.14 mgc: 0.004783744 ustep: 1 
iter: 3  value: 18706.14 mgc: 2.659799e-07 ustep: 1 
iter: 4  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  10.04176 
iter: 1  value: 18700.51 mgc: 0.5403197 ustep: 1 
iter: 2  value: 18700.51 mgc: 0.003877376 ustep: 1 
iter: 3  value: 18700.51 mgc: 2.574463e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  11.40085 
iter: 1  value: 18695.56 mgc: 0.6212465 ustep: 1 
iter: 2  value: 18695.56 mgc: 0.002877911 ustep: 1 
iter: 3  value: 18695.56 mgc: 7.19514e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  3.742405 
iter: 1  value: 18686.4 mgc: 0.4805837 ustep: 1 
iter: 2  value: 18686.4 mgc: 0.002321134 ustep: 1 
iter: 3  value: 18686.4 mgc: 8.469873e-08 ustep: 1 
mgc: 4.253542e-15 
iter: 1  mgc: 4.253542e-15 
outer mgc:  3.30378 
iter: 1  value: 18674.04 mgc: 0.8947204 ustep: 1 
iter: 2  value: 18674.04 mgc: 0.00427473 ustep: 1 
iter: 3  value: 18674.04 mgc: 2.163221e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  value: 18638.66 mgc: 2.678702 ustep: 1 
iter: 2  value: 18638.66 mgc: 0.02645983 ustep: 1 
iter: 3  value: 18638.66 mgc: 3.236434e-06 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  30.09939 
iter: 1  value: 18592.15 mgc: 4.979254 ustep: 1 
iter: 2  value: 18592.15 mgc: 0.01418607 ustep: 1 
iter: 3  value: 18592.15 mgc: 1.811001e-07 ustep: 1 
mgc: 3.330669e-15 
iter: 1  value: 18619.94 mgc: 1.836106 ustep: 1 
iter: 2  value: 18619.94 mgc: 0.004689562 ustep: 1 
iter: 3  value: 18619.94 mgc: 3.552253e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  13.36981 
iter: 1  value: 18613.6 mgc: 1.374547 ustep: 1 
iter: 2  value: 18613.6 mgc: 0.001876695 ustep: 1 
iter: 3  mgc: 3.380964e-09 
iter: 1  value: 18617.67 mgc: 0.3552016 ustep: 1 
iter: 2  value: 18617.67 mgc: 0.0001882678 ustep: 1 
iter: 3  mgc: 1.091416e-10 
iter: 1  mgc: 1.091416e-10 
outer mgc:  2.895913 
iter: 1  value: 18611.57 mgc: 0.3906898 ustep: 1 
iter: 2  value: 18611.57 mgc: 0.0002735643 ustep: 1 
iter: 3  mgc: 2.183245e-10 
iter: 1  value: 18602.91 mgc: 0.5683045 ustep: 1 
iter: 2  value: 18602.91 mgc: 0.0003390611 ustep: 1 
iter: 3  mgc: 2.895262e-10 
iter: 1  mgc: 2.895262e-10 
outer mgc:  2.356594 
iter: 1  value: 18588.28 mgc: 1.252711 ustep: 1 
iter: 2  value: 18588.28 mgc: 0.0009796102 ustep: 1 
iter: 3  mgc: 1.440098e-09 
iter: 1  mgc: 1.440098e-09 
outer mgc:  2.262875 
iter: 1  value: 18573.02 mgc: 1.103029 ustep: 1 
iter: 2  value: 18573.02 mgc: 0.0006224634 ustep: 1 
iter: 3  mgc: 4.570273e-10 
iter: 1  value: 18544.03 mgc: 2.447253 ustep: 1 
iter: 2  value: 18544.03 mgc: 0.001355825 ustep: 1 
iter: 3  mgc: 1.170442e-09 
iter: 1  mgc: 1.170442e-09 
outer mgc:  4.818918 
iter: 1  value: 18498.22 mgc: 4.29478 ustep: 1 
iter: 2  value: 18498.22 mgc: 0.0013402 ustep: 1 
iter: 3  mgc: 4.627592e-10 
iter: 1  mgc: 4.627592e-10 
outer mgc:  2.765659 
iter: 1  value: 18455.33 mgc: 4.110438 ustep: 1 
iter: 2  value: 18455.33 mgc: 0.0005031963 ustep: 1 
iter: 3  mgc: 2.918332e-11 
iter: 1  mgc: 2.918332e-11 
outer mgc:  2.045793 
iter: 1  value: 18411.77 mgc: 3.966911 ustep: 1 
iter: 2  value: 18411.77 mgc: 0.0002312009 ustep: 1 
iter: 3  mgc: 3.155698e-12 
iter: 1  mgc: 3.155698e-12 
outer mgc:  1.243532 
iter: 1  value: 18368.12 mgc: 4.232792 ustep: 1 
iter: 2  value: 18368.12 mgc: 0.0001103934 ustep: 1 
iter: 3  mgc: 5.284662e-13 
iter: 1  mgc: 5.284662e-13 
outer mgc:  0.6828602 
iter: 1  value: 18324.37 mgc: 4.245 ustep: 1 
iter: 2  value: 18324.37 mgc: 5.593888e-05 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  0.2397766 
iter: 1  value: 18280.49 mgc: 4.247415 ustep: 1 
iter: 2  value: 18280.49 mgc: 2.996444e-05 ustep: 1 
iter: 3  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  0.1918155 
iter: 1  value: 18224.8 mgc: 5.859683 ustep: 1 
iter: 2  value: 18224.8 mgc: 2.343915e-05 ustep: 1 
iter: 3  mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.1106815 
iter: 1  value: 18173.16 mgc: 5.283365 ustep: 1 
iter: 2  value: 18173.16 mgc: 9.212255e-06 ustep: 1 
iter: 3  mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  0.07374269 
iter: 1  value: 18121.48 mgc: 5.291208 ustep: 1 
iter: 2  value: 18121.48 mgc: 4.338879e-06 ustep: 1 
mgc: 4.32987e-15 
iter: 1  mgc: 4.32987e-15 
outer mgc:  0.04483184 
iter: 1  value: 18069.78 mgc: 5.295113 ustep: 1 
iter: 2  value: 18069.78 mgc: 2.043282e-06 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.03162479 
iter: 1  value: 18018.06 mgc: 5.29742 ustep: 1 
iter: 2  value: 18018.06 mgc: 9.605947e-07 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.0204818 
iter: 1  value: 17966.32 mgc: 5.29855 ustep: 1 
iter: 2  value: 17966.32 mgc: 4.514821e-07 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.0146128 
iter: 1  value: 17914.58 mgc: 5.299362 ustep: 1 
iter: 2  value: 17914.58 mgc: 2.120263e-07 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  0.009483132 
iter: 1  value: 17862.84 mgc: 5.299807 ustep: 1 
iter: 2  value: 17862.84 mgc: 9.955646e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  0.006747281 
iter: 1  value: 17811.09 mgc: 5.30014 ustep: 1 
iter: 2  value: 17811.09 mgc: 4.672955e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  0.004424205 
iter: 1  value: 17759.34 mgc: 5.300318 ustep: 1 
iter: 2  value: 17759.34 mgc: 2.193219e-08 ustep: 1 
mgc: 6.328271e-15 
iter: 1  mgc: 6.328271e-15 
outer mgc:  0.003178721 
iter: 1  value: 17707.58 mgc: 5.300455 ustep: 1 
iter: 2  value: 17707.58 mgc: 1.029206e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.002110739 
iter: 1  value: 17655.83 mgc: 5.30053 ustep: 1 
iter: 2  mgc: 4.829577e-09 
iter: 1  mgc: 4.829577e-09 
outer mgc:  0.00152701 
iter: 1  value: 17604.07 mgc: 5.30059 ustep: 1 
iter: 2  mgc: 2.266134e-09 
iter: 1  mgc: 2.266134e-09 
outer mgc:  0.001027318 
iter: 1  value: 17552.32 mgc: 5.300623 ustep: 1 
iter: 2  mgc: 1.063306e-09 
iter: 1  mgc: 1.063306e-09 
outer mgc:  0.0007485889 
iter: 1  mgc: 1.063306e-09 
iter: 1  mgc: 1.063306e-09 
outer mgc:  0.0007485889 
iter: 1  value: 17552.32 mgc: 0.005307019 ustep: 1 
iter: 2  mgc: 5.051515e-15 
outer mgc:  0.3026218 
iter: 1  value: 17552.32 mgc: 0.005305571 ustep: 1 
iter: 2  mgc: 5.995204e-15 
outer mgc:  0.3020529 
iter: 1  value: 17552.32 mgc: 0.002728767 ustep: 1 
iter: 2  mgc: 3.996803e-15 
outer mgc:  0.1526546 
iter: 1  value: 17552.32 mgc: 0.002728173 ustep: 1 
iter: 2  mgc: 4.884981e-15 
outer mgc:  0.1523193 
iter: 1  value: 17552.32 mgc: 0.004331742 ustep: 1 
iter: 2  mgc: 5.995204e-15 
outer mgc:  0.4127366 
iter: 1  value: 17552.32 mgc: 0.004332847 ustep: 1 
iter: 2  mgc: 5.77316e-15 
outer mgc:  0.4125237 
iter: 1  value: 17552.32 mgc: 0.002164592 ustep: 1 
iter: 2  mgc: 3.996803e-15 
outer mgc:  0.2070937 
iter: 1  value: 17552.32 mgc: 0.002164834 ustep: 1 
iter: 2  mgc: 5.329071e-15 
outer mgc:  0.2069417 
iter: 1  value: 17552.37 mgc: 0.005705654 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.0007485942 
iter: 1  value: 17552.27 mgc: 0.005711362 ustep: 1 
mgc: 3.996803e-15 
outer mgc:  0.0007485835 
iter: 1  value: 17552.37 mgc: 0.004380599 ustep: 1 
iter: 2  mgc: 5.329071e-15 
outer mgc:  0.0007518151 
iter: 1  value: 17552.27 mgc: 0.004384983 ustep: 1 
iter: 2  mgc: 4.662937e-15 
outer mgc:  0.0007453659 
iter: 1  value: 17552.32 mgc: 0.004752224 ustep: 1 
iter: 2  mgc: 7.105427e-15 
outer mgc:  0.1945354 
iter: 1  value: 17552.32 mgc: 0.0047494 ustep: 1 
iter: 2  mgc: 6.217249e-15 
outer mgc:  0.1959407 
[Sat Aug 14 13:28:33 2021]
Finished job 0.
1 of 1 steps (100%) done

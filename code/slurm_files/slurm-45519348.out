Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:33:03 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4476.845076 
iter  10 value 4120.260497
iter  10 value 4120.260497
final  value 4120.260497 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3998.776 mgc: 5.4325 ustep: 1 
iter: 2  value: 3988.294 mgc: 5.289682 ustep: 0.8994163 
iter: 3  value: 3968.346 mgc: 5.505023 ustep: 0.772724 
iter: 4  value: 3968.265 mgc: 2.241525 ustep: 0.8790593 
iter: 5  value: 3962.798 mgc: 4.211787 ustep: 0.7501008 
iter: 6  value: 3962.01 mgc: 1.916303 ustep: 0.866097 
iter: 7  value: 3959.738 mgc: 3.543627 ustep: 0.9306503 
iter: 8  value: 3959.48 mgc: 0.590972 ustep: 0.9647057 
iter: 9  value: 3959.48 mgc: 0.02304469 ustep: 0.9821961 
iter: 10  value: 3959.48 mgc: 0.000229368 ustep: 0.991059 
iter: 11  value: 3959.48 mgc: 1.039783e-06 ustep: 0.9955199 
iter: 12  mgc: 2.816797e-09 
iter: 1  mgc: 2.816797e-09 
Matching hessian patterns... Done
outer mgc:  24.68701 
iter: 1  value: 3922.616 mgc: 1.452534 ustep: 1 
iter: 2  value: 3922.609 mgc: 0.1060575 ustep: 1 
iter: 3  value: 3922.609 mgc: 0.001011189 ustep: 1 
iter: 4  value: 3922.609 mgc: 9.522778e-08 ustep: 1 
iter: 5  mgc: 3.885781e-15 
iter: 1  value: 3885.169 mgc: 6.114863 ustep: 1 
iter: 2  value: 3885.034 mgc: 1.118898 ustep: 1 
iter: 3  value: 3885.034 mgc: 0.02379032 ustep: 1 
iter: 4  value: 3885.034 mgc: 1.110899e-05 ustep: 1 
iter: 5  mgc: 2.529976e-12 
iter: 1  mgc: 2.529976e-12 
outer mgc:  24.71426 
iter: 1  value: 4055.801 mgc: 16.42569 ustep: 0.8994163 
iter: 2  value: 3964.213 mgc: 12.72549 ustep: 0.9483808 
iter: 3  value: 3937.993 mgc: 8.319375 ustep: 0.365699 
iter: 4  value: 3935.103 mgc: 5.620843 ustep: 0.6047701 
iter: 5  value: 3935.085 mgc: 0.3026515 ustep: 0.7776919 
iter: 6  value: 3935.085 mgc: 0.01383705 ustep: 0.8818802 
iter: 7  value: 3935.085 mgc: 0.0002882033 ustep: 0.9390909 
iter: 8  value: 3935.085 mgc: 2.994684e-06 ustep: 0.9690701 
iter: 9  value: 3935.085 mgc: 1.557141e-08 ustep: 0.9844151 
mgc: 4.039435e-11 
iter: 1  value: 3874.563 mgc: 5.358486 ustep: 1 
iter: 2  value: 3874.04 mgc: 1.429217 ustep: 1 
iter: 3  value: 3874.04 mgc: 0.0344441 ustep: 1 
iter: 4  value: 3874.04 mgc: 6.308789e-05 ustep: 1 
iter: 5  mgc: 2.019382e-10 
iter: 1  mgc: 2.019382e-10 
outer mgc:  15.44168 
iter: 1  value: 3870.711 mgc: 5.692723 ustep: 1 
iter: 2  value: 3870.657 mgc: 0.482074 ustep: 1 
iter: 3  value: 3870.657 mgc: 0.00432637 ustep: 1 
iter: 4  value: 3870.657 mgc: 3.385906e-07 ustep: 1 
iter: 5  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  29.79588 
iter: 1  value: 3861.553 mgc: 3.256839 ustep: 1 
iter: 2  value: 3861.548 mgc: 0.1094798 ustep: 1 
iter: 3  value: 3861.548 mgc: 0.0001967424 ustep: 1 
iter: 4  mgc: 6.142007e-10 
iter: 1  mgc: 6.142007e-10 
outer mgc:  6.795625 
iter: 1  value: 3852.192 mgc: 2.756426 ustep: 1 
iter: 2  value: 3852.192 mgc: 0.01802852 ustep: 1 
iter: 3  value: 3852.192 mgc: 5.393363e-06 ustep: 1 
iter: 4  mgc: 4.907186e-13 
iter: 1  mgc: 4.907186e-13 
outer mgc:  4.438899 
iter: 1  value: 3850.764 mgc: 4.183519 ustep: 1 
iter: 2  value: 3850.764 mgc: 0.06043793 ustep: 1 
iter: 3  value: 3850.764 mgc: 2.671449e-05 ustep: 1 
iter: 4  mgc: 8.424705e-12 
iter: 1  value: 3851.506 mgc: 1.145149 ustep: 1 
iter: 2  value: 3851.506 mgc: 0.006747234 ustep: 1 
iter: 3  value: 3851.506 mgc: 3.688493e-07 ustep: 1 
iter: 4  mgc: 8.149731e-15 
iter: 1  mgc: 8.149731e-15 
outer mgc:  6.387649 
iter: 1  value: 3849.813 mgc: 1.17808 ustep: 1 
iter: 2  value: 3849.813 mgc: 0.003635409 ustep: 1 
iter: 3  value: 3849.813 mgc: 1.515531e-07 ustep: 1 
iter: 4  mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  2.175787 
iter: 1  value: 3847.959 mgc: 0.9817362 ustep: 1 
iter: 2  value: 3847.959 mgc: 0.005296469 ustep: 1 
iter: 3  value: 3847.959 mgc: 2.666882e-07 ustep: 1 
iter: 4  mgc: 6.827872e-15 
iter: 1  mgc: 6.827872e-15 
outer mgc:  2.926001 
iter: 1  value: 3843.21 mgc: 2.649039 ustep: 1 
iter: 2  value: 3843.21 mgc: 0.0215403 ustep: 1 
iter: 3  value: 3843.21 mgc: 5.763085e-07 ustep: 1 
iter: 4  mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  1.572584 
iter: 1  value: 3840.216 mgc: 2.200973 ustep: 1 
iter: 2  value: 3840.216 mgc: 0.01071867 ustep: 1 
iter: 3  value: 3840.216 mgc: 5.965026e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  value: 3841.701 mgc: 0.9317094 ustep: 1 
iter: 2  value: 3841.701 mgc: 0.002533387 ustep: 1 
iter: 3  value: 3841.701 mgc: 4.042292e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  1.077596 
iter: 1  value: 3840.319 mgc: 1.309416 ustep: 1 
iter: 2  value: 3840.319 mgc: 0.002665147 ustep: 1 
iter: 3  value: 3840.319 mgc: 3.711006e-08 ustep: 1 
mgc: 8.65974e-15 
iter: 1  mgc: 8.65974e-15 
outer mgc:  0.8287697 
iter: 1  value: 3838.141 mgc: 1.373356 ustep: 1 
iter: 2  value: 3838.141 mgc: 0.003331206 ustep: 1 
iter: 3  value: 3838.141 mgc: 1.271597e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.8059385 
iter: 1  value: 3836.401 mgc: 1.458331 ustep: 1 
iter: 2  value: 3836.401 mgc: 0.002917043 ustep: 1 
iter: 3  value: 3836.401 mgc: 1.790424e-08 ustep: 1 
mgc: 1.032507e-14 
iter: 1  mgc: 1.032507e-14 
outer mgc:  0.7112491 
iter: 1  value: 3834.592 mgc: 0.6636294 ustep: 1 
iter: 2  value: 3834.592 mgc: 0.001255297 ustep: 1 
iter: 3  value: 3834.592 mgc: 1.12258e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.7105082 
iter: 1  value: 3832.192 mgc: 0.6328474 ustep: 1 
iter: 2  value: 3832.192 mgc: 0.0005436153 ustep: 1 
iter: 3  mgc: 1.398764e-09 
iter: 1  mgc: 1.398764e-09 
outer mgc:  1.025836 
iter: 1  value: 3829.98 mgc: 0.7943361 ustep: 1 
iter: 2  value: 3829.98 mgc: 0.001436675 ustep: 1 
iter: 3  value: 3829.98 mgc: 1.428965e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.6962016 
iter: 1  value: 3828.083 mgc: 1.860323 ustep: 1 
iter: 2  value: 3828.083 mgc: 0.001054114 ustep: 1 
iter: 3  mgc: 1.062881e-09 
iter: 1  mgc: 1.062881e-09 
outer mgc:  0.875322 
iter: 1  value: 3825.52 mgc: 1.737462 ustep: 1 
iter: 2  value: 3825.52 mgc: 0.00122748 ustep: 1 
iter: 3  mgc: 5.253006e-09 
iter: 1  mgc: 5.253006e-09 
outer mgc:  0.5428418 
iter: 1  value: 3823.189 mgc: 0.9071816 ustep: 1 
iter: 2  value: 3823.189 mgc: 0.0003912329 ustep: 1 
iter: 3  mgc: 7.557119e-10 
iter: 1  mgc: 7.557119e-10 
outer mgc:  0.1519278 
iter: 1  value: 3821.155 mgc: 1.58754 ustep: 1 
iter: 2  value: 3821.155 mgc: 0.0003056482 ustep: 1 
iter: 3  mgc: 1.536931e-10 
iter: 1  mgc: 1.536931e-10 
outer mgc:  0.1815713 
iter: 1  value: 3819.146 mgc: 1.346686 ustep: 1 
iter: 2  value: 3819.146 mgc: 0.0002130332 ustep: 1 
iter: 3  mgc: 1.195026e-10 
iter: 1  mgc: 1.195026e-10 
outer mgc:  0.07856242 
iter: 1  value: 3817.649 mgc: 1.173953 ustep: 1 
iter: 2  value: 3817.649 mgc: 6.815924e-05 ustep: 1 
iter: 3  mgc: 5.044853e-12 
iter: 1  mgc: 5.044853e-12 
outer mgc:  0.04530721 
iter: 1  value: 3816.52 mgc: 0.8148768 ustep: 1 
iter: 2  value: 3816.52 mgc: 2.437055e-05 ustep: 1 
iter: 3  mgc: 1.127987e-13 
iter: 1  mgc: 1.127987e-13 
outer mgc:  0.05424457 
iter: 1  value: 3814.568 mgc: 1.162426 ustep: 1 
iter: 2  value: 3814.568 mgc: 3.184741e-05 ustep: 1 
iter: 3  mgc: 1.280753e-12 
iter: 1  mgc: 1.280753e-12 
outer mgc:  0.05866645 
iter: 1  value: 3813.109 mgc: 0.9911683 ustep: 1 
iter: 2  value: 3813.109 mgc: 1.405728e-05 ustep: 1 
iter: 3  mgc: 2.011724e-13 
iter: 1  mgc: 2.011724e-13 
outer mgc:  0.05569454 
iter: 1  value: 3810.402 mgc: 3.249275 ustep: 1 
iter: 2  value: 3810.402 mgc: 0.0001094191 ustep: 1 
iter: 3  mgc: 2.487832e-11 
iter: 1  mgc: 2.487832e-11 
outer mgc:  0.05737446 
iter: 1  value: 3808.178 mgc: 4.230299 ustep: 1 
iter: 2  value: 3808.178 mgc: 0.0001318993 ustep: 1 
iter: 3  mgc: 2.020872e-11 
iter: 1  mgc: 2.020872e-11 
outer mgc:  0.03260824 
iter: 1  value: 3805.8 mgc: 3.47243 ustep: 1 
iter: 2  value: 3805.8 mgc: 5.287448e-05 ustep: 1 
iter: 3  mgc: 3.741896e-12 
iter: 1  mgc: 3.741896e-12 
outer mgc:  0.01002383 
iter: 1  value: 3803.341 mgc: 2.044123 ustep: 1 
iter: 2  value: 3803.341 mgc: 8.741117e-06 ustep: 1 
iter: 3  mgc: 2.424727e-13 
iter: 1  mgc: 2.424727e-13 
outer mgc:  0.01884897 
iter: 1  value: 3799.325 mgc: 2.380256 ustep: 1 
iter: 2  value: 3799.325 mgc: 4.566169e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.01664856 
iter: 1  value: 3795.979 mgc: 2.302965 ustep: 1 
iter: 2  value: 3795.979 mgc: 2.921004e-06 ustep: 1 
iter: 3  mgc: 6.57252e-14 
iter: 1  mgc: 6.57252e-14 
outer mgc:  0.008695265 
iter: 1  value: 3791.663 mgc: 4.150139 ustep: 1 
iter: 2  value: 3791.663 mgc: 4.0334e-06 ustep: 1 
iter: 3  mgc: 7.194245e-14 
iter: 1  mgc: 7.194245e-14 
outer mgc:  0.003596426 
iter: 1  value: 3788.236 mgc: 2.552033 ustep: 1 
iter: 2  value: 3788.236 mgc: 5.654937e-07 ustep: 1 
iter: 3  mgc: 1.14575e-13 
iter: 1  mgc: 1.14575e-13 
outer mgc:  0.007105499 
iter: 1  value: 3785.327 mgc: 1.88121 ustep: 1 
iter: 2  value: 3785.327 mgc: 2.083743e-07 ustep: 1 
mgc: 7.926992e-14 
iter: 1  mgc: 7.926992e-14 
outer mgc:  0.007894713 
iter: 1  value: 3781.141 mgc: 4.822798 ustep: 1 
iter: 2  value: 3781.141 mgc: 7.330628e-07 ustep: 1 
iter: 3  mgc: 1.363354e-13 
iter: 1  mgc: 1.363354e-13 
outer mgc:  0.005114999 
iter: 1  value: 3777.68 mgc: 5.699978 ustep: 1 
iter: 2  value: 3777.68 mgc: 4.859264e-07 ustep: 1 
iter: 3  mgc: 3.863576e-13 
iter: 1  mgc: 3.863576e-13 
outer mgc:  0.001683386 
iter: 1  value: 3773.736 mgc: 6.677282 ustep: 1 
iter: 2  value: 3773.736 mgc: 3.243274e-07 ustep: 1 
iter: 3  mgc: 3.965717e-13 
iter: 1  mgc: 3.965717e-13 
outer mgc:  0.001472062 
iter: 1  value: 3770.433 mgc: 3.257206 ustep: 1 
iter: 2  value: 3770.433 mgc: 3.610267e-08 ustep: 1 
mgc: 6.146195e-13 
iter: 1  mgc: 6.146195e-13 
outer mgc:  0.001945766 
iter: 1  value: 3766.237 mgc: 3.096416 ustep: 1 
iter: 2  value: 3766.237 mgc: 1.369465e-08 ustep: 1 
mgc: 6.448175e-13 
iter: 1  mgc: 6.448175e-13 
outer mgc:  0.001424174 
iter: 1  value: 3762.767 mgc: 5.803926 ustep: 1 
iter: 2  value: 3762.767 mgc: 2.402124e-08 ustep: 1 
mgc: 1.128431e-12 
iter: 1  mgc: 1.128431e-12 
outer mgc:  0.000474289 
iter: 1  value: 3758.625 mgc: 8.643239 ustep: 1 
iter: 2  value: 3758.625 mgc: 2.463365e-08 ustep: 1 
mgc: 1.506795e-12 
iter: 1  mgc: 1.506795e-12 
outer mgc:  0.0005384344 
iter: 1  value: 3755.198 mgc: 4.000221 ustep: 1 
iter: 2  mgc: 2.427519e-09 
iter: 1  mgc: 2.427519e-09 
outer mgc:  0.0008387631 
iter: 1  value: 3751.06 mgc: 4.765592 ustep: 1 
iter: 2  mgc: 1.662664e-09 
iter: 1  mgc: 1.662664e-09 
outer mgc:  0.0006769659 
iter: 1  value: 3747.634 mgc: 9.967829 ustep: 1 
iter: 2  mgc: 4.403153e-09 
iter: 1  mgc: 4.403153e-09 
outer mgc:  0.0003209079 
iter: 1  value: 3743.458 mgc: 16.58987 ustep: 1 
iter: 2  mgc: 5.503805e-09 
iter: 1  mgc: 5.503805e-09 
outer mgc:  9.134825e-05 
iter: 1  value: 3740.004 mgc: 9.709365 ustep: 1 
iter: 2  mgc: 8.932242e-10 
iter: 1  mgc: 8.932242e-10 
outer mgc:  0.0002448987 
iter: 1  mgc: 8.932242e-10 
iter: 1  mgc: 8.932242e-10 
outer mgc:  0.0002448987 
iter: 1  value: 3740.004 mgc: 0.006389169 ustep: 1 
iter: 2  value: 3740.004 mgc: 5.63384e-08 ustep: 1 
mgc: 7.562277e-12 
outer mgc:  0.09326019 
iter: 1  value: 3740.004 mgc: 0.006389814 ustep: 1 
iter: 2  value: 3740.004 mgc: 5.641075e-08 ustep: 1 
mgc: 9.315659e-12 
outer mgc:  0.09357165 
iter: 1  value: 3740.005 mgc: 0.003198126 ustep: 1 
iter: 2  value: 3740.005 mgc: 1.463207e-08 ustep: 1 
mgc: 7.956746e-12 
outer mgc:  0.05347667 
iter: 1  value: 3740.004 mgc: 0.003198212 ustep: 1 
iter: 2  value: 3740.004 mgc: 1.46501e-08 ustep: 1 
mgc: 2.0691e-11 
outer mgc:  0.05307543 
iter: 1  value: 3740.005 mgc: 0.005471691 ustep: 1 
iter: 2  mgc: 1.148459e-09 
outer mgc:  0.07296339 
iter: 1  value: 3740.004 mgc: 0.005468215 ustep: 1 
iter: 2  mgc: 1.144261e-09 
outer mgc:  0.07244926 
iter: 1  value: 3740.005 mgc: 0.003276637 ustep: 1 
iter: 2  mgc: 9.858643e-10 
outer mgc:  0.03646677 
iter: 1  value: 3740.004 mgc: 0.003275095 ustep: 1 
iter: 2  mgc: 9.855028e-10 
outer mgc:  0.03613307 
iter: 1  value: 3740.019 mgc: 66.30637 ustep: 1 
iter: 2  value: 3740.019 mgc: 1.131226e-07 ustep: 1 
mgc: 2.984235e-11 
outer mgc:  0.003787903 
iter: 1  value: 3739.989 mgc: 66.37271 ustep: 1 
iter: 2  value: 3739.989 mgc: 1.128721e-07 ustep: 1 
mgc: 1.10334e-11 
outer mgc:  0.00380296 
iter: 1  value: 3740.025 mgc: 66.24452 ustep: 1 
iter: 2  value: 3740.025 mgc: 4.308571e-08 ustep: 1 
mgc: 6.38245e-12 
outer mgc:  0.0006875519 
iter: 1  value: 3739.984 mgc: 66.44354 ustep: 1 
iter: 2  value: 3739.984 mgc: 4.296006e-08 ustep: 1 
mgc: 1.671729e-11 
outer mgc:  0.000313856 
iter: 1  value: 3740.004 mgc: 0.0001440821 ustep: 1 
mgc: 1.595701e-11 
outer mgc:  0.0002448993 
iter: 1  value: 3740.005 mgc: 0.0001440798 ustep: 1 
mgc: 1.296963e-11 
outer mgc:  0.0002448982 
iter: 1  value: 3740.003 mgc: 0.003857201 ustep: 1 
iter: 2  value: 3740.003 mgc: 2.860745e-08 ustep: 1 
mgc: 1.799494e-11 
outer mgc:  0.03042923 
iter: 1  value: 3740.006 mgc: 0.003854253 ustep: 1 
iter: 2  value: 3740.006 mgc: 2.853752e-08 ustep: 1 
mgc: 1.108447e-11 
outer mgc:  0.03040615 
[Fri Aug 13 11:33:06 2021]
Finished job 0.
1 of 1 steps (100%) done

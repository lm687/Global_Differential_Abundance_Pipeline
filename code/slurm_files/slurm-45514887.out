Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 10:36:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4397.744992 
final  value 3777.609059 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3659.175 mgc: 5.963827 ustep: 0.8994163 
iter: 2  value: 3632.599 mgc: 6.341296 ustep: 0.772724 
iter: 3  value: 3583.788 mgc: 5.005235 ustep: 0.4101874 
iter: 4  value: 3568.215 mgc: 3.640452 ustep: 0.4003724 
iter: 5  value: 3566.747 mgc: 2.284384 ustep: 0.6327866 
iter: 6  value: 3566.712 mgc: 0.2602 ustep: 0.7954993 
iter: 7  value: 3566.711 mgc: 0.02791726 ustep: 0.8919185 
iter: 8  value: 3566.711 mgc: 0.001874091 ustep: 0.9444199 
iter: 9  value: 3566.711 mgc: 8.538872e-05 ustep: 0.9718155 
iter: 10  value: 3566.711 mgc: 1.940672e-06 ustep: 0.9858085 
iter: 11  value: 3566.711 mgc: 2.202529e-08 ustep: 0.9928796 
iter: 12  mgc: 1.250028e-10 
iter: 1  mgc: 1.250028e-10 
Matching hessian patterns... Done
outer mgc:  24.56498 
iter: 1  value: 3537.576 mgc: 1.767299 ustep: 1 
iter: 2  value: 3537.475 mgc: 0.5108495 ustep: 1 
iter: 3  value: 3537.475 mgc: 0.01284353 ustep: 1 
iter: 4  value: 3537.475 mgc: 9.824311e-06 ustep: 1 
iter: 5  mgc: 5.859806e-12 
iter: 1  value: 3525.702 mgc: 3.785988 ustep: 1 
iter: 2  value: 3524.793 mgc: 1.976081 ustep: 1 
iter: 3  value: 3524.791 mgc: 0.08398633 ustep: 1 
iter: 4  value: 3524.791 mgc: 0.0004201994 ustep: 1 
iter: 5  value: 3524.791 mgc: 1.167943e-08 ustep: 1 
mgc: 9.436896e-15 
iter: 1  mgc: 9.436896e-15 
outer mgc:  14.34596 
iter: 1  value: 3571.252 mgc: 5.113737 ustep: 0.8994163 
iter: 2  value: 3516.111 mgc: 8.867467 ustep: 0.9483808 
iter: 3  value: 3512.702 mgc: 3.845036 ustep: 0.973851 
iter: 4  value: 3512.604 mgc: 1.058165 ustep: 0.9868402 
iter: 5  value: 3512.604 mgc: 0.02242878 ustep: 0.993399 
iter: 6  value: 3512.604 mgc: 5.04832e-05 ustep: 0.9966944 
iter: 7  value: 3512.604 mgc: 3.491131e-08 ustep: 0.998346 
iter: 8  mgc: 1.524214e-11 
iter: 1  mgc: 1.524214e-11 
outer mgc:  8.546867 
iter: 1  value: 3507.096 mgc: 3.825861 ustep: 1 
iter: 2  value: 3507.079 mgc: 0.2781123 ustep: 1 
iter: 3  value: 3507.079 mgc: 0.001034003 ustep: 1 
iter: 4  value: 3507.079 mgc: 1.84242e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  value: 3504.078 mgc: 1.589174 ustep: 1 
iter: 2  value: 3504.071 mgc: 0.1079673 ustep: 1 
iter: 3  value: 3504.071 mgc: 0.0009825202 ustep: 1 
iter: 4  value: 3504.071 mgc: 7.687426e-08 ustep: 1 
iter: 5  mgc: 8.326673e-15 
iter: 1  mgc: 8.326673e-15 
outer mgc:  9.51088 
iter: 1  value: 3503.333 mgc: 5.652601 ustep: 1 
iter: 2  value: 3502.568 mgc: 1.452865 ustep: 1 
iter: 3  value: 3502.568 mgc: 0.01281581 ustep: 1 
iter: 4  value: 3502.568 mgc: 5.628045e-06 ustep: 1 
iter: 5  mgc: 3.596567e-13 
iter: 1  value: 3500.032 mgc: 2.091881 ustep: 1 
iter: 2  value: 3500.023 mgc: 0.1069173 ustep: 1 
iter: 3  value: 3500.023 mgc: 0.0007921595 ustep: 1 
iter: 4  value: 3500.023 mgc: 4.88116e-08 ustep: 1 
iter: 5  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  4.293685 
iter: 1  value: 3497.63 mgc: 1.642305 ustep: 1 
iter: 2  value: 3497.619 mgc: 0.1052179 ustep: 1 
iter: 3  value: 3497.619 mgc: 0.0005572098 ustep: 1 
iter: 4  value: 3497.619 mgc: 2.066376e-08 ustep: 1 
mgc: 5.52336e-15 
iter: 1  mgc: 5.52336e-15 
outer mgc:  4.544325 
iter: 1  value: 3489.001 mgc: 2.517846 ustep: 1 
iter: 2  value: 3488.995 mgc: 0.1325381 ustep: 1 
iter: 3  value: 3488.995 mgc: 0.0005536593 ustep: 1 
iter: 4  value: 3488.995 mgc: 1.173836e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  4.18939 
iter: 1  value: 3484.731 mgc: 2.410169 ustep: 1 
iter: 2  value: 3484.73 mgc: 0.08141831 ustep: 1 
iter: 3  value: 3484.73 mgc: 0.0001067875 ustep: 1 
iter: 4  mgc: 2.260216e-10 
iter: 1  mgc: 2.260216e-10 
outer mgc:  5.152528 
iter: 1  value: 3477.244 mgc: 1.961335 ustep: 1 
iter: 2  value: 3477.243 mgc: 0.01954228 ustep: 1 
iter: 3  value: 3477.243 mgc: 1.85703e-06 ustep: 1 
iter: 4  mgc: 3.619327e-14 
iter: 1  mgc: 3.619327e-14 
outer mgc:  12.54099 
iter: 1  value: 3470.794 mgc: 2.423564 ustep: 1 
iter: 2  value: 3470.794 mgc: 0.02305222 ustep: 1 
iter: 3  value: 3470.794 mgc: 4.563597e-06 ustep: 1 
iter: 4  mgc: 1.976197e-13 
iter: 1  mgc: 1.976197e-13 
outer mgc:  6.5896 
iter: 1  value: 3473.108 mgc: 3.676518 ustep: 1 
iter: 2  value: 3473.107 mgc: 0.03862029 ustep: 1 
iter: 3  value: 3473.107 mgc: 4.488731e-06 ustep: 1 
iter: 4  mgc: 7.127632e-14 
iter: 1  value: 3469.538 mgc: 0.6032563 ustep: 1 
iter: 2  value: 3469.538 mgc: 0.0005720297 ustep: 1 
iter: 3  mgc: 2.584177e-09 
iter: 1  mgc: 2.584177e-09 
outer mgc:  3.362134 
iter: 1  value: 3466.951 mgc: 0.9792043 ustep: 1 
iter: 2  value: 3466.951 mgc: 0.006197645 ustep: 1 
iter: 3  value: 3466.951 mgc: 2.70548e-07 ustep: 1 
iter: 4  mgc: 9.436896e-15 
iter: 1  mgc: 9.436896e-15 
outer mgc:  5.737944 
iter: 1  value: 3463.772 mgc: 1.948202 ustep: 1 
iter: 2  value: 3463.772 mgc: 0.011632 ustep: 1 
iter: 3  value: 3463.772 mgc: 6.726045e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  8.462399 
iter: 1  value: 3460.285 mgc: 1.164874 ustep: 1 
iter: 2  value: 3460.285 mgc: 0.006142522 ustep: 1 
iter: 3  value: 3460.285 mgc: 1.581358e-07 ustep: 1 
mgc: 6.106227e-15 
iter: 1  mgc: 6.106227e-15 
outer mgc:  4.056263 
iter: 1  value: 3456.274 mgc: 0.6338197 ustep: 1 
iter: 2  value: 3456.274 mgc: 0.001354215 ustep: 1 
iter: 3  mgc: 5.428055e-09 
iter: 1  mgc: 5.428055e-09 
outer mgc:  4.924681 
iter: 1  value: 3452.016 mgc: 1.053256 ustep: 1 
iter: 2  value: 3452.016 mgc: 0.000695812 ustep: 1 
iter: 3  mgc: 8.566494e-10 
iter: 1  mgc: 8.566494e-10 
outer mgc:  2.190224 
iter: 1  value: 3443.135 mgc: 2.523191 ustep: 1 
iter: 2  value: 3443.135 mgc: 0.002357663 ustep: 1 
iter: 3  mgc: 5.132643e-09 
iter: 1  mgc: 5.132643e-09 
outer mgc:  1.96908 
iter: 1  value: 3433.424 mgc: 1.934711 ustep: 1 
iter: 2  value: 3433.424 mgc: 0.001223491 ustep: 1 
iter: 3  mgc: 5.875576e-10 
iter: 1  mgc: 5.875576e-10 
outer mgc:  1.778472 
iter: 1  value: 3424.941 mgc: 1.684451 ustep: 1 
iter: 2  value: 3424.941 mgc: 0.000453264 ustep: 1 
iter: 3  mgc: 3.806022e-11 
iter: 1  mgc: 3.806022e-11 
outer mgc:  0.3552077 
iter: 1  value: 3416.389 mgc: 1.930886 ustep: 1 
iter: 2  value: 3416.389 mgc: 0.000199179 ustep: 1 
iter: 3  mgc: 3.41549e-12 
iter: 1  mgc: 3.41549e-12 
outer mgc:  0.2968637 
iter: 1  value: 3400.633 mgc: 4.314753 ustep: 1 
iter: 2  value: 3400.633 mgc: 0.000213659 ustep: 1 
iter: 3  mgc: 9.445777e-13 
iter: 1  mgc: 9.445777e-13 
outer mgc:  0.3410187 
iter: 1  value: 3386.633 mgc: 3.845347 ustep: 1 
iter: 2  value: 3386.633 mgc: 4.603778e-05 ustep: 1 
iter: 3  mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  0.2214616 
iter: 1  value: 3376.583 mgc: 2.439913 ustep: 1 
iter: 2  value: 3376.583 mgc: 7.057514e-06 ustep: 1 
iter: 3  mgc: 4.107825e-15 
iter: 1  mgc: 4.107825e-15 
outer mgc:  0.1005022 
iter: 1  value: 3361.839 mgc: 4.02838 ustep: 1 
iter: 2  value: 3361.839 mgc: 5.137118e-06 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.06886946 
iter: 1  value: 3347.974 mgc: 3.747627 ustep: 1 
iter: 2  value: 3347.974 mgc: 1.24821e-06 ustep: 1 
mgc: 5.218048e-15 
iter: 1  mgc: 5.218048e-15 
outer mgc:  0.1174651 
iter: 1  value: 3334.102 mgc: 3.74644 ustep: 1 
iter: 2  value: 3334.102 mgc: 3.511951e-07 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.01690062 
iter: 1  value: 3320.266 mgc: 3.743068 ustep: 1 
iter: 2  value: 3320.266 mgc: 9.925401e-08 ustep: 1 
mgc: 5.662137e-15 
iter: 1  mgc: 5.662137e-15 
outer mgc:  0.009947074 
iter: 1  value: 3306.428 mgc: 3.740977 ustep: 1 
iter: 2  value: 3306.428 mgc: 2.822941e-08 ustep: 1 
mgc: 3.108624e-15 
iter: 1  mgc: 3.108624e-15 
outer mgc:  0.003565266 
iter: 1  value: 3292.589 mgc: 3.74163 ustep: 1 
iter: 2  mgc: 8.070865e-09 
iter: 1  mgc: 8.070865e-09 
outer mgc:  0.001480716 
iter: 1  value: 3278.749 mgc: 3.742284 ustep: 1 
iter: 2  mgc: 2.313691e-09 
iter: 1  mgc: 2.313691e-09 
outer mgc:  0.0005699123 
iter: 1  value: 3264.909 mgc: 3.742869 ustep: 1 
iter: 2  mgc: 6.647629e-10 
iter: 1  mgc: 6.647629e-10 
outer mgc:  0.0004334125 
iter: 1  value: 3251.069 mgc: 3.743026 ustep: 1 
iter: 2  mgc: 1.913358e-10 
iter: 1  mgc: 1.913358e-10 
outer mgc:  0.0001326629 
iter: 1  value: 3237.229 mgc: 3.743101 ustep: 1 
iter: 2  mgc: 5.550316e-11 
iter: 1  mgc: 5.550316e-11 
outer mgc:  8.868562e-05 
iter: 1  value: 3223.389 mgc: 3.743122 ustep: 1 
iter: 2  mgc: 1.610845e-11 
iter: 1  mgc: 1.610845e-11 
outer mgc:  5.276513e-05 
iter: 1  value: 3209.549 mgc: 3.743145 ustep: 1 
iter: 2  mgc: 4.678924e-12 
iter: 1  mgc: 4.678924e-12 
outer mgc:  2.804136e-05 
iter: 1  value: 3195.709 mgc: 3.743158 ustep: 1 
iter: 2  mgc: 1.361133e-12 
iter: 1  mgc: 1.361133e-12 
outer mgc:  1.11795e-05 
iter: 1  value: 3181.869 mgc: 3.743167 ustep: 1 
iter: 2  mgc: 3.890221e-13 
iter: 1  mgc: 3.890221e-13 
outer mgc:  5.313427e-06 
iter: 1  value: 3168.029 mgc: 3.743171 ustep: 1 
iter: 2  mgc: 1.159073e-13 
iter: 1  mgc: 1.159073e-13 
outer mgc:  2.842231e-06 
iter: 1  value: 3154.189 mgc: 3.743173 ustep: 1 
iter: 2  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  1.88507e-06 
iter: 1  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  1.88507e-06 
iter: 1  value: 3154.189 mgc: 0.004680394 ustep: 1 
mgc: 2.664535e-15 
outer mgc:  0.06687093 
iter: 1  value: 3154.189 mgc: 0.004677504 ustep: 1 
mgc: 4.218847e-15 
outer mgc:  0.0668056 
iter: 1  value: 3154.189 mgc: 0.002319787 ustep: 1 
mgc: 4.884981e-15 
outer mgc:  0.03307535 
iter: 1  value: 3154.189 mgc: 0.002318186 ustep: 1 
mgc: 5.662137e-15 
outer mgc:  0.03304207 
iter: 1  value: 3154.189 mgc: 0.005601192 ustep: 1 
mgc: 4.662937e-15 
outer mgc:  0.09907812 
iter: 1  value: 3154.189 mgc: 0.005600527 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.09910445 
iter: 1  value: 3154.189 mgc: 0.002974378 ustep: 1 
mgc: 9.769963e-15 
outer mgc:  0.04941272 
iter: 1  value: 3154.189 mgc: 0.002973421 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.04942787 
iter: 1  value: 3154.199 mgc: 0.002660737 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  1.885077e-06 
iter: 1  value: 3154.179 mgc: 0.002663399 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  1.885064e-06 
iter: 1  value: 3154.199 mgc: 0.004386942 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  1.887077e-06 
iter: 1  value: 3154.179 mgc: 0.004391332 ustep: 1 
mgc: 5.995204e-15 
outer mgc:  1.883066e-06 
iter: 1  value: 3154.189 mgc: 0.004383128 ustep: 1 
mgc: 3.552714e-15 
outer mgc:  0.03663213 
iter: 1  value: 3154.189 mgc: 0.004380413 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.03662169 
[Fri Aug 13 10:36:48 2021]
Finished job 0.
1 of 1 steps (100%) done

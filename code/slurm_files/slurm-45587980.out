Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:04:42 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2235.676007 
final  value 2125.256659 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 968.2407 mgc: 75.67642 ustep: 0.6827823 
iter: 2  value: 892.271 mgc: 75.26764 ustep: 0.5831969 
iter: 3  value: 625.4979 mgc: 123.1186 ustep: 0.1649487 
iter: 4  value: 463.8537 mgc: 73.95122 ustep: 0.1221448 
iter: 5  value: 422.3241 mgc: 128.5331 ustep: 0.3495572 
iter: 6  value: 374.7045 mgc: 73.04335 ustep: 0.1057773 
iter: 7  value: 369.9951 mgc: 122.3102 ustep: 0.3253018 
iter: 8  value: 310.4318 mgc: 102.9743 ustep: 0.1001932 
iter: 9  value: 199.1575 mgc: 109.2336 ustep: 0.3166014 
iter: 10  value: 177.1032 mgc: 43.03026 ustep: 0.5627172 
iter: 11  value: 172.0255 mgc: 23.03153 ustep: 0.7501698 
iter: 12  value: 172.015 mgc: 0.9947368 ustep: 0.8661368 
iter: 13  value: 172.015 mgc: 0.006408729 ustep: 0.9306716 
iter: 14  value: 172.015 mgc: 1.059862e-05 ustep: 0.9647168 
iter: 15  mgc: 9.826308e-09 
iter: 1  mgc: 9.826308e-09 
Matching hessian patterns... Done
outer mgc:  52.12622 
iter: 1  value: 183.6859 mgc: 23.6156 ustep: 1 
iter: 2  value: 183.4369 mgc: 2.288457 ustep: 1 
iter: 3  value: 183.4369 mgc: 0.01495941 ustep: 1 
iter: 4  value: 183.4369 mgc: 7.406593e-07 ustep: 1 
iter: 5  mgc: 1.759703e-14 
iter: 1  value: 160.4393 mgc: 10.737 ustep: 1 
iter: 2  value: 160.4333 mgc: 0.3899905 ustep: 1 
iter: 3  value: 160.4333 mgc: 0.0004778422 ustep: 1 
iter: 4  mgc: 6.484518e-10 
iter: 1  mgc: 6.484518e-10 
outer mgc:  10.54862 
iter: 1  value: 156.5117 mgc: 10.23498 ustep: 1 
iter: 2  value: 156.4203 mgc: 0.8715844 ustep: 1 
iter: 3  value: 156.4203 mgc: 0.006331993 ustep: 1 
iter: 4  value: 156.4203 mgc: 4.201542e-07 ustep: 1 
iter: 5  mgc: 1.160183e-14 
iter: 1  mgc: 1.160183e-14 
outer mgc:  11.65854 
iter: 1  value: 151.8152 mgc: 1.225307 ustep: 1 
iter: 2  value: 151.8152 mgc: 0.01565685 ustep: 1 
iter: 3  value: 151.8152 mgc: 2.467899e-06 ustep: 1 
iter: 4  mgc: 6.250556e-14 
iter: 1  mgc: 6.250556e-14 
outer mgc:  13.34242 
iter: 1  value: 146.9524 mgc: 12.88434 ustep: 1 
iter: 2  value: 146.8941 mgc: 0.7429572 ustep: 1 
iter: 3  value: 146.8941 mgc: 0.005231384 ustep: 1 
iter: 4  value: 146.8941 mgc: 2.656487e-07 ustep: 1 
iter: 5  mgc: 1.812439e-14 
iter: 1  mgc: 1.812439e-14 
outer mgc:  12.09715 
iter: 1  value: 139.528 mgc: 6.186482 ustep: 1 
iter: 2  value: 139.5164 mgc: 0.3967681 ustep: 1 
iter: 3  value: 139.5164 mgc: 0.00132468 ustep: 1 
iter: 4  value: 139.5164 mgc: 1.562764e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  12.49661 
iter: 1  value: 135.6482 mgc: 14.27324 ustep: 1 
iter: 2  value: 135.6005 mgc: 1.0267 ustep: 1 
iter: 3  value: 135.6005 mgc: 0.00292504 ustep: 1 
iter: 4  value: 135.6005 mgc: 6.155147e-08 ustep: 1 
mgc: 1.265654e-14 
iter: 1  mgc: 1.265654e-14 
outer mgc:  30.22118 
iter: 1  value: 143.6652 mgc: 29.10153 ustep: 1 
iter: 2  value: 142.3061 mgc: 4.671079 ustep: 1 
iter: 3  value: 142.3058 mgc: 0.08260409 ustep: 1 
iter: 4  value: 142.3058 mgc: 2.675316e-05 ustep: 1 
iter: 5  mgc: 2.853717e-12 
iter: 1  value: 132.2255 mgc: 16.23987 ustep: 1 
iter: 2  value: 132.1762 mgc: 0.766332 ustep: 1 
iter: 3  value: 132.1762 mgc: 0.003286628 ustep: 1 
iter: 4  value: 132.1762 mgc: 6.327356e-08 ustep: 1 
mgc: 1.421085e-14 
iter: 1  mgc: 1.421085e-14 
outer mgc:  21.96025 
iter: 1  value: 127.503 mgc: 9.603761 ustep: 1 
iter: 2  value: 127.5007 mgc: 0.1431864 ustep: 1 
iter: 3  value: 127.5007 mgc: 0.0002324818 ustep: 1 
iter: 4  mgc: 8.974288e-11 
iter: 1  mgc: 8.974288e-11 
outer mgc:  10.68996 
iter: 1  value: 125.1372 mgc: 9.141672 ustep: 1 
iter: 2  value: 125.1308 mgc: 0.354533 ustep: 1 
iter: 3  value: 125.1308 mgc: 0.0004560585 ustep: 1 
iter: 4  mgc: 7.758547e-10 
iter: 1  mgc: 7.758547e-10 
outer mgc:  12.59102 
iter: 1  value: 121.5811 mgc: 8.009406 ustep: 1 
iter: 2  value: 121.581 mgc: 0.05724563 ustep: 1 
iter: 3  value: 121.581 mgc: 7.04287e-06 ustep: 1 
iter: 4  mgc: 1.465494e-13 
iter: 1  mgc: 1.465494e-13 
outer mgc:  7.372775 
iter: 1  value: 119.1221 mgc: 4.891249 ustep: 1 
iter: 2  value: 119.122 mgc: 0.06181478 ustep: 1 
iter: 3  value: 119.122 mgc: 1.056117e-05 ustep: 1 
iter: 4  mgc: 4.387601e-13 
iter: 1  mgc: 4.387601e-13 
outer mgc:  6.852484 
iter: 1  value: 117.2833 mgc: 8.297434 ustep: 1 
iter: 2  value: 117.2828 mgc: 0.09075177 ustep: 1 
iter: 3  value: 117.2828 mgc: 1.25012e-05 ustep: 1 
iter: 4  mgc: 4.849454e-13 
iter: 1  mgc: 4.849454e-13 
outer mgc:  8.906702 
iter: 1  value: 120.873 mgc: 10.28209 ustep: 1 
iter: 2  value: 120.873 mgc: 0.05199312 ustep: 1 
iter: 3  value: 120.873 mgc: 1.557663e-06 ustep: 1 
iter: 4  mgc: 1.909584e-14 
iter: 1  value: 117.0209 mgc: 2.427518 ustep: 1 
iter: 2  value: 117.0209 mgc: 0.004661402 ustep: 1 
iter: 3  value: 117.0209 mgc: 1.730728e-08 ustep: 1 
mgc: 1.398881e-14 
iter: 1  mgc: 1.398881e-14 
outer mgc:  9.485901 
iter: 1  value: 116.4126 mgc: 2.969653 ustep: 1 
iter: 2  value: 116.4126 mgc: 0.007710363 ustep: 1 
iter: 3  value: 116.4126 mgc: 1.229369e-07 ustep: 1 
mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  3.280124 
iter: 1  value: 116.006 mgc: 1.252606 ustep: 1 
iter: 2  value: 116.006 mgc: 0.001416835 ustep: 1 
iter: 3  mgc: 9.863733e-09 
iter: 1  mgc: 9.863733e-09 
outer mgc:  3.301404 
iter: 1  value: 115.6156 mgc: 3.928489 ustep: 1 
iter: 2  value: 115.6156 mgc: 0.004252211 ustep: 1 
iter: 3  value: 115.6156 mgc: 1.031071e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  1.404638 
iter: 1  value: 114.7016 mgc: 3.602492 ustep: 1 
iter: 2  value: 114.7016 mgc: 0.01125544 ustep: 1 
iter: 3  value: 114.7016 mgc: 1.910527e-07 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  1.465076 
iter: 1  value: 114.0696 mgc: 2.430276 ustep: 1 
iter: 2  value: 114.0696 mgc: 0.002273871 ustep: 1 
iter: 3  mgc: 2.543841e-09 
iter: 1  value: 114.5043 mgc: 1.12938 ustep: 1 
iter: 2  value: 114.5043 mgc: 0.0003533137 ustep: 1 
iter: 3  mgc: 1.256071e-10 
iter: 1  mgc: 1.256071e-10 
outer mgc:  2.963026 
iter: 1  value: 114.2211 mgc: 0.8826111 ustep: 1 
iter: 2  value: 114.2211 mgc: 0.0002301292 ustep: 1 
iter: 3  mgc: 9.147882e-11 
iter: 1  mgc: 9.147882e-11 
outer mgc:  0.552926 
iter: 1  value: 113.9042 mgc: 0.8665886 ustep: 1 
iter: 2  value: 113.9042 mgc: 0.0003944774 ustep: 1 
iter: 3  mgc: 2.155076e-10 
iter: 1  mgc: 2.155076e-10 
outer mgc:  0.7577685 
iter: 1  value: 113.6755 mgc: 0.7769802 ustep: 1 
iter: 2  value: 113.6755 mgc: 0.0001725678 ustep: 1 
iter: 3  mgc: 8.519407e-12 
iter: 1  mgc: 8.519407e-12 
outer mgc:  0.5674444 
iter: 1  value: 113.433 mgc: 0.6159751 ustep: 1 
iter: 2  value: 113.433 mgc: 0.000197236 ustep: 1 
iter: 3  mgc: 6.275336e-11 
iter: 1  mgc: 6.275336e-11 
outer mgc:  0.3131497 
iter: 1  value: 113.2204 mgc: 0.5836223 ustep: 1 
iter: 2  value: 113.2204 mgc: 8.099136e-05 ustep: 1 
iter: 3  mgc: 1.431744e-12 
iter: 1  value: 112.5918 mgc: 1.81894 ustep: 1 
iter: 2  value: 112.5918 mgc: 0.0006091133 ustep: 1 
iter: 3  mgc: 5.237233e-11 
iter: 1  mgc: 5.237233e-11 
outer mgc:  0.2135912 
iter: 1  value: 111.5298 mgc: 2.910866 ustep: 1 
iter: 2  value: 111.5298 mgc: 0.001041928 ustep: 1 
iter: 3  mgc: 1.298881e-10 
iter: 1  mgc: 1.298881e-10 
outer mgc:  0.1706735 
iter: 1  value: 110.6284 mgc: 2.24903 ustep: 1 
iter: 2  value: 110.6284 mgc: 0.0004108602 ustep: 1 
iter: 3  mgc: 3.297629e-11 
iter: 1  mgc: 3.297629e-11 
outer mgc:  0.06746118 
iter: 1  value: 109.7833 mgc: 2.131929 ustep: 1 
iter: 2  value: 109.7833 mgc: 0.0002666933 ustep: 1 
iter: 3  mgc: 1.045475e-11 
iter: 1  mgc: 1.045475e-11 
outer mgc:  0.01844911 
iter: 1  value: 108.958 mgc: 2.203782 ustep: 1 
iter: 2  value: 108.958 mgc: 0.0002134567 ustep: 1 
iter: 3  mgc: 2.921219e-12 
iter: 1  mgc: 2.921219e-12 
outer mgc:  0.02747435 
iter: 1  value: 108.2084 mgc: 2.06364 ustep: 1 
iter: 2  value: 108.2084 mgc: 0.0001400136 ustep: 1 
iter: 3  mgc: 6.590284e-13 
iter: 1  mgc: 6.590284e-13 
outer mgc:  0.01331999 
iter: 1  value: 107.6304 mgc: 1.573027 ustep: 1 
iter: 2  value: 107.6304 mgc: 6.459231e-05 ustep: 1 
iter: 3  mgc: 1.101341e-13 
iter: 1  mgc: 1.101341e-13 
outer mgc:  0.005742763 
iter: 1  value: 107.2679 mgc: 0.9477429 ustep: 1 
iter: 2  value: 107.2679 mgc: 2.026758e-05 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.00362038 
iter: 1  value: 107.094 mgc: 0.4344214 ustep: 1 
iter: 2  value: 107.094 mgc: 3.943783e-06 ustep: 1 
iter: 3  mgc: 4.13003e-14 
iter: 1  mgc: 4.13003e-14 
outer mgc:  0.001597414 
iter: 1  value: 107.0453 mgc: 0.1165863 ustep: 1 
iter: 2  value: 107.0453 mgc: 2.740297e-07 ustep: 1 
mgc: 3.352874e-14 
iter: 1  mgc: 3.352874e-14 
outer mgc:  0.0004301535 
iter: 1  value: 107.0404 mgc: 0.01114654 ustep: 1 
iter: 2  mgc: 2.308839e-09 
iter: 1  mgc: 2.308839e-09 
outer mgc:  7.462528e-05 
iter: 1  mgc: 2.308839e-09 
iter: 1  mgc: 2.308839e-09 
outer mgc:  7.462528e-05 
iter: 1  value: 107.0411 mgc: 0.03700213 ustep: 1 
iter: 2  value: 107.0411 mgc: 3.915668e-08 ustep: 1 
mgc: 2.04281e-14 
outer mgc:  0.2996769 
iter: 1  value: 107.04 mgc: 0.03697915 ustep: 1 
iter: 2  value: 107.04 mgc: 3.907181e-08 ustep: 1 
mgc: 4.740652e-14 
outer mgc:  0.2994104 
iter: 1  value: 107.0407 mgc: 0.01775828 ustep: 1 
iter: 2  mgc: 9.60151e-09 
outer mgc:  0.1542942 
iter: 1  value: 107.0402 mgc: 0.01774754 ustep: 1 
iter: 2  mgc: 9.583763e-09 
outer mgc:  0.1541202 
iter: 1  value: 107.0402 mgc: 0.05638904 ustep: 1 
iter: 2  value: 107.0402 mgc: 2.654276e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.1878825 
iter: 1  value: 107.0407 mgc: 0.05637521 ustep: 1 
iter: 2  value: 107.0407 mgc: 2.655004e-06 ustep: 1 
iter: 3  mgc: 4.196643e-14 
outer mgc:  0.1878357 
iter: 1  value: 107.0402 mgc: 0.0274847 ustep: 1 
iter: 2  value: 107.0402 mgc: 7.073577e-07 ustep: 1 
iter: 3  mgc: 3.708145e-14 
outer mgc:  0.166814 
iter: 1  value: 107.0407 mgc: 0.02748097 ustep: 1 
iter: 2  value: 107.0407 mgc: 7.07472e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.1666542 
iter: 1  value: 107.0383 mgc: 0.004815486 ustep: 1 
iter: 2  mgc: 4.652545e-10 
outer mgc:  0.0001155871 
iter: 1  value: 107.0425 mgc: 0.004814351 ustep: 1 
iter: 2  mgc: 4.658034e-10 
outer mgc:  0.0001286403 
iter: 1  value: 107.0498 mgc: 0.1653661 ustep: 1 
iter: 2  value: 107.0498 mgc: 5.70627e-07 ustep: 1 
mgc: 3.841372e-14 
outer mgc:  0.006611122 
iter: 1  value: 107.0309 mgc: 0.1658666 ustep: 1 
iter: 2  value: 107.0309 mgc: 5.697198e-07 ustep: 1 
mgc: 4.196643e-14 
outer mgc:  0.006666953 
iter: 1  value: 107.0428 mgc: 0.1692458 ustep: 1 
iter: 2  value: 107.0428 mgc: 4.893289e-07 ustep: 1 
iter: 3  mgc: 3.441691e-14 
outer mgc:  0.01820254 
iter: 1  value: 107.0379 mgc: 0.1694151 ustep: 1 
iter: 2  value: 107.0379 mgc: 4.887294e-07 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.0181946 
[Sun Aug 15 23:04:44 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:16:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21883.258178 
final  value 20055.638198 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 7804.972 mgc: 134.9501 ustep: 1 
iter: 2  value: 5985.332 mgc: 97.46745 ustep: 0.2494656 
iter: 3  value: 4436.059 mgc: 155.371 ustep: 0.08285847 
iter: 4  value: 3023.121 mgc: 187.7503 ustep: 0.08137205 
iter: 5  value: 2632.934 mgc: 119.7004 ustep: 0.1546026 
iter: 6  value: 2486.525 mgc: 134.3293 ustep: 0.1174012 
iter: 7  value: 2373.569 mgc: 109.5629 ustep: 0.3427044 
iter: 8  value: 2352.503 mgc: 40.47786 ustep: 0.5854511 
iter: 9  value: 2349.195 mgc: 18.38034 ustep: 0.7651712 
iter: 10  value: 2349.188 mgc: 0.753732 ustep: 0.8747532 
iter: 11  value: 2349.188 mgc: 0.0036062 ustep: 0.9352889 
iter: 12  value: 2349.188 mgc: 5.67343e-06 ustep: 0.9671066 
iter: 13  mgc: 5.050941e-09 
iter: 1  mgc: 5.050941e-09 
Matching hessian patterns... Done
outer mgc:  108.972 
iter: 1  value: 2353.272 mgc: 22.70543 ustep: 1 
iter: 2  value: 2344.467 mgc: 3.263333 ustep: 1 
iter: 3  value: 2344.46 mgc: 0.09560008 ustep: 1 
iter: 4  value: 2344.46 mgc: 0.0001295326 ustep: 1 
iter: 5  mgc: 5.450008e-10 
iter: 1  mgc: 5.450008e-10 
outer mgc:  365.4604 
iter: 1  value: 2286.399 mgc: 19.91765 ustep: 1 
iter: 2  value: 2285.868 mgc: 1.448029 ustep: 1 
iter: 3  value: 2285.868 mgc: 0.01413159 ustep: 1 
iter: 4  value: 2285.868 mgc: 2.2753e-06 ustep: 1 
iter: 5  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  213.3209 
iter: 1  value: 2240.639 mgc: 6.697048 ustep: 1 
iter: 2  value: 2240.633 mgc: 0.1381823 ustep: 1 
iter: 3  value: 2240.633 mgc: 0.0001905695 ustep: 1 
iter: 4  mgc: 3.65209e-10 
iter: 1  mgc: 3.65209e-10 
outer mgc:  161.2356 
iter: 1  value: 2194.552 mgc: 26.27819 ustep: 1 
iter: 2  value: 2187.836 mgc: 3.309856 ustep: 1 
iter: 3  value: 2187.831 mgc: 0.1020383 ustep: 1 
iter: 4  value: 2187.831 mgc: 0.000210773 ustep: 1 
iter: 5  mgc: 9.044712e-10 
iter: 1  mgc: 9.044712e-10 
outer mgc:  73.94559 
iter: 1  value: 2169.161 mgc: 7.445707 ustep: 1 
iter: 2  value: 2169.026 mgc: 0.390157 ustep: 1 
iter: 3  value: 2169.026 mgc: 0.006829005 ustep: 1 
iter: 4  value: 2169.026 mgc: 2.478686e-06 ustep: 1 
iter: 5  mgc: 3.272937e-13 
iter: 1  mgc: 3.272937e-13 
outer mgc:  159.3665 
iter: 1  value: 2143.709 mgc: 10.24735 ustep: 1 
iter: 2  value: 2143.275 mgc: 0.7973597 ustep: 1 
iter: 3  value: 2143.275 mgc: 0.02043441 ustep: 1 
iter: 4  value: 2143.275 mgc: 1.428642e-05 ustep: 1 
iter: 5  mgc: 6.996181e-12 
iter: 1  mgc: 6.996181e-12 
outer mgc:  95.99476 
iter: 1  value: 2125.925 mgc: 14.27821 ustep: 1 
iter: 2  value: 2125.085 mgc: 1.234417 ustep: 1 
iter: 3  value: 2125.085 mgc: 0.01387552 ustep: 1 
iter: 4  value: 2125.085 mgc: 1.83776e-06 ustep: 1 
iter: 5  mgc: 4.17999e-14 
iter: 1  mgc: 4.17999e-14 
outer mgc:  31.07494 
iter: 1  value: 2119.433 mgc: 16.10519 ustep: 1 
iter: 2  value: 2119.25 mgc: 0.5879782 ustep: 1 
iter: 3  value: 2119.25 mgc: 0.001932271 ustep: 1 
iter: 4  value: 2119.25 mgc: 2.394663e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  65.20371 
iter: 1  value: 2115.647 mgc: 6.358134 ustep: 1 
iter: 2  value: 2115.63 mgc: 0.2997993 ustep: 1 
iter: 3  value: 2115.63 mgc: 0.0008922992 ustep: 1 
iter: 4  value: 2115.63 mgc: 1.362169e-08 ustep: 1 
mgc: 2.675637e-14 
iter: 1  mgc: 2.675637e-14 
outer mgc:  108.5434 
iter: 1  value: 2113.503 mgc: 14.5264 ustep: 1 
iter: 2  value: 2113.297 mgc: 0.5817496 ustep: 1 
iter: 3  value: 2113.297 mgc: 0.002709423 ustep: 1 
iter: 4  value: 2113.297 mgc: 7.940323e-08 ustep: 1 
iter: 5  mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  124.9153 
iter: 1  value: 2109.715 mgc: 4.812936 ustep: 1 
iter: 2  value: 2109.711 mgc: 0.1062455 ustep: 1 
iter: 3  value: 2109.711 mgc: 0.0001760704 ustep: 1 
iter: 4  mgc: 5.231238e-10 
iter: 1  mgc: 5.231238e-10 
outer mgc:  42.10542 
iter: 1  value: 2107.474 mgc: 3.746235 ustep: 1 
iter: 2  value: 2107.47 mgc: 0.08052966 ustep: 1 
iter: 3  value: 2107.47 mgc: 0.0001266872 ustep: 1 
iter: 4  mgc: 5.965211e-10 
iter: 1  mgc: 5.965211e-10 
outer mgc:  18.83686 
iter: 1  value: 2108.987 mgc: 3.364192 ustep: 1 
iter: 2  value: 2108.985 mgc: 0.08673204 ustep: 1 
iter: 3  value: 2108.985 mgc: 0.000114667 ustep: 1 
iter: 4  mgc: 2.021361e-10 
iter: 1  value: 2106.889 mgc: 0.8684442 ustep: 1 
iter: 2  value: 2106.889 mgc: 0.003603899 ustep: 1 
iter: 3  value: 2106.889 mgc: 1.2153e-07 ustep: 1 
iter: 4  mgc: 3.437528e-14 
iter: 1  mgc: 3.437528e-14 
outer mgc:  26.51574 
iter: 1  value: 2106.537 mgc: 1.795843 ustep: 1 
iter: 2  value: 2106.537 mgc: 0.009417364 ustep: 1 
iter: 3  value: 2106.537 mgc: 5.025523e-07 ustep: 1 
iter: 4  mgc: 3.771983e-14 
iter: 1  mgc: 3.771983e-14 
outer mgc:  30.52913 
iter: 1  value: 2105.916 mgc: 1.532094 ustep: 1 
iter: 2  value: 2105.916 mgc: 0.006958451 ustep: 1 
iter: 3  value: 2105.916 mgc: 5.495364e-07 ustep: 1 
iter: 4  mgc: 4.388503e-14 
iter: 1  mgc: 4.388503e-14 
outer mgc:  4.727292 
iter: 1  value: 2105.976 mgc: 1.130165 ustep: 1 
iter: 2  value: 2105.976 mgc: 0.004042302 ustep: 1 
iter: 3  value: 2105.976 mgc: 1.46842e-07 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  1.767337 
iter: 1  value: 2106.152 mgc: 0.4083115 ustep: 1 
iter: 2  value: 2106.152 mgc: 0.001266882 ustep: 1 
iter: 3  value: 2106.152 mgc: 1.998131e-08 ustep: 1 
mgc: 3.345935e-14 
iter: 1  value: 2105.973 mgc: 0.2018407 ustep: 1 
iter: 2  value: 2105.973 mgc: 0.0002197207 ustep: 1 
iter: 3  mgc: 3.220926e-10 
iter: 1  mgc: 3.220926e-10 
outer mgc:  3.475799 
iter: 1  value: 2105.971 mgc: 0.4771213 ustep: 1 
iter: 2  value: 2105.971 mgc: 0.0006761913 ustep: 1 
iter: 3  mgc: 4.687942e-09 
iter: 1  mgc: 4.687942e-09 
outer mgc:  1.997021 
iter: 1  value: 2105.977 mgc: 0.3685684 ustep: 1 
iter: 2  value: 2105.977 mgc: 0.0003198759 ustep: 1 
iter: 3  mgc: 7.78944e-10 
iter: 1  mgc: 7.78944e-10 
outer mgc:  1.003132 
iter: 1  value: 2105.98 mgc: 0.1723444 ustep: 1 
iter: 2  value: 2105.98 mgc: 7.815434e-05 ustep: 1 
iter: 3  mgc: 1.534763e-10 
iter: 1  value: 2105.972 mgc: 0.02248203 ustep: 1 
iter: 2  value: 2105.972 mgc: 1.3304e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.4953972 
iter: 1  value: 2105.962 mgc: 0.06327099 ustep: 1 
iter: 2  value: 2105.962 mgc: 1.144763e-05 ustep: 1 
iter: 3  mgc: 1.190603e-12 
iter: 1  mgc: 1.190603e-12 
outer mgc:  0.5087152 
iter: 1  value: 2105.937 mgc: 0.0552172 ustep: 1 
iter: 2  value: 2105.937 mgc: 2.057103e-05 ustep: 1 
iter: 3  mgc: 1.528999e-11 
iter: 1  mgc: 1.528999e-11 
outer mgc:  0.3448167 
iter: 1  value: 2105.929 mgc: 0.08856589 ustep: 1 
iter: 2  value: 2105.929 mgc: 3.0075e-05 ustep: 1 
iter: 3  mgc: 7.255307e-12 
iter: 1  mgc: 7.255307e-12 
outer mgc:  0.2560187 
iter: 1  value: 2105.934 mgc: 0.08348367 ustep: 1 
iter: 2  value: 2105.934 mgc: 2.368949e-05 ustep: 1 
iter: 3  mgc: 4.652279e-12 
iter: 1  value: 2105.93 mgc: 0.02006372 ustep: 1 
iter: 2  value: 2105.93 mgc: 1.36841e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  0.2813635 
iter: 1  value: 2105.934 mgc: 0.01207656 ustep: 1 
iter: 2  value: 2105.934 mgc: 4.375909e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  0.1767439 
iter: 1  value: 2105.946 mgc: 0.0221848 ustep: 1 
iter: 2  value: 2105.946 mgc: 3.657985e-06 ustep: 1 
iter: 3  mgc: 1.048051e-13 
iter: 1  value: 2105.939 mgc: 0.01451805 ustep: 1 
iter: 2  value: 2105.939 mgc: 1.135884e-06 ustep: 1 
iter: 3  mgc: 5.329071e-14 
iter: 1  mgc: 5.329071e-14 
outer mgc:  0.1584821 
iter: 1  value: 2105.934 mgc: 0.006321569 ustep: 1 
iter: 2  value: 2105.934 mgc: 2.32891e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.05872513 
iter: 1  value: 2105.936 mgc: 0.01588891 ustep: 1 
iter: 2  value: 2105.936 mgc: 9.921529e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.1711696 
iter: 1  value: 2105.936 mgc: 0.008251532 ustep: 1 
iter: 2  value: 2105.936 mgc: 3.006701e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.05604937 
iter: 1  value: 2105.935 mgc: 0.01445129 ustep: 1 
iter: 2  value: 2105.935 mgc: 6.271738e-07 ustep: 1 
iter: 3  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  0.1233069 
iter: 1  value: 2105.938 mgc: 0.002595698 ustep: 1 
iter: 2  value: 2105.938 mgc: 6.339475e-08 ustep: 1 
mgc: 3.674838e-14 
iter: 1  mgc: 3.674838e-14 
outer mgc:  0.02591714 
iter: 1  value: 2105.935 mgc: 0.009365656 ustep: 1 
iter: 2  value: 2105.935 mgc: 2.971882e-07 ustep: 1 
iter: 3  mgc: 3.432671e-14 
iter: 1  value: 2105.937 mgc: 0.004153517 ustep: 1 
iter: 2  value: 2105.937 mgc: 5.908845e-08 ustep: 1 
iter: 3  mgc: 4.868328e-14 
iter: 1  mgc: 4.868328e-14 
outer mgc:  0.01356867 
iter: 1  value: 2105.936 mgc: 0.0007010121 ustep: 1 
iter: 2  mgc: 8.114167e-09 
iter: 1  value: 2105.936 mgc: 0.0006619793 ustep: 1 
iter: 2  mgc: 1.65315e-09 
iter: 1  mgc: 1.65315e-09 
outer mgc:  0.01639034 
iter: 1  value: 2105.936 mgc: 0.001021261 ustep: 1 
iter: 2  mgc: 4.852369e-09 
iter: 1  mgc: 4.852369e-09 
outer mgc:  0.004206632 
iter: 1  value: 2105.936 mgc: 0.0002922966 ustep: 1 
iter: 2  mgc: 5.277885e-10 
iter: 1  mgc: 5.277885e-10 
outer mgc:  0.001657094 
iter: 1  mgc: 5.277885e-10 
iter: 1  mgc: 5.277885e-10 
outer mgc:  0.001657094 
iter: 1  value: 2105.934 mgc: 0.05233185 ustep: 1 
iter: 2  value: 2105.934 mgc: 1.01548e-05 ustep: 1 
iter: 3  mgc: 7.707168e-13 
outer mgc:  0.2119994 
iter: 1  value: 2105.938 mgc: 0.05231694 ustep: 1 
iter: 2  value: 2105.938 mgc: 1.016596e-05 ustep: 1 
iter: 3  mgc: 7.752687e-13 
outer mgc:  0.2115725 
iter: 1  value: 2105.935 mgc: 0.02892729 ustep: 1 
iter: 2  value: 2105.935 mgc: 2.651201e-06 ustep: 1 
iter: 3  mgc: 7.127632e-14 
outer mgc:  0.74178 
iter: 1  value: 2105.938 mgc: 0.02892584 ustep: 1 
iter: 2  value: 2105.938 mgc: 2.650709e-06 ustep: 1 
iter: 3  mgc: 7.044365e-14 
outer mgc:  0.745027 
iter: 1  value: 2105.938 mgc: 0.05871754 ustep: 1 
iter: 2  value: 2105.938 mgc: 9.107085e-06 ustep: 1 
iter: 3  mgc: 4.272138e-13 
outer mgc:  0.3610535 
iter: 1  value: 2105.934 mgc: 0.05871196 ustep: 1 
iter: 2  value: 2105.934 mgc: 9.093797e-06 ustep: 1 
iter: 3  mgc: 4.423129e-13 
outer mgc:  0.3604448 
iter: 1  value: 2105.938 mgc: 0.02920308 ustep: 1 
iter: 2  value: 2105.938 mgc: 2.288847e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  1.254144 
iter: 1  value: 2105.936 mgc: 0.0292019 ustep: 1 
iter: 2  value: 2105.936 mgc: 2.288097e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  1.254005 
iter: 1  value: 2105.936 mgc: 0.005189779 ustep: 1 
iter: 2  value: 2105.936 mgc: 3.912574e-07 ustep: 1 
iter: 3  mgc: 3.774758e-14 
outer mgc:  0.08088529 
iter: 1  value: 2105.936 mgc: 0.005190823 ustep: 1 
iter: 2  value: 2105.936 mgc: 3.918382e-07 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.08029774 
iter: 1  value: 2105.948 mgc: 0.008994746 ustep: 1 
iter: 2  value: 2105.948 mgc: 1.849615e-06 ustep: 1 
iter: 3  mgc: 1.24345e-13 
outer mgc:  0.1563714 
iter: 1  value: 2105.924 mgc: 0.009013172 ustep: 1 
iter: 2  value: 2105.924 mgc: 1.854e-06 ustep: 1 
iter: 3  mgc: 1.252332e-13 
outer mgc:  0.156782 
iter: 1  value: 2105.947 mgc: 0.01155507 ustep: 1 
iter: 2  value: 2105.947 mgc: 1.501104e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.1628731 
iter: 1  value: 2105.926 mgc: 0.01157859 ustep: 1 
iter: 2  value: 2105.926 mgc: 1.505658e-06 ustep: 1 
iter: 3  mgc: 4.618528e-14 
outer mgc:  0.1633545 
[Fri Aug 13 12:16:50 2021]
Finished job 0.
1 of 1 steps (100%) done

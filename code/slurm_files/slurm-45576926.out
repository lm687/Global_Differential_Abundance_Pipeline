Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 07:41:08 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2123.617554 
iter  10 value 1027.530486
final  value 1026.871982 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1254.306 mgc: 1.175594 ustep: 1 
iter: 2  value: 1252.705 mgc: 1.318014 ustep: 1 
iter: 3  value: 1252.702 mgc: 0.08994632 ustep: 1 
iter: 4  value: 1252.702 mgc: 0.0004010952 ustep: 1 
iter: 5  value: 1252.702 mgc: 5.050753e-08 ustep: 1 
iter: 6  mgc: 8.604228e-16 
iter: 1  mgc: 8.604228e-16 
Matching hessian patterns... Done
outer mgc:  97.96515 
iter: 1  value: 1190.904 mgc: 0.4488748 ustep: 1 
iter: 2  value: 1190.885 mgc: 0.06637903 ustep: 1 
iter: 3  value: 1190.885 mgc: 0.006534644 ustep: 1 
iter: 4  value: 1190.885 mgc: 5.188852e-05 ustep: 1 
iter: 5  mgc: 3.594336e-09 
iter: 1  mgc: 3.594336e-09 
outer mgc:  34.69174 
iter: 1  value: 1166.729 mgc: 0.4483423 ustep: 1 
iter: 2  value: 1166.729 mgc: 0.01975344 ustep: 1 
iter: 3  value: 1166.729 mgc: 7.278836e-05 ustep: 1 
iter: 4  mgc: 2.652037e-09 
iter: 1  value: 1153.927 mgc: 1.46325 ustep: 1 
iter: 2  value: 1153.917 mgc: 0.04237265 ustep: 1 
iter: 3  value: 1153.917 mgc: 0.0005323456 ustep: 1 
iter: 4  value: 1153.917 mgc: 8.432553e-08 ustep: 1 
iter: 5  mgc: 1.554312e-15 
iter: 1  mgc: 1.554312e-15 
outer mgc:  19.62037 
iter: 1  value: 1128.728 mgc: 1.951926 ustep: 1 
iter: 2  value: 1128.728 mgc: 0.01853587 ustep: 1 
iter: 3  value: 1128.728 mgc: 1.817699e-06 ustep: 1 
iter: 4  mgc: 5.159206e-13 
iter: 1  mgc: 5.159206e-13 
outer mgc:  10.00003 
iter: 1  value: 1103.308 mgc: 0.2604138 ustep: 1 
iter: 2  value: 1103.307 mgc: 0.00758615 ustep: 1 
iter: 3  value: 1103.307 mgc: 5.013083e-06 ustep: 1 
iter: 4  mgc: 2.283895e-12 
iter: 1  mgc: 2.283895e-12 
outer mgc:  10.01264 
iter: 1  value: 1051.294 mgc: 2.433029 ustep: 1 
iter: 2  value: 1051.294 mgc: 0.002869671 ustep: 1 
iter: 3  value: 1051.294 mgc: 1.675791e-07 ustep: 1 
iter: 4  mgc: 1.332268e-15 
iter: 1  value: 978.7648 mgc: 21.91483 ustep: 1 
iter: 2  value: 978.7648 mgc: 0.0002523588 ustep: 1 
iter: 3  mgc: 2.166045e-13 
iter: 1  mgc: 2.166045e-13 
outer mgc:  12.45086 
iter: 1  value: 1069.664 mgc: 3247.817 ustep: 1 
iter: 2  value: 1069.664 mgc: 5.826749e-05 ustep: 1 
iter: 3  mgc: 1.061373e-13 
iter: 1  value: 967.0958 mgc: 12.75032 ustep: 1 
iter: 2  value: 967.0958 mgc: 3.070113e-05 ustep: 1 
iter: 3  mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  17.80291 
iter: 1  value: 934.6423 mgc: 11.40412 ustep: 1 
iter: 2  value: 934.6423 mgc: 9.308653e-05 ustep: 1 
iter: 3  mgc: 3.352874e-13 
iter: 1  value: 1042.138 mgc: 234.322 ustep: 1 
iter: 2  value: 1042.138 mgc: 0.03279303 ustep: 1 
iter: 3  value: 1042.138 mgc: 2.679741e-06 ustep: 1 
iter: 4  mgc: 1.820766e-13 
iter: 1  mgc: 3.352874e-13 
outer mgc:  6.885113 
iter: 1  value: 991.6175 mgc: 27.95461 ustep: 1 
iter: 2  value: 991.6175 mgc: 0.006924104 ustep: 1 
iter: 3  mgc: 3.989663e-09 
iter: 1  value: 928.1404 mgc: 1.360328 ustep: 1 
iter: 2  value: 928.1404 mgc: 0.0002386242 ustep: 1 
iter: 3  mgc: 1.459138e-12 
iter: 1  mgc: 1.459138e-12 
outer mgc:  11.24437 
iter: 1  value: 921.6549 mgc: 4.123044 ustep: 1 
iter: 2  value: 921.6549 mgc: 0.0003141238 ustep: 1 
iter: 3  mgc: 4.81637e-12 
iter: 1  mgc: 4.81637e-12 
outer mgc:  3.370409 
iter: 1  value: 918.9118 mgc: 11.73104 ustep: 1 
iter: 2  value: 918.9118 mgc: 0.000192485 ustep: 1 
iter: 3  mgc: 5.691891e-12 
iter: 1  mgc: 5.691891e-12 
outer mgc:  1.846277 
iter: 1  value: 919.2888 mgc: 5.808099 ustep: 1 
iter: 2  value: 919.2888 mgc: 0.0001901795 ustep: 1 
iter: 3  mgc: 7.59659e-12 
iter: 1  mgc: 7.59659e-12 
outer mgc:  1.002756 
iter: 1  value: 920.9632 mgc: 2.587913 ustep: 1 
iter: 2  value: 920.9632 mgc: 0.0001336552 ustep: 1 
iter: 3  mgc: 1.826095e-12 
iter: 1  mgc: 1.826095e-12 
outer mgc:  0.7879726 
iter: 1  value: 922.4483 mgc: 3.018233 ustep: 1 
iter: 2  value: 922.4483 mgc: 0.0003295643 ustep: 1 
iter: 3  mgc: 4.492007e-11 
iter: 1  mgc: 4.492007e-11 
outer mgc:  0.3064444 
iter: 1  value: 924.118 mgc: 4.288846 ustep: 1 
iter: 2  value: 924.118 mgc: 0.0005943223 ustep: 1 
iter: 3  mgc: 2.519611e-10 
iter: 1  value: 926.7037 mgc: 6.644728 ustep: 1 
iter: 2  value: 926.7037 mgc: 0.002702089 ustep: 1 
iter: 3  value: 926.7037 mgc: 1.116979e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.3848231 
iter: 1  value: 941.358 mgc: 12.68163 ustep: 1 
iter: 2  value: 941.3196 mgc: 0.5879738 ustep: 1 
iter: 3  value: 941.3196 mgc: 0.003741934 ustep: 1 
iter: 4  value: 941.3196 mgc: 8.620454e-08 ustep: 1 
iter: 5  mgc: 2.93654e-14 
iter: 1  value: 929.2921 mgc: 8.701177 ustep: 1 
iter: 2  value: 929.2921 mgc: 0.006071571 ustep: 1 
iter: 3  value: 929.2921 mgc: 1.162352e-07 ustep: 1 
mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  0.3645537 
iter: 1  value: 934.009 mgc: 14.68673 ustep: 1 
iter: 2  value: 934.0089 mgc: 0.05107668 ustep: 1 
iter: 3  value: 934.0089 mgc: 2.229002e-05 ustep: 1 
iter: 4  mgc: 2.845946e-12 
iter: 1  mgc: 2.845946e-12 
outer mgc:  0.7352404 
iter: 1  value: 935.5249 mgc: 21.25844 ustep: 1 
iter: 2  value: 935.5247 mgc: 0.08043816 ustep: 1 
iter: 3  value: 935.5247 mgc: 3.550206e-05 ustep: 1 
iter: 4  mgc: 1.306066e-11 
iter: 1  value: 933.9345 mgc: 4.046295 ustep: 1 
iter: 2  value: 933.9345 mgc: 0.0005420492 ustep: 1 
iter: 3  mgc: 1.036893e-10 
iter: 1  mgc: 1.036893e-10 
outer mgc:  0.5800822 
iter: 1  value: 934.409 mgc: 3.457996 ustep: 1 
iter: 2  value: 934.409 mgc: 0.0007386905 ustep: 1 
iter: 3  mgc: 6.349444e-10 
iter: 1  mgc: 6.349444e-10 
outer mgc:  0.2381113 
iter: 1  value: 934.9459 mgc: 3.41807 ustep: 1 
iter: 2  value: 934.9459 mgc: 0.000675197 ustep: 1 
iter: 3  mgc: 4.713407e-11 
iter: 1  mgc: 4.713407e-11 
outer mgc:  0.3312133 
iter: 1  value: 936.3667 mgc: 3.872051 ustep: 1 
iter: 2  value: 936.3667 mgc: 0.003675428 ustep: 1 
iter: 3  mgc: 8.416112e-09 
iter: 1  value: 939.2897 mgc: 6.472217 ustep: 1 
iter: 2  value: 939.2897 mgc: 0.02173293 ustep: 1 
iter: 3  value: 939.2897 mgc: 2.423688e-07 ustep: 1 
iter: 4  mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  0.5459597 
iter: 1  value: 943.3544 mgc: 22.45192 ustep: 1 
iter: 2  value: 943.3542 mgc: 0.02886934 ustep: 1 
iter: 3  value: 943.3542 mgc: 3.18184e-05 ustep: 1 
iter: 4  mgc: 1.197265e-12 
iter: 1  value: 940.6735 mgc: 13.91184 ustep: 1 
iter: 2  value: 940.6735 mgc: 0.002798413 ustep: 1 
iter: 3  value: 940.6735 mgc: 3.860293e-07 ustep: 1 
iter: 4  mgc: 8.326673e-15 
iter: 1  mgc: 8.326673e-15 
outer mgc:  0.2786653 
iter: 1  value: 941.6013 mgc: 8.764947 ustep: 1 
iter: 2  value: 941.6013 mgc: 0.001885574 ustep: 1 
iter: 3  value: 941.6013 mgc: 8.771718e-08 ustep: 1 
mgc: 1.74305e-14 
iter: 1  mgc: 1.74305e-14 
outer mgc:  0.1588443 
iter: 1  value: 941.7193 mgc: 0.2641642 ustep: 1 
iter: 2  value: 941.7193 mgc: 0.000165052 ustep: 1 
iter: 3  mgc: 2.196465e-11 
iter: 1  mgc: 2.196465e-11 
outer mgc:  0.01338212 
iter: 1  value: 942.0547 mgc: 1.354866 ustep: 1 
iter: 2  value: 942.0547 mgc: 0.0001418574 ustep: 1 
iter: 3  mgc: 5.308562e-10 
iter: 1  mgc: 5.308562e-10 
outer mgc:  0.02983426 
iter: 1  value: 941.9121 mgc: 0.6647354 ustep: 1 
iter: 2  value: 941.9121 mgc: 2.838575e-05 ustep: 1 
iter: 3  mgc: 2.385692e-11 
iter: 1  mgc: 2.385692e-11 
outer mgc:  0.0135542 
iter: 1  value: 941.7613 mgc: 0.6125654 ustep: 1 
iter: 2  value: 941.7613 mgc: 2.80551e-05 ustep: 1 
iter: 3  mgc: 1.759393e-11 
iter: 1  mgc: 1.759393e-11 
outer mgc:  0.02487288 
iter: 1  value: 941.4462 mgc: 1.140615 ustep: 1 
iter: 2  value: 941.4462 mgc: 8.242541e-05 ustep: 1 
iter: 3  mgc: 1.570699e-10 
iter: 1  mgc: 1.570699e-10 
outer mgc:  0.06470586 
iter: 1  value: 941.1543 mgc: 0.7379025 ustep: 1 
iter: 2  value: 941.1543 mgc: 2.863035e-05 ustep: 1 
iter: 3  mgc: 2.086775e-11 
iter: 1  mgc: 2.086775e-11 
outer mgc:  0.07380322 
iter: 1  value: 941.0247 mgc: 0.4332976 ustep: 1 
iter: 2  value: 941.0247 mgc: 1.259804e-05 ustep: 1 
iter: 3  mgc: 1.592948e-12 
iter: 1  mgc: 1.592948e-12 
outer mgc:  0.06343956 
iter: 1  value: 941.0094 mgc: 1.246945 ustep: 1 
iter: 2  value: 941.0094 mgc: 9.308541e-05 ustep: 1 
iter: 3  mgc: 1.810565e-10 
iter: 1  mgc: 1.810565e-10 
outer mgc:  0.02083072 
iter: 1  value: 940.9567 mgc: 0.960457 ustep: 1 
iter: 2  value: 940.9567 mgc: 5.108814e-05 ustep: 1 
iter: 3  mgc: 5.4869e-11 
iter: 1  mgc: 5.4869e-11 
outer mgc:  0.005323745 
iter: 1  value: 940.7928 mgc: 0.3783854 ustep: 1 
iter: 2  value: 940.7928 mgc: 5.553128e-06 ustep: 1 
iter: 3  mgc: 4.667378e-13 
iter: 1  mgc: 4.667378e-13 
outer mgc:  0.01950979 
iter: 1  value: 940.4274 mgc: 0.2426221 ustep: 1 
iter: 2  value: 940.4274 mgc: 8.480088e-07 ustep: 1 
iter: 3  mgc: 1.554312e-14 
iter: 1  mgc: 1.554312e-14 
outer mgc:  0.01802092 
iter: 1  value: 939.6629 mgc: 0.7084548 ustep: 1 
iter: 2  value: 939.6629 mgc: 8.784967e-06 ustep: 1 
iter: 3  mgc: 3.98348e-12 
iter: 1  mgc: 3.98348e-12 
outer mgc:  0.01344496 
iter: 1  value: 938.1199 mgc: 1.554904 ustep: 1 
iter: 2  value: 938.1199 mgc: 2.143601e-05 ustep: 1 
iter: 3  mgc: 2.567724e-11 
iter: 1  mgc: 2.567724e-11 
outer mgc:  0.01146881 
iter: 1  value: 936.2038 mgc: 1.997403 ustep: 1 
iter: 2  value: 936.2038 mgc: 1.761161e-05 ustep: 1 
iter: 3  mgc: 1.585354e-11 
iter: 1  mgc: 1.585354e-11 
outer mgc:  0.01510142 
iter: 1  value: 934.6563 mgc: 1.046059 ustep: 1 
iter: 2  value: 934.6563 mgc: 1.55573e-06 ustep: 1 
iter: 3  mgc: 7.061018e-14 
iter: 1  mgc: 7.061018e-14 
outer mgc:  0.02369755 
iter: 1  value: 932.6712 mgc: 2.203494 ustep: 1 
iter: 2  value: 932.6712 mgc: 3.138868e-06 ustep: 1 
iter: 3  mgc: 2.393641e-13 
iter: 1  mgc: 2.393641e-13 
outer mgc:  0.008617109 
iter: 1  value: 931.045 mgc: 3.073581 ustep: 1 
iter: 2  value: 931.045 mgc: 6.130138e-06 ustep: 1 
iter: 3  mgc: 5.095924e-13 
iter: 1  mgc: 5.095924e-13 
outer mgc:  0.005668868 
iter: 1  value: 929.1279 mgc: 3.058829 ustep: 1 
iter: 2  value: 929.1279 mgc: 1.825627e-06 ustep: 1 
iter: 3  mgc: 1.212364e-13 
iter: 1  mgc: 1.212364e-13 
outer mgc:  0.008053408 
iter: 1  value: 927.5046 mgc: 1.691055 ustep: 1 
iter: 2  value: 927.5046 mgc: 2.62742e-07 ustep: 1 
iter: 3  mgc: 3.996803e-13 
iter: 1  mgc: 3.996803e-13 
outer mgc:  0.004495913 
iter: 1  value: 925.3635 mgc: 2.6438 ustep: 1 
iter: 2  value: 925.3635 mgc: 5.385068e-07 ustep: 1 
iter: 3  mgc: 4.605205e-13 
iter: 1  mgc: 4.605205e-13 
outer mgc:  0.006188045 
iter: 1  value: 923.5985 mgc: 2.805728 ustep: 1 
iter: 2  value: 923.5985 mgc: 2.272883e-07 ustep: 1 
iter: 3  mgc: 1.047162e-12 
iter: 1  mgc: 1.047162e-12 
outer mgc:  0.0005764279 
iter: 1  value: 921.536 mgc: 4.513079 ustep: 1 
iter: 2  value: 921.536 mgc: 4.411859e-07 ustep: 1 
iter: 3  mgc: 7.571721e-13 
iter: 1  mgc: 7.571721e-13 
outer mgc:  0.001219253 
iter: 1  value: 919.8368 mgc: 1.080226 ustep: 1 
iter: 2  mgc: 4.615891e-09 
iter: 1  mgc: 4.615891e-09 
outer mgc:  NaN 
Error in nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) : 
  NA/NaN gradient evaluation
[Sun Aug 15 07:41:10 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:55:59 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4341.715765 
final  value 4218.446836 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3980.939 mgc: 6.191931 ustep: 0.6827823 
iter: 2  value: 3976.634 mgc: 1.861798 ustep: 0.8263238 
iter: 3  value: 3975.412 mgc: 2.272697 ustep: 0.9090326 
iter: 4  value: 3975.374 mgc: 0.2992229 ustep: 0.9534367 
iter: 5  value: 3975.374 mgc: 0.01067724 ustep: 0.9764432 
iter: 6  value: 3975.374 mgc: 0.0001991083 ustep: 0.9881526 
iter: 7  value: 3975.374 mgc: 2.145735e-06 ustep: 0.9940592 
iter: 8  value: 3975.374 mgc: 1.148516e-08 ustep: 0.9970255 
iter: 9  mgc: 3.060108e-11 
iter: 1  mgc: 3.060108e-11 
Matching hessian patterns... Done
outer mgc:  25.6266 
iter: 1  value: 3932.829 mgc: 1.256228 ustep: 1 
iter: 2  value: 3932.809 mgc: 0.1221335 ustep: 1 
iter: 3  value: 3932.809 mgc: 0.0007770259 ustep: 1 
iter: 4  value: 3932.809 mgc: 4.140792e-08 ustep: 1 
iter: 5  mgc: 2.88658e-15 
iter: 1  value: 3930.707 mgc: 25.65191 ustep: 1 
iter: 2  value: 3929.845 mgc: 3.601439 ustep: 1 
iter: 3  value: 3929.845 mgc: 0.09750408 ustep: 1 
iter: 4  value: 3929.845 mgc: 7.013365e-05 ustep: 1 
iter: 5  mgc: 4.975928e-11 
iter: 1  mgc: 2.88658e-15 
outer mgc:  14.54278 
iter: 1  value: 3907.491 mgc: 11.98933 ustep: 1 
iter: 2  value: 3906.962 mgc: 1.800107 ustep: 1 
iter: 3  value: 3906.961 mgc: 0.05675421 ustep: 1 
iter: 4  value: 3906.961 mgc: 6.804412e-05 ustep: 1 
iter: 5  mgc: 9.674173e-11 
iter: 1  mgc: 9.674173e-11 
outer mgc:  52.01924 
iter: 1  value: 4004.312 mgc: 38.59318 ustep: 1 
iter: 2  value: 4003.181 mgc: 3.129008 ustep: 1 
iter: 3  value: 4003.18 mgc: 0.09535456 ustep: 1 
iter: 4  value: 4003.18 mgc: 6.747148e-05 ustep: 1 
iter: 5  mgc: 4.652279e-11 
iter: 1  value: 3884.023 mgc: 5.025676 ustep: 1 
iter: 2  value: 3884.017 mgc: 0.09025106 ustep: 1 
iter: 3  value: 3884.017 mgc: 0.0003749105 ustep: 1 
iter: 4  value: 3884.017 mgc: 1.19751e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  6.563799 
iter: 1  value: 3877.2 mgc: 3.778838 ustep: 1 
iter: 2  value: 3877.199 mgc: 0.1002404 ustep: 1 
iter: 3  value: 3877.199 mgc: 5.256679e-05 ustep: 1 
iter: 4  mgc: 2.12661e-11 
iter: 1  mgc: 2.12661e-11 
outer mgc:  9.107839 
iter: 1  value: 3877.25 mgc: 8.874457 ustep: 1 
iter: 2  value: 3877.247 mgc: 0.2559206 ustep: 1 
iter: 3  value: 3877.247 mgc: 0.0001364391 ustep: 1 
iter: 4  mgc: 5.262866e-10 
iter: 1  value: 3876.833 mgc: 3.038526 ustep: 1 
iter: 2  value: 3876.833 mgc: 0.04955225 ustep: 1 
iter: 3  value: 3876.833 mgc: 1.216575e-05 ustep: 1 
iter: 4  mgc: 6.945555e-13 
iter: 1  mgc: 6.945555e-13 
outer mgc:  7.296381 
iter: 1  value: 3875.676 mgc: 2.242066 ustep: 1 
iter: 2  value: 3875.676 mgc: 0.01328444 ustep: 1 
iter: 3  value: 3875.676 mgc: 8.294036e-07 ustep: 1 
iter: 4  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  1.077366 
iter: 1  value: 3876.555 mgc: 1.436443 ustep: 1 
iter: 2  value: 3876.555 mgc: 0.006869345 ustep: 1 
iter: 3  value: 3876.555 mgc: 2.926625e-07 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  value: 3875.53 mgc: 1.023028 ustep: 1 
iter: 2  value: 3875.53 mgc: 0.002939975 ustep: 1 
iter: 3  value: 3875.53 mgc: 5.002777e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  1.130599 
iter: 1  value: 3875.757 mgc: 0.700038 ustep: 1 
iter: 2  value: 3875.757 mgc: 0.002802798 ustep: 1 
iter: 3  value: 3875.757 mgc: 6.572086e-08 ustep: 1 
mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  2.585906 
iter: 1  value: 3875.542 mgc: 0.2850897 ustep: 1 
iter: 2  value: 3875.542 mgc: 0.0003121721 ustep: 1 
iter: 3  mgc: 1.08794e-09 
iter: 1  mgc: 1.08794e-09 
outer mgc:  0.6112296 
iter: 1  value: 3875.066 mgc: 0.3079933 ustep: 1 
iter: 2  value: 3875.066 mgc: 0.0003487997 ustep: 1 
iter: 3  mgc: 7.706125e-10 
iter: 1  mgc: 7.706125e-10 
outer mgc:  0.9921676 
iter: 1  value: 3874.845 mgc: 0.5374366 ustep: 1 
iter: 2  value: 3874.845 mgc: 0.001207201 ustep: 1 
iter: 3  value: 3874.845 mgc: 1.354648e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  value: 3874.654 mgc: 0.6754148 ustep: 1 
iter: 2  value: 3874.654 mgc: 0.001569971 ustep: 1 
iter: 3  value: 3874.654 mgc: 2.577246e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.7343159 
iter: 1  value: 3874.381 mgc: 1.029939 ustep: 1 
iter: 2  value: 3874.381 mgc: 0.002570218 ustep: 1 
iter: 3  value: 3874.381 mgc: 5.764932e-08 ustep: 1 
mgc: 6.328271e-15 
iter: 1  value: 3874.688 mgc: 0.6107707 ustep: 1 
iter: 2  value: 3874.688 mgc: 0.001294627 ustep: 1 
iter: 3  value: 3874.688 mgc: 1.012251e-08 ustep: 1 
mgc: 7.993606e-15 
iter: 1  value: 3874.784 mgc: 0.166608 ustep: 1 
iter: 2  value: 3874.784 mgc: 9.90916e-05 ustep: 1 
iter: 3  mgc: 6.0838e-11 
iter: 1  mgc: 6.0838e-11 
outer mgc:  0.5097684 
iter: 1  value: 3874.669 mgc: 0.1183724 ustep: 1 
iter: 2  value: 3874.669 mgc: 1.961958e-05 ustep: 1 
iter: 3  mgc: 7.153611e-12 
iter: 1  mgc: 7.153611e-12 
outer mgc:  0.5047922 
iter: 1  value: 3874.559 mgc: 0.1649086 ustep: 1 
iter: 2  value: 3874.559 mgc: 4.932744e-05 ustep: 1 
iter: 3  mgc: 2.603073e-11 
iter: 1  value: 3874.476 mgc: 0.1001504 ustep: 1 
iter: 2  value: 3874.476 mgc: 4.266755e-05 ustep: 1 
iter: 3  mgc: 1.253131e-11 
iter: 1  value: 3874.151 mgc: 0.4144807 ustep: 1 
iter: 2  value: 3874.151 mgc: 0.0006977693 ustep: 1 
iter: 3  mgc: 3.400617e-09 
iter: 1  value: 3873.619 mgc: 0.7779939 ustep: 1 
iter: 2  value: 3873.619 mgc: 0.002178753 ustep: 1 
iter: 3  value: 3873.619 mgc: 3.733362e-08 ustep: 1 
mgc: 6.328271e-15 
iter: 1  mgc: 6.328271e-15 
outer mgc:  1.073612 
iter: 1  value: 3872.379 mgc: 1.383484 ustep: 1 
iter: 2  value: 3872.379 mgc: 0.01178616 ustep: 1 
iter: 3  value: 3872.379 mgc: 1.238548e-06 ustep: 1 
iter: 4  mgc: 1.063594e-13 
iter: 1  mgc: 1.063594e-13 
outer mgc:  1.304123 
iter: 1  value: 3869.479 mgc: 2.567871 ustep: 1 
iter: 2  value: 3869.479 mgc: 0.007425537 ustep: 1 
iter: 3  value: 3869.479 mgc: 1.215679e-06 ustep: 1 
iter: 4  mgc: 9.148238e-14 
iter: 1  mgc: 9.148238e-14 
outer mgc:  1.739878 
iter: 1  value: 3867.629 mgc: 2.028933 ustep: 1 
iter: 2  value: 3867.629 mgc: 0.006970747 ustep: 1 
iter: 3  value: 3867.629 mgc: 1.898951e-07 ustep: 1 
iter: 4  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  1.619231 
iter: 1  value: 3866.291 mgc: 2.336678 ustep: 1 
iter: 2  value: 3866.291 mgc: 0.004342267 ustep: 1 
iter: 3  value: 3866.291 mgc: 5.262735e-08 ustep: 1 
mgc: 1.121325e-14 
iter: 1  mgc: 1.121325e-14 
outer mgc:  1.544215 
iter: 1  value: 3865.91 mgc: 1.164205 ustep: 1 
iter: 2  value: 3865.91 mgc: 0.00213495 ustep: 1 
iter: 3  value: 3865.91 mgc: 2.105975e-07 ustep: 1 
iter: 4  mgc: 1.976197e-14 
iter: 1  mgc: 1.976197e-14 
outer mgc:  2.233407 
iter: 1  value: 3864.73 mgc: 0.8171361 ustep: 1 
iter: 2  value: 3864.73 mgc: 0.0003596483 ustep: 1 
iter: 3  mgc: 9.124468e-10 
iter: 1  mgc: 9.124468e-10 
outer mgc:  0.9664982 
iter: 1  value: 3862.775 mgc: 1.402965 ustep: 1 
iter: 2  value: 3862.775 mgc: 0.001004767 ustep: 1 
iter: 3  mgc: 9.545484e-09 
iter: 1  mgc: 9.545484e-09 
outer mgc:  0.4518621 
iter: 1  value: 3861.568 mgc: 0.938796 ustep: 1 
iter: 2  value: 3861.568 mgc: 0.0002746477 ustep: 1 
iter: 3  mgc: 2.771126e-10 
iter: 1  value: 3860.125 mgc: 1.183597 ustep: 1 
iter: 2  value: 3860.125 mgc: 0.0003430833 ustep: 1 
iter: 3  mgc: 3.827729e-10 
iter: 1  mgc: 3.827729e-10 
outer mgc:  0.5163484 
iter: 1  value: 3857.729 mgc: 1.784648 ustep: 1 
iter: 2  value: 3857.729 mgc: 0.0003985376 ustep: 1 
iter: 3  mgc: 5.956506e-10 
iter: 1  mgc: 5.956506e-10 
outer mgc:  0.4022789 
iter: 1  value: 3853.839 mgc: 3.094239 ustep: 1 
iter: 2  value: 3853.839 mgc: 0.0006291774 ustep: 1 
iter: 3  mgc: 1.012467e-09 
iter: 1  mgc: 1.012467e-09 
outer mgc:  0.02853206 
iter: 1  value: 3850.495 mgc: 2.523528 ustep: 1 
iter: 2  value: 3850.495 mgc: 0.0001997221 ustep: 1 
iter: 3  mgc: 9.960388e-11 
iter: 1  mgc: 9.960388e-11 
outer mgc:  0.05390638 
iter: 1  value: 3846.616 mgc: 2.809122 ustep: 1 
iter: 2  value: 3846.616 mgc: 0.000109457 ustep: 1 
iter: 3  mgc: 2.824851e-11 
iter: 1  mgc: 2.824851e-11 
outer mgc:  0.01776624 
iter: 1  value: 3843.354 mgc: 2.312601 ustep: 1 
iter: 2  value: 3843.354 mgc: 3.755879e-05 ustep: 1 
iter: 3  mgc: 3.170797e-12 
iter: 1  mgc: 3.170797e-12 
outer mgc:  0.01193905 
iter: 1  value: 3839.26 mgc: 3.026531 ustep: 1 
iter: 2  value: 3839.26 mgc: 2.992487e-05 ustep: 1 
iter: 3  mgc: 1.826983e-12 
iter: 1  mgc: 1.826983e-12 
outer mgc:  0.01109437 
iter: 1  value: 3835.861 mgc: 2.486314 ustep: 1 
iter: 2  value: 3835.861 mgc: 1.023674e-05 ustep: 1 
iter: 3  mgc: 2.466916e-13 
iter: 1  mgc: 2.466916e-13 
outer mgc:  0.006362558 
iter: 1  value: 3831.735 mgc: 3.101901 ustep: 1 
iter: 2  value: 3831.735 mgc: 7.161941e-06 ustep: 1 
iter: 3  mgc: 2.311484e-13 
iter: 1  mgc: 2.311484e-13 
outer mgc:  0.004474165 
iter: 1  value: 3828.312 mgc: 2.491204 ustep: 1 
iter: 2  value: 3828.312 mgc: 2.262129e-06 ustep: 1 
iter: 3  mgc: 3.446132e-13 
iter: 1  mgc: 3.446132e-13 
outer mgc:  0.003071499 
iter: 1  value: 3824.145 mgc: 3.10827 ustep: 1 
iter: 2  value: 3824.145 mgc: 1.553546e-06 ustep: 1 
iter: 3  mgc: 4.916068e-13 
iter: 1  mgc: 4.916068e-13 
outer mgc:  0.002160059 
iter: 1  value: 3820.696 mgc: 2.501892 ustep: 1 
iter: 2  value: 3820.696 mgc: 4.955017e-07 ustep: 1 
iter: 3  mgc: 8.286705e-13 
iter: 1  mgc: 8.286705e-13 
outer mgc:  0.001480473 
iter: 1  value: 3816.516 mgc: 3.12517 ustep: 1 
iter: 2  value: 3816.516 mgc: 3.427028e-07 ustep: 1 
iter: 3  mgc: 1.800282e-12 
iter: 1  mgc: 1.800282e-12 
outer mgc:  0.001025804 
iter: 1  value: 3813.059 mgc: 2.51472 ustep: 1 
iter: 2  value: 3813.059 mgc: 1.092647e-07 ustep: 1 
iter: 3  mgc: 1.792344e-12 
iter: 1  mgc: 1.792344e-12 
outer mgc:  0.0006988491 
iter: 1  value: 3808.871 mgc: 3.13576 ustep: 1 
iter: 2  value: 3808.871 mgc: 7.494627e-08 ustep: 1 
iter: 3  mgc: 3.679279e-12 
iter: 1  mgc: 3.679279e-12 
outer mgc:  0.0004804298 
iter: 1  value: 3805.409 mgc: 2.516775 ustep: 1 
iter: 2  value: 3805.409 mgc: 2.368291e-08 ustep: 1 
mgc: 4.562573e-12 
iter: 1  mgc: 4.562573e-12 
outer mgc:  0.0003268557 
iter: 1  value: 3801.217 mgc: 3.135682 ustep: 1 
iter: 2  value: 3801.217 mgc: 1.619401e-08 ustep: 1 
mgc: 4.760414e-12 
iter: 1  mgc: 4.760414e-12 
outer mgc:  0.0002242859 
iter: 1  value: 3797.753 mgc: 2.517616 ustep: 1 
iter: 2  mgc: 5.12169e-09 
iter: 1  mgc: 5.12169e-09 
outer mgc:  0.0001525196 
iter: 1  value: 3793.56 mgc: 3.13796 ustep: 1 
iter: 2  mgc: 3.497734e-09 
iter: 1  mgc: 3.497734e-09 
outer mgc:  0.0001044897 
iter: 1  value: 3790.095 mgc: 2.51897 ustep: 1 
iter: 2  mgc: 1.108127e-09 
iter: 1  mgc: 1.108127e-09 
outer mgc:  7.100844e-05 
iter: 1  value: 3785.901 mgc: 3.138901 ustep: 1 
iter: 2  mgc: 7.598659e-10 
iter: 1  mgc: 7.598659e-10 
outer mgc:  4.861074e-05 
iter: 1  value: 3782.435 mgc: 2.519038 ustep: 1 
iter: 2  mgc: 2.567813e-10 
iter: 1  mgc: 2.567813e-10 
outer mgc:  3.302878e-05 
iter: 1  mgc: 2.567813e-10 
iter: 1  mgc: 2.567813e-10 
outer mgc:  3.302878e-05 
iter: 1  value: 3782.436 mgc: 0.006287585 ustep: 1 
iter: 2  value: 3782.436 mgc: 1.191771e-07 ustep: 1 
iter: 3  mgc: 6.165835e-11 
outer mgc:  0.08237554 
iter: 1  value: 3782.435 mgc: 0.006284721 ustep: 1 
iter: 2  value: 3782.435 mgc: 1.189973e-07 ustep: 1 
iter: 3  mgc: 4.367151e-11 
outer mgc:  0.08230083 
iter: 1  value: 3782.436 mgc: 0.003193036 ustep: 1 
iter: 2  value: 3782.436 mgc: 3.532915e-08 ustep: 1 
iter: 3  mgc: 2.773448e-11 
outer mgc:  0.04257274 
iter: 1  value: 3782.435 mgc: 0.00319184 ustep: 1 
iter: 2  value: 3782.435 mgc: 3.529367e-08 ustep: 1 
iter: 3  mgc: 5.008532e-11 
outer mgc:  0.04251364 
iter: 1  value: 3782.436 mgc: 0.006692777 ustep: 1 
iter: 2  value: 3782.436 mgc: 2.443927e-07 ustep: 1 
iter: 3  mgc: 4.506817e-11 
outer mgc:  0.0932242 
iter: 1  value: 3782.434 mgc: 0.006691215 ustep: 1 
iter: 2  value: 3782.434 mgc: 2.435252e-07 ustep: 1 
iter: 3  mgc: 4.164269e-11 
outer mgc:  0.09325822 
iter: 1  value: 3782.436 mgc: 0.003549779 ustep: 1 
iter: 2  value: 3782.436 mgc: 9.867178e-08 ustep: 1 
iter: 3  mgc: 6.063994e-11 
outer mgc:  0.05474053 
iter: 1  value: 3782.434 mgc: 0.003549152 ustep: 1 
iter: 2  value: 3782.434 mgc: 9.858648e-08 ustep: 1 
iter: 3  mgc: 5.336576e-11 
outer mgc:  0.05477509 
iter: 1  value: 3782.45 mgc: 243.2063 ustep: 1 
iter: 2  value: 3782.45 mgc: 2.036288e-06 ustep: 1 
iter: 3  mgc: 8.194334e-11 
outer mgc:  0.02747473 
iter: 1  value: 3782.421 mgc: 243.4496 ustep: 1 
iter: 2  value: 3782.421 mgc: 2.032781e-06 ustep: 1 
iter: 3  mgc: 5.940493e-11 
outer mgc:  0.02739766 
iter: 1  value: 3782.448 mgc: 242.9687 ustep: 1 
iter: 2  value: 3782.448 mgc: 1.332813e-06 ustep: 1 
iter: 3  mgc: 6.252371e-11 
outer mgc:  0.0278007 
iter: 1  value: 3782.423 mgc: 243.6987 ustep: 1 
iter: 2  value: 3782.423 mgc: 1.332484e-06 ustep: 1 
iter: 3  mgc: 3.441796e-11 
outer mgc:  0.02772176 
iter: 1  value: 3782.435 mgc: 4.38766e-05 ustep: 1 
mgc: 7.460876e-11 
outer mgc:  3.302813e-05 
iter: 1  value: 3782.435 mgc: 4.387563e-05 ustep: 1 
mgc: 3.651141e-11 
outer mgc:  3.302941e-05 
iter: 1  value: 3782.431 mgc: 0.004752612 ustep: 1 
iter: 2  value: 3782.431 mgc: 1.184847e-07 ustep: 1 
iter: 3  mgc: 5.558509e-11 
outer mgc:  0.02578779 
iter: 1  value: 3782.44 mgc: 0.004750452 ustep: 1 
iter: 2  value: 3782.44 mgc: 1.184245e-07 ustep: 1 
iter: 3  mgc: 3.89333e-11 
outer mgc:  0.02584695 
[Mon Aug 16 08:56:02 2021]
Finished job 0.
1 of 1 steps (100%) done

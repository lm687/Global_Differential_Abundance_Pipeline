Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:00:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_diagREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_4_ModeldiagREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_diagREDMsinglelambda_NA_NA_NA_dataset0.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2141.195351 
final  value 1815.338541 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1869.932 mgc: 5.153151 ustep: 1 
iter: 2  value: 1863.539 mgc: 4.487829 ustep: 0.8994163 
iter: 3  value: 1859.509 mgc: 4.467613 ustep: 0.4893118 
iter: 4  value: 1854.522 mgc: 5.206219 ustep: 0.6995383 
iter: 5  value: 1845.161 mgc: 4.047295 ustep: 0.3639337 
iter: 6  value: 1845.119 mgc: 0.2592878 ustep: 0.6033089 
iter: 7  value: 1845.114 mgc: 0.07086325 ustep: 0.7767519 
iter: 8  value: 1845.114 mgc: 0.01284011 ustep: 0.8813472 
iter: 9  value: 1845.114 mgc: 0.001221427 ustep: 0.938807 
iter: 10  value: 1845.114 mgc: 5.872925e-05 ustep: 0.9689237 
iter: 11  value: 1845.114 mgc: 1.41419e-06 ustep: 0.9843408 
iter: 12  value: 1845.114 mgc: 1.704264e-08 ustep: 0.9921403 
iter: 13  mgc: 1.027818e-10 
iter: 1  mgc: 1.027818e-10 
Matching hessian patterns... Done
outer mgc:  14.40074 
iter: 1  value: 1827.474 mgc: 0.8553078 ustep: 1 
iter: 2  value: 1827.472 mgc: 0.05648418 ustep: 1 
iter: 3  value: 1827.472 mgc: 0.0001867208 ustep: 1 
iter: 4  mgc: 2.580174e-09 
iter: 1  value: 1810.117 mgc: 9.794684 ustep: 1 
iter: 2  value: 1806.599 mgc: 4.751405 ustep: 1 
iter: 3  value: 1806.572 mgc: 0.4242198 ustep: 1 
iter: 4  value: 1806.572 mgc: 0.007786065 ustep: 1 
iter: 5  value: 1806.572 mgc: 2.836125e-06 ustep: 1 
iter: 6  mgc: 3.86996e-13 
iter: 1  mgc: 3.86996e-13 
outer mgc:  23.55671 
iter: 1  value: 1844.6 mgc: 12.16039 ustep: 1 
iter: 2  value: 1837.248 mgc: 7.200952 ustep: 1 
iter: 3  value: 1837.205 mgc: 0.3874925 ustep: 1 
iter: 4  value: 1837.205 mgc: 0.005107426 ustep: 1 
iter: 5  value: 1837.205 mgc: 5.823116e-07 ustep: 1 
iter: 6  mgc: 7.582823e-14 
iter: 1  value: 1798.483 mgc: 3.698266 ustep: 1 
iter: 2  value: 1798.453 mgc: 0.349887 ustep: 1 
iter: 3  value: 1798.453 mgc: 0.004889011 ustep: 1 
iter: 4  value: 1798.453 mgc: 1.104296e-06 ustep: 1 
iter: 5  mgc: 6.236678e-14 
iter: 1  mgc: 6.236678e-14 
outer mgc:  16.81262 
iter: 1  value: 1831.875 mgc: 10.79687 ustep: 0.8994163 
iter: 2  value: 1793.211 mgc: 18.68805 ustep: 0.9483808 
iter: 3  value: 1792.611 mgc: 1.582454 ustep: 0.973851 
iter: 4  value: 1792.61 mgc: 0.1102998 ustep: 0.9868402 
iter: 5  value: 1792.61 mgc: 0.0005234422 ustep: 0.993399 
iter: 6  value: 1792.61 mgc: 6.654522e-07 ustep: 0.9966944 
iter: 7  mgc: 7.046534e-10 
iter: 1  mgc: 7.046534e-10 
outer mgc:  15.35138 
iter: 1  value: 1779.892 mgc: 1.29934 ustep: 1 
iter: 2  value: 1779.891 mgc: 0.05063995 ustep: 1 
iter: 3  value: 1779.891 mgc: 6.127717e-05 ustep: 1 
iter: 4  mgc: 2.274125e-10 
iter: 1  mgc: 2.274125e-10 
outer mgc:  4.157866 
iter: 1  value: 1772.888 mgc: 8.757887 ustep: 1 
iter: 2  value: 1771.941 mgc: 2.354731 ustep: 1 
iter: 3  value: 1771.94 mgc: 0.07741507 ustep: 1 
iter: 4  value: 1771.94 mgc: 0.0001387338 ustep: 1 
iter: 5  mgc: 5.09859e-10 
iter: 1  mgc: 5.09859e-10 
outer mgc:  6.743223 
iter: 1  value: 1767.323 mgc: 11.33796 ustep: 1 
iter: 2  value: 1767.281 mgc: 0.7594732 ustep: 1 
iter: 3  value: 1767.281 mgc: 0.008123741 ustep: 1 
iter: 4  value: 1767.281 mgc: 9.777571e-07 ustep: 1 
iter: 5  mgc: 1.947331e-13 
iter: 1  mgc: 1.947331e-13 
outer mgc:  8.781046 
iter: 1  value: 1766.097 mgc: 18.0877 ustep: 1 
iter: 2  value: 1765.652 mgc: 2.300183 ustep: 1 
iter: 3  value: 1765.652 mgc: 0.03876059 ustep: 1 
iter: 4  value: 1765.652 mgc: 1.410312e-05 ustep: 1 
iter: 5  mgc: 2.581491e-12 
iter: 1  mgc: 2.581491e-12 
outer mgc:  7.936691 
iter: 1  value: 1765.685 mgc: 14.63831 ustep: 1 
iter: 2  value: 1765.653 mgc: 0.4681428 ustep: 1 
iter: 3  value: 1765.653 mgc: 0.002074551 ustep: 1 
iter: 4  value: 1765.653 mgc: 6.116349e-08 ustep: 1 
mgc: 3.339551e-13 
iter: 1  value: 1764.522 mgc: 7.107477 ustep: 1 
iter: 2  value: 1764.52 mgc: 0.1321414 ustep: 1 
iter: 3  value: 1764.52 mgc: 0.0001559581 ustep: 1 
iter: 4  mgc: 3.430242e-10 
iter: 1  mgc: 3.430242e-10 
outer mgc:  5.186997 
iter: 1  value: 1764.415 mgc: 5.408641 ustep: 1 
iter: 2  value: 1764.41 mgc: 0.1883588 ustep: 1 
iter: 3  value: 1764.41 mgc: 0.0004389412 ustep: 1 
iter: 4  mgc: 2.481153e-09 
iter: 1  mgc: 2.481153e-09 
outer mgc:  4.112912 
iter: 1  value: 1764.735 mgc: 4.594084 ustep: 1 
iter: 2  value: 1764.734 mgc: 0.07669575 ustep: 1 
iter: 3  value: 1764.734 mgc: 8.816705e-05 ustep: 1 
iter: 4  mgc: 1.036342e-10 
iter: 1  value: 1764.139 mgc: 1.789202 ustep: 1 
iter: 2  value: 1764.139 mgc: 0.01230178 ustep: 1 
iter: 3  value: 1764.139 mgc: 2.199058e-06 ustep: 1 
iter: 4  mgc: 2.395861e-13 
iter: 1  mgc: 2.395861e-13 
outer mgc:  2.267185 
iter: 1  value: 1764.016 mgc: 2.193294 ustep: 1 
iter: 2  value: 1764.015 mgc: 0.04246092 ustep: 1 
iter: 3  value: 1764.015 mgc: 2.198405e-05 ustep: 1 
iter: 4  mgc: 6.126211e-12 
iter: 1  mgc: 6.126211e-12 
outer mgc:  2.586547 
iter: 1  value: 1763.852 mgc: 1.037112 ustep: 1 
iter: 2  value: 1763.852 mgc: 0.007442669 ustep: 1 
iter: 3  value: 1763.852 mgc: 6.733729e-07 ustep: 1 
iter: 4  mgc: 4.352074e-13 
iter: 1  mgc: 4.352074e-13 
outer mgc:  0.8245008 
iter: 1  value: 1763.733 mgc: 0.549239 ustep: 1 
iter: 2  value: 1763.733 mgc: 0.002291551 ustep: 1 
iter: 3  value: 1763.733 mgc: 4.354597e-08 ustep: 1 
mgc: 4.054534e-13 
iter: 1  mgc: 4.054534e-13 
outer mgc:  1.325759 
iter: 1  value: 1763.508 mgc: 0.4751522 ustep: 1 
iter: 2  value: 1763.508 mgc: 0.001536194 ustep: 1 
iter: 3  value: 1763.508 mgc: 2.564328e-08 ustep: 1 
mgc: 5.124789e-13 
iter: 1  value: 1763.111 mgc: 1.392173 ustep: 1 
iter: 2  value: 1763.111 mgc: 0.01239908 ustep: 1 
iter: 3  value: 1763.111 mgc: 1.389259e-06 ustep: 1 
iter: 4  mgc: 1.045386e-12 
iter: 1  mgc: 1.045386e-12 
outer mgc:  1.658105 
iter: 1  value: 1763.106 mgc: 1.280376 ustep: 1 
iter: 2  value: 1763.106 mgc: 0.01945988 ustep: 1 
iter: 3  value: 1763.106 mgc: 4.766918e-06 ustep: 1 
iter: 4  mgc: 1.33249e-12 
iter: 1  value: 1763.039 mgc: 0.4977105 ustep: 1 
iter: 2  value: 1763.039 mgc: 0.002981847 ustep: 1 
iter: 3  value: 1763.039 mgc: 1.070583e-07 ustep: 1 
mgc: 1.313172e-12 
iter: 1  mgc: 1.313172e-12 
outer mgc:  1.263927 
iter: 1  value: 1762.71 mgc: 0.8477493 ustep: 1 
iter: 2  value: 1762.71 mgc: 0.0072532 ustep: 1 
iter: 3  value: 1762.71 mgc: 6.114669e-07 ustep: 1 
iter: 4  mgc: 1.377787e-12 
iter: 1  mgc: 1.377787e-12 
outer mgc:  0.5017763 
iter: 1  value: 1762.69 mgc: 1.798977 ustep: 1 
iter: 2  value: 1762.69 mgc: 0.01178577 ustep: 1 
iter: 3  value: 1762.69 mgc: 1.34787e-06 ustep: 1 
iter: 4  mgc: 3.576583e-12 
iter: 1  mgc: 3.576583e-12 
outer mgc:  0.8587198 
iter: 1  value: 1762.621 mgc: 0.1549941 ustep: 1 
iter: 2  value: 1762.621 mgc: 0.0001421621 ustep: 1 
iter: 3  mgc: 1.961067e-10 
iter: 1  mgc: 1.961067e-10 
outer mgc:  0.2376554 
iter: 1  value: 1762.548 mgc: 0.3187872 ustep: 1 
iter: 2  value: 1762.548 mgc: 0.0006209559 ustep: 1 
iter: 3  mgc: 3.629137e-09 
iter: 1  mgc: 3.629137e-09 
outer mgc:  0.1111407 
iter: 1  value: 1762.519 mgc: 0.06609202 ustep: 1 
iter: 2  value: 1762.519 mgc: 1.95342e-05 ustep: 1 
iter: 3  mgc: 3.390355e-11 
iter: 1  mgc: 3.390355e-11 
outer mgc:  0.09346052 
iter: 1  value: 1762.506 mgc: 0.02174991 ustep: 1 
iter: 2  value: 1762.506 mgc: 5.198834e-06 ustep: 1 
iter: 3  mgc: 7.903678e-11 
iter: 1  mgc: 7.903678e-11 
outer mgc:  0.0207842 
iter: 1  value: 1762.498 mgc: 0.01926136 ustep: 1 
iter: 2  value: 1762.498 mgc: 2.426398e-06 ustep: 0.989901 
iter: 3  mgc: 6.64693e-10 
iter: 1  mgc: 6.64693e-10 
outer mgc:  0.006499992 
iter: 1  value: 1762.494 mgc: 0.003682031 ustep: 1 
iter: 2  value: 1762.494 mgc: 5.036895e-08 ustep: 0.989901 
mgc: 2.649714e-10 
iter: 1  mgc: 2.649714e-10 
outer mgc:  0.008714436 
iter: 1  value: 1762.492 mgc: 0.001059024 ustep: 1 
iter: 2  value: 1762.492 mgc: 1.238082e-08 ustep: 1 
mgc: 4.94853e-10 
iter: 1  mgc: 4.94853e-10 
outer mgc:  0.002069273 
iter: 1  value: 1762.49 mgc: 0.00192034 ustep: 1 
iter: 2  value: 1762.49 mgc: 3.022613e-08 ustep: 1 
mgc: 8.400788e-10 
iter: 1  mgc: 8.400788e-10 
outer mgc:  0.0007660843 
iter: 1  value: 1762.49 mgc: 0.0002601619 ustep: 0.9999 
iter: 2  mgc: 4.255284e-09 
iter: 1  mgc: 4.255284e-09 
outer mgc:  0.0009267295 
iter: 1  value: 1762.489 mgc: 0.0002565134 ustep: 1 
iter: 2  mgc: 2.391898e-09 
iter: 1  mgc: 2.391898e-09 
outer mgc:  0.0003417914 
iter: 1  value: 1762.489 mgc: 0.0002985094 ustep: 1 
iter: 2  mgc: 5.116015e-09 
iter: 1  mgc: 5.116015e-09 
outer mgc:  0.0001482577 
iter: 1  value: 1762.489 mgc: 0.0001565155 ustep: 1 
iter: 2  mgc: 9.04345e-09 
iter: 1  mgc: 9.04345e-09 
outer mgc:  0.0001832997 
iter: 1  value: 1762.489 mgc: 8.926347e-05 ustep: 0.9999 
iter: 2  value: 1762.489 mgc: 5.82378e-08 ustep: 2.291081e-09 
mgc: 5.82378e-08 
iter: 1  value: 1762.489 mgc: 5.82378e-08 ustep: 0.8994163 
mgc: 2.084928e-08 
outer mgc:  7.808365e-05 
iter: 1  value: 1762.489 mgc: 8.876754e-05 ustep: 0.1336527 
iter: 2  value: 1762.489 mgc: 1.716153e-05 ustep: 0.003547002 
iter: 3  value: 1762.489 mgc: 1.592138e-05 ustep: 7.136398e-12 
mgc: 1.592138e-05 
iter: 1  value: 1762.489 mgc: 2.814095e-05 ustep: 1 
iter: 2  value: 1762.489 mgc: 4.169172e-08 ustep: 1 
mgc: 4.169092e-08 
iter: 1  value: 1762.489 mgc: 3.133713e-05 ustep: 1 
iter: 2  value: 1762.489 mgc: 5.39198e-08 ustep: 0.4367355 
mgc: 3.324176e-08 
iter: 1  value: 1762.489 mgc: 3.51294e-05 ustep: 0.9999 
iter: 2  value: 1762.489 mgc: 2.254533e-08 ustep: 0.9928299 
mgc: 2.722457e-08 
iter: 1  value: 1762.489 mgc: 3.549142e-05 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.341493e-08 ustep: 1 
mgc: 2.740305e-08 
iter: 1  value: 1762.489 mgc: 3.553003e-05 ustep: 1 
iter: 2  value: 1762.489 mgc: 4.583036e-08 ustep: 0.989901 
mgc: 3.137791e-08 
iter: 1  value: 1762.489 mgc: 3.551987e-05 ustep: 1 
iter: 2  value: 1762.489 mgc: 4.063894e-08 ustep: 1 
mgc: 3.786834e-08 
iter: 1  value: 1762.489 mgc: 4.878527e-06 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.608669e-08 ustep: 1 
mgc: 2.583536e-08 
iter: 1  value: 1762.489 mgc: 4.810471e-07 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.499525e-08 ustep: 0.9999 
mgc: 2.865467e-08 
iter: 1  value: 1762.489 mgc: 7.059881e-08 ustep: 0.001119436 
mgc: 6.750966e-08 
iter: 1  value: 1762.489 mgc: 3.959773e-08 ustep: 1 
mgc: 2.668058e-08 
iter: 1  value: 1762.489 mgc: 2.668058e-08 ustep: 3.413036e-08 
mgc: 3.103676e-08 
outer mgc:  7.80786e-05 
iter: 1  value: 1762.489 mgc: 3.24e-08 ustep: 1 
mgc: 2.366794e-08 
iter: 1  value: 1762.489 mgc: 3.421948e-08 ustep: 1 
mgc: 1.83939e-08 
iter: 1  value: 1762.489 mgc: 3.267323e-08 ustep: 0.9999 
mgc: 3.823333e-08 
iter: 1  value: 1762.489 mgc: 2.536244e-08 ustep: 1 
mgc: 1.404342e-08 
iter: 1  value: 1762.489 mgc: 2.668058e-08 ustep: 3.413036e-08 
mgc: 3.103676e-08 
iter: 1  value: 1762.489 mgc: 3.103676e-08 ustep: 1.706347e-08 
mgc: 3.103676e-08 
outer mgc:  7.807175e-05 
iter: 1  value: 1762.489 mgc: 0.03506207 ustep: 1 
iter: 2  value: 1762.489 mgc: 7.77304e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 4.23479e-08 ustep: 0.4367355 
mgc: 2.627817e-08 
outer mgc:  0.02844829 
iter: 1  value: 1762.489 mgc: 0.03504475 ustep: 1 
iter: 2  value: 1762.489 mgc: 7.788779e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 6.438024e-08 ustep: 1 
mgc: 2.773558e-08 
outer mgc:  0.02853619 
iter: 1  value: 1762.489 mgc: 0.02328633 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.3075e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 3.207455e-08 ustep: 0.01776843 
mgc: 3.104733e-08 
outer mgc:  0.07848184 
iter: 1  value: 1762.489 mgc: 0.02327724 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.314606e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 5.125763e-08 ustep: 1 
mgc: 2.198769e-08 
outer mgc:  0.07860528 
iter: 1  value: 1762.489 mgc: 0.05332384 ustep: 1 
iter: 2  value: 1762.489 mgc: 7.687452e-06 ustep: 0.9999 
iter: 3  value: 1762.489 mgc: 3.996594e-08 ustep: 0.9928299 
mgc: 2.79876e-08 
outer mgc:  0.02397895 
iter: 1  value: 1762.489 mgc: 0.05332468 ustep: 1 
iter: 2  value: 1762.489 mgc: 7.697542e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 2.592607e-08 ustep: 1.706347e-08 
mgc: 2.924967e-08 
outer mgc:  0.02399036 
iter: 1  value: 1762.489 mgc: 0.02749183 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.139938e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 4.435271e-08 ustep: 0.9999 
mgc: 3.463131e-08 
outer mgc:  0.1122942 
iter: 1  value: 1762.489 mgc: 0.02749132 ustep: 1 
iter: 2  value: 1762.489 mgc: 3.174914e-06 ustep: 1 
iter: 3  value: 1762.489 mgc: 2.373563e-08 ustep: 0.989901 
mgc: 3.379964e-08 
outer mgc:  0.1124477 
iter: 1  value: 1762.49 mgc: 0.003493613 ustep: 1.299629e-13 
mgc: 0.003493613 
outer mgc:  0.003440977 
iter: 1  value: 1762.488 mgc: 0.003497101 ustep: 2.599519e-13 
mgc: 0.003497098 
outer mgc:  0.003433421 
iter: 1  value: 1762.49 mgc: 0.002918925 ustep: 5.199558e-13 
mgc: 0.002918929 
outer mgc:  0.00407569 
iter: 1  value: 1762.489 mgc: 0.00292184 ustep: 1.299629e-13 
mgc: 0.002921837 
outer mgc:  0.00406174 
iter: 1  value: 1762.489 mgc: 4.234813e-08 ustep: 0.2494656 
mgc: 2.353255e-08 
outer mgc:  7.807058e-05 
iter: 1  value: 1762.489 mgc: 5.820089e-08 ustep: 1 
mgc: 2.53628e-08 
outer mgc:  7.802792e-05 
[Sun Aug 15 00:00:49 2021]
Finished job 0.
1 of 1 steps (100%) done

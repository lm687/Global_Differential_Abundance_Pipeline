Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 19:56:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_80_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4339.518540 
iter  10 value 4165.969143
iter  10 value 4165.969143
final  value 4165.969143 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 351.3865 mgc: 75.04793 ustep: 1 
iter: 2  value: 323.1655 mgc: 21.95453 ustep: 1 
iter: 3  value: 321.2997 mgc: 10.40037 ustep: 1 
iter: 4  value: 321.2893 mgc: 0.7802694 ustep: 1 
iter: 5  value: 321.2893 mgc: 0.006134758 ustep: 1 
iter: 6  value: 321.2893 mgc: 3.907471e-07 ustep: 1 
iter: 7  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
Matching hessian patterns... Done
outer mgc:  22.38692 
iter: 1  value: 376.9708 mgc: 11.48855 ustep: 1 
iter: 2  value: 376.9282 mgc: 0.4725337 ustep: 1 
iter: 3  value: 376.9282 mgc: 0.001881838 ustep: 1 
iter: 4  value: 376.9282 mgc: 3.059045e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  value: 317.1518 mgc: 2.309694 ustep: 1 
iter: 2  value: 317.1517 mgc: 0.02072175 ustep: 1 
iter: 3  value: 317.1517 mgc: 3.013089e-06 ustep: 1 
iter: 4  mgc: 7.049916e-14 
iter: 1  mgc: 7.049916e-14 
outer mgc:  17.67057 
iter: 1  value: 313.286 mgc: 8.046222 ustep: 1 
iter: 2  value: 313.2763 mgc: 0.2553121 ustep: 1 
iter: 3  value: 313.2763 mgc: 0.0006016772 ustep: 1 
iter: 4  mgc: 3.371418e-09 
iter: 1  mgc: 3.371418e-09 
outer mgc:  17.74299 
iter: 1  value: 304.2833 mgc: 6.161809 ustep: 1 
iter: 2  value: 304.2783 mgc: 0.1894814 ustep: 1 
iter: 3  value: 304.2783 mgc: 0.0003219741 ustep: 1 
iter: 4  mgc: 9.357621e-10 
iter: 1  mgc: 9.357621e-10 
outer mgc:  21.77062 
iter: 1  value: 290.9764 mgc: 31.63027 ustep: 1 
iter: 2  value: 284.5946 mgc: 6.816609 ustep: 1 
iter: 3  value: 284.5875 mgc: 0.315837 ustep: 1 
iter: 4  value: 284.5875 mgc: 0.0008110545 ustep: 1 
iter: 5  mgc: 5.417193e-09 
iter: 1  value: 401.6345 mgc: 40.15635 ustep: 1 
iter: 2  value: 399.344 mgc: 7.325079 ustep: 1 
iter: 3  value: 399.3437 mgc: 0.1141769 ustep: 1 
iter: 4  value: 399.3437 mgc: 4.326081e-05 ustep: 1 
iter: 5  mgc: 1.047606e-11 
iter: 1  mgc: 5.417193e-09 
outer mgc:  18.98739 
iter: 1  value: 269.1749 mgc: 9.34763 ustep: 1 
iter: 2  value: 269.1447 mgc: 0.3681833 ustep: 1 
iter: 3  value: 269.1447 mgc: 0.001644722 ustep: 1 
iter: 4  value: 269.1447 mgc: 2.619506e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  29.35484 
iter: 1  value: 273.1354 mgc: 33.776 ustep: 1 
iter: 2  value: 273.0837 mgc: 1.929131 ustep: 1 
iter: 3  value: 273.0837 mgc: 0.004161369 ustep: 1 
iter: 4  value: 273.0837 mgc: 7.926742e-08 ustep: 1 
mgc: 2.564615e-14 
iter: 1  value: 270.2918 mgc: 13.2168 ustep: 1 
iter: 2  value: 270.2625 mgc: 0.5380698 ustep: 1 
iter: 3  value: 270.2625 mgc: 0.001714204 ustep: 1 
iter: 4  value: 270.2625 mgc: 1.767635e-08 ustep: 1 
mgc: 1.879746e-14 
iter: 1  value: 266.5665 mgc: 6.030012 ustep: 1 
iter: 2  value: 266.5649 mgc: 0.114784 ustep: 1 
iter: 3  value: 266.5649 mgc: 8.141628e-05 ustep: 1 
iter: 4  mgc: 4.107026e-11 
iter: 1  mgc: 4.107026e-11 
outer mgc:  14.83463 
iter: 1  value: 264.9885 mgc: 4.571099 ustep: 1 
iter: 2  value: 264.9878 mgc: 0.05841044 ustep: 1 
iter: 3  value: 264.9878 mgc: 1.770814e-05 ustep: 1 
iter: 4  mgc: 1.379785e-12 
iter: 1  mgc: 1.379785e-12 
outer mgc:  16.127 
iter: 1  value: 261.0781 mgc: 10.96786 ustep: 1 
iter: 2  value: 261.0772 mgc: 0.2183817 ustep: 1 
iter: 3  value: 261.0772 mgc: 6.792621e-05 ustep: 1 
iter: 4  mgc: 1.21112e-11 
iter: 1  mgc: 1.21112e-11 
outer mgc:  15.00675 
iter: 1  value: 257.6658 mgc: 9.976622 ustep: 1 
iter: 2  value: 257.6599 mgc: 0.2565199 ustep: 1 
iter: 3  value: 257.6599 mgc: 0.0001631033 ustep: 1 
iter: 4  mgc: 9.851142e-11 
iter: 1  mgc: 9.851142e-11 
outer mgc:  14.7935 
iter: 1  value: 258.3204 mgc: 12.33466 ustep: 1 
iter: 2  value: 258.3172 mgc: 0.2289996 ustep: 1 
iter: 3  value: 258.3172 mgc: 0.0001840497 ustep: 1 
iter: 4  mgc: 4.588614e-10 
iter: 1  value: 256.9732 mgc: 5.835833 ustep: 1 
iter: 2  value: 256.9731 mgc: 0.04578681 ustep: 1 
iter: 3  value: 256.9731 mgc: 5.944444e-06 ustep: 1 
iter: 4  mgc: 1.412204e-13 
iter: 1  mgc: 1.412204e-13 
outer mgc:  9.284265 
iter: 1  value: 255.9713 mgc: 2.942395 ustep: 1 
iter: 2  value: 255.9713 mgc: 0.01315827 ustep: 1 
iter: 3  value: 255.9713 mgc: 7.749222e-07 ustep: 1 
iter: 4  mgc: 2.589595e-14 
iter: 1  mgc: 2.589595e-14 
outer mgc:  3.51309 
iter: 1  value: 255.5734 mgc: 1.503533 ustep: 1 
iter: 2  value: 255.5733 mgc: 0.005426886 ustep: 1 
iter: 3  value: 255.5733 mgc: 1.959624e-07 ustep: 1 
iter: 4  mgc: 1.901257e-14 
iter: 1  value: 255.7403 mgc: 0.896158 ustep: 1 
iter: 2  value: 255.7403 mgc: 0.001577063 ustep: 1 
iter: 3  value: 255.7403 mgc: 2.774076e-08 ustep: 1 
mgc: 1.498801e-14 
iter: 1  mgc: 1.498801e-14 
outer mgc:  5.727205 
iter: 1  value: 255.4735 mgc: 1.435519 ustep: 1 
iter: 2  value: 255.4735 mgc: 0.005000745 ustep: 1 
iter: 3  value: 255.4735 mgc: 6.419012e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  4.393799 
iter: 1  value: 255.2113 mgc: 1.406258 ustep: 1 
iter: 2  value: 255.2113 mgc: 0.002181467 ustep: 1 
iter: 3  value: 255.2113 mgc: 1.53064e-08 ustep: 1 
mgc: 1.94289e-14 
iter: 1  mgc: 1.94289e-14 
outer mgc:  1.995119 
iter: 1  value: 254.9814 mgc: 1.06517 ustep: 1 
iter: 2  value: 254.9814 mgc: 0.001442258 ustep: 1 
iter: 3  value: 254.9814 mgc: 2.936387e-08 ustep: 1 
mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  1.899493 
iter: 1  value: 254.7705 mgc: 1.175642 ustep: 1 
iter: 2  value: 254.7705 mgc: 0.001331066 ustep: 1 
iter: 3  mgc: 5.220762e-09 
iter: 1  mgc: 5.220762e-09 
outer mgc:  2.180687 
iter: 1  value: 254.5599 mgc: 0.8204812 ustep: 1 
iter: 2  value: 254.5599 mgc: 0.001604757 ustep: 1 
iter: 3  mgc: 7.694392e-09 
iter: 1  mgc: 7.694392e-09 
outer mgc:  2.953858 
iter: 1  value: 254.3992 mgc: 1.035006 ustep: 1 
iter: 2  value: 254.3992 mgc: 0.002697004 ustep: 1 
iter: 3  value: 254.3992 mgc: 3.537292e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  1.581074 
iter: 1  value: 254.2337 mgc: 0.8323495 ustep: 1 
iter: 2  value: 254.2337 mgc: 0.002022624 ustep: 1 
iter: 3  value: 254.2337 mgc: 1.762067e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  value: 254.1177 mgc: 0.5661073 ustep: 1 
iter: 2  value: 254.1177 mgc: 0.001004621 ustep: 1 
iter: 3  mgc: 2.358085e-09 
iter: 1  value: 253.9647 mgc: 1.119184 ustep: 1 
iter: 2  value: 253.9647 mgc: 0.003871277 ustep: 1 
iter: 3  value: 253.9647 mgc: 3.520375e-08 ustep: 1 
mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  4.45674 
iter: 1  value: 253.4257 mgc: 1.89481 ustep: 1 
iter: 2  value: 253.4257 mgc: 0.004619912 ustep: 1 
iter: 3  value: 253.4257 mgc: 9.455131e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  5.947383 
iter: 1  value: 252.7003 mgc: 3.175015 ustep: 1 
iter: 2  value: 252.7003 mgc: 0.01333513 ustep: 1 
iter: 3  value: 252.7003 mgc: 2.366264e-06 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  3.226142 
iter: 1  value: 251.7477 mgc: 2.480175 ustep: 1 
iter: 2  value: 251.7477 mgc: 0.01660899 ustep: 1 
iter: 3  value: 251.7477 mgc: 8.151166e-07 ustep: 1 
iter: 4  mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  7.130138 
iter: 1  value: 251.3956 mgc: 1.059831 ustep: 1 
iter: 2  value: 251.3956 mgc: 0.002661008 ustep: 1 
iter: 3  value: 251.3956 mgc: 2.342531e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  5.387834 
iter: 1  value: 250.7622 mgc: 2.224083 ustep: 1 
iter: 2  value: 250.7622 mgc: 0.002282379 ustep: 1 
iter: 3  value: 250.7622 mgc: 3.189559e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  9.281596 
iter: 1  value: 250.6253 mgc: 1.018848 ustep: 1 
iter: 2  value: 250.6253 mgc: 0.001662543 ustep: 1 
iter: 3  mgc: 5.537657e-09 
iter: 1  mgc: 5.537657e-09 
outer mgc:  2.000269 
iter: 1  value: 250.5291 mgc: 0.8935682 ustep: 1 
iter: 2  value: 250.5291 mgc: 0.001661858 ustep: 1 
iter: 3  mgc: 8.741243e-09 
iter: 1  value: 250.634 mgc: 0.793141 ustep: 1 
iter: 2  value: 250.634 mgc: 0.0003588089 ustep: 1 
iter: 3  mgc: 3.021636e-10 
iter: 1  value: 250.611 mgc: 0.2390196 ustep: 1 
iter: 2  value: 250.611 mgc: 3.231424e-05 ustep: 1 
iter: 3  mgc: 2.316369e-12 
iter: 1  mgc: 2.316369e-12 
outer mgc:  1.193411 
iter: 1  value: 250.5774 mgc: 0.2519009 ustep: 1 
iter: 2  value: 250.5774 mgc: 3.720237e-05 ustep: 1 
iter: 3  mgc: 6.799894e-12 
iter: 1  mgc: 6.799894e-12 
outer mgc:  1.017403 
iter: 1  value: 250.5376 mgc: 0.1616707 ustep: 1 
iter: 2  value: 250.5376 mgc: 2.227342e-05 ustep: 1 
iter: 3  mgc: 9.148238e-13 
iter: 1  mgc: 9.148238e-13 
outer mgc:  0.3236272 
iter: 1  value: 250.451 mgc: 0.1612014 ustep: 1 
iter: 2  value: 250.451 mgc: 2.342154e-05 ustep: 1 
iter: 3  mgc: 2.818634e-12 
iter: 1  mgc: 2.818634e-12 
outer mgc:  0.2255435 
iter: 1  value: 250.3371 mgc: 0.1689987 ustep: 1 
iter: 2  value: 250.3371 mgc: 4.491477e-05 ustep: 1 
iter: 3  mgc: 3.474554e-12 
iter: 1  value: 250.015 mgc: 0.4467623 ustep: 1 
iter: 2  value: 250.015 mgc: 0.0002988148 ustep: 1 
iter: 3  mgc: 1.418918e-10 
iter: 1  mgc: 1.418918e-10 
outer mgc:  0.1815863 
iter: 1  value: 249.8269 mgc: 0.344195 ustep: 1 
iter: 2  value: 249.8269 mgc: 0.0001742013 ustep: 1 
iter: 3  mgc: 4.525447e-11 
iter: 1  mgc: 4.525447e-11 
outer mgc:  0.429315 
iter: 1  value: 249.4485 mgc: 0.4947674 ustep: 1 
iter: 2  value: 249.4485 mgc: 0.0002880526 ustep: 1 
iter: 3  mgc: 1.322125e-10 
iter: 1  mgc: 1.322125e-10 
outer mgc:  0.1077549 
iter: 1  value: 249.3052 mgc: 0.2547635 ustep: 1 
iter: 2  value: 249.3052 mgc: 7.855241e-05 ustep: 1 
iter: 3  mgc: 1.182521e-11 
iter: 1  mgc: 1.182521e-11 
outer mgc:  0.03896659 
iter: 1  value: 249.2883 mgc: 0.03937672 ustep: 1 
iter: 2  value: 249.2883 mgc: 1.308634e-06 ustep: 1 
iter: 3  mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  0.008268659 
iter: 1  value: 249.2906 mgc: 0.00811802 ustep: 1 
iter: 2  value: 249.2906 mgc: 4.178144e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  0.0003780518 
iter: 1  value: 249.2906 mgc: 0.0002396493 ustep: 1 
iter: 2  mgc: 7.803336e-11 
iter: 1  mgc: 7.803336e-11 
outer mgc:  4.995535e-05 
iter: 1  mgc: 7.803336e-11 
iter: 1  mgc: 7.803336e-11 
outer mgc:  4.995535e-05 
iter: 1  value: 249.2916 mgc: 0.05474449 ustep: 1 
iter: 2  value: 249.2916 mgc: 3.193828e-06 ustep: 1 
iter: 3  mgc: 1.136868e-13 
outer mgc:  0.3651603 
iter: 1  value: 249.29 mgc: 0.0547441 ustep: 1 
iter: 2  value: 249.29 mgc: 3.194574e-06 ustep: 1 
iter: 3  mgc: 8.348877e-14 
outer mgc:  0.3651522 
iter: 1  value: 249.2912 mgc: 0.0269945 ustep: 1 
iter: 2  value: 249.2912 mgc: 7.518254e-07 ustep: 1 
iter: 3  mgc: 2.020606e-14 
outer mgc:  0.3273153 
iter: 1  value: 249.2904 mgc: 0.0269941 ustep: 1 
iter: 2  value: 249.2904 mgc: 7.522928e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.3273587 
iter: 1  value: 249.2901 mgc: 0.04079585 ustep: 1 
iter: 2  value: 249.2901 mgc: 2.157859e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.373021 
iter: 1  value: 249.2915 mgc: 0.04077555 ustep: 1 
iter: 2  value: 249.2915 mgc: 2.157419e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.3730005 
iter: 1  value: 249.2904 mgc: 0.02069267 ustep: 1 
iter: 2  value: 249.2904 mgc: 5.536226e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.2582947 
iter: 1  value: 249.291 mgc: 0.02068267 ustep: 1 
iter: 2  value: 249.291 mgc: 5.533208e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.2581096 
iter: 1  value: 249.2873 mgc: 0.004989814 ustep: 1 
iter: 2  value: 249.2873 mgc: 3.014662e-08 ustep: 1 
mgc: 2.131628e-14 
outer mgc:  0.00120929 
iter: 1  value: 249.2939 mgc: 0.004988462 ustep: 1 
iter: 2  value: 249.2939 mgc: 3.016704e-08 ustep: 1 
mgc: 2.842171e-14 
outer mgc:  0.001262627 
iter: 1  value: 249.2955 mgc: 0.07333258 ustep: 1 
iter: 2  value: 249.2955 mgc: 3.379324e-06 ustep: 1 
iter: 3  mgc: 7.41629e-14 
outer mgc:  0.09568767 
iter: 1  value: 249.2858 mgc: 0.07354625 ustep: 1 
iter: 2  value: 249.2858 mgc: 3.374861e-06 ustep: 1 
iter: 3  mgc: 6.750156e-14 
outer mgc:  0.09571815 
iter: 1  value: 249.3004 mgc: 0.07323343 ustep: 1 
iter: 2  value: 249.3004 mgc: 5.593703e-06 ustep: 1 
iter: 3  mgc: 1.063594e-13 
outer mgc:  0.08207847 
iter: 1  value: 249.2809 mgc: 0.0734501 ustep: 1 
iter: 2  value: 249.2809 mgc: 5.60293e-06 ustep: 1 
iter: 3  mgc: 1.256772e-13 
outer mgc:  0.082087 
[Sun Aug 15 19:56:58 2021]
Finished job 0.
1 of 1 steps (100%) done

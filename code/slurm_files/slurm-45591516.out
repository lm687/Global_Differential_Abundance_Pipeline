Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 05:20:41 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_80_3_4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22023.880551 
iter  10 value 10985.843405
final  value 10972.145297 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 23288.17 mgc: 123.8078 ustep: 1 
iter: 2  value: 22845.52 mgc: 45.36071 ustep: 0.6827823 
iter: 3  value: 22144.83 mgc: 109.053 ustep: 0.8263238 
iter: 4  value: 21949.38 mgc: 42.10938 ustep: 0.2588283 
iter: 5  value: 21824.31 mgc: 69.77341 ustep: 0.2991141 
iter: 6  value: 21811.17 mgc: 32.40567 ustep: 0.5469585 
iter: 7  value: 21811.04 mgc: 2.854633 ustep: 0.7395925 
iter: 8  value: 21811.04 mgc: 0.08424644 ustep: 0.8600096 
iter: 9  value: 21811.04 mgc: 0.0008793953 ustep: 0.9273743 
iter: 10  value: 21811.04 mgc: 8.458573e-06 ustep: 0.9630065 
iter: 11  value: 21811.04 mgc: 1.098457e-07 ustep: 0.9813308 
iter: 12  mgc: 9.520954e-10 
iter: 1  mgc: 9.520954e-10 
Matching hessian patterns... Done
outer mgc:  4057.3 
iter: 1  value: 18061.65 mgc: 29.77347 ustep: 1 
iter: 2  value: 18010.14 mgc: 7.927638 ustep: 1 
iter: 3  value: 18009.9 mgc: 0.4983937 ustep: 1 
iter: 4  value: 18009.9 mgc: 0.006257376 ustep: 1 
iter: 5  value: 18009.9 mgc: 2.013005e-06 ustep: 1 
iter: 6  mgc: 2.63789e-13 
iter: 1  value: 10759.36 mgc: 67.01124 ustep: 0.2494656 
iter: 2  value: 9923.704 mgc: 70.91973 ustep: 0.4995153 
iter: 3  value: 9917.684 mgc: 7.403936 ustep: 0.7067933 
iter: 4  value: 9917.67 mgc: 0.2548954 ustep: 0.8407259 
iter: 5  value: 9917.67 mgc: 0.00666599 ustep: 0.9169194 
iter: 6  value: 9917.67 mgc: 0.0002661506 ustep: 0.9575633 
iter: 7  value: 9917.67 mgc: 6.352793e-06 ustep: 0.9785538 
iter: 8  value: 9917.67 mgc: 7.79323e-08 ustep: 0.9892199 
iter: 9  mgc: 4.797323e-10 
iter: 1  mgc: 4.797323e-10 
outer mgc:  2494.062 
iter: 1  value: 3873.888 mgc: 67.59344 ustep: 0.2494656 
iter: 2  value: 2452.939 mgc: 94.83675 ustep: 0.4995153 
iter: 3  value: 2414.635 mgc: 19.66382 ustep: 0.7067933 
iter: 4  value: 2414.39 mgc: 1.286861 ustep: 0.8407259 
iter: 5  value: 2414.39 mgc: 0.01675923 ustep: 0.9169194 
iter: 6  value: 2414.39 mgc: 0.0003267473 ustep: 0.9575633 
iter: 7  value: 2414.39 mgc: 5.70701e-06 ustep: 0.9785538 
iter: 8  value: 2414.39 mgc: 5.894408e-08 ustep: 0.9892199 
iter: 9  mgc: 3.036224e-10 
iter: 1  value: 1050.505 mgc: 29.20914 ustep: 1 
iter: 2  value: 1031.02 mgc: 4.149452 ustep: 1 
iter: 3  value: 1030.98 mgc: 0.2103496 ustep: 1 
iter: 4  value: 1030.98 mgc: 0.002836877 ustep: 1 
iter: 5  value: 1030.98 mgc: 5.529646e-07 ustep: 1 
iter: 6  mgc: 3.327894e-14 
iter: 1  mgc: 3.327894e-14 
outer mgc:  94.6063 
iter: 1  value: 579.6303 mgc: 54516.71 ustep: 1 
iter: 2  value: 579.0542 mgc: 12.65985 ustep: 1 
iter: 3  value: 579.0542 mgc: 0.0001922757 ustep: 1 
iter: 4  mgc: 1.385558e-13 
iter: 1  value: 809.5069 mgc: 58.26192 ustep: 1 
iter: 2  value: 803.4811 mgc: 5.625451 ustep: 1 
iter: 3  value: 803.4518 mgc: 0.5880039 ustep: 1 
iter: 4  value: 803.4518 mgc: 0.006232016 ustep: 1 
iter: 5  value: 803.4518 mgc: 8.189995e-07 ustep: 1 
iter: 6  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  235.9167 
iter: 1  value: 10218.69 mgc: 152.7952 ustep: 0.4367355 
iter: 2  value: 5838.228 mgc: 69.58603 ustep: 0.6608936 
iter: 3  value: 4765.728 mgc: 61.13095 ustep: 0.8129723 
iter: 4  value: 4510.191 mgc: 51.54429 ustep: 0.9016596 
iter: 5  value: 4499.828 mgc: 17.78147 ustep: 0.9495626 
iter: 6  value: 4499.796 mgc: 1.072785 ustep: 0.9744576 
iter: 7  value: 4499.796 mgc: 0.003851818 ustep: 0.9871475 
iter: 8  value: 4499.796 mgc: 2.195418e-06 ustep: 0.9935536 
iter: 9  mgc: 5.79611e-10 
iter: 1  value: 793.5497 mgc: 9.072053 ustep: 1 
iter: 2  value: 793.5428 mgc: 0.2376076 ustep: 1 
iter: 3  value: 793.5428 mgc: 0.0002680782 ustep: 1 
iter: 4  mgc: 3.58312e-10 
iter: 1  mgc: 3.58312e-10 
outer mgc:  344.5644 
iter: 1  value: 754.1782 mgc: 12.80045 ustep: 1 
iter: 2  value: 754.172 mgc: 0.3551686 ustep: 1 
iter: 3  value: 754.172 mgc: 0.0003690602 ustep: 1 
iter: 4  mgc: 4.056142e-10 
iter: 1  mgc: 4.056142e-10 
outer mgc:  153.7403 
iter: 1  value: 747.5276 mgc: 7.839079 ustep: 1 
iter: 2  value: 747.5219 mgc: 0.137665 ustep: 1 
iter: 3  value: 747.5219 mgc: 6.919813e-05 ustep: 1 
iter: 4  mgc: 4.607337e-11 
iter: 1  mgc: 4.607337e-11 
outer mgc:  109.7159 
iter: 1  value: 754.4138 mgc: 8.178958 ustep: 1 
iter: 2  value: 754.4102 mgc: 0.1034164 ustep: 1 
iter: 3  value: 754.4102 mgc: 0.0001157171 ustep: 1 
iter: 4  mgc: 8.668266e-11 
iter: 1  mgc: 8.668266e-11 
outer mgc:  67.69867 
iter: 1  value: 762.8671 mgc: 10.33773 ustep: 1 
iter: 2  value: 762.8583 mgc: 0.2075886 ustep: 1 
iter: 3  value: 762.8583 mgc: 0.0005610572 ustep: 1 
iter: 4  value: 762.8583 mgc: 1.041742e-08 ustep: 1 
mgc: 2.808864e-14 
iter: 1  value: 750.2259 mgc: 6.076998 ustep: 1 
iter: 2  value: 750.2252 mgc: 0.0346949 ustep: 1 
iter: 3  value: 750.2252 mgc: 8.668567e-06 ustep: 1 
iter: 4  mgc: 2.916778e-12 
iter: 1  mgc: 2.916778e-12 
outer mgc:  24.88915 
iter: 1  value: 747.2428 mgc: 2.496103 ustep: 1 
iter: 2  value: 747.2424 mgc: 0.02335849 ustep: 1 
iter: 3  value: 747.2424 mgc: 4.37991e-06 ustep: 1 
iter: 4  mgc: 9.041656e-13 
iter: 1  mgc: 9.041656e-13 
outer mgc:  30.38301 
iter: 1  value: 743.7768 mgc: 2.766873 ustep: 1 
iter: 2  value: 743.7764 mgc: 0.04318945 ustep: 1 
iter: 3  value: 743.7764 mgc: 1.809196e-05 ustep: 1 
iter: 4  mgc: 2.863709e-12 
iter: 1  mgc: 2.863709e-12 
outer mgc:  17.24804 
iter: 1  value: 743.0831 mgc: 1.300068 ustep: 1 
iter: 2  value: 743.0831 mgc: 0.004425449 ustep: 1 
iter: 3  value: 743.0831 mgc: 4.227073e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  13.72251 
iter: 1  value: 743.0971 mgc: 2.564125 ustep: 1 
iter: 2  value: 743.0971 mgc: 0.007030453 ustep: 1 
iter: 3  value: 743.0971 mgc: 9.193557e-07 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  29.34998 
iter: 1  value: 740.0378 mgc: 1.603958 ustep: 1 
iter: 2  value: 740.0378 mgc: 0.002199374 ustep: 1 
iter: 3  value: 740.0378 mgc: 4.520438e-08 ustep: 1 
iter: 4  mgc: 4.085621e-14 
iter: 1  value: 737.2274 mgc: 0.4787472 ustep: 1 
iter: 2  value: 737.2274 mgc: 0.0004957077 ustep: 1 
iter: 3  mgc: 5.320072e-09 
iter: 1  value: 723.6768 mgc: 2.675836 ustep: 1 
iter: 2  value: 723.6767 mgc: 0.01412287 ustep: 1 
iter: 3  value: 723.6767 mgc: 5.493797e-06 ustep: 1 
iter: 4  mgc: 2.083667e-12 
iter: 1  value: 689.2537 mgc: 14.06808 ustep: 1 
iter: 2  value: 689.2083 mgc: 0.3166707 ustep: 1 
iter: 3  value: 689.2083 mgc: 0.002975659 ustep: 1 
iter: 4  value: 689.2083 mgc: 3.486493e-07 ustep: 1 
iter: 5  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  162.3305 
iter: 1  value: 652.9072 mgc: 7.113811 ustep: 1 
iter: 2  value: 652.8508 mgc: 0.2244987 ustep: 1 
iter: 3  value: 652.8508 mgc: 0.0006108988 ustep: 1 
iter: 4  value: 652.8508 mgc: 1.71204e-08 ustep: 1 
mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  95.57385 
iter: 1  value: 2580.059 mgc: 1519.354 ustep: 1 
iter: 2  value: 2553.506 mgc: 13.36933 ustep: 1 
iter: 3  value: 2553.485 mgc: 0.3171472 ustep: 1 
iter: 4  value: 2553.485 mgc: 0.001105507 ustep: 1 
iter: 5  value: 2553.485 mgc: 2.944183e-08 ustep: 1 
mgc: 8.526513e-14 
iter: 1  value: 669.1322 mgc: 31.50236 ustep: 1 
iter: 2  value: 668.9664 mgc: 0.8707584 ustep: 1 
iter: 3  value: 668.9663 mgc: 0.01085311 ustep: 1 
iter: 4  value: 668.9663 mgc: 2.233804e-06 ustep: 1 
iter: 5  mgc: 1.474376e-13 
iter: 1  value: 648.1962 mgc: 13.64199 ustep: 1 
iter: 2  value: 648.1918 mgc: 0.1641396 ustep: 1 
iter: 3  value: 648.1918 mgc: 0.0001993529 ustep: 1 
iter: 4  mgc: 3.647005e-10 
iter: 1  mgc: 3.647005e-10 
outer mgc:  37.89261 
iter: 1  value: 652.2639 mgc: 6.342819 ustep: 1 
iter: 2  value: 652.263 mgc: 0.09310328 ustep: 1 
iter: 3  value: 652.263 mgc: 6.398337e-05 ustep: 1 
iter: 4  mgc: 2.941802e-11 
iter: 1  mgc: 2.941802e-11 
outer mgc:  87.33735 
iter: 1  value: 650.4105 mgc: 3.964797 ustep: 1 
iter: 2  value: 650.4104 mgc: 0.02567711 ustep: 1 
iter: 3  value: 650.4104 mgc: 3.854205e-06 ustep: 1 
iter: 4  mgc: 7.451817e-13 
iter: 1  mgc: 7.451817e-13 
outer mgc:  40.47767 
iter: 1  value: 651.9604 mgc: 2.722403 ustep: 1 
iter: 2  value: 651.9604 mgc: 0.004463207 ustep: 1 
iter: 3  value: 651.9604 mgc: 2.986786e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  24.11242 
iter: 1  value: 653.6131 mgc: 1.868278 ustep: 1 
iter: 2  value: 653.6131 mgc: 0.007602916 ustep: 1 
iter: 3  value: 653.6131 mgc: 1.331837e-07 ustep: 1 
iter: 4  mgc: 3.652634e-14 
iter: 1  mgc: 3.652634e-14 
outer mgc:  18.60602 
iter: 1  value: 656.1259 mgc: 2.105899 ustep: 1 
iter: 2  value: 656.1255 mgc: 0.0209013 ustep: 1 
iter: 3  value: 656.1255 mgc: 2.876338e-06 ustep: 1 
iter: 4  mgc: 6.004086e-13 
iter: 1  mgc: 6.004086e-13 
outer mgc:  16.72449 
iter: 1  value: 659.5567 mgc: 2.224997 ustep: 1 
iter: 2  value: 659.5566 mgc: 0.02141406 ustep: 1 
iter: 3  value: 659.5566 mgc: 3.672801e-06 ustep: 1 
iter: 4  mgc: 1.54543e-13 
iter: 1  mgc: 1.54543e-13 
outer mgc:  6.369608 
iter: 1  value: 662.0049 mgc: 1.541651 ustep: 1 
iter: 2  value: 662.0049 mgc: 0.006065377 ustep: 1 
iter: 3  value: 662.0049 mgc: 2.891256e-07 ustep: 1 
iter: 4  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  10.43402 
iter: 1  value: 667.3361 mgc: 2.655675 ustep: 1 
iter: 2  value: 667.3348 mgc: 0.0536906 ustep: 1 
iter: 3  value: 667.3348 mgc: 2.421503e-05 ustep: 1 
iter: 4  mgc: 4.818812e-12 
iter: 1  value: 663.8577 mgc: 1.264894 ustep: 1 
iter: 2  value: 663.8577 mgc: 0.0120728 ustep: 1 
iter: 3  value: 663.8577 mgc: 1.088682e-06 ustep: 1 
iter: 4  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  3.719529 
iter: 1  value: 662.8988 mgc: 0.5439691 ustep: 1 
iter: 2  value: 662.8988 mgc: 0.001132753 ustep: 1 
iter: 3  value: 662.8988 mgc: 2.242094e-08 ustep: 1 
mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  3.373809 
iter: 1  value: 661.4866 mgc: 0.5593931 ustep: 1 
iter: 2  value: 661.4866 mgc: 0.0004717877 ustep: 1 
iter: 3  mgc: 1.363626e-09 
iter: 1  mgc: 1.363626e-09 
outer mgc:  3.643253 
iter: 1  value: 661.4725 mgc: 0.2656862 ustep: 1 
iter: 2  value: 661.4725 mgc: 0.0004152037 ustep: 1 
iter: 3  mgc: 1.39677e-09 
iter: 1  mgc: 1.39677e-09 
outer mgc:  1.067639 
iter: 1  value: 661.8633 mgc: 0.2286092 ustep: 1 
iter: 2  value: 661.8633 mgc: 0.0001949068 ustep: 1 
iter: 3  mgc: 1.693098e-09 
iter: 1  mgc: 1.693098e-09 
outer mgc:  1.461753 
iter: 1  value: 661.6759 mgc: 0.1902694 ustep: 1 
iter: 2  value: 661.6759 mgc: 0.0001176385 ustep: 1 
iter: 3  mgc: 1.245732e-10 
iter: 1  mgc: 1.245732e-10 
outer mgc:  1.427911 
iter: 1  value: 661.7707 mgc: 0.08966484 ustep: 1 
iter: 2  value: 661.7707 mgc: 4.13097e-05 ustep: 1 
iter: 3  mgc: 1.557621e-11 
iter: 1  mgc: 1.557621e-11 
outer mgc:  0.0144108 
iter: 1  value: 661.7719 mgc: 0.001256387 ustep: 1 
iter: 2  mgc: 7.152293e-09 
iter: 1  mgc: 7.152293e-09 
outer mgc:  0.0008856327 
iter: 1  value: 661.772 mgc: 0.000100313 ustep: 1 
iter: 2  mgc: 9.119461e-11 
iter: 1  mgc: 9.119461e-11 
outer mgc:  3.216031e-05 
iter: 1  mgc: 9.119461e-11 
iter: 1  mgc: 9.119461e-11 
outer mgc:  3.216031e-05 
iter: 1  value: 661.7739 mgc: 0.02969336 ustep: 1 
iter: 2  value: 661.7739 mgc: 2.151274e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.7968741 
iter: 1  value: 661.7708 mgc: 0.02968826 ustep: 1 
iter: 2  value: 661.7708 mgc: 2.153876e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.7968348 
iter: 1  value: 661.7724 mgc: 0.0005535275 ustep: 1 
iter: 2  mgc: 2.233014e-09 
outer mgc:  0.019813 
iter: 1  value: 661.7716 mgc: 0.0005540759 ustep: 1 
iter: 2  mgc: 2.236996e-09 
outer mgc:  0.01982058 
iter: 1  value: 661.7727 mgc: 0.0292699 ustep: 1 
iter: 2  value: 661.7727 mgc: 2.574521e-06 ustep: 1 
iter: 3  mgc: 4.418688e-14 
outer mgc:  0.7518989 
iter: 1  value: 661.772 mgc: 0.02926783 ustep: 1 
iter: 2  value: 661.772 mgc: 2.577528e-06 ustep: 1 
iter: 3  mgc: 4.662937e-14 
outer mgc:  0.7519151 
iter: 1  value: 661.7718 mgc: 0.0002039468 ustep: 1 
iter: 2  mgc: 1.352456e-10 
outer mgc:  0.01292456 
iter: 1  value: 661.7722 mgc: 0.000203744 ustep: 1 
iter: 2  mgc: 1.349694e-10 
outer mgc:  0.01292049 
iter: 1  value: 661.7571 mgc: 0.005491969 ustep: 1 
iter: 2  value: 661.7571 mgc: 1.020294e-07 ustep: 1 
iter: 3  mgc: 2.9865e-14 
outer mgc:  0.01252145 
iter: 1  value: 661.7869 mgc: 0.005489732 ustep: 1 
iter: 2  value: 661.7869 mgc: 1.0207e-07 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.01246501 
iter: 1  value: 661.8009 mgc: 0.02869663 ustep: 1 
iter: 2  value: 661.8009 mgc: 3.287498e-06 ustep: 1 
iter: 3  mgc: 1.070255e-13 
outer mgc:  0.3992286 
iter: 1  value: 661.7433 mgc: 0.02877748 ustep: 1 
iter: 2  value: 661.7433 mgc: 3.298259e-06 ustep: 1 
iter: 3  mgc: 1.376677e-13 
outer mgc:  0.3994122 
iter: 1  value: 661.7981 mgc: 0.02548588 ustep: 1 
iter: 2  value: 661.7981 mgc: 2.869741e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
outer mgc:  0.4098181 
iter: 1  value: 661.7462 mgc: 0.02556027 ustep: 1 
iter: 2  value: 661.7462 mgc: 2.880125e-06 ustep: 1 
iter: 3  mgc: 1.008083e-13 
outer mgc:  0.4101534 
[Mon Aug 16 05:20:43 2021]
Finished job 0.
1 of 1 steps (100%) done

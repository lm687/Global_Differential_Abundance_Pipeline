Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 01:21:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_4_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_4_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=4, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_4_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_4_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 5539.632267 
iter  10 value 5166.421969
final  value 5166.420094 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4807.114 mgc: 2.185681 ustep: 1 
iter: 2  value: 4806.485 mgc: 1.4381 ustep: 1 
iter: 3  value: 4806.483 mgc: 0.04877126 ustep: 1 
iter: 4  value: 4806.483 mgc: 0.0002953598 ustep: 1 
iter: 5  value: 4806.483 mgc: 1.065688e-08 ustep: 1 
iter: 6  mgc: 1.498801e-15 
iter: 1  mgc: 1.498801e-15 
Matching hessian patterns... Done
outer mgc:  45.04319 
iter: 1  value: 4751.667 mgc: 1.845028 ustep: 1 
iter: 2  value: 4751.658 mgc: 0.08585912 ustep: 1 
iter: 3  value: 4751.658 mgc: 0.0005981765 ustep: 1 
iter: 4  value: 4751.658 mgc: 1.012021e-08 ustep: 1 
iter: 5  mgc: 3.497203e-15 
iter: 1  value: 4718.709 mgc: 2.183378 ustep: 1 
iter: 2  value: 4718.705 mgc: 0.08457767 ustep: 1 
iter: 3  value: 4718.705 mgc: 0.0005266002 ustep: 1 
iter: 4  value: 4718.705 mgc: 1.93629e-08 ustep: 1 
iter: 5  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  15.33442 
iter: 1  value: 4734.487 mgc: 18.14883 ustep: 1 
iter: 2  value: 4712.034 mgc: 3.413363 ustep: 1 
iter: 3  value: 4711.834 mgc: 0.5854065 ustep: 1 
iter: 4  value: 4711.834 mgc: 0.01192334 ustep: 1 
iter: 5  value: 4711.834 mgc: 3.774349e-06 ustep: 1 
iter: 6  mgc: 1.837974e-13 
iter: 1  mgc: 1.837974e-13 
outer mgc:  26.78409 
iter: 1  value: 4695.649 mgc: 6.629891 ustep: 1 
iter: 2  value: 4695.481 mgc: 0.6114837 ustep: 1 
iter: 3  value: 4695.481 mgc: 0.01424867 ustep: 1 
iter: 4  value: 4695.481 mgc: 1.020753e-05 ustep: 1 
iter: 5  mgc: 6.444845e-12 
iter: 1  mgc: 6.444845e-12 
outer mgc:  22.10904 
iter: 1  value: 4690.68 mgc: 7.698557 ustep: 1 
iter: 2  value: 4690.199 mgc: 0.8333984 ustep: 1 
iter: 3  value: 4690.198 mgc: 0.06473959 ustep: 1 
iter: 4  value: 4690.198 mgc: 0.0001305227 ustep: 1 
iter: 5  mgc: 3.26733e-09 
iter: 1  mgc: 3.26733e-09 
outer mgc:  23.76799 
iter: 1  value: 4683.192 mgc: 3.157873 ustep: 1 
iter: 2  value: 4683.084 mgc: 0.3328161 ustep: 1 
iter: 3  value: 4683.084 mgc: 0.003829013 ustep: 1 
iter: 4  value: 4683.084 mgc: 4.857422e-07 ustep: 1 
iter: 5  mgc: 1.088019e-14 
iter: 1  mgc: 1.088019e-14 
outer mgc:  9.977106 
iter: 1  value: 4684.041 mgc: 3.804293 ustep: 1 
iter: 2  value: 4684.027 mgc: 0.1881326 ustep: 1 
iter: 3  value: 4684.027 mgc: 0.0003983782 ustep: 1 
iter: 4  mgc: 4.260188e-09 
iter: 1  value: 4680.021 mgc: 1.50479 ustep: 1 
iter: 2  value: 4680.02 mgc: 0.02057137 ustep: 1 
iter: 3  value: 4680.02 mgc: 1.359259e-05 ustep: 1 
iter: 4  mgc: 2.161382e-12 
iter: 1  mgc: 2.161382e-12 
outer mgc:  6.967222 
iter: 1  value: 4678.389 mgc: 1.750986 ustep: 1 
iter: 2  value: 4678.389 mgc: 0.02134574 ustep: 1 
iter: 3  value: 4678.389 mgc: 2.278632e-05 ustep: 1 
iter: 4  mgc: 2.814105e-11 
iter: 1  mgc: 2.814105e-11 
outer mgc:  5.597575 
iter: 1  value: 4675.085 mgc: 2.444649 ustep: 1 
iter: 2  value: 4675.083 mgc: 0.07568633 ustep: 1 
iter: 3  value: 4675.083 mgc: 9.710634e-05 ustep: 1 
iter: 4  mgc: 6.337388e-10 
iter: 1  mgc: 6.337388e-10 
outer mgc:  5.948889 
iter: 1  value: 4673.001 mgc: 2.098752 ustep: 1 
iter: 2  value: 4673 mgc: 0.0853489 ustep: 1 
iter: 3  value: 4673 mgc: 0.0001167997 ustep: 1 
iter: 4  mgc: 2.221549e-10 
iter: 1  mgc: 2.221549e-10 
outer mgc:  8.348961 
iter: 1  value: 4670.868 mgc: 3.134189 ustep: 1 
iter: 2  value: 4670.867 mgc: 0.05832527 ustep: 1 
iter: 3  value: 4670.867 mgc: 2.955813e-05 ustep: 1 
iter: 4  mgc: 9.148238e-12 
iter: 1  mgc: 9.148238e-12 
outer mgc:  6.365353 
iter: 1  value: 4670.74 mgc: 4.568975 ustep: 1 
iter: 2  value: 4670.74 mgc: 0.05726216 ustep: 1 
iter: 3  value: 4670.74 mgc: 3.934361e-05 ustep: 1 
iter: 4  mgc: 1.437064e-10 
iter: 1  mgc: 1.437064e-10 
outer mgc:  4.194233 
iter: 1  value: 4666.935 mgc: 1.923469 ustep: 1 
iter: 2  value: 4666.935 mgc: 0.01500058 ustep: 1 
iter: 3  value: 4666.935 mgc: 7.189493e-06 ustep: 1 
iter: 4  mgc: 1.528111e-12 
iter: 1  value: 4668.927 mgc: 0.6941679 ustep: 1 
iter: 2  value: 4668.926 mgc: 0.01277086 ustep: 1 
iter: 3  value: 4668.926 mgc: 4.041602e-06 ustep: 1 
iter: 4  mgc: 4.161116e-13 
iter: 1  mgc: 4.161116e-13 
outer mgc:  2.315227 
iter: 1  value: 4667.908 mgc: 1.082617 ustep: 1 
iter: 2  value: 4667.908 mgc: 0.01870484 ustep: 1 
iter: 3  value: 4667.908 mgc: 9.917055e-06 ustep: 1 
iter: 4  mgc: 2.783329e-12 
iter: 1  value: 4668.426 mgc: 0.3880808 ustep: 1 
iter: 2  value: 4668.426 mgc: 0.002325358 ustep: 1 
iter: 3  value: 4668.426 mgc: 1.421231e-07 ustep: 1 
iter: 4  mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  1.128925 
iter: 1  value: 4668.052 mgc: 0.2716633 ustep: 1 
iter: 2  value: 4668.052 mgc: 0.0006563523 ustep: 1 
iter: 3  value: 4668.052 mgc: 1.38433e-08 ustep: 1 
mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.9630899 
iter: 1  value: 4667.629 mgc: 0.4658177 ustep: 1 
iter: 2  value: 4667.629 mgc: 0.0009748632 ustep: 1 
iter: 3  value: 4667.629 mgc: 2.556504e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  0.6241193 
iter: 1  value: 4667.186 mgc: 0.1983439 ustep: 1 
iter: 2  value: 4667.186 mgc: 0.0002070214 ustep: 1 
iter: 3  mgc: 8.721051e-10 
iter: 1  mgc: 8.721051e-10 
outer mgc:  0.4289257 
iter: 1  value: 4666.651 mgc: 0.380881 ustep: 1 
iter: 2  value: 4666.651 mgc: 0.0004512704 ustep: 1 
iter: 3  mgc: 3.02202e-09 
iter: 1  mgc: 3.02202e-09 
outer mgc:  0.5136769 
iter: 1  value: 4666.127 mgc: 0.3405949 ustep: 1 
iter: 2  value: 4666.127 mgc: 0.0002345818 ustep: 1 
iter: 3  mgc: 1.384414e-09 
iter: 1  mgc: 1.384414e-09 
outer mgc:  0.6782085 
iter: 1  value: 4665.468 mgc: 0.2373353 ustep: 1 
iter: 2  value: 4665.468 mgc: 0.0004772093 ustep: 1 
iter: 3  mgc: 5.676126e-09 
iter: 1  mgc: 5.676126e-09 
outer mgc:  0.2426233 
iter: 1  value: 4664.885 mgc: 0.3742338 ustep: 1 
iter: 2  value: 4664.885 mgc: 0.0003627794 ustep: 1 
iter: 3  mgc: 1.397308e-09 
iter: 1  mgc: 1.397308e-09 
outer mgc:  0.4945445 
iter: 1  value: 4664.66 mgc: 0.2287892 ustep: 1 
iter: 2  value: 4664.66 mgc: 0.0001412689 ustep: 1 
iter: 3  mgc: 1.783123e-10 
iter: 1  mgc: 1.783123e-10 
outer mgc:  0.1779162 
iter: 1  value: 4664.164 mgc: 0.2109642 ustep: 1 
iter: 2  value: 4664.164 mgc: 0.0001658272 ustep: 1 
iter: 3  mgc: 1.028829e-09 
iter: 1  mgc: 1.028829e-09 
outer mgc:  0.1445311 
iter: 1  value: 4663.442 mgc: 0.2781282 ustep: 1 
iter: 2  value: 4663.442 mgc: 0.0002372101 ustep: 1 
iter: 3  mgc: 1.071881e-09 
iter: 1  mgc: 1.071881e-09 
outer mgc:  0.1511219 
iter: 1  value: 4662.999 mgc: 0.1472831 ustep: 1 
iter: 2  value: 4662.999 mgc: 6.676412e-05 ustep: 1 
iter: 3  mgc: 2.756217e-11 
iter: 1  mgc: 2.756217e-11 
outer mgc:  0.1826448 
iter: 1  value: 4662.605 mgc: 0.1539201 ustep: 1 
iter: 2  value: 4662.605 mgc: 3.893459e-05 ustep: 1 
iter: 3  mgc: 2.667887e-11 
iter: 1  mgc: 2.667887e-11 
outer mgc:  0.172312 
iter: 1  value: 4662.272 mgc: 0.141725 ustep: 1 
iter: 2  value: 4662.272 mgc: 7.810674e-05 ustep: 1 
iter: 3  mgc: 1.616405e-10 
iter: 1  mgc: 1.616405e-10 
outer mgc:  0.1009788 
iter: 1  value: 4661.856 mgc: 0.1763353 ustep: 1 
iter: 2  value: 4661.856 mgc: 2.324874e-05 ustep: 1 
iter: 3  mgc: 6.93845e-12 
iter: 1  value: 4660.628 mgc: 0.5356915 ustep: 1 
iter: 2  value: 4660.628 mgc: 0.0001514243 ustep: 1 
iter: 3  mgc: 3.882423e-10 
iter: 1  mgc: 3.882423e-10 
outer mgc:  0.1292158 
iter: 1  value: 4659.137 mgc: 0.7499765 ustep: 1 
iter: 2  value: 4659.137 mgc: 0.0002771731 ustep: 1 
iter: 3  mgc: 8.967662e-10 
iter: 1  mgc: 8.967662e-10 
outer mgc:  0.07336291 
iter: 1  value: 4658.052 mgc: 0.6916818 ustep: 1 
iter: 2  value: 4658.052 mgc: 9.695007e-05 ustep: 1 
iter: 3  mgc: 2.800618e-10 
iter: 1  mgc: 2.800618e-10 
outer mgc:  0.09958963 
iter: 1  value: 4656.905 mgc: 0.6483958 ustep: 1 
iter: 2  value: 4656.905 mgc: 8.910184e-05 ustep: 1 
iter: 3  mgc: 5.984602e-11 
iter: 1  mgc: 5.984602e-11 
outer mgc:  0.06584879 
iter: 1  value: 4655.713 mgc: 0.6215502 ustep: 1 
iter: 2  value: 4655.713 mgc: 0.0001091627 ustep: 1 
iter: 3  mgc: 9.833645e-11 
iter: 1  mgc: 9.833645e-11 
outer mgc:  0.0530134 
iter: 1  value: 4654.622 mgc: 0.656206 ustep: 1 
iter: 2  value: 4654.622 mgc: 7.147226e-05 ustep: 1 
iter: 3  mgc: 1.56579e-10 
iter: 1  mgc: 1.56579e-10 
outer mgc:  0.07822105 
iter: 1  value: 4653.826 mgc: 0.4306863 ustep: 1 
iter: 2  value: 4653.826 mgc: 2.83718e-05 ustep: 1 
iter: 3  mgc: 1.638378e-11 
iter: 1  mgc: 1.638378e-11 
outer mgc:  0.05584985 
iter: 1  value: 4653.47 mgc: 0.1608867 ustep: 1 
iter: 2  value: 4653.47 mgc: 8.691939e-06 ustep: 1 
iter: 3  mgc: 5.265788e-13 
iter: 1  mgc: 5.265788e-13 
outer mgc:  0.01334639 
iter: 1  value: 4653.322 mgc: 0.08073548 ustep: 1 
iter: 2  value: 4653.322 mgc: 1.702492e-06 ustep: 1 
iter: 3  mgc: 1.092459e-13 
iter: 1  mgc: 1.092459e-13 
outer mgc:  0.01205532 
iter: 1  value: 4653.268 mgc: 0.0320108 ustep: 1 
iter: 2  value: 4653.268 mgc: 8.926664e-07 ustep: 1 
iter: 3  mgc: 9.65894e-15 
iter: 1  mgc: 9.65894e-15 
outer mgc:  0.002453058 
iter: 1  value: 4653.217 mgc: 0.01883619 ustep: 1 
iter: 2  value: 4653.217 mgc: 9.249495e-08 ustep: 1 
iter: 3  mgc: 1.398881e-14 
iter: 1  mgc: 1.398881e-14 
outer mgc:  0.00144274 
iter: 1  value: 4653.137 mgc: 0.03577345 ustep: 1 
iter: 2  value: 4653.137 mgc: 2.738842e-07 ustep: 1 
iter: 3  mgc: 1.210143e-14 
iter: 1  mgc: 1.210143e-14 
outer mgc:  0.0005394534 
iter: 1  value: 4653.139 mgc: 0.003576657 ustep: 1 
iter: 2  mgc: 3.349472e-09 
iter: 1  mgc: 3.349472e-09 
outer mgc:  0.000111498 
iter: 1  mgc: 3.349472e-09 
iter: 1  mgc: 3.349472e-09 
outer mgc:  0.000111498 
iter: 1  value: 4653.14 mgc: 0.006647671 ustep: 1 
iter: 2  value: 4653.14 mgc: 2.597743e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.07222767 
iter: 1  value: 4653.138 mgc: 0.006646402 ustep: 1 
iter: 2  value: 4653.138 mgc: 2.598976e-07 ustep: 1 
iter: 3  mgc: 8.548717e-15 
outer mgc:  0.07228247 
iter: 1  value: 4653.14 mgc: 0.003411377 ustep: 1 
iter: 2  value: 4653.14 mgc: 8.088677e-08 ustep: 1 
iter: 3  mgc: 8.992806e-15 
outer mgc:  0.04817406 
iter: 1  value: 4653.139 mgc: 0.003410831 ustep: 1 
iter: 2  value: 4653.139 mgc: 8.090126e-08 ustep: 1 
iter: 3  mgc: 1.24345e-14 
outer mgc:  0.04827891 
iter: 1  value: 4653.139 mgc: 0.005073094 ustep: 1 
iter: 2  value: 4653.139 mgc: 4.673466e-07 ustep: 1 
iter: 3  mgc: 1.132427e-14 
outer mgc:  0.04760339 
iter: 1  value: 4653.14 mgc: 0.005069022 ustep: 1 
iter: 2  value: 4653.14 mgc: 4.68058e-07 ustep: 1 
iter: 3  mgc: 1.132427e-14 
outer mgc:  0.04767787 
iter: 1  value: 4653.139 mgc: 0.003402273 ustep: 1 
iter: 2  value: 4653.139 mgc: 1.964952e-07 ustep: 1 
iter: 3  mgc: 1.576517e-14 
outer mgc:  0.03460641 
iter: 1  value: 4653.14 mgc: 0.003400899 ustep: 1 
iter: 2  value: 4653.14 mgc: 1.965541e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.03453041 
iter: 1  value: 4653.14 mgc: 0.00599105 ustep: 1 
iter: 2  value: 4653.14 mgc: 1.752361e-07 ustep: 1 
iter: 3  mgc: 2.320366e-14 
outer mgc:  0.06566876 
iter: 1  value: 4653.139 mgc: 0.005987736 ustep: 1 
iter: 2  value: 4653.139 mgc: 1.751014e-07 ustep: 1 
iter: 3  mgc: 1.44329e-14 
outer mgc:  0.06556283 
iter: 1  value: 4653.14 mgc: 0.003440724 ustep: 1 
iter: 2  value: 4653.14 mgc: 5.678582e-08 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.03449971 
iter: 1  value: 4653.139 mgc: 0.003439106 ustep: 1 
iter: 2  value: 4653.139 mgc: 5.675179e-08 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.0344436 
iter: 1  value: 4653.148 mgc: 0.06046099 ustep: 1 
iter: 2  value: 4653.148 mgc: 1.190537e-06 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.01890065 
iter: 1  value: 4653.131 mgc: 0.06052149 ustep: 1 
iter: 2  value: 4653.131 mgc: 1.190191e-06 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.01908639 
iter: 1  value: 4653.153 mgc: 0.01214135 ustep: 1 
iter: 2  value: 4653.153 mgc: 5.54759e-07 ustep: 1 
iter: 3  mgc: 1.421085e-14 
outer mgc:  0.005921208 
iter: 1  value: 4653.126 mgc: 0.0121535 ustep: 1 
iter: 2  value: 4653.126 mgc: 5.539364e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.005855096 
iter: 1  value: 4653.157 mgc: 0.04817681 ustep: 1 
iter: 2  value: 4653.157 mgc: 6.315935e-07 ustep: 1 
iter: 3  mgc: 9.103829e-15 
outer mgc:  0.006987584 
iter: 1  value: 4653.122 mgc: 0.04832312 ustep: 1 
iter: 2  value: 4653.122 mgc: 6.312957e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.006865426 
iter: 1  value: 4653.135 mgc: 0.01162566 ustep: 1 
iter: 2  value: 4653.135 mgc: 2.47208e-07 ustep: 1 
iter: 3  mgc: 1.104672e-14 
outer mgc:  0.004313045 
iter: 1  value: 4653.143 mgc: 0.01163189 ustep: 1 
iter: 2  value: 4653.143 mgc: 2.470021e-07 ustep: 1 
iter: 3  mgc: 2.120526e-14 
outer mgc:  0.00437324 
iter: 1  value: 4653.135 mgc: 0.003973065 ustep: 1 
iter: 2  mgc: 6.013374e-09 
outer mgc:  0.0004543262 
iter: 1  value: 4653.144 mgc: 0.003971833 ustep: 1 
iter: 2  mgc: 6.019635e-09 
outer mgc:  0.0003786937 
iter: 1  value: 4653.142 mgc: 0.009429195 ustep: 1 
iter: 2  value: 4653.142 mgc: 2.819329e-08 ustep: 1 
mgc: 1.509903e-14 
outer mgc:  0.0007456035 
iter: 1  value: 4653.137 mgc: 0.009430216 ustep: 1 
iter: 2  value: 4653.137 mgc: 2.81684e-08 ustep: 1 
mgc: 1.221245e-14 
outer mgc:  0.0006694442 
iter: 1  value: 4653.132 mgc: 0.004995915 ustep: 1 
iter: 2  value: 4653.132 mgc: 1.929859e-07 ustep: 1 
iter: 3  mgc: 9.048318e-15 
outer mgc:  0.03744838 
iter: 1  value: 4653.146 mgc: 0.00499299 ustep: 1 
iter: 2  value: 4653.146 mgc: 1.927442e-07 ustep: 1 
iter: 3  mgc: 1.376677e-14 
outer mgc:  0.03737091 
[Sun Aug 15 01:21:46 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:04:24 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22189.771007 
iter  10 value 16302.949222
final  value 16302.344038 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 16021.54 mgc: 3.83917 ustep: 0.6827823 
iter: 2  value: 16014.19 mgc: 4.116939 ustep: 0.8263238 
iter: 3  value: 15964.52 mgc: 4.854868 ustep: 0.2388738 
iter: 4  value: 15930.43 mgc: 4.42315 ustep: 0.4887983 
iter: 5  value: 15930.39 mgc: 3.872866 ustep: 0.6991712 
iter: 6  value: 15919.35 mgc: 4.961138 ustep: 0.2629471 
iter: 7  value: 15918.62 mgc: 1.216704 ustep: 0.5128324 
iter: 8  value: 15918.3 mgc: 0.5109472 ustep: 0.7161515 
iter: 9  value: 15918.25 mgc: 0.1739607 ustep: 0.8462727 
iter: 10  value: 15918.24 mgc: 0.03668939 ustep: 0.9199388 
iter: 11  value: 15918.24 mgc: 0.004138195 ustep: 0.9591385 
iter: 12  value: 15918.24 mgc: 0.0002501956 ustep: 0.9793582 
iter: 13  value: 15918.24 mgc: 8.012799e-06 ustep: 0.9896263 
iter: 14  value: 15918.24 mgc: 1.319725e-07 ustep: 0.9948002 
iter: 15  mgc: 1.098213e-09 
iter: 1  mgc: 1.098213e-09 
Matching hessian patterns... Done
outer mgc:  192.9511 
iter: 1  value: 15832.43 mgc: 1.067395 ustep: 1 
iter: 2  value: 15832.3 mgc: 0.08941273 ustep: 1 
iter: 3  value: 15832.3 mgc: 0.0007375429 ustep: 1 
iter: 4  value: 15832.3 mgc: 4.850141e-08 ustep: 1 
iter: 5  mgc: 1.665335e-15 
iter: 1  mgc: 1.665335e-15 
outer mgc:  91.97064 
iter: 1  value: 15728.49 mgc: 1.065641 ustep: 1 
iter: 2  value: 15728.35 mgc: 0.1084995 ustep: 1 
iter: 3  value: 15728.35 mgc: 0.0005523272 ustep: 1 
iter: 4  value: 15728.35 mgc: 4.309406e-08 ustep: 1 
iter: 5  mgc: 1.668804e-15 
iter: 1  mgc: 1.668804e-15 
outer mgc:  91.33599 
iter: 1  value: 15614.5 mgc: 1.768625 ustep: 1 
iter: 2  value: 15614.43 mgc: 0.08622056 ustep: 1 
iter: 3  value: 15614.43 mgc: 0.0002794074 ustep: 1 
iter: 4  mgc: 1.988274e-09 
iter: 1  mgc: 1.988274e-09 
outer mgc:  86.43378 
iter: 1  value: 15427.22 mgc: 5.788276 ustep: 1 
iter: 2  value: 15427.13 mgc: 0.2260345 ustep: 1 
iter: 3  value: 15427.13 mgc: 0.003164366 ustep: 1 
iter: 4  value: 15427.13 mgc: 6.417812e-07 ustep: 1 
iter: 5  mgc: 2.731149e-14 
iter: 1  mgc: 2.731149e-14 
outer mgc:  131.4608 
iter: 1  value: 15204.96 mgc: 5.870133 ustep: 1 
iter: 2  value: 15199.1 mgc: 1.301082 ustep: 1 
iter: 3  value: 15199.1 mgc: 0.03135236 ustep: 1 
iter: 4  value: 15199.1 mgc: 2.217209e-05 ustep: 1 
iter: 5  mgc: 4.029826e-11 
iter: 1  mgc: 4.029826e-11 
outer mgc:  70.81486 
iter: 1  value: 15037.13 mgc: 2.871936 ustep: 1 
iter: 2  value: 15037.13 mgc: 0.01254126 ustep: 1 
iter: 3  value: 15037.13 mgc: 1.542839e-06 ustep: 1 
iter: 4  mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  47.5359 
iter: 1  value: 15092.62 mgc: 5.982217 ustep: 1 
iter: 2  value: 15092.62 mgc: 0.06876604 ustep: 1 
iter: 3  value: 15092.62 mgc: 1.028793e-05 ustep: 1 
iter: 4  mgc: 3.017586e-13 
iter: 1  value: 15010.98 mgc: 1.904638 ustep: 1 
iter: 2  value: 15010.98 mgc: 0.00860204 ustep: 1 
iter: 3  value: 15010.98 mgc: 1.613344e-07 ustep: 1 
iter: 4  mgc: 2.94903e-15 
iter: 1  mgc: 2.94903e-15 
outer mgc:  81.36301 
iter: 1  value: 14964.78 mgc: 1.845963 ustep: 1 
iter: 2  value: 14964.78 mgc: 0.00606594 ustep: 1 
iter: 3  value: 14964.78 mgc: 2.541115e-07 ustep: 1 
iter: 4  mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  54.05248 
iter: 1  value: 14926.07 mgc: 1.618134 ustep: 1 
iter: 2  value: 14926.07 mgc: 0.003457218 ustep: 1 
iter: 3  value: 14926.07 mgc: 1.146428e-07 ustep: 1 
iter: 4  mgc: 3.691492e-15 
iter: 1  mgc: 3.691492e-15 
outer mgc:  61.06814 
iter: 1  value: 14843.37 mgc: 2.74325 ustep: 1 
iter: 2  value: 14843.37 mgc: 0.01455125 ustep: 1 
iter: 3  value: 14843.37 mgc: 4.36103e-06 ustep: 1 
iter: 4  mgc: 2.069456e-13 
iter: 1  mgc: 2.069456e-13 
outer mgc:  42.18897 
iter: 1  value: 14783.69 mgc: 15.12028 ustep: 1 
iter: 2  value: 14783.69 mgc: 0.00686914 ustep: 1 
iter: 3  value: 14783.69 mgc: 6.981956e-08 ustep: 1 
iter: 4  mgc: 3.774758e-15 
iter: 1  mgc: 3.774758e-15 
outer mgc:  77.33396 
iter: 1  value: 14741.93 mgc: 5.726299 ustep: 1 
iter: 2  value: 14741.93 mgc: 0.0249251 ustep: 1 
iter: 3  value: 14741.93 mgc: 2.739074e-06 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  34.81651 
iter: 1  value: 14752.59 mgc: 6.192962 ustep: 1 
iter: 2  value: 14752.58 mgc: 0.163 ustep: 1 
iter: 3  value: 14752.58 mgc: 0.0004832952 ustep: 1 
iter: 4  mgc: 5.38656e-09 
iter: 1  mgc: 5.38656e-09 
outer mgc:  38.09925 
iter: 1  value: 14812.43 mgc: 3.534607 ustep: 1 
iter: 2  value: 14812.43 mgc: 0.0871836 ustep: 1 
iter: 3  value: 14812.43 mgc: 0.0001795969 ustep: 1 
iter: 4  mgc: 1.634173e-09 
iter: 1  value: 14746.04 mgc: 1.540097 ustep: 1 
iter: 2  value: 14746.04 mgc: 0.003348137 ustep: 1 
iter: 3  value: 14746.04 mgc: 6.628548e-08 ustep: 1 
iter: 4  mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  48.62234 
iter: 1  value: 14768.32 mgc: 2.090659 ustep: 1 
iter: 2  value: 14768.32 mgc: 0.005177911 ustep: 1 
iter: 3  value: 14768.32 mgc: 1.177331e-07 ustep: 1 
iter: 4  mgc: 5.440093e-15 
iter: 1  value: 14744.34 mgc: 1.237578 ustep: 1 
iter: 2  value: 14744.34 mgc: 0.0009109666 ustep: 1 
iter: 3  mgc: 4.078434e-09 
iter: 1  mgc: 4.078434e-09 
outer mgc:  36.31898 
iter: 1  value: 14751.89 mgc: 1.058457 ustep: 1 
iter: 2  value: 14751.89 mgc: 0.002657306 ustep: 1 
iter: 3  value: 14751.89 mgc: 6.561285e-08 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  6.921509 
iter: 1  value: 14749.16 mgc: 0.4493062 ustep: 1 
iter: 2  value: 14749.16 mgc: 0.0006474119 ustep: 1 
iter: 3  mgc: 4.960568e-09 
iter: 1  mgc: 4.960568e-09 
outer mgc:  8.922819 
iter: 1  value: 14757.78 mgc: 0.4823956 ustep: 1 
iter: 2  value: 14757.78 mgc: 0.002622744 ustep: 1 
iter: 3  value: 14757.78 mgc: 1.717763e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  11.0628 
iter: 1  value: 14782.52 mgc: 1.618743 ustep: 1 
iter: 2  value: 14782.52 mgc: 0.03842488 ustep: 1 
iter: 3  value: 14782.52 mgc: 4.758278e-05 ustep: 1 
iter: 4  mgc: 7.969003e-11 
iter: 1  mgc: 7.969003e-11 
outer mgc:  11.71808 
iter: 1  value: 14799.99 mgc: 2.645423 ustep: 1 
iter: 2  value: 14799.99 mgc: 0.04733405 ustep: 1 
iter: 3  value: 14799.99 mgc: 0.0001419483 ustep: 1 
iter: 4  mgc: 8.241172e-10 
iter: 1  mgc: 8.241172e-10 
outer mgc:  5.960338 
iter: 1  value: 14792.87 mgc: 4.148091 ustep: 1 
iter: 2  value: 14792.87 mgc: 0.01908169 ustep: 1 
iter: 3  value: 14792.87 mgc: 1.644324e-05 ustep: 1 
iter: 4  mgc: 9.313439e-12 
iter: 1  value: 14795.88 mgc: 2.384948 ustep: 1 
iter: 2  value: 14795.88 mgc: 0.008929953 ustep: 1 
iter: 3  value: 14795.88 mgc: 3.736854e-06 ustep: 1 
iter: 4  mgc: 4.520828e-13 
iter: 1  value: 14798.23 mgc: 0.7701566 ustep: 1 
iter: 2  value: 14798.23 mgc: 0.0009384563 ustep: 1 
iter: 3  value: 14798.23 mgc: 5.495965e-08 ustep: 1 
iter: 4  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  9.440834 
iter: 1  value: 14796.22 mgc: 0.3564206 ustep: 1 
iter: 2  value: 14796.22 mgc: 0.0002482471 ustep: 1 
iter: 3  mgc: 1.019398e-10 
iter: 1  mgc: 1.019398e-10 
outer mgc:  3.836012 
iter: 1  value: 14794.45 mgc: 0.2241002 ustep: 1 
iter: 2  value: 14794.45 mgc: 4.596292e-05 ustep: 1 
iter: 3  mgc: 2.135181e-11 
iter: 1  value: 14792.29 mgc: 0.2808096 ustep: 1 
iter: 2  value: 14792.29 mgc: 9.827657e-05 ustep: 1 
iter: 3  mgc: 2.791545e-10 
iter: 1  value: 14785.31 mgc: 0.9001299 ustep: 1 
iter: 2  value: 14785.31 mgc: 0.0008786056 ustep: 1 
iter: 3  mgc: 9.346276e-09 
iter: 1  mgc: 9.346276e-09 
outer mgc:  4.043828 
iter: 1  value: 14794.8 mgc: 2.586522 ustep: 1 
iter: 2  value: 14794.8 mgc: 0.01911908 ustep: 1 
iter: 3  value: 14794.8 mgc: 4.597191e-06 ustep: 1 
iter: 4  mgc: 9.325873e-13 
iter: 1  mgc: 9.325873e-13 
outer mgc:  5.617034 
iter: 1  value: 14796.87 mgc: 2.414275 ustep: 1 
iter: 2  value: 14796.87 mgc: 0.02234241 ustep: 1 
iter: 3  value: 14796.87 mgc: 2.725486e-05 ustep: 1 
iter: 4  mgc: 2.902567e-11 
iter: 1  mgc: 2.902567e-11 
outer mgc:  3.074898 
iter: 1  value: 14793.86 mgc: 1.433409 ustep: 1 
iter: 2  value: 14793.86 mgc: 0.00801735 ustep: 1 
iter: 3  value: 14793.86 mgc: 2.521031e-06 ustep: 1 
iter: 4  mgc: 1.607603e-13 
iter: 1  value: 14795.71 mgc: 0.972539 ustep: 1 
iter: 2  value: 14795.71 mgc: 0.0016555 ustep: 1 
iter: 3  value: 14795.71 mgc: 1.770608e-07 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  1.328999 
iter: 1  value: 14795.28 mgc: 0.1077993 ustep: 1 
iter: 2  value: 14795.28 mgc: 0.000212082 ustep: 1 
iter: 3  mgc: 9.169034e-10 
iter: 1  mgc: 9.169034e-10 
outer mgc:  1.019938 
iter: 1  value: 14795.33 mgc: 0.1907048 ustep: 1 
iter: 2  value: 14795.33 mgc: 0.000126953 ustep: 1 
iter: 3  mgc: 4.239724e-10 
iter: 1  mgc: 4.239724e-10 
outer mgc:  0.3764826 
iter: 1  value: 14795.89 mgc: 0.1120507 ustep: 1 
iter: 2  value: 14795.89 mgc: 4.76267e-05 ustep: 1 
iter: 3  mgc: 9.031886e-11 
iter: 1  mgc: 9.031886e-11 
outer mgc:  0.3437698 
iter: 1  value: 14796.7 mgc: 0.1726003 ustep: 1 
iter: 2  value: 14796.7 mgc: 5.65455e-05 ustep: 1 
iter: 3  mgc: 8.003376e-12 
iter: 1  mgc: 8.003376e-12 
outer mgc:  0.3530332 
iter: 1  value: 14796.34 mgc: 0.06412931 ustep: 1 
iter: 2  value: 14796.34 mgc: 1.223287e-05 ustep: 1 
iter: 3  mgc: 7.370105e-12 
iter: 1  mgc: 7.370105e-12 
outer mgc:  0.1071767 
iter: 1  value: 14796.35 mgc: 0.01116471 ustep: 1 
iter: 2  value: 14796.35 mgc: 2.268164e-06 ustep: 1 
iter: 3  mgc: 1.629807e-13 
iter: 1  mgc: 1.629807e-13 
outer mgc:  0.0450093 
iter: 1  value: 14796.39 mgc: 0.01014241 ustep: 1 
iter: 2  value: 14796.39 mgc: 2.050185e-07 ustep: 1 
iter: 3  mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  0.006079155 
iter: 1  value: 14796.39 mgc: 0.001087936 ustep: 1 
iter: 2  mgc: 2.519396e-09 
iter: 1  mgc: 2.519396e-09 
outer mgc:  0.0006030785 
iter: 1  mgc: 2.519396e-09 
iter: 1  mgc: 2.519396e-09 
outer mgc:  0.0006030785 
iter: 1  value: 14796.39 mgc: 0.00572497 ustep: 1 
iter: 2  value: 14796.39 mgc: 1.063248e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.2942992 
iter: 1  value: 14796.39 mgc: 0.005723131 ustep: 1 
iter: 2  value: 14796.39 mgc: 1.066624e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.2934493 
iter: 1  value: 14796.39 mgc: 0.003387368 ustep: 1 
iter: 2  value: 14796.39 mgc: 2.991124e-08 ustep: 1 
iter: 3  mgc: 1.146305e-14 
outer mgc:  0.2201561 
iter: 1  value: 14796.38 mgc: 0.003387844 ustep: 1 
iter: 2  value: 14796.38 mgc: 3.00435e-08 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.2197857 
iter: 1  value: 14796.39 mgc: 0.006641501 ustep: 1 
iter: 2  value: 14796.39 mgc: 1.24224e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.3733993 
iter: 1  value: 14796.38 mgc: 0.00664175 ustep: 1 
iter: 2  value: 14796.38 mgc: 1.235219e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.3745851 
iter: 1  value: 14796.38 mgc: 0.003364899 ustep: 1 
iter: 2  value: 14796.38 mgc: 2.747208e-08 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.2189806 
iter: 1  value: 14796.39 mgc: 0.003364328 ustep: 1 
iter: 2  value: 14796.39 mgc: 2.73427e-08 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.2193464 
iter: 1  value: 14796.46 mgc: 0.01515016 ustep: 1 
iter: 2  value: 14796.46 mgc: 6.430755e-07 ustep: 1 
iter: 3  mgc: 7.882583e-15 
outer mgc:  0.06474421 
iter: 1  value: 14796.32 mgc: 0.01518716 ustep: 1 
iter: 2  value: 14796.32 mgc: 6.440627e-07 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.06466448 
iter: 1  value: 14796.44 mgc: 0.0200762 ustep: 1 
iter: 2  value: 14796.44 mgc: 8.774018e-07 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.07959621 
iter: 1  value: 14796.33 mgc: 0.0201297 ustep: 1 
iter: 2  value: 14796.33 mgc: 8.767248e-07 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.07986879 
iter: 1  value: 14796.36 mgc: 0.003792546 ustep: 1 
iter: 2  value: 14796.36 mgc: 3.037335e-08 ustep: 1 
mgc: 9.769963e-15 
outer mgc:  0.007407768 
iter: 1  value: 14796.42 mgc: 0.003790649 ustep: 1 
iter: 2  value: 14796.42 mgc: 3.041117e-08 ustep: 1 
mgc: 9.880985e-15 
outer mgc:  0.0069077 
iter: 1  value: 14796.36 mgc: 0.00501245 ustep: 1 
iter: 2  value: 14796.36 mgc: 1.264635e-07 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.09326957 
iter: 1  value: 14796.41 mgc: 0.005009219 ustep: 1 
iter: 2  value: 14796.41 mgc: 1.262893e-07 ustep: 1 
iter: 3  mgc: 9.325873e-15 
outer mgc:  0.09277567 
[Mon Aug 16 08:04:28 2021]
Finished job 0.
1 of 1 steps (100%) done

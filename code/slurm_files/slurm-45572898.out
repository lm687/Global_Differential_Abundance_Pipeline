Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:26:00 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4441.689483 
iter  10 value 4050.224891
final  value 4050.224760 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3873.455 mgc: 2.762543 ustep: 1 
iter: 2  value: 3872.085 mgc: 1.94167 ustep: 1 
iter: 3  value: 3872.082 mgc: 0.09606389 ustep: 1 
iter: 4  value: 3872.082 mgc: 0.0003188935 ustep: 1 
iter: 5  value: 3872.082 mgc: 1.87956e-08 ustep: 1 
iter: 6  mgc: 1.554312e-15 
iter: 1  mgc: 1.554312e-15 
Matching hessian patterns... Done
outer mgc:  17.96194 
iter: 1  value: 3837.878 mgc: 0.7986001 ustep: 1 
iter: 2  value: 3837.875 mgc: 0.06127842 ustep: 1 
iter: 3  value: 3837.875 mgc: 0.0001097888 ustep: 1 
iter: 4  mgc: 3.572656e-10 
iter: 1  value: 3796.56 mgc: 16.14916 ustep: 1 
iter: 2  value: 3795.657 mgc: 1.175484 ustep: 1 
iter: 3  value: 3795.657 mgc: 0.08918094 ustep: 1 
iter: 4  value: 3795.657 mgc: 2.807187e-05 ustep: 1 
iter: 5  mgc: 1.328626e-11 
iter: 1  mgc: 1.328626e-11 
outer mgc:  43.20839 
iter: 1  value: 3843.459 mgc: 63.30694 ustep: 1 
iter: 2  value: 3843.443 mgc: 0.837898 ustep: 1 
iter: 3  value: 3843.443 mgc: 0.000751332 ustep: 1 
iter: 4  mgc: 6.120953e-10 
iter: 1  value: 3787.36 mgc: 4.686509 ustep: 1 
iter: 2  value: 3787.335 mgc: 0.174787 ustep: 1 
iter: 3  value: 3787.335 mgc: 0.001602675 ustep: 1 
iter: 4  value: 3787.335 mgc: 8.582901e-08 ustep: 1 
iter: 5  mgc: 3.663736e-15 
iter: 1  mgc: 3.663736e-15 
outer mgc:  37.61872 
iter: 1  value: 3775.302 mgc: 5.884031 ustep: 1 
iter: 2  value: 3775.253 mgc: 0.3022333 ustep: 1 
iter: 3  value: 3775.253 mgc: 0.002653401 ustep: 1 
iter: 4  value: 3775.253 mgc: 4.417546e-08 ustep: 1 
iter: 5  mgc: 3.663736e-15 
iter: 1  mgc: 3.663736e-15 
outer mgc:  25.26855 
iter: 1  value: 3746.938 mgc: 7.326176 ustep: 1 
iter: 2  value: 3746.938 mgc: 0.06406245 ustep: 1 
iter: 3  value: 3746.938 mgc: 9.007086e-06 ustep: 1 
iter: 4  mgc: 9.547918e-14 
iter: 1  mgc: 9.547918e-14 
outer mgc:  8.970885 
iter: 1  value: 3744.998 mgc: 5.156174 ustep: 1 
iter: 2  value: 3744.957 mgc: 0.4063397 ustep: 1 
iter: 3  value: 3744.957 mgc: 0.00103502 ustep: 1 
iter: 4  mgc: 8.404413e-09 
iter: 1  value: 3742.31 mgc: 1.948334 ustep: 1 
iter: 2  value: 3742.31 mgc: 0.04802472 ustep: 1 
iter: 3  value: 3742.31 mgc: 1.279009e-05 ustep: 1 
iter: 4  mgc: 1.356693e-12 
iter: 1  mgc: 1.356693e-12 
outer mgc:  8.696266 
iter: 1  value: 3735.779 mgc: 3.499651 ustep: 1 
iter: 2  value: 3735.779 mgc: 0.01826676 ustep: 1 
iter: 3  value: 3735.779 mgc: 4.451452e-07 ustep: 1 
iter: 4  mgc: 6.467049e-15 
iter: 1  mgc: 6.467049e-15 
outer mgc:  12.73296 
iter: 1  value: 3730.994 mgc: 2.76687 ustep: 1 
iter: 2  value: 3730.994 mgc: 0.03994981 ustep: 1 
iter: 3  value: 3730.994 mgc: 1.630481e-06 ustep: 1 
iter: 4  mgc: 2.198242e-14 
iter: 1  mgc: 2.198242e-14 
outer mgc:  2.6888 
iter: 1  value: 3724.413 mgc: 4.881826 ustep: 1 
iter: 2  value: 3724.413 mgc: 0.005058227 ustep: 1 
iter: 3  value: 3724.413 mgc: 1.961792e-07 ustep: 1 
iter: 4  mgc: 1.412759e-14 
iter: 1  value: 3727.873 mgc: 1.584104 ustep: 1 
iter: 2  value: 3727.873 mgc: 0.001430021 ustep: 1 
iter: 3  mgc: 7.203112e-09 
iter: 1  mgc: 7.203112e-09 
outer mgc:  1.668484 
iter: 1  value: 3724.588 mgc: 5.075207 ustep: 1 
iter: 2  value: 3724.588 mgc: 0.001792973 ustep: 1 
iter: 3  value: 3724.588 mgc: 2.747963e-08 ustep: 1 
mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  2.071442 
iter: 1  value: 3721.767 mgc: 8.444287 ustep: 1 
iter: 2  value: 3721.767 mgc: 0.001712315 ustep: 1 
iter: 3  value: 3721.767 mgc: 2.653226e-08 ustep: 1 
mgc: 1.465494e-14 
iter: 1  mgc: 1.465494e-14 
outer mgc:  4.44408 
iter: 1  value: 3718.177 mgc: 6.047852 ustep: 1 
iter: 2  value: 3718.177 mgc: 0.007269892 ustep: 1 
iter: 3  value: 3718.177 mgc: 1.133191e-07 ustep: 1 
iter: 4  mgc: 1.587619e-14 
iter: 1  mgc: 1.587619e-14 
outer mgc:  2.782309 
iter: 1  value: 3713.996 mgc: 2.469313 ustep: 1 
iter: 2  value: 3713.996 mgc: 0.003882721 ustep: 1 
iter: 3  value: 3713.996 mgc: 4.831531e-08 ustep: 1 
mgc: 1.371125e-14 
iter: 1  mgc: 1.371125e-14 
outer mgc:  1.606591 
iter: 1  value: 3710.651 mgc: 14.44095 ustep: 1 
iter: 2  value: 3710.651 mgc: 0.003178175 ustep: 1 
iter: 3  value: 3710.651 mgc: 1.036457e-07 ustep: 1 
iter: 4  mgc: 1.614681e-14 
iter: 1  mgc: 1.614681e-14 
outer mgc:  0.5931371 
iter: 1  value: 3706.426 mgc: 10.77624 ustep: 1 
iter: 2  value: 3706.426 mgc: 0.001304891 ustep: 1 
iter: 3  mgc: 1.212479e-09 
iter: 1  mgc: 1.212479e-09 
outer mgc:  1.158452 
iter: 1  value: 3702.322 mgc: 16.83403 ustep: 1 
iter: 2  value: 3702.322 mgc: 0.0002262284 ustep: 1 
iter: 3  mgc: 3.242271e-10 
iter: 1  value: 3693.62 mgc: 60.70818 ustep: 1 
iter: 2  value: 3693.62 mgc: 0.0008963427 ustep: 1 
iter: 3  mgc: 1.306175e-09 
iter: 1  mgc: 1.306175e-09 
outer mgc:  0.5854609 
iter: 1  value: 3682.353 mgc: 158.4719 ustep: 1 
iter: 2  value: 3682.353 mgc: 0.001345774 ustep: 1 
iter: 3  mgc: 1.31335e-09 
iter: 1  mgc: 1.31335e-09 
outer mgc:  0.5130232 
iter: 1  value: 3671.499 mgc: 301.8819 ustep: 1 
iter: 2  value: 3671.499 mgc: 0.0005222237 ustep: 1 
iter: 3  mgc: 2.236495e-09 
iter: 1  mgc: 2.236495e-09 
outer mgc:  0.5932508 
iter: 1  value: 3662.601 mgc: 371.417 ustep: 1 
iter: 2  value: 3662.601 mgc: 0.0007213555 ustep: 1 
iter: 3  mgc: 3.832609e-09 
iter: 1  mgc: 3.832609e-09 
outer mgc:  0.394489 
iter: 1  value: 3658.799 mgc: 151.9375 ustep: 1 
iter: 2  value: 3658.799 mgc: 0.0001627399 ustep: 1 
iter: 3  mgc: 1.791873e-10 
iter: 1  mgc: 1.791873e-10 
outer mgc:  0.1887714 
iter: 1  value: 3655.071 mgc: 202.1936 ustep: 1 
iter: 2  value: 3655.071 mgc: 3.297688e-06 ustep: 1 
iter: 3  mgc: 2.606804e-13 
iter: 1  mgc: 2.606804e-13 
outer mgc:  0.06148318 
iter: 1  value: 3651.309 mgc: 244.4686 ustep: 1 
iter: 2  value: 3651.309 mgc: 1.249834e-06 ustep: 1 
iter: 3  mgc: 3.379519e-13 
iter: 1  value: 3642.724 mgc: 979.5128 ustep: 1 
iter: 2  value: 3642.724 mgc: 3.652976e-06 ustep: 1 
iter: 3  mgc: 4.791723e-13 
iter: 1  mgc: 4.791723e-13 
outer mgc:  0.09430438 
iter: 1  value: 3630.408 mgc: 2924.808 ustep: 1 
iter: 2  value: 3630.408 mgc: 4.535398e-06 ustep: 1 
iter: 3  mgc: 1.037614e-12 
iter: 1  mgc: 1.037614e-12 
outer mgc:  0.05050621 
iter: 1  value: 3618.109 mgc: 5509.282 ustep: 1 
iter: 2  value: 3618.109 mgc: 1.858322e-06 ustep: 1 
iter: 3  mgc: 1.039613e-12 
iter: 1  mgc: 1.039613e-12 
outer mgc:  0.01021597 
iter: 1  value: 3605.822 mgc: 10348.4 ustep: 1 
iter: 2  value: 3605.822 mgc: 2.507004e-07 ustep: 1 
iter: 3  mgc: 2.122302e-12 
iter: 1  mgc: 2.122302e-12 
outer mgc:  0.01082618 
iter: 1  value: 3593.543 mgc: 19412.16 ustep: 1 
iter: 2  value: 3593.543 mgc: 7.290958e-08 ustep: 1 
mgc: 3.960388e-12 
iter: 1  mgc: 3.960388e-12 
outer mgc:  0.006674161 
iter: 1  value: 3578.781 mgc: 53143.96 ustep: 1 
iter: 2  value: 3578.781 mgc: 2.861176e-08 ustep: 1 
mgc: 1.04956e-11 
iter: 1  mgc: 1.04956e-11 
outer mgc:  0.001804178 
iter: 1  value: 3564.938 mgc: 98690.41 ustep: 1 
iter: 2  mgc: 7.258124e-09 
iter: 1  mgc: 7.258124e-09 
outer mgc:  0.001316567 
iter: 1  value: 3551.099 mgc: 200243.2 ustep: 1 
iter: 2  mgc: 1.563075e-09 
iter: 1  mgc: 1.563075e-09 
outer mgc:  0.0008119277 
iter: 1  value: 3537.262 mgc: 406151.6 ustep: 1 
iter: 2  mgc: 7.579866e-10 
iter: 1  mgc: 7.579866e-10 
outer mgc:  0.0002223691 
iter: 1  value: 3523.428 mgc: 823472.6 ustep: 1 
iter: 2  mgc: 2.684777e-10 
iter: 1  mgc: 2.684777e-10 
outer mgc:  0.0001679553 
iter: 1  value: 3509.597 mgc: 1668958 ustep: 1 
iter: 2  mgc: 3.332974e-10 
iter: 1  mgc: 3.332974e-10 
outer mgc:  0.0001022595 
iter: 1  value: 3495.769 mgc: 3381303 ustep: 1 
iter: 2  mgc: 1.460251e-09 
iter: 1  mgc: 1.460251e-09 
outer mgc:  3.222599e-05 
iter: 1  value: 3481.943 mgc: 6848147 ustep: 1 
iter: 2  mgc: 1.942549e-09 
iter: 1  mgc: 1.942549e-09 
outer mgc:  1.867045e-05 
iter: 1  value: 3468.12 mgc: 13864905 ustep: 1 
iter: 2  mgc: 5.735232e-09 
iter: 1  mgc: 5.735232e-09 
outer mgc:  1.23569e-05 
iter: 1  value: 3454.299 mgc: 28062027 ustep: 1 
iter: 2  value: 3454.299 mgc: 1.127351e-08 ustep: 1 
mgc: 3.992964e-09 
iter: 1  mgc: 3.992964e-09 
outer mgc:  3.822409e-06 
iter: 1  value: 3440.481 mgc: 56778324 ustep: 1 
iter: 2  value: 3440.481 mgc: 2.639468e-08 ustep: 1 
mgc: 4.958447e-09 
iter: 1  mgc: 4.958447e-09 
outer mgc:  2.432939e-06 
iter: 1  mgc: 4.958447e-09 
iter: 1  mgc: 4.958447e-09 
outer mgc:  2.432939e-06 
iter: 1  value: 3440.482 mgc: 0.006378823 ustep: 1 
iter: 2  value: 3440.482 mgc: 1.783133e-07 ustep: 1 
iter: 3  value: 3440.482 mgc: 1.444089e-08 ustep: 1 
mgc: 1.013027e-08 
outer mgc:  0.0917931 
iter: 1  value: 3440.48 mgc: 0.006377904 ustep: 1 
iter: 2  value: 3440.48 mgc: 1.778855e-07 ustep: 1 
iter: 3  value: 3440.48 mgc: 1.508454e-08 ustep: 1 
mgc: 7.275046e-09 
outer mgc:  0.09178313 
iter: 1  value: 3440.482 mgc: 0.003425018 ustep: 1 
iter: 2  value: 3440.482 mgc: 7.421372e-08 ustep: 1 
iter: 3  value: 3440.482 mgc: 1.608776e-08 ustep: 1 
mgc: 1.863166e-08 
outer mgc:  0.05381728 
iter: 1  value: 3440.48 mgc: 0.003424753 ustep: 1 
iter: 2  value: 3440.48 mgc: 7.402928e-08 ustep: 1 
iter: 3  value: 3440.48 mgc: 2.389642e-08 ustep: 1 
mgc: 9.962973e-09 
outer mgc:  0.05382211 
iter: 1  value: 3440.48 mgc: 0.006125321 ustep: 1 
iter: 2  value: 3440.48 mgc: 3.317786e-07 ustep: 1 
iter: 3  mgc: 9.673812e-09 
outer mgc:  0.06157681 
iter: 1  value: 3440.482 mgc: 0.006122794 ustep: 1 
iter: 2  value: 3440.482 mgc: 3.326139e-07 ustep: 1 
iter: 3  value: 3440.482 mgc: 1.486679e-08 ustep: 1 
mgc: 1.640836e-08 
outer mgc:  0.06157242 
iter: 1  value: 3440.48 mgc: 0.003554249 ustep: 1 
iter: 2  value: 3440.48 mgc: 1.074901e-07 ustep: 1 
iter: 3  mgc: 7.308919e-09 
outer mgc:  0.041272 
iter: 1  value: 3440.482 mgc: 0.003554041 ustep: 1 
iter: 2  value: 3440.482 mgc: 1.077381e-07 ustep: 1 
iter: 3  mgc: 7.717117e-09 
outer mgc:  0.04125876 
iter: 1  value: 3440.501 mgc: 58541.74 ustep: 1 
mgc: 1.237778e-08 
outer mgc:  2.434762e-06 
iter: 1  value: 3440.461 mgc: 58717.63 ustep: 1 
mgc: 1.398162e-08 
outer mgc:  2.431118e-06 
iter: 1  value: 3440.492 mgc: 58600.31 ustep: 1 
iter: 2  value: 3440.492 mgc: 3.111886e-07 ustep: 1 
iter: 3  value: 3440.492 mgc: 2.486425e-08 ustep: 1 
mgc: 1.985493e-08 
outer mgc:  0.007884541 
iter: 1  value: 3440.47 mgc: 58658.94 ustep: 1 
iter: 2  value: 3440.47 mgc: 3.114345e-07 ustep: 1 
iter: 3  mgc: 8.738061e-09 
outer mgc:  0.007871332 
iter: 1  value: 3440.474 mgc: 2843.176 ustep: 1 
mgc: 1.367837e-08 
outer mgc:  2.433028e-06 
iter: 1  value: 3440.488 mgc: 2842.229 ustep: 1 
mgc: 1.357579e-08 
outer mgc:  2.432851e-06 
iter: 1  value: 3440.477 mgc: 0.004540129 ustep: 1 
iter: 2  value: 3440.477 mgc: 8.114337e-08 ustep: 1 
iter: 3  mgc: 7.092644e-09 
outer mgc:  0.02862148 
iter: 1  value: 3440.484 mgc: 0.004537037 ustep: 1 
iter: 2  value: 3440.484 mgc: 8.10498e-08 ustep: 1 
iter: 3  value: 3440.484 mgc: 1.717282e-08 ustep: 1 
mgc: 1.074144e-08 
outer mgc:  0.02861124 
[Sun Aug 15 00:30:52 2021]
Finished job 0.
1 of 1 steps (100%) done

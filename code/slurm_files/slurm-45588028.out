Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:04:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22065.627818 
final  value 21871.891365 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 20178.49 mgc: 4.30475 ustep: 0.6827823 
iter: 2  value: 20167.63 mgc: 2.142116 ustep: 0.8263238 
iter: 3  value: 20164.82 mgc: 2.344919 ustep: 0.6983222 
iter: 4  value: 20164.3 mgc: 0.8322004 ustep: 0.8356732 
iter: 5  value: 20164.3 mgc: 0.04787069 ustep: 0.9141602 
iter: 6  value: 20164.3 mgc: 0.002735438 ustep: 0.9561216 
iter: 7  value: 20164.3 mgc: 8.575751e-05 ustep: 0.9778169 
iter: 8  value: 20164.3 mgc: 1.366892e-06 ustep: 0.9888474 
iter: 9  value: 20164.3 mgc: 1.096992e-08 ustep: 0.9944086 
iter: 10  mgc: 4.416328e-11 
iter: 1  mgc: 4.416328e-11 
Matching hessian patterns... Done
outer mgc:  145.546 
iter: 1  value: 19954.67 mgc: 1.089247 ustep: 1 
iter: 2  value: 19954.66 mgc: 0.07457603 ustep: 1 
iter: 3  value: 19954.66 mgc: 0.0005444599 ustep: 1 
iter: 4  value: 19954.66 mgc: 3.732509e-08 ustep: 1 
iter: 5  mgc: 3.372302e-15 
iter: 1  value: 19776.17 mgc: 4.36054 ustep: 1 
iter: 2  value: 19776.11 mgc: 0.3199436 ustep: 1 
iter: 3  value: 19776.11 mgc: 0.001753423 ustep: 1 
iter: 4  value: 19776.11 mgc: 6.277714e-08 ustep: 1 
mgc: 1.731948e-14 
iter: 1  mgc: 1.731948e-14 
outer mgc:  99.48209 
iter: 1  value: 20807.45 mgc: 58.29777 ustep: 1 
iter: 2  value: 20385.19 mgc: 10.63277 ustep: 1 
iter: 3  value: 20356.67 mgc: 5.864489 ustep: 0.6827823 
iter: 4  value: 20347.99 mgc: 11.94854 ustep: 0.8263238 
iter: 5  value: 20330.79 mgc: 7.445144 ustep: 0.9090326 
iter: 6  value: 20324.81 mgc: 8.423035 ustep: 0.9534367 
iter: 7  value: 20323.83 mgc: 3.037995 ustep: 0.9764432 
iter: 8  value: 20323.76 mgc: 0.9105936 ustep: 0.9881526 
iter: 9  value: 20323.76 mgc: 0.01942373 ustep: 0.9940592 
iter: 10  value: 20323.76 mgc: 3.140702e-05 ustep: 0.9970255 
iter: 11  value: 20323.76 mgc: 1.739101e-08 ustep: 0.9985118 
mgc: 5.040413e-12 
iter: 1  value: 19774.31 mgc: 4.283114 ustep: 1 
iter: 2  value: 19774.17 mgc: 0.3525457 ustep: 1 
iter: 3  value: 19774.17 mgc: 0.00218546 ustep: 1 
iter: 4  value: 19774.17 mgc: 4.497006e-08 ustep: 1 
iter: 5  mgc: 1.176836e-14 
iter: 1  mgc: 1.176836e-14 
outer mgc:  78.5909 
iter: 1  value: 19778.39 mgc: 4.695857 ustep: 1 
iter: 2  value: 19778.22 mgc: 0.2894229 ustep: 1 
iter: 3  value: 19778.22 mgc: 0.002550412 ustep: 1 
iter: 4  value: 19778.22 mgc: 1.040951e-07 ustep: 1 
iter: 5  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  78.76256 
iter: 1  value: 19771.2 mgc: 4.99085 ustep: 1 
iter: 2  value: 19771.18 mgc: 0.1202425 ustep: 1 
iter: 3  value: 19771.18 mgc: 0.0003723344 ustep: 1 
iter: 4  mgc: 3.787573e-09 
iter: 1  mgc: 3.787573e-09 
outer mgc:  33.64822 
iter: 1  value: 19715.52 mgc: 4.906049 ustep: 1 
iter: 2  value: 19715.51 mgc: 0.09783774 ustep: 1 
iter: 3  value: 19715.51 mgc: 5.247486e-05 ustep: 1 
iter: 4  mgc: 1.586109e-11 
iter: 1  mgc: 1.586109e-11 
outer mgc:  9.806472 
iter: 1  value: 19760.85 mgc: 3.943992 ustep: 1 
iter: 2  value: 19760.85 mgc: 0.05107136 ustep: 1 
iter: 3  value: 19760.85 mgc: 6.726392e-05 ustep: 1 
iter: 4  mgc: 4.022205e-11 
iter: 1  value: 19718.36 mgc: 0.4586624 ustep: 1 
iter: 2  value: 19718.36 mgc: 0.001011417 ustep: 1 
iter: 3  mgc: 5.041835e-09 
iter: 1  mgc: 5.041835e-09 
outer mgc:  12.57907 
iter: 1  value: 19718.81 mgc: 0.9194223 ustep: 1 
iter: 2  value: 19718.81 mgc: 0.0051622 ustep: 1 
iter: 3  value: 19718.81 mgc: 2.056045e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 19718.8 mgc: 0.3223781 ustep: 1 
iter: 2  value: 19718.8 mgc: 0.0006341106 ustep: 1 
iter: 3  mgc: 2.725329e-09 
iter: 1  mgc: 2.725329e-09 
outer mgc:  5.601472 
iter: 1  value: 19719.34 mgc: 0.2284043 ustep: 1 
iter: 2  value: 19719.34 mgc: 0.0002618688 ustep: 1 
iter: 3  mgc: 3.412328e-10 
iter: 1  mgc: 3.412328e-10 
outer mgc:  2.919482 
iter: 1  value: 19720.45 mgc: 0.2092739 ustep: 1 
iter: 2  value: 19720.45 mgc: 0.0003016936 ustep: 1 
iter: 3  mgc: 3.005569e-10 
iter: 1  mgc: 3.005569e-10 
outer mgc:  3.218445 
iter: 1  value: 19721.76 mgc: 0.7028585 ustep: 1 
iter: 2  value: 19721.76 mgc: 0.002503779 ustep: 1 
iter: 3  value: 19721.76 mgc: 5.080622e-08 ustep: 1 
iter: 4  mgc: 4.996004e-15 
iter: 1  mgc: 4.996004e-15 
outer mgc:  4.732359 
iter: 1  value: 19720.24 mgc: 0.3427021 ustep: 1 
iter: 2  value: 19720.24 mgc: 0.001030326 ustep: 1 
iter: 3  value: 19720.24 mgc: 1.029992e-08 ustep: 1 
mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  1.600913 
iter: 1  value: 19719.59 mgc: 0.8288747 ustep: 1 
iter: 2  value: 19719.59 mgc: 0.002997678 ustep: 1 
iter: 3  value: 19719.59 mgc: 6.928237e-08 ustep: 1 
mgc: 7.438494e-15 
iter: 1  value: 19720.93 mgc: 0.213798 ustep: 1 
iter: 2  value: 19720.93 mgc: 0.0002052007 ustep: 1 
iter: 3  mgc: 2.937986e-10 
iter: 1  mgc: 2.937986e-10 
outer mgc:  3.896216 
iter: 1  value: 19719.65 mgc: 0.3169524 ustep: 1 
iter: 2  value: 19719.65 mgc: 0.0002203446 ustep: 1 
iter: 3  mgc: 1.145251e-09 
iter: 1  mgc: 1.145251e-09 
outer mgc:  3.529016 
iter: 1  value: 19718.64 mgc: 0.2578355 ustep: 1 
iter: 2  value: 19718.64 mgc: 0.0003280896 ustep: 1 
iter: 3  mgc: 1.00209e-09 
iter: 1  mgc: 1.00209e-09 
outer mgc:  1.11222 
iter: 1  value: 19718.28 mgc: 0.3007535 ustep: 1 
iter: 2  value: 19718.28 mgc: 0.0004293062 ustep: 1 
iter: 3  mgc: 6.340413e-10 
iter: 1  mgc: 6.340413e-10 
outer mgc:  1.024453 
iter: 1  value: 19717.7 mgc: 0.2489066 ustep: 1 
iter: 2  value: 19717.7 mgc: 0.0001431895 ustep: 1 
iter: 3  mgc: 3.394574e-10 
iter: 1  mgc: 3.394574e-10 
outer mgc:  2.027176 
iter: 1  value: 19716.47 mgc: 0.2046858 ustep: 1 
iter: 2  value: 19716.47 mgc: 0.0002018598 ustep: 1 
iter: 3  mgc: 1.580229e-10 
iter: 1  mgc: 1.580229e-10 
outer mgc:  0.8840513 
iter: 1  value: 19715.61 mgc: 0.2026061 ustep: 1 
iter: 2  value: 19715.61 mgc: 9.587652e-05 ustep: 1 
iter: 3  mgc: 1.853273e-10 
iter: 1  mgc: 1.853273e-10 
outer mgc:  1.767003 
iter: 1  value: 19714.9 mgc: 0.1340445 ustep: 1 
iter: 2  value: 19714.9 mgc: 7.396085e-05 ustep: 1 
iter: 3  mgc: 1.025424e-10 
iter: 1  mgc: 1.025424e-10 
outer mgc:  1.43901 
iter: 1  value: 19713.91 mgc: 0.2285664 ustep: 1 
iter: 2  value: 19713.91 mgc: 0.0001226548 ustep: 1 
iter: 3  mgc: 3.249707e-10 
iter: 1  mgc: 3.249707e-10 
outer mgc:  1.642935 
iter: 1  value: 19712.93 mgc: 0.2167209 ustep: 1 
iter: 2  value: 19712.93 mgc: 8.702337e-05 ustep: 1 
iter: 3  mgc: 1.264988e-10 
iter: 1  mgc: 1.264988e-10 
outer mgc:  0.7960282 
iter: 1  value: 19712.14 mgc: 0.1315081 ustep: 1 
iter: 2  value: 19712.14 mgc: 5.615633e-05 ustep: 1 
iter: 3  mgc: 4.608136e-11 
iter: 1  mgc: 4.608136e-11 
outer mgc:  0.910127 
iter: 1  value: 19711.41 mgc: 0.1084851 ustep: 1 
iter: 2  value: 19711.41 mgc: 2.101784e-05 ustep: 1 
iter: 3  mgc: 1.339107e-11 
iter: 1  mgc: 1.339107e-11 
outer mgc:  0.9522385 
iter: 1  value: 19710.79 mgc: 0.1124465 ustep: 1 
iter: 2  value: 19710.79 mgc: 2.704123e-05 ustep: 1 
iter: 3  mgc: 4.744871e-12 
iter: 1  mgc: 4.744871e-12 
outer mgc:  1.1723 
iter: 1  value: 19709.71 mgc: 0.2141428 ustep: 1 
iter: 2  value: 19709.71 mgc: 0.0001447118 ustep: 1 
iter: 3  mgc: 2.429643e-10 
iter: 1  mgc: 2.429643e-10 
outer mgc:  0.5388497 
iter: 1  value: 19709.2 mgc: 0.2662119 ustep: 1 
iter: 2  value: 19709.2 mgc: 0.0001307154 ustep: 1 
iter: 3  mgc: 9.99667e-11 
iter: 1  mgc: 9.99667e-11 
outer mgc:  0.8338252 
iter: 1  value: 19708.26 mgc: 0.1278463 ustep: 1 
iter: 2  value: 19708.26 mgc: 3.965453e-05 ustep: 1 
iter: 3  mgc: 1.654543e-11 
iter: 1  mgc: 1.654543e-11 
outer mgc:  1.028557 
iter: 1  value: 19707.17 mgc: 0.1564032 ustep: 1 
iter: 2  value: 19707.17 mgc: 6.768804e-05 ustep: 1 
iter: 3  mgc: 1.524203e-11 
iter: 1  value: 19704.99 mgc: 0.3033345 ustep: 1 
iter: 2  value: 19704.99 mgc: 0.0002751937 ustep: 1 
iter: 3  mgc: 2.735248e-10 
iter: 1  value: 19701.38 mgc: 0.5130787 ustep: 1 
iter: 2  value: 19701.38 mgc: 0.0006906499 ustep: 1 
iter: 3  mgc: 1.294187e-09 
iter: 1  mgc: 1.294187e-09 
outer mgc:  1.321395 
iter: 1  value: 19697.44 mgc: 0.6545742 ustep: 1 
iter: 2  value: 19697.44 mgc: 0.0007528572 ustep: 1 
iter: 3  mgc: 5.936934e-09 
iter: 1  mgc: 5.936934e-09 
outer mgc:  0.940391 
iter: 1  value: 19689.94 mgc: 0.9114798 ustep: 1 
iter: 2  value: 19689.94 mgc: 0.001203328 ustep: 1 
iter: 3  value: 19689.94 mgc: 2.400378e-08 ustep: 1 
mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  1.268735 
iter: 1  value: 19688.93 mgc: 0.3638947 ustep: 1 
iter: 2  value: 19688.93 mgc: 0.0002387396 ustep: 1 
iter: 3  mgc: 5.206764e-10 
iter: 1  mgc: 5.206764e-10 
outer mgc:  0.5788996 
iter: 1  value: 19687.87 mgc: 0.5480741 ustep: 1 
iter: 2  value: 19687.87 mgc: 0.0002335392 ustep: 1 
iter: 3  mgc: 1.686908e-09 
iter: 1  mgc: 1.686908e-09 
outer mgc:  0.2972448 
iter: 1  value: 19686.75 mgc: 0.1320183 ustep: 1 
iter: 2  value: 19686.75 mgc: 2.240887e-05 ustep: 1 
iter: 3  mgc: 8.767209e-12 
iter: 1  mgc: 8.767209e-12 
outer mgc:  0.1418751 
iter: 1  value: 19684.98 mgc: 0.2043893 ustep: 1 
iter: 2  value: 19684.98 mgc: 4.55288e-05 ustep: 1 
iter: 3  mgc: 4.776712e-11 
iter: 1  mgc: 4.776712e-11 
outer mgc:  0.1098828 
iter: 1  value: 19683.24 mgc: 0.2088682 ustep: 1 
iter: 2  value: 19683.24 mgc: 5.594929e-05 ustep: 1 
iter: 3  mgc: 6.629364e-12 
iter: 1  mgc: 6.629364e-12 
outer mgc:  0.08293462 
iter: 1  value: 19683.3 mgc: 0.02201969 ustep: 1 
iter: 2  value: 19683.3 mgc: 3.648713e-06 ustep: 1 
iter: 3  mgc: 3.33289e-13 
iter: 1  mgc: 3.33289e-13 
outer mgc:  0.04121995 
iter: 1  value: 19683.28 mgc: 0.01604714 ustep: 1 
iter: 2  value: 19683.28 mgc: 6.116765e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.01234343 
iter: 1  value: 19683.24 mgc: 0.004451067 ustep: 1 
iter: 2  value: 19683.24 mgc: 2.639206e-08 ustep: 1 
mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  0.004822516 
iter: 1  value: 19683.21 mgc: 0.003588292 ustep: 1 
iter: 2  value: 19683.21 mgc: 1.129793e-08 ustep: 1 
mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  3.401916e-05 
iter: 1  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  3.401916e-05 
iter: 1  value: 19683.22 mgc: 0.006093616 ustep: 1 
iter: 2  value: 19683.22 mgc: 9.02711e-08 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.3737331 
iter: 1  value: 19683.2 mgc: 0.006091802 ustep: 1 
iter: 2  value: 19683.2 mgc: 9.021283e-08 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.373592 
iter: 1  value: 19683.22 mgc: 0.003240099 ustep: 1 
iter: 2  value: 19683.22 mgc: 3.042502e-08 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.2010541 
iter: 1  value: 19683.21 mgc: 0.003239513 ustep: 1 
iter: 2  value: 19683.21 mgc: 3.041893e-08 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.2009581 
iter: 1  value: 19683.21 mgc: 0.005647164 ustep: 1 
iter: 2  value: 19683.21 mgc: 2.742944e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.3181892 
iter: 1  value: 19683.21 mgc: 0.005645316 ustep: 1 
iter: 2  value: 19683.21 mgc: 2.742432e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.31817 
iter: 1  value: 19683.21 mgc: 0.00312319 ustep: 1 
iter: 2  value: 19683.21 mgc: 1.151122e-07 ustep: 1 
iter: 3  mgc: 1.265654e-14 
outer mgc:  0.1995697 
iter: 1  value: 19683.21 mgc: 0.003122651 ustep: 1 
iter: 2  value: 19683.21 mgc: 1.150401e-07 ustep: 1 
iter: 3  mgc: 1.332268e-14 
outer mgc:  0.1995455 
iter: 1  value: 19683.29 mgc: 0.04446585 ustep: 1 
iter: 2  value: 19683.29 mgc: 1.718884e-06 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.05645191 
iter: 1  value: 19683.13 mgc: 0.04459233 ustep: 1 
iter: 2  value: 19683.13 mgc: 1.714999e-06 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.05628364 
iter: 1  value: 19683.26 mgc: 0.03849299 ustep: 1 
iter: 2  value: 19683.26 mgc: 1.723416e-06 ustep: 1 
iter: 3  mgc: 2.109424e-14 
outer mgc:  0.09794111 
iter: 1  value: 19683.16 mgc: 0.0385315 ustep: 1 
iter: 2  value: 19683.16 mgc: 1.72363e-06 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.09781216 
iter: 1  value: 19683.18 mgc: 0.003018078 ustep: 1 
iter: 2  mgc: 8.757875e-09 
outer mgc:  0.002499362 
iter: 1  value: 19683.24 mgc: 0.00301707 ustep: 1 
iter: 2  mgc: 8.771635e-09 
outer mgc:  0.002569082 
iter: 1  value: 19683.19 mgc: 0.00465818 ustep: 1 
iter: 2  value: 19683.19 mgc: 1.556311e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.136654 
iter: 1  value: 19683.24 mgc: 0.004654389 ustep: 1 
iter: 2  value: 19683.24 mgc: 1.554644e-07 ustep: 1 
iter: 3  mgc: 1.554312e-14 
outer mgc:  0.1366941 
[Sun Aug 15 23:04:49 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 02:53:03 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_50_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11024.574317 
final  value 8605.703404 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8184.242 mgc: 148.2119 ustep: 0.6827823 
iter: 2  value: 3883.084 mgc: 128.8487 ustep: 0.103588 
iter: 3  value: 2203.899 mgc: 103.4914 ustep: 0.09253576 
iter: 4  value: 1482.655 mgc: 120.0871 ustep: 0.08668798 
iter: 5  value: 1156.12 mgc: 97.73798 ustep: 0.08349986 
iter: 6  value: 1021.375 mgc: 84.557 ustep: 0.2890345 
iter: 7  value: 1006.823 mgc: 82.03023 ustep: 0.5376656 
iter: 8  value: 957.3958 mgc: 75.86781 ustep: 0.7332835 
iter: 9  value: 920.8144 mgc: 59.44928 ustep: 0.8563341 
iter: 10  value: 916.1827 mgc: 19.86106 ustep: 0.9253907 
iter: 11  value: 916.1529 mgc: 1.025299 ustep: 0.9619761 
iter: 12  value: 916.1529 mgc: 0.01509047 ustep: 0.9808057 
iter: 13  value: 916.1529 mgc: 1.400629e-05 ustep: 0.9903573 
iter: 14  mgc: 6.141759e-09 
iter: 1  mgc: 6.141759e-09 
Matching hessian patterns... Done
outer mgc:  273.2614 
iter: 1  value: 843.879 mgc: 25.62485 ustep: 1 
iter: 2  value: 810.1625 mgc: 8.282186 ustep: 1 
iter: 3  value: 809.8865 mgc: 0.9219932 ustep: 1 
iter: 4  value: 809.8865 mgc: 0.01696983 ustep: 1 
iter: 5  value: 809.8865 mgc: 6.089352e-06 ustep: 1 
iter: 6  mgc: 7.829848e-13 
iter: 1  mgc: 7.829848e-13 
outer mgc:  234.1362 
iter: 1  value: 747.5507 mgc: 16.22516 ustep: 1 
iter: 2  value: 747.327 mgc: 0.8271946 ustep: 1 
iter: 3  value: 747.327 mgc: 0.006928262 ustep: 1 
iter: 4  value: 747.327 mgc: 5.454344e-07 ustep: 1 
iter: 5  mgc: 3.885781e-14 
iter: 1  mgc: 3.885781e-14 
outer mgc:  156.4428 
iter: 1  value: 703.0179 mgc: 29.16885 ustep: 1 
iter: 2  value: 687.4352 mgc: 5.715503 ustep: 1 
iter: 3  value: 687.3789 mgc: 0.3557715 ustep: 1 
iter: 4  value: 687.3789 mgc: 0.002827524 ustep: 1 
iter: 5  value: 687.3789 mgc: 1.953404e-07 ustep: 1 
iter: 6  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  65.45774 
iter: 1  value: 664.5323 mgc: 10.18514 ustep: 1 
iter: 2  value: 664.2839 mgc: 1.103716 ustep: 1 
iter: 3  value: 664.2836 mgc: 0.05579455 ustep: 1 
iter: 4  value: 664.2836 mgc: 0.0001621262 ustep: 1 
iter: 5  mgc: 1.378036e-09 
iter: 1  mgc: 1.378036e-09 
outer mgc:  53.05875 
iter: 1  value: 782.0033 mgc: 33.4464 ustep: 1 
iter: 2  value: 668.2941 mgc: 21.3624 ustep: 1 
iter: 3  value: 666.5673 mgc: 2.252508 ustep: 1 
iter: 4  value: 666.5666 mgc: 0.03946424 ustep: 1 
iter: 5  value: 666.5666 mgc: 2.158704e-05 ustep: 1 
iter: 6  mgc: 8.477219e-12 
iter: 1  value: 660.1018 mgc: 19.24788 ustep: 1 
iter: 2  value: 658.2369 mgc: 1.85774 ustep: 1 
iter: 3  value: 658.236 mgc: 0.03711488 ustep: 1 
iter: 4  value: 658.236 mgc: 3.489494e-05 ustep: 1 
iter: 5  mgc: 6.286793e-11 
iter: 1  mgc: 6.286793e-11 
outer mgc:  101.3092 
iter: 1  value: 629.0203 mgc: 8.24515 ustep: 1 
iter: 2  value: 628.7403 mgc: 0.9203657 ustep: 1 
iter: 3  value: 628.7403 mgc: 0.0238745 ustep: 1 
iter: 4  value: 628.7403 mgc: 1.708916e-05 ustep: 1 
iter: 5  mgc: 8.770318e-12 
iter: 1  mgc: 8.770318e-12 
outer mgc:  37.71101 
iter: 1  value: 631.8076 mgc: 10.02377 ustep: 1 
iter: 2  value: 631.4139 mgc: 1.107343 ustep: 1 
iter: 3  value: 631.4139 mgc: 0.009744824 ustep: 1 
iter: 4  value: 631.4139 mgc: 1.578958e-06 ustep: 1 
iter: 5  mgc: 4.710121e-14 
iter: 1  value: 622.9278 mgc: 4.664205 ustep: 1 
iter: 2  value: 622.9135 mgc: 0.1982727 ustep: 1 
iter: 3  value: 622.9135 mgc: 0.0003550166 ustep: 1 
iter: 4  mgc: 2.131807e-09 
iter: 1  mgc: 2.131807e-09 
outer mgc:  28.98683 
iter: 1  value: 619.6018 mgc: 2.4823 ustep: 1 
iter: 2  value: 619.5983 mgc: 0.08987082 ustep: 1 
iter: 3  value: 619.5983 mgc: 0.000206497 ustep: 1 
iter: 4  mgc: 1.098607e-09 
iter: 1  mgc: 1.098607e-09 
outer mgc:  57.4339 
iter: 1  value: 611.5462 mgc: 6.208842 ustep: 1 
iter: 2  value: 611.5358 mgc: 0.1574074 ustep: 1 
iter: 3  value: 611.5358 mgc: 0.000212902 ustep: 1 
iter: 4  mgc: 5.405285e-10 
iter: 1  mgc: 5.405285e-10 
outer mgc:  22.22837 
iter: 1  value: 613.5907 mgc: 9.15876 ustep: 1 
iter: 2  value: 613.3481 mgc: 0.7672122 ustep: 1 
iter: 3  value: 613.3481 mgc: 0.004078051 ustep: 1 
iter: 4  value: 613.3481 mgc: 1.703955e-07 ustep: 1 
iter: 5  mgc: 3.38618e-14 
iter: 1  value: 609.2112 mgc: 3.712032 ustep: 1 
iter: 2  value: 609.2055 mgc: 0.1105505 ustep: 1 
iter: 3  value: 609.2055 mgc: 9.20021e-05 ustep: 1 
iter: 4  mgc: 1.156812e-10 
iter: 1  mgc: 1.156812e-10 
outer mgc:  33.33174 
iter: 1  value: 605.9114 mgc: 9.494146 ustep: 1 
iter: 2  value: 605.904 mgc: 0.1426034 ustep: 1 
iter: 3  value: 605.904 mgc: 0.000119172 ustep: 1 
iter: 4  mgc: 1.691238e-10 
iter: 1  mgc: 1.691238e-10 
outer mgc:  20.31065 
iter: 1  value: 603.8879 mgc: 3.78042 ustep: 1 
iter: 2  value: 603.8833 mgc: 0.1057378 ustep: 1 
iter: 3  value: 603.8833 mgc: 0.0001836263 ustep: 1 
iter: 4  mgc: 5.532836e-10 
iter: 1  mgc: 5.532836e-10 
outer mgc:  17.70342 
iter: 1  value: 602.0068 mgc: 3.41153 ustep: 1 
iter: 2  value: 602.0067 mgc: 0.02780847 ustep: 1 
iter: 3  value: 602.0067 mgc: 5.185638e-06 ustep: 1 
iter: 4  mgc: 1.820766e-13 
iter: 1  mgc: 1.820766e-13 
outer mgc:  30.15822 
iter: 1  value: 601.2464 mgc: 6.32176 ustep: 1 
iter: 2  value: 601.2438 mgc: 0.06965827 ustep: 1 
iter: 3  value: 601.2438 mgc: 4.647988e-05 ustep: 1 
iter: 4  mgc: 1.634604e-11 
iter: 1  value: 600.7968 mgc: 1.516235 ustep: 1 
iter: 2  value: 600.7968 mgc: 0.005734433 ustep: 1 
iter: 3  value: 600.7968 mgc: 3.107691e-07 ustep: 1 
iter: 4  mgc: 4.596323e-14 
iter: 1  mgc: 4.596323e-14 
outer mgc:  12.62707 
iter: 1  value: 601.0687 mgc: 2.833447 ustep: 1 
iter: 2  value: 601.0682 mgc: 0.04575273 ustep: 1 
iter: 3  value: 601.0682 mgc: 1.421067e-05 ustep: 1 
iter: 4  mgc: 1.348699e-12 
iter: 1  value: 600.6618 mgc: 1.775493 ustep: 1 
iter: 2  value: 600.6618 mgc: 0.008422649 ustep: 1 
iter: 3  value: 600.6618 mgc: 4.73257e-07 ustep: 1 
iter: 4  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  7.120312 
iter: 1  value: 600.2611 mgc: 1.41833 ustep: 1 
iter: 2  value: 600.2611 mgc: 0.003397274 ustep: 1 
iter: 3  value: 600.2611 mgc: 1.027748e-07 ustep: 1 
iter: 4  mgc: 5.107026e-14 
iter: 1  mgc: 5.107026e-14 
outer mgc:  3.168668 
iter: 1  value: 599.8952 mgc: 0.7165694 ustep: 1 
iter: 2  value: 599.8952 mgc: 0.002042145 ustep: 1 
iter: 3  value: 599.8952 mgc: 5.845768e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  4.613421 
iter: 1  value: 599.6924 mgc: 1.104755 ustep: 1 
iter: 2  value: 599.6923 mgc: 0.007736508 ustep: 1 
iter: 3  value: 599.6923 mgc: 4.288036e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  value: 599.7162 mgc: 0.8952945 ustep: 1 
iter: 2  value: 599.7162 mgc: 0.001734553 ustep: 1 
iter: 3  value: 599.7162 mgc: 2.039642e-08 ustep: 1 
mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  5.040366 
iter: 1  value: 599.7111 mgc: 0.4623764 ustep: 1 
iter: 2  value: 599.7111 mgc: 0.0006243685 ustep: 1 
iter: 3  mgc: 2.563325e-09 
iter: 1  mgc: 2.563325e-09 
outer mgc:  1.222001 
iter: 1  value: 599.4774 mgc: 0.814061 ustep: 1 
iter: 2  value: 599.4774 mgc: 0.0009659912 ustep: 1 
iter: 3  mgc: 7.642105e-09 
iter: 1  mgc: 7.642105e-09 
outer mgc:  3.852074 
iter: 1  value: 599.6453 mgc: 0.3716298 ustep: 1 
iter: 2  value: 599.6453 mgc: 0.0007345416 ustep: 1 
iter: 3  mgc: 5.618911e-09 
iter: 1  mgc: 5.618911e-09 
outer mgc:  1.065345 
iter: 1  value: 599.179 mgc: 0.8531039 ustep: 1 
iter: 2  value: 599.179 mgc: 0.004245933 ustep: 1 
iter: 3  value: 599.179 mgc: 5.838086e-08 ustep: 1 
mgc: 3.208545e-14 
iter: 1  value: 599.5295 mgc: 0.16406 ustep: 1 
iter: 2  value: 599.5295 mgc: 0.0002104227 ustep: 1 
iter: 3  mgc: 2.088951e-10 
iter: 1  mgc: 2.088951e-10 
outer mgc:  0.3409305 
iter: 1  value: 599.4925 mgc: 0.1011226 ustep: 1 
iter: 2  value: 599.4925 mgc: 3.64276e-05 ustep: 1 
iter: 3  mgc: 1.42979e-11 
iter: 1  mgc: 1.42979e-11 
outer mgc:  0.4442166 
iter: 1  value: 599.4515 mgc: 0.1141431 ustep: 1 
iter: 2  value: 599.4515 mgc: 2.535301e-05 ustep: 1 
iter: 3  mgc: 4.088285e-12 
iter: 1  mgc: 4.088285e-12 
outer mgc:  0.2793735 
iter: 1  value: 599.384 mgc: 0.1194338 ustep: 1 
iter: 2  value: 599.384 mgc: 5.892813e-05 ustep: 1 
iter: 3  mgc: 1.511413e-11 
iter: 1  value: 599.4459 mgc: 0.03861069 ustep: 1 
iter: 2  value: 599.4459 mgc: 3.279826e-06 ustep: 1 
iter: 3  mgc: 8.792966e-14 
iter: 1  mgc: 8.792966e-14 
outer mgc:  0.1271124 
iter: 1  value: 599.4528 mgc: 0.01445987 ustep: 1 
iter: 2  value: 599.4528 mgc: 8.105442e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  value: 599.4441 mgc: 0.008888129 ustep: 1 
iter: 2  value: 599.4441 mgc: 2.881586e-07 ustep: 1 
iter: 3  mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  0.1373351 
iter: 1  value: 599.447 mgc: 0.01574136 ustep: 1 
iter: 2  value: 599.447 mgc: 4.88346e-07 ustep: 1 
iter: 3  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.04505637 
iter: 1  value: 599.4425 mgc: 0.01035442 ustep: 1 
iter: 2  value: 599.4425 mgc: 7.008903e-07 ustep: 1 
iter: 3  mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  0.03800564 
iter: 1  value: 599.4445 mgc: 0.005087401 ustep: 1 
iter: 2  value: 599.4445 mgc: 5.114793e-08 ustep: 1 
mgc: 2.728373e-14 
iter: 1  mgc: 2.728373e-14 
outer mgc:  0.00984955 
iter: 1  value: 599.4465 mgc: 0.003875643 ustep: 1 
iter: 2  value: 599.4465 mgc: 4.917875e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.01438802 
iter: 1  value: 599.4486 mgc: 0.004176463 ustep: 1 
iter: 2  value: 599.4486 mgc: 5.6259e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  value: 599.4473 mgc: 0.002715779 ustep: 1 
iter: 2  value: 599.4473 mgc: 2.136023e-08 ustep: 1 
mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  0.006323186 
iter: 1  value: 599.4471 mgc: 0.002269017 ustep: 1 
iter: 2  value: 599.4471 mgc: 3.598735e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  value: 599.4473 mgc: 0.0008463032 ustep: 1 
iter: 2  mgc: 3.426625e-09 
iter: 1  mgc: 3.426625e-09 
outer mgc:  0.002521037 
iter: 1  value: 599.447 mgc: 0.000742014 ustep: 1 
iter: 2  mgc: 1.899648e-09 
iter: 1  mgc: 1.899648e-09 
outer mgc:  0.003545227 
iter: 1  mgc: 1.899648e-09 
iter: 1  mgc: 1.899648e-09 
outer mgc:  0.003545227 
iter: 1  value: 599.4433 mgc: 0.0316681 ustep: 1 
iter: 2  value: 599.4433 mgc: 6.571936e-06 ustep: 1 
iter: 3  mgc: 2.88658e-13 
outer mgc:  0.2757743 
iter: 1  value: 599.451 mgc: 0.03164717 ustep: 1 
iter: 2  value: 599.451 mgc: 6.574604e-06 ustep: 1 
iter: 3  mgc: 2.877698e-13 
outer mgc:  0.2798416 
iter: 1  value: 599.4453 mgc: 0.01117238 ustep: 1 
iter: 2  value: 599.4453 mgc: 8.163807e-07 ustep: 1 
iter: 3  mgc: 4.063416e-14 
outer mgc:  0.2504258 
iter: 1  value: 599.4491 mgc: 0.01116375 ustep: 1 
iter: 2  value: 599.4491 mgc: 8.155166e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.2511202 
iter: 1  value: 599.4519 mgc: 0.0560937 ustep: 1 
iter: 2  value: 599.4519 mgc: 6.399129e-06 ustep: 1 
iter: 3  mgc: 2.353673e-13 
outer mgc:  0.4159409 
iter: 1  value: 599.4426 mgc: 0.05610077 ustep: 1 
iter: 2  value: 599.4426 mgc: 6.390331e-06 ustep: 1 
iter: 3  mgc: 2.433609e-13 
outer mgc:  0.4104341 
iter: 1  value: 599.4504 mgc: 0.02835051 ustep: 1 
iter: 2  value: 599.4504 mgc: 1.73867e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.6261409 
iter: 1  value: 599.4443 mgc: 0.02835715 ustep: 1 
iter: 2  value: 599.4443 mgc: 1.738464e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.6191369 
iter: 1  value: 599.4387 mgc: 0.006811956 ustep: 1 
iter: 2  value: 599.4387 mgc: 4.006639e-07 ustep: 1 
iter: 3  mgc: 4.218847e-14 
outer mgc:  0.01269731 
iter: 1  value: 599.4554 mgc: 0.006807521 ustep: 1 
iter: 2  value: 599.4554 mgc: 4.007764e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.012797 
iter: 1  value: 599.4625 mgc: 0.01474062 ustep: 1 
iter: 2  value: 599.4625 mgc: 3.010532e-06 ustep: 1 
iter: 3  mgc: 1.207923e-13 
outer mgc:  0.0966326 
iter: 1  value: 599.4317 mgc: 0.01477209 ustep: 1 
iter: 2  value: 599.4317 mgc: 3.012889e-06 ustep: 1 
iter: 3  mgc: 1.234568e-13 
outer mgc:  0.09800042 
iter: 1  value: 599.4543 mgc: 0.01920369 ustep: 1 
iter: 2  value: 599.4543 mgc: 1.502973e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.1277417 
iter: 1  value: 599.4399 mgc: 0.01924892 ustep: 1 
iter: 2  value: 599.4399 mgc: 1.507384e-06 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.1267462 
[Mon Aug 16 02:53:06 2021]
Finished job 0.
1 of 1 steps (100%) done

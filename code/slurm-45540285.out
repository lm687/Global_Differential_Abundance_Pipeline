Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 00:03:18 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10945.474232 
iter  10 value 9048.422916
iter  10 value 9048.422913
final  value 9048.422913 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 7054.71 mgc: 109.9352 ustep: 1 
iter: 2  value: 5726.94 mgc: 81.48107 ustep: 0.1336527 
iter: 3  value: 4701.397 mgc: 129.6426 ustep: 0.1075309 
iter: 4  value: 3731.725 mgc: 77.01349 ustep: 0.09457213 
iter: 5  value: 3470.389 mgc: 88.28495 ustep: 0.3075951 
iter: 6  value: 3462.916 mgc: 20.59968 ustep: 0.5546571 
iter: 7  value: 3462.879 mgc: 1.643326 ustep: 0.7447786 
iter: 8  value: 3462.879 mgc: 0.01777773 ustep: 0.8630192 
iter: 9  value: 3462.879 mgc: 6.528261e-05 ustep: 0.9289954 
iter: 10  value: 3462.879 mgc: 1.632791e-07 ustep: 0.9638477 
iter: 11  mgc: 4.714384e-10 
iter: 1  mgc: 4.714384e-10 
Matching hessian patterns... Done
outer mgc:  1731.175 
iter: 1  value: 1917.714 mgc: 33.1704 ustep: 1 
iter: 2  value: 1884.944 mgc: 10.35303 ustep: 1 
iter: 3  value: 1884.807 mgc: 1.092001 ustep: 1 
iter: 4  value: 1884.807 mgc: 0.01908576 ustep: 1 
iter: 5  value: 1884.807 mgc: 6.173077e-06 ustep: 1 
iter: 6  mgc: 6.511458e-13 
iter: 1  value: 968.9105 mgc: 55.09702 ustep: 1 
iter: 2  value: 820.5716 mgc: 22.74967 ustep: 1 
iter: 3  value: 819.1019 mgc: 2.072617 ustep: 1 
iter: 4  value: 819.1014 mgc: 0.05364034 ustep: 1 
iter: 5  value: 819.1014 mgc: 4.706347e-05 ustep: 1 
iter: 6  mgc: 3.628089e-11 
iter: 1  mgc: 3.628089e-11 
outer mgc:  210.6315 
iter: 1  value: 1026.654 mgc: 48.81414 ustep: 1 
iter: 2  value: 1015.478 mgc: 4.941829 ustep: 1 
iter: 3  value: 1015.455 mgc: 0.37522 ustep: 1 
iter: 4  value: 1015.455 mgc: 0.002826562 ustep: 1 
iter: 5  value: 1015.455 mgc: 1.636011e-07 ustep: 1 
iter: 6  mgc: 3.397282e-14 
iter: 1  value: 743.9001 mgc: 23.51913 ustep: 1 
iter: 2  value: 742.5368 mgc: 1.854868 ustep: 1 
iter: 3  value: 742.5364 mgc: 0.0417531 ustep: 1 
iter: 4  value: 742.5364 mgc: 4.770678e-05 ustep: 1 
iter: 5  mgc: 6.250833e-11 
iter: 1  mgc: 6.250833e-11 
outer mgc:  189.6152 
iter: 1  value: 720.1334 mgc: 19.73997 ustep: 1 
iter: 2  value: 718.0744 mgc: 2.401795 ustep: 1 
iter: 3  value: 718.0739 mgc: 0.03842297 ustep: 1 
iter: 4  value: 718.0739 mgc: 2.307302e-05 ustep: 1 
iter: 5  mgc: 1.491385e-11 
iter: 1  mgc: 1.491385e-11 
outer mgc:  212.1323 
iter: 1  value: 796.3477 mgc: 37.02865 ustep: 1 
iter: 2  value: 795.3453 mgc: 2.569333 ustep: 1 
iter: 3  value: 795.3452 mgc: 0.01978615 ustep: 1 
iter: 4  value: 795.3452 mgc: 6.405001e-06 ustep: 1 
iter: 5  mgc: 6.248335e-13 
iter: 1  value: 667.5934 mgc: 14.75526 ustep: 1 
iter: 2  value: 667.5183 mgc: 0.4470213 ustep: 1 
iter: 3  value: 667.5183 mgc: 0.00130189 ustep: 1 
iter: 4  value: 667.5183 mgc: 1.461896e-08 ustep: 1 
mgc: 3.265443e-14 
iter: 1  mgc: 3.265443e-14 
outer mgc:  25.95601 
iter: 1  value: 654.2277 mgc: 6.142859 ustep: 1 
iter: 2  value: 654.2075 mgc: 0.2427875 ustep: 1 
iter: 3  value: 654.2075 mgc: 0.0002448244 ustep: 1 
iter: 4  mgc: 1.013551e-09 
iter: 1  mgc: 1.013551e-09 
outer mgc:  35.26266 
iter: 1  value: 656.6645 mgc: 13.29377 ustep: 1 
iter: 2  value: 656.6512 mgc: 0.2954318 ustep: 1 
iter: 3  value: 656.6512 mgc: 0.0005870868 ustep: 1 
iter: 4  mgc: 6.130669e-09 
iter: 1  value: 649.4703 mgc: 5.239308 ustep: 1 
iter: 2  value: 649.4699 mgc: 0.05037782 ustep: 1 
iter: 3  value: 649.4699 mgc: 1.462301e-05 ustep: 1 
iter: 4  mgc: 3.600231e-12 
iter: 1  mgc: 3.600231e-12 
outer mgc:  28.96288 
iter: 1  value: 646.9409 mgc: 4.575054 ustep: 1 
iter: 2  value: 646.935 mgc: 0.1280638 ustep: 1 
iter: 3  value: 646.935 mgc: 9.741092e-05 ustep: 1 
iter: 4  mgc: 9.437873e-11 
iter: 1  mgc: 9.437873e-11 
outer mgc:  33.46157 
iter: 1  value: 636.1429 mgc: 8.162979 ustep: 1 
iter: 2  value: 636.125 mgc: 0.1531463 ustep: 1 
iter: 3  value: 636.125 mgc: 0.0004424665 ustep: 1 
iter: 4  mgc: 2.453672e-09 
iter: 1  mgc: 2.453672e-09 
outer mgc:  32.99475 
iter: 1  value: 625.1128 mgc: 11.44544 ustep: 1 
iter: 2  value: 624.6654 mgc: 0.980558 ustep: 1 
iter: 3  value: 624.6654 mgc: 0.006236982 ustep: 1 
iter: 4  value: 624.6654 mgc: 3.794181e-07 ustep: 1 
iter: 5  mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  52.00647 
iter: 1  value: 627.9929 mgc: 24.21762 ustep: 1 
iter: 2  value: 627.8819 mgc: 0.9157019 ustep: 1 
iter: 3  value: 627.8819 mgc: 0.001218063 ustep: 1 
iter: 4  mgc: 7.746284e-09 
iter: 1  value: 620.4523 mgc: 12.56011 ustep: 1 
iter: 2  value: 620.4332 mgc: 0.2834222 ustep: 1 
iter: 3  value: 620.4332 mgc: 0.0003429189 ustep: 1 
iter: 4  mgc: 5.858007e-10 
iter: 1  mgc: 5.858007e-10 
outer mgc:  44.76207 
iter: 1  value: 616.7229 mgc: 6.299664 ustep: 1 
iter: 2  value: 616.7045 mgc: 0.2313676 ustep: 1 
iter: 3  value: 616.7045 mgc: 0.0002795772 ustep: 1 
iter: 4  mgc: 6.418825e-10 
iter: 1  mgc: 6.418825e-10 
outer mgc:  46.13115 
iter: 1  value: 612.7369 mgc: 7.867565 ustep: 1 
iter: 2  value: 612.7363 mgc: 0.06848512 ustep: 1 
iter: 3  value: 612.7363 mgc: 4.97201e-06 ustep: 1 
iter: 4  mgc: 1.549871e-13 
iter: 1  mgc: 1.549871e-13 
outer mgc:  28.54193 
iter: 1  value: 611.8197 mgc: 7.129743 ustep: 1 
iter: 2  value: 611.8126 mgc: 0.2725616 ustep: 1 
iter: 3  value: 611.8126 mgc: 0.0006500682 ustep: 1 
iter: 4  mgc: 3.532711e-09 
iter: 1  value: 611.8843 mgc: 5.192441 ustep: 1 
iter: 2  value: 611.8824 mgc: 0.06159354 ustep: 1 
iter: 3  value: 611.8824 mgc: 3.383377e-05 ustep: 1 
iter: 4  mgc: 1.24607e-11 
iter: 1  mgc: 1.24607e-11 
outer mgc:  27.12283 
iter: 1  value: 610.9246 mgc: 5.297833 ustep: 1 
iter: 2  value: 610.924 mgc: 0.07689148 ustep: 1 
iter: 3  value: 610.924 mgc: 2.122882e-05 ustep: 1 
iter: 4  mgc: 9.139356e-13 
iter: 1  value: 610.5416 mgc: 2.839389 ustep: 1 
iter: 2  value: 610.5415 mgc: 0.02005367 ustep: 1 
iter: 3  value: 610.5415 mgc: 1.733773e-06 ustep: 1 
iter: 4  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  6.863881 
iter: 1  value: 610.2752 mgc: 0.905172 ustep: 1 
iter: 2  value: 610.2752 mgc: 0.008407347 ustep: 1 
iter: 3  value: 610.2752 mgc: 7.308173e-07 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  5.913311 
iter: 1  value: 610.1962 mgc: 0.6196536 ustep: 1 
iter: 2  value: 610.1962 mgc: 0.002057513 ustep: 1 
iter: 3  value: 610.1962 mgc: 4.697474e-08 ustep: 1 
mgc: 4.007905e-14 
iter: 1  mgc: 4.007905e-14 
outer mgc:  3.165923 
iter: 1  value: 609.4348 mgc: 1.800543 ustep: 1 
iter: 2  value: 609.4348 mgc: 0.005898253 ustep: 1 
iter: 3  value: 609.4348 mgc: 1.143954e-07 ustep: 1 
iter: 4  mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  9.498911 
iter: 1  value: 608.1979 mgc: 2.16023 ustep: 1 
iter: 2  value: 608.1979 mgc: 0.01327748 ustep: 1 
iter: 3  value: 608.1979 mgc: 7.80724e-07 ustep: 1 
iter: 4  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  10.13152 
iter: 1  value: 608.475 mgc: 1.173234 ustep: 1 
iter: 2  value: 608.475 mgc: 0.01057939 ustep: 1 
iter: 3  value: 608.475 mgc: 1.190374e-06 ustep: 1 
iter: 4  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  6.968489 
iter: 1  value: 609.6207 mgc: 1.642367 ustep: 1 
iter: 2  value: 609.6207 mgc: 0.009045193 ustep: 1 
iter: 3  value: 609.6207 mgc: 3.302062e-07 ustep: 1 
iter: 4  mgc: 3.520795e-14 
iter: 1  value: 608.2975 mgc: 0.3280257 ustep: 1 
iter: 2  value: 608.2975 mgc: 0.0002896078 ustep: 1 
iter: 3  mgc: 3.474188e-10 
iter: 1  mgc: 3.474188e-10 
outer mgc:  6.197006 
iter: 1  value: 608.3503 mgc: 0.8909288 ustep: 1 
iter: 2  value: 608.3503 mgc: 0.001417192 ustep: 1 
iter: 3  value: 608.3503 mgc: 1.088939e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  value: 608.3656 mgc: 0.5827699 ustep: 1 
iter: 2  value: 608.3656 mgc: 0.0008373085 ustep: 1 
iter: 3  mgc: 2.802899e-09 
iter: 1  mgc: 2.802899e-09 
outer mgc:  4.407005 
iter: 1  value: 608.265 mgc: 0.3929749 ustep: 1 
iter: 2  value: 608.265 mgc: 0.0004719339 ustep: 1 
iter: 3  mgc: 1.006121e-09 
iter: 1  mgc: 1.006121e-09 
outer mgc:  0.9197819 
iter: 1  value: 608.2164 mgc: 0.1681931 ustep: 1 
iter: 2  value: 608.2164 mgc: 9.388001e-05 ustep: 1 
iter: 3  mgc: 7.634338e-11 
iter: 1  mgc: 7.634338e-11 
outer mgc:  1.708032 
iter: 1  value: 608.0873 mgc: 0.1876884 ustep: 1 
iter: 2  value: 608.0873 mgc: 0.0001489443 ustep: 1 
iter: 3  mgc: 9.976375e-11 
iter: 1  value: 607.8934 mgc: 0.2923093 ustep: 1 
iter: 2  value: 607.8934 mgc: 0.0001402556 ustep: 1 
iter: 3  mgc: 1.686002e-10 
iter: 1  mgc: 1.686002e-10 
outer mgc:  1.473654 
iter: 1  value: 607.1439 mgc: 0.8677161 ustep: 1 
iter: 2  value: 607.1439 mgc: 0.001917851 ustep: 1 
iter: 3  value: 607.1439 mgc: 2.096299e-08 ustep: 1 
mgc: 3.885781e-14 
iter: 1  mgc: 3.885781e-14 
outer mgc:  2.519823 
iter: 1  value: 607.4395 mgc: 0.8655268 ustep: 1 
iter: 2  value: 607.4395 mgc: 0.004815969 ustep: 1 
iter: 3  value: 607.4395 mgc: 5.460594e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  value: 607.2671 mgc: 0.3702069 ustep: 1 
iter: 2  value: 607.2671 mgc: 0.0008954831 ustep: 1 
iter: 3  value: 607.2671 mgc: 1.305206e-08 ustep: 1 
mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  1.698706 
iter: 1  value: 607.5437 mgc: 0.3403835 ustep: 1 
iter: 2  value: 607.5437 mgc: 0.0009970406 ustep: 1 
iter: 3  mgc: 8.34509e-09 
iter: 1  mgc: 8.34509e-09 
outer mgc:  1.353288 
iter: 1  value: 607.3221 mgc: 0.3161941 ustep: 1 
iter: 2  value: 607.3221 mgc: 0.0004062748 ustep: 1 
iter: 3  mgc: 1.673354e-09 
iter: 1  mgc: 1.673354e-09 
outer mgc:  0.9684679 
iter: 1  value: 607.2396 mgc: 0.3570511 ustep: 1 
iter: 2  value: 607.2396 mgc: 0.0005445446 ustep: 1 
iter: 3  mgc: 4.026816e-09 
iter: 1  value: 607.2844 mgc: 0.1652035 ustep: 1 
iter: 2  value: 607.2844 mgc: 8.675542e-05 ustep: 1 
iter: 3  mgc: 1.143601e-10 
iter: 1  mgc: 1.143601e-10 
outer mgc:  0.3743076 
iter: 1  value: 607.2246 mgc: 0.1054792 ustep: 1 
iter: 2  value: 607.2246 mgc: 2.801474e-05 ustep: 1 
iter: 3  mgc: 4.436451e-12 
iter: 1  mgc: 4.436451e-12 
outer mgc:  0.3716525 
iter: 1  value: 607.256 mgc: 0.04217306 ustep: 1 
iter: 2  value: 607.256 mgc: 3.858065e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  0.06078989 
iter: 1  value: 607.2557 mgc: 0.0119423 ustep: 1 
iter: 2  value: 607.2557 mgc: 5.994805e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  0.02938463 
iter: 1  value: 607.2548 mgc: 0.004216834 ustep: 1 
iter: 2  value: 607.2548 mgc: 6.507181e-08 ustep: 1 
mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  0.00144926 
iter: 1  value: 607.2548 mgc: 9.565647e-05 ustep: 1 
iter: 2  mgc: 5.975132e-11 
iter: 1  mgc: 5.975132e-11 
outer mgc:  0.0002869582 
iter: 1  mgc: 5.975132e-11 
iter: 1  mgc: 5.975132e-11 
outer mgc:  0.0002869582 
iter: 1  value: 607.2521 mgc: 0.04007065 ustep: 1 
iter: 2  value: 607.2521 mgc: 5.795731e-06 ustep: 1 
iter: 3  mgc: 1.49214e-13 
outer mgc:  0.4278838 
iter: 1  value: 607.2579 mgc: 0.04005405 ustep: 1 
iter: 2  value: 607.2579 mgc: 5.798948e-06 ustep: 1 
iter: 3  mgc: 1.438849e-13 
outer mgc:  0.428254 
iter: 1  value: 607.2531 mgc: 0.01812236 ustep: 1 
iter: 2  value: 607.2531 mgc: 1.336944e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.4091877 
iter: 1  value: 607.2569 mgc: 0.01811088 ustep: 1 
iter: 2  value: 607.2569 mgc: 1.336277e-06 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.4091069 
iter: 1  value: 607.2582 mgc: 0.04627325 ustep: 1 
iter: 2  value: 607.2582 mgc: 2.886157e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.4886734 
iter: 1  value: 607.2519 mgc: 0.04627508 ustep: 1 
iter: 2  value: 607.2519 mgc: 2.881291e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.4883613 
iter: 1  value: 607.2605 mgc: 0.02697946 ustep: 1 
iter: 2  value: 607.2605 mgc: 6.51093e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.6017023 
iter: 1  value: 607.2497 mgc: 0.02698833 ustep: 1 
iter: 2  value: 607.2497 mgc: 6.538525e-07 ustep: 1 
iter: 3  mgc: 4.063416e-14 
outer mgc:  0.6012726 
iter: 1  value: 607.2483 mgc: 0.005426743 ustep: 1 
iter: 2  value: 607.2483 mgc: 1.570192e-07 ustep: 1 
mgc: 2.797762e-14 
outer mgc:  0.008157184 
iter: 1  value: 607.2613 mgc: 0.00542453 ustep: 1 
iter: 2  value: 607.2613 mgc: 1.570953e-07 ustep: 1 
mgc: 2.797762e-14 
outer mgc:  0.008128209 
iter: 1  value: 607.2685 mgc: 0.02605351 ustep: 1 
iter: 2  value: 607.2685 mgc: 3.980084e-06 ustep: 1 
iter: 3  mgc: 1.358913e-13 
outer mgc:  0.2216669 
iter: 1  value: 607.2413 mgc: 0.02612311 ustep: 1 
iter: 2  value: 607.2413 mgc: 3.990344e-06 ustep: 1 
iter: 3  mgc: 1.39444e-13 
outer mgc:  0.2219458 
iter: 1  value: 607.2632 mgc: 0.02369754 ustep: 1 
iter: 2  value: 607.2632 mgc: 1.989025e-06 ustep: 1 
iter: 3  mgc: 3.436834e-14 
outer mgc:  0.2442073 
iter: 1  value: 607.2466 mgc: 0.02375195 ustep: 1 
iter: 2  value: 607.2466 mgc: 1.99006e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.244584 
[Sat Aug 14 00:03:21 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:33:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_10_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2231.281558 
final  value 2069.023312 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1986.672 mgc: 2.256316 ustep: 1 
iter: 2  value: 1986.421 mgc: 0.8863805 ustep: 1 
iter: 3  value: 1986.42 mgc: 0.01637882 ustep: 1 
iter: 4  value: 1986.42 mgc: 2.674693e-05 ustep: 1 
iter: 5  mgc: 1.023409e-10 
iter: 1  mgc: 1.023409e-10 
Matching hessian patterns... Done
outer mgc:  11.90761 
iter: 1  value: 1967.158 mgc: 0.5239361 ustep: 1 
iter: 2  value: 1967.158 mgc: 0.01880402 ustep: 1 
iter: 3  value: 1967.158 mgc: 1.721538e-05 ustep: 1 
iter: 4  mgc: 1.428757e-11 
iter: 1  value: 1950.57 mgc: 3.785211 ustep: 1 
iter: 2  value: 1950.565 mgc: 0.2194033 ustep: 1 
iter: 3  value: 1950.565 mgc: 0.001623277 ustep: 1 
iter: 4  value: 1950.565 mgc: 5.190483e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  15.8519 
iter: 1  value: 2007.788 mgc: 83.63615 ustep: 0.2494656 
iter: 2  value: 1999.446 mgc: 10.48774 ustep: 0.2925213 
iter: 3  value: 1955.139 mgc: 10.32237 ustep: 0.1768161 
iter: 4  value: 1950.96 mgc: 7.368752 ustep: 0.420553 
iter: 5  value: 1950.938 mgc: 0.6125676 ustep: 0.6485357 
iter: 6  value: 1950.938 mgc: 0.02257829 ustep: 0.8053366 
iter: 7  value: 1950.938 mgc: 0.0005916689 ustep: 0.8974158 
iter: 8  value: 1950.938 mgc: 7.60812e-06 ustep: 0.9473256 
iter: 9  value: 1950.938 mgc: 4.798621e-08 ustep: 0.9733092 
mgc: 1.497604e-10 
iter: 1  value: 1951.345 mgc: 5.30497 ustep: 1 
iter: 2  value: 1948.745 mgc: 2.036376 ustep: 1 
iter: 3  value: 1948.74 mgc: 0.1219506 ustep: 1 
iter: 4  value: 1948.74 mgc: 0.00104061 ustep: 1 
iter: 5  value: 1948.74 mgc: 7.072837e-08 ustep: 1 
iter: 6  mgc: 5.717649e-15 
iter: 1  mgc: 5.717649e-15 
outer mgc:  16.18477 
iter: 1  value: 1945.036 mgc: 5.27837 ustep: 1 
iter: 2  value: 1945.028 mgc: 0.1344523 ustep: 1 
iter: 3  value: 1945.028 mgc: 0.001596748 ustep: 1 
iter: 4  value: 1945.028 mgc: 2.176749e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  11.9148 
iter: 1  value: 1937.267 mgc: 14.38586 ustep: 1 
iter: 2  value: 1937.179 mgc: 1.032128 ustep: 1 
iter: 3  value: 1937.179 mgc: 0.01056262 ustep: 1 
iter: 4  value: 1937.179 mgc: 6.91335e-06 ustep: 1 
iter: 5  mgc: 1.359801e-12 
iter: 1  mgc: 1.359801e-12 
outer mgc:  15.03998 
iter: 1  value: 1926.662 mgc: 9.911701 ustep: 1 
iter: 2  value: 1926.661 mgc: 0.1083753 ustep: 1 
iter: 3  value: 1926.661 mgc: 0.0001399708 ustep: 1 
iter: 4  mgc: 7.824763e-11 
iter: 1  mgc: 7.824763e-11 
outer mgc:  12.14156 
iter: 1  value: 1928.356 mgc: 5.289088 ustep: 1 
iter: 2  value: 1928.356 mgc: 0.0502272 ustep: 1 
iter: 3  value: 1928.356 mgc: 6.494102e-06 ustep: 1 
iter: 4  mgc: 8.967826e-14 
iter: 1  value: 1925.273 mgc: 3.347109 ustep: 1 
iter: 2  value: 1925.273 mgc: 0.02523556 ustep: 1 
iter: 3  value: 1925.273 mgc: 6.70347e-07 ustep: 1 
iter: 4  mgc: 4.926615e-15 
iter: 1  mgc: 4.926615e-15 
outer mgc:  5.522076 
iter: 1  value: 1923.008 mgc: 3.020974 ustep: 1 
iter: 2  value: 1923.008 mgc: 0.03766811 ustep: 1 
iter: 3  value: 1923.008 mgc: 7.992516e-06 ustep: 1 
iter: 4  mgc: 8.029133e-13 
iter: 1  mgc: 8.029133e-13 
outer mgc:  4.862709 
iter: 1  value: 1923.44 mgc: 3.276358 ustep: 1 
iter: 2  value: 1923.44 mgc: 0.009382306 ustep: 1 
iter: 3  value: 1923.44 mgc: 2.958756e-07 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  value: 1922.817 mgc: 1.036695 ustep: 1 
iter: 2  value: 1922.817 mgc: 0.001445196 ustep: 1 
iter: 3  value: 1922.817 mgc: 2.07908e-08 ustep: 1 
mgc: 5.884182e-15 
iter: 1  mgc: 5.884182e-15 
outer mgc:  4.755301 
iter: 1  value: 1921.88 mgc: 1.650264 ustep: 1 
iter: 2  value: 1921.88 mgc: 0.000844969 ustep: 1 
iter: 3  mgc: 2.805451e-09 
iter: 1  mgc: 2.805451e-09 
outer mgc:  0.8693637 
iter: 1  value: 1921.24 mgc: 0.31453 ustep: 1 
iter: 2  value: 1921.24 mgc: 0.0001119126 ustep: 1 
iter: 3  mgc: 3.432904e-11 
iter: 1  mgc: 3.432904e-11 
outer mgc:  1.887223 
iter: 1  value: 1920.555 mgc: 0.5670223 ustep: 1 
iter: 2  value: 1920.555 mgc: 0.0002422787 ustep: 1 
iter: 3  mgc: 3.809994e-10 
iter: 1  mgc: 3.809994e-10 
outer mgc:  0.2597518 
iter: 1  value: 1919.843 mgc: 0.3883774 ustep: 1 
iter: 2  value: 1919.843 mgc: 0.0002802793 ustep: 1 
iter: 3  mgc: 2.995799e-10 
iter: 1  mgc: 2.995799e-10 
outer mgc:  0.3309759 
iter: 1  value: 1919.053 mgc: 0.4916475 ustep: 1 
iter: 2  value: 1919.053 mgc: 0.0002577904 ustep: 1 
iter: 3  mgc: 1.823866e-10 
iter: 1  value: 1917.515 mgc: 0.9660616 ustep: 1 
iter: 2  value: 1917.515 mgc: 0.0007943834 ustep: 1 
iter: 3  mgc: 1.225228e-09 
iter: 1  mgc: 1.225228e-09 
outer mgc:  0.5448143 
iter: 1  value: 1914.971 mgc: 1.417405 ustep: 1 
iter: 2  value: 1914.971 mgc: 0.0008893669 ustep: 1 
iter: 3  mgc: 1.619915e-09 
iter: 1  mgc: 1.619915e-09 
outer mgc:  0.4215281 
iter: 1  value: 1912.402 mgc: 1.418017 ustep: 1 
iter: 2  value: 1912.402 mgc: 0.0007337053 ustep: 1 
iter: 3  mgc: 6.185878e-10 
iter: 1  mgc: 6.185878e-10 
outer mgc:  0.2305238 
iter: 1  value: 1909.849 mgc: 1.411614 ustep: 1 
iter: 2  value: 1909.849 mgc: 0.000437423 ustep: 1 
iter: 3  mgc: 1.20842e-10 
iter: 1  mgc: 1.20842e-10 
outer mgc:  0.1728013 
iter: 1  value: 1907.238 mgc: 1.41087 ustep: 1 
iter: 2  value: 1907.238 mgc: 0.0003532577 ustep: 1 
iter: 3  mgc: 2.919442e-11 
iter: 1  mgc: 2.919442e-11 
outer mgc:  0.06153525 
iter: 1  value: 1905.316 mgc: 1.016591 ustep: 1 
iter: 2  value: 1905.316 mgc: 0.0001265665 ustep: 1 
iter: 3  mgc: 3.309353e-12 
iter: 1  mgc: 3.309353e-12 
outer mgc:  0.03131885 
iter: 1  value: 1903.522 mgc: 0.9190423 ustep: 1 
iter: 2  value: 1903.522 mgc: 7.515608e-05 ustep: 1 
iter: 3  mgc: 8.277823e-13 
iter: 1  mgc: 8.277823e-13 
outer mgc:  0.01714197 
iter: 1  value: 1902.485 mgc: 0.5093923 ustep: 1 
iter: 2  value: 1902.485 mgc: 1.893122e-05 ustep: 1 
iter: 3  mgc: 4.374279e-14 
iter: 1  mgc: 4.374279e-14 
outer mgc:  0.005664675 
iter: 1  value: 1901.81 mgc: 0.341617 ustep: 1 
iter: 2  value: 1901.81 mgc: 6.125112e-06 ustep: 1 
iter: 3  mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  0.005161197 
iter: 1  value: 1901.133 mgc: 0.3739306 ustep: 1 
iter: 2  value: 1901.133 mgc: 4.14775e-06 ustep: 1 
iter: 3  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.01061767 
iter: 1  value: 1900.223 mgc: 0.5886854 ustep: 1 
iter: 2  value: 1900.223 mgc: 3.476712e-06 ustep: 1 
iter: 3  mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.0179429 
iter: 1  value: 1899.144 mgc: 0.9270571 ustep: 1 
iter: 2  value: 1899.144 mgc: 2.527029e-06 ustep: 1 
iter: 3  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  0.02657307 
iter: 1  value: 1898.242 mgc: 1.439349 ustep: 1 
iter: 2  value: 1898.242 mgc: 1.931314e-05 ustep: 1 
iter: 3  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.03384839 
iter: 1  value: 1898.495 mgc: 1.959507 ustep: 1 
iter: 2  value: 1898.495 mgc: 0.0002564193 ustep: 1 
iter: 3  mgc: 2.022271e-12 
iter: 1  mgc: 2.022271e-12 
outer mgc:  0.02351301 
iter: 1  value: 1899.527 mgc: 0.7030217 ustep: 1 
iter: 2  value: 1899.527 mgc: 0.0001026141 ustep: 1 
iter: 3  mgc: 1.657008e-12 
iter: 1  mgc: 1.657008e-12 
outer mgc:  0.02104346 
iter: 1  value: 1901.669 mgc: 3.470345 ustep: 1 
iter: 2  value: 1901.669 mgc: 0.0001133096 ustep: 1 
iter: 3  mgc: 1.79361e-11 
iter: 1  mgc: 1.79361e-11 
outer mgc:  0.03197888 
iter: 1  value: 1903.134 mgc: 4.411918 ustep: 1 
iter: 2  value: 1903.134 mgc: 8.952379e-05 ustep: 1 
iter: 3  mgc: 4.296119e-12 
iter: 1  mgc: 4.296119e-12 
outer mgc:  0.0471962 
iter: 1  value: 1902.377 mgc: 1.431944 ustep: 1 
iter: 2  value: 1902.377 mgc: 3.905104e-05 ustep: 1 
iter: 3  mgc: 8.582024e-14 
iter: 1  mgc: 8.582024e-14 
outer mgc:  0.02370028 
iter: 1  value: 1901.691 mgc: 1.624234 ustep: 1 
iter: 2  value: 1901.691 mgc: 3.468055e-06 ustep: 1 
iter: 3  mgc: 1.132427e-14 
iter: 1  value: 1900.9 mgc: 2.189807 ustep: 1 
iter: 2  value: 1900.9 mgc: 5.013429e-06 ustep: 1 
iter: 3  mgc: 1.176836e-14 
iter: 1  mgc: 1.176836e-14 
outer mgc:  0.01219222 
iter: 1  value: 1899.391 mgc: 1.323288 ustep: 1 
iter: 2  value: 1899.391 mgc: 2.304095e-06 ustep: 1 
iter: 3  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.01689056 
iter: 1  value: 1897.542 mgc: 2.576342 ustep: 1 
iter: 2  value: 1897.542 mgc: 1.111901e-05 ustep: 1 
iter: 3  mgc: 4.92939e-14 
iter: 1  mgc: 4.92939e-14 
outer mgc:  0.006773374 
iter: 1  value: 1895.775 mgc: 2.993767 ustep: 1 
iter: 2  value: 1895.775 mgc: 4.463213e-06 ustep: 1 
iter: 3  mgc: 3.130829e-14 
iter: 1  mgc: 3.130829e-14 
outer mgc:  0.0004899566 
iter: 1  value: 1894.47 mgc: 1.52767 ustep: 1 
iter: 2  value: 1894.47 mgc: 3.277146e-06 ustep: 1 
iter: 3  mgc: 4.651834e-14 
iter: 1  mgc: 4.651834e-14 
outer mgc:  0.004330453 
iter: 1  value: 1892.335 mgc: 2.233707 ustep: 1 
iter: 2  value: 1892.335 mgc: 2.384158e-07 ustep: 1 
mgc: 5.240253e-14 
iter: 1  mgc: 5.240253e-14 
outer mgc:  0.00521475 
iter: 1  value: 1890.654 mgc: 4.681403 ustep: 1 
iter: 2  value: 1890.654 mgc: 4.478395e-07 ustep: 1 
iter: 3  mgc: 1.721956e-13 
iter: 1  mgc: 1.721956e-13 
outer mgc:  0.003421861 
iter: 1  value: 1888.486 mgc: 2.168383 ustep: 1 
iter: 2  value: 1888.486 mgc: 5.667437e-07 ustep: 1 
iter: 3  mgc: 1.909584e-13 
iter: 1  mgc: 1.909584e-13 
outer mgc:  0.0002893153 
iter: 1  value: 1886.782 mgc: 4.412449 ustep: 1 
iter: 2  value: 1886.782 mgc: 8.852043e-08 ustep: 1 
mgc: 1.963985e-13 
iter: 1  mgc: 1.963985e-13 
outer mgc:  0.0007084489 
iter: 1  value: 1884.682 mgc: 1.949007 ustep: 1 
iter: 2  mgc: 9.296007e-09 
iter: 1  mgc: 9.296007e-09 
outer mgc:  0.0006962533 
iter: 1  value: 1882.977 mgc: 1.65898 ustep: 1 
iter: 2  value: 1882.977 mgc: 3.243026e-08 ustep: 1 
mgc: 4.102274e-13 
iter: 1  mgc: 4.102274e-13 
outer mgc:  0.0001682717 
iter: 1  value: 1880.884 mgc: 2.643869 ustep: 1 
iter: 2  value: 1880.884 mgc: 1.3445e-08 ustep: 1 
mgc: 8.224532e-13 
iter: 1  mgc: 8.224532e-13 
outer mgc:  0.0002843816 
iter: 1  value: 1879.157 mgc: 1.965316 ustep: 1 
iter: 2  mgc: 3.950952e-09 
iter: 1  mgc: 3.950952e-09 
outer mgc:  0.0003571007 
iter: 1  value: 1877.06 mgc: 2.124108 ustep: 1 
iter: 2  mgc: 6.474811e-10 
iter: 1  mgc: 6.474811e-10 
outer mgc:  0.0002025355 
iter: 1  value: 1875.328 mgc: 3.695625 ustep: 1 
iter: 2  mgc: 4.454375e-10 
iter: 1  mgc: 4.454375e-10 
outer mgc:  5.937664e-05 
iter: 1  value: 1873.23 mgc: 2.743071 ustep: 1 
iter: 2  mgc: 2.741777e-10 
iter: 1  mgc: 2.741777e-10 
outer mgc:  4.00034e-05 
iter: 1  value: 1871.499 mgc: 1.88577 ustep: 1 
iter: 2  mgc: 8.3058e-11 
iter: 1  mgc: 8.3058e-11 
outer mgc:  4.287062e-05 
iter: 1  value: 1869.402 mgc: 1.9478 ustep: 1 
iter: 2  mgc: 9.806811e-11 
iter: 1  mgc: 9.806811e-11 
outer mgc:  9.7056e-06 
iter: 1  value: 1867.669 mgc: 1.588146 ustep: 1 
iter: 2  mgc: 4.62046e-11 
iter: 1  mgc: 4.62046e-11 
outer mgc:  1.32258e-05 
iter: 1  mgc: 4.62046e-11 
iter: 1  mgc: 4.62046e-11 
outer mgc:  1.32258e-05 
iter: 1  value: 1867.67 mgc: 0.005939705 ustep: 1 
iter: 2  mgc: 9.341033e-09 
outer mgc:  0.05463413 
iter: 1  value: 1867.669 mgc: 0.005939718 ustep: 1 
iter: 2  mgc: 9.318275e-09 
outer mgc:  0.05463442 
iter: 1  value: 1867.669 mgc: 0.002992649 ustep: 1 
iter: 2  mgc: 1.940074e-09 
outer mgc:  0.02850072 
iter: 1  value: 1867.669 mgc: 0.002992727 ustep: 1 
iter: 2  mgc: 1.920594e-09 
outer mgc:  0.02850987 
iter: 1  value: 1867.67 mgc: 0.005674236 ustep: 1 
iter: 2  mgc: 1.344114e-09 
outer mgc:  0.04511684 
iter: 1  value: 1867.669 mgc: 0.005671214 ustep: 1 
iter: 2  mgc: 1.342661e-09 
outer mgc:  0.04508559 
iter: 1  value: 1867.669 mgc: 0.002933658 ustep: 1 
iter: 2  mgc: 2.581531e-10 
outer mgc:  0.02483975 
iter: 1  value: 1867.669 mgc: 0.002932289 ustep: 1 
iter: 2  mgc: 2.599685e-10 
outer mgc:  0.02482038 
iter: 1  value: 1867.679 mgc: 68.30001 ustep: 1 
iter: 2  value: 1867.679 mgc: 3.323493e-08 ustep: 1 
mgc: 1.494871e-11 
outer mgc:  0.0006880073 
iter: 1  value: 1867.66 mgc: 68.36834 ustep: 1 
iter: 2  value: 1867.66 mgc: 3.310737e-08 ustep: 1 
mgc: 6.030398e-12 
outer mgc:  0.0006603516 
iter: 1  value: 1867.679 mgc: 68.22998 ustep: 1 
iter: 2  value: 1867.679 mgc: 1.038742e-08 ustep: 1 
mgc: 1.402589e-11 
outer mgc:  0.0001851118 
iter: 1  value: 1867.659 mgc: 68.43498 ustep: 1 
iter: 2  value: 1867.659 mgc: 1.035895e-08 ustep: 1 
mgc: 7.267076e-12 
outer mgc:  0.0001688079 
iter: 1  value: 1867.669 mgc: 6.432463e-05 ustep: 1 
mgc: 1.91136e-11 
outer mgc:  1.322556e-05 
iter: 1  value: 1867.669 mgc: 6.432409e-05 ustep: 1 
mgc: 1.975486e-11 
outer mgc:  1.322605e-05 
iter: 1  value: 1867.669 mgc: 0.004208229 ustep: 1 
iter: 2  mgc: 5.590316e-09 
outer mgc:  0.0170652 
iter: 1  value: 1867.67 mgc: 0.004205355 ustep: 1 
iter: 2  mgc: 5.593842e-09 
outer mgc:  0.01708585 
[Fri Aug 13 11:33:05 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:53:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4303.264335 
final  value 3683.655870 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3508.591 mgc: 3.336765 ustep: 1 
iter: 2  value: 3503.562 mgc: 3.7753 ustep: 1 
iter: 3  value: 3491.347 mgc: 3.641745 ustep: 0.4605891 
iter: 4  value: 3489.456 mgc: 2.601752 ustep: 0.6786993 
iter: 5  value: 3489.372 mgc: 0.518626 ustep: 0.8238497 
iter: 6  value: 3489.371 mgc: 0.05118404 ustep: 0.9076709 
iter: 7  value: 3489.371 mgc: 0.004156101 ustep: 0.9527224 
iter: 8  value: 3489.371 mgc: 0.0002305325 ustep: 0.9760774 
iter: 9  value: 3489.371 mgc: 7.472177e-06 ustep: 0.9879675 
iter: 10  value: 3489.371 mgc: 1.275506e-07 ustep: 0.9939661 
iter: 11  mgc: 1.105166e-09 
iter: 1  mgc: 1.105166e-09 
Matching hessian patterns... Done
outer mgc:  18.99125 
iter: 1  value: 3455.666 mgc: 0.7167061 ustep: 1 
iter: 2  value: 3455.665 mgc: 0.03742525 ustep: 1 
iter: 3  value: 3455.665 mgc: 0.0002096145 ustep: 1 
iter: 4  value: 3455.665 mgc: 1.264567e-08 ustep: 1 
iter: 5  mgc: 2.442491e-15 
iter: 1  value: 3400.319 mgc: 108.8576 ustep: 1 
iter: 2  value: 3397.836 mgc: 3.474439 ustep: 1 
iter: 3  value: 3397.827 mgc: 0.2305407 ustep: 1 
iter: 4  value: 3397.827 mgc: 0.002592511 ustep: 1 
iter: 5  value: 3397.827 mgc: 3.792908e-07 ustep: 1 
iter: 6  mgc: 1.376677e-14 
iter: 1  mgc: 1.376677e-14 
outer mgc:  28.879 
iter: 1  value: 3378.834 mgc: 93.22775 ustep: 1 
iter: 2  value: 3375.514 mgc: 2.432677 ustep: 1 
iter: 3  value: 3375.514 mgc: 0.03621066 ustep: 1 
iter: 4  value: 3375.514 mgc: 1.678218e-05 ustep: 1 
iter: 5  mgc: 3.587353e-12 
iter: 1  mgc: 3.587353e-12 
outer mgc:  30.40536 
iter: 1  value: 3469.367 mgc: 9.625572 ustep: 1 
iter: 2  value: 3424.773 mgc: 13.54706 ustep: 1 
iter: 3  value: 3422.192 mgc: 5.563593 ustep: 1 
iter: 4  value: 3422.125 mgc: 1.105902 ustep: 1 
iter: 5  value: 3422.125 mgc: 0.006575072 ustep: 1 
iter: 6  value: 3422.125 mgc: 1.485102e-07 ustep: 1 
iter: 7  mgc: 1.865175e-14 
iter: 1  value: 3352.616 mgc: 3.411677 ustep: 1 
iter: 2  value: 3352.615 mgc: 0.03903783 ustep: 1 
iter: 3  value: 3352.615 mgc: 4.0331e-06 ustep: 1 
iter: 4  mgc: 9.714451e-15 
iter: 1  mgc: 9.714451e-15 
outer mgc:  17.24023 
iter: 1  value: 3339.486 mgc: 11.65586 ustep: 1 
iter: 2  value: 3339.486 mgc: 0.001740507 ustep: 1 
iter: 3  value: 3339.486 mgc: 1.306544e-08 ustep: 1 
mgc: 1.532108e-14 
iter: 1  mgc: 1.532108e-14 
outer mgc:  7.115986 
iter: 1  value: 3334.758 mgc: 20.66676 ustep: 1 
iter: 2  value: 3334.758 mgc: 0.006336038 ustep: 1 
iter: 3  value: 3334.758 mgc: 3.949753e-08 ustep: 1 
mgc: 1.545986e-14 
iter: 1  mgc: 1.545986e-14 
outer mgc:  14.90486 
iter: 1  value: 3337.29 mgc: 4.074204 ustep: 1 
iter: 2  value: 3337.29 mgc: 0.03476957 ustep: 1 
iter: 3  value: 3337.29 mgc: 4.926481e-06 ustep: 1 
iter: 4  mgc: 1.008083e-13 
iter: 1  mgc: 1.008083e-13 
outer mgc:  10.17887 
iter: 1  value: 3336.039 mgc: 31.83249 ustep: 1 
iter: 2  value: 3336.039 mgc: 0.02379891 ustep: 1 
iter: 3  value: 3336.039 mgc: 9.752324e-07 ustep: 1 
iter: 4  mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  6.186201 
iter: 1  value: 3340.117 mgc: 9.555246 ustep: 1 
iter: 2  value: 3340.117 mgc: 0.009558312 ustep: 1 
iter: 3  value: 3340.117 mgc: 4.806818e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  value: 3336.024 mgc: 1.454808 ustep: 1 
iter: 2  value: 3336.024 mgc: 0.001629624 ustep: 1 
iter: 3  mgc: 8.925876e-09 
iter: 1  mgc: 8.925876e-09 
outer mgc:  2.841928 
iter: 1  value: 3339.635 mgc: 7.864905 ustep: 1 
iter: 2  value: 3339.635 mgc: 0.0015492 ustep: 1 
iter: 3  mgc: 7.818131e-09 
iter: 1  mgc: 7.818131e-09 
outer mgc:  2.72709 
iter: 1  value: 3344.747 mgc: 6.187729 ustep: 1 
iter: 2  value: 3344.747 mgc: 0.004552742 ustep: 1 
iter: 3  value: 3344.747 mgc: 9.519714e-08 ustep: 1 
iter: 4  mgc: 5.287437e-15 
iter: 1  value: 3360.551 mgc: 8.015846 ustep: 1 
iter: 2  value: 3360.55 mgc: 0.1493377 ustep: 1 
iter: 3  value: 3360.55 mgc: 2.804465e-05 ustep: 1 
iter: 4  mgc: 2.392442e-11 
iter: 1  mgc: 2.392442e-11 
outer mgc:  10.66412 
iter: 1  value: 3379.308 mgc: 4.694189 ustep: 1 
iter: 2  value: 3379.096 mgc: 1.522725 ustep: 1 
iter: 3  value: 3379.095 mgc: 0.05030143 ustep: 1 
iter: 4  value: 3379.095 mgc: 4.436711e-05 ustep: 1 
iter: 5  mgc: 5.367395e-11 
iter: 1  value: 3362.18 mgc: 1.807901 ustep: 1 
iter: 2  value: 3362.18 mgc: 0.01505133 ustep: 1 
iter: 3  value: 3362.18 mgc: 2.528951e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  5.346658 
iter: 1  value: 3362.316 mgc: 5.065644 ustep: 1 
iter: 2  value: 3362.316 mgc: 0.01466004 ustep: 1 
iter: 3  value: 3362.316 mgc: 5.17689e-06 ustep: 1 
iter: 4  mgc: 5.777601e-13 
iter: 1  mgc: 5.777601e-13 
outer mgc:  3.170031 
iter: 1  value: 3367.356 mgc: 1.773283 ustep: 1 
iter: 2  value: 3367.355 mgc: 0.07244718 ustep: 1 
iter: 3  value: 3367.355 mgc: 7.806337e-05 ustep: 1 
iter: 4  mgc: 2.020666e-10 
iter: 1  mgc: 2.020666e-10 
outer mgc:  2.710064 
iter: 1  value: 3368.324 mgc: 7.948861 ustep: 1 
iter: 2  value: 3368.323 mgc: 0.1346123 ustep: 1 
iter: 3  value: 3368.323 mgc: 7.438096e-05 ustep: 1 
iter: 4  mgc: 7.670353e-11 
iter: 1  value: 3367.084 mgc: 1.916642 ustep: 1 
iter: 2  value: 3367.084 mgc: 0.006152278 ustep: 1 
iter: 3  value: 3367.084 mgc: 1.707297e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  1.948021 
iter: 1  value: 3367.562 mgc: 0.5998513 ustep: 1 
iter: 2  value: 3367.562 mgc: 0.001964241 ustep: 1 
iter: 3  value: 3367.562 mgc: 1.168368e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  2.785325 
iter: 1  value: 3367.565 mgc: 0.3638944 ustep: 1 
iter: 2  value: 3367.565 mgc: 0.0009538253 ustep: 1 
iter: 3  value: 3367.565 mgc: 1.806036e-08 ustep: 1 
mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.7038295 
iter: 1  value: 3367.292 mgc: 0.3844237 ustep: 1 
iter: 2  value: 3367.292 mgc: 0.0007682725 ustep: 1 
iter: 3  mgc: 7.188342e-09 
iter: 1  value: 3366.959 mgc: 0.2068355 ustep: 1 
iter: 2  value: 3366.959 mgc: 0.0001469754 ustep: 1 
iter: 3  mgc: 2.283738e-10 
iter: 1  value: 3365.557 mgc: 1.013475 ustep: 1 
iter: 2  value: 3365.557 mgc: 0.008426358 ustep: 1 
iter: 3  value: 3365.557 mgc: 7.051271e-07 ustep: 1 
iter: 4  mgc: 4.723999e-14 
iter: 1  mgc: 4.723999e-14 
outer mgc:  0.5957363 
iter: 1  value: 3360.845 mgc: 2.095883 ustep: 1 
iter: 2  value: 3360.845 mgc: 0.004666733 ustep: 1 
iter: 3  value: 3360.845 mgc: 9.223657e-08 ustep: 1 
iter: 4  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  1.590552 
iter: 1  value: 3358.861 mgc: 0.9968625 ustep: 1 
iter: 2  value: 3358.861 mgc: 0.002203137 ustep: 1 
iter: 3  value: 3358.861 mgc: 3.967641e-08 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  0.5862149 
iter: 1  value: 3356.361 mgc: 1.013686 ustep: 1 
iter: 2  value: 3356.361 mgc: 0.000569617 ustep: 1 
iter: 3  mgc: 9.158742e-09 
iter: 1  mgc: 9.158742e-09 
outer mgc:  0.3286458 
iter: 1  value: 3354.056 mgc: 1.395105 ustep: 1 
iter: 2  value: 3354.056 mgc: 0.0004417561 ustep: 1 
iter: 3  mgc: 9.773529e-10 
iter: 1  mgc: 9.773529e-10 
outer mgc:  0.3025323 
iter: 1  value: 3348.945 mgc: 4.931683 ustep: 1 
iter: 2  value: 3348.945 mgc: 0.001912199 ustep: 1 
iter: 3  value: 3348.945 mgc: 4.829837e-08 ustep: 1 
iter: 4  mgc: 2.631229e-14 
iter: 1  mgc: 2.631229e-14 
outer mgc:  1.12311 
iter: 1  value: 3344.3 mgc: 8.336851 ustep: 1 
iter: 2  value: 3344.3 mgc: 0.002173224 ustep: 1 
iter: 3  value: 3344.3 mgc: 2.170281e-07 ustep: 1 
iter: 4  mgc: 7.982504e-14 
iter: 1  mgc: 7.982504e-14 
outer mgc:  0.4878209 
iter: 1  value: 3342.135 mgc: 2.446178 ustep: 1 
iter: 2  value: 3342.135 mgc: 0.0006455126 ustep: 1 
iter: 3  mgc: 7.104946e-09 
iter: 1  mgc: 7.104946e-09 
outer mgc:  0.512169 
iter: 1  value: 3339.828 mgc: 4.277769 ustep: 1 
iter: 2  value: 3339.828 mgc: 0.0001878711 ustep: 1 
iter: 3  mgc: 1.941662e-10 
iter: 1  mgc: 1.941662e-10 
outer mgc:  0.1129216 
iter: 1  value: 3335.761 mgc: 3.487385 ustep: 1 
iter: 2  value: 3335.761 mgc: 7.590245e-05 ustep: 1 
iter: 3  mgc: 1.678035e-11 
iter: 1  mgc: 1.678035e-11 
outer mgc:  0.176847 
iter: 1  value: 3332.31 mgc: 1.453686 ustep: 1 
iter: 2  value: 3332.31 mgc: 7.147649e-06 ustep: 1 
iter: 3  mgc: 2.086997e-12 
iter: 1  mgc: 2.086997e-12 
outer mgc:  0.129665 
iter: 1  value: 3328.111 mgc: 3.968684 ustep: 1 
iter: 2  value: 3328.111 mgc: 1.546555e-05 ustep: 1 
iter: 3  mgc: 8.757439e-13 
iter: 1  mgc: 8.757439e-13 
outer mgc:  0.02230069 
iter: 1  value: 3324.627 mgc: 1.871529 ustep: 1 
iter: 2  value: 3324.627 mgc: 1.575228e-06 ustep: 1 
iter: 3  mgc: 5.220269e-13 
iter: 1  mgc: 5.220269e-13 
outer mgc:  0.01206161 
iter: 1  value: 3320.456 mgc: 1.685613 ustep: 1 
iter: 2  value: 3320.456 mgc: 1.365379e-06 ustep: 1 
iter: 3  mgc: 6.448175e-13 
iter: 1  mgc: 6.448175e-13 
outer mgc:  0.01539295 
iter: 1  value: 3316.992 mgc: 1.963558 ustep: 1 
iter: 2  value: 3316.992 mgc: 8.553825e-07 ustep: 1 
iter: 3  mgc: 6.685763e-13 
iter: 1  mgc: 6.685763e-13 
outer mgc:  0.00463767 
iter: 1  value: 3312.801 mgc: 1.852211 ustep: 1 
iter: 2  value: 3312.801 mgc: 3.214965e-07 ustep: 1 
iter: 3  mgc: 1.408873e-12 
iter: 1  mgc: 1.408873e-12 
outer mgc:  0.006232099 
iter: 1  value: 3309.328 mgc: 1.564244 ustep: 1 
iter: 2  value: 3309.328 mgc: 1.334642e-07 ustep: 1 
iter: 3  mgc: 1.968203e-12 
iter: 1  mgc: 1.968203e-12 
outer mgc:  0.004493018 
iter: 1  value: 3305.136 mgc: 2.417927 ustep: 1 
iter: 2  value: 3305.136 mgc: 7.890308e-08 ustep: 1 
iter: 3  mgc: 5.780709e-12 
iter: 1  mgc: 5.780709e-12 
outer mgc:  0.003209199 
iter: 1  value: 3301.668 mgc: 1.485596 ustep: 1 
iter: 2  value: 3301.668 mgc: 2.725363e-08 ustep: 1 
mgc: 4.017231e-12 
iter: 1  mgc: 4.017231e-12 
outer mgc:  0.001161304 
iter: 1  value: 3297.474 mgc: 1.986366 ustep: 1 
iter: 2  value: 3297.474 mgc: 1.575711e-08 ustep: 1 
mgc: 4.999112e-12 
iter: 1  mgc: 4.999112e-12 
outer mgc:  0.001621716 
iter: 1  value: 3294.007 mgc: 1.68398 ustep: 1 
iter: 2  mgc: 7.237577e-09 
iter: 1  mgc: 7.237577e-09 
outer mgc:  0.0005356726 
iter: 1  value: 3289.813 mgc: 1.832142 ustep: 1 
iter: 2  mgc: 3.359754e-09 
iter: 1  mgc: 3.359754e-09 
outer mgc:  0.0007005633 
iter: 1  value: 3286.346 mgc: 1.602454 ustep: 1 
iter: 2  mgc: 1.427519e-09 
iter: 1  mgc: 1.427519e-09 
outer mgc:  0.0002648992 
iter: 1  value: 3282.152 mgc: 2.059198 ustep: 1 
iter: 2  mgc: 7.056804e-10 
iter: 1  mgc: 7.056804e-10 
outer mgc:  0.0003203707 
iter: 1  value: 3278.686 mgc: 1.566172 ustep: 1 
iter: 2  mgc: 2.850147e-10 
iter: 1  mgc: 2.850147e-10 
outer mgc:  0.0001129443 
iter: 1  value: 3274.491 mgc: 1.973703 ustep: 1 
iter: 2  mgc: 1.696536e-10 
iter: 1  mgc: 1.696536e-10 
outer mgc:  0.0001479395 
iter: 1  value: 3271.025 mgc: 1.603921 ustep: 1 
iter: 2  mgc: 7.438361e-11 
iter: 1  mgc: 7.438361e-11 
outer mgc:  5.065355e-05 
iter: 1  value: 3266.83 mgc: 1.916693 ustep: 1 
iter: 2  mgc: 2.162892e-10 
iter: 1  mgc: 2.162892e-10 
outer mgc:  6.59048e-05 
iter: 1  value: 3263.364 mgc: 1.58446 ustep: 1 
iter: 2  mgc: 1.382663e-10 
iter: 1  mgc: 1.382663e-10 
outer mgc:  2.333604e-05 
iter: 1  mgc: 1.382663e-10 
iter: 1  mgc: 1.382663e-10 
outer mgc:  2.333604e-05 
iter: 1  value: 3263.365 mgc: 0.007507536 ustep: 1 
iter: 2  value: 3263.365 mgc: 5.750518e-07 ustep: 1 
iter: 3  mgc: 2.838449e-10 
outer mgc:  0.09571769 
iter: 1  value: 3263.363 mgc: 0.007507261 ustep: 1 
iter: 2  value: 3263.363 mgc: 5.740303e-07 ustep: 1 
iter: 3  mgc: 2.121638e-10 
outer mgc:  0.0957159 
iter: 1  value: 3263.365 mgc: 0.00383819 ustep: 1 
iter: 2  value: 3263.365 mgc: 1.012973e-07 ustep: 1 
iter: 3  mgc: 2.029827e-10 
outer mgc:  0.06097231 
iter: 1  value: 3263.363 mgc: 0.00383751 ustep: 1 
iter: 2  value: 3263.363 mgc: 1.012642e-07 ustep: 1 
iter: 3  mgc: 1.529473e-10 
outer mgc:  0.06098732 
iter: 1  value: 3263.364 mgc: 0.005703737 ustep: 1 
iter: 2  value: 3263.364 mgc: 6.076748e-08 ustep: 1 
iter: 3  mgc: 3.101598e-10 
outer mgc:  0.0840128 
iter: 1  value: 3263.363 mgc: 0.005699629 ustep: 1 
iter: 2  value: 3263.363 mgc: 6.066722e-08 ustep: 1 
iter: 3  mgc: 2.476901e-10 
outer mgc:  0.08396915 
iter: 1  value: 3263.364 mgc: 0.003623333 ustep: 1 
iter: 2  value: 3263.364 mgc: 3.409535e-08 ustep: 1 
iter: 3  mgc: 2.826699e-10 
outer mgc:  0.05185787 
iter: 1  value: 3263.363 mgc: 0.003621419 ustep: 1 
iter: 2  value: 3263.363 mgc: 3.407885e-08 ustep: 1 
iter: 3  mgc: 2.242182e-10 
outer mgc:  0.05181881 
iter: 1  value: 3263.373 mgc: 831.8548 ustep: 1 
iter: 2  value: 3263.373 mgc: 1.35816e-06 ustep: 1 
iter: 3  mgc: 2.886932e-10 
outer mgc:  0.04541361 
iter: 1  value: 3263.354 mgc: 832.6871 ustep: 1 
iter: 2  value: 3263.354 mgc: 1.35742e-06 ustep: 1 
iter: 3  mgc: 1.372169e-10 
outer mgc:  0.04533135 
iter: 1  value: 3263.381 mgc: 831.0251 ustep: 1 
iter: 2  value: 3263.381 mgc: 2.049529e-06 ustep: 1 
iter: 3  mgc: 2.033058e-10 
outer mgc:  0.03595509 
iter: 1  value: 3263.347 mgc: 833.5219 ustep: 1 
iter: 2  value: 3263.347 mgc: 2.048624e-06 ustep: 1 
iter: 3  mgc: 2.293504e-10 
outer mgc:  0.0358819 
iter: 1  value: 3263.364 mgc: 1.044799e-05 ustep: 1 
mgc: 1.859946e-10 
outer mgc:  2.333592e-05 
iter: 1  value: 3263.364 mgc: 1.044845e-05 ustep: 1 
mgc: 1.086971e-10 
outer mgc:  2.333581e-05 
iter: 1  value: 3263.359 mgc: 0.00361259 ustep: 1 
iter: 2  value: 3263.359 mgc: 1.065162e-07 ustep: 1 
iter: 3  mgc: 1.940841e-10 
outer mgc:  0.02391384 
iter: 1  value: 3263.369 mgc: 0.003610559 ustep: 1 
iter: 2  value: 3263.369 mgc: 1.064919e-07 ustep: 1 
iter: 3  mgc: 2.278524e-10 
outer mgc:  0.02393423 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:53:50 2021]
Finished job 0.
1 of 1 steps (100%) done

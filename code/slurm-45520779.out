Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:55:55 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21879.962341 
final  value 18106.479329 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17424.51 mgc: 5.036466 ustep: 0.6827823 
iter: 2  value: 17348.45 mgc: 5.452461 ustep: 0.8263238 
iter: 3  value: 17303.31 mgc: 4.274255 ustep: 0.4997611 
iter: 4  value: 17290.48 mgc: 5.383416 ustep: 0.7069672 
iter: 5  value: 17276.9 mgc: 4.589212 ustep: 0.3099192 
iter: 6  value: 17276.56 mgc: 1.018258 ustep: 0.5567482 
iter: 7  value: 17276.53 mgc: 0.213591 ustep: 0.746181 
iter: 8  value: 17276.53 mgc: 0.03567526 ustep: 0.8638313 
iter: 9  value: 17276.53 mgc: 0.004352207 ustep: 0.9294323 
iter: 10  value: 17276.53 mgc: 0.0003146449 ustep: 0.9640743 
iter: 11  value: 17276.53 mgc: 1.117268e-05 ustep: 0.9818747 
iter: 12  value: 17276.53 mgc: 1.973706e-07 ustep: 0.9908968 
iter: 13  mgc: 1.74328e-09 
iter: 1  mgc: 1.74328e-09 
Matching hessian patterns... Done
outer mgc:  105.4507 
iter: 1  value: 17107.5 mgc: 0.8159143 ustep: 1 
iter: 2  value: 17107.49 mgc: 0.07397688 ustep: 1 
iter: 3  value: 17107.49 mgc: 0.0005319362 ustep: 1 
iter: 4  value: 17107.49 mgc: 2.899029e-08 ustep: 1 
iter: 5  mgc: 3.275158e-15 
iter: 1  value: 17011.43 mgc: 10.74964 ustep: 1 
iter: 2  value: 17008.03 mgc: 1.546262 ustep: 1 
iter: 3  value: 17008.03 mgc: 0.08238733 ustep: 1 
iter: 4  value: 17008.03 mgc: 0.0004856227 ustep: 1 
iter: 5  value: 17008.03 mgc: 1.725039e-08 ustep: 1 
mgc: 9.853229e-15 
iter: 1  mgc: 3.275158e-15 
outer mgc:  65.24609 
iter: 1  value: 16974.12 mgc: 2.494906 ustep: 1 
iter: 2  value: 16974.09 mgc: 0.1991545 ustep: 1 
iter: 3  value: 16974.09 mgc: 0.001073526 ustep: 1 
iter: 4  value: 16974.09 mgc: 4.777809e-08 ustep: 1 
iter: 5  mgc: 6.64746e-15 
iter: 1  mgc: 6.64746e-15 
outer mgc:  41.01338 
iter: 1  value: 16903.04 mgc: 4.475097 ustep: 1 
iter: 2  value: 16894.42 mgc: 1.677177 ustep: 1 
iter: 3  value: 16894.4 mgc: 0.08761399 ustep: 1 
iter: 4  value: 16894.4 mgc: 0.0005167102 ustep: 1 
iter: 5  value: 16894.4 mgc: 1.915836e-08 ustep: 1 
mgc: 9.603429e-15 
iter: 1  value: 17219.98 mgc: 37.39173 ustep: 1 
iter: 2  value: 16845.91 mgc: 15.12565 ustep: 1 
iter: 3  value: 16844.22 mgc: 1.490392 ustep: 1 
iter: 4  value: 16844.22 mgc: 0.01672966 ustep: 1 
iter: 5  value: 16844.22 mgc: 7.538355e-06 ustep: 1 
iter: 6  mgc: 1.911582e-12 
iter: 1  mgc: 9.603429e-15 
outer mgc:  54.26368 
iter: 1  value: 17413.14 mgc: 17.89891 ustep: 1 
iter: 2  value: 16826.8 mgc: 11.59393 ustep: 1 
iter: 3  value: 16810.01 mgc: 4.85842 ustep: 1 
iter: 4  value: 16809.6 mgc: 1.332067 ustep: 1 
iter: 5  value: 16809.6 mgc: 0.03106497 ustep: 1 
iter: 6  value: 16809.6 mgc: 3.509552e-05 ustep: 1 
iter: 7  mgc: 3.992628e-11 
iter: 1  mgc: 3.992628e-11 
outer mgc:  148.9978 
iter: 1  value: 16973.91 mgc: 20.41064 ustep: 1 
iter: 2  value: 16973.89 mgc: 0.7077729 ustep: 1 
iter: 3  value: 16973.89 mgc: 0.0002572103 ustep: 1 
iter: 4  mgc: 5.825047e-10 
iter: 1  value: 16741.11 mgc: 3.650914 ustep: 1 
iter: 2  value: 16741.07 mgc: 0.08743377 ustep: 1 
iter: 3  value: 16741.07 mgc: 0.0002717645 ustep: 1 
iter: 4  mgc: 2.672242e-09 
iter: 1  mgc: 2.672242e-09 
outer mgc:  43.637 
iter: 1  value: 16713.69 mgc: 6.461513 ustep: 1 
iter: 2  value: 16713.69 mgc: 0.07723052 ustep: 1 
iter: 3  value: 16713.69 mgc: 6.102346e-05 ustep: 1 
iter: 4  mgc: 9.552892e-11 
iter: 1  mgc: 9.552892e-11 
outer mgc:  43.64161 
iter: 1  value: 16732.11 mgc: 7.849688 ustep: 1 
iter: 2  value: 16732.1 mgc: 0.03998123 ustep: 1 
iter: 3  value: 16732.1 mgc: 4.328129e-05 ustep: 1 
iter: 4  mgc: 1.641309e-11 
iter: 1  value: 16706.16 mgc: 1.177026 ustep: 1 
iter: 2  value: 16706.16 mgc: 0.004506685 ustep: 1 
iter: 3  value: 16706.16 mgc: 4.527107e-07 ustep: 1 
iter: 4  mgc: 9.853229e-15 
iter: 1  mgc: 9.853229e-15 
outer mgc:  17.86739 
iter: 1  value: 16698.59 mgc: 1.841021 ustep: 1 
iter: 2  value: 16698.59 mgc: 0.004420753 ustep: 1 
iter: 3  value: 16698.59 mgc: 2.451352e-07 ustep: 1 
iter: 4  mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  19.7027 
iter: 1  value: 16678.8 mgc: 2.370277 ustep: 1 
iter: 2  value: 16678.8 mgc: 0.005881158 ustep: 1 
iter: 3  value: 16678.8 mgc: 4.548157e-07 ustep: 1 
iter: 4  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  21.43306 
iter: 1  value: 16670.89 mgc: 1.355626 ustep: 1 
iter: 2  value: 16670.89 mgc: 0.007725453 ustep: 1 
iter: 3  value: 16670.89 mgc: 6.061845e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  18.3287 
iter: 1  value: 16657.91 mgc: 1.199543 ustep: 1 
iter: 2  value: 16657.91 mgc: 0.007813138 ustep: 1 
iter: 3  value: 16657.91 mgc: 4.339438e-07 ustep: 1 
iter: 4  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  15.10885 
iter: 1  value: 16649.67 mgc: 3.830538 ustep: 1 
iter: 2  value: 16649.67 mgc: 0.01096724 ustep: 1 
iter: 3  value: 16649.67 mgc: 1.12674e-06 ustep: 1 
iter: 4  mgc: 8.437695e-15 
iter: 1  value: 16654.83 mgc: 0.4888468 ustep: 1 
iter: 2  value: 16654.83 mgc: 0.0006631041 ustep: 1 
iter: 3  mgc: 4.561497e-09 
iter: 1  mgc: 4.561497e-09 
outer mgc:  12.31244 
iter: 1  value: 16652.05 mgc: 0.6161824 ustep: 1 
iter: 2  value: 16652.05 mgc: 0.0002058102 ustep: 1 
iter: 3  mgc: 4.036229e-10 
iter: 1  mgc: 4.036229e-10 
outer mgc:  18.68138 
iter: 1  value: 16650.53 mgc: 0.2630292 ustep: 1 
iter: 2  value: 16650.53 mgc: 0.0001188131 ustep: 1 
iter: 3  mgc: 1.329727e-10 
iter: 1  mgc: 1.329727e-10 
outer mgc:  4.842136 
iter: 1  value: 16646.83 mgc: 0.3554945 ustep: 1 
iter: 2  value: 16646.83 mgc: 0.0002011084 ustep: 1 
iter: 3  mgc: 5.062413e-10 
iter: 1  value: 16635.79 mgc: 1.129076 ustep: 1 
iter: 2  value: 16635.79 mgc: 0.001575201 ustep: 1 
iter: 3  value: 16635.79 mgc: 2.531669e-08 ustep: 1 
mgc: 7.554721e-15 
iter: 1  mgc: 7.554721e-15 
outer mgc:  8.176707 
iter: 1  value: 16622.14 mgc: 1.225859 ustep: 1 
iter: 2  value: 16622.14 mgc: 0.001857599 ustep: 1 
iter: 3  value: 16622.14 mgc: 1.102403e-08 ustep: 1 
mgc: 6.77236e-15 
iter: 1  mgc: 6.77236e-15 
outer mgc:  5.314087 
iter: 1  value: 16609.21 mgc: 1.274408 ustep: 1 
iter: 2  value: 16609.21 mgc: 0.0005922666 ustep: 1 
iter: 3  mgc: 1.700025e-09 
iter: 1  mgc: 1.700025e-09 
outer mgc:  6.236337 
iter: 1  value: 16597.7 mgc: 1.490099 ustep: 1 
iter: 2  value: 16597.7 mgc: 0.0009762602 ustep: 1 
iter: 3  mgc: 6.141911e-10 
iter: 1  mgc: 6.141911e-10 
outer mgc:  2.79343 
iter: 1  value: 16586.04 mgc: 1.079737 ustep: 1 
iter: 2  value: 16586.04 mgc: 0.0009920134 ustep: 1 
iter: 3  mgc: 3.384973e-09 
iter: 1  value: 16594.43 mgc: 0.3499714 ustep: 1 
iter: 2  value: 16594.43 mgc: 9.460171e-05 ustep: 1 
iter: 3  mgc: 3.793144e-11 
iter: 1  mgc: 3.793144e-11 
outer mgc:  4.907362 
iter: 1  value: 16589.94 mgc: 0.3049031 ustep: 1 
iter: 2  value: 16589.94 mgc: 0.0001015745 ustep: 1 
iter: 3  mgc: 3.945289e-11 
iter: 1  mgc: 3.945289e-11 
outer mgc:  7.543186 
iter: 1  value: 16584.96 mgc: 0.3273919 ustep: 1 
iter: 2  value: 16584.96 mgc: 9.494552e-05 ustep: 1 
iter: 3  mgc: 1.308509e-11 
iter: 1  mgc: 1.308509e-11 
outer mgc:  1.682945 
iter: 1  value: 16581.3 mgc: 0.3555914 ustep: 1 
iter: 2  value: 16581.3 mgc: 4.260296e-05 ustep: 1 
iter: 3  mgc: 4.694023e-12 
iter: 1  mgc: 4.694023e-12 
outer mgc:  4.708297 
iter: 1  value: 16575.91 mgc: 0.2870497 ustep: 1 
iter: 2  value: 16575.91 mgc: 0.0001096777 ustep: 1 
iter: 3  mgc: 3.132294e-11 
iter: 1  value: 16566.97 mgc: 0.5970864 ustep: 1 
iter: 2  value: 16566.97 mgc: 0.0002015697 ustep: 1 
iter: 3  mgc: 7.99476e-11 
iter: 1  value: 16525.76 mgc: 3.306685 ustep: 1 
iter: 2  value: 16525.76 mgc: 0.002876334 ustep: 1 
iter: 3  mgc: 8.775728e-09 
iter: 1  mgc: 8.775728e-09 
outer mgc:  9.170308 
iter: 1  value: 16470.95 mgc: 4.597928 ustep: 1 
iter: 2  value: 16470.95 mgc: 0.001817432 ustep: 1 
iter: 3  mgc: 1.55523e-09 
iter: 1  mgc: 1.55523e-09 
outer mgc:  6.409757 
iter: 1  value: 16423.85 mgc: 3.713801 ustep: 1 
iter: 2  value: 16423.85 mgc: 0.0004290008 ustep: 1 
iter: 3  mgc: 4.328626e-11 
iter: 1  value: 16461.82 mgc: 0.5332569 ustep: 1 
iter: 2  value: 16461.82 mgc: 1.160249e-05 ustep: 1 
iter: 3  mgc: 5.151435e-14 
iter: 1  mgc: 5.151435e-14 
outer mgc:  3.478498 
iter: 1  value: 16459.78 mgc: 0.3726281 ustep: 1 
iter: 2  value: 16459.78 mgc: 2.319161e-06 ustep: 1 
iter: 3  mgc: 8.104628e-15 
iter: 1  mgc: 8.104628e-15 
outer mgc:  4.930256 
iter: 1  value: 16448.97 mgc: 0.6201969 ustep: 1 
iter: 2  value: 16448.97 mgc: 3.175799e-05 ustep: 1 
iter: 3  mgc: 3.779199e-13 
iter: 1  mgc: 3.779199e-13 
outer mgc:  3.873545 
iter: 1  value: 16438.3 mgc: 0.5782187 ustep: 1 
iter: 2  value: 16438.3 mgc: 2.82952e-05 ustep: 1 
iter: 3  mgc: 2.611245e-13 
iter: 1  mgc: 2.611245e-13 
outer mgc:  2.985299 
iter: 1  value: 16415.23 mgc: 1.648826 ustep: 1 
iter: 2  value: 16415.23 mgc: 0.0001114934 ustep: 1 
iter: 3  mgc: 2.765788e-12 
iter: 1  mgc: 2.765788e-12 
outer mgc:  1.107299 
iter: 1  value: 16392.24 mgc: 1.245782 ustep: 1 
iter: 2  value: 16392.24 mgc: 6.645617e-05 ustep: 1 
iter: 3  mgc: 6.297185e-13 
iter: 1  mgc: 6.297185e-13 
outer mgc:  1.225552 
iter: 1  value: 16330.83 mgc: 4.112954 ustep: 1 
iter: 2  value: 16330.83 mgc: 0.0002339183 ustep: 1 
iter: 3  mgc: 2.696954e-12 
iter: 1  mgc: 2.696954e-12 
outer mgc:  0.5258657 
iter: 1  value: 16278.81 mgc: 3.300494 ustep: 1 
iter: 2  value: 16278.81 mgc: 6.067546e-05 ustep: 1 
iter: 3  mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  0.1394276 
iter: 1  value: 16226.8 mgc: 3.232164 ustep: 1 
iter: 2  value: 16226.8 mgc: 2.447272e-05 ustep: 1 
iter: 3  mgc: 1.104672e-14 
iter: 1  mgc: 1.104672e-14 
outer mgc:  0.1469459 
iter: 1  value: 16174.93 mgc: 3.298089 ustep: 1 
iter: 2  value: 16174.93 mgc: 9.63248e-06 ustep: 1 
iter: 3  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  0.0843618 
iter: 1  value: 16106.65 mgc: 4.867465 ustep: 1 
iter: 2  value: 16106.65 mgc: 5.831871e-06 ustep: 1 
iter: 3  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  0.08373558 
iter: 1  value: 16040.9 mgc: 4.735303 ustep: 1 
iter: 2  value: 16040.9 mgc: 1.6249e-06 ustep: 1 
mgc: 1.94289e-14 
iter: 1  mgc: 1.94289e-14 
outer mgc:  0.02604713 
iter: 1  value: 15975.34 mgc: 4.780282 ustep: 1 
iter: 2  value: 15975.34 mgc: 4.984627e-07 ustep: 1 
mgc: 1.754152e-14 
iter: 1  mgc: 1.754152e-14 
outer mgc:  0.0379782 
iter: 1  value: 15909.99 mgc: 4.886211 ustep: 1 
iter: 2  value: 15909.99 mgc: 1.519473e-07 ustep: 1 
mgc: 3.635287e-14 
iter: 1  mgc: 3.635287e-14 
outer mgc:  0.009451996 
iter: 1  value: 15844.84 mgc: 4.962102 ustep: 1 
iter: 2  value: 15844.84 mgc: 4.647453e-08 ustep: 1 
mgc: 2.697842e-14 
iter: 1  mgc: 2.697842e-14 
outer mgc:  0.01292252 
iter: 1  value: 15779.87 mgc: 5.458291 ustep: 1 
iter: 2  value: 15779.87 mgc: 1.418221e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.00326441 
iter: 1  value: 15699.7 mgc: 8.572045 ustep: 1 
iter: 2  mgc: 5.855594e-09 
iter: 1  mgc: 5.855594e-09 
outer mgc:  0.004539684 
iter: 1  value: 15624.31 mgc: 8.628005 ustep: 1 
iter: 2  mgc: 1.245523e-09 
iter: 1  mgc: 1.245523e-09 
outer mgc:  0.0006529196 
iter: 1  value: 15549.11 mgc: 9.51959 ustep: 1 
iter: 2  mgc: 3.123906e-10 
iter: 1  mgc: 3.123906e-10 
outer mgc:  0.001509728 
iter: 1  value: 15474.1 mgc: 10.497 ustep: 1 
iter: 2  mgc: 7.836753e-11 
iter: 1  mgc: 7.836753e-11 
outer mgc:  0.000335338 
iter: 1  value: 15399.26 mgc: 11.53336 ustep: 1 
iter: 2  mgc: 1.964962e-11 
iter: 1  mgc: 1.964962e-11 
outer mgc:  0.0004652437 
iter: 1  value: 15324.57 mgc: 12.65286 ustep: 1 
iter: 2  mgc: 4.930278e-12 
iter: 1  mgc: 4.930278e-12 
outer mgc:  7.239608e-05 
iter: 1  value: 15250.03 mgc: 13.84527 ustep: 1 
iter: 2  mgc: 1.266542e-12 
iter: 1  mgc: 1.266542e-12 
outer mgc:  0.0001395751 
iter: 1  mgc: 1.266542e-12 
iter: 1  mgc: 1.266542e-12 
outer mgc:  0.0001395751 
iter: 1  value: 15250.03 mgc: 0.006132044 ustep: 1 
iter: 2  mgc: 5.417888e-14 
outer mgc:  0.513708 
iter: 1  value: 15250.03 mgc: 0.006132022 ustep: 1 
iter: 2  mgc: 5.240253e-14 
outer mgc:  0.513895 
iter: 1  value: 15250.03 mgc: 0.003020337 ustep: 1 
mgc: 5.561523e-14 
outer mgc:  0.2610886 
iter: 1  value: 15250.03 mgc: 0.003019934 ustep: 1 
mgc: 4.310441e-14 
outer mgc:  0.2611782 
iter: 1  value: 15250.03 mgc: 0.004725525 ustep: 1 
mgc: 5.728751e-14 
outer mgc:  0.280777 
iter: 1  value: 15250.03 mgc: 0.004722694 ustep: 1 
mgc: 5.162537e-14 
outer mgc:  0.2803579 
iter: 1  value: 15250.03 mgc: 0.002717097 ustep: 1 
mgc: 5.978551e-14 
outer mgc:  0.151044 
iter: 1  value: 15250.03 mgc: 0.002715548 ustep: 1 
mgc: 5.638198e-14 
outer mgc:  0.1507845 
iter: 1  value: 15250.13 mgc: 0.2684109 ustep: 1 
iter: 2  mgc: 5.684342e-14 
outer mgc:  0.0001396739 
iter: 1  value: 15249.93 mgc: 0.2686794 ustep: 1 
iter: 2  mgc: 7.194245e-14 
outer mgc:  0.0001394766 
iter: 1  value: 15250.13 mgc: 0.267143 ustep: 1 
mgc: 1.150191e-13 
outer mgc:  0.0001395762 
iter: 1  value: 15249.93 mgc: 0.2679466 ustep: 1 
mgc: 1.165734e-13 
outer mgc:  0.0001395741 
iter: 1  value: 15250.01 mgc: 0.001834245 ustep: 1 
mgc: 9.85878e-14 
outer mgc:  0.0001395751 
iter: 1  value: 15250.05 mgc: 0.001833935 ustep: 1 
mgc: 6.117329e-14 
outer mgc:  0.0001395752 
iter: 1  value: 15250.03 mgc: 0.004438336 ustep: 1 
mgc: 7.294165e-14 
outer mgc:  0.1748569 
iter: 1  value: 15250.03 mgc: 0.00443553 ustep: 1 
mgc: 8.504308e-14 
outer mgc:  0.1750731 
[Fri Aug 13 11:56:00 2021]
Finished job 0.
1 of 1 steps (100%) done

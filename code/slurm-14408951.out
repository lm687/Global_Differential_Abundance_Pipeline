Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:31:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2251.056579 
final  value 2200.369133 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2213.905 mgc: 3.135324 ustep: 0.6827823 
iter: 2  value: 2213.417 mgc: 0.6355158 ustep: 0.8263238 
iter: 3  value: 2213.409 mgc: 0.08669994 ustep: 0.9090326 
iter: 4  value: 2213.409 mgc: 0.005062915 ustep: 0.9534367 
iter: 5  value: 2213.409 mgc: 0.0001895895 ustep: 0.9764432 
iter: 6  value: 2213.409 mgc: 3.563998e-06 ustep: 0.9881526 
iter: 7  value: 2213.409 mgc: 3.360711e-08 ustep: 0.9940592 
iter: 8  mgc: 1.587273e-10 
iter: 1  mgc: 1.587273e-10 
Matching hessian patterns... Done
outer mgc:  17.6086 
iter: 1  value: 2188.719 mgc: 0.4662805 ustep: 1 
iter: 2  value: 2188.719 mgc: 0.02203886 ustep: 1 
iter: 3  value: 2188.719 mgc: 5.009252e-05 ustep: 1 
iter: 4  mgc: 3.845376e-10 
iter: 1  value: 2139.05 mgc: 8.123499 ustep: 1 
iter: 2  value: 2139.021 mgc: 0.5535247 ustep: 1 
iter: 3  value: 2139.021 mgc: 0.001852818 ustep: 1 
iter: 4  value: 2139.021 mgc: 1.788141e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  25.84407 
iter: 1  value: 3231.892 mgc: 77.77554 ustep: 1 
iter: 2  value: 3188.407 mgc: 33.1285 ustep: 1 
iter: 3  value: 3188.237 mgc: 2.238152 ustep: 1 
iter: 4  value: 3188.237 mgc: 0.02670493 ustep: 1 
iter: 5  value: 3188.237 mgc: 4.106939e-06 ustep: 1 
iter: 6  mgc: 4.618528e-13 
iter: 1  value: 2135.975 mgc: 9.698522 ustep: 1 
iter: 2  value: 2135.879 mgc: 0.8777778 ustep: 1 
iter: 3  value: 2135.879 mgc: 0.006726553 ustep: 1 
iter: 4  value: 2135.879 mgc: 2.087101e-07 ustep: 1 
iter: 5  mgc: 3.169687e-14 
iter: 1  mgc: 3.169687e-14 
outer mgc:  23.03826 
iter: 1  value: 2131.106 mgc: 6.937899 ustep: 1 
iter: 2  value: 2131.105 mgc: 0.1151844 ustep: 1 
iter: 3  value: 2131.105 mgc: 8.433122e-05 ustep: 1 
iter: 4  mgc: 4.589973e-11 
iter: 1  mgc: 4.589973e-11 
outer mgc:  9.079126 
iter: 1  value: 2127.517 mgc: 5.644741 ustep: 1 
iter: 2  value: 2127.517 mgc: 0.1855026 ustep: 1 
iter: 3  value: 2127.517 mgc: 0.0001830462 ustep: 1 
iter: 4  mgc: 1.723581e-10 
iter: 1  mgc: 1.723581e-10 
outer mgc:  8.326455 
iter: 1  value: 2125.137 mgc: 5.437802 ustep: 1 
iter: 2  value: 2125.137 mgc: 0.04890741 ustep: 1 
iter: 3  value: 2125.137 mgc: 1.336458e-05 ustep: 1 
iter: 4  mgc: 5.416778e-13 
iter: 1  mgc: 5.416778e-13 
outer mgc:  9.969102 
iter: 1  value: 2123.603 mgc: 5.703397 ustep: 1 
iter: 2  value: 2123.602 mgc: 0.08006578 ustep: 1 
iter: 3  value: 2123.602 mgc: 2.318084e-05 ustep: 1 
iter: 4  mgc: 4.063194e-12 
iter: 1  mgc: 4.063194e-12 
outer mgc:  5.319845 
iter: 1  value: 2123.654 mgc: 3.265942 ustep: 1 
iter: 2  value: 2123.654 mgc: 0.04826691 ustep: 1 
iter: 3  value: 2123.654 mgc: 6.507164e-05 ustep: 1 
iter: 4  mgc: 6.472811e-11 
iter: 1  mgc: 6.472811e-11 
outer mgc:  5.324471 
iter: 1  value: 2125.777 mgc: 8.425809 ustep: 1 
iter: 2  value: 2125.775 mgc: 0.1990519 ustep: 1 
iter: 3  value: 2125.775 mgc: 0.0001220743 ustep: 1 
iter: 4  mgc: 5.745848e-11 
iter: 1  value: 2123.688 mgc: 2.820514 ustep: 1 
iter: 2  value: 2123.688 mgc: 0.01596109 ustep: 1 
iter: 3  value: 2123.688 mgc: 7.900402e-07 ustep: 1 
iter: 4  mgc: 1.89182e-13 
iter: 1  value: 2123.463 mgc: 1.232736 ustep: 1 
iter: 2  value: 2123.463 mgc: 0.003006318 ustep: 1 
iter: 3  value: 2123.463 mgc: 2.682547e-08 ustep: 1 
mgc: 1.785239e-13 
iter: 1  mgc: 1.785239e-13 
outer mgc:  2.350462 
iter: 1  value: 2123.363 mgc: 1.548258 ustep: 1 
iter: 2  value: 2123.363 mgc: 0.0052059 ustep: 1 
iter: 3  value: 2123.363 mgc: 1.603484e-07 ustep: 1 
mgc: 1.163514e-13 
iter: 1  mgc: 1.163514e-13 
outer mgc:  2.082858 
iter: 1  value: 2123.207 mgc: 1.106718 ustep: 1 
iter: 2  value: 2123.207 mgc: 0.00318845 ustep: 1 
iter: 3  value: 2123.207 mgc: 3.497083e-08 ustep: 1 
mgc: 1.150191e-13 
iter: 1  mgc: 1.150191e-13 
outer mgc:  1.339467 
iter: 1  value: 2123.012 mgc: 0.5295889 ustep: 1 
iter: 2  value: 2123.012 mgc: 0.0006620332 ustep: 1 
iter: 3  mgc: 2.132752e-09 
iter: 1  value: 2122.819 mgc: 0.2631699 ustep: 1 
iter: 2  value: 2122.819 mgc: 0.0003182357 ustep: 1 
iter: 3  mgc: 4.274945e-10 
iter: 1  value: 2122.151 mgc: 1.113398 ustep: 1 
iter: 2  value: 2122.151 mgc: 0.00478592 ustep: 1 
iter: 3  value: 2122.151 mgc: 8.079454e-08 ustep: 1 
mgc: 1.49214e-13 
iter: 1  mgc: 1.49214e-13 
outer mgc:  1.240687 
iter: 1  value: 2121.653 mgc: 2.494484 ustep: 1 
iter: 2  value: 2121.653 mgc: 0.01322731 ustep: 1 
iter: 3  value: 2121.653 mgc: 6.723732e-07 ustep: 1 
iter: 4  mgc: 2.04281e-13 
iter: 1  mgc: 2.04281e-13 
outer mgc:  3.90355 
iter: 1  value: 2121.162 mgc: 1.399788 ustep: 1 
iter: 2  value: 2121.162 mgc: 0.00522848 ustep: 1 
iter: 3  value: 2121.162 mgc: 3.84412e-08 ustep: 1 
mgc: 1.907363e-13 
iter: 1  mgc: 1.907363e-13 
outer mgc:  1.566717 
iter: 1  value: 2121.021 mgc: 1.244869 ustep: 1 
iter: 2  value: 2121.021 mgc: 0.002363973 ustep: 1 
iter: 3  value: 2121.021 mgc: 1.119214e-08 ustep: 1 
mgc: 2.660094e-13 
iter: 1  value: 2121.046 mgc: 1.732385 ustep: 1 
iter: 2  value: 2121.046 mgc: 0.006524625 ustep: 1 
iter: 3  value: 2121.046 mgc: 1.244846e-07 ustep: 1 
mgc: 2.269296e-13 
iter: 1  value: 2121.069 mgc: 1.31619 ustep: 1 
iter: 2  value: 2121.069 mgc: 0.004651612 ustep: 1 
iter: 3  value: 2121.069 mgc: 6.396773e-08 ustep: 1 
mgc: 1.687539e-13 
iter: 1  mgc: 1.687539e-13 
outer mgc:  2.177633 
iter: 1  value: 2121.004 mgc: 0.8395117 ustep: 1 
iter: 2  value: 2121.004 mgc: 0.0006629191 ustep: 1 
iter: 3  mgc: 8.126526e-10 
iter: 1  mgc: 8.126526e-10 
outer mgc:  1.029297 
iter: 1  value: 2120.905 mgc: 0.5070236 ustep: 1 
iter: 2  value: 2120.905 mgc: 0.0006677633 ustep: 1 
iter: 3  mgc: 1.50888e-09 
iter: 1  mgc: 1.50888e-09 
outer mgc:  0.7572781 
iter: 1  value: 2120.808 mgc: 0.2539556 ustep: 1 
iter: 2  value: 2120.808 mgc: 0.0002574396 ustep: 1 
iter: 3  mgc: 2.171876e-10 
iter: 1  value: 2120.567 mgc: 0.8452042 ustep: 1 
iter: 2  value: 2120.567 mgc: 0.00192197 ustep: 1 
iter: 3  value: 2120.567 mgc: 8.792386e-08 ustep: 1 
mgc: 2.351452e-13 
iter: 1  value: 2120.283 mgc: 1.016354 ustep: 1 
iter: 2  value: 2120.283 mgc: 0.003702906 ustep: 1 
iter: 3  value: 2120.283 mgc: 2.055044e-07 ustep: 1 
iter: 4  mgc: 2.131628e-13 
iter: 1  mgc: 2.131628e-13 
outer mgc:  1.64254 
iter: 1  value: 2119.547 mgc: 2.247485 ustep: 1 
iter: 2  value: 2119.547 mgc: 0.01106581 ustep: 1 
iter: 3  value: 2119.547 mgc: 5.269845e-07 ustep: 1 
iter: 4  mgc: 3.272937e-13 
iter: 1  mgc: 3.272937e-13 
outer mgc:  0.4703892 
iter: 1  value: 2118.558 mgc: 2.185293 ustep: 1 
iter: 2  value: 2118.558 mgc: 0.004580989 ustep: 1 
iter: 3  value: 2118.558 mgc: 4.446536e-08 ustep: 1 
mgc: 4.898304e-13 
iter: 1  mgc: 4.898304e-13 
outer mgc:  1.890922 
iter: 1  value: 2118.144 mgc: 1.331329 ustep: 1 
iter: 2  value: 2118.144 mgc: 0.003311437 ustep: 1 
iter: 3  value: 2118.144 mgc: 1.327437e-08 ustep: 1 
mgc: 2.930989e-13 
iter: 1  mgc: 2.930989e-13 
outer mgc:  1.12741 
iter: 1  value: 2117.587 mgc: 3.991508 ustep: 1 
iter: 2  value: 2117.587 mgc: 0.007676945 ustep: 1 
iter: 3  value: 2117.587 mgc: 7.044227e-08 ustep: 1 
mgc: 3.055334e-13 
iter: 1  value: 2117.922 mgc: 1.274395 ustep: 1 
iter: 2  value: 2117.922 mgc: 0.001022541 ustep: 1 
iter: 3  mgc: 1.61322e-09 
iter: 1  mgc: 1.61322e-09 
outer mgc:  0.5371833 
iter: 1  value: 2117.873 mgc: 0.6316346 ustep: 1 
iter: 2  value: 2117.873 mgc: 0.001024873 ustep: 1 
iter: 3  mgc: 9.673228e-09 
iter: 1  mgc: 9.673228e-09 
outer mgc:  0.1360449 
iter: 1  value: 2117.786 mgc: 0.4593195 ustep: 1 
iter: 2  value: 2117.786 mgc: 0.0002047317 ustep: 1 
iter: 3  mgc: 5.577228e-11 
iter: 1  value: 2117.683 mgc: 0.5680974 ustep: 1 
iter: 2  value: 2117.683 mgc: 0.0003018311 ustep: 1 
iter: 3  mgc: 1.158753e-10 
iter: 1  mgc: 1.158753e-10 
outer mgc:  0.1829635 
iter: 1  value: 2117.264 mgc: 1.797353 ustep: 1 
iter: 2  value: 2117.264 mgc: 0.001724445 ustep: 1 
iter: 3  mgc: 4.047674e-09 
iter: 1  mgc: 4.047674e-09 
outer mgc:  0.345923 
iter: 1  value: 2116.973 mgc: 0.8851696 ustep: 1 
iter: 2  value: 2116.973 mgc: 0.0006868212 ustep: 1 
iter: 3  mgc: 6.456374e-10 
iter: 1  mgc: 6.456374e-10 
outer mgc:  0.143092 
iter: 1  value: 2116.686 mgc: 0.7742578 ustep: 1 
iter: 2  value: 2116.686 mgc: 0.0004696053 ustep: 1 
iter: 3  mgc: 5.550352e-10 
iter: 1  mgc: 5.550352e-10 
outer mgc:  0.04000556 
iter: 1  value: 2116.582 mgc: 0.2819975 ustep: 1 
iter: 2  value: 2116.582 mgc: 2.226018e-05 ustep: 1 
iter: 3  mgc: 1.107558e-12 
iter: 1  mgc: 1.107558e-12 
outer mgc:  0.03988313 
iter: 1  value: 2116.471 mgc: 0.262316 ustep: 1 
iter: 2  value: 2116.471 mgc: 2.588179e-05 ustep: 1 
iter: 3  mgc: 7.496226e-13 
iter: 1  mgc: 7.496226e-13 
outer mgc:  0.0188613 
iter: 1  value: 2116.434 mgc: 0.0881356 ustep: 1 
iter: 2  value: 2116.434 mgc: 3.369147e-06 ustep: 1 
iter: 3  mgc: 2.802203e-13 
iter: 1  mgc: 2.802203e-13 
outer mgc:  0.005624148 
iter: 1  value: 2116.432 mgc: 0.005425656 ustep: 1 
iter: 2  value: 2116.432 mgc: 2.390261e-08 ustep: 1 
mgc: 2.717826e-13 
iter: 1  mgc: 2.717826e-13 
outer mgc:  0.001490708 
iter: 1  value: 2116.433 mgc: 0.002574673 ustep: 1 
iter: 2  mgc: 2.084668e-09 
iter: 1  mgc: 2.084668e-09 
outer mgc:  0.0002338967 
iter: 1  mgc: 2.084668e-09 
iter: 1  mgc: 2.084668e-09 
outer mgc:  0.0002338967 
iter: 1  value: 2116.433 mgc: 0.03662057 ustep: 1 
iter: 2  value: 2116.433 mgc: 1.237357e-06 ustep: 1 
iter: 3  mgc: 2.602363e-13 
outer mgc:  0.2216311 
iter: 1  value: 2116.433 mgc: 0.03660133 ustep: 1 
iter: 2  value: 2116.433 mgc: 1.236633e-06 ustep: 1 
iter: 3  mgc: 2.504663e-13 
outer mgc:  0.2211391 
iter: 1  value: 2116.433 mgc: 0.01799959 ustep: 1 
iter: 2  value: 2116.433 mgc: 3.327534e-07 ustep: 1 
iter: 3  mgc: 3.03535e-13 
outer mgc:  0.1309485 
iter: 1  value: 2116.433 mgc: 0.01799064 ustep: 1 
iter: 2  value: 2116.433 mgc: 3.324154e-07 ustep: 1 
iter: 3  mgc: 2.020606e-13 
outer mgc:  0.1307134 
iter: 1  value: 2116.433 mgc: 0.0457724 ustep: 1 
iter: 2  value: 2116.433 mgc: 2.553345e-06 ustep: 1 
iter: 3  mgc: 2.4869e-13 
outer mgc:  0.2019351 
iter: 1  value: 2116.433 mgc: 0.04577012 ustep: 1 
iter: 2  value: 2116.433 mgc: 2.554494e-06 ustep: 1 
iter: 3  mgc: 2.708944e-13 
outer mgc:  0.2024346 
iter: 1  value: 2116.433 mgc: 0.02264247 ustep: 1 
iter: 2  value: 2116.433 mgc: 7.068239e-07 ustep: 1 
iter: 3  mgc: 3.023692e-13 
outer mgc:  0.1459019 
iter: 1  value: 2116.433 mgc: 0.02264099 ustep: 1 
iter: 2  value: 2116.433 mgc: 7.068482e-07 ustep: 1 
iter: 3  mgc: 2.313705e-13 
outer mgc:  0.1460523 
iter: 1  value: 2116.439 mgc: 0.1076215 ustep: 1 
iter: 2  value: 2116.439 mgc: 5.027884e-06 ustep: 1 
iter: 3  mgc: 2.399192e-13 
outer mgc:  0.05701668 
iter: 1  value: 2116.427 mgc: 0.1079282 ustep: 1 
iter: 2  value: 2116.427 mgc: 5.030108e-06 ustep: 1 
iter: 3  mgc: 2.602363e-13 
outer mgc:  0.05682073 
iter: 1  value: 2116.436 mgc: 0.09166816 ustep: 1 
iter: 2  value: 2116.436 mgc: 2.976074e-06 ustep: 1 
iter: 3  mgc: 3.33289e-13 
outer mgc:  0.06307692 
iter: 1  value: 2116.43 mgc: 0.09192578 ustep: 1 
iter: 2  value: 2116.43 mgc: 2.975174e-06 ustep: 1 
iter: 3  mgc: 2.096101e-13 
outer mgc:  0.06327274 
iter: 1  value: 2116.431 mgc: 0.002857867 ustep: 1 
iter: 2  mgc: 2.933434e-09 
outer mgc:  0.0002143789 
iter: 1  value: 2116.434 mgc: 0.002857359 ustep: 1 
iter: 2  mgc: 2.935543e-09 
outer mgc:  0.0002899268 
iter: 1  value: 2116.432 mgc: 0.001648882 ustep: 1 
iter: 2  mgc: 1.651937e-09 
outer mgc:  0.0005024464 
iter: 1  value: 2116.434 mgc: 0.001649913 ustep: 1 
iter: 2  mgc: 1.654278e-09 
outer mgc:  0.0004622067 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:31:05 2021]
Finished job 0.
1 of 1 steps (100%) done

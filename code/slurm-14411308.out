Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:41:07 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.05_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.05_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.05_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4260.418455 
iter  10 value 3947.365742
iter  10 value 3947.365741
final  value 3947.365741 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2102.3 mgc: 85.99476 ustep: 1 
iter: 2  value: 1264.323 mgc: 69.65188 ustep: 0.1336527 
iter: 3  value: 989.3607 mgc: 120.2784 ustep: 0.3656489 
iter: 4  value: 757.0769 mgc: 100.78 ustep: 0.1095094 
iter: 5  value: 671.1674 mgc: 110.945 ustep: 0.3309889 
iter: 6  value: 601.5914 mgc: 59.11376 ustep: 0.1014988 
iter: 7  value: 580.6723 mgc: 44.41781 ustep: 0.3186569 
iter: 8  value: 580.4501 mgc: 2.469775 ustep: 0.5645406 
iter: 9  value: 580.4491 mgc: 0.1918238 ustep: 0.751384 
iter: 10  value: 580.4491 mgc: 0.004096789 ustep: 0.8668374 
iter: 11  value: 580.4491 mgc: 3.514183e-05 ustep: 0.9310479 
iter: 12  value: 580.4491 mgc: 1.475154e-07 ustep: 0.9649118 
mgc: 3.072218e-10 
iter: 1  mgc: 3.072218e-10 
Matching hessian patterns... Done
outer mgc:  351.6807 
iter: 1  value: 333.1254 mgc: 31.20531 ustep: 1 
iter: 2  value: 328.3246 mgc: 6.054462 ustep: 1 
iter: 3  value: 328.3177 mgc: 0.3171708 ustep: 1 
iter: 4  value: 328.3177 mgc: 0.001073913 ustep: 1 
iter: 5  value: 328.3177 mgc: 1.247646e-08 ustep: 1 
mgc: 2.371454e-14 
iter: 1  mgc: 2.371454e-14 
outer mgc:  108.4567 
iter: 1  value: 289.9485 mgc: 17.47394 ustep: 1 
iter: 2  value: 289.9102 mgc: 0.607757 ustep: 1 
iter: 3  value: 289.9102 mgc: 0.001952575 ustep: 1 
iter: 4  value: 289.9102 mgc: 4.524207e-08 ustep: 1 
mgc: 1.973421e-14 
iter: 1  mgc: 1.973421e-14 
outer mgc:  20.65224 
iter: 1  value: 280.5684 mgc: 11.28114 ustep: 1 
iter: 2  value: 280.378 mgc: 1.071172 ustep: 1 
iter: 3  value: 280.378 mgc: 0.01598723 ustep: 1 
iter: 4  value: 280.378 mgc: 4.238442e-06 ustep: 1 
iter: 5  mgc: 3.016476e-13 
iter: 1  mgc: 3.016476e-13 
outer mgc:  34.38454 
iter: 1  value: 270.9496 mgc: 18.22653 ustep: 1 
iter: 2  value: 270.9349 mgc: 0.4307719 ustep: 1 
iter: 3  value: 270.9349 mgc: 0.0005767421 ustep: 1 
iter: 4  mgc: 1.580162e-09 
iter: 1  mgc: 1.580162e-09 
outer mgc:  68.01287 
iter: 1  value: 316.0162 mgc: 35.04542 ustep: 1 
iter: 2  value: 311.714 mgc: 7.91438 ustep: 1 
iter: 3  value: 311.7114 mgc: 0.2098184 ustep: 1 
iter: 4  value: 311.7114 mgc: 0.0001921463 ustep: 1 
iter: 5  mgc: 1.702736e-10 
iter: 1  value: 259.1659 mgc: 16.93252 ustep: 1 
iter: 2  value: 259.0613 mgc: 1.163706 ustep: 1 
iter: 3  value: 259.0613 mgc: 0.004789886 ustep: 1 
iter: 4  value: 259.0613 mgc: 1.01377e-07 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  31.63074 
iter: 1  value: 252.5425 mgc: 9.620881 ustep: 1 
iter: 2  value: 252.5294 mgc: 0.2211023 ustep: 1 
iter: 3  value: 252.5294 mgc: 0.0005075912 ustep: 1 
iter: 4  mgc: 1.838324e-09 
iter: 1  mgc: 1.838324e-09 
outer mgc:  13.96881 
iter: 1  value: 248.7214 mgc: 6.532922 ustep: 1 
iter: 2  value: 248.7066 mgc: 0.3110393 ustep: 1 
iter: 3  value: 248.7066 mgc: 0.0007227682 ustep: 1 
iter: 4  mgc: 3.986559e-09 
iter: 1  mgc: 3.986559e-09 
outer mgc:  21.48925 
iter: 1  value: 247.1199 mgc: 15.85942 ustep: 1 
iter: 2  value: 247.1012 mgc: 0.6527266 ustep: 1 
iter: 3  value: 247.1012 mgc: 0.001107474 ustep: 1 
iter: 4  mgc: 3.132584e-09 
iter: 1  mgc: 3.132584e-09 
outer mgc:  26.49717 
iter: 1  value: 242.8862 mgc: 7.289976 ustep: 1 
iter: 2  value: 242.8837 mgc: 0.1880822 ustep: 1 
iter: 3  value: 242.8837 mgc: 0.0001868504 ustep: 1 
iter: 4  mgc: 1.613838e-10 
iter: 1  mgc: 1.613838e-10 
outer mgc:  12.49196 
iter: 1  value: 244.5994 mgc: 4.357494 ustep: 1 
iter: 2  value: 244.599 mgc: 0.07576195 ustep: 1 
iter: 3  value: 244.599 mgc: 2.505269e-05 ustep: 1 
iter: 4  mgc: 2.833289e-12 
iter: 1  value: 241.8641 mgc: 3.034413 ustep: 1 
iter: 2  value: 241.864 mgc: 0.01143963 ustep: 1 
iter: 3  value: 241.864 mgc: 4.819616e-07 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  6.424939 
iter: 1  value: 243.7867 mgc: 5.603712 ustep: 1 
iter: 2  value: 243.7861 mgc: 0.07033256 ustep: 1 
iter: 3  value: 243.7861 mgc: 1.515766e-05 ustep: 1 
iter: 4  mgc: 5.742073e-13 
iter: 1  value: 241.7585 mgc: 1.097212 ustep: 1 
iter: 2  value: 241.7585 mgc: 0.002542889 ustep: 1 
iter: 3  value: 241.7585 mgc: 2.061752e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  5.239805 
iter: 1  value: 241.6491 mgc: 1.074828 ustep: 1 
iter: 2  value: 241.6491 mgc: 0.001373819 ustep: 1 
iter: 3  mgc: 3.740682e-09 
iter: 1  mgc: 3.740682e-09 
outer mgc:  4.351373 
iter: 1  value: 241.5549 mgc: 0.8546971 ustep: 1 
iter: 2  value: 241.5549 mgc: 0.001317539 ustep: 1 
iter: 3  mgc: 5.914201e-09 
iter: 1  mgc: 5.914201e-09 
outer mgc:  2.477602 
iter: 1  value: 241.4275 mgc: 0.6044209 ustep: 1 
iter: 2  value: 241.4275 mgc: 0.000458109 ustep: 1 
iter: 3  mgc: 5.266685e-10 
iter: 1  mgc: 5.266685e-10 
outer mgc:  2.435328 
iter: 1  value: 241.2315 mgc: 0.5522785 ustep: 1 
iter: 2  value: 241.2315 mgc: 0.0006047228 ustep: 1 
iter: 3  mgc: 1.300773e-09 
iter: 1  value: 240.927 mgc: 0.4741361 ustep: 1 
iter: 2  value: 240.927 mgc: 0.0008240616 ustep: 1 
iter: 3  mgc: 3.270855e-09 
iter: 1  value: 240.1557 mgc: 1.683552 ustep: 1 
iter: 2  value: 240.1557 mgc: 0.009229826 ustep: 1 
iter: 3  value: 240.1557 mgc: 4.038928e-07 ustep: 1 
iter: 4  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  5.396165 
iter: 1  value: 239.3142 mgc: 5.007128 ustep: 1 
iter: 2  value: 239.3141 mgc: 0.06231114 ustep: 1 
iter: 3  value: 239.3141 mgc: 1.342408e-05 ustep: 1 
iter: 4  mgc: 5.417888e-13 
iter: 1  mgc: 5.417888e-13 
outer mgc:  11.75098 
iter: 1  value: 238.2695 mgc: 4.080693 ustep: 1 
iter: 2  value: 238.2694 mgc: 0.03544126 ustep: 1 
iter: 3  value: 238.2694 mgc: 4.938239e-06 ustep: 1 
iter: 4  mgc: 6.883383e-14 
iter: 1  mgc: 6.883383e-14 
outer mgc:  5.548521 
iter: 1  value: 236.9624 mgc: 1.51657 ustep: 1 
iter: 2  value: 236.9624 mgc: 0.004416569 ustep: 1 
iter: 3  value: 236.9624 mgc: 4.303334e-08 ustep: 1 
mgc: 2.783884e-14 
iter: 1  mgc: 2.783884e-14 
outer mgc:  0.9683905 
iter: 1  value: 236.3385 mgc: 1.395321 ustep: 1 
iter: 2  value: 236.3385 mgc: 0.005708472 ustep: 1 
iter: 3  value: 236.3385 mgc: 8.02262e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  3.97561 
iter: 1  value: 235.9711 mgc: 0.7460009 ustep: 1 
iter: 2  value: 235.9711 mgc: 0.0008452151 ustep: 1 
iter: 3  mgc: 1.823694e-09 
iter: 1  mgc: 1.823694e-09 
outer mgc:  2.677779 
iter: 1  value: 235.1095 mgc: 2.001756 ustep: 1 
iter: 2  value: 235.1095 mgc: 0.0078164 ustep: 1 
iter: 3  value: 235.1095 mgc: 1.511688e-07 ustep: 1 
iter: 4  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  3.65467 
iter: 1  value: 234.5114 mgc: 0.7818517 ustep: 1 
iter: 2  value: 234.5114 mgc: 0.0007231657 ustep: 1 
iter: 3  mgc: 1.190894e-09 
iter: 1  value: 233.6824 mgc: 1.00007 ustep: 1 
iter: 2  value: 233.6824 mgc: 0.0007491318 ustep: 1 
iter: 3  mgc: 1.417532e-09 
iter: 1  mgc: 1.417532e-09 
outer mgc:  2.534155 
iter: 1  value: 231.3292 mgc: 5.30473 ustep: 1 
iter: 2  value: 231.3292 mgc: 0.01493244 ustep: 1 
iter: 3  value: 231.3292 mgc: 2.907881e-07 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  5.446 
iter: 1  value: 230.1196 mgc: 2.65306 ustep: 1 
iter: 2  value: 230.1196 mgc: 0.006650656 ustep: 1 
iter: 3  value: 230.1196 mgc: 8.072548e-08 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  3.635627 
iter: 1  value: 229.2026 mgc: 3.375072 ustep: 1 
iter: 2  value: 229.2026 mgc: 0.01071188 ustep: 1 
iter: 3  value: 229.2026 mgc: 9.027827e-07 ustep: 1 
iter: 4  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  2.567832 
iter: 1  value: 228.1005 mgc: 1.892046 ustep: 1 
iter: 2  value: 228.1005 mgc: 0.002936186 ustep: 1 
iter: 3  value: 228.1005 mgc: 1.889126e-08 ustep: 1 
mgc: 3.230749e-14 
iter: 1  mgc: 3.230749e-14 
outer mgc:  2.32464 
iter: 1  value: 226.9087 mgc: 1.354262 ustep: 1 
iter: 2  value: 226.9087 mgc: 0.0004542846 ustep: 1 
iter: 3  mgc: 3.859295e-10 
iter: 1  mgc: 3.859295e-10 
outer mgc:  1.02934 
iter: 1  value: 224.0465 mgc: 4.448457 ustep: 1 
iter: 2  value: 224.0465 mgc: 0.003169491 ustep: 1 
iter: 3  value: 224.0465 mgc: 1.57771e-08 ustep: 1 
mgc: 3.497203e-14 
iter: 1  mgc: 3.497203e-14 
outer mgc:  0.2093102 
iter: 1  value: 221.9446 mgc: 2.947796 ustep: 1 
iter: 2  value: 221.9446 mgc: 0.000861908 ustep: 1 
iter: 3  mgc: 1.188901e-09 
iter: 1  mgc: 1.188901e-09 
outer mgc:  0.1140315 
iter: 1  value: 220.0606 mgc: 2.549394 ustep: 1 
iter: 2  value: 220.0606 mgc: 0.0004562925 ustep: 1 
iter: 3  mgc: 3.155574e-10 
iter: 1  mgc: 3.155574e-10 
outer mgc:  0.05135311 
iter: 1  value: 217.869 mgc: 3.020504 ustep: 1 
iter: 2  value: 217.869 mgc: 0.0004340666 ustep: 1 
iter: 3  mgc: 2.66219e-10 
iter: 1  mgc: 2.66219e-10 
outer mgc:  0.0384736 
iter: 1  value: 215.986 mgc: 2.608355 ustep: 1 
iter: 2  value: 215.986 mgc: 0.0002274035 ustep: 1 
iter: 3  mgc: 6.990497e-11 
iter: 1  mgc: 6.990497e-11 
outer mgc:  0.02635852 
iter: 1  value: 214.2526 mgc: 2.391603 ustep: 1 
iter: 2  value: 214.2526 mgc: 0.0001375393 ustep: 1 
iter: 3  mgc: 2.479261e-11 
iter: 1  mgc: 2.479261e-11 
outer mgc:  0.01577871 
iter: 1  value: 212.813 mgc: 1.972014 ustep: 1 
iter: 2  value: 212.813 mgc: 7.041928e-05 ustep: 1 
iter: 3  mgc: 6.423306e-12 
iter: 1  mgc: 6.423306e-12 
outer mgc:  0.00865017 
iter: 1  value: 211.723 mgc: 1.463927 ustep: 1 
iter: 2  value: 211.723 mgc: 3.148776e-05 ustep: 1 
iter: 3  mgc: 1.270095e-12 
iter: 1  mgc: 1.270095e-12 
outer mgc:  0.004092475 
iter: 1  value: 211.0477 mgc: 0.8943545 ustep: 1 
iter: 2  value: 211.0477 mgc: 1.025972e-05 ustep: 1 
iter: 3  mgc: 1.421085e-13 
iter: 1  mgc: 1.421085e-13 
outer mgc:  0.002260312 
iter: 1  value: 210.7533 mgc: 0.3811181 ustep: 1 
iter: 2  value: 210.7533 mgc: 1.770506e-06 ustep: 1 
iter: 3  mgc: 1.869616e-13 
iter: 1  mgc: 1.869616e-13 
outer mgc:  0.0003622349 
iter: 1  value: 210.6844 mgc: 0.08925591 ustep: 1 
iter: 2  value: 210.6844 mgc: 9.471201e-08 ustep: 1 
mgc: 1.857403e-13 
iter: 1  mgc: 1.857403e-13 
outer mgc:  0.0002783111 
iter: 1  value: 210.6786 mgc: 0.007224291 ustep: 1 
iter: 2  mgc: 6.497185e-10 
iter: 1  mgc: 6.497185e-10 
outer mgc:  8.547246e-05 
iter: 1  mgc: 6.497185e-10 
iter: 1  mgc: 6.497185e-10 
outer mgc:  8.547246e-05 
iter: 1  value: 210.6786 mgc: 0.04021396 ustep: 1 
iter: 2  value: 210.6786 mgc: 7.95081e-07 ustep: 1 
iter: 3  mgc: 1.808553e-13 
outer mgc:  0.5047168 
iter: 1  value: 210.6791 mgc: 0.04019453 ustep: 1 
iter: 2  value: 210.6791 mgc: 7.94197e-07 ustep: 1 
iter: 3  mgc: 2.473577e-13 
outer mgc:  0.5046882 
iter: 1  value: 210.6788 mgc: 0.01778824 ustep: 1 
iter: 2  value: 210.6788 mgc: 9.178398e-08 ustep: 1 
mgc: 1.39444e-13 
outer mgc:  0.2679222 
iter: 1  value: 210.6786 mgc: 0.01777804 ustep: 1 
iter: 2  value: 210.6786 mgc: 9.166295e-08 ustep: 1 
mgc: 1.767475e-13 
outer mgc:  0.2678254 
iter: 1  value: 210.6793 mgc: 0.05130689 ustep: 1 
iter: 2  value: 210.6793 mgc: 2.253482e-06 ustep: 1 
iter: 3  mgc: 1.389444e-13 
outer mgc:  0.5337709 
iter: 1  value: 210.6784 mgc: 0.05131088 ustep: 1 
iter: 2  value: 210.6784 mgc: 2.248852e-06 ustep: 1 
iter: 3  mgc: 2.149392e-13 
outer mgc:  0.5337623 
iter: 1  value: 210.6796 mgc: 0.02962555 ustep: 1 
iter: 2  value: 210.6796 mgc: 5.973018e-07 ustep: 1 
iter: 3  mgc: 3.206324e-13 
outer mgc:  0.3743237 
iter: 1  value: 210.678 mgc: 0.0296298 ustep: 1 
iter: 2  value: 210.678 mgc: 5.96583e-07 ustep: 1 
iter: 3  mgc: 1.646461e-13 
outer mgc:  0.3742974 
iter: 1  value: 210.6774 mgc: 0.001483201 ustep: 1 
iter: 2  mgc: 2.652456e-11 
outer mgc:  0.0001016408 
iter: 1  value: 210.6797 mgc: 0.001483114 ustep: 1 
iter: 2  mgc: 2.653522e-11 
outer mgc:  6.930151e-05 
iter: 1  value: 210.6921 mgc: 0.7809485 ustep: 1 
iter: 2  value: 210.6921 mgc: 7.573167e-06 ustep: 1 
iter: 3  mgc: 2.154388e-13 
outer mgc:  0.1753765 
iter: 1  value: 210.6652 mgc: 0.7817299 ustep: 1 
iter: 2  value: 210.6652 mgc: 7.564625e-06 ustep: 1 
iter: 3  mgc: 2.171596e-13 
outer mgc:  0.1751156 
iter: 1  value: 210.686 mgc: 0.7864385 ustep: 1 
iter: 2  value: 210.686 mgc: 6.566077e-06 ustep: 1 
iter: 3  mgc: 1.633416e-13 
outer mgc:  0.1870428 
iter: 1  value: 210.6713 mgc: 0.7887879 ustep: 1 
iter: 2  value: 210.6713 mgc: 6.570477e-06 ustep: 1 
iter: 3  mgc: 2.293721e-13 
outer mgc:  0.1871888 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:41:08 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 09:32:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2176.350944 
final  value 2103.332313 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2143.295 mgc: 3.22998 ustep: 0.8994163 
iter: 2  value: 2133.371 mgc: 2.188606 ustep: 0.772724 
iter: 3  value: 2132.248 mgc: 2.011545 ustep: 0.8790593 
iter: 4  value: 2131.335 mgc: 1.120117 ustep: 0.9375879 
iter: 5  value: 2131.334 mgc: 0.08590588 ustep: 0.9682944 
iter: 6  value: 2131.334 mgc: 0.001817977 ustep: 0.9840211 
iter: 7  value: 2131.334 mgc: 1.512955e-05 ustep: 0.9919792 
iter: 8  value: 2131.334 mgc: 7.951235e-08 ustep: 0.9959819 
iter: 9  mgc: 2.470251e-10 
iter: 1  mgc: 2.470251e-10 
Matching hessian patterns... Done
outer mgc:  16.11908 
iter: 1  value: 2108.133 mgc: 0.7718319 ustep: 1 
iter: 2  value: 2108.132 mgc: 0.05393791 ustep: 1 
iter: 3  value: 2108.132 mgc: 8.225836e-05 ustep: 1 
iter: 4  mgc: 3.07876e-10 
iter: 1  value: 2064.224 mgc: 11.60906 ustep: 1 
iter: 2  value: 2063.972 mgc: 1.583221 ustep: 1 
iter: 3  value: 2063.972 mgc: 0.01923038 ustep: 1 
iter: 4  value: 2063.972 mgc: 1.29295e-06 ustep: 1 
iter: 5  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  17.953 
iter: 1  value: 2535.997 mgc: 57.49366 ustep: 1 
iter: 2  value: 2531.362 mgc: 7.513229 ustep: 1 
iter: 3  value: 2531.358 mgc: 0.231078 ustep: 1 
iter: 4  value: 2531.358 mgc: 0.0002852776 ustep: 1 
iter: 5  mgc: 4.435101e-10 
iter: 1  value: 2058.593 mgc: 5.599819 ustep: 1 
iter: 2  value: 2058.583 mgc: 0.2360997 ustep: 1 
iter: 3  value: 2058.583 mgc: 0.0005507063 ustep: 1 
iter: 4  mgc: 1.357799e-09 
iter: 1  mgc: 1.357799e-09 
outer mgc:  21.5466 
iter: 1  value: 2057.493 mgc: 6.845116 ustep: 1 
iter: 2  value: 2057.487 mgc: 0.2238127 ustep: 1 
iter: 3  value: 2057.487 mgc: 0.0002324825 ustep: 1 
iter: 4  mgc: 1.302674e-09 
iter: 1  mgc: 1.302674e-09 
outer mgc:  24.88036 
iter: 1  value: 2053.656 mgc: 4.129895 ustep: 1 
iter: 2  value: 2053.655 mgc: 0.07158558 ustep: 1 
iter: 3  value: 2053.655 mgc: 6.595285e-05 ustep: 1 
iter: 4  mgc: 2.101253e-11 
iter: 1  mgc: 2.101253e-11 
outer mgc:  5.978892 
iter: 1  value: 2051.635 mgc: 1.431868 ustep: 1 
iter: 2  value: 2051.635 mgc: 0.003429988 ustep: 1 
iter: 3  value: 2051.635 mgc: 1.980988e-07 ustep: 1 
iter: 4  mgc: 2.620126e-14 
iter: 1  value: 2049.808 mgc: 2.756308 ustep: 1 
iter: 2  value: 2049.808 mgc: 0.0134503 ustep: 1 
iter: 3  value: 2049.808 mgc: 2.261633e-06 ustep: 1 
iter: 4  mgc: 3.895322e-14 
iter: 1  mgc: 3.895322e-14 
outer mgc:  12.93483 
iter: 1  value: 2046.905 mgc: 6.94365 ustep: 1 
iter: 2  value: 2046.9 mgc: 0.248864 ustep: 1 
iter: 3  value: 2046.9 mgc: 0.0001093089 ustep: 1 
iter: 4  mgc: 8.763634e-11 
iter: 1  mgc: 8.763634e-11 
outer mgc:  14.03016 
iter: 1  value: 2045.409 mgc: 6.746661 ustep: 1 
iter: 2  value: 2045.403 mgc: 0.1388254 ustep: 1 
iter: 3  value: 2045.403 mgc: 0.0004115866 ustep: 1 
iter: 4  mgc: 8.25876e-10 
iter: 1  value: 2045.2 mgc: 5.018183 ustep: 1 
iter: 2  value: 2045.2 mgc: 0.03009501 ustep: 1 
iter: 3  value: 2045.2 mgc: 8.914168e-06 ustep: 1 
iter: 4  mgc: 9.867107e-14 
iter: 1  mgc: 9.867107e-14 
outer mgc:  9.650554 
iter: 1  value: 2044.774 mgc: 5.375678 ustep: 1 
iter: 2  value: 2044.774 mgc: 0.06414357 ustep: 1 
iter: 3  value: 2044.774 mgc: 2.119791e-05 ustep: 1 
iter: 4  mgc: 2.47935e-12 
iter: 1  value: 2044.663 mgc: 3.681823 ustep: 1 
iter: 2  value: 2044.663 mgc: 0.01306917 ustep: 1 
iter: 3  value: 2044.663 mgc: 1.417134e-06 ustep: 1 
iter: 4  mgc: 4.218847e-14 
iter: 1  mgc: 4.218847e-14 
outer mgc:  6.437627 
iter: 1  value: 2044.022 mgc: 2.027885 ustep: 1 
iter: 2  value: 2044.022 mgc: 0.02445301 ustep: 1 
iter: 3  value: 2044.022 mgc: 6.837391e-07 ustep: 1 
iter: 4  mgc: 8.837375e-14 
iter: 1  mgc: 8.837375e-14 
outer mgc:  1.74177 
iter: 1  value: 2043.39 mgc: 2.510839 ustep: 1 
iter: 2  value: 2043.39 mgc: 0.00690296 ustep: 1 
iter: 3  value: 2043.39 mgc: 5.065179e-07 ustep: 1 
mgc: 8.65974e-14 
iter: 1  mgc: 8.65974e-14 
outer mgc:  2.516369 
iter: 1  value: 2042.834 mgc: 1.821002 ustep: 1 
iter: 2  value: 2042.834 mgc: 0.003982986 ustep: 1 
iter: 3  value: 2042.834 mgc: 5.284822e-08 ustep: 1 
mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
outer mgc:  1.224318 
iter: 1  value: 2042.688 mgc: 1.579106 ustep: 1 
iter: 2  value: 2042.688 mgc: 0.001164251 ustep: 1 
iter: 3  value: 2042.688 mgc: 1.18946e-08 ustep: 1 
mgc: 7.394085e-14 
iter: 1  mgc: 7.394085e-14 
outer mgc:  2.941447 
iter: 1  value: 2042.797 mgc: 0.9596884 ustep: 1 
iter: 2  value: 2042.797 mgc: 0.002204257 ustep: 1 
iter: 3  value: 2042.797 mgc: 2.264707e-08 ustep: 1 
mgc: 6.483702e-14 
iter: 1  mgc: 6.483702e-14 
outer mgc:  0.985735 
iter: 1  value: 2042.162 mgc: 0.6316517 ustep: 1 
iter: 2  value: 2042.162 mgc: 0.0008490485 ustep: 1 
iter: 3  mgc: 4.264483e-09 
iter: 1  value: 2041.022 mgc: 1.641566 ustep: 1 
iter: 2  value: 2041.022 mgc: 0.001794664 ustep: 1 
iter: 3  value: 2041.022 mgc: 1.876183e-08 ustep: 1 
mgc: 1.234568e-13 
iter: 1  mgc: 1.234568e-13 
outer mgc:  5.470899 
iter: 1  value: 2039.889 mgc: 4.258866 ustep: 1 
iter: 2  value: 2039.889 mgc: 0.01166454 ustep: 1 
iter: 3  value: 2039.889 mgc: 8.636009e-07 ustep: 1 
iter: 4  mgc: 9.431345e-14 
iter: 1  mgc: 9.431345e-14 
outer mgc:  2.86249 
iter: 1  value: 2039.476 mgc: 4.799315 ustep: 1 
iter: 2  value: 2039.476 mgc: 0.01341353 ustep: 1 
iter: 3  value: 2039.476 mgc: 2.167662e-06 ustep: 1 
iter: 4  mgc: 1.167955e-13 
iter: 1  mgc: 1.167955e-13 
outer mgc:  9.343114 
iter: 1  value: 2038.703 mgc: 4.103764 ustep: 1 
iter: 2  value: 2038.703 mgc: 0.02483429 ustep: 1 
iter: 3  value: 2038.703 mgc: 3.220517e-06 ustep: 1 
iter: 4  mgc: 1.654232e-13 
iter: 1  mgc: 1.654232e-13 
outer mgc:  2.57869 
iter: 1  value: 2038.288 mgc: 6.211959 ustep: 1 
iter: 2  value: 2038.288 mgc: 0.07713195 ustep: 1 
iter: 3  value: 2038.288 mgc: 2.643608e-05 ustep: 1 
iter: 4  mgc: 8.463674e-12 
iter: 1  mgc: 8.463674e-12 
outer mgc:  2.900744 
iter: 1  value: 2037.639 mgc: 3.574314 ustep: 1 
iter: 2  value: 2037.639 mgc: 0.004173202 ustep: 1 
iter: 3  value: 2037.639 mgc: 2.563352e-08 ustep: 1 
mgc: 5.630219e-14 
iter: 1  mgc: 5.630219e-14 
outer mgc:  1.641481 
iter: 1  value: 2036.735 mgc: 1.561761 ustep: 1 
iter: 2  value: 2036.735 mgc: 0.002241514 ustep: 1 
iter: 3  value: 2036.735 mgc: 8.238834e-08 ustep: 1 
mgc: 8.615331e-14 
iter: 1  value: 2035.696 mgc: 2.002165 ustep: 1 
iter: 2  value: 2035.696 mgc: 0.00348746 ustep: 1 
iter: 3  value: 2035.696 mgc: 1.958508e-07 ustep: 1 
iter: 4  mgc: 9.281464e-14 
iter: 1  mgc: 9.281464e-14 
outer mgc:  2.401743 
iter: 1  value: 2034.573 mgc: 2.843364 ustep: 1 
iter: 2  value: 2034.573 mgc: 0.001426563 ustep: 1 
iter: 3  mgc: 7.283241e-09 
iter: 1  mgc: 7.283241e-09 
outer mgc:  0.9828926 
iter: 1  value: 2033.315 mgc: 1.976188 ustep: 1 
iter: 2  value: 2033.315 mgc: 0.003344614 ustep: 1 
iter: 3  value: 2033.315 mgc: 6.119662e-08 ustep: 1 
mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  0.6479499 
iter: 1  value: 2032.27 mgc: 2.582207 ustep: 1 
iter: 2  value: 2032.27 mgc: 0.0003329643 ustep: 1 
iter: 3  mgc: 5.835936e-10 
iter: 1  value: 2031.188 mgc: 3.498788 ustep: 1 
iter: 2  value: 2031.188 mgc: 0.0004446617 ustep: 1 
iter: 3  mgc: 6.056933e-10 
iter: 1  mgc: 6.056933e-10 
outer mgc:  0.4790996 
iter: 1  value: 2029.603 mgc: 2.997568 ustep: 1 
iter: 2  value: 2029.603 mgc: 0.0003885349 ustep: 1 
iter: 3  mgc: 3.650932e-09 
iter: 1  mgc: 3.650932e-09 
outer mgc:  0.4396998 
iter: 1  value: 2028.192 mgc: 3.477708 ustep: 1 
iter: 2  value: 2028.192 mgc: 0.0002367117 ustep: 1 
iter: 3  mgc: 3.536726e-11 
iter: 1  mgc: 3.536726e-11 
outer mgc:  0.2143773 
iter: 1  value: 2026.067 mgc: 4.945236 ustep: 1 
iter: 2  value: 2026.067 mgc: 8.877582e-05 ustep: 1 
iter: 3  mgc: 5.464873e-11 
iter: 1  mgc: 5.464873e-11 
outer mgc:  0.2425504 
iter: 1  value: 2024.368 mgc: 3.490299 ustep: 1 
iter: 2  value: 2024.368 mgc: 2.469693e-05 ustep: 1 
iter: 3  mgc: 1.317169e-11 
iter: 1  mgc: 1.317169e-11 
outer mgc:  0.1357422 
iter: 1  value: 2022.202 mgc: 5.031799 ustep: 1 
iter: 2  value: 2022.202 mgc: 9.350492e-05 ustep: 1 
iter: 3  mgc: 2.008882e-11 
iter: 1  mgc: 2.008882e-11 
outer mgc:  0.1775689 
iter: 1  value: 2020.456 mgc: 4.351881 ustep: 1 
iter: 2  value: 2020.456 mgc: 8.720139e-06 ustep: 1 
iter: 3  mgc: 8.21565e-13 
iter: 1  mgc: 8.21565e-13 
outer mgc:  0.06648859 
iter: 1  value: 2018.946 mgc: 3.430801 ustep: 1 
iter: 2  value: 2018.946 mgc: 3.347974e-06 ustep: 1 
iter: 3  mgc: 1.350031e-12 
iter: 1  mgc: 1.350031e-12 
outer mgc:  0.02453937 
iter: 1  value: 2016.768 mgc: 4.5706 ustep: 1 
iter: 2  value: 2016.768 mgc: 1.275094e-06 ustep: 1 
iter: 3  mgc: 6.461498e-13 
iter: 1  mgc: 6.461498e-13 
outer mgc:  0.005790091 
iter: 1  value: 2014.981 mgc: 3.744697 ustep: 1 
iter: 2  value: 2014.981 mgc: 5.723238e-07 ustep: 1 
iter: 3  mgc: 1.383782e-12 
iter: 1  mgc: 1.383782e-12 
outer mgc:  0.002845595 
iter: 1  value: 2012.913 mgc: 4.078257 ustep: 1 
iter: 2  value: 2012.913 mgc: 4.022764e-07 ustep: 1 
iter: 3  mgc: 2.039258e-12 
iter: 1  mgc: 2.039258e-12 
outer mgc:  0.003673628 
iter: 1  value: 2011.199 mgc: 3.375485 ustep: 1 
iter: 2  value: 2011.199 mgc: 1.384056e-07 ustep: 1 
mgc: 3.699707e-12 
iter: 1  mgc: 3.699707e-12 
outer mgc:  0.0008040948 
iter: 1  value: 2009.098 mgc: 4.192263 ustep: 1 
iter: 2  value: 2009.098 mgc: 9.394057e-08 ustep: 1 
mgc: 5.23892e-12 
iter: 1  mgc: 5.23892e-12 
outer mgc:  0.0009766383 
iter: 1  value: 2007.361 mgc: 3.460004 ustep: 1 
iter: 2  value: 2007.361 mgc: 2.353835e-08 ustep: 1 
mgc: 7.711609e-12 
iter: 1  mgc: 7.711609e-12 
outer mgc:  0.000582688 
iter: 1  value: 2005.267 mgc: 4.280176 ustep: 1 
iter: 2  value: 2005.267 mgc: 1.48183e-08 ustep: 1 
mgc: 1.437206e-11 
iter: 1  mgc: 1.437206e-11 
outer mgc:  0.0003482602 
iter: 1  value: 2003.536 mgc: 3.437193 ustep: 1 
iter: 2  mgc: 4.890591e-09 
iter: 1  mgc: 4.890591e-09 
outer mgc:  0.000163972 
iter: 1  value: 2001.438 mgc: 4.260503 ustep: 1 
iter: 2  mgc: 3.72773e-09 
iter: 1  mgc: 3.72773e-09 
outer mgc:  0.0001244259 
iter: 1  value: 1999.706 mgc: 3.401053 ustep: 1 
iter: 2  mgc: 1.238859e-09 
iter: 1  mgc: 1.238859e-09 
outer mgc:  8.331923e-05 
iter: 1  value: 1997.608 mgc: 4.255699 ustep: 1 
iter: 2  mgc: 8.371517e-10 
iter: 1  mgc: 8.371517e-10 
outer mgc:  6.818721e-05 
iter: 1  value: 1995.876 mgc: 3.40758 ustep: 1 
iter: 2  mgc: 2.340013e-10 
iter: 1  mgc: 2.340013e-10 
outer mgc:  4.526766e-05 
iter: 1  value: 1993.778 mgc: 4.280363 ustep: 1 
iter: 2  mgc: 1.516183e-10 
iter: 1  mgc: 1.516183e-10 
outer mgc:  3.020076e-05 
iter: 1  value: 1992.046 mgc: 3.409122 ustep: 1 
iter: 2  mgc: 1.70945e-10 
iter: 1  mgc: 1.70945e-10 
outer mgc:  1.925069e-05 
iter: 1  value: 1989.948 mgc: 4.275263 ustep: 1 
iter: 2  mgc: 5.67925e-10 
iter: 1  mgc: 5.67925e-10 
outer mgc:  1.307818e-05 
iter: 1  value: 1988.215 mgc: 3.40018 ustep: 1 
iter: 2  mgc: 2.310116e-10 
iter: 1  mgc: 2.310116e-10 
outer mgc:  8.978936e-06 
iter: 1  mgc: 2.310116e-10 
iter: 1  mgc: 2.310116e-10 
outer mgc:  8.978936e-06 
iter: 1  value: 1988.215 mgc: 0.02737307 ustep: 1 
iter: 2  value: 1988.215 mgc: 1.506802e-06 ustep: 1 
iter: 3  mgc: 3.22223e-10 
outer mgc:  0.2016308 
iter: 1  value: 1988.216 mgc: 0.02735943 ustep: 1 
iter: 2  value: 1988.216 mgc: 1.505424e-06 ustep: 1 
iter: 3  mgc: 3.430109e-10 
outer mgc:  0.2015935 
iter: 1  value: 1988.215 mgc: 0.01238886 ustep: 1 
iter: 2  value: 1988.215 mgc: 3.421998e-07 ustep: 1 
iter: 3  mgc: 2.553013e-10 
outer mgc:  0.09033898 
iter: 1  value: 1988.216 mgc: 0.01238037 ustep: 1 
iter: 2  value: 1988.216 mgc: 3.417221e-07 ustep: 1 
iter: 3  mgc: 2.1892e-10 
outer mgc:  0.0902877 
iter: 1  value: 1988.217 mgc: 0.03308308 ustep: 1 
iter: 2  value: 1988.217 mgc: 1.200852e-06 ustep: 1 
iter: 3  mgc: 2.460858e-10 
outer mgc:  0.2582822 
iter: 1  value: 1988.214 mgc: 0.03307379 ustep: 1 
iter: 2  value: 1988.214 mgc: 1.196774e-06 ustep: 1 
iter: 3  mgc: 2.637912e-10 
outer mgc:  0.2583114 
iter: 1  value: 1988.216 mgc: 0.0171541 ustep: 1 
iter: 2  value: 1988.216 mgc: 4.886899e-07 ustep: 1 
iter: 3  mgc: 2.456666e-10 
outer mgc:  0.1325298 
iter: 1  value: 1988.215 mgc: 0.01715103 ustep: 1 
iter: 2  value: 1988.215 mgc: 4.877072e-07 ustep: 1 
iter: 3  mgc: 2.68467e-10 
outer mgc:  0.1325271 
iter: 1  value: 1988.22 mgc: 1945.77 ustep: 1 
iter: 2  value: 1988.22 mgc: 4.26388e-06 ustep: 1 
iter: 3  mgc: 2.670935e-10 
outer mgc:  0.05503526 
iter: 1  value: 1988.21 mgc: 1947.717 ustep: 1 
iter: 2  value: 1988.21 mgc: 4.269352e-06 ustep: 1 
iter: 3  mgc: 2.035758e-10 
outer mgc:  0.05499997 
iter: 1  value: 1988.222 mgc: 1943.827 ustep: 1 
iter: 2  value: 1988.222 mgc: 2.395572e-06 ustep: 1 
iter: 3  mgc: 1.647722e-10 
outer mgc:  0.05280709 
iter: 1  value: 1988.209 mgc: 1949.667 ustep: 1 
iter: 2  value: 1988.209 mgc: 2.387993e-06 ustep: 1 
iter: 3  mgc: 1.218561e-10 
outer mgc:  0.05272819 
iter: 1  value: 1988.215 mgc: 2.246673e-05 ustep: 1 
mgc: 3.029456e-10 
outer mgc:  8.978981e-06 
iter: 1  value: 1988.215 mgc: 2.246562e-05 ustep: 1 
mgc: 2.91744e-10 
outer mgc:  8.979328e-06 
iter: 1  value: 1988.214 mgc: 0.002729177 ustep: 1 
iter: 2  mgc: 9.323688e-09 
outer mgc:  0.00206138 
iter: 1  value: 1988.217 mgc: 0.002729837 ustep: 1 
iter: 2  mgc: 9.61997e-09 
outer mgc:  0.00206862 
[Mon Aug 16 09:32:19 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 00:03:18 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10945.474232 
iter  10 value 9048.422916
iter  10 value 9048.422913
final  value 9048.422913 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 9101.517 mgc: 4.267725 ustep: 0.6827823 
iter: 2  value: 9094.167 mgc: 1.975723 ustep: 0.8263238 
iter: 3  value: 9093.815 mgc: 1.121015 ustep: 0.9090326 
iter: 4  value: 9093.813 mgc: 0.07177311 ustep: 0.9534367 
iter: 5  value: 9093.813 mgc: 0.001774224 ustep: 0.9764432 
iter: 6  value: 9093.813 mgc: 1.876087e-05 ustep: 0.9881526 
iter: 7  value: 9093.813 mgc: 1.056131e-07 ustep: 0.9940592 
iter: 8  mgc: 3.28835e-10 
iter: 1  mgc: 3.28835e-10 
Matching hessian patterns... Done
outer mgc:  59.01929 
iter: 1  value: 8995.236 mgc: 2.130527 ustep: 1 
iter: 2  value: 8993.919 mgc: 0.5875172 ustep: 1 
iter: 3  value: 8993.918 mgc: 0.01992653 ustep: 1 
iter: 4  value: 8993.918 mgc: 2.487624e-05 ustep: 1 
iter: 5  mgc: 8.649409e-11 
iter: 1  value: 9008.174 mgc: 10.74906 ustep: 1 
iter: 2  value: 9007.464 mgc: 0.7103646 ustep: 1 
iter: 3  value: 9007.464 mgc: 0.0131512 ustep: 1 
iter: 4  value: 9007.464 mgc: 6.117729e-06 ustep: 1 
iter: 5  mgc: 1.791012e-12 
iter: 1  mgc: 8.649409e-11 
outer mgc:  47.22597 
iter: 1  value: 8835.382 mgc: 5.516465 ustep: 1 
iter: 2  value: 8834.03 mgc: 0.900105 ustep: 1 
iter: 3  value: 8834.029 mgc: 0.03175032 ustep: 1 
iter: 4  value: 8834.029 mgc: 4.241964e-05 ustep: 1 
iter: 5  mgc: 8.283441e-11 
iter: 1  mgc: 8.283441e-11 
outer mgc:  78.37701 
iter: 1  value: 8966.465 mgc: 15.05303 ustep: 1 
iter: 2  value: 8906.782 mgc: 9.364759 ustep: 1 
iter: 3  value: 8906.116 mgc: 1.348564 ustep: 1 
iter: 4  value: 8906.115 mgc: 0.05096532 ustep: 1 
iter: 5  value: 8906.115 mgc: 3.444857e-05 ustep: 1 
iter: 6  mgc: 1.208171e-10 
iter: 1  value: 8791.083 mgc: 3.817742 ustep: 1 
iter: 2  value: 8791.075 mgc: 0.04888256 ustep: 1 
iter: 3  value: 8791.075 mgc: 0.0002855925 ustep: 1 
iter: 4  mgc: 6.434013e-09 
iter: 1  mgc: 6.434013e-09 
outer mgc:  50.28509 
iter: 1  value: 8762.003 mgc: 2.990469 ustep: 1 
iter: 2  value: 8761.996 mgc: 0.1006365 ustep: 1 
iter: 3  value: 8761.996 mgc: 0.0002170161 ustep: 1 
iter: 4  mgc: 9.326941e-10 
iter: 1  mgc: 9.326941e-10 
outer mgc:  58.72951 
iter: 1  value: 8710.763 mgc: 6.756169 ustep: 1 
iter: 2  value: 8710.74 mgc: 0.1870728 ustep: 1 
iter: 3  value: 8710.74 mgc: 0.0002521346 ustep: 1 
iter: 4  mgc: 6.116516e-10 
iter: 1  mgc: 6.116516e-10 
outer mgc:  76.9218 
iter: 1  value: 8688.883 mgc: 7.94693 ustep: 1 
iter: 2  value: 8688.806 mgc: 0.4692184 ustep: 1 
iter: 3  value: 8688.806 mgc: 0.001746218 ustep: 1 
iter: 4  value: 8688.806 mgc: 2.228055e-08 ustep: 1 
mgc: 1.132427e-14 
iter: 1  mgc: 1.132427e-14 
outer mgc:  72.54616 
iter: 1  value: 8715.312 mgc: 16.41771 ustep: 1 
iter: 2  value: 8714.55 mgc: 1.418657 ustep: 1 
iter: 3  value: 8714.549 mgc: 0.09045367 ustep: 1 
iter: 4  value: 8714.549 mgc: 0.0003370604 ustep: 1 
iter: 5  mgc: 5.058776e-09 
iter: 1  value: 8673.507 mgc: 5.594665 ustep: 1 
iter: 2  value: 8673.495 mgc: 0.18362 ustep: 1 
iter: 3  value: 8673.495 mgc: 0.0004006151 ustep: 1 
iter: 4  mgc: 1.130076e-09 
iter: 1  mgc: 1.130076e-09 
outer mgc:  64.00154 
iter: 1  value: 8666.092 mgc: 4.648645 ustep: 1 
iter: 2  value: 8666.069 mgc: 0.1240853 ustep: 1 
iter: 3  value: 8666.069 mgc: 0.0004493516 ustep: 1 
iter: 4  mgc: 7.022793e-10 
iter: 1  mgc: 7.022793e-10 
outer mgc:  24.87483 
iter: 1  value: 8651.538 mgc: 1.686196 ustep: 1 
iter: 2  value: 8651.537 mgc: 0.02373698 ustep: 1 
iter: 3  value: 8651.537 mgc: 2.991834e-05 ustep: 1 
iter: 4  mgc: 3.030913e-11 
iter: 1  mgc: 3.030913e-11 
outer mgc:  13.97681 
iter: 1  value: 8639.565 mgc: 1.938835 ustep: 1 
iter: 2  value: 8639.564 mgc: 0.03144395 ustep: 1 
iter: 3  value: 8639.564 mgc: 2.100413e-05 ustep: 1 
iter: 4  mgc: 6.685763e-12 
iter: 1  mgc: 6.685763e-12 
outer mgc:  33.82309 
iter: 1  value: 8643.399 mgc: 6.177949 ustep: 1 
iter: 2  value: 8643.396 mgc: 0.1045709 ustep: 1 
iter: 3  value: 8643.396 mgc: 0.0001018211 ustep: 1 
iter: 4  mgc: 1.903455e-11 
iter: 1  value: 8636.919 mgc: 2.632421 ustep: 1 
iter: 2  value: 8636.919 mgc: 0.02212825 ustep: 1 
iter: 3  value: 8636.919 mgc: 4.683284e-06 ustep: 1 
iter: 4  mgc: 7.904788e-14 
iter: 1  mgc: 7.904788e-14 
outer mgc:  30.15255 
iter: 1  value: 8635.344 mgc: 2.248711 ustep: 1 
iter: 2  value: 8635.344 mgc: 0.04788692 ustep: 1 
iter: 3  value: 8635.344 mgc: 1.992785e-05 ustep: 1 
iter: 4  mgc: 3.369305e-12 
iter: 1  mgc: 3.369305e-12 
outer mgc:  8.098687 
iter: 1  value: 8634.316 mgc: 1.687774 ustep: 1 
iter: 2  value: 8634.316 mgc: 0.007039739 ustep: 1 
iter: 3  value: 8634.316 mgc: 5.403451e-07 ustep: 1 
iter: 4  mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  6.395384 
iter: 1  value: 8632.469 mgc: 1.811262 ustep: 1 
iter: 2  value: 8632.469 mgc: 0.02847856 ustep: 1 
iter: 3  value: 8632.469 mgc: 6.277988e-06 ustep: 1 
iter: 4  mgc: 3.153033e-13 
iter: 1  mgc: 3.153033e-13 
outer mgc:  6.326154 
iter: 1  value: 8627.31 mgc: 2.179472 ustep: 1 
iter: 2  value: 8627.31 mgc: 0.02837417 ustep: 1 
iter: 3  value: 8627.31 mgc: 6.790044e-06 ustep: 1 
iter: 4  mgc: 3.894662e-13 
iter: 1  mgc: 3.894662e-13 
outer mgc:  16.93442 
iter: 1  value: 8623.527 mgc: 3.682547 ustep: 1 
iter: 2  value: 8623.527 mgc: 0.03002276 ustep: 1 
iter: 3  value: 8623.527 mgc: 2.777824e-06 ustep: 1 
iter: 4  mgc: 3.606004e-13 
iter: 1  mgc: 3.606004e-13 
outer mgc:  16.36785 
iter: 1  value: 8625.802 mgc: 3.556984 ustep: 1 
iter: 2  value: 8625.801 mgc: 0.068465 ustep: 1 
iter: 3  value: 8625.801 mgc: 2.533891e-05 ustep: 1 
iter: 4  mgc: 4.267142e-11 
iter: 1  mgc: 4.267142e-11 
outer mgc:  13.05297 
iter: 1  value: 8624.207 mgc: 1.57039 ustep: 1 
iter: 2  value: 8624.207 mgc: 0.009508901 ustep: 1 
iter: 3  value: 8624.207 mgc: 8.405611e-07 ustep: 1 
iter: 4  mgc: 5.295764e-14 
iter: 1  mgc: 5.295764e-14 
outer mgc:  9.672694 
iter: 1  value: 8621.642 mgc: 2.117537 ustep: 1 
iter: 2  value: 8621.642 mgc: 0.01812571 ustep: 1 
iter: 3  value: 8621.642 mgc: 1.999562e-06 ustep: 1 
iter: 4  mgc: 6.128431e-14 
iter: 1  value: 8623.575 mgc: 1.125389 ustep: 1 
iter: 2  value: 8623.575 mgc: 0.001761164 ustep: 1 
iter: 3  value: 8623.575 mgc: 2.771586e-08 ustep: 1 
mgc: 4.496403e-14 
iter: 1  value: 8623.707 mgc: 0.5184785 ustep: 1 
iter: 2  value: 8623.707 mgc: 0.0003723686 ustep: 1 
iter: 3  mgc: 1.200827e-09 
iter: 1  mgc: 1.200827e-09 
outer mgc:  2.972963 
iter: 1  value: 8623.142 mgc: 0.3685155 ustep: 1 
iter: 2  value: 8623.142 mgc: 0.0004478117 ustep: 1 
iter: 3  mgc: 1.37456e-09 
iter: 1  mgc: 1.37456e-09 
outer mgc:  2.703568 
iter: 1  value: 8622.054 mgc: 0.4874521 ustep: 1 
iter: 2  value: 8622.054 mgc: 0.001138378 ustep: 1 
iter: 3  mgc: 7.658686e-09 
iter: 1  mgc: 7.658686e-09 
outer mgc:  2.900789 
iter: 1  value: 8620.918 mgc: 0.608133 ustep: 1 
iter: 2  value: 8620.918 mgc: 0.0004608307 ustep: 1 
iter: 3  mgc: 1.461359e-09 
iter: 1  mgc: 1.461359e-09 
outer mgc:  2.767362 
iter: 1  value: 8619.936 mgc: 0.4913711 ustep: 1 
iter: 2  value: 8619.936 mgc: 0.0006460009 ustep: 1 
iter: 3  mgc: 1.96983e-09 
iter: 1  value: 8618.244 mgc: 0.8861427 ustep: 1 
iter: 2  value: 8618.244 mgc: 0.002992402 ustep: 1 
iter: 3  value: 8618.244 mgc: 3.599287e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  4.954478 
iter: 1  value: 8616.777 mgc: 1.205504 ustep: 1 
iter: 2  value: 8616.777 mgc: 0.007755841 ustep: 1 
iter: 3  value: 8616.777 mgc: 3.465475e-07 ustep: 1 
iter: 4  mgc: 3.869127e-14 
iter: 1  mgc: 3.869127e-14 
outer mgc:  4.173987 
iter: 1  value: 8613.972 mgc: 1.550466 ustep: 1 
iter: 2  value: 8613.972 mgc: 0.01253143 ustep: 1 
iter: 3  value: 8613.972 mgc: 8.548793e-07 ustep: 1 
iter: 4  mgc: 8.637535e-14 
iter: 1  mgc: 8.637535e-14 
outer mgc:  5.690329 
iter: 1  value: 8610.376 mgc: 1.725358 ustep: 1 
iter: 2  value: 8610.376 mgc: 0.008682013 ustep: 1 
iter: 3  value: 8610.376 mgc: 2.044037e-07 ustep: 1 
iter: 4  mgc: 4.096723e-14 
iter: 1  mgc: 4.096723e-14 
outer mgc:  4.39139 
iter: 1  value: 8608.674 mgc: 2.022974 ustep: 1 
iter: 2  value: 8608.674 mgc: 0.002836517 ustep: 1 
iter: 3  value: 8608.674 mgc: 3.497339e-08 ustep: 1 
mgc: 4.396483e-14 
iter: 1  value: 8609.817 mgc: 1.489851 ustep: 1 
iter: 2  value: 8609.817 mgc: 0.003093135 ustep: 1 
iter: 3  value: 8609.817 mgc: 3.989587e-08 ustep: 1 
mgc: 5.406786e-14 
iter: 1  value: 8610.478 mgc: 1.227073 ustep: 1 
iter: 2  value: 8610.478 mgc: 0.003671118 ustep: 1 
iter: 3  value: 8610.478 mgc: 5.660672e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  value: 8610.535 mgc: 0.7408263 ustep: 1 
iter: 2  value: 8610.535 mgc: 0.001337939 ustep: 1 
iter: 3  mgc: 7.535764e-09 
iter: 1  mgc: 7.535764e-09 
outer mgc:  6.363053 
iter: 1  value: 8610.317 mgc: 0.2862677 ustep: 1 
iter: 2  value: 8610.317 mgc: 5.946098e-05 ustep: 1 
iter: 3  mgc: 1.601541e-11 
iter: 1  mgc: 1.601541e-11 
outer mgc:  0.9210614 
iter: 1  value: 8610.246 mgc: 0.157821 ustep: 1 
iter: 2  value: 8610.246 mgc: 7.268445e-05 ustep: 1 
iter: 3  mgc: 9.19087e-12 
iter: 1  mgc: 9.19087e-12 
outer mgc:  1.052702 
iter: 1  value: 8610.019 mgc: 0.1096552 ustep: 1 
iter: 2  value: 8610.019 mgc: 2.161393e-05 ustep: 1 
iter: 3  mgc: 1.0143e-12 
iter: 1  value: 8609.363 mgc: 0.349227 ustep: 1 
iter: 2  value: 8609.363 mgc: 0.0002340449 ustep: 1 
iter: 3  mgc: 1.933298e-10 
iter: 1  value: 8608.233 mgc: 0.590727 ustep: 1 
iter: 2  value: 8608.233 mgc: 0.0006257257 ustep: 1 
iter: 3  mgc: 1.093605e-09 
iter: 1  mgc: 1.093605e-09 
outer mgc:  0.6181584 
iter: 1  value: 8605.129 mgc: 1.504157 ustep: 1 
iter: 2  value: 8605.129 mgc: 0.00185603 ustep: 1 
iter: 3  value: 8605.129 mgc: 1.666232e-08 ustep: 1 
mgc: 4.385381e-14 
iter: 1  mgc: 4.385381e-14 
outer mgc:  0.7518486 
iter: 1  value: 8604.369 mgc: 0.2907706 ustep: 1 
iter: 2  value: 8604.369 mgc: 7.841065e-05 ustep: 1 
iter: 3  mgc: 1.054001e-11 
iter: 1  mgc: 1.054001e-11 
outer mgc:  0.2350373 
iter: 1  value: 8604.117 mgc: 0.3188827 ustep: 1 
iter: 2  value: 8604.117 mgc: 4.643709e-05 ustep: 1 
iter: 3  mgc: 1.088907e-11 
iter: 1  value: 8604.248 mgc: 0.1516216 ustep: 1 
iter: 2  value: 8604.248 mgc: 1.072737e-05 ustep: 1 
iter: 3  mgc: 5.57776e-13 
iter: 1  mgc: 5.57776e-13 
outer mgc:  0.09634667 
iter: 1  value: 8604.111 mgc: 0.1058772 ustep: 1 
iter: 2  value: 8604.111 mgc: 1.828837e-05 ustep: 1 
iter: 3  mgc: 5.737633e-13 
iter: 1  mgc: 5.737633e-13 
outer mgc:  0.07709233 
iter: 1  value: 8604.055 mgc: 0.02849681 ustep: 1 
iter: 2  value: 8604.055 mgc: 1.106512e-06 ustep: 1 
iter: 3  mgc: 4.163336e-14 
iter: 1  mgc: 4.163336e-14 
outer mgc:  0.00617737 
iter: 1  value: 8604.031 mgc: 0.00957091 ustep: 1 
iter: 2  value: 8604.031 mgc: 9.310058e-08 ustep: 1 
mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  0.000690946 
iter: 1  value: 8604.024 mgc: 0.002601466 ustep: 1 
iter: 2  mgc: 6.685577e-09 
iter: 1  mgc: 6.685577e-09 
outer mgc:  9.2899e-05 
iter: 1  mgc: 6.685577e-09 
iter: 1  mgc: 6.685577e-09 
outer mgc:  9.2899e-05 
iter: 1  value: 8604.021 mgc: 0.01600018 ustep: 1 
iter: 2  value: 8604.021 mgc: 7.541388e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.4564823 
iter: 1  value: 8604.028 mgc: 0.01598963 ustep: 1 
iter: 2  value: 8604.028 mgc: 7.533941e-07 ustep: 1 
iter: 3  mgc: 5.861978e-14 
outer mgc:  0.4563009 
iter: 1  value: 8604.023 mgc: 0.006769739 ustep: 1 
iter: 2  value: 8604.023 mgc: 8.555068e-08 ustep: 1 
iter: 3  mgc: 5.928591e-14 
outer mgc:  0.241729 
iter: 1  value: 8604.026 mgc: 0.006764242 ustep: 1 
iter: 2  value: 8604.026 mgc: 8.543575e-08 ustep: 1 
iter: 3  mgc: 3.763656e-14 
outer mgc:  0.2414891 
iter: 1  value: 8604.029 mgc: 0.02034124 ustep: 1 
iter: 2  value: 8604.029 mgc: 8.209323e-07 ustep: 1 
iter: 3  mgc: 5.795364e-14 
outer mgc:  0.5115471 
iter: 1  value: 8604.02 mgc: 0.02034468 ustep: 1 
iter: 2  value: 8604.02 mgc: 8.170879e-07 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.511898 
iter: 1  value: 8604.03 mgc: 0.0116866 ustep: 1 
iter: 2  value: 8604.03 mgc: 1.302771e-07 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.3514933 
iter: 1  value: 8604.019 mgc: 0.01168787 ustep: 1 
iter: 2  value: 8604.019 mgc: 1.30499e-07 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.3518542 
iter: 1  value: 8604.054 mgc: 0.06893526 ustep: 1 
iter: 2  value: 8604.054 mgc: 7.657591e-06 ustep: 1 
iter: 3  mgc: 1.367795e-13 
outer mgc:  0.1755442 
iter: 1  value: 8603.995 mgc: 0.06913229 ustep: 1 
iter: 2  value: 8603.995 mgc: 7.659006e-06 ustep: 1 
iter: 3  mgc: 1.221245e-13 
outer mgc:  0.1753172 
iter: 1  value: 8604.043 mgc: 0.06992753 ustep: 1 
iter: 2  value: 8604.043 mgc: 4.835314e-06 ustep: 1 
iter: 3  mgc: 1.016964e-13 
outer mgc:  0.1995031 
iter: 1  value: 8604.006 mgc: 0.07013511 ustep: 1 
iter: 2  value: 8604.006 mgc: 4.832552e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
outer mgc:  0.1996031 
iter: 1  value: 8604.016 mgc: 0.003409114 ustep: 1 
iter: 2  value: 8604.016 mgc: 1.064e-08 ustep: 1 
mgc: 5.151435e-14 
outer mgc:  0.0008677695 
iter: 1  value: 8604.033 mgc: 0.003408381 ustep: 1 
iter: 2  value: 8604.033 mgc: 1.064956e-08 ustep: 1 
mgc: 6.483702e-14 
outer mgc:  0.0008236158 
iter: 1  value: 8604.011 mgc: 0.005286117 ustep: 1 
iter: 2  value: 8604.011 mgc: 8.274831e-08 ustep: 1 
iter: 3  mgc: 4.274359e-14 
outer mgc:  0.02116742 
iter: 1  value: 8604.038 mgc: 0.005285762 ustep: 1 
iter: 2  value: 8604.038 mgc: 8.279828e-08 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  0.02114272 
[Sat Aug 14 00:03:21 2021]
Finished job 0.
1 of 1 steps (100%) done

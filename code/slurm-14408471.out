Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:09:11 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11025.672929 
final  value 10236.577616 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5161.846 mgc: 120.3842 ustep: 1 
iter: 2  value: 1258.318 mgc: 48.14899 ustep: 0.1336527 
iter: 3  value: 804.3011 mgc: 92.44863 ustep: 0.3656489 
iter: 4  value: 792.8846 mgc: 13.21942 ustep: 0.6047286 
iter: 5  value: 792.6788 mgc: 2.42706 ustep: 0.7776652 
iter: 6  value: 792.6778 mgc: 0.1683901 ustep: 0.8818651 
iter: 7  value: 792.6778 mgc: 0.002228119 ustep: 0.9390828 
iter: 8  value: 792.6778 mgc: 9.947222e-06 ustep: 0.969066 
iter: 9  value: 792.6778 mgc: 2.200775e-08 ustep: 0.984413 
mgc: 2.438899e-11 
iter: 1  mgc: 2.438899e-11 
Matching hessian patterns... Done
outer mgc:  93.3652 
iter: 1  value: 768.262 mgc: 15.00328 ustep: 1 
iter: 2  value: 766.8991 mgc: 2.100796 ustep: 1 
iter: 3  value: 766.8988 mgc: 0.04686112 ustep: 1 
iter: 4  value: 766.8988 mgc: 2.981374e-05 ustep: 1 
iter: 5  mgc: 1.897815e-11 
iter: 1  mgc: 1.897815e-11 
outer mgc:  102.6294 
iter: 1  value: 696.5564 mgc: 14.69039 ustep: 1 
iter: 2  value: 696.4799 mgc: 0.4894808 ustep: 1 
iter: 3  value: 696.4799 mgc: 0.001599513 ustep: 1 
iter: 4  value: 696.4799 mgc: 1.732344e-08 ustep: 1 
mgc: 2.053913e-14 
iter: 1  mgc: 2.053913e-14 
outer mgc:  47.84171 
iter: 1  value: 736.2317 mgc: 21.9736 ustep: 1 
iter: 2  value: 731.3724 mgc: 4.020474 ustep: 1 
iter: 3  value: 731.3699 mgc: 0.1377275 ustep: 1 
iter: 4  value: 731.3699 mgc: 0.0001800243 ustep: 1 
iter: 5  mgc: 3.091789e-10 
iter: 1  value: 687.4369 mgc: 7.266851 ustep: 1 
iter: 2  value: 687.3876 mgc: 0.3771475 ustep: 1 
iter: 3  value: 687.3876 mgc: 0.001521162 ustep: 1 
iter: 4  value: 687.3876 mgc: 3.497803e-08 ustep: 1 
mgc: 1.676437e-14 
iter: 1  mgc: 1.676437e-14 
outer mgc:  48.86346 
iter: 1  value: 682.3353 mgc: 5.834458 ustep: 1 
iter: 2  value: 682.3295 mgc: 0.125977 ustep: 1 
iter: 3  value: 682.3295 mgc: 0.0001509949 ustep: 1 
iter: 4  mgc: 2.175399e-10 
iter: 1  mgc: 2.175399e-10 
outer mgc:  71.89128 
iter: 1  value: 667.8745 mgc: 16.26271 ustep: 1 
iter: 2  value: 667.3974 mgc: 1.182931 ustep: 1 
iter: 3  value: 667.3974 mgc: 0.006698846 ustep: 1 
iter: 4  value: 667.3974 mgc: 5.31925e-07 ustep: 1 
iter: 5  mgc: 1.726397e-14 
iter: 1  mgc: 1.726397e-14 
outer mgc:  45.65365 
iter: 1  value: 654.981 mgc: 6.734867 ustep: 1 
iter: 2  value: 654.9658 mgc: 0.2246193 ustep: 1 
iter: 3  value: 654.9658 mgc: 0.0007128129 ustep: 1 
iter: 4  mgc: 6.91213e-09 
iter: 1  mgc: 6.91213e-09 
outer mgc:  40.30065 
iter: 1  value: 646.8536 mgc: 12.83862 ustep: 1 
iter: 2  value: 646.7 mgc: 0.6649303 ustep: 1 
iter: 3  value: 646.7 mgc: 0.002635133 ustep: 1 
iter: 4  value: 646.7 mgc: 6.57583e-08 ustep: 1 
mgc: 2.211425e-14 
iter: 1  mgc: 2.211425e-14 
outer mgc:  57.94984 
iter: 1  value: 637.7259 mgc: 12.2062 ustep: 1 
iter: 2  value: 637.6286 mgc: 0.521195 ustep: 1 
iter: 3  value: 637.6286 mgc: 0.001625244 ustep: 1 
iter: 4  value: 637.6286 mgc: 1.944259e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  55.82356 
iter: 1  value: 626.1178 mgc: 7.488734 ustep: 1 
iter: 2  value: 626.0929 mgc: 0.3311007 ustep: 1 
iter: 3  value: 626.0929 mgc: 0.0007881259 ustep: 1 
iter: 4  mgc: 4.348108e-09 
iter: 1  mgc: 4.348108e-09 
outer mgc:  27.57969 
iter: 1  value: 619.1854 mgc: 4.3896 ustep: 1 
iter: 2  value: 619.1831 mgc: 0.1341237 ustep: 1 
iter: 3  value: 619.1831 mgc: 0.0001039787 ustep: 1 
iter: 4  mgc: 5.932144e-11 
iter: 1  mgc: 5.932144e-11 
outer mgc:  18.21622 
iter: 1  value: 631.2691 mgc: 9.157429 ustep: 1 
iter: 2  value: 631.2607 mgc: 0.2474899 ustep: 1 
iter: 3  value: 631.2607 mgc: 0.0002828618 ustep: 1 
iter: 4  mgc: 3.461764e-10 
iter: 1  value: 618.1104 mgc: 1.437506 ustep: 1 
iter: 2  value: 618.1104 mgc: 0.002505622 ustep: 1 
iter: 3  value: 618.1104 mgc: 3.58988e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  9.887116 
iter: 1  value: 618.321 mgc: 1.582004 ustep: 1 
iter: 2  value: 618.321 mgc: 0.003094923 ustep: 1 
iter: 3  value: 618.321 mgc: 5.153771e-08 ustep: 1 
mgc: 1.798561e-14 
iter: 1  value: 617.9365 mgc: 0.5123497 ustep: 1 
iter: 2  value: 617.9365 mgc: 0.0003248136 ustep: 1 
iter: 3  mgc: 5.786882e-10 
iter: 1  mgc: 5.786882e-10 
outer mgc:  5.749654 
iter: 1  value: 617.7214 mgc: 0.5784495 ustep: 1 
iter: 2  value: 617.7214 mgc: 0.0004951583 ustep: 1 
iter: 3  mgc: 9.918431e-10 
iter: 1  mgc: 9.918431e-10 
outer mgc:  3.739905 
iter: 1  value: 617.2915 mgc: 0.5662736 ustep: 1 
iter: 2  value: 617.2915 mgc: 0.0006197107 ustep: 1 
iter: 3  mgc: 1.730695e-09 
iter: 1  value: 616.7266 mgc: 0.4125401 ustep: 1 
iter: 2  value: 616.7266 mgc: 0.0006285713 ustep: 1 
iter: 3  mgc: 2.087245e-09 
iter: 1  value: 614.9832 mgc: 1.393539 ustep: 1 
iter: 2  value: 614.9832 mgc: 0.006566045 ustep: 1 
iter: 3  value: 614.9832 mgc: 2.198285e-07 ustep: 1 
mgc: 1.94289e-14 
iter: 1  mgc: 1.94289e-14 
outer mgc:  5.081615 
iter: 1  value: 614.5653 mgc: 2.883972 ustep: 1 
iter: 2  value: 614.5653 mgc: 0.0109676 ustep: 1 
iter: 3  value: 614.5653 mgc: 3.040285e-07 ustep: 1 
iter: 4  mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  11.52834 
iter: 1  value: 613.8626 mgc: 2.798045 ustep: 1 
iter: 2  value: 613.8626 mgc: 0.01495004 ustep: 1 
iter: 3  value: 613.8626 mgc: 1.115731e-06 ustep: 1 
iter: 4  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  5.799182 
iter: 1  value: 612.3196 mgc: 2.194439 ustep: 1 
iter: 2  value: 612.3196 mgc: 0.009809567 ustep: 1 
iter: 3  value: 612.3196 mgc: 4.286662e-07 ustep: 1 
iter: 4  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  9.423679 
iter: 1  value: 611.683 mgc: 2.325282 ustep: 1 
iter: 2  value: 611.683 mgc: 0.009380717 ustep: 1 
iter: 3  value: 611.683 mgc: 1.939456e-07 ustep: 1 
iter: 4  mgc: 1.776357e-14 
iter: 1  value: 612.2732 mgc: 1.635147 ustep: 1 
iter: 2  value: 612.2732 mgc: 0.002413065 ustep: 1 
iter: 3  value: 612.2732 mgc: 3.890338e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  14.05186 
iter: 1  value: 612.0959 mgc: 0.6752823 ustep: 1 
iter: 2  value: 612.0959 mgc: 0.0005023877 ustep: 1 
iter: 3  mgc: 1.206299e-09 
iter: 1  mgc: 1.206299e-09 
outer mgc:  2.477142 
iter: 1  value: 611.983 mgc: 0.2214719 ustep: 1 
iter: 2  value: 611.983 mgc: 0.0001941498 ustep: 1 
iter: 3  mgc: 1.863123e-10 
iter: 1  mgc: 1.863123e-10 
outer mgc:  3.522858 
iter: 1  value: 611.998 mgc: 0.5017281 ustep: 1 
iter: 2  value: 611.998 mgc: 0.0008176879 ustep: 1 
iter: 3  mgc: 2.930576e-09 
iter: 1  mgc: 2.930576e-09 
outer mgc:  3.687269 
iter: 1  value: 612.0938 mgc: 0.5783664 ustep: 1 
iter: 2  value: 612.0938 mgc: 0.00112575 ustep: 1 
iter: 3  mgc: 6.440246e-09 
iter: 1  mgc: 6.440246e-09 
outer mgc:  3.823182 
iter: 1  value: 611.8905 mgc: 0.3467054 ustep: 1 
iter: 2  value: 611.8905 mgc: 0.0004459538 ustep: 1 
iter: 3  mgc: 8.699637e-10 
iter: 1  mgc: 8.699637e-10 
outer mgc:  1.370234 
iter: 1  value: 611.222 mgc: 0.7674633 ustep: 1 
iter: 2  value: 611.222 mgc: 0.0014848 ustep: 1 
iter: 3  value: 611.222 mgc: 1.031766e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  6.767867 
iter: 1  value: 609.9976 mgc: 1.237511 ustep: 1 
iter: 2  value: 609.9976 mgc: 0.002787396 ustep: 1 
iter: 3  value: 609.9976 mgc: 3.768512e-08 ustep: 1 
mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  1.910211 
iter: 1  value: 609.8879 mgc: 0.4990234 ustep: 1 
iter: 2  value: 609.8879 mgc: 0.0002584904 ustep: 1 
iter: 3  mgc: 2.84337e-10 
iter: 1  mgc: 2.84337e-10 
outer mgc:  5.058244 
iter: 1  value: 609.5531 mgc: 0.430166 ustep: 1 
iter: 2  value: 609.5531 mgc: 0.0001788612 ustep: 1 
iter: 3  mgc: 1.562999e-10 
iter: 1  mgc: 1.562999e-10 
outer mgc:  1.055 
iter: 1  value: 609.2477 mgc: 0.2125982 ustep: 1 
iter: 2  value: 609.2477 mgc: 8.457478e-05 ustep: 1 
iter: 3  mgc: 1.735501e-11 
iter: 1  value: 608.263 mgc: 0.6380332 ustep: 1 
iter: 2  value: 608.263 mgc: 0.0008314088 ustep: 1 
iter: 3  mgc: 3.155448e-09 
iter: 1  mgc: 3.155448e-09 
outer mgc:  2.456121 
iter: 1  value: 607.0151 mgc: 1.635347 ustep: 1 
iter: 2  value: 607.0151 mgc: 0.005276596 ustep: 1 
iter: 3  value: 607.0151 mgc: 1.196998e-07 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  3.230659 
iter: 1  value: 606.4879 mgc: 0.8335876 ustep: 1 
iter: 2  value: 606.4879 mgc: 0.00314414 ustep: 1 
iter: 3  value: 606.4879 mgc: 4.082263e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  1.304546 
iter: 1  value: 606.5362 mgc: 0.4665558 ustep: 1 
iter: 2  value: 606.5362 mgc: 0.001048208 ustep: 1 
iter: 3  mgc: 5.454571e-09 
iter: 1  value: 606.5081 mgc: 0.2315831 ustep: 1 
iter: 2  value: 606.5081 mgc: 0.0002578869 ustep: 1 
iter: 3  mgc: 3.293765e-10 
iter: 1  mgc: 3.293765e-10 
outer mgc:  0.3851239 
iter: 1  value: 606.4425 mgc: 0.06394828 ustep: 1 
iter: 2  value: 606.4425 mgc: 6.110749e-06 ustep: 1 
iter: 3  mgc: 1.572076e-13 
iter: 1  mgc: 1.572076e-13 
outer mgc:  0.1073812 
iter: 1  value: 606.3668 mgc: 0.06210913 ustep: 1 
iter: 2  value: 606.3668 mgc: 5.523248e-06 ustep: 1 
iter: 3  mgc: 1.314504e-13 
iter: 1  mgc: 1.314504e-13 
outer mgc:  0.01299978 
iter: 1  value: 606.3596 mgc: 0.005444408 ustep: 1 
iter: 2  value: 606.3596 mgc: 5.977294e-08 ustep: 1 
mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  0.004115336 
iter: 1  value: 606.3589 mgc: 0.0004766405 ustep: 1 
iter: 2  mgc: 2.808171e-10 
iter: 1  mgc: 2.808171e-10 
outer mgc:  0.0001643856 
iter: 1  mgc: 2.808171e-10 
iter: 1  mgc: 2.808171e-10 
outer mgc:  0.0001643856 
iter: 1  value: 606.3593 mgc: 0.05194045 ustep: 1 
iter: 2  value: 606.3593 mgc: 4.000254e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.7386921 
iter: 1  value: 606.3594 mgc: 0.05192989 ustep: 1 
iter: 2  value: 606.3594 mgc: 3.999952e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.7383469 
iter: 1  value: 606.359 mgc: 0.02578436 ustep: 1 
iter: 2  value: 606.359 mgc: 9.639332e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.6116899 
iter: 1  value: 606.3595 mgc: 0.02577495 ustep: 1 
iter: 2  value: 606.3595 mgc: 9.631661e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
outer mgc:  0.6115937 
iter: 1  value: 606.359 mgc: 0.04908832 ustep: 1 
iter: 2  value: 606.359 mgc: 3.710926e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.7278677 
iter: 1  value: 606.3596 mgc: 0.04907317 ustep: 1 
iter: 2  value: 606.3596 mgc: 3.712888e-06 ustep: 1 
iter: 3  mgc: 4.620609e-14 
outer mgc:  0.7281292 
iter: 1  value: 606.3589 mgc: 0.02485462 ustep: 1 
iter: 2  value: 606.3589 mgc: 9.884914e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.6076083 
iter: 1  value: 606.3596 mgc: 0.02484454 ustep: 1 
iter: 2  value: 606.3596 mgc: 9.876308e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.6074928 
iter: 1  value: 606.3504 mgc: 0.005052059 ustep: 1 
iter: 2  value: 606.3504 mgc: 2.898835e-08 ustep: 1 
mgc: 2.398082e-14 
outer mgc:  0.001792809 
iter: 1  value: 606.3675 mgc: 0.005050539 ustep: 1 
iter: 2  value: 606.3675 mgc: 2.9017e-08 ustep: 1 
mgc: 1.687539e-14 
outer mgc:  0.00193128 
iter: 1  value: 606.3759 mgc: 0.05025017 ustep: 1 
iter: 2  value: 606.3759 mgc: 3.178452e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.2493505 
iter: 1  value: 606.3422 mgc: 0.05038991 ustep: 1 
iter: 2  value: 606.3422 mgc: 3.181304e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.2497224 
iter: 1  value: 606.3762 mgc: 0.04484495 ustep: 1 
iter: 2  value: 606.3762 mgc: 2.133022e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.2500839 
iter: 1  value: 606.3419 mgc: 0.04496895 ustep: 1 
iter: 2  value: 606.3419 mgc: 2.136831e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.2501104 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:09:12 2021]
Finished job 0.
1 of 1 steps (100%) done

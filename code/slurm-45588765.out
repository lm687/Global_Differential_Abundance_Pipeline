Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 00:05:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10953.164518 
iter  10 value 6090.384410
final  value 6012.440617 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 12740.92 mgc: 112.765 ustep: 1 
iter: 2  value: 12608.88 mgc: 60.44753 ustep: 1 
iter: 3  value: 11438.49 mgc: 124.6762 ustep: 1 
iter: 4  value: 11292.74 mgc: 57.13748 ustep: 0.0692153 
iter: 5  value: 11217.44 mgc: 78.49593 ustep: 0.2631617 
iter: 6  value: 11215.18 mgc: 7.510952 ustep: 0.5130416 
iter: 7  value: 11215.17 mgc: 0.8089709 ustep: 0.7162976 
iter: 8  value: 11215.17 mgc: 0.01626014 ustep: 0.846359 
iter: 9  value: 11215.17 mgc: 0.0002186775 ustep: 0.9199857 
iter: 10  value: 11215.17 mgc: 2.367801e-06 ustep: 0.959163 
iter: 11  value: 11215.17 mgc: 1.400444e-08 ustep: 0.9793707 
mgc: 4.163354e-11 
iter: 1  mgc: 4.163354e-11 
Matching hessian patterns... Done
outer mgc:  2591.889 
iter: 1  value: 8773.241 mgc: 30.5342 ustep: 1 
iter: 2  value: 8751.882 mgc: 8.331617 ustep: 1 
iter: 3  value: 8751.827 mgc: 0.7075648 ustep: 1 
iter: 4  value: 8751.827 mgc: 0.01229093 ustep: 1 
iter: 5  value: 8751.827 mgc: 3.8112e-06 ustep: 1 
iter: 6  mgc: 3.906875e-13 
iter: 1  value: 4207.033 mgc: 68.85377 ustep: 0.2494656 
iter: 2  value: 3280.173 mgc: 65.24082 ustep: 0.4995153 
iter: 3  value: 3266.539 mgc: 7.968292 ustep: 0.7067933 
iter: 4  value: 3266.503 mgc: 0.5005147 ustep: 0.8407259 
iter: 5  value: 3266.503 mgc: 0.005460658 ustep: 0.9169194 
iter: 6  value: 3266.503 mgc: 3.430585e-05 ustep: 0.9575633 
iter: 7  value: 3266.503 mgc: 2.350167e-07 ustep: 0.9785538 
iter: 8  mgc: 8.006471e-10 
iter: 1  value: 1417.349 mgc: 46.96206 ustep: 1 
iter: 2  value: 1310.983 mgc: 16.31871 ustep: 1 
iter: 3  value: 1309.656 mgc: 1.651594 ustep: 1 
iter: 4  value: 1309.655 mgc: 0.1306484 ustep: 1 
iter: 5  value: 1309.655 mgc: 0.000304003 ustep: 1 
iter: 6  mgc: 3.343746e-09 
iter: 1  mgc: 3.343746e-09 
outer mgc:  127.6797 
iter: 1  value: 1353.387 mgc: 651.7607 ustep: 1 
iter: 2  value: 1334.844 mgc: 11.54241 ustep: 1 
iter: 3  value: 1334.772 mgc: 0.9152767 ustep: 1 
iter: 4  value: 1334.772 mgc: 0.008052753 ustep: 1 
iter: 5  value: 1334.772 mgc: 8.021307e-07 ustep: 1 
iter: 6  mgc: 2.842171e-14 
iter: 1  value: 828.3404 mgc: 13.6902 ustep: 1 
iter: 2  value: 826.6698 mgc: 2.007772 ustep: 1 
iter: 3  value: 826.6693 mgc: 0.04408865 ustep: 1 
iter: 4  value: 826.6693 mgc: 2.74437e-05 ustep: 1 
iter: 5  mgc: 1.168848e-11 
iter: 1  mgc: 1.168848e-11 
outer mgc:  160.1016 
iter: 1  value: 1455.631 mgc: 94.12686 ustep: 1 
iter: 2  value: 1438.142 mgc: 15.52156 ustep: 1 
iter: 3  value: 1438.129 mgc: 0.3834312 ustep: 1 
iter: 4  value: 1438.129 mgc: 0.002372 ustep: 1 
iter: 5  value: 1438.129 mgc: 5.076625e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  value: 775.0613 mgc: 17.69637 ustep: 1 
iter: 2  value: 773.7947 mgc: 2.400166 ustep: 1 
iter: 3  value: 773.7946 mgc: 0.0227973 ustep: 1 
iter: 4  value: 773.7946 mgc: 4.306426e-06 ustep: 1 
iter: 5  mgc: 1.767475e-13 
iter: 1  mgc: 1.767475e-13 
outer mgc:  115.1349 
iter: 1  value: 645.408 mgc: 14.45652 ustep: 1 
iter: 2  value: 644.3533 mgc: 1.512619 ustep: 1 
iter: 3  value: 644.3532 mgc: 0.02027764 ustep: 1 
iter: 4  value: 644.3532 mgc: 4.876739e-06 ustep: 1 
iter: 5  mgc: 2.918776e-13 
iter: 1  mgc: 2.918776e-13 
outer mgc:  74.55662 
iter: 1  value: 568.4086 mgc: 8.622229 ustep: 1 
iter: 2  value: 568.3854 mgc: 0.2555887 ustep: 1 
iter: 3  value: 568.3854 mgc: 0.001379921 ustep: 1 
iter: 4  value: 568.3854 mgc: 4.55952e-08 ustep: 1 
mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  61.63367 
iter: 1  value: 642.2281 mgc: 26.67618 ustep: 1 
iter: 2  value: 632.2763 mgc: 5.611558 ustep: 1 
iter: 3  value: 632.2683 mgc: 0.176723 ustep: 1 
iter: 4  value: 632.2683 mgc: 0.0002781143 ustep: 1 
iter: 5  mgc: 9.151767e-10 
iter: 1  value: 553.6985 mgc: 8.524636 ustep: 1 
iter: 2  value: 553.6451 mgc: 0.3209148 ustep: 1 
iter: 3  value: 553.6451 mgc: 0.0008549265 ustep: 1 
iter: 4  mgc: 6.972058e-09 
iter: 1  mgc: 6.972058e-09 
outer mgc:  40.69942 
iter: 1  value: 542.7877 mgc: 5.998279 ustep: 1 
iter: 2  value: 542.7829 mgc: 0.110821 ustep: 1 
iter: 3  value: 542.7829 mgc: 9.990833e-05 ustep: 1 
iter: 4  mgc: 2.231997e-10 
iter: 1  mgc: 2.231997e-10 
outer mgc:  45.69203 
iter: 1  value: 537.0476 mgc: 13.60587 ustep: 1 
iter: 2  value: 535.9922 mgc: 1.719388 ustep: 1 
iter: 3  value: 535.9921 mgc: 0.0194955 ustep: 1 
iter: 4  value: 535.9921 mgc: 4.25822e-06 ustep: 1 
iter: 5  mgc: 2.327027e-13 
iter: 1  mgc: 2.327027e-13 
outer mgc:  83.51452 
iter: 1  value: 523.0999 mgc: 8.765751 ustep: 1 
iter: 2  value: 523.0525 mgc: 0.2382966 ustep: 1 
iter: 3  value: 523.0525 mgc: 0.0005986574 ustep: 1 
iter: 4  mgc: 5.476323e-09 
iter: 1  mgc: 5.476323e-09 
outer mgc:  39.95988 
iter: 1  value: 521.1147 mgc: 6.936678 ustep: 1 
iter: 2  value: 521.1005 mgc: 0.1790404 ustep: 1 
iter: 3  value: 521.1005 mgc: 0.000224419 ustep: 1 
iter: 4  mgc: 3.835208e-10 
iter: 1  mgc: 3.835208e-10 
outer mgc:  36.18128 
iter: 1  value: 517.8061 mgc: 2.003632 ustep: 1 
iter: 2  value: 517.806 mgc: 0.01859474 ustep: 1 
iter: 3  value: 517.806 mgc: 6.795191e-06 ustep: 1 
iter: 4  mgc: 9.054979e-13 
iter: 1  mgc: 9.054979e-13 
outer mgc:  29.83399 
iter: 1  value: 514.8396 mgc: 6.16911 ustep: 1 
iter: 2  value: 514.838 mgc: 0.1248603 ustep: 1 
iter: 3  value: 514.838 mgc: 0.0002093403 ustep: 1 
iter: 4  mgc: 5.838467e-10 
iter: 1  mgc: 5.838467e-10 
outer mgc:  17.38255 
iter: 1  value: 512.5252 mgc: 6.401353 ustep: 1 
iter: 2  value: 512.5222 mgc: 0.1348919 ustep: 1 
iter: 3  value: 512.5222 mgc: 0.0003149953 ustep: 1 
iter: 4  mgc: 1.789418e-09 
iter: 1  mgc: 1.789418e-09 
outer mgc:  25.72289 
iter: 1  value: 511.6253 mgc: 5.370218 ustep: 1 
iter: 2  value: 511.6245 mgc: 0.03599323 ustep: 1 
iter: 3  value: 511.6245 mgc: 1.332336e-05 ustep: 1 
iter: 4  mgc: 3.68372e-12 
iter: 1  mgc: 3.68372e-12 
outer mgc:  34.73126 
iter: 1  value: 512.7896 mgc: 4.075542 ustep: 1 
iter: 2  value: 512.7887 mgc: 0.05070751 ustep: 1 
iter: 3  value: 512.7887 mgc: 1.35375e-05 ustep: 1 
iter: 4  mgc: 1.661782e-12 
iter: 1  mgc: 1.661782e-12 
outer mgc:  18.00753 
iter: 1  value: 510.789 mgc: 3.305212 ustep: 1 
iter: 2  value: 510.7887 mgc: 0.02985903 ustep: 1 
iter: 3  value: 510.7887 mgc: 1.10229e-05 ustep: 1 
iter: 4  mgc: 2.67697e-12 
iter: 1  mgc: 2.67697e-12 
outer mgc:  9.261821 
iter: 1  value: 508.3628 mgc: 3.606922 ustep: 1 
iter: 2  value: 508.3626 mgc: 0.02981091 ustep: 1 
iter: 3  value: 508.3626 mgc: 1.057327e-05 ustep: 1 
iter: 4  mgc: 1.138645e-12 
iter: 1  mgc: 1.138645e-12 
outer mgc:  8.989385 
iter: 1  value: 509.7395 mgc: 2.226938 ustep: 1 
iter: 2  value: 509.7395 mgc: 0.01611308 ustep: 1 
iter: 3  value: 509.7395 mgc: 1.196388e-06 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  14.96643 
iter: 1  value: 512.4328 mgc: 2.120211 ustep: 1 
iter: 2  value: 512.4327 mgc: 0.01991435 ustep: 1 
iter: 3  value: 512.4327 mgc: 6.177276e-06 ustep: 1 
iter: 4  mgc: 6.052936e-13 
iter: 1  value: 509.7037 mgc: 1.256975 ustep: 1 
iter: 2  value: 509.7037 mgc: 0.004855736 ustep: 1 
iter: 3  value: 509.7037 mgc: 1.911386e-07 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  6.922927 
iter: 1  value: 508.9788 mgc: 0.6214362 ustep: 1 
iter: 2  value: 508.9788 mgc: 0.001217649 ustep: 1 
iter: 3  value: 508.9788 mgc: 1.631407e-08 ustep: 1 
mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  1.310729 
iter: 1  value: 509.2305 mgc: 0.8452938 ustep: 1 
iter: 2  value: 509.2305 mgc: 0.004500591 ustep: 1 
iter: 3  value: 509.2305 mgc: 1.633471e-07 ustep: 1 
iter: 4  mgc: 3.352874e-14 
iter: 1  value: 508.9631 mgc: 0.2210962 ustep: 1 
iter: 2  value: 508.9631 mgc: 0.0003488713 ustep: 1 
iter: 3  mgc: 1.64399e-09 
iter: 1  mgc: 1.64399e-09 
outer mgc:  2.677355 
iter: 1  value: 508.7612 mgc: 0.2612341 ustep: 1 
iter: 2  value: 508.7612 mgc: 0.0002020351 ustep: 1 
iter: 3  mgc: 1.436002e-10 
iter: 1  mgc: 1.436002e-10 
outer mgc:  1.323371 
iter: 1  value: 508.9435 mgc: 0.1114978 ustep: 1 
iter: 2  value: 508.9435 mgc: 4.471279e-05 ustep: 1 
iter: 3  mgc: 3.531397e-11 
iter: 1  mgc: 3.531397e-11 
outer mgc:  0.6682787 
iter: 1  value: 508.9521 mgc: 0.1429713 ustep: 1 
iter: 2  value: 508.9521 mgc: 0.0002536872 ustep: 1 
iter: 3  mgc: 9.512409e-10 
iter: 1  mgc: 9.512409e-10 
outer mgc:  0.4872748 
iter: 1  value: 508.9047 mgc: 0.1088159 ustep: 1 
iter: 2  value: 508.9047 mgc: 0.0001168968 ustep: 1 
iter: 3  mgc: 2.034678e-10 
iter: 1  mgc: 2.034678e-10 
outer mgc:  0.5054533 
iter: 1  value: 508.8076 mgc: 0.2843224 ustep: 1 
iter: 2  value: 508.8076 mgc: 0.000221329 ustep: 1 
iter: 3  mgc: 6.346923e-10 
iter: 1  value: 508.8903 mgc: 0.1143524 ustep: 1 
iter: 2  value: 508.8903 mgc: 2.513131e-05 ustep: 1 
iter: 3  mgc: 9.40048e-12 
iter: 1  mgc: 9.40048e-12 
outer mgc:  0.1565506 
iter: 1  value: 508.9389 mgc: 0.03159725 ustep: 1 
iter: 2  value: 508.9389 mgc: 2.240262e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  0.1149871 
iter: 1  value: 508.9542 mgc: 0.04199022 ustep: 1 
iter: 2  value: 508.9542 mgc: 2.188135e-06 ustep: 1 
iter: 3  mgc: 7.194245e-14 
iter: 1  value: 508.9451 mgc: 0.03583399 ustep: 1 
iter: 2  value: 508.9451 mgc: 1.720445e-06 ustep: 1 
iter: 3  mgc: 3.708145e-14 
iter: 1  value: 508.9397 mgc: 0.03345791 ustep: 1 
iter: 2  value: 508.9397 mgc: 1.510771e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  value: 508.9388 mgc: 0.01591211 ustep: 1 
iter: 2  value: 508.9388 mgc: 3.417544e-07 ustep: 1 
iter: 3  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.04930689 
iter: 1  value: 508.9353 mgc: 0.006069619 ustep: 1 
iter: 2  value: 508.9353 mgc: 2.628553e-07 ustep: 1 
iter: 3  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  0.03961755 
iter: 1  value: 508.9341 mgc: 0.003006444 ustep: 1 
iter: 2  value: 508.9341 mgc: 5.118501e-08 ustep: 1 
iter: 3  mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  0.009513516 
iter: 1  value: 508.9318 mgc: 0.001693925 ustep: 1 
iter: 2  mgc: 7.440383e-09 
iter: 1  mgc: 7.440383e-09 
outer mgc:  0.001783927 
iter: 1  value: 508.9335 mgc: 0.0009869493 ustep: 1 
iter: 2  mgc: 3.02457e-09 
iter: 1  mgc: 3.02457e-09 
outer mgc:  0.0009788861 
iter: 1  value: 508.9331 mgc: 0.0002573644 ustep: 1 
iter: 2  mgc: 1.826312e-10 
iter: 1  mgc: 1.826312e-10 
outer mgc:  0.0002868458 
iter: 1  mgc: 1.826312e-10 
iter: 1  mgc: 1.826312e-10 
outer mgc:  0.0002868458 
iter: 1  value: 508.9348 mgc: 0.02684737 ustep: 1 
iter: 2  value: 508.9348 mgc: 2.125894e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.3699626 
iter: 1  value: 508.9316 mgc: 0.02684204 ustep: 1 
iter: 2  value: 508.9316 mgc: 2.12677e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.3696688 
iter: 1  value: 508.937 mgc: 0.006033172 ustep: 1 
iter: 2  value: 508.937 mgc: 7.484526e-08 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.1710538 
iter: 1  value: 508.9293 mgc: 0.006038588 ustep: 1 
iter: 2  value: 508.9293 mgc: 7.474331e-08 ustep: 1 
iter: 3  mgc: 3.774758e-14 
outer mgc:  0.1705989 
iter: 1  value: 508.9315 mgc: 0.0281609 ustep: 1 
iter: 2  value: 508.9315 mgc: 3.588415e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
outer mgc:  0.2900127 
iter: 1  value: 508.9349 mgc: 0.02814936 ustep: 1 
iter: 2  value: 508.9349 mgc: 3.589984e-06 ustep: 1 
iter: 3  mgc: 8.615331e-14 
outer mgc:  0.2900747 
iter: 1  value: 508.9313 mgc: 0.004347008 ustep: 1 
iter: 2  value: 508.9313 mgc: 4.863101e-08 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.1117039 
iter: 1  value: 508.9349 mgc: 0.004343051 ustep: 1 
iter: 2  value: 508.9349 mgc: 4.850977e-08 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.1117113 
iter: 1  value: 508.9244 mgc: 0.003978614 ustep: 1 
iter: 2  value: 508.9244 mgc: 4.328315e-08 ustep: 1 
mgc: 3.68594e-14 
outer mgc:  0.005753582 
iter: 1  value: 508.9417 mgc: 0.003976978 ustep: 1 
iter: 2  value: 508.9417 mgc: 4.3302e-08 ustep: 1 
mgc: 3.241851e-14 
outer mgc:  0.005723275 
iter: 1  value: 508.9482 mgc: 0.02102898 ustep: 1 
iter: 2  value: 508.9482 mgc: 1.1528e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.175699 
iter: 1  value: 508.918 mgc: 0.02108634 ustep: 1 
iter: 2  value: 508.918 mgc: 1.15132e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.1760953 
iter: 1  value: 508.9455 mgc: 0.0234151 ustep: 1 
iter: 2  value: 508.9455 mgc: 3.574826e-06 ustep: 1 
iter: 3  mgc: 1.731948e-13 
outer mgc:  0.1840212 
iter: 1  value: 508.9208 mgc: 0.02347388 ustep: 1 
iter: 2  value: 508.9208 mgc: 3.58202e-06 ustep: 1 
iter: 3  mgc: 1.767475e-13 
outer mgc:  0.1842515 
[Mon Aug 16 00:05:51 2021]
Finished job 0.
1 of 1 steps (100%) done

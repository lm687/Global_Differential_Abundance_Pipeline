Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:08:30 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.1_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.1_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.1, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.1_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4395.547767 
final  value 4212.097920 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2584.401 mgc: 81.57103 ustep: 1 
iter: 2  value: 1139.096 mgc: 59.31639 ustep: 0.1336527 
iter: 3  value: 656.0971 mgc: 108.3562 ustep: 0.3656489 
iter: 4  value: 558.3568 mgc: 45.00149 ustep: 0.6047286 
iter: 5  value: 552.7024 mgc: 9.823879 ustep: 0.7776652 
iter: 6  value: 552.595 mgc: 1.528973 ustep: 0.8818651 
iter: 7  value: 552.5948 mgc: 0.06790307 ustep: 0.9390828 
iter: 8  value: 552.5948 mgc: 0.000411398 ustep: 0.969066 
iter: 9  value: 552.5948 mgc: 8.762705e-07 ustep: 0.984413 
iter: 10  mgc: 9.317195e-10 
iter: 1  mgc: 9.317195e-10 
Matching hessian patterns... Done
outer mgc:  101.2172 
iter: 1  value: 540.6727 mgc: 29.09009 ustep: 1 
iter: 2  value: 540.2143 mgc: 2.018779 ustep: 1 
iter: 3  value: 540.2141 mgc: 0.06133575 ustep: 1 
iter: 4  value: 540.2141 mgc: 6.258159e-05 ustep: 1 
iter: 5  mgc: 6.535827e-11 
iter: 1  mgc: 6.535827e-11 
outer mgc:  91.40564 
iter: 1  value: 533.1813 mgc: 29.16217 ustep: 1 
iter: 2  value: 532.1575 mgc: 1.934678 ustep: 1 
iter: 3  value: 532.1572 mgc: 0.04410963 ustep: 1 
iter: 4  value: 532.1572 mgc: 4.830549e-05 ustep: 1 
iter: 5  mgc: 5.782319e-11 
iter: 1  mgc: 5.782319e-11 
outer mgc:  87.08957 
iter: 1  value: 510.2005 mgc: 20.14144 ustep: 1 
iter: 2  value: 507.8222 mgc: 3.613794 ustep: 1 
iter: 3  value: 507.8196 mgc: 0.1339196 ustep: 1 
iter: 4  value: 507.8196 mgc: 0.0003211317 ustep: 1 
iter: 5  mgc: 2.354887e-09 
iter: 1  mgc: 2.354887e-09 
outer mgc:  39.09187 
iter: 1  value: 529.7122 mgc: 30.46856 ustep: 1 
iter: 2  value: 529.1044 mgc: 2.162201 ustep: 1 
iter: 3  value: 529.1039 mgc: 0.1083364 ustep: 1 
iter: 4  value: 529.1039 mgc: 0.0003080812 ustep: 1 
iter: 5  mgc: 2.511242e-09 
iter: 1  value: 499.9074 mgc: 11.0649 ustep: 1 
iter: 2  value: 499.9019 mgc: 0.1874874 ustep: 1 
iter: 3  value: 499.9019 mgc: 0.001738268 ustep: 1 
iter: 4  value: 499.9019 mgc: 1.494135e-07 ustep: 1 
iter: 5  mgc: 2.149669e-14 
iter: 1  mgc: 2.149669e-14 
outer mgc:  14.26907 
iter: 1  value: 501.5935 mgc: 12.5273 ustep: 1 
iter: 2  value: 501.5004 mgc: 0.9185402 ustep: 1 
iter: 3  value: 501.5004 mgc: 0.004808941 ustep: 1 
iter: 4  value: 501.5004 mgc: 2.519451e-07 ustep: 1 
iter: 5  mgc: 1.748601e-14 
iter: 1  value: 499.0852 mgc: 6.129 ustep: 1 
iter: 2  value: 499.0824 mgc: 0.1700453 ustep: 1 
iter: 3  value: 499.0824 mgc: 0.0001773921 ustep: 1 
iter: 4  mgc: 3.363592e-10 
iter: 1  mgc: 3.363592e-10 
outer mgc:  12.31204 
iter: 1  value: 497.3866 mgc: 5.673528 ustep: 1 
iter: 2  value: 497.3851 mgc: 0.112274 ustep: 1 
iter: 3  value: 497.3851 mgc: 0.0001049421 ustep: 1 
iter: 4  mgc: 1.531104e-10 
iter: 1  mgc: 1.531104e-10 
outer mgc:  7.352157 
iter: 1  value: 496.196 mgc: 4.377997 ustep: 1 
iter: 2  value: 496.1933 mgc: 0.1136755 ustep: 1 
iter: 3  value: 496.1933 mgc: 0.0001528458 ustep: 1 
iter: 4  mgc: 3.948961e-10 
iter: 1  mgc: 3.948961e-10 
outer mgc:  7.420057 
iter: 1  value: 493.649 mgc: 6.914093 ustep: 1 
iter: 2  value: 493.6253 mgc: 0.2827709 ustep: 1 
iter: 3  value: 493.6253 mgc: 0.001916969 ustep: 1 
iter: 4  value: 493.6253 mgc: 1.402043e-07 ustep: 1 
iter: 5  mgc: 1.471046e-14 
iter: 1  mgc: 1.471046e-14 
outer mgc:  8.779894 
iter: 1  value: 491.9309 mgc: 6.394229 ustep: 1 
iter: 2  value: 491.9198 mgc: 0.2534513 ustep: 1 
iter: 3  value: 491.9198 mgc: 0.0005150537 ustep: 1 
iter: 4  mgc: 3.630185e-09 
iter: 1  mgc: 3.630185e-09 
outer mgc:  7.039376 
iter: 1  value: 490.5647 mgc: 11.1773 ustep: 1 
iter: 2  value: 490.5078 mgc: 0.6606758 ustep: 1 
iter: 3  value: 490.5078 mgc: 0.0046243 ustep: 1 
iter: 4  value: 490.5078 mgc: 2.735267e-07 ustep: 1 
iter: 5  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  6.318175 
iter: 1  value: 490.7247 mgc: 11.36981 ustep: 1 
iter: 2  value: 490.6195 mgc: 0.7326418 ustep: 1 
iter: 3  value: 490.6195 mgc: 0.005358017 ustep: 1 
iter: 4  value: 490.6195 mgc: 8.549019e-07 ustep: 1 
iter: 5  mgc: 2.04281e-14 
iter: 1  value: 490.5232 mgc: 6.090646 ustep: 1 
iter: 2  value: 490.5194 mgc: 0.1669637 ustep: 1 
iter: 3  value: 490.5194 mgc: 0.0001946331 ustep: 1 
iter: 4  mgc: 4.51835e-10 
iter: 1  value: 490.2195 mgc: 2.888375 ustep: 1 
iter: 2  value: 490.2194 mgc: 0.03374554 ustep: 1 
iter: 3  value: 490.2194 mgc: 8.493892e-06 ustep: 1 
iter: 4  mgc: 7.074341e-13 
iter: 1  mgc: 7.074341e-13 
outer mgc:  4.548781 
iter: 1  value: 489.9817 mgc: 1.926069 ustep: 1 
iter: 2  value: 489.9817 mgc: 0.009392021 ustep: 1 
iter: 3  value: 489.9817 mgc: 5.74988e-07 ustep: 1 
iter: 4  mgc: 1.965095e-14 
iter: 1  mgc: 1.965095e-14 
outer mgc:  5.849101 
iter: 1  value: 489.5247 mgc: 4.071394 ustep: 1 
iter: 2  value: 489.5232 mgc: 0.08340184 ustep: 1 
iter: 3  value: 489.5232 mgc: 8.660238e-05 ustep: 1 
iter: 4  mgc: 1.985407e-10 
iter: 1  mgc: 1.985407e-10 
outer mgc:  4.427245 
iter: 1  value: 489.1316 mgc: 4.134326 ustep: 1 
iter: 2  value: 489.1312 mgc: 0.05925191 ustep: 1 
iter: 3  value: 489.1312 mgc: 4.678771e-05 ustep: 1 
iter: 4  mgc: 2.909051e-11 
iter: 1  mgc: 2.909051e-11 
outer mgc:  4.112283 
iter: 1  value: 489.0232 mgc: 3.528928 ustep: 1 
iter: 2  value: 489.0222 mgc: 0.09758409 ustep: 1 
iter: 3  value: 489.0222 mgc: 8.065284e-05 ustep: 1 
iter: 4  mgc: 6.375549e-11 
iter: 1  mgc: 6.375549e-11 
outer mgc:  2.136624 
iter: 1  value: 488.8107 mgc: 4.000727 ustep: 1 
iter: 2  value: 488.8103 mgc: 0.05331684 ustep: 1 
iter: 3  value: 488.8103 mgc: 2.135285e-05 ustep: 1 
iter: 4  mgc: 5.867307e-12 
iter: 1  mgc: 5.867307e-12 
outer mgc:  2.543825 
iter: 1  value: 488.8654 mgc: 3.09973 ustep: 1 
iter: 2  value: 488.8648 mgc: 0.07240473 ustep: 1 
iter: 3  value: 488.8648 mgc: 6.564463e-05 ustep: 1 
iter: 4  mgc: 5.247758e-11 
iter: 1  value: 488.7593 mgc: 1.916093 ustep: 1 
iter: 2  value: 488.7593 mgc: 0.01184068 ustep: 1 
iter: 3  value: 488.7593 mgc: 6.487206e-07 ustep: 1 
iter: 4  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.5232671 
iter: 1  value: 488.7671 mgc: 0.5179167 ustep: 1 
iter: 2  value: 488.7671 mgc: 0.002195743 ustep: 1 
iter: 3  value: 488.7671 mgc: 8.013125e-08 ustep: 1 
iter: 4  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  1.000911 
iter: 1  value: 488.7178 mgc: 1.332527 ustep: 1 
iter: 2  value: 488.7178 mgc: 0.007184386 ustep: 1 
iter: 3  value: 488.7178 mgc: 5.907461e-07 ustep: 1 
iter: 4  mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  2.167345 
iter: 1  value: 488.6923 mgc: 0.8243776 ustep: 1 
iter: 2  value: 488.6923 mgc: 0.003034394 ustep: 1 
iter: 3  value: 488.6923 mgc: 6.472024e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  1.93778 
iter: 1  value: 488.6934 mgc: 0.2862984 ustep: 1 
iter: 2  value: 488.6934 mgc: 0.0003821812 ustep: 1 
iter: 3  mgc: 3.162544e-09 
iter: 1  mgc: 3.162544e-09 
outer mgc:  0.211113 
iter: 1  value: 488.7126 mgc: 0.4034466 ustep: 1 
iter: 2  value: 488.7126 mgc: 0.0003536774 ustep: 1 
iter: 3  mgc: 1.369471e-09 
iter: 1  value: 488.7007 mgc: 0.1767401 ustep: 1 
iter: 2  value: 488.7007 mgc: 6.793957e-05 ustep: 1 
iter: 3  mgc: 5.039258e-11 
iter: 1  mgc: 5.039258e-11 
outer mgc:  0.1288887 
iter: 1  value: 488.7109 mgc: 0.04884324 ustep: 1 
iter: 2  value: 488.7109 mgc: 3.83508e-05 ustep: 1 
iter: 3  mgc: 4.781064e-11 
iter: 1  mgc: 4.781064e-11 
outer mgc:  0.1185059 
iter: 1  value: 488.7124 mgc: 0.0194807 ustep: 1 
iter: 2  value: 488.7124 mgc: 7.496349e-06 ustep: 1 
iter: 3  mgc: 1.773692e-12 
iter: 1  value: 488.7106 mgc: 0.03068782 ustep: 1 
iter: 2  value: 488.7106 mgc: 4.65869e-06 ustep: 1 
iter: 3  mgc: 6.981082e-13 
iter: 1  mgc: 6.981082e-13 
outer mgc:  0.1715583 
iter: 1  value: 488.71 mgc: 0.04385063 ustep: 1 
iter: 2  value: 488.71 mgc: 1.681282e-05 ustep: 1 
iter: 3  mgc: 1.488601e-12 
iter: 1  mgc: 1.488601e-12 
outer mgc:  0.02070732 
iter: 1  value: 488.7093 mgc: 0.03671253 ustep: 1 
iter: 2  value: 488.7093 mgc: 4.287711e-06 ustep: 1 
iter: 3  mgc: 1.141309e-13 
iter: 1  value: 488.7097 mgc: 0.01650534 ustep: 1 
iter: 2  value: 488.7097 mgc: 7.754132e-07 ustep: 1 
iter: 3  mgc: 1.620926e-14 
iter: 1  mgc: 1.620926e-14 
outer mgc:  0.005419552 
iter: 1  value: 488.7095 mgc: 0.001603291 ustep: 1 
iter: 2  value: 488.7095 mgc: 3.234244e-08 ustep: 1 
mgc: 2.153833e-14 
iter: 1  value: 488.7096 mgc: 0.0007862838 ustep: 1 
iter: 2  mgc: 7.778738e-09 
iter: 1  mgc: 7.778738e-09 
outer mgc:  0.002253099 
iter: 1  value: 488.7096 mgc: 0.002530125 ustep: 1 
iter: 2  value: 488.7096 mgc: 2.642226e-08 ustep: 1 
mgc: 2.542411e-14 
iter: 1  mgc: 2.542411e-14 
outer mgc:  0.0006484821 
iter: 1  value: 488.7096 mgc: 0.0006320621 ustep: 1 
iter: 2  mgc: 3.119919e-09 
iter: 1  mgc: 3.119919e-09 
outer mgc:  0.00021613 
iter: 1  mgc: 3.119919e-09 
iter: 1  mgc: 3.119919e-09 
outer mgc:  0.00021613 
iter: 1  value: 488.7093 mgc: 0.04891748 ustep: 1 
iter: 2  value: 488.7093 mgc: 9.36753e-06 ustep: 1 
iter: 3  mgc: 5.818679e-13 
outer mgc:  0.05797768 
iter: 1  value: 488.71 mgc: 0.04889774 ustep: 1 
iter: 2  value: 488.71 mgc: 9.37922e-06 ustep: 1 
iter: 3  mgc: 6.000755e-13 
outer mgc:  0.05787151 
iter: 1  value: 488.7096 mgc: 0.0248421 ustep: 1 
iter: 2  value: 488.7096 mgc: 2.902247e-06 ustep: 1 
iter: 3  mgc: 5.961898e-14 
outer mgc:  0.1705308 
iter: 1  value: 488.7097 mgc: 0.02483068 ustep: 1 
iter: 2  value: 488.7097 mgc: 2.903265e-06 ustep: 1 
iter: 3  mgc: 6.727952e-14 
outer mgc:  0.1701419 
iter: 1  value: 488.7099 mgc: 0.0583268 ustep: 1 
iter: 2  value: 488.7099 mgc: 8.389056e-06 ustep: 1 
iter: 3  mgc: 4.585221e-13 
outer mgc:  0.06893708 
iter: 1  value: 488.7093 mgc: 0.05832926 ustep: 1 
iter: 2  value: 488.7093 mgc: 8.397998e-06 ustep: 1 
iter: 3  mgc: 4.651834e-13 
outer mgc:  0.06908433 
iter: 1  value: 488.7101 mgc: 0.03149972 ustep: 1 
iter: 2  value: 488.7101 mgc: 2.721856e-06 ustep: 1 
iter: 3  mgc: 5.906386e-14 
outer mgc:  0.2233224 
iter: 1  value: 488.7093 mgc: 0.03149981 ustep: 1 
iter: 2  value: 488.7093 mgc: 2.722732e-06 ustep: 1 
iter: 3  mgc: 6.727952e-14 
outer mgc:  0.2237554 
iter: 1  value: 488.7081 mgc: 0.004263481 ustep: 1 
iter: 2  value: 488.7081 mgc: 4.13582e-07 ustep: 1 
iter: 3  mgc: 2.509104e-14 
outer mgc:  0.006384684 
iter: 1  value: 488.7111 mgc: 0.004261098 ustep: 1 
iter: 2  value: 488.7111 mgc: 4.135367e-07 ustep: 1 
iter: 3  mgc: 2.020606e-14 
outer mgc:  0.006311809 
iter: 1  value: 488.712 mgc: 0.01172304 ustep: 1 
iter: 2  value: 488.712 mgc: 4.21008e-06 ustep: 1 
iter: 3  mgc: 5.604406e-13 
outer mgc:  0.07032371 
iter: 1  value: 488.7072 mgc: 0.01174876 ustep: 1 
iter: 2  value: 488.7072 mgc: 4.22012e-06 ustep: 1 
iter: 3  mgc: 5.631051e-13 
outer mgc:  0.07042046 
iter: 1  value: 488.7113 mgc: 0.01089119 ustep: 1 
iter: 2  value: 488.7113 mgc: 1.544488e-06 ustep: 1 
iter: 3  mgc: 2.753353e-14 
outer mgc:  0.0790377 
iter: 1  value: 488.708 mgc: 0.01091468 ustep: 1 
iter: 2  value: 488.708 mgc: 1.549448e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.07926308 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:08:33 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:53:52 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4362.589398 
iter  10 value 3768.342702
final  value 3768.342065 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1435.588 mgc: 100.0632 ustep: 1 
iter: 2  value: 1396.505 mgc: 25.30712 ustep: 1 
iter: 3  value: 1395.426 mgc: 7.752849 ustep: 1 
iter: 4  value: 1395.423 mgc: 0.2225974 ustep: 1 
iter: 5  value: 1395.423 mgc: 0.0005679961 ustep: 1 
iter: 6  value: 1395.423 mgc: 4.401428e-08 ustep: 1 
iter: 7  mgc: 5.805079e-14 
iter: 1  mgc: 5.805079e-14 
Matching hessian patterns... Done
outer mgc:  456.6703 
iter: 1  value: 1044.533 mgc: 27.95481 ustep: 1 
iter: 2  value: 1042.909 mgc: 2.742306 ustep: 1 
iter: 3  value: 1042.907 mgc: 0.07452141 ustep: 1 
iter: 4  value: 1042.907 mgc: 0.0004501201 ustep: 1 
iter: 5  value: 1042.907 mgc: 1.571143e-08 ustep: 1 
mgc: 3.015123e-14 
iter: 1  value: 883.8945 mgc: 32.98512 ustep: 1 
iter: 2  value: 878.8946 mgc: 4.141112 ustep: 1 
iter: 3  value: 878.8784 mgc: 0.198933 ustep: 1 
iter: 4  value: 878.8784 mgc: 0.002458459 ustep: 1 
iter: 5  value: 878.8784 mgc: 4.889215e-07 ustep: 1 
iter: 6  mgc: 2.733924e-14 
iter: 1  mgc: 2.733924e-14 
outer mgc:  270.9592 
iter: 1  value: 621.2437 mgc: 55.59714 ustep: 1 
iter: 2  value: 579.1788 mgc: 48.68929 ustep: 1 
iter: 3  value: 579.0904 mgc: 2.053332 ustep: 1 
iter: 4  value: 579.0904 mgc: 0.02010838 ustep: 1 
iter: 5  value: 579.0904 mgc: 1.100262e-05 ustep: 1 
iter: 6  mgc: 2.13507e-11 
iter: 1  mgc: 2.13507e-11 
outer mgc:  231.9948 
iter: 1  value: 602.877 mgc: 55.71081 ustep: 1 
iter: 2  value: 600.3063 mgc: 6.054511 ustep: 1 
iter: 3  value: 600.3058 mgc: 0.1092877 ustep: 1 
iter: 4  value: 600.3058 mgc: 2.971378e-05 ustep: 1 
iter: 5  mgc: 1.782885e-11 
iter: 1  value: 473.2802 mgc: 33.93799 ustep: 1 
iter: 2  value: 472.9881 mgc: 2.519406 ustep: 1 
iter: 3  value: 472.988 mgc: 0.05598428 ustep: 1 
iter: 4  value: 472.988 mgc: 3.080124e-05 ustep: 1 
iter: 5  mgc: 9.334755e-12 
iter: 1  mgc: 9.334755e-12 
outer mgc:  118.0514 
iter: 1  value: 444.093 mgc: 35.8201 ustep: 1 
iter: 2  value: 440.2706 mgc: 11.95248 ustep: 1 
iter: 3  value: 440.2671 mgc: 0.4472277 ustep: 1 
iter: 4  value: 440.2671 mgc: 0.0008731391 ustep: 1 
iter: 5  mgc: 3.175136e-09 
iter: 1  mgc: 3.175136e-09 
outer mgc:  126.2983 
iter: 1  value: 424.6513 mgc: 51.40305 ustep: 1 
iter: 2  value: 420.0431 mgc: 13.93998 ustep: 1 
iter: 3  value: 420.0133 mgc: 0.6959448 ustep: 1 
iter: 4  value: 420.0133 mgc: 0.01409491 ustep: 1 
iter: 5  value: 420.0133 mgc: 6.123452e-06 ustep: 1 
iter: 6  mgc: 1.160849e-12 
iter: 1  mgc: 1.160849e-12 
outer mgc:  97.71699 
iter: 1  value: 407.9277 mgc: 38.878 ustep: 1 
iter: 2  value: 403.5623 mgc: 5.322834 ustep: 1 
iter: 3  value: 403.529 mgc: 0.4861368 ustep: 1 
iter: 4  value: 403.5289 mgc: 0.01887594 ustep: 1 
iter: 5  value: 403.5289 mgc: 3.119844e-05 ustep: 1 
iter: 6  mgc: 8.544293e-11 
iter: 1  mgc: 8.544293e-11 
outer mgc:  55.48472 
iter: 1  value: 776.8884 mgc: 49.64426 ustep: 1 
iter: 2  value: 618.7461 mgc: 68.43053 ustep: 1 
iter: 3  value: 617.1078 mgc: 7.289213 ustep: 1 
iter: 4  value: 617.1039 mgc: 0.4400678 ustep: 1 
iter: 5  value: 617.1039 mgc: 0.002107223 ustep: 1 
iter: 6  value: 617.1039 mgc: 4.994106e-08 ustep: 1 
mgc: 2.614575e-14 
iter: 1  value: 393.3365 mgc: 15.15598 ustep: 1 
iter: 2  value: 393.2211 mgc: 1.42795 ustep: 1 
iter: 3  value: 393.2211 mgc: 0.007579904 ustep: 1 
iter: 4  value: 393.2211 mgc: 3.446159e-07 ustep: 1 
iter: 5  mgc: 2.947642e-14 
iter: 1  mgc: 2.947642e-14 
outer mgc:  38.24338 
iter: 1  value: 386.6865 mgc: 15.79646 ustep: 1 
iter: 2  value: 386.5923 mgc: 1.373965 ustep: 1 
iter: 3  value: 386.5923 mgc: 0.0125447 ustep: 1 
iter: 4  value: 386.5923 mgc: 1.091098e-06 ustep: 1 
iter: 5  mgc: 2.814415e-14 
iter: 1  mgc: 2.814415e-14 
outer mgc:  18.57049 
iter: 1  value: 383.36 mgc: 7.988992 ustep: 1 
iter: 2  value: 383.3399 mgc: 0.2830565 ustep: 1 
iter: 3  value: 383.3399 mgc: 0.001633646 ustep: 1 
iter: 4  value: 383.3399 mgc: 5.36528e-08 ustep: 1 
mgc: 2.875478e-14 
iter: 1  mgc: 2.875478e-14 
outer mgc:  29.31571 
iter: 1  value: 376.8382 mgc: 26.75248 ustep: 1 
iter: 2  value: 376.2349 mgc: 3.748742 ustep: 1 
iter: 3  value: 376.2349 mgc: 0.04456607 ustep: 1 
iter: 4  value: 376.2349 mgc: 7.004509e-06 ustep: 1 
iter: 5  mgc: 2.002842e-13 
iter: 1  mgc: 2.002842e-13 
outer mgc:  17.64256 
iter: 1  value: 382.7105 mgc: 25.64618 ustep: 1 
iter: 2  value: 382.4525 mgc: 1.479092 ustep: 1 
iter: 3  value: 382.4525 mgc: 0.01331675 ustep: 1 
iter: 4  value: 382.4525 mgc: 1.117394e-06 ustep: 1 
iter: 5  mgc: 3.147482e-14 
iter: 1  value: 375.4777 mgc: 4.485471 ustep: 1 
iter: 2  value: 375.4764 mgc: 0.08564954 ustep: 1 
iter: 3  value: 375.4764 mgc: 4.692003e-05 ustep: 1 
iter: 4  mgc: 2.023909e-11 
iter: 1  mgc: 2.023909e-11 
outer mgc:  28.67158 
iter: 1  value: 372.9722 mgc: 16.59297 ustep: 1 
iter: 2  value: 372.9036 mgc: 1.11706 ustep: 1 
iter: 3  value: 372.9036 mgc: 0.004124114 ustep: 1 
iter: 4  value: 372.9036 mgc: 5.805204e-08 ustep: 1 
mgc: 5.284662e-14 
iter: 1  mgc: 5.284662e-14 
outer mgc:  13.92936 
iter: 1  value: 370.766 mgc: 10.38346 ustep: 1 
iter: 2  value: 370.7577 mgc: 0.3804654 ustep: 1 
iter: 3  value: 370.7577 mgc: 0.001183891 ustep: 1 
iter: 4  value: 370.7577 mgc: 1.164069e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  7.242909 
iter: 1  value: 369.0933 mgc: 6.294827 ustep: 1 
iter: 2  value: 369.0904 mgc: 0.1756642 ustep: 1 
iter: 3  value: 369.0904 mgc: 0.000185207 ustep: 1 
iter: 4  mgc: 2.998721e-10 
iter: 1  mgc: 2.998721e-10 
outer mgc:  5.663365 
iter: 1  value: 368.6482 mgc: 6.230542 ustep: 1 
iter: 2  value: 368.6472 mgc: 0.08136933 ustep: 1 
iter: 3  value: 368.6472 mgc: 3.236111e-05 ustep: 1 
iter: 4  mgc: 1.200218e-11 
iter: 1  mgc: 1.200218e-11 
outer mgc:  15.54889 
iter: 1  value: 368.5713 mgc: 5.041706 ustep: 1 
iter: 2  value: 368.5685 mgc: 0.1295393 ustep: 1 
iter: 3  value: 368.5685 mgc: 0.0001137756 ustep: 1 
iter: 4  mgc: 8.874421e-10 
iter: 1  mgc: 8.874421e-10 
outer mgc:  12.69374 
iter: 1  value: 368.0796 mgc: 6.818118 ustep: 1 
iter: 2  value: 368.0783 mgc: 0.1478939 ustep: 1 
iter: 3  value: 368.0783 mgc: 0.0001290348 ustep: 1 
iter: 4  mgc: 9.740428e-11 
iter: 1  mgc: 9.740428e-11 
outer mgc:  4.421074 
iter: 1  value: 367.8061 mgc: 3.124812 ustep: 1 
iter: 2  value: 367.8057 mgc: 0.03122345 ustep: 1 
iter: 3  value: 367.8057 mgc: 2.424186e-05 ustep: 1 
iter: 4  mgc: 4.596412e-11 
iter: 1  mgc: 4.596412e-11 
outer mgc:  3.666102 
iter: 1  value: 367.6646 mgc: 2.313451 ustep: 1 
iter: 2  value: 367.6644 mgc: 0.03050207 ustep: 1 
iter: 3  value: 367.6644 mgc: 8.180771e-06 ustep: 1 
iter: 4  mgc: 2.922773e-12 
iter: 1  mgc: 2.922773e-12 
outer mgc:  3.796522 
iter: 1  value: 367.6361 mgc: 0.7762458 ustep: 1 
iter: 2  value: 367.6361 mgc: 0.001530115 ustep: 1 
iter: 3  mgc: 8.784236e-09 
iter: 1  mgc: 8.784236e-09 
outer mgc:  1.018089 
iter: 1  value: 367.6148 mgc: 0.6786348 ustep: 1 
iter: 2  value: 367.6148 mgc: 0.006207757 ustep: 1 
iter: 3  value: 367.6148 mgc: 4.839858e-07 ustep: 1 
iter: 4  mgc: 3.154421e-14 
iter: 1  mgc: 3.154421e-14 
outer mgc:  0.6596631 
iter: 1  value: 367.6305 mgc: 0.2805232 ustep: 1 
iter: 2  value: 367.6305 mgc: 0.000365497 ustep: 1 
iter: 3  mgc: 9.905376e-09 
iter: 1  value: 367.6174 mgc: 0.1862493 ustep: 1 
iter: 2  value: 367.6174 mgc: 0.0001557606 ustep: 1 
iter: 3  mgc: 1.419274e-09 
iter: 1  mgc: 1.419274e-09 
outer mgc:  0.6810125 
iter: 1  value: 367.6305 mgc: 0.1260487 ustep: 1 
iter: 2  value: 367.6305 mgc: 0.0001066192 ustep: 1 
iter: 3  mgc: 7.670842e-11 
iter: 1  mgc: 7.670842e-11 
outer mgc:  0.1698248 
iter: 1  value: 367.6248 mgc: 0.1345985 ustep: 1 
iter: 2  value: 367.6248 mgc: 8.147261e-05 ustep: 1 
iter: 3  mgc: 1.077289e-10 
iter: 1  mgc: 1.077289e-10 
outer mgc:  0.1582661 
iter: 1  value: 367.6274 mgc: 0.06873882 ustep: 1 
iter: 2  value: 367.6274 mgc: 2.098939e-05 ustep: 1 
iter: 3  mgc: 7.873702e-12 
iter: 1  mgc: 7.873702e-12 
outer mgc:  0.003479267 
iter: 1  value: 367.6275 mgc: 0.003278845 ustep: 1 
iter: 2  value: 367.6275 mgc: 3.861594e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.001622798 
iter: 1  value: 367.6275 mgc: 0.001160808 ustep: 1 
iter: 2  mgc: 3.380434e-09 
iter: 1  mgc: 3.380434e-09 
outer mgc:  0.0001408944 
iter: 1  value: 367.6275 mgc: 0.0001400702 ustep: 1 
iter: 2  mgc: 8.502132e-11 
iter: 1  mgc: 8.502132e-11 
outer mgc:  8.258928e-05 
iter: 1  mgc: 8.502132e-11 
iter: 1  mgc: 8.502132e-11 
outer mgc:  8.258928e-05 
iter: 1  value: 367.6276 mgc: 0.04060045 ustep: 1 
iter: 2  value: 367.6276 mgc: 4.588325e-06 ustep: 1 
iter: 3  mgc: 1.376677e-13 
outer mgc:  0.06395863 
iter: 1  value: 367.6274 mgc: 0.04059994 ustep: 1 
iter: 2  value: 367.6274 mgc: 4.593447e-06 ustep: 1 
iter: 3  mgc: 1.438849e-13 
outer mgc:  0.06391009 
iter: 1  value: 367.6293 mgc: 0.02893179 ustep: 1 
iter: 2  value: 367.6293 mgc: 3.54923e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
outer mgc:  0.1802695 
iter: 1  value: 367.6258 mgc: 0.02893319 ustep: 1 
iter: 2  value: 367.6258 mgc: 3.553791e-06 ustep: 1 
iter: 3  mgc: 9.015011e-14 
outer mgc:  0.1802324 
iter: 1  value: 367.6277 mgc: 0.05155058 ustep: 1 
iter: 2  value: 367.6277 mgc: 7.565653e-06 ustep: 1 
iter: 3  mgc: 3.418377e-13 
outer mgc:  0.07115905 
iter: 1  value: 367.6274 mgc: 0.05155394 ustep: 1 
iter: 2  value: 367.6274 mgc: 7.574015e-06 ustep: 1 
iter: 3  mgc: 3.227418e-13 
outer mgc:  0.07124879 
iter: 1  value: 367.6266 mgc: 0.0286527 ustep: 1 
iter: 2  value: 367.6266 mgc: 2.379462e-06 ustep: 1 
iter: 3  mgc: 5.839773e-14 
outer mgc:  0.1997448 
iter: 1  value: 367.6285 mgc: 0.02865436 ustep: 1 
iter: 2  value: 367.6285 mgc: 2.380272e-06 ustep: 1 
iter: 3  mgc: 4.005823e-14 
outer mgc:  0.1998815 
iter: 1  value: 367.6266 mgc: 0.002902024 ustep: 1 
iter: 2  value: 367.6266 mgc: 2.879156e-08 ustep: 1 
mgc: 3.029174e-14 
outer mgc:  0.006788218 
iter: 1  value: 367.6284 mgc: 0.002900497 ustep: 1 
iter: 2  value: 367.6284 mgc: 2.877298e-08 ustep: 1 
mgc: 3.730349e-14 
outer mgc:  0.006787262 
iter: 1  value: 367.6292 mgc: 0.01141658 ustep: 1 
iter: 2  value: 367.6292 mgc: 8.322411e-07 ustep: 1 
iter: 3  mgc: 2.377265e-14 
outer mgc:  0.09915046 
iter: 1  value: 367.6259 mgc: 0.01144614 ustep: 1 
iter: 2  value: 367.6259 mgc: 8.359875e-07 ustep: 1 
iter: 3  mgc: 4.307665e-14 
outer mgc:  0.09944923 
iter: 1  value: 367.6295 mgc: 0.0137909 ustep: 1 
iter: 2  value: 367.6295 mgc: 2.016888e-06 ustep: 1 
iter: 3  mgc: 3.215206e-13 
outer mgc:  0.09707274 
iter: 1  value: 367.6255 mgc: 0.01382377 ustep: 1 
iter: 2  value: 367.6255 mgc: 2.031395e-06 ustep: 1 
iter: 3  mgc: 3.357314e-13 
outer mgc:  0.09722912 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:53:54 2021]
Finished job 0.
1 of 1 steps (100%) done

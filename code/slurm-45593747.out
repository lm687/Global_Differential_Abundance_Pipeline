Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:51:06 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.1_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_10_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.1_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.1_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.1_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_10_3_0.1_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4487.831199 
final  value 4348.056933 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4114.178 mgc: 2.104975 ustep: 1 
iter: 2  value: 4113.08 mgc: 0.8975946 ustep: 1 
iter: 3  value: 4113.075 mgc: 0.1027773 ustep: 1 
iter: 4  value: 4113.075 mgc: 0.001002475 ustep: 1 
iter: 5  value: 4113.075 mgc: 9.800859e-08 ustep: 1 
iter: 6  mgc: 1.046906e-15 
iter: 1  mgc: 1.046906e-15 
Matching hessian patterns... Done
outer mgc:  29.05638 
iter: 1  value: 4071.563 mgc: 0.7879108 ustep: 1 
iter: 2  value: 4071.562 mgc: 0.0371491 ustep: 1 
iter: 3  value: 4071.562 mgc: 0.0003374812 ustep: 1 
iter: 4  value: 4071.562 mgc: 1.159217e-08 ustep: 1 
iter: 5  mgc: 3.885781e-15 
iter: 1  value: 4036.551 mgc: 1.48857 ustep: 1 
iter: 2  value: 4036.549 mgc: 0.09516532 ustep: 1 
iter: 3  value: 4036.549 mgc: 0.0004977734 ustep: 1 
iter: 4  value: 4036.549 mgc: 2.881099e-08 ustep: 1 
iter: 5  mgc: 8.382184e-15 
iter: 1  mgc: 8.382184e-15 
outer mgc:  19.88845 
iter: 1  value: 4098.48 mgc: 71.31559 ustep: 0.2494656 
iter: 2  value: 4063.463 mgc: 7.56802 ustep: 0.4995153 
iter: 3  value: 4051.781 mgc: 8.068748 ustep: 0.7067933 
iter: 4  value: 4051.619 mgc: 1.197763 ustep: 0.8407259 
iter: 5  value: 4051.619 mgc: 0.05295254 ustep: 0.9169194 
iter: 6  value: 4051.619 mgc: 0.0007472656 ustep: 0.9575633 
iter: 7  value: 4051.619 mgc: 6.387304e-06 ustep: 0.9785538 
iter: 8  value: 4051.619 mgc: 2.730684e-08 ustep: 0.9892199 
mgc: 5.827006e-11 
iter: 1  value: 4041.921 mgc: 4.922469 ustep: 1 
iter: 2  value: 4040.589 mgc: 0.9817694 ustep: 1 
iter: 3  value: 4040.587 mgc: 0.03960094 ustep: 1 
iter: 4  value: 4040.587 mgc: 0.000165048 ustep: 1 
iter: 5  mgc: 1.948485e-09 
iter: 1  mgc: 1.948485e-09 
outer mgc:  29.12394 
iter: 1  value: 4043.948 mgc: 5.688546 ustep: 1 
iter: 2  value: 4043.918 mgc: 0.2387342 ustep: 1 
iter: 3  value: 4043.918 mgc: 0.001973933 ustep: 1 
iter: 4  value: 4043.918 mgc: 1.530394e-07 ustep: 1 
iter: 5  mgc: 2.88658e-15 
iter: 1  mgc: 2.88658e-15 
outer mgc:  21.53107 
iter: 1  value: 4033.974 mgc: 3.860684 ustep: 1 
iter: 2  value: 4033.945 mgc: 0.2190151 ustep: 1 
iter: 3  value: 4033.945 mgc: 0.0009444324 ustep: 1 
iter: 4  value: 4033.945 mgc: 1.223932e-08 ustep: 1 
mgc: 4.350686e-15 
iter: 1  mgc: 4.350686e-15 
outer mgc:  7.800352 
iter: 1  value: 4023.167 mgc: 3.374248 ustep: 1 
iter: 2  value: 4023.166 mgc: 0.04738421 ustep: 1 
iter: 3  value: 4023.166 mgc: 4.93965e-05 ustep: 1 
iter: 4  mgc: 1.213831e-10 
iter: 1  mgc: 1.213831e-10 
outer mgc:  8.586523 
iter: 1  value: 4018.495 mgc: 4.485271 ustep: 1 
iter: 2  value: 4018.495 mgc: 0.07115381 ustep: 1 
iter: 3  value: 4018.495 mgc: 9.167557e-05 ustep: 1 
iter: 4  mgc: 5.409686e-10 
iter: 1  value: 4022.163 mgc: 1.814075 ustep: 1 
iter: 2  value: 4022.162 mgc: 0.01546519 ustep: 1 
iter: 3  value: 4022.162 mgc: 6.004942e-06 ustep: 1 
iter: 4  mgc: 7.085443e-13 
iter: 1  mgc: 7.085443e-13 
outer mgc:  10.3892 
iter: 1  value: 4020.768 mgc: 0.9828096 ustep: 1 
iter: 2  value: 4020.768 mgc: 0.004177774 ustep: 1 
iter: 3  value: 4020.768 mgc: 4.156206e-07 ustep: 1 
iter: 4  mgc: 7.660539e-15 
iter: 1  mgc: 7.660539e-15 
outer mgc:  2.743279 
iter: 1  value: 4017.284 mgc: 1.498957 ustep: 1 
iter: 2  value: 4017.284 mgc: 0.00699591 ustep: 1 
iter: 3  value: 4017.284 mgc: 2.949324e-06 ustep: 1 
iter: 4  mgc: 5.722089e-13 
iter: 1  mgc: 5.722089e-13 
outer mgc:  3.564735 
iter: 1  value: 4015.124 mgc: 4.279785 ustep: 1 
iter: 2  value: 4015.123 mgc: 0.06710279 ustep: 1 
iter: 3  value: 4015.123 mgc: 4.001352e-05 ustep: 1 
iter: 4  mgc: 7.860623e-11 
iter: 1  value: 4016.027 mgc: 1.765141 ustep: 1 
iter: 2  value: 4016.027 mgc: 0.01592701 ustep: 1 
iter: 3  value: 4016.027 mgc: 2.814664e-06 ustep: 1 
iter: 4  mgc: 5.502265e-13 
iter: 1  mgc: 5.502265e-13 
outer mgc:  2.147443 
iter: 1  value: 4015.517 mgc: 1.738966 ustep: 1 
iter: 2  value: 4015.517 mgc: 0.01010631 ustep: 1 
iter: 3  value: 4015.517 mgc: 9.348952e-07 ustep: 1 
iter: 4  mgc: 1.613987e-14 
iter: 1  mgc: 1.613987e-14 
outer mgc:  1.645667 
iter: 1  value: 4014.79 mgc: 2.774464 ustep: 1 
iter: 2  value: 4014.79 mgc: 0.0108974 ustep: 1 
iter: 3  value: 4014.79 mgc: 2.059471e-06 ustep: 1 
iter: 4  mgc: 1.678657e-13 
iter: 1  value: 4015.115 mgc: 0.4667229 ustep: 1 
iter: 2  value: 4015.115 mgc: 0.000487502 ustep: 1 
iter: 3  mgc: 2.805396e-09 
iter: 1  mgc: 2.805396e-09 
outer mgc:  1.424064 
iter: 1  value: 4014.772 mgc: 0.3288363 ustep: 1 
iter: 2  value: 4014.772 mgc: 0.0002218001 ustep: 1 
iter: 3  mgc: 1.39864e-09 
iter: 1  mgc: 1.39864e-09 
outer mgc:  1.125097 
iter: 1  value: 4014.31 mgc: 0.2604803 ustep: 1 
iter: 2  value: 4014.31 mgc: 0.0001619736 ustep: 1 
iter: 3  mgc: 7.425793e-10 
iter: 1  mgc: 7.425793e-10 
outer mgc:  0.8254883 
iter: 1  value: 4013.408 mgc: 0.4069911 ustep: 1 
iter: 2  value: 4013.408 mgc: 0.0007450034 ustep: 1 
iter: 3  mgc: 1.967754e-09 
iter: 1  value: 4012.602 mgc: 0.4946903 ustep: 1 
iter: 2  value: 4012.602 mgc: 0.0008568548 ustep: 1 
iter: 3  mgc: 3.225137e-09 
iter: 1  mgc: 3.225137e-09 
outer mgc:  1.550044 
iter: 1  value: 4011.042 mgc: 1.379218 ustep: 1 
iter: 2  value: 4011.042 mgc: 0.002748265 ustep: 1 
iter: 3  value: 4011.042 mgc: 5.854937e-08 ustep: 1 
iter: 4  mgc: 1.44329e-14 
iter: 1  mgc: 1.44329e-14 
outer mgc:  2.857141 
iter: 1  value: 4009.677 mgc: 1.120584 ustep: 1 
iter: 2  value: 4009.677 mgc: 0.002420043 ustep: 1 
iter: 3  value: 4009.677 mgc: 4.128955e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.6405097 
iter: 1  value: 4008.852 mgc: 0.6737311 ustep: 1 
iter: 2  value: 4008.852 mgc: 0.005476595 ustep: 1 
iter: 3  value: 4008.852 mgc: 2.126255e-06 ustep: 1 
iter: 4  mgc: 3.033129e-13 
iter: 1  mgc: 3.033129e-13 
outer mgc:  2.074595 
iter: 1  value: 4007.767 mgc: 0.3794262 ustep: 1 
iter: 2  value: 4007.767 mgc: 0.003056292 ustep: 1 
iter: 3  value: 4007.767 mgc: 2.865316e-07 ustep: 1 
iter: 4  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  1.242728 
iter: 1  value: 4005.828 mgc: 1.116771 ustep: 1 
iter: 2  value: 4005.828 mgc: 0.001402842 ustep: 1 
iter: 3  value: 4005.828 mgc: 9.577268e-08 ustep: 1 
iter: 4  mgc: 1.298961e-14 
iter: 1  mgc: 1.298961e-14 
outer mgc:  0.6935418 
iter: 1  value: 4004.642 mgc: 0.7993523 ustep: 1 
iter: 2  value: 4004.642 mgc: 0.0008068471 ustep: 1 
iter: 3  mgc: 6.47857e-09 
iter: 1  value: 4003.437 mgc: 0.8015683 ustep: 1 
iter: 2  value: 4003.437 mgc: 0.0007669391 ustep: 1 
iter: 3  mgc: 9.702974e-09 
iter: 1  mgc: 9.702974e-09 
outer mgc:  1.238017 
iter: 1  value: 4000.629 mgc: 1.932071 ustep: 1 
iter: 2  value: 4000.629 mgc: 0.0004930733 ustep: 1 
iter: 3  mgc: 4.589859e-09 
iter: 1  mgc: 4.589859e-09 
outer mgc:  0.4362103 
iter: 1  value: 3998.683 mgc: 1.400107 ustep: 1 
iter: 2  value: 3998.683 mgc: 0.0003932485 ustep: 1 
iter: 3  mgc: 2.174802e-09 
iter: 1  mgc: 2.174802e-09 
outer mgc:  0.2953633 
iter: 1  value: 3994.129 mgc: 2.755274 ustep: 1 
iter: 2  value: 3994.129 mgc: 0.0007421691 ustep: 1 
iter: 3  mgc: 7.248652e-09 
iter: 1  mgc: 7.248652e-09 
outer mgc:  0.2348404 
iter: 1  value: 3990.736 mgc: 2.978651 ustep: 1 
iter: 2  value: 3990.736 mgc: 0.0003635407 ustep: 1 
iter: 3  mgc: 7.30962e-10 
iter: 1  mgc: 7.30962e-10 
outer mgc:  0.1402522 
iter: 1  value: 3987.625 mgc: 1.822502 ustep: 1 
iter: 2  value: 3987.625 mgc: 7.564666e-05 ustep: 1 
iter: 3  mgc: 2.101852e-11 
iter: 1  mgc: 2.101852e-11 
outer mgc:  0.08840314 
iter: 1  value: 3983.272 mgc: 3.586573 ustep: 1 
iter: 2  value: 3983.272 mgc: 0.0001092692 ustep: 1 
iter: 3  mgc: 7.014034e-11 
iter: 1  mgc: 7.014034e-11 
outer mgc:  0.04611869 
iter: 1  value: 3979.747 mgc: 1.752627 ustep: 1 
iter: 2  value: 3979.747 mgc: 1.986163e-05 ustep: 1 
iter: 3  mgc: 1.213696e-12 
iter: 1  mgc: 1.213696e-12 
outer mgc:  0.04715189 
iter: 1  value: 3975.552 mgc: 3.474579 ustep: 1 
iter: 2  value: 3975.552 mgc: 1.869153e-05 ustep: 1 
iter: 3  mgc: 2.310152e-12 
iter: 1  mgc: 2.310152e-12 
outer mgc:  0.02604981 
iter: 1  value: 3972.145 mgc: 1.695573 ustep: 1 
iter: 2  value: 3972.145 mgc: 4.766019e-06 ustep: 1 
iter: 3  mgc: 5.617729e-13 
iter: 1  mgc: 5.617729e-13 
outer mgc:  0.0199576 
iter: 1  value: 3967.916 mgc: 3.338925 ustep: 1 
iter: 2  value: 3967.916 mgc: 4.240079e-06 ustep: 1 
iter: 3  mgc: 5.053735e-13 
iter: 1  mgc: 5.053735e-13 
outer mgc:  0.01053736 
iter: 1  value: 3964.453 mgc: 1.885248 ustep: 1 
iter: 2  value: 3964.453 mgc: 1.114714e-06 ustep: 1 
iter: 3  mgc: 4.143352e-13 
iter: 1  mgc: 4.143352e-13 
outer mgc:  0.00783636 
iter: 1  value: 3960.257 mgc: 3.16936 ustep: 1 
iter: 2  value: 3960.257 mgc: 8.667813e-07 ustep: 1 
iter: 3  mgc: 1.046011e-12 
iter: 1  mgc: 1.046011e-12 
outer mgc:  0.004254527 
iter: 1  value: 3956.8 mgc: 2.025187 ustep: 1 
iter: 2  value: 3956.8 mgc: 2.553465e-07 ustep: 1 
iter: 3  mgc: 9.754419e-13 
iter: 1  mgc: 9.754419e-13 
outer mgc:  0.002754786 
iter: 1  value: 3952.604 mgc: 3.060374 ustep: 1 
iter: 2  value: 3952.604 mgc: 1.886125e-07 ustep: 1 
iter: 3  mgc: 4.445888e-12 
iter: 1  mgc: 4.445888e-12 
outer mgc:  0.001500953 
iter: 1  value: 3949.14 mgc: 2.12308 ustep: 1 
iter: 2  value: 3949.14 mgc: 5.743236e-08 ustep: 1 
mgc: 2.540634e-12 
iter: 1  mgc: 2.540634e-12 
outer mgc:  0.00107221 
iter: 1  value: 3944.946 mgc: 2.991304 ustep: 1 
iter: 2  value: 3944.946 mgc: 4.081382e-08 ustep: 1 
mgc: 3.851142e-12 
iter: 1  mgc: 3.851142e-12 
outer mgc:  0.0005078544 
iter: 1  value: 3941.482 mgc: 2.184661 ustep: 1 
iter: 2  value: 3941.482 mgc: 1.257297e-08 ustep: 1 
mgc: 7.273959e-12 
iter: 1  mgc: 7.273959e-12 
outer mgc:  0.0004415125 
iter: 1  value: 3937.287 mgc: 2.950748 ustep: 1 
iter: 2  mgc: 8.785753e-09 
iter: 1  mgc: 8.785753e-09 
outer mgc:  0.0001716373 
iter: 1  value: 3933.822 mgc: 2.224474 ustep: 1 
iter: 2  mgc: 2.741147e-09 
iter: 1  mgc: 2.741147e-09 
outer mgc:  0.000185546 
iter: 1  value: 3929.627 mgc: 2.923958 ustep: 1 
iter: 2  mgc: 1.89437e-09 
iter: 1  mgc: 1.89437e-09 
outer mgc:  7.22756e-05 
iter: 1  value: 3926.162 mgc: 2.249662 ustep: 1 
iter: 2  mgc: 6.000587e-10 
iter: 1  mgc: 6.000587e-10 
outer mgc:  8.09577e-05 
iter: 1  value: 3921.967 mgc: 2.906774 ustep: 1 
iter: 2  mgc: 4.12391e-10 
iter: 1  mgc: 4.12391e-10 
outer mgc:  3.987243e-05 
iter: 1  value: 3918.501 mgc: 2.26617 ustep: 1 
iter: 2  mgc: 1.3757e-10 
iter: 1  mgc: 1.3757e-10 
outer mgc:  3.604006e-05 
iter: 1  value: 3914.307 mgc: 2.89569 ustep: 1 
iter: 2  mgc: 1.092756e-10 
iter: 1  mgc: 1.092756e-10 
outer mgc:  2.03631e-05 
iter: 1  value: 3910.841 mgc: 2.276852 ustep: 1 
iter: 2  mgc: 1.143226e-10 
iter: 1  mgc: 1.143226e-10 
outer mgc:  1.623606e-05 
iter: 1  mgc: 1.143226e-10 
iter: 1  mgc: 1.143226e-10 
outer mgc:  1.623606e-05 
iter: 1  value: 3910.841 mgc: 0.006944331 ustep: 1 
iter: 2  value: 3910.841 mgc: 5.045311e-07 ustep: 1 
iter: 3  mgc: 1.232836e-10 
outer mgc:  0.09913279 
iter: 1  value: 3910.841 mgc: 0.006944877 ustep: 1 
iter: 2  value: 3910.841 mgc: 5.028308e-07 ustep: 1 
iter: 3  mgc: 1.400762e-10 
outer mgc:  0.09914482 
iter: 1  value: 3910.841 mgc: 0.003515879 ustep: 1 
iter: 2  value: 3910.841 mgc: 1.342315e-07 ustep: 1 
iter: 3  mgc: 1.626098e-10 
outer mgc:  0.05634435 
iter: 1  value: 3910.841 mgc: 0.003515567 ustep: 1 
iter: 2  value: 3910.841 mgc: 1.339786e-07 ustep: 1 
iter: 3  mgc: 2.11543e-10 
outer mgc:  0.05633842 
iter: 1  value: 3910.842 mgc: 0.006177265 ustep: 1 
iter: 2  value: 3910.842 mgc: 1.011433e-07 ustep: 1 
iter: 3  mgc: 1.355599e-10 
outer mgc:  0.1024486 
iter: 1  value: 3910.84 mgc: 0.006173975 ustep: 1 
iter: 2  value: 3910.84 mgc: 1.008059e-07 ustep: 1 
iter: 3  mgc: 1.166411e-10 
outer mgc:  0.1023894 
iter: 1  value: 3910.842 mgc: 0.003433495 ustep: 1 
iter: 2  value: 3910.842 mgc: 4.983387e-08 ustep: 1 
iter: 3  mgc: 1.93449e-10 
outer mgc:  0.0534061 
iter: 1  value: 3910.84 mgc: 0.003431927 ustep: 1 
iter: 2  value: 3910.84 mgc: 4.978122e-08 ustep: 1 
iter: 3  mgc: 1.348095e-10 
outer mgc:  0.0533731 
iter: 1  value: 3910.852 mgc: 732.2262 ustep: 1 
iter: 2  value: 3910.852 mgc: 1.088271e-06 ustep: 1 
iter: 3  mgc: 1.77697e-10 
outer mgc:  0.03918206 
iter: 1  value: 3910.83 mgc: 732.9588 ustep: 1 
iter: 2  value: 3910.83 mgc: 1.082237e-06 ustep: 1 
iter: 3  mgc: 1.736373e-10 
outer mgc:  0.03908823 
iter: 1  value: 3910.857 mgc: 731.4936 ustep: 1 
iter: 2  value: 3910.857 mgc: 1.905405e-06 ustep: 1 
iter: 3  mgc: 1.439724e-10 
outer mgc:  0.03337443 
iter: 1  value: 3910.825 mgc: 733.6913 ustep: 1 
iter: 2  value: 3910.825 mgc: 1.903436e-06 ustep: 1 
iter: 3  mgc: 1.858611e-10 
outer mgc:  0.03329374 
iter: 1  value: 3910.841 mgc: 2.163969e-05 ustep: 1 
mgc: 1.675604e-10 
outer mgc:  1.623639e-05 
iter: 1  value: 3910.841 mgc: 2.163867e-05 ustep: 1 
mgc: 8.330692e-11 
outer mgc:  1.623631e-05 
iter: 1  value: 3910.836 mgc: 0.004541008 ustep: 1 
iter: 2  value: 3910.836 mgc: 1.471581e-07 ustep: 1 
iter: 3  mgc: 1.415759e-10 
outer mgc:  0.02595531 
iter: 1  value: 3910.846 mgc: 0.004537859 ustep: 1 
iter: 2  value: 3910.846 mgc: 1.471499e-07 ustep: 1 
iter: 3  mgc: 1.696909e-10 
outer mgc:  0.0259653 
[Mon Aug 16 08:51:08 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:27:35 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_50_100_80_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_50_100_80_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_50_100_80_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11009.193745 
final  value 10177.137395 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 10529.6 mgc: 4.283749 ustep: 0.6827823 
iter: 2  value: 10526.26 mgc: 1.104523 ustep: 0.8263238 
iter: 3  value: 10526.2 mgc: 0.1558494 ustep: 0.9090326 
iter: 4  value: 10526.2 mgc: 0.006676375 ustep: 0.9534367 
iter: 5  value: 10526.2 mgc: 0.0002757415 ustep: 0.9764432 
iter: 6  value: 10526.2 mgc: 5.61614e-06 ustep: 0.9881526 
iter: 7  value: 10526.2 mgc: 5.686929e-08 ustep: 0.9940592 
iter: 8  mgc: 2.873949e-10 
iter: 1  mgc: 2.873949e-10 
Matching hessian patterns... Done
outer mgc:  75.85047 
iter: 1  value: 10412.61 mgc: 1.303117 ustep: 1 
iter: 2  value: 10412.58 mgc: 0.1037328 ustep: 1 
iter: 3  value: 10412.58 mgc: 0.0009606714 ustep: 1 
iter: 4  value: 10412.58 mgc: 8.842066e-08 ustep: 1 
iter: 5  mgc: 2.664535e-15 
iter: 1  value: 10259.75 mgc: 19.04162 ustep: 1 
iter: 2  value: 10258.82 mgc: 2.250555 ustep: 1 
iter: 3  value: 10258.82 mgc: 0.06502735 ustep: 1 
iter: 4  value: 10258.82 mgc: 3.381137e-05 ustep: 1 
iter: 5  mgc: 1.840572e-11 
iter: 1  mgc: 1.840572e-11 
outer mgc:  259.5822 
iter: 1  value: 12982.27 mgc: 516.7417 ustep: 0.0692153 
iter: 2  value: 12870.27 mgc: 40.13494 ustep: 0.2631617 
iter: 3  value: 12487.88 mgc: 61.80103 ustep: 0.5130416 
iter: 4  value: 12480.31 mgc: 10.3344 ustep: 0.7162976 
iter: 5  value: 12480.26 mgc: 0.5742066 ustep: 0.846359 
iter: 6  value: 12480.26 mgc: 0.01421353 ustep: 0.9199857 
iter: 7  value: 12480.26 mgc: 8.789211e-05 ustep: 0.959163 
iter: 8  value: 12480.26 mgc: 2.720872e-07 ustep: 0.9793707 
iter: 9  mgc: 4.222276e-10 
iter: 1  value: 10212.97 mgc: 7.489113 ustep: 1 
iter: 2  value: 10212.9 mgc: 0.5391904 ustep: 1 
iter: 3  value: 10212.9 mgc: 0.001847338 ustep: 1 
iter: 4  value: 10212.9 mgc: 1.748885e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  137.4821 
iter: 1  value: 10172.53 mgc: 4.602148 ustep: 1 
iter: 2  value: 10172.41 mgc: 0.4911608 ustep: 1 
iter: 3  value: 10172.41 mgc: 0.003474358 ustep: 1 
iter: 4  value: 10172.41 mgc: 2.013953e-07 ustep: 1 
iter: 5  mgc: 3.647083e-14 
iter: 1  mgc: 3.647083e-14 
outer mgc:  60.47288 
iter: 1  value: 10143.03 mgc: 5.253909 ustep: 1 
iter: 2  value: 10143.01 mgc: 0.2439238 ustep: 1 
iter: 3  value: 10143.01 mgc: 0.0003759614 ustep: 1 
iter: 4  mgc: 9.287943e-10 
iter: 1  mgc: 9.287943e-10 
outer mgc:  89.1748 
iter: 1  value: 10106.93 mgc: 7.254682 ustep: 1 
iter: 2  value: 10106.73 mgc: 0.561038 ustep: 1 
iter: 3  value: 10106.73 mgc: 0.002987329 ustep: 1 
iter: 4  value: 10106.73 mgc: 7.923242e-08 ustep: 1 
iter: 5  mgc: 5.262457e-14 
iter: 1  mgc: 5.262457e-14 
outer mgc:  80.92745 
iter: 1  value: 10069.9 mgc: 8.20727 ustep: 1 
iter: 2  value: 10069.86 mgc: 0.3183088 ustep: 1 
iter: 3  value: 10069.86 mgc: 0.0006435793 ustep: 1 
iter: 4  mgc: 4.700979e-09 
iter: 1  mgc: 4.700979e-09 
outer mgc:  34.44804 
iter: 1  value: 10048.73 mgc: 9.049197 ustep: 1 
iter: 2  value: 10048.73 mgc: 0.181739 ustep: 1 
iter: 3  value: 10048.73 mgc: 8.449975e-05 ustep: 1 
iter: 4  mgc: 1.849498e-11 
iter: 1  mgc: 1.849498e-11 
outer mgc:  74.60377 
iter: 1  value: 10045.85 mgc: 17.23722 ustep: 1 
iter: 2  value: 10045.85 mgc: 0.1199894 ustep: 1 
iter: 3  value: 10045.85 mgc: 1.284242e-05 ustep: 1 
iter: 4  mgc: 2.68674e-13 
iter: 1  value: 10043.18 mgc: 5.385653 ustep: 1 
iter: 2  value: 10043.18 mgc: 0.033376 ustep: 1 
iter: 3  value: 10043.18 mgc: 2.47174e-06 ustep: 1 
iter: 4  mgc: 7.460699e-14 
iter: 1  mgc: 7.460699e-14 
outer mgc:  77.49305 
iter: 1  value: 10032.85 mgc: 5.122174 ustep: 1 
iter: 2  value: 10032.85 mgc: 0.0171421 ustep: 1 
iter: 3  value: 10032.85 mgc: 3.391642e-07 ustep: 1 
iter: 4  mgc: 7.327472e-14 
iter: 1  mgc: 7.327472e-14 
outer mgc:  9.723653 
iter: 1  value: 10026.66 mgc: 2.746949 ustep: 1 
iter: 2  value: 10026.66 mgc: 0.01277918 ustep: 1 
iter: 3  value: 10026.66 mgc: 2.154201e-07 ustep: 1 
iter: 4  mgc: 1.081357e-13 
iter: 1  mgc: 1.081357e-13 
outer mgc:  27.09194 
iter: 1  value: 10018.67 mgc: 4.641501 ustep: 1 
iter: 2  value: 10018.67 mgc: 0.01092368 ustep: 1 
iter: 3  value: 10018.67 mgc: 1.467002e-07 ustep: 1 
mgc: 8.881784e-14 
iter: 1  mgc: 8.881784e-14 
outer mgc:  31.93954 
iter: 1  value: 10012 mgc: 5.322483 ustep: 1 
iter: 2  value: 10012 mgc: 0.009332587 ustep: 1 
iter: 3  value: 10012 mgc: 1.05614e-07 ustep: 1 
mgc: 9.414691e-14 
iter: 1  mgc: 9.414691e-14 
outer mgc:  37.40783 
iter: 1  value: 10007.56 mgc: 2.082142 ustep: 1 
iter: 2  value: 10007.56 mgc: 0.001051468 ustep: 1 
iter: 3  mgc: 8.786776e-10 
iter: 1  mgc: 8.786776e-10 
outer mgc:  14.21541 
iter: 1  value: 10007.14 mgc: 2.021125 ustep: 1 
iter: 2  value: 10007.14 mgc: 0.001220616 ustep: 1 
iter: 3  mgc: 2.996258e-09 
iter: 1  value: 10007.09 mgc: 0.9614575 ustep: 1 
iter: 2  value: 10007.09 mgc: 0.0002349742 ustep: 1 
iter: 3  mgc: 1.82574e-11 
iter: 1  mgc: 1.82574e-11 
outer mgc:  17.38813 
iter: 1  value: 10006.64 mgc: 0.7017765 ustep: 1 
iter: 2  value: 10006.64 mgc: 0.0004068304 ustep: 1 
iter: 3  mgc: 2.177298e-10 
iter: 1  mgc: 2.177298e-10 
outer mgc:  12.29689 
iter: 1  value: 10005.01 mgc: 0.7255305 ustep: 1 
iter: 2  value: 10005.01 mgc: 0.0007154759 ustep: 1 
iter: 3  mgc: 6.041612e-10 
iter: 1  mgc: 6.041612e-10 
outer mgc:  2.712159 
iter: 1  value: 10003.53 mgc: 0.6934766 ustep: 1 
iter: 2  value: 10003.53 mgc: 0.0006508661 ustep: 1 
iter: 3  mgc: 4.406653e-10 
iter: 1  mgc: 4.406653e-10 
outer mgc:  3.123067 
iter: 1  value: 10001.99 mgc: 0.5419913 ustep: 1 
iter: 2  value: 10001.99 mgc: 0.0003913431 ustep: 1 
iter: 3  mgc: 1.393001e-10 
iter: 1  mgc: 1.393001e-10 
outer mgc:  3.440305 
iter: 1  value: 9998.947 mgc: 1.784904 ustep: 1 
iter: 2  value: 9998.947 mgc: 0.0004794562 ustep: 1 
iter: 3  mgc: 1.704583e-10 
iter: 1  mgc: 1.704583e-10 
outer mgc:  6.657645 
iter: 1  value: 9995.644 mgc: 1.059374 ustep: 1 
iter: 2  value: 9995.644 mgc: 0.0009538535 ustep: 1 
iter: 3  mgc: 5.689929e-10 
iter: 1  mgc: 5.689929e-10 
outer mgc:  5.586995 
iter: 1  value: 9994.014 mgc: 0.9429637 ustep: 1 
iter: 2  value: 9994.014 mgc: 0.0008007566 ustep: 1 
iter: 3  mgc: 4.706244e-10 
iter: 1  value: 9994.968 mgc: 0.3246132 ustep: 1 
iter: 2  value: 9994.968 mgc: 0.0001094074 ustep: 1 
iter: 3  mgc: 7.317702e-12 
iter: 1  mgc: 7.317702e-12 
outer mgc:  4.290218 
iter: 1  value: 9994.39 mgc: 0.4715525 ustep: 1 
iter: 2  value: 9994.39 mgc: 0.0001270112 ustep: 1 
iter: 3  mgc: 1.410339e-11 
iter: 1  value: 9994.908 mgc: 0.2666875 ustep: 1 
iter: 2  value: 9994.908 mgc: 3.460158e-05 ustep: 1 
iter: 3  mgc: 9.618972e-13 
iter: 1  value: 9994.918 mgc: 0.1177649 ustep: 1 
iter: 2  value: 9994.918 mgc: 6.783936e-06 ustep: 1 
iter: 3  mgc: 6.594725e-14 
iter: 1  mgc: 6.594725e-14 
outer mgc:  2.471065 
iter: 1  value: 9994.801 mgc: 0.1307082 ustep: 1 
iter: 2  value: 9994.801 mgc: 2.982445e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  1.91173 
iter: 1  value: 9994.633 mgc: 0.09971809 ustep: 1 
iter: 2  value: 9994.633 mgc: 3.320868e-06 ustep: 1 
iter: 3  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  1.525278 
iter: 1  value: 9994.438 mgc: 0.09998802 ustep: 1 
iter: 2  value: 9994.438 mgc: 5.19796e-06 ustep: 1 
iter: 3  mgc: 5.040413e-14 
iter: 1  mgc: 5.040413e-14 
outer mgc:  0.9600687 
iter: 1  value: 9994.069 mgc: 0.1082782 ustep: 1 
iter: 2  value: 9994.069 mgc: 1.357887e-05 ustep: 1 
iter: 3  mgc: 1.358913e-13 
iter: 1  value: 9993.36 mgc: 0.269589 ustep: 1 
iter: 2  value: 9993.36 mgc: 6.221894e-05 ustep: 1 
iter: 3  mgc: 2.621015e-12 
iter: 1  value: 9990.17 mgc: 1.119952 ustep: 1 
iter: 2  value: 9990.17 mgc: 0.001094297 ustep: 1 
iter: 3  mgc: 7.038139e-10 
iter: 1  mgc: 7.038139e-10 
outer mgc:  2.346519 
iter: 1  value: 9985.732 mgc: 2.017265 ustep: 1 
iter: 2  value: 9985.732 mgc: 0.0002749463 ustep: 1 
iter: 3  mgc: 8.718359e-12 
iter: 1  value: 9988.044 mgc: 0.9609086 ustep: 1 
iter: 2  value: 9988.044 mgc: 6.422501e-05 ustep: 1 
iter: 3  mgc: 8.304468e-13 
iter: 1  mgc: 8.304468e-13 
outer mgc:  1.612286 
iter: 1  value: 9987.374 mgc: 0.410595 ustep: 1 
iter: 2  value: 9987.374 mgc: 0.0002322011 ustep: 1 
iter: 3  mgc: 2.667377e-11 
iter: 1  mgc: 2.667377e-11 
outer mgc:  0.6600533 
iter: 1  value: 9987.748 mgc: 0.4667102 ustep: 1 
iter: 2  value: 9987.748 mgc: 0.0001704431 ustep: 1 
iter: 3  mgc: 1.555289e-11 
iter: 1  mgc: 1.555289e-11 
outer mgc:  0.6157137 
iter: 1  value: 9988.813 mgc: 0.4489181 ustep: 1 
iter: 2  value: 9988.813 mgc: 7.54958e-05 ustep: 1 
iter: 3  mgc: 4.354739e-12 
iter: 1  mgc: 4.354739e-12 
outer mgc:  1.207546 
iter: 1  value: 9990.434 mgc: 0.7019278 ustep: 1 
iter: 2  value: 9990.434 mgc: 6.760404e-05 ustep: 1 
iter: 3  mgc: 5.228706e-12 
iter: 1  mgc: 5.228706e-12 
outer mgc:  0.3486013 
iter: 1  value: 9994.55 mgc: 1.898208 ustep: 1 
iter: 2  value: 9994.55 mgc: 0.0003078074 ustep: 1 
iter: 3  mgc: 1.372933e-10 
iter: 1  mgc: 1.372933e-10 
outer mgc:  0.2720793 
iter: 1  value: 9998.828 mgc: 1.279752 ustep: 1 
iter: 2  value: 9998.828 mgc: 0.0008276281 ustep: 1 
iter: 3  mgc: 9.534133e-10 
iter: 1  mgc: 9.534133e-10 
outer mgc:  0.5728719 
iter: 1  value: 9999.004 mgc: 0.8488851 ustep: 1 
iter: 2  value: 9999.004 mgc: 0.0001953041 ustep: 1 
iter: 3  mgc: 1.082956e-11 
iter: 1  mgc: 1.082956e-11 
outer mgc:  0.2035685 
iter: 1  value: 9997.753 mgc: 0.9230668 ustep: 1 
iter: 2  value: 9997.753 mgc: 0.0001369921 ustep: 1 
iter: 3  mgc: 2.478906e-12 
iter: 1  mgc: 2.478906e-12 
outer mgc:  0.04053651 
iter: 1  value: 9998.569 mgc: 0.4245956 ustep: 1 
iter: 2  value: 9998.569 mgc: 2.563475e-05 ustep: 1 
iter: 3  mgc: 1.064482e-12 
iter: 1  mgc: 1.064482e-12 
outer mgc:  0.01533565 
iter: 1  value: 9998.615 mgc: 0.03020052 ustep: 1 
iter: 2  value: 9998.615 mgc: 1.377575e-07 ustep: 1 
mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  0.005839349 
iter: 1  value: 9998.606 mgc: 0.005475146 ustep: 1 
iter: 2  mgc: 6.224921e-09 
iter: 1  mgc: 6.224921e-09 
outer mgc:  0.0005139171 
iter: 1  mgc: 6.224921e-09 
iter: 1  mgc: 6.224921e-09 
outer mgc:  0.0005139171 
iter: 1  value: 9998.607 mgc: 0.02352051 ustep: 1 
iter: 2  value: 9998.607 mgc: 1.502202e-07 ustep: 1 
mgc: 6.483702e-14 
outer mgc:  0.8941923 
iter: 1  value: 9998.605 mgc: 0.02350745 ustep: 1 
iter: 2  value: 9998.605 mgc: 1.505249e-07 ustep: 1 
mgc: 7.638334e-14 
outer mgc:  0.8937302 
iter: 1  value: 9998.607 mgc: 0.01382798 ustep: 1 
iter: 2  value: 9998.607 mgc: 5.43695e-08 ustep: 1 
mgc: 4.923839e-14 
outer mgc:  0.5499861 
iter: 1  value: 9998.605 mgc: 0.01382301 ustep: 1 
iter: 2  value: 9998.605 mgc: 5.446759e-08 ustep: 1 
mgc: 6.483702e-14 
outer mgc:  0.548769 
iter: 1  value: 9998.604 mgc: 0.01857481 ustep: 1 
iter: 2  value: 9998.604 mgc: 3.513106e-07 ustep: 1 
iter: 3  mgc: 5.184742e-14 
outer mgc:  0.675032 
iter: 1  value: 9998.608 mgc: 0.01856033 ustep: 1 
iter: 2  value: 9998.608 mgc: 3.511093e-07 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.6747606 
iter: 1  value: 9998.605 mgc: 0.009027583 ustep: 1 
iter: 2  value: 9998.605 mgc: 8.52441e-08 ustep: 1 
mgc: 7.549517e-14 
outer mgc:  0.3457231 
iter: 1  value: 9998.607 mgc: 0.009020645 ustep: 1 
iter: 2  value: 9998.607 mgc: 8.515295e-08 ustep: 1 
mgc: 6.483702e-14 
outer mgc:  0.3453193 
iter: 1  value: 9998.646 mgc: 0.03384488 ustep: 1 
iter: 2  value: 9998.646 mgc: 2.395138e-07 ustep: 1 
mgc: 6.128431e-14 
outer mgc:  0.005590969 
iter: 1  value: 9998.565 mgc: 0.03392043 ustep: 1 
iter: 2  value: 9998.565 mgc: 2.386381e-07 ustep: 1 
mgc: 5.018208e-14 
outer mgc:  0.00548709 
iter: 1  value: 9998.643 mgc: 0.0229648 ustep: 1 
iter: 2  value: 9998.643 mgc: 4.637179e-07 ustep: 1 
iter: 3  mgc: 7.371881e-14 
outer mgc:  0.008058958 
iter: 1  value: 9998.568 mgc: 0.02302403 ustep: 1 
iter: 2  value: 9998.568 mgc: 4.626438e-07 ustep: 1 
iter: 3  mgc: 7.105427e-14 
outer mgc:  0.008165735 
iter: 1  value: 9998.583 mgc: 0.009794145 ustep: 1 
iter: 2  value: 9998.583 mgc: 3.91315e-08 ustep: 1 
mgc: 5.329071e-14 
outer mgc:  0.0009712074 
iter: 1  value: 9998.628 mgc: 0.00978399 ustep: 1 
iter: 2  value: 9998.628 mgc: 3.923308e-08 ustep: 1 
mgc: 8.815171e-14 
outer mgc:  0.001030728 
iter: 1  value: 9998.601 mgc: 0.005509177 ustep: 1 
iter: 2  value: 9998.601 mgc: 1.721552e-08 ustep: 1 
mgc: 6.306067e-14 
outer mgc:  0.01884989 
iter: 1  value: 9998.61 mgc: 0.005509896 ustep: 1 
iter: 2  value: 9998.61 mgc: 1.721163e-08 ustep: 1 
mgc: 7.849277e-14 
outer mgc:  0.01893191 
[Fri Aug 13 11:27:38 2021]
Finished job 0.
1 of 1 steps (100%) done

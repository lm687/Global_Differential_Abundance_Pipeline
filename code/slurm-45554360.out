Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 12:17:37 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22126.051494 
iter  10 value 20000.854206
iter  10 value 20000.854205
final  value 20000.854205 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3169.491 mgc: 114.862 ustep: 1 
iter: 2  value: 2476.974 mgc: 29.48505 ustep: 1 
iter: 3  value: 2350.633 mgc: 37.05357 ustep: 1 
iter: 4  value: 2348.26 mgc: 3.343571 ustep: 1 
iter: 5  value: 2348.162 mgc: 0.6072732 ustep: 1 
iter: 6  value: 2348.161 mgc: 0.06940255 ustep: 1 
iter: 7  value: 2348.161 mgc: 0.001207155 ustep: 1 
iter: 8  value: 2348.161 mgc: 3.809265e-07 ustep: 1 
iter: 9  mgc: 4.152234e-14 
iter: 1  mgc: 4.152234e-14 
Matching hessian patterns... Done
outer mgc:  166.8484 
iter: 1  value: 2694.336 mgc: 46.27934 ustep: 1 
iter: 2  value: 2567.074 mgc: 15.1252 ustep: 1 
iter: 3  value: 2565.967 mgc: 1.614658 ustep: 1 
iter: 4  value: 2565.967 mgc: 0.03062975 ustep: 1 
iter: 5  value: 2565.967 mgc: 2.105066e-05 ustep: 1 
iter: 6  mgc: 1.423439e-11 
iter: 1  value: 2322.033 mgc: 13.23129 ustep: 1 
iter: 2  value: 2321.653 mgc: 0.7454631 ustep: 1 
iter: 3  value: 2321.653 mgc: 0.006962756 ustep: 1 
iter: 4  value: 2321.653 mgc: 6.269239e-07 ustep: 1 
iter: 5  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  104.1828 
iter: 1  value: 2306.797 mgc: 4.580273 ustep: 1 
iter: 2  value: 2306.787 mgc: 0.09673358 ustep: 1 
iter: 3  value: 2306.787 mgc: 0.0001604371 ustep: 1 
iter: 4  mgc: 5.872832e-09 
iter: 1  mgc: 5.872832e-09 
outer mgc:  108.0836 
iter: 1  value: 2288.043 mgc: 15.44634 ustep: 1 
iter: 2  value: 2287.574 mgc: 0.8713698 ustep: 1 
iter: 3  value: 2287.574 mgc: 0.009241717 ustep: 1 
iter: 4  value: 2287.574 mgc: 1.098552e-06 ustep: 1 
iter: 5  mgc: 7.727152e-14 
iter: 1  mgc: 7.727152e-14 
outer mgc:  87.45169 
iter: 1  value: 2245.118 mgc: 18.69754 ustep: 1 
iter: 2  value: 2243.646 mgc: 1.390532 ustep: 1 
iter: 3  value: 2243.646 mgc: 0.02347764 ustep: 1 
iter: 4  value: 2243.646 mgc: 7.146828e-05 ustep: 1 
iter: 5  mgc: 6.66919e-10 
iter: 1  value: 2208.437 mgc: 30.62873 ustep: 1 
iter: 2  value: 2198.82 mgc: 3.956335 ustep: 1 
iter: 3  value: 2198.809 mgc: 0.1375613 ustep: 1 
iter: 4  value: 2198.809 mgc: 0.0006266245 ustep: 1 
iter: 5  value: 2198.809 mgc: 2.673606e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  value: 2458.872 mgc: 56.52219 ustep: 1 
iter: 2  value: 2352.968 mgc: 19.93758 ustep: 1 
iter: 3  value: 2352.658 mgc: 1.170549 ustep: 1 
iter: 4  value: 2352.658 mgc: 0.007732518 ustep: 1 
iter: 5  value: 2352.658 mgc: 3.873817e-07 ustep: 1 
iter: 6  mgc: 4.052314e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  83.2789 
iter: 1  value: 2330.162 mgc: 47.95339 ustep: 1 
iter: 2  value: 2214.129 mgc: 17.10429 ustep: 1 
iter: 3  value: 2213.273 mgc: 1.633242 ustep: 1 
iter: 4  value: 2213.273 mgc: 0.02987617 ustep: 1 
iter: 5  value: 2213.273 mgc: 1.063953e-05 ustep: 1 
iter: 6  mgc: 1.556255e-12 
iter: 1  value: 2197.099 mgc: 21.16286 ustep: 1 
iter: 2  value: 2194.262 mgc: 2.235674 ustep: 1 
iter: 3  value: 2194.261 mgc: 0.04966434 ustep: 1 
iter: 4  value: 2194.261 mgc: 3.041086e-05 ustep: 1 
iter: 5  mgc: 1.143408e-11 
iter: 1  mgc: 1.143408e-11 
outer mgc:  166.4105 
iter: 1  value: 2162.415 mgc: 5.631024 ustep: 1 
iter: 2  value: 2162.411 mgc: 0.1863573 ustep: 1 
iter: 3  value: 2162.411 mgc: 0.0002444665 ustep: 1 
iter: 4  mgc: 1.778006e-09 
iter: 1  mgc: 1.778006e-09 
outer mgc:  188.2349 
iter: 1  value: 2144.717 mgc: 25.84281 ustep: 1 
iter: 2  value: 2143.005 mgc: 2.795347 ustep: 1 
iter: 3  value: 2143.005 mgc: 0.03436077 ustep: 1 
iter: 4  value: 2143.005 mgc: 8.618755e-06 ustep: 1 
iter: 5  mgc: 1.042721e-12 
iter: 1  mgc: 1.042721e-12 
outer mgc:  106.773 
iter: 1  value: 2141.707 mgc: 26.78865 ustep: 1 
iter: 2  value: 2138.194 mgc: 1.830412 ustep: 1 
iter: 3  value: 2138.192 mgc: 0.03761276 ustep: 1 
iter: 4  value: 2138.192 mgc: 2.946524e-05 ustep: 1 
iter: 5  mgc: 5.974821e-11 
iter: 1  mgc: 5.974821e-11 
outer mgc:  52.88031 
iter: 1  value: 2137.103 mgc: 11.4414 ustep: 1 
iter: 2  value: 2137.037 mgc: 0.4564046 ustep: 1 
iter: 3  value: 2137.037 mgc: 0.003889399 ustep: 1 
iter: 4  value: 2137.037 mgc: 8.465731e-07 ustep: 1 
iter: 5  mgc: 4.13003e-14 
iter: 1  value: 2133.064 mgc: 9.942783 ustep: 1 
iter: 2  value: 2132.963 mgc: 0.3590311 ustep: 1 
iter: 3  value: 2132.963 mgc: 0.001538911 ustep: 1 
iter: 4  value: 2132.963 mgc: 4.454532e-08 ustep: 1 
iter: 5  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  50.14475 
iter: 1  value: 2139.549 mgc: 7.697469 ustep: 1 
iter: 2  value: 2139.529 mgc: 0.1748548 ustep: 1 
iter: 3  value: 2139.529 mgc: 0.0003023081 ustep: 1 
iter: 4  mgc: 1.068575e-09 
iter: 1  value: 2130.787 mgc: 2.993414 ustep: 1 
iter: 2  value: 2130.787 mgc: 0.02491566 ustep: 1 
iter: 3  value: 2130.787 mgc: 7.474701e-06 ustep: 1 
iter: 4  mgc: 6.811079e-13 
iter: 1  mgc: 6.811079e-13 
outer mgc:  30.88384 
iter: 1  value: 2129.389 mgc: 0.5515261 ustep: 1 
iter: 2  value: 2129.389 mgc: 0.005402709 ustep: 1 
iter: 3  value: 2129.389 mgc: 1.932697e-06 ustep: 1 
iter: 4  mgc: 2.473577e-13 
iter: 1  mgc: 2.473577e-13 
outer mgc:  15.52699 
iter: 1  value: 2129.041 mgc: 1.108702 ustep: 1 
iter: 2  value: 2129.041 mgc: 0.004416191 ustep: 1 
iter: 3  value: 2129.041 mgc: 2.39688e-07 ustep: 1 
iter: 4  mgc: 3.796963e-14 
iter: 1  mgc: 3.796963e-14 
outer mgc:  16.6682 
iter: 1  value: 2129.07 mgc: 0.8605881 ustep: 1 
iter: 2  value: 2129.07 mgc: 0.003562761 ustep: 1 
iter: 3  value: 2129.07 mgc: 9.487509e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  8.64159 
iter: 1  value: 2128.893 mgc: 2.185772 ustep: 1 
iter: 2  value: 2128.893 mgc: 0.01253588 ustep: 1 
iter: 3  value: 2128.893 mgc: 1.160022e-06 ustep: 1 
iter: 4  mgc: 3.330669e-14 
iter: 1  value: 2128.988 mgc: 1.06453 ustep: 1 
iter: 2  value: 2128.988 mgc: 0.002998935 ustep: 1 
iter: 3  value: 2128.988 mgc: 6.778957e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  7.919136 
iter: 1  value: 2128.876 mgc: 0.2470158 ustep: 1 
iter: 2  value: 2128.876 mgc: 0.0002079491 ustep: 1 
iter: 3  mgc: 2.780912e-09 
iter: 1  mgc: 2.780912e-09 
outer mgc:  3.956858 
iter: 1  value: 2129.049 mgc: 0.5665498 ustep: 1 
iter: 2  value: 2129.049 mgc: 0.001010207 ustep: 1 
iter: 3  mgc: 8.042626e-09 
iter: 1  mgc: 8.042626e-09 
outer mgc:  2.703834 
iter: 1  value: 2129.095 mgc: 0.9602163 ustep: 1 
iter: 2  value: 2129.095 mgc: 0.002259526 ustep: 1 
iter: 3  value: 2129.095 mgc: 3.442315e-08 ustep: 1 
mgc: 4.263256e-14 
iter: 1  value: 2129.035 mgc: 0.1504996 ustep: 1 
iter: 2  value: 2129.035 mgc: 5.59681e-05 ustep: 1 
iter: 3  mgc: 2.107267e-11 
iter: 1  mgc: 2.107267e-11 
outer mgc:  0.6768121 
iter: 1  value: 2129.021 mgc: 0.06327209 ustep: 1 
iter: 2  value: 2129.021 mgc: 1.10952e-05 ustep: 1 
iter: 3  mgc: 1.115552e-12 
iter: 1  mgc: 1.115552e-12 
outer mgc:  0.9380939 
iter: 1  value: 2129.012 mgc: 0.02715689 ustep: 1 
iter: 2  value: 2129.012 mgc: 9.839705e-06 ustep: 1 
iter: 3  mgc: 5.682566e-12 
iter: 1  mgc: 5.682566e-12 
outer mgc:  0.292238 
iter: 1  value: 2129.028 mgc: 0.142378 ustep: 1 
iter: 2  value: 2129.028 mgc: 7.096405e-05 ustep: 1 
iter: 3  mgc: 3.078746e-10 
iter: 1  value: 2129.006 mgc: 0.04149667 ustep: 1 
iter: 2  value: 2129.006 mgc: 4.504037e-06 ustep: 1 
iter: 3  mgc: 1.501022e-13 
iter: 1  mgc: 1.501022e-13 
outer mgc:  0.1092065 
iter: 1  value: 2128.998 mgc: 0.03733046 ustep: 1 
iter: 2  value: 2128.998 mgc: 3.999869e-06 ustep: 1 
iter: 3  mgc: 1.536549e-13 
iter: 1  mgc: 1.536549e-13 
outer mgc:  0.1634251 
iter: 1  value: 2128.995 mgc: 0.01212187 ustep: 1 
iter: 2  value: 2128.995 mgc: 7.288115e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
iter: 1  value: 2128.997 mgc: 0.01347183 ustep: 1 
iter: 2  value: 2128.997 mgc: 5.682444e-07 ustep: 1 
iter: 3  mgc: 4.474199e-14 
iter: 1  mgc: 4.474199e-14 
outer mgc:  0.2092951 
iter: 1  value: 2128.997 mgc: 0.006977904 ustep: 1 
iter: 2  value: 2128.997 mgc: 1.273184e-07 ustep: 1 
iter: 3  mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  0.0249456 
iter: 1  value: 2128.998 mgc: 0.01005198 ustep: 1 
iter: 2  value: 2128.998 mgc: 3.886677e-07 ustep: 1 
iter: 3  mgc: 3.51108e-14 
iter: 1  mgc: 3.51108e-14 
outer mgc:  0.0518297 
iter: 1  value: 2128.996 mgc: 0.006664495 ustep: 1 
iter: 2  value: 2128.996 mgc: 1.347677e-07 ustep: 1 
iter: 3  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  0.0151191 
iter: 1  value: 2128.998 mgc: 0.02272299 ustep: 1 
iter: 2  value: 2128.998 mgc: 1.378356e-06 ustep: 1 
iter: 3  mgc: 4.063416e-14 
iter: 1  value: 2128.996 mgc: 0.002272282 ustep: 1 
iter: 2  value: 2128.996 mgc: 1.378602e-08 ustep: 1 
mgc: 3.771983e-14 
iter: 1  mgc: 3.771983e-14 
outer mgc:  0.01847273 
iter: 1  value: 2128.997 mgc: 0.0003097596 ustep: 1 
iter: 2  mgc: 5.893028e-10 
iter: 1  mgc: 5.893028e-10 
outer mgc:  0.01102122 
iter: 1  value: 2128.997 mgc: 0.000981558 ustep: 1 
iter: 2  mgc: 4.259044e-09 
iter: 1  mgc: 4.259044e-09 
outer mgc:  0.007122298 
iter: 1  value: 2128.997 mgc: 0.00151029 ustep: 1 
iter: 2  mgc: 6.897091e-09 
iter: 1  value: 2128.997 mgc: 0.0006337002 ustep: 1 
iter: 2  mgc: 1.214272e-09 
iter: 1  mgc: 1.214272e-09 
outer mgc:  0.006505485 
iter: 1  value: 2128.997 mgc: 0.0003857466 ustep: 1 
iter: 2  mgc: 5.864893e-10 
iter: 1  mgc: 5.864893e-10 
outer mgc:  0.001969347 
iter: 1  mgc: 5.864893e-10 
iter: 1  mgc: 5.864893e-10 
outer mgc:  0.001969347 
iter: 1  value: 2128.999 mgc: 0.05848305 ustep: 1 
iter: 2  value: 2128.999 mgc: 8.526624e-06 ustep: 1 
iter: 3  mgc: 5.049294e-13 
outer mgc:  0.2815993 
iter: 1  value: 2128.995 mgc: 0.05847454 ustep: 1 
iter: 2  value: 2128.995 mgc: 8.515247e-06 ustep: 1 
iter: 3  mgc: 5.049294e-13 
outer mgc:  0.2786677 
iter: 1  value: 2128.998 mgc: 0.02999795 ustep: 1 
iter: 2  value: 2128.998 mgc: 2.344856e-06 ustep: 1 
iter: 3  mgc: 5.462297e-14 
outer mgc:  1.230105 
iter: 1  value: 2128.997 mgc: 0.02999769 ustep: 1 
iter: 2  value: 2128.997 mgc: 2.344254e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  1.22812 
iter: 1  value: 2128.994 mgc: 0.0523724 ustep: 1 
iter: 2  value: 2128.994 mgc: 9.852366e-06 ustep: 1 
iter: 3  mgc: 9.394152e-13 
outer mgc:  0.1515482 
iter: 1  value: 2128.999 mgc: 0.05235615 ustep: 1 
iter: 2  value: 2128.999 mgc: 9.862289e-06 ustep: 1 
iter: 3  mgc: 9.502399e-13 
outer mgc:  0.150627 
iter: 1  value: 2128.996 mgc: 0.02573698 ustep: 1 
iter: 2  value: 2128.996 mgc: 2.674295e-06 ustep: 1 
iter: 3  mgc: 6.444845e-14 
outer mgc:  0.6136539 
iter: 1  value: 2128.999 mgc: 0.02572834 ustep: 1 
iter: 2  value: 2128.999 mgc: 2.674797e-06 ustep: 1 
iter: 3  mgc: 6.578071e-14 
outer mgc:  0.6154361 
iter: 1  value: 2128.991 mgc: 0.005345911 ustep: 1 
iter: 2  value: 2128.991 mgc: 8.144681e-07 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  0.07188788 
iter: 1  value: 2129.003 mgc: 0.005340023 ustep: 1 
iter: 2  value: 2129.003 mgc: 8.12955e-07 ustep: 1 
iter: 3  mgc: 4.485301e-14 
outer mgc:  0.06970273 
iter: 1  value: 2129.004 mgc: 0.009237054 ustep: 1 
iter: 2  value: 2129.004 mgc: 7.618957e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.2108803 
iter: 1  value: 2128.99 mgc: 0.009256912 ustep: 1 
iter: 2  value: 2128.99 mgc: 7.646506e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.2123779 
iter: 1  value: 2129.008 mgc: 0.007444294 ustep: 1 
iter: 2  value: 2129.008 mgc: 3.625696e-06 ustep: 1 
iter: 3  mgc: 8.61089e-13 
outer mgc:  0.180133 
iter: 1  value: 2128.986 mgc: 0.007460045 ustep: 1 
iter: 2  value: 2128.986 mgc: 3.634668e-06 ustep: 1 
iter: 3  mgc: 8.602008e-13 
outer mgc:  0.1843265 
[Sat Aug 14 12:17:40 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:50:37 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_4_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_4_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_4_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=4, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_4_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_4_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_4_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_4_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_4_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 5596.470336 
iter  10 value 4916.129168
final  value 4856.316163 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4436.592 mgc: 5.01598 ustep: 0.8994163 
iter: 2  value: 4410.129 mgc: 5.848097 ustep: 0.9483808 
iter: 3  value: 4407.043 mgc: 3.214295 ustep: 0.973851 
iter: 4  value: 4406.505 mgc: 1.709389 ustep: 0.9868402 
iter: 5  value: 4406.503 mgc: 0.08008705 ustep: 0.993399 
iter: 6  value: 4406.503 mgc: 0.0008223082 ustep: 0.9966944 
iter: 7  value: 4406.503 mgc: 1.610414e-06 ustep: 0.998346 
iter: 8  mgc: 2.647565e-09 
iter: 1  mgc: 2.647565e-09 
Matching hessian patterns... Done
outer mgc:  21.68817 
iter: 1  value: 4360.114 mgc: 1.691104 ustep: 1 
iter: 2  value: 4360.009 mgc: 0.2879032 ustep: 1 
iter: 3  value: 4360.009 mgc: 0.003411137 ustep: 1 
iter: 4  value: 4360.009 mgc: 6.64348e-07 ustep: 1 
iter: 5  mgc: 2.4869e-14 
iter: 1  value: 4387.105 mgc: 17.77095 ustep: 1 
iter: 2  value: 4365.506 mgc: 6.39766 ustep: 1 
iter: 3  value: 4365.476 mgc: 0.307815 ustep: 1 
iter: 4  value: 4365.476 mgc: 0.002350596 ustep: 1 
iter: 5  value: 4365.476 mgc: 1.324133e-07 ustep: 1 
iter: 6  mgc: 7.993606e-15 
iter: 1  mgc: 2.4869e-14 
outer mgc:  24.45758 
iter: 1  value: 4310.778 mgc: 7.166687 ustep: 1 
iter: 2  value: 4306.074 mgc: 2.610506 ustep: 1 
iter: 3  value: 4306.064 mgc: 0.1532438 ustep: 1 
iter: 4  value: 4306.064 mgc: 0.001028263 ustep: 1 
iter: 5  value: 4306.064 mgc: 3.564929e-08 ustep: 1 
iter: 6  mgc: 2.220446e-15 
iter: 1  mgc: 2.220446e-15 
outer mgc:  24.32582 
iter: 1  value: 4352.872 mgc: 11.79253 ustep: 1 
iter: 2  value: 4342.459 mgc: 5.79243 ustep: 1 
iter: 3  value: 4342.444 mgc: 0.2216939 ustep: 1 
iter: 4  value: 4342.444 mgc: 0.0006537384 ustep: 1 
iter: 5  value: 4342.444 mgc: 8.095207e-08 ustep: 1 
iter: 6  mgc: 5.77316e-15 
iter: 1  value: 4292.103 mgc: 3.141467 ustep: 1 
iter: 2  value: 4292.092 mgc: 0.09982211 ustep: 1 
iter: 3  value: 4292.092 mgc: 0.0006246003 ustep: 1 
iter: 4  mgc: 7.535436e-09 
iter: 1  mgc: 7.535436e-09 
outer mgc:  6.703839 
iter: 1  value: 4279.422 mgc: 1.467963 ustep: 1 
iter: 2  value: 4279.422 mgc: 0.01633847 ustep: 1 
iter: 3  value: 4279.422 mgc: 4.620996e-06 ustep: 1 
iter: 4  mgc: 8.237855e-13 
iter: 1  mgc: 8.237855e-13 
outer mgc:  6.098855 
iter: 1  value: 4277.874 mgc: 2.928101 ustep: 1 
iter: 2  value: 4277.872 mgc: 0.07946376 ustep: 1 
iter: 3  value: 4277.872 mgc: 0.0001040982 ustep: 1 
iter: 4  mgc: 2.616378e-10 
iter: 1  mgc: 2.616378e-10 
outer mgc:  17.23525 
iter: 1  value: 4269.852 mgc: 2.427116 ustep: 1 
iter: 2  value: 4269.846 mgc: 0.1466008 ustep: 1 
iter: 3  value: 4269.846 mgc: 0.0003410371 ustep: 1 
iter: 4  mgc: 2.355903e-09 
iter: 1  mgc: 2.355903e-09 
outer mgc:  5.920168 
iter: 1  value: 4263.69 mgc: 1.644302 ustep: 1 
iter: 2  value: 4263.689 mgc: 0.07459185 ustep: 1 
iter: 3  value: 4263.689 mgc: 3.880334e-05 ustep: 1 
iter: 4  mgc: 1.602124e-10 
iter: 1  mgc: 1.602124e-10 
outer mgc:  5.66399 
iter: 1  value: 4260.127 mgc: 1.800778 ustep: 1 
iter: 2  value: 4260.127 mgc: 0.0430805 ustep: 1 
iter: 3  value: 4260.127 mgc: 1.764863e-05 ustep: 1 
iter: 4  mgc: 7.069012e-12 
iter: 1  mgc: 7.069012e-12 
outer mgc:  8.448895 
iter: 1  value: 4260.227 mgc: 1.990887 ustep: 1 
iter: 2  value: 4260.226 mgc: 0.04135663 ustep: 1 
iter: 3  value: 4260.226 mgc: 2.759717e-05 ustep: 1 
iter: 4  mgc: 1.737988e-11 
iter: 1  mgc: 1.737988e-11 
outer mgc:  9.487489 
iter: 1  value: 4255.945 mgc: 1.828 ustep: 1 
iter: 2  value: 4255.943 mgc: 0.07886823 ustep: 1 
iter: 3  value: 4255.943 mgc: 0.0001315094 ustep: 1 
iter: 4  mgc: 3.541241e-10 
iter: 1  mgc: 3.541241e-10 
outer mgc:  8.530768 
iter: 1  value: 4252.507 mgc: 1.594506 ustep: 1 
iter: 2  value: 4252.507 mgc: 0.04135155 ustep: 1 
iter: 3  value: 4252.507 mgc: 5.224377e-05 ustep: 1 
iter: 4  mgc: 7.893464e-11 
iter: 1  mgc: 7.893464e-11 
outer mgc:  4.196335 
iter: 1  value: 4249.444 mgc: 3.074904 ustep: 1 
iter: 2  value: 4249.442 mgc: 0.09357454 ustep: 1 
iter: 3  value: 4249.442 mgc: 0.0003097539 ustep: 1 
iter: 4  mgc: 3.429625e-09 
iter: 1  value: 4252.573 mgc: 1.241064 ustep: 1 
iter: 2  value: 4252.573 mgc: 0.03180373 ustep: 1 
iter: 3  value: 4252.573 mgc: 2.738964e-05 ustep: 1 
iter: 4  mgc: 1.598149e-11 
iter: 1  mgc: 1.598149e-11 
outer mgc:  3.985552 
iter: 1  value: 4251.69 mgc: 1.122638 ustep: 1 
iter: 2  value: 4251.689 mgc: 0.02785789 ustep: 1 
iter: 3  value: 4251.689 mgc: 2.956678e-05 ustep: 1 
iter: 4  mgc: 3.334755e-11 
iter: 1  mgc: 3.334755e-11 
outer mgc:  2.128522 
iter: 1  value: 4249.192 mgc: 2.053263 ustep: 1 
iter: 2  value: 4249.191 mgc: 0.06700607 ustep: 1 
iter: 3  value: 4249.191 mgc: 0.000127498 ustep: 1 
iter: 4  mgc: 4.738305e-10 
iter: 1  value: 4250.73 mgc: 0.8451437 ustep: 1 
iter: 2  value: 4250.73 mgc: 0.01003578 ustep: 1 
iter: 3  value: 4250.73 mgc: 3.192536e-06 ustep: 1 
iter: 4  mgc: 3.246292e-13 
iter: 1  mgc: 3.246292e-13 
outer mgc:  1.898866 
iter: 1  value: 4249.423 mgc: 0.9472305 ustep: 1 
iter: 2  value: 4249.423 mgc: 0.009297718 ustep: 1 
iter: 3  value: 4249.423 mgc: 2.389128e-06 ustep: 1 
iter: 4  mgc: 1.487699e-13 
iter: 1  mgc: 1.487699e-13 
outer mgc:  1.470811 
iter: 1  value: 4248.188 mgc: 0.4441785 ustep: 1 
iter: 2  value: 4248.188 mgc: 0.003453611 ustep: 1 
iter: 3  value: 4248.188 mgc: 3.91099e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.6796001 
iter: 1  value: 4246.88 mgc: 0.7648028 ustep: 1 
iter: 2  value: 4246.88 mgc: 0.00735607 ustep: 1 
iter: 3  value: 4246.88 mgc: 1.778056e-06 ustep: 1 
iter: 4  mgc: 1.119105e-13 
iter: 1  mgc: 1.119105e-13 
outer mgc:  1.389288 
iter: 1  value: 4246.867 mgc: 0.5190111 ustep: 1 
iter: 2  value: 4246.867 mgc: 0.002951859 ustep: 1 
iter: 3  value: 4246.867 mgc: 2.297032e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.8000227 
iter: 1  value: 4246.491 mgc: 0.3140489 ustep: 1 
iter: 2  value: 4246.491 mgc: 0.00118927 ustep: 1 
iter: 3  value: 4246.491 mgc: 2.676044e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.5587923 
iter: 1  value: 4246.065 mgc: 0.2583847 ustep: 1 
iter: 2  value: 4246.065 mgc: 0.0004376755 ustep: 1 
iter: 3  mgc: 4.357798e-09 
iter: 1  value: 4246.384 mgc: 0.1916209 ustep: 1 
iter: 2  value: 4246.384 mgc: 0.000595735 ustep: 1 
iter: 3  mgc: 6.453076e-09 
iter: 1  mgc: 6.453076e-09 
outer mgc:  0.6049688 
iter: 1  value: 4246.061 mgc: 0.1349458 ustep: 1 
iter: 2  value: 4246.061 mgc: 0.000278147 ustep: 1 
iter: 3  mgc: 1.100232e-09 
iter: 1  mgc: 1.100232e-09 
outer mgc:  0.08107693 
iter: 1  value: 4245.804 mgc: 0.0741409 ustep: 1 
iter: 2  value: 4245.804 mgc: 0.0001137401 ustep: 1 
iter: 3  mgc: 1.996574e-10 
iter: 1  mgc: 1.996574e-10 
outer mgc:  0.09477675 
iter: 1  value: 4245.351 mgc: 0.1096669 ustep: 1 
iter: 2  value: 4245.351 mgc: 3.558432e-05 ustep: 1 
iter: 3  mgc: 4.003464e-11 
iter: 1  value: 4244.427 mgc: 0.2271999 ustep: 1 
iter: 2  value: 4244.427 mgc: 0.0001425146 ustep: 1 
iter: 3  mgc: 6.266609e-10 
iter: 1  mgc: 6.266609e-10 
outer mgc:  0.1325693 
iter: 1  value: 4243.301 mgc: 0.3007566 ustep: 1 
iter: 2  value: 4243.301 mgc: 0.0001916548 ustep: 1 
iter: 3  mgc: 5.900609e-10 
iter: 1  mgc: 5.900609e-10 
outer mgc:  0.07195596 
iter: 1  value: 4242.997 mgc: 0.1567898 ustep: 1 
iter: 2  value: 4242.997 mgc: 0.0001006007 ustep: 1 
iter: 3  mgc: 1.90238e-10 
iter: 1  value: 4243.149 mgc: 0.07801679 ustep: 1 
iter: 2  value: 4243.149 mgc: 2.542093e-05 ustep: 1 
iter: 3  mgc: 1.210543e-11 
iter: 1  mgc: 1.210543e-11 
outer mgc:  0.04988343 
iter: 1  value: 4242.903 mgc: 0.1083025 ustep: 1 
iter: 2  value: 4242.903 mgc: 1.86462e-05 ustep: 1 
iter: 3  mgc: 5.999645e-12 
iter: 1  mgc: 5.999645e-12 
outer mgc:  0.03405196 
iter: 1  value: 4242.657 mgc: 0.08155617 ustep: 1 
iter: 2  value: 4242.657 mgc: 5.746828e-05 ustep: 1 
iter: 3  mgc: 1.079754e-10 
iter: 1  mgc: 1.079754e-10 
outer mgc:  0.05600226 
iter: 1  value: 4242.616 mgc: 0.03258856 ustep: 1 
iter: 2  value: 4242.616 mgc: 5.538052e-06 ustep: 1 
iter: 3  mgc: 5.284662e-13 
iter: 1  mgc: 5.284662e-13 
outer mgc:  0.01089406 
iter: 1  value: 4242.644 mgc: 0.0129056 ustep: 1 
iter: 2  value: 4242.644 mgc: 2.09595e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.001600464 
iter: 1  value: 4242.647 mgc: 0.004164942 ustep: 1 
iter: 2  value: 4242.647 mgc: 1.695635e-07 ustep: 1 
iter: 3  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.001150527 
iter: 1  mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.001150527 
iter: 1  value: 4242.645 mgc: 0.00405784 ustep: 1 
iter: 2  value: 4242.645 mgc: 3.329301e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.03809603 
iter: 1  value: 4242.649 mgc: 0.004053978 ustep: 1 
iter: 2  value: 4242.649 mgc: 3.325973e-07 ustep: 1 
iter: 3  mgc: 5.731526e-15 
outer mgc:  0.03899334 
iter: 1  value: 4242.646 mgc: 0.002378003 ustep: 1 
iter: 2  value: 4242.646 mgc: 1.106593e-07 ustep: 1 
iter: 3  mgc: 5.245804e-15 
outer mgc:  0.02333208 
iter: 1  value: 4242.648 mgc: 0.002376405 ustep: 1 
iter: 2  value: 4242.648 mgc: 1.105192e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.02469351 
iter: 1  value: 4242.646 mgc: 0.006360143 ustep: 1 
iter: 2  value: 4242.646 mgc: 6.17036e-07 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.04903572 
iter: 1  value: 4242.648 mgc: 0.006356926 ustep: 1 
iter: 2  value: 4242.648 mgc: 6.170867e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.04826776 
iter: 1  value: 4242.646 mgc: 0.00338986 ustep: 1 
iter: 2  value: 4242.646 mgc: 1.877073e-07 ustep: 1 
iter: 3  mgc: 4.14252e-15 
outer mgc:  0.03185278 
iter: 1  value: 4242.648 mgc: 0.003389575 ustep: 1 
iter: 2  value: 4242.648 mgc: 1.875742e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.03325881 
iter: 1  value: 4242.648 mgc: 0.007172764 ustep: 1 
iter: 2  value: 4242.648 mgc: 6.620819e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.04220358 
iter: 1  value: 4242.646 mgc: 0.007172002 ustep: 1 
iter: 2  value: 4242.646 mgc: 6.633631e-07 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.04078515 
iter: 1  value: 4242.649 mgc: 0.003807624 ustep: 1 
iter: 2  value: 4242.649 mgc: 1.831871e-07 ustep: 1 
iter: 3  mgc: 8.437695e-15 
outer mgc:  0.04158142 
iter: 1  value: 4242.645 mgc: 0.003808597 ustep: 1 
iter: 2  value: 4242.645 mgc: 1.83601e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.03990891 
iter: 1  value: 4242.661 mgc: 0.01319021 ustep: 1 
iter: 2  value: 4242.661 mgc: 1.508922e-06 ustep: 1 
iter: 3  mgc: 6.972201e-14 
outer mgc:  0.01148182 
iter: 1  value: 4242.633 mgc: 0.01322722 ustep: 1 
iter: 2  value: 4242.633 mgc: 1.506094e-06 ustep: 1 
iter: 3  mgc: 6.483702e-14 
outer mgc:  0.01112229 
iter: 1  value: 4242.663 mgc: 0.008587396 ustep: 1 
iter: 2  value: 4242.663 mgc: 1.801752e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.003558287 
iter: 1  value: 4242.631 mgc: 0.008608439 ustep: 1 
iter: 2  value: 4242.631 mgc: 1.797468e-07 ustep: 1 
iter: 3  mgc: 4.884981e-15 
outer mgc:  0.002683406 
iter: 1  value: 4242.652 mgc: 0.009760827 ustep: 1 
iter: 2  value: 4242.652 mgc: 7.244002e-07 ustep: 1 
iter: 3  mgc: 1.176836e-14 
outer mgc:  0.0280094 
iter: 1  value: 4242.642 mgc: 0.009787144 ustep: 1 
iter: 2  value: 4242.642 mgc: 7.24674e-07 ustep: 1 
iter: 3  mgc: 1.24345e-14 
outer mgc:  0.02716362 
iter: 1  value: 4242.656 mgc: 0.008073089 ustep: 1 
iter: 2  value: 4242.656 mgc: 1.307564e-07 ustep: 1 
iter: 3  mgc: 5.995204e-15 
outer mgc:  0.00228901 
iter: 1  value: 4242.638 mgc: 0.008075406 ustep: 1 
iter: 2  value: 4242.638 mgc: 1.304091e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.003128319 
iter: 1  value: 4242.641 mgc: 0.003883239 ustep: 1 
iter: 2  value: 4242.641 mgc: 1.902881e-07 ustep: 1 
iter: 3  mgc: 6.883383e-15 
outer mgc:  0.001206702 
iter: 1  value: 4242.653 mgc: 0.003880135 ustep: 1 
iter: 2  value: 4242.653 mgc: 1.90485e-07 ustep: 1 
iter: 3  mgc: 5.107026e-15 
outer mgc:  0.002689465 
iter: 1  value: 4242.643 mgc: 0.003829484 ustep: 1 
iter: 2  value: 4242.643 mgc: 1.327881e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.001576458 
iter: 1  value: 4242.651 mgc: 0.003822733 ustep: 1 
iter: 2  value: 4242.651 mgc: 1.32778e-07 ustep: 1 
iter: 3  mgc: 6.27276e-15 
outer mgc:  0.001750536 
iter: 1  value: 4242.639 mgc: 0.003194593 ustep: 1 
iter: 2  value: 4242.639 mgc: 2.559035e-07 ustep: 1 
iter: 3  mgc: 4.218847e-15 
outer mgc:  0.0338012 
iter: 1  value: 4242.655 mgc: 0.00319285 ustep: 1 
iter: 2  value: 4242.655 mgc: 2.554669e-07 ustep: 1 
iter: 3  mgc: 4.662937e-15 
outer mgc:  0.03609969 
[Sun Aug 15 22:50:40 2021]
Finished job 0.
1 of 1 steps (100%) done

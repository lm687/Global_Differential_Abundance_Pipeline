Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:00:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2141.195351 
final  value 1815.338541 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1880.608 mgc: 4.864549 ustep: 0.8994163 
iter: 2  value: 1861.41 mgc: 4.33993 ustep: 0.772724 
iter: 3  value: 1856.975 mgc: 3.791085 ustep: 0.6521695 
iter: 4  value: 1854.96 mgc: 4.131445 ustep: 0.8075894 
iter: 5  value: 1853.451 mgc: 3.519451 ustep: 0.6816079 
iter: 6  value: 1852.014 mgc: 2.733193 ustep: 0.8256129 
iter: 7  value: 1851.947 mgc: 0.5918306 ustep: 0.9086416 
iter: 8  value: 1851.946 mgc: 0.03767465 ustep: 0.9532316 
iter: 9  value: 1851.946 mgc: 0.001094229 ustep: 0.9763382 
iter: 10  value: 1851.946 mgc: 1.982345e-05 ustep: 0.9880995 
iter: 11  value: 1851.946 mgc: 2.238792e-07 ustep: 0.9940325 
iter: 12  mgc: 1.3572e-09 
iter: 1  mgc: 1.3572e-09 
Matching hessian patterns... Done
outer mgc:  13.91221 
iter: 1  value: 1832.189 mgc: 1.13373 ustep: 1 
iter: 2  value: 1832.18 mgc: 0.1214342 ustep: 1 
iter: 3  value: 1832.18 mgc: 0.0009599114 ustep: 1 
iter: 4  value: 1832.18 mgc: 6.314815e-08 ustep: 1 
iter: 5  mgc: 3.885781e-15 
iter: 1  value: 1826.54 mgc: 18.23164 ustep: 1 
iter: 2  value: 1796.943 mgc: 15.95598 ustep: 1 
iter: 3  value: 1796.642 mgc: 1.473731 ustep: 1 
iter: 4  value: 1796.642 mgc: 0.0425702 ustep: 1 
iter: 5  value: 1796.642 mgc: 4.050605e-05 ustep: 1 
iter: 6  mgc: 3.71112e-11 
iter: 1  mgc: 3.71112e-11 
outer mgc:  27.89086 
iter: 1  value: 1902.166 mgc: 40.83004 ustep: 1 
iter: 2  value: 1901.258 mgc: 3.783181 ustep: 1 
iter: 3  value: 1901.258 mgc: 0.05256602 ustep: 1 
iter: 4  value: 1901.258 mgc: 3.663473e-05 ustep: 1 
iter: 5  mgc: 1.622524e-11 
iter: 1  value: 1782.364 mgc: 2.532902 ustep: 1 
iter: 2  value: 1782.363 mgc: 0.05615791 ustep: 1 
iter: 3  value: 1782.363 mgc: 0.0001359158 ustep: 1 
iter: 4  mgc: 1.261079e-09 
iter: 1  mgc: 1.261079e-09 
outer mgc:  14.37099 
iter: 1  value: 1793.72 mgc: 12.03945 ustep: 1 
iter: 2  value: 1790.563 mgc: 4.297525 ustep: 1 
iter: 3  value: 1790.55 mgc: 0.3063426 ustep: 1 
iter: 4  value: 1790.55 mgc: 0.002203055 ustep: 1 
iter: 5  value: 1790.55 mgc: 1.173399e-07 ustep: 1 
iter: 6  mgc: 2.4869e-14 
iter: 1  value: 1779.316 mgc: 4.58703 ustep: 1 
iter: 2  value: 1779.289 mgc: 0.3909325 ustep: 1 
iter: 3  value: 1779.289 mgc: 0.00320755 ustep: 1 
iter: 4  value: 1779.289 mgc: 2.240429e-07 ustep: 1 
iter: 5  mgc: 3.408385e-14 
iter: 1  mgc: 3.408385e-14 
outer mgc:  9.432681 
iter: 1  value: 1776.078 mgc: 3.240075 ustep: 1 
iter: 2  value: 1776.077 mgc: 0.08620565 ustep: 1 
iter: 3  value: 1776.077 mgc: 0.0001212078 ustep: 1 
iter: 4  mgc: 2.389101e-10 
iter: 1  mgc: 2.389101e-10 
outer mgc:  9.908165 
iter: 1  value: 1770.07 mgc: 5.469717 ustep: 1 
iter: 2  value: 1770.042 mgc: 0.4306305 ustep: 1 
iter: 3  value: 1770.042 mgc: 0.002372841 ustep: 1 
iter: 4  value: 1770.042 mgc: 7.302309e-08 ustep: 1 
mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  14.26291 
iter: 1  value: 1763.118 mgc: 7.062886 ustep: 1 
iter: 2  value: 1763.116 mgc: 0.2066941 ustep: 1 
iter: 3  value: 1763.116 mgc: 0.0003000113 ustep: 1 
iter: 4  mgc: 2.53646e-09 
iter: 1  mgc: 2.53646e-09 
outer mgc:  10.05306 
iter: 1  value: 1761.054 mgc: 5.325312 ustep: 1 
iter: 2  value: 1761.047 mgc: 0.2544784 ustep: 1 
iter: 3  value: 1761.047 mgc: 0.0004016375 ustep: 1 
iter: 4  mgc: 4.486322e-09 
iter: 1  mgc: 4.486322e-09 
outer mgc:  11.66209 
iter: 1  value: 1757.056 mgc: 6.796059 ustep: 1 
iter: 2  value: 1757.056 mgc: 0.07076192 ustep: 1 
iter: 3  value: 1757.056 mgc: 5.993838e-05 ustep: 1 
iter: 4  mgc: 8.926815e-11 
iter: 1  mgc: 8.926815e-11 
outer mgc:  4.26229 
iter: 1  value: 1755.584 mgc: 12.34578 ustep: 1 
iter: 2  value: 1755.575 mgc: 0.2360251 ustep: 1 
iter: 3  value: 1755.575 mgc: 0.001005859 ustep: 1 
iter: 4  value: 1755.575 mgc: 1.931948e-08 ustep: 1 
mgc: 2.081688e-13 
iter: 1  value: 1756.034 mgc: 6.552693 ustep: 1 
iter: 2  value: 1756.034 mgc: 0.05234092 ustep: 1 
iter: 3  value: 1756.034 mgc: 4.350094e-05 ustep: 1 
iter: 4  mgc: 4.258349e-11 
iter: 1  mgc: 4.258349e-11 
outer mgc:  10.48106 
iter: 1  value: 1755.067 mgc: 4.668043 ustep: 1 
iter: 2  value: 1755.066 mgc: 0.0745133 ustep: 1 
iter: 3  value: 1755.066 mgc: 2.130476e-05 ustep: 1 
iter: 4  mgc: 1.683098e-12 
iter: 1  mgc: 1.683098e-12 
outer mgc:  7.579825 
iter: 1  value: 1754.092 mgc: 2.630171 ustep: 1 
iter: 2  value: 1754.092 mgc: 0.03477115 ustep: 1 
iter: 3  value: 1754.092 mgc: 5.237628e-06 ustep: 1 
iter: 4  mgc: 2.753353e-13 
iter: 1  mgc: 2.753353e-13 
outer mgc:  1.668006 
iter: 1  value: 1753.24 mgc: 1.437806 ustep: 1 
iter: 2  value: 1753.24 mgc: 0.006645787 ustep: 1 
iter: 3  value: 1753.24 mgc: 1.556282e-07 ustep: 1 
mgc: 2.479822e-13 
iter: 1  mgc: 2.479822e-13 
outer mgc:  3.321658 
iter: 1  value: 1752.392 mgc: 0.8867553 ustep: 1 
iter: 2  value: 1752.392 mgc: 0.002314257 ustep: 1 
iter: 3  value: 1752.392 mgc: 1.557459e-07 ustep: 1 
iter: 4  mgc: 2.349232e-13 
iter: 1  value: 1751.866 mgc: 1.880441 ustep: 1 
iter: 2  value: 1751.866 mgc: 0.009662419 ustep: 1 
iter: 3  value: 1751.866 mgc: 2.501852e-07 ustep: 1 
mgc: 2.287059e-13 
iter: 1  mgc: 2.287059e-13 
outer mgc:  9.947923 
iter: 1  value: 1750.547 mgc: 5.527877 ustep: 1 
iter: 2  value: 1750.546 mgc: 0.09656088 ustep: 1 
iter: 3  value: 1750.546 mgc: 0.000199474 ustep: 1 
iter: 4  mgc: 1.316272e-09 
iter: 1  mgc: 1.316272e-09 
outer mgc:  7.696482 
iter: 1  value: 1751.074 mgc: 2.315496 ustep: 1 
iter: 2  value: 1751.074 mgc: 0.02643335 ustep: 1 
iter: 3  value: 1751.074 mgc: 1.128121e-05 ustep: 1 
iter: 4  mgc: 4.68825e-12 
iter: 1  mgc: 4.68825e-12 
outer mgc:  3.064667 
iter: 1  value: 1749.411 mgc: 2.719417 ustep: 1 
iter: 2  value: 1749.411 mgc: 0.0154826 ustep: 1 
iter: 3  value: 1749.411 mgc: 4.375748e-07 ustep: 1 
iter: 4  mgc: 8.872902e-13 
iter: 1  mgc: 8.872902e-13 
outer mgc:  3.755192 
iter: 1  value: 1748.7 mgc: 10.55313 ustep: 1 
iter: 2  value: 1748.699 mgc: 0.1629153 ustep: 1 
iter: 3  value: 1748.699 mgc: 0.0002759098 ustep: 1 
iter: 4  mgc: 2.575774e-09 
iter: 1  value: 1748.891 mgc: 1.946602 ustep: 1 
iter: 2  value: 1748.891 mgc: 0.008635421 ustep: 1 
iter: 3  value: 1748.891 mgc: 9.479323e-07 ustep: 1 
iter: 4  mgc: 9.836576e-13 
iter: 1  mgc: 9.836576e-13 
outer mgc:  3.67159 
iter: 1  value: 1748.167 mgc: 4.092721 ustep: 1 
iter: 2  value: 1748.167 mgc: 0.02190911 ustep: 1 
iter: 3  value: 1748.167 mgc: 4.121872e-06 ustep: 1 
iter: 4  mgc: 1.499245e-12 
iter: 1  mgc: 1.499245e-12 
outer mgc:  1.147211 
iter: 1  value: 1747.863 mgc: 0.9282716 ustep: 1 
iter: 2  value: 1747.863 mgc: 0.001554912 ustep: 1 
iter: 3  value: 1747.863 mgc: 3.072502e-08 ustep: 1 
mgc: 1.104894e-12 
iter: 1  value: 1747.525 mgc: 0.8657379 ustep: 1 
iter: 2  value: 1747.525 mgc: 0.001957718 ustep: 1 
iter: 3  value: 1747.525 mgc: 3.334803e-08 ustep: 1 
mgc: 9.430234e-13 
iter: 1  mgc: 9.430234e-13 
outer mgc:  0.5921758 
iter: 1  value: 1746.874 mgc: 0.9875394 ustep: 1 
iter: 2  value: 1746.874 mgc: 0.001048498 ustep: 1 
iter: 3  mgc: 1.132586e-09 
iter: 1  value: 1745.463 mgc: 2.856933 ustep: 1 
iter: 2  value: 1745.463 mgc: 0.005569432 ustep: 1 
iter: 3  value: 1745.463 mgc: 2.163968e-08 ustep: 1 
mgc: 3.019807e-12 
iter: 1  mgc: 3.019807e-12 
outer mgc:  0.984353 
iter: 1  value: 1744.519 mgc: 2.725253 ustep: 1 
iter: 2  value: 1744.519 mgc: 0.003107426 ustep: 1 
iter: 3  mgc: 4.988311e-09 
iter: 1  mgc: 4.988311e-09 
outer mgc:  0.6826737 
iter: 1  value: 1743.647 mgc: 1.969209 ustep: 1 
iter: 2  value: 1743.647 mgc: 0.001297856 ustep: 1 
iter: 3  value: 1743.647 mgc: 1.568853e-08 ustep: 1 
mgc: 8.639756e-12 
iter: 1  mgc: 8.639756e-12 
outer mgc:  1.64621 
iter: 1  value: 1742.761 mgc: 2.012205 ustep: 1 
iter: 2  value: 1742.761 mgc: 0.0008243474 ustep: 1 
iter: 3  mgc: 3.618742e-09 
iter: 1  mgc: 3.618742e-09 
outer mgc:  0.5651407 
iter: 1  value: 1741.818 mgc: 1.999337 ustep: 1 
iter: 2  value: 1741.818 mgc: 0.0007553949 ustep: 1 
iter: 3  mgc: 2.72612e-09 
iter: 1  mgc: 2.72612e-09 
outer mgc:  0.4313997 
iter: 1  value: 1740.999 mgc: 1.742585 ustep: 1 
iter: 2  value: 1740.999 mgc: 0.0004003309 ustep: 1 
iter: 3  mgc: 2.278462e-10 
iter: 1  mgc: 2.278462e-10 
outer mgc:  0.1227361 
iter: 1  value: 1739.959 mgc: 2.216043 ustep: 1 
iter: 2  value: 1739.959 mgc: 0.0003416835 ustep: 6.826754e-08 
mgc: 0.0003416703 
iter: 1  value: 1739.959 mgc: 0.0003416703 ustep: 0.2494656 
iter: 2  value: 1739.959 mgc: 7.542647e-06 ustep: 0.0107502 
iter: 3  value: 1739.959 mgc: 5.678607e-06 ustep: 2.085738e-07 
mgc: 5.678634e-06 
outer mgc:  0.06613291 
iter: 1  value: 1739.067 mgc: 1.887778 ustep: 1 
iter: 2  value: 1739.067 mgc: 0.000174596 ustep: 0.0692153 
iter: 3  value: 1739.067 mgc: 1.521104e-05 ustep: 0.0374424 
iter: 4  value: 1739.067 mgc: 6.863885e-06 ustep: 0.193581 
iter: 5  value: 1739.067 mgc: 2.246786e-06 ustep: 7.068948e-05 
mgc: 2.245515e-06 
iter: 1  value: 1739.067 mgc: 2.245515e-06 ustep: 1.365487e-07 
mgc: 2.245587e-06 
outer mgc:  0.05708184 
iter: 1  value: 1738.242 mgc: 1.787956 ustep: 1 
iter: 2  value: 1738.242 mgc: 0.0001098138 ustep: 0.989901 
iter: 3  mgc: 7.267577e-09 
iter: 1  mgc: 7.267577e-09 
outer mgc:  0.03848361 
iter: 1  value: 1737.47 mgc: 1.747518 ustep: 1 
iter: 2  value: 1737.47 mgc: 7.493923e-05 ustep: 1 
iter: 3  mgc: 3.468467e-09 
iter: 1  mgc: 3.468467e-09 
outer mgc:  0.03794396 
iter: 1  value: 1736.807 mgc: 1.412583 ustep: 1 
iter: 2  value: 1736.807 mgc: 3.952795e-05 ustep: 0.6827823 
iter: 3  value: 1736.807 mgc: 9.588163e-08 ustep: 1.300613e-08 
mgc: 9.588144e-08 
iter: 1  value: 1736.807 mgc: 9.588144e-08 ustep: 1.066041e-09 
mgc: 9.432863e-08 
outer mgc:  0.01504612 
iter: 1  value: 1736.319 mgc: 1.037632 ustep: 1 
iter: 2  value: 1736.319 mgc: 1.58381e-05 ustep: 1 
iter: 3  value: 1736.319 mgc: 2.112235e-08 ustep: 0.9999 
mgc: 2.096493e-08 
iter: 1  value: 1736.319 mgc: 2.096493e-08 ustep: 1 
mgc: 1.516544e-08 
outer mgc:  0.01036096 
iter: 1  value: 1736.03 mgc: 0.5872892 ustep: 1 
iter: 2  value: 1736.03 mgc: 5.027001e-06 ustep: 1 
iter: 3  value: 1736.03 mgc: 2.645135e-08 ustep: 0.8994163 
mgc: 4.423934e-08 
iter: 1  value: 1736.03 mgc: 4.423934e-08 ustep: 0.1336527 
mgc: 4.571765e-08 
outer mgc:  0.001790863 
iter: 1  value: 1735.906 mgc: 0.2375113 ustep: 1 
iter: 2  value: 1735.906 mgc: 7.315054e-07 ustep: 4.265015e-09 
mgc: 7.63186e-07 
iter: 1  value: 1735.906 mgc: 7.63186e-07 ustep: 5.32967e-10 
mgc: 7.693382e-07 
outer mgc:  0.0009332309 
iter: 1  value: 1735.888 mgc: 0.03692958 ustep: 1 
iter: 2  value: 1735.888 mgc: 5.616502e-08 ustep: 1 
mgc: 4.702714e-08 
iter: 1  value: 1735.906 mgc: 7.63186e-07 ustep: 5.32967e-10 
mgc: 7.693382e-07 
iter: 1  value: 1735.906 mgc: 7.693382e-07 ustep: 4.265015e-09 
mgc: 7.474327e-07 
outer mgc:  0.0009332594 
iter: 1  value: 1735.907 mgc: 0.03257908 ustep: 1 
iter: 2  value: 1735.907 mgc: 1.78467e-07 ustep: 1 
iter: 3  value: 1735.907 mgc: 6.407528e-08 ustep: 4.371736e-06 
mgc: 6.387558e-08 
outer mgc:  0.2764366 
iter: 1  value: 1735.906 mgc: 0.03255979 ustep: 1 
iter: 2  value: 1735.906 mgc: 2.019393e-07 ustep: 0.989901 
iter: 3  value: 1735.906 mgc: 5.520735e-08 ustep: 0.1521162 
mgc: 4.178474e-08 
outer mgc:  0.2760866 
iter: 1  value: 1735.907 mgc: 0.02109153 ustep: 0.9999 
iter: 2  value: 1735.907 mgc: 7.525151e-08 ustep: 0.99995 
mgc: 5.496791e-08 
outer mgc:  0.1755793 
iter: 1  value: 1735.906 mgc: 0.02108037 ustep: 1 
iter: 2  value: 1735.906 mgc: 1.124079e-07 ustep: 6.997346e-05 
mgc: 1.026921e-07 
outer mgc:  0.1753608 
iter: 1  value: 1735.906 mgc: 0.05333491 ustep: 1 
iter: 2  value: 1735.906 mgc: 4.603951e-06 ustep: 1 
iter: 3  value: 1735.906 mgc: 4.302841e-08 ustep: 0.9999 
mgc: 4.081994e-08 
outer mgc:  0.2376719 
iter: 1  value: 1735.907 mgc: 0.0533367 ustep: 1 
iter: 2  value: 1735.907 mgc: 4.554009e-06 ustep: 0.989901 
iter: 3  value: 1735.907 mgc: 1.024758e-07 ustep: 0.9949382 
mgc: 4.089225e-08 
outer mgc:  0.2379843 
iter: 1  value: 1735.906 mgc: 0.02741591 ustep: 1 
iter: 2  value: 1735.906 mgc: 8.156768e-07 ustep: 0.989901 
iter: 3  value: 1735.906 mgc: 4.054996e-08 ustep: 0.1521162 
mgc: 4.275664e-08 
outer mgc:  0.1868422 
iter: 1  value: 1735.906 mgc: 0.02741814 ustep: 1 
iter: 2  value: 1735.906 mgc: 8.600321e-07 ustep: 0.989901 
iter: 3  value: 1735.906 mgc: 4.567918e-08 ustep: 0.9949382 
mgc: 3.295057e-08 
outer mgc:  0.1865418 
iter: 1  value: 1735.915 mgc: 0.8284971 ustep: 1 
iter: 2  value: 1735.915 mgc: 1.017607e-05 ustep: 1 
iter: 3  value: 1735.915 mgc: 4.322394e-08 ustep: 3.413036e-08 
mgc: 4.849982e-08 
outer mgc:  0.09501051 
iter: 1  value: 1735.897 mgc: 0.8309941 ustep: 1 
iter: 2  value: 1735.897 mgc: 1.016396e-05 ustep: 1 
iter: 3  value: 1735.897 mgc: 4.664277e-08 ustep: 0.989901 
mgc: 2.804621e-08 
outer mgc:  0.09652978 
iter: 1  value: 1735.908 mgc: 0.83684 ustep: 1 
iter: 2  value: 1735.908 mgc: 1.056256e-05 ustep: 0.9999 
iter: 3  value: 1735.908 mgc: 6.373306e-08 ustep: 0.99995 
mgc: 2.742264e-08 
outer mgc:  0.1105649 
iter: 1  value: 1735.905 mgc: 0.837677 ustep: 1 
iter: 2  value: 1735.905 mgc: 1.05928e-05 ustep: 1 
iter: 3  value: 1735.905 mgc: 3.671282e-08 ustep: 0.8994163 
mgc: 4.391309e-08 
outer mgc:  0.1088639 
iter: 1  value: 1735.906 mgc: 0.001159202 ustep: 5.199558e-13 
mgc: 0.001159213 
outer mgc:  0.0009001857 
iter: 1  value: 1735.907 mgc: 0.00116067 ustep: 1.092717e-06 
mgc: 0.001158961 
outer mgc:  0.0009663249 
iter: 1  value: 1735.906 mgc: 7.841203e-07 ustep: 1 
iter: 2  value: 1735.906 mgc: 3.152291e-08 ustep: 0.8994163 
mgc: 3.757501e-08 
outer mgc:  0.0009332077 
iter: 1  value: 1735.906 mgc: 7.373e-07 ustep: 0.989901 
iter: 2  value: 1735.906 mgc: 4.478696e-08 ustep: 0.02040899 
mgc: 5.389812e-08 
outer mgc:  0.0009331779 
[Sun Aug 15 00:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

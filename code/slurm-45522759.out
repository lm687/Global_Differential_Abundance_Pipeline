Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:27:33 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21916.216547 
final  value 21569.607944 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 20593.45 mgc: 2.966096 ustep: 0.6827823 
iter: 2  value: 20588.67 mgc: 0.9085143 ustep: 0.8263238 
iter: 3  value: 20588.59 mgc: 0.1225907 ustep: 0.9090326 
iter: 4  value: 20588.59 mgc: 0.006043053 ustep: 0.9534367 
iter: 5  value: 20588.59 mgc: 0.0002214028 ustep: 0.9764432 
iter: 6  value: 20588.59 mgc: 4.22001e-06 ustep: 0.9881526 
iter: 7  value: 20588.59 mgc: 4.777685e-08 ustep: 0.9940592 
iter: 8  mgc: 2.783832e-10 
iter: 1  mgc: 2.783832e-10 
Matching hessian patterns... Done
outer mgc:  127.4686 
iter: 1  value: 20379.09 mgc: 0.7819639 ustep: 1 
iter: 2  value: 20379.09 mgc: 0.0388598 ustep: 1 
iter: 3  value: 20379.09 mgc: 9.646551e-05 ustep: 1 
iter: 4  mgc: 1.292037e-09 
iter: 1  value: 20199.26 mgc: 5.987462 ustep: 1 
iter: 2  value: 20199.23 mgc: 0.4845036 ustep: 1 
iter: 3  value: 20199.23 mgc: 0.002314991 ustep: 1 
iter: 4  value: 20199.23 mgc: 5.027115e-08 ustep: 1 
mgc: 1.371125e-14 
iter: 1  mgc: 1.371125e-14 
outer mgc:  273.0333 
iter: 1  value: 23331.22 mgc: 93.80917 ustep: 1 
iter: 2  value: 23325.36 mgc: 2.519633 ustep: 0.6827823 
iter: 3  value: 23324.02 mgc: 3.75978 ustep: 0.5831969 
iter: 4  value: 23323.84 mgc: 0.8558645 ustep: 0.7636969 
iter: 5  value: 23323.81 mgc: 0.1181417 ustep: 0.6448442 
iter: 6  value: 23323.75 mgc: 0.1586223 ustep: 0.5561444 
iter: 7  value: 23323.65 mgc: 0.2317023 ustep: 0.4957445 
iter: 8  value: 23323.52 mgc: 0.3198078 ustep: 0.4560066 
iter: 9  value: 23323.33 mgc: 0.3587703 ustep: 0.6753151 
iter: 10  value: 23323.32 mgc: 0.8915087 ustep: 0.8217934 
iter: 11  value: 23323.32 mgc: 0.02923334 ustep: 0.9065376 
iter: 12  value: 23323.32 mgc: 0.002392545 ustep: 0.9521274 
iter: 13  value: 23323.32 mgc: 9.087354e-05 ustep: 0.9757726 
iter: 14  value: 23323.32 mgc: 1.759999e-06 ustep: 0.9878132 
iter: 15  value: 23323.32 mgc: 1.733677e-08 ustep: 0.9938886 
iter: 16  mgc: 8.568435e-11 
iter: 1  value: 20120.83 mgc: 5.666941 ustep: 1 
iter: 2  value: 20120.75 mgc: 0.2013704 ustep: 1 
iter: 3  value: 20120.75 mgc: 0.0008092041 ustep: 1 
iter: 4  value: 20120.75 mgc: 1.373323e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  mgc: 1.598721e-14 
outer mgc:  91.8413 
iter: 1  value: 20099.49 mgc: 2.066573 ustep: 1 
iter: 2  value: 20099.49 mgc: 0.02279269 ustep: 1 
iter: 3  value: 20099.49 mgc: 6.388212e-06 ustep: 1 
iter: 4  mgc: 7.289724e-13 
iter: 1  mgc: 7.289724e-13 
outer mgc:  42.93686 
iter: 1  value: 20084.4 mgc: 3.781558 ustep: 1 
iter: 2  value: 20084.39 mgc: 0.1284572 ustep: 1 
iter: 3  value: 20084.39 mgc: 0.0001405607 ustep: 1 
iter: 4  mgc: 1.926184e-10 
iter: 1  mgc: 1.926184e-10 
outer mgc:  67.91051 
iter: 1  value: 20060.87 mgc: 14.89909 ustep: 1 
iter: 2  value: 20060.86 mgc: 0.2152842 ustep: 1 
iter: 3  value: 20060.86 mgc: 0.0002589359 ustep: 1 
iter: 4  mgc: 1.075931e-09 
iter: 1  value: 20065.63 mgc: 4.812603 ustep: 1 
iter: 2  value: 20065.63 mgc: 0.05201616 ustep: 1 
iter: 3  value: 20065.63 mgc: 2.794694e-05 ustep: 1 
iter: 4  mgc: 9.721779e-12 
iter: 1  mgc: 9.721779e-12 
outer mgc:  36.24391 
iter: 1  value: 20035.54 mgc: 2.167818 ustep: 1 
iter: 2  value: 20035.54 mgc: 0.01469782 ustep: 1 
iter: 3  value: 20035.54 mgc: 3.080903e-06 ustep: 1 
iter: 4  mgc: 1.299794e-13 
iter: 1  mgc: 1.299794e-13 
outer mgc:  17.65062 
iter: 1  value: 20020.17 mgc: 2.947307 ustep: 1 
iter: 2  value: 20020.17 mgc: 0.06321278 ustep: 1 
iter: 3  value: 20020.17 mgc: 4.766289e-06 ustep: 1 
iter: 4  mgc: 1.416089e-13 
iter: 1  mgc: 1.416089e-13 
outer mgc:  11.25497 
iter: 1  value: 20010.55 mgc: 1.90035 ustep: 1 
iter: 2  value: 20010.55 mgc: 0.0039307 ustep: 1 
iter: 3  value: 20010.55 mgc: 1.201022e-07 ustep: 1 
mgc: 8.965051e-15 
iter: 1  value: 20015.84 mgc: 0.3733849 ustep: 1 
iter: 2  value: 20015.84 mgc: 0.0001851714 ustep: 1 
iter: 3  mgc: 4.14611e-10 
iter: 1  mgc: 4.14611e-10 
outer mgc:  15.85931 
iter: 1  value: 20011.6 mgc: 0.5526415 ustep: 1 
iter: 2  value: 20011.6 mgc: 0.001312707 ustep: 1 
iter: 3  mgc: 4.141332e-09 
iter: 1  mgc: 4.141332e-09 
outer mgc:  14.35101 
iter: 1  value: 20005.9 mgc: 1.602983 ustep: 1 
iter: 2  value: 20005.9 mgc: 0.00103605 ustep: 1 
iter: 3  value: 20005.9 mgc: 1.051303e-08 ustep: 1 
mgc: 5.884182e-15 
iter: 1  mgc: 5.884182e-15 
outer mgc:  3.521212 
iter: 1  value: 19988.48 mgc: 2.037999 ustep: 1 
iter: 2  value: 19988.48 mgc: 0.003652151 ustep: 1 
iter: 3  value: 19988.48 mgc: 2.454554e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  7.993541 
iter: 1  value: 19972.25 mgc: 1.523586 ustep: 1 
iter: 2  value: 19972.25 mgc: 0.005901395 ustep: 1 
iter: 3  value: 19972.25 mgc: 9.636562e-08 ustep: 1 
iter: 4  mgc: 6.883383e-15 
iter: 1  value: 19980.98 mgc: 0.7247496 ustep: 1 
iter: 2  value: 19980.98 mgc: 0.001142625 ustep: 1 
iter: 3  mgc: 5.989859e-09 
iter: 1  mgc: 5.989859e-09 
outer mgc:  6.099648 
iter: 1  value: 19977.64 mgc: 0.8517933 ustep: 1 
iter: 2  value: 19977.64 mgc: 0.001150031 ustep: 1 
iter: 3  mgc: 4.369695e-09 
iter: 1  mgc: 4.369695e-09 
outer mgc:  3.746922 
iter: 1  value: 19972.09 mgc: 0.4858505 ustep: 1 
iter: 2  value: 19972.09 mgc: 0.001447295 ustep: 1 
iter: 3  mgc: 4.693264e-10 
iter: 1  mgc: 4.693264e-10 
outer mgc:  8.418366 
iter: 1  value: 19969.67 mgc: 0.4167574 ustep: 1 
iter: 2  value: 19969.67 mgc: 0.0002424177 ustep: 1 
iter: 3  mgc: 2.09428e-10 
iter: 1  mgc: 2.09428e-10 
outer mgc:  8.329388 
iter: 1  value: 19966.36 mgc: 0.9308137 ustep: 1 
iter: 2  value: 19966.36 mgc: 0.0001467623 ustep: 1 
iter: 3  mgc: 1.701936e-10 
iter: 1  mgc: 1.701936e-10 
outer mgc:  1.255474 
iter: 1  value: 19962.84 mgc: 0.8648253 ustep: 1 
iter: 2  value: 19962.84 mgc: 0.0001424889 ustep: 1 
iter: 3  mgc: 2.295506e-10 
iter: 1  mgc: 2.295506e-10 
outer mgc:  1.750671 
iter: 1  value: 19955 mgc: 0.7327472 ustep: 1 
iter: 2  value: 19955 mgc: 0.0005152153 ustep: 1 
iter: 3  mgc: 7.01097e-10 
iter: 1  mgc: 7.01097e-10 
outer mgc:  1.653289 
iter: 1  value: 19945.21 mgc: 2.068838 ustep: 1 
iter: 2  value: 19945.21 mgc: 0.0003868803 ustep: 1 
iter: 3  mgc: 1.088279e-09 
iter: 1  mgc: 1.088279e-09 
outer mgc:  2.128305 
iter: 1  value: 19932.65 mgc: 2.431027 ustep: 1 
iter: 2  value: 19932.65 mgc: 0.0004867751 ustep: 1 
iter: 3  mgc: 3.609143e-09 
iter: 1  mgc: 3.609143e-09 
outer mgc:  2.311806 
iter: 1  value: 19923.05 mgc: 0.9902498 ustep: 1 
iter: 2  value: 19923.05 mgc: 0.0006539964 ustep: 1 
iter: 3  mgc: 8.409202e-10 
iter: 1  mgc: 8.409202e-10 
outer mgc:  1.878709 
iter: 1  value: 19915.53 mgc: 2.104093 ustep: 1 
iter: 2  value: 19915.53 mgc: 0.000707338 ustep: 1 
iter: 3  mgc: 1.53705e-09 
iter: 1  mgc: 1.53705e-09 
outer mgc:  1.619053 
iter: 1  value: 19910.48 mgc: 1.535378 ustep: 1 
iter: 2  value: 19910.48 mgc: 0.0001750622 ustep: 1 
iter: 3  mgc: 1.273081e-10 
iter: 1  mgc: 1.273081e-10 
outer mgc:  2.681867 
iter: 1  value: 19906.96 mgc: 0.7050188 ustep: 1 
iter: 2  value: 19906.96 mgc: 0.0001448492 ustep: 1 
iter: 3  mgc: 4.172218e-11 
iter: 1  mgc: 4.172218e-11 
outer mgc:  0.3951176 
iter: 1  value: 19902.94 mgc: 0.5068156 ustep: 1 
iter: 2  value: 19902.94 mgc: 6.097542e-06 ustep: 1 
iter: 3  mgc: 1.527667e-13 
iter: 1  mgc: 1.527667e-13 
outer mgc:  0.3314116 
iter: 1  value: 19888.28 mgc: 2.214203 ustep: 1 
iter: 2  value: 19888.28 mgc: 6.533969e-05 ustep: 1 
iter: 3  mgc: 2.686473e-11 
iter: 1  mgc: 2.686473e-11 
outer mgc:  0.4728955 
iter: 1  value: 19874.62 mgc: 1.90153 ustep: 1 
iter: 2  value: 19874.62 mgc: 3.049456e-05 ustep: 1 
iter: 3  mgc: 5.877077e-12 
iter: 1  mgc: 5.877077e-12 
outer mgc:  0.2451797 
iter: 1  value: 19855.71 mgc: 2.470843 ustep: 1 
iter: 2  value: 19855.71 mgc: 1.980686e-05 ustep: 1 
iter: 3  mgc: 2.547296e-12 
iter: 1  mgc: 2.547296e-12 
outer mgc:  0.1083472 
iter: 1  value: 19839.37 mgc: 2.017195 ustep: 1 
iter: 2  value: 19839.37 mgc: 7.092433e-06 ustep: 1 
iter: 3  mgc: 1.110223e-13 
iter: 1  mgc: 1.110223e-13 
outer mgc:  0.08656332 
iter: 1  value: 19819.13 mgc: 2.575243 ustep: 1 
iter: 2  value: 19819.13 mgc: 5.181547e-06 ustep: 1 
iter: 3  mgc: 9.092727e-14 
iter: 1  mgc: 9.092727e-14 
outer mgc:  0.04706511 
iter: 1  value: 19802.41 mgc: 2.080937 ustep: 1 
iter: 2  value: 19802.41 mgc: 1.706489e-06 ustep: 1 
iter: 3  mgc: 1.219025e-13 
iter: 1  mgc: 1.219025e-13 
outer mgc:  0.01600805 
iter: 1  value: 19782.12 mgc: 2.659641 ustep: 1 
iter: 2  value: 19782.12 mgc: 1.216618e-06 ustep: 1 
iter: 3  mgc: 2.347011e-13 
iter: 1  mgc: 2.347011e-13 
outer mgc:  0.02121887 
iter: 1  value: 19765.29 mgc: 2.165487 ustep: 1 
iter: 2  value: 19765.29 mgc: 4.054454e-07 ustep: 1 
iter: 3  mgc: 1.834088e-13 
iter: 1  mgc: 1.834088e-13 
outer mgc:  0.01595096 
iter: 1  value: 19744.65 mgc: 2.75875 ustep: 1 
iter: 2  value: 19744.65 mgc: 2.902266e-07 ustep: 1 
iter: 3  mgc: 3.506084e-13 
iter: 1  mgc: 3.506084e-13 
outer mgc:  0.01036571 
iter: 1  value: 19727.52 mgc: 2.193071 ustep: 1 
iter: 2  value: 19727.52 mgc: 9.062828e-08 ustep: 1 
iter: 3  mgc: 5.684342e-13 
iter: 1  mgc: 5.684342e-13 
outer mgc:  0.008048743 
iter: 1  value: 19706.68 mgc: 2.73216 ustep: 1 
iter: 2  value: 19706.68 mgc: 6.326604e-08 ustep: 1 
mgc: 8.328893e-13 
iter: 1  mgc: 8.328893e-13 
outer mgc:  0.005771105 
iter: 1  value: 19689.44 mgc: 2.17385 ustep: 1 
iter: 2  value: 19689.44 mgc: 1.999907e-08 ustep: 1 
mgc: 1.101619e-12 
iter: 1  mgc: 1.101619e-12 
outer mgc:  0.0031139 
iter: 1  value: 19668.52 mgc: 2.734564 ustep: 1 
iter: 2  value: 19668.52 mgc: 1.382055e-08 ustep: 1 
mgc: 1.932676e-12 
iter: 1  mgc: 1.932676e-12 
outer mgc:  0.001802988 
iter: 1  value: 19651.24 mgc: 2.206524 ustep: 1 
iter: 2  mgc: 4.365119e-09 
iter: 1  mgc: 4.365119e-09 
outer mgc:  0.0009835035 
iter: 1  value: 19630.3 mgc: 2.784117 ustep: 1 
iter: 2  mgc: 3.016168e-09 
iter: 1  mgc: 3.016168e-09 
outer mgc:  0.0009128791 
iter: 1  value: 19613 mgc: 2.227589 ustep: 1 
iter: 2  mgc: 9.493486e-10 
iter: 1  mgc: 9.493486e-10 
outer mgc:  0.000663744 
iter: 1  value: 19592.04 mgc: 2.775831 ustep: 1 
iter: 2  mgc: 6.530039e-10 
iter: 1  mgc: 6.530039e-10 
outer mgc:  0.0005681849 
iter: 1  value: 19574.72 mgc: 2.204275 ustep: 1 
iter: 2  mgc: 2.04925e-10 
iter: 1  mgc: 2.04925e-10 
outer mgc:  0.0003463292 
iter: 1  value: 19553.75 mgc: 2.748516 ustep: 1 
iter: 2  mgc: 1.419149e-10 
iter: 1  mgc: 1.419149e-10 
outer mgc:  0.0002282836 
iter: 1  value: 19536.43 mgc: 2.203677 ustep: 1 
iter: 2  mgc: 4.159961e-11 
iter: 1  mgc: 4.159961e-11 
outer mgc:  0.0001208981 
iter: 1  mgc: 4.159961e-11 
iter: 1  mgc: 4.159961e-11 
outer mgc:  0.0001208981 
iter: 1  value: 19536.42 mgc: 0.005730514 ustep: 1 
iter: 2  value: 19536.42 mgc: 9.632286e-08 ustep: 1 
mgc: 2.022477e-11 
outer mgc:  0.3644214 
iter: 1  value: 19536.43 mgc: 0.00572833 ustep: 1 
iter: 2  value: 19536.43 mgc: 9.629499e-08 ustep: 1 
mgc: 2.379696e-11 
outer mgc:  0.3642257 
iter: 1  value: 19536.42 mgc: 0.003385977 ustep: 1 
iter: 2  value: 19536.42 mgc: 4.165821e-08 ustep: 1 
mgc: 2.464406e-11 
outer mgc:  0.2175435 
iter: 1  value: 19536.43 mgc: 0.003385762 ustep: 1 
iter: 2  value: 19536.43 mgc: 4.164521e-08 ustep: 1 
mgc: 1.993383e-11 
outer mgc:  0.2174635 
iter: 1  value: 19536.43 mgc: 0.006249307 ustep: 1 
iter: 2  mgc: 8.410037e-09 
outer mgc:  0.4780036 
iter: 1  value: 19536.42 mgc: 0.006248692 ustep: 1 
iter: 2  mgc: 8.366718e-09 
outer mgc:  0.4778498 
iter: 1  value: 19536.43 mgc: 0.003553876 ustep: 1 
iter: 2  mgc: 2.52837e-09 
outer mgc:  0.2170305 
iter: 1  value: 19536.42 mgc: 0.003553731 ustep: 1 
iter: 2  mgc: 2.51613e-09 
outer mgc:  0.2169001 
iter: 1  value: 19536.5 mgc: 117.1949 ustep: 1 
iter: 2  value: 19536.5 mgc: 7.882351e-07 ustep: 1 
iter: 3  mgc: 2.250408e-11 
outer mgc:  0.02025721 
iter: 1  value: 19536.35 mgc: 117.3121 ustep: 1 
iter: 2  value: 19536.35 mgc: 7.868753e-07 ustep: 1 
iter: 3  mgc: 3.479439e-11 
outer mgc:  0.02000955 
iter: 1  value: 19536.52 mgc: 117.0796 ustep: 1 
iter: 2  value: 19536.52 mgc: 9.886548e-08 ustep: 1 
iter: 3  mgc: 2.723244e-11 
outer mgc:  0.004561581 
iter: 1  value: 19536.33 mgc: 117.4313 ustep: 1 
iter: 2  value: 19536.33 mgc: 9.872926e-08 ustep: 1 
iter: 3  mgc: 1.751044e-11 
outer mgc:  0.004636754 
iter: 1  value: 19536.42 mgc: 9.652468e-05 ustep: 1 
mgc: 2.328523e-11 
outer mgc:  0.0001208904 
iter: 1  value: 19536.43 mgc: 9.65238e-05 ustep: 1 
mgc: 3.364534e-11 
outer mgc:  0.0001209058 
iter: 1  value: 19536.42 mgc: 0.004408441 ustep: 1 
iter: 2  value: 19536.42 mgc: 9.916073e-08 ustep: 1 
mgc: 2.173439e-11 
outer mgc:  0.1572721 
iter: 1  value: 19536.44 mgc: 0.004405113 ustep: 1 
iter: 2  value: 19536.44 mgc: 9.897831e-08 ustep: 1 
mgc: 2.17657e-11 
outer mgc:  0.1574722 
[Fri Aug 13 12:27:40 2021]
Finished job 0.
1 of 1 steps (100%) done

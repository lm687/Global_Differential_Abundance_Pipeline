Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 06:42:15 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4321.940744 
iter  10 value 2548.254377
final  value 2548.253866 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2343.215 mgc: 143.0058 ustep: 1 
iter: 2  value: 2321.213 mgc: 54.58596 ustep: 0.2494656 
iter: 3  value: 1630.377 mgc: 110.4976 ustep: 0.4995153 
iter: 4  value: 1606.562 mgc: 16.46258 ustep: 0.7067933 
iter: 5  value: 1603.35 mgc: 11.42163 ustep: 0.8407259 
iter: 6  value: 1603.26 mgc: 1.303404 ustep: 0.9169194 
iter: 7  value: 1603.259 mgc: 0.06793924 ustep: 0.9575633 
iter: 8  value: 1603.259 mgc: 0.0008895988 ustep: 0.9785538 
iter: 9  value: 1603.259 mgc: 4.744704e-06 ustep: 0.9892199 
iter: 10  value: 1603.259 mgc: 1.525397e-08 ustep: 0.9945959 
mgc: 2.384801e-11 
iter: 1  mgc: 2.384801e-11 
Matching hessian patterns... Done
outer mgc:  576.3981 
iter: 1  value: 1107.703 mgc: 31.61251 ustep: 1 
iter: 2  value: 1096.757 mgc: 6.91429 ustep: 1 
iter: 3  value: 1096.685 mgc: 0.5979788 ustep: 1 
iter: 4  value: 1096.685 mgc: 0.008631733 ustep: 1 
iter: 5  value: 1096.685 mgc: 2.05202e-06 ustep: 1 
iter: 6  mgc: 2.83551e-13 
iter: 1  value: 784.4706 mgc: 57.36252 ustep: 1 
iter: 2  value: 500.0178 mgc: 40.23792 ustep: 1 
iter: 3  value: 486.5367 mgc: 6.862602 ustep: 1 
iter: 4  value: 486.2927 mgc: 0.9998303 ustep: 1 
iter: 5  value: 486.2922 mgc: 0.06239026 ustep: 1 
iter: 6  value: 486.2922 mgc: 0.0002943629 ustep: 1 
iter: 7  mgc: 6.650108e-09 
iter: 1  mgc: 6.650108e-09 
outer mgc:  61.33138 
iter: 1  value: 358.116 mgc: 31.47405 ustep: 1 
iter: 2  value: 357.4059 mgc: 1.698036 ustep: 1 
iter: 3  value: 357.4057 mgc: 0.03064177 ustep: 1 
iter: 4  value: 357.4057 mgc: 3.715811e-05 ustep: 1 
iter: 5  mgc: 9.533752e-11 
iter: 1  mgc: 9.533752e-11 
outer mgc:  46.95315 
iter: 1  value: 992.8643 mgc: 63.76217 ustep: 0.1336527 
iter: 2  value: 487.7569 mgc: 98.82293 ustep: 0.3656489 
iter: 3  value: 464.2941 mgc: 28.61058 ustep: 0.6047286 
iter: 4  value: 463.7884 mgc: 5.528488 ustep: 0.7776652 
iter: 5  value: 463.788 mgc: 0.1091662 ustep: 0.8818651 
iter: 6  value: 463.788 mgc: 0.0004573628 ustep: 0.9390828 
iter: 7  value: 463.788 mgc: 5.285218e-06 ustep: 0.969066 
iter: 8  value: 463.788 mgc: 3.878782e-08 ustep: 0.984413 
iter: 9  mgc: 1.441522e-10 
iter: 1  value: 342.897 mgc: 10.09143 ustep: 1 
iter: 2  value: 342.7118 mgc: 1.107036 ustep: 1 
iter: 3  value: 342.7118 mgc: 0.01642654 ustep: 1 
iter: 4  value: 342.7118 mgc: 6.669667e-06 ustep: 1 
iter: 5  mgc: 1.101688e-12 
iter: 1  mgc: 1.101688e-12 
outer mgc:  48.36419 
iter: 1  value: 413.665 mgc: 38.83429 ustep: 1 
iter: 2  value: 332.6548 mgc: 23.7925 ustep: 1 
iter: 3  value: 330.8823 mgc: 2.964264 ustep: 1 
iter: 4  value: 330.8787 mgc: 0.1568713 ustep: 1 
iter: 5  value: 330.8787 mgc: 0.0006207632 ustep: 1 
iter: 6  mgc: 9.830078e-09 
iter: 1  mgc: 9.830078e-09 
outer mgc:  20.40734 
iter: 1  value: 321.0666 mgc: 16.07353 ustep: 1 
iter: 2  value: 320.6088 mgc: 1.953078 ustep: 1 
iter: 3  value: 320.6087 mgc: 0.0267579 ustep: 1 
iter: 4  value: 320.6087 mgc: 6.507818e-06 ustep: 1 
iter: 5  mgc: 7.454683e-12 
iter: 1  mgc: 7.454683e-12 
outer mgc:  16.21164 
iter: 1  value: 331.9757 mgc: 16.56384 ustep: 1 
iter: 2  value: 331.5892 mgc: 1.761151 ustep: 1 
iter: 3  value: 331.5885 mgc: 0.1003831 ustep: 1 
iter: 4  value: 331.5885 mgc: 0.0003583189 ustep: 1 
iter: 5  mgc: 4.591837e-09 
iter: 1  value: 316.2265 mgc: 4.0295 ustep: 1 
iter: 2  value: 316.2248 mgc: 0.06749334 ustep: 1 
iter: 3  value: 316.2248 mgc: 0.0005023066 ustep: 1 
iter: 4  value: 316.2248 mgc: 4.269611e-08 ustep: 1 
iter: 5  mgc: 1.876277e-14 
iter: 1  mgc: 1.876277e-14 
outer mgc:  5.556969 
iter: 1  value: 313.3206 mgc: 7.896923 ustep: 1 
iter: 2  value: 313.3 mgc: 0.3141131 ustep: 1 
iter: 3  value: 313.3 mgc: 0.001227701 ustep: 1 
iter: 4  value: 313.3 mgc: 2.891337e-08 ustep: 1 
mgc: 2.420286e-14 
iter: 1  mgc: 2.420286e-14 
outer mgc:  8.465354 
iter: 1  value: 311.5869 mgc: 7.596583 ustep: 1 
iter: 2  value: 311.5744 mgc: 0.3423948 ustep: 1 
iter: 3  value: 311.5744 mgc: 0.001711424 ustep: 1 
iter: 4  value: 311.5744 mgc: 4.346141e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  13.8583 
iter: 1  value: 310.0173 mgc: 7.949634 ustep: 1 
iter: 2  value: 310.0083 mgc: 0.1709942 ustep: 1 
iter: 3  value: 310.0083 mgc: 0.0003729971 ustep: 1 
iter: 4  mgc: 3.135584e-09 
iter: 1  mgc: 3.135584e-09 
outer mgc:  6.456799 
iter: 1  value: 311.0636 mgc: 12.95007 ustep: 1 
iter: 2  value: 310.9439 mgc: 0.7601191 ustep: 1 
iter: 3  value: 310.9439 mgc: 0.00697245 ustep: 1 
iter: 4  value: 310.9439 mgc: 1.039445e-06 ustep: 1 
iter: 5  mgc: 5.417888e-14 
iter: 1  value: 309.4072 mgc: 5.317846 ustep: 1 
iter: 2  value: 309.4048 mgc: 0.1189115 ustep: 1 
iter: 3  value: 309.4048 mgc: 0.0001557905 ustep: 1 
iter: 4  mgc: 3.898872e-10 
iter: 1  mgc: 3.898872e-10 
outer mgc:  4.010758 
iter: 1  value: 309.2926 mgc: 2.847589 ustep: 1 
iter: 2  value: 309.2926 mgc: 0.01913394 ustep: 1 
iter: 3  value: 309.2926 mgc: 3.451062e-06 ustep: 1 
iter: 4  mgc: 4.583001e-13 
iter: 1  mgc: 4.583001e-13 
outer mgc:  2.009414 
iter: 1  value: 308.8211 mgc: 1.46232 ustep: 1 
iter: 2  value: 308.821 mgc: 0.01626751 ustep: 1 
iter: 3  value: 308.821 mgc: 4.741637e-06 ustep: 1 
iter: 4  mgc: 7.494005e-13 
iter: 1  mgc: 7.494005e-13 
outer mgc:  3.104843 
iter: 1  value: 308.5428 mgc: 2.07226 ustep: 1 
iter: 2  value: 308.5427 mgc: 0.0250643 ustep: 1 
iter: 3  value: 308.5427 mgc: 9.044323e-06 ustep: 1 
iter: 4  mgc: 1.178169e-12 
iter: 1  mgc: 1.178169e-12 
outer mgc:  0.8291935 
iter: 1  value: 308.787 mgc: 1.614754 ustep: 1 
iter: 2  value: 308.787 mgc: 0.006325884 ustep: 1 
iter: 3  value: 308.787 mgc: 2.040079e-06 ustep: 1 
iter: 4  mgc: 2.88658e-13 
iter: 1  value: 308.7532 mgc: 1.455994 ustep: 1 
iter: 2  value: 308.7532 mgc: 0.006761977 ustep: 1 
iter: 3  value: 308.7532 mgc: 5.137853e-07 ustep: 1 
iter: 4  mgc: 3.558265e-14 
iter: 1  value: 308.5846 mgc: 0.5078535 ustep: 1 
iter: 2  value: 308.5846 mgc: 0.0008176485 ustep: 1 
iter: 3  mgc: 5.832185e-09 
iter: 1  mgc: 5.832185e-09 
outer mgc:  0.4943838 
iter: 1  value: 308.5759 mgc: 0.3960316 ustep: 1 
iter: 2  value: 308.5759 mgc: 0.000786327 ustep: 1 
iter: 3  mgc: 6.667221e-09 
iter: 1  mgc: 6.667221e-09 
outer mgc:  0.5249268 
iter: 1  value: 308.5975 mgc: 0.3769066 ustep: 1 
iter: 2  value: 308.5975 mgc: 0.0002185915 ustep: 1 
iter: 3  mgc: 5.345644e-10 
iter: 1  mgc: 5.345644e-10 
outer mgc:  0.3451784 
iter: 1  value: 308.5699 mgc: 0.2148713 ustep: 1 
iter: 2  value: 308.5699 mgc: 0.0002711467 ustep: 1 
iter: 3  mgc: 1.074314e-09 
iter: 1  value: 308.5671 mgc: 0.1321951 ustep: 1 
iter: 2  value: 308.5671 mgc: 5.624948e-05 ustep: 1 
iter: 3  mgc: 4.102163e-11 
iter: 1  value: 308.5403 mgc: 0.139576 ustep: 1 
iter: 2  value: 308.5403 mgc: 0.0002014669 ustep: 1 
iter: 3  mgc: 5.837943e-10 
iter: 1  mgc: 5.837943e-10 
outer mgc:  0.2666543 
iter: 1  value: 308.391 mgc: 1.411661 ustep: 1 
iter: 2  value: 308.391 mgc: 0.01911579 ustep: 1 
iter: 3  value: 308.391 mgc: 5.138408e-06 ustep: 1 
iter: 4  mgc: 3.83249e-13 
iter: 1  value: 308.4722 mgc: 0.5571604 ustep: 1 
iter: 2  value: 308.4722 mgc: 0.002932963 ustep: 1 
iter: 3  value: 308.4722 mgc: 1.224424e-07 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.1714396 
iter: 1  value: 308.4676 mgc: 0.2826997 ustep: 1 
iter: 2  value: 308.4676 mgc: 0.0003293192 ustep: 1 
iter: 3  mgc: 7.606609e-10 
iter: 1  value: 308.4748 mgc: 0.02485022 ustep: 1 
iter: 2  value: 308.4748 mgc: 1.27364e-05 ustep: 1 
iter: 3  mgc: 1.0421e-11 
iter: 1  mgc: 1.0421e-11 
outer mgc:  0.07432363 
iter: 1  value: 308.4817 mgc: 0.01002551 ustep: 1 
iter: 2  value: 308.4817 mgc: 5.831941e-06 ustep: 1 
iter: 3  mgc: 2.174483e-12 
iter: 1  mgc: 2.174483e-12 
outer mgc:  0.04574308 
iter: 1  value: 308.4803 mgc: 0.02164819 ustep: 1 
iter: 2  value: 308.4803 mgc: 2.911139e-06 ustep: 1 
iter: 3  mgc: 1.231237e-13 
iter: 1  mgc: 1.231237e-13 
outer mgc:  0.0102454 
iter: 1  value: 308.4765 mgc: 0.03296796 ustep: 1 
iter: 2  value: 308.4765 mgc: 8.399972e-06 ustep: 1 
iter: 3  mgc: 9.823253e-13 
iter: 1  mgc: 9.823253e-13 
outer mgc:  0.02967238 
iter: 1  value: 308.4763 mgc: 0.0149279 ustep: 1 
iter: 2  value: 308.4763 mgc: 4.396e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  0.008051175 
iter: 1  value: 308.4772 mgc: 0.004400855 ustep: 1 
iter: 2  value: 308.4772 mgc: 2.502621e-08 ustep: 1 
mgc: 3.413936e-14 
iter: 1  mgc: 3.413936e-14 
outer mgc:  0.001328981 
iter: 1  value: 308.4769 mgc: 0.00389732 ustep: 1 
iter: 2  value: 308.4769 mgc: 1.605711e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  value: 308.4771 mgc: 0.001851612 ustep: 1 
iter: 2  value: 308.4771 mgc: 3.624406e-08 ustep: 1 
mgc: 3.787942e-14 
iter: 1  mgc: 3.787942e-14 
outer mgc:  0.0007691771 
iter: 1  value: 308.4769 mgc: 0.000679001 ustep: 1 
iter: 2  mgc: 5.637326e-09 
iter: 1  mgc: 5.637326e-09 
outer mgc:  0.0001219037 
iter: 1  mgc: 5.637326e-09 
iter: 1  mgc: 5.637326e-09 
outer mgc:  0.0001219037 
iter: 1  value: 308.4791 mgc: 0.037088 ustep: 1 
iter: 2  value: 308.4791 mgc: 4.208867e-06 ustep: 1 
iter: 3  mgc: 1.127987e-13 
outer mgc:  0.09207906 
iter: 1  value: 308.4749 mgc: 0.0370901 ustep: 1 
iter: 2  value: 308.4749 mgc: 4.20317e-06 ustep: 1 
iter: 3  mgc: 1.190159e-13 
outer mgc:  0.09208596 
iter: 1  value: 308.4785 mgc: 0.01420762 ustep: 1 
iter: 2  value: 308.4785 mgc: 1.8717e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.1000864 
iter: 1  value: 308.4754 mgc: 0.01421818 ustep: 1 
iter: 2  value: 308.4754 mgc: 1.87527e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.1003852 
iter: 1  value: 308.4758 mgc: 0.03355072 ustep: 1 
iter: 2  value: 308.4758 mgc: 6.357139e-06 ustep: 1 
iter: 3  mgc: 5.413447e-13 
outer mgc:  0.04593834 
iter: 1  value: 308.4781 mgc: 0.03354133 ustep: 1 
iter: 2  value: 308.4781 mgc: 6.362526e-06 ustep: 1 
iter: 3  mgc: 5.471179e-13 
outer mgc:  0.04593348 
iter: 1  value: 308.4763 mgc: 0.007912358 ustep: 1 
iter: 2  value: 308.4763 mgc: 2.802816e-07 ustep: 1 
iter: 3  mgc: 2.997602e-14 
outer mgc:  0.04553961 
iter: 1  value: 308.4776 mgc: 0.007906005 ustep: 1 
iter: 2  value: 308.4776 mgc: 2.798606e-07 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.0453553 
iter: 1  value: 308.4748 mgc: 0.004880285 ustep: 1 
iter: 2  value: 308.4748 mgc: 9.275303e-08 ustep: 1 
iter: 3  mgc: 3.225198e-14 
outer mgc:  0.005648991 
iter: 1  value: 308.4791 mgc: 0.004877645 ustep: 1 
iter: 2  value: 308.4791 mgc: 9.27091e-08 ustep: 1 
iter: 3  mgc: 3.27377e-14 
outer mgc:  0.005512382 
iter: 1  value: 308.4803 mgc: 0.01295385 ustep: 1 
iter: 2  value: 308.4803 mgc: 1.193117e-06 ustep: 1 
iter: 3  mgc: 9.170442e-14 
outer mgc:  0.07267796 
iter: 1  value: 308.4736 mgc: 0.01298077 ustep: 1 
iter: 2  value: 308.4736 mgc: 1.194016e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
outer mgc:  0.07290177 
iter: 1  value: 308.4801 mgc: 0.009092603 ustep: 1 
iter: 2  value: 308.4801 mgc: 3.108373e-06 ustep: 1 
iter: 3  mgc: 6.215028e-13 
outer mgc:  0.0694016 
iter: 1  value: 308.4738 mgc: 0.009101699 ustep: 1 
iter: 2  value: 308.4738 mgc: 3.116944e-06 ustep: 1 
iter: 3  mgc: 6.237233e-13 
outer mgc:  0.06951497 
[Mon Aug 16 06:42:17 2021]
Finished job 0.
1 of 1 steps (100%) done

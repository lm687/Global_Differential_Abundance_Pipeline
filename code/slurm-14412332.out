Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:06:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_4_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2697.728827 
iter  10 value 2530.362843
final  value 2530.362778 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 633.3297 mgc: 60.30847 ustep: 1 
iter: 2  value: 554.117 mgc: 35.36737 ustep: 1 
iter: 3  value: 552.6814 mgc: 7.887971 ustep: 1 
iter: 4  value: 552.6788 mgc: 0.3532729 ustep: 1 
iter: 5  value: 552.6788 mgc: 0.0009753983 ustep: 1 
iter: 6  mgc: 8.084292e-09 
iter: 1  mgc: 8.084292e-09 
Matching hessian patterns... Done
outer mgc:  161.1596 
iter: 1  value: 407.7959 mgc: 25.99885 ustep: 1 
iter: 2  value: 403.4202 mgc: 7.850257 ustep: 1 
iter: 3  value: 403.41 mgc: 0.478511 ustep: 1 
iter: 4  value: 403.41 mgc: 0.00228828 ustep: 1 
iter: 5  value: 403.41 mgc: 5.334863e-08 ustep: 1 
mgc: 2.969847e-14 
iter: 1  mgc: 2.969847e-14 
outer mgc:  79.03958 
iter: 1  value: 363.175 mgc: 19.09381 ustep: 1 
iter: 2  value: 362.5435 mgc: 2.578143 ustep: 1 
iter: 3  value: 362.5433 mgc: 0.05833119 ustep: 1 
iter: 4  value: 362.5433 mgc: 3.315727e-05 ustep: 1 
iter: 5  mgc: 1.067617e-11 
iter: 1  mgc: 1.067617e-11 
outer mgc:  18.02528 
iter: 1  value: 354.1627 mgc: 16.74318 ustep: 1 
iter: 2  value: 354.0703 mgc: 1.594552 ustep: 1 
iter: 3  value: 354.0703 mgc: 0.03036496 ustep: 1 
iter: 4  value: 354.0703 mgc: 1.175305e-05 ustep: 1 
iter: 5  mgc: 1.778577e-12 
iter: 1  mgc: 1.778577e-12 
outer mgc:  35.12404 
iter: 1  value: 340.7204 mgc: 10.97552 ustep: 1 
iter: 2  value: 340.7014 mgc: 0.5382461 ustep: 1 
iter: 3  value: 340.7014 mgc: 0.002190038 ustep: 1 
iter: 4  value: 340.7014 mgc: 3.898783e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  16.78956 
iter: 1  value: 340.7693 mgc: 36.80175 ustep: 1 
iter: 2  value: 340.3233 mgc: 1.929803 ustep: 1 
iter: 3  value: 340.3233 mgc: 0.0194636 ustep: 1 
iter: 4  value: 340.3233 mgc: 2.621039e-06 ustep: 1 
iter: 5  mgc: 5.195844e-14 
iter: 1  value: 336.0609 mgc: 18.19156 ustep: 1 
iter: 2  value: 335.9878 mgc: 0.7593888 ustep: 1 
iter: 3  value: 335.9878 mgc: 0.004030699 ustep: 1 
iter: 4  value: 335.9878 mgc: 1.579175e-07 ustep: 1 
mgc: 1.76803e-14 
iter: 1  mgc: 1.76803e-14 
outer mgc:  7.310981 
iter: 1  value: 334.3344 mgc: 7.57672 ustep: 1 
iter: 2  value: 334.3286 mgc: 0.2457592 ustep: 1 
iter: 3  value: 334.3286 mgc: 0.0008317089 ustep: 1 
iter: 4  value: 334.3286 mgc: 1.622918e-08 ustep: 1 
mgc: 2.009504e-14 
iter: 1  mgc: 2.009504e-14 
outer mgc:  18.75749 
iter: 1  value: 332.0301 mgc: 15.90769 ustep: 1 
iter: 2  value: 331.9899 mgc: 0.9451912 ustep: 1 
iter: 3  value: 331.9899 mgc: 0.009985643 ustep: 1 
iter: 4  value: 331.9899 mgc: 1.15075e-06 ustep: 1 
iter: 5  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  13.67573 
iter: 1  value: 331.0552 mgc: 14.02664 ustep: 1 
iter: 2  value: 331.0503 mgc: 0.3939437 ustep: 1 
iter: 3  value: 331.0503 mgc: 0.0005629204 ustep: 1 
iter: 4  mgc: 1.062013e-09 
iter: 1  mgc: 1.062013e-09 
outer mgc:  20.59713 
iter: 1  value: 329.6276 mgc: 15.55551 ustep: 1 
iter: 2  value: 329.5366 mgc: 0.9972213 ustep: 1 
iter: 3  value: 329.5366 mgc: 0.004392039 ustep: 1 
iter: 4  value: 329.5366 mgc: 9.755741e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  14.1228 
iter: 1  value: 329.3627 mgc: 10.66577 ustep: 1 
iter: 2  value: 329.3376 mgc: 0.4547054 ustep: 1 
iter: 3  value: 329.3376 mgc: 0.001712182 ustep: 1 
iter: 4  value: 329.3376 mgc: 3.5458e-08 ustep: 1 
mgc: 2.076117e-14 
iter: 1  value: 327.97 mgc: 7.748914 ustep: 1 
iter: 2  value: 327.9635 mgc: 0.2815056 ustep: 1 
iter: 3  value: 327.9635 mgc: 0.000437057 ustep: 1 
iter: 4  mgc: 2.07854e-09 
iter: 1  mgc: 2.07854e-09 
outer mgc:  4.852504 
iter: 1  value: 326.5833 mgc: 4.133142 ustep: 1 
iter: 2  value: 326.5821 mgc: 0.1256304 ustep: 1 
iter: 3  value: 326.5821 mgc: 0.0003830153 ustep: 1 
iter: 4  mgc: 3.366315e-09 
iter: 1  mgc: 3.366315e-09 
outer mgc:  2.968486 
iter: 1  value: 325.6727 mgc: 3.987798 ustep: 1 
iter: 2  value: 325.6727 mgc: 0.01943611 ustep: 1 
iter: 3  value: 325.6727 mgc: 1.372005e-06 ustep: 1 
iter: 4  mgc: 2.076117e-14 
iter: 1  mgc: 2.076117e-14 
outer mgc:  4.019402 
iter: 1  value: 325.3441 mgc: 4.789279 ustep: 1 
iter: 2  value: 325.3439 mgc: 0.05935948 ustep: 1 
iter: 3  value: 325.3439 mgc: 1.610111e-05 ustep: 1 
iter: 4  mgc: 2.233103e-12 
iter: 1  value: 325.4177 mgc: 3.38546 ustep: 1 
iter: 2  value: 325.4176 mgc: 0.0254119 ustep: 1 
iter: 3  value: 325.4176 mgc: 4.223999e-06 ustep: 1 
iter: 4  mgc: 1.847411e-13 
iter: 1  mgc: 1.847411e-13 
outer mgc:  3.828685 
iter: 1  value: 325.0539 mgc: 2.299131 ustep: 1 
iter: 2  value: 325.0539 mgc: 0.00969726 ustep: 1 
iter: 3  value: 325.0539 mgc: 1.10331e-06 ustep: 1 
iter: 4  mgc: 2.781109e-14 
iter: 1  mgc: 2.781109e-14 
outer mgc:  2.641666 
iter: 1  value: 324.858 mgc: 0.780858 ustep: 1 
iter: 2  value: 324.858 mgc: 0.002579745 ustep: 1 
iter: 3  value: 324.858 mgc: 7.106255e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  1.975507 
iter: 1  value: 324.6312 mgc: 2.542026 ustep: 1 
iter: 2  value: 324.6312 mgc: 0.007142133 ustep: 1 
iter: 3  value: 324.6312 mgc: 3.635325e-08 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  3.37751 
iter: 1  value: 324.1376 mgc: 2.129332 ustep: 1 
iter: 2  value: 324.1376 mgc: 0.006575215 ustep: 1 
iter: 3  value: 324.1376 mgc: 3.869508e-07 ustep: 1 
iter: 4  mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  1.963361 
iter: 1  value: 324.0895 mgc: 1.270788 ustep: 1 
iter: 2  value: 324.0895 mgc: 0.002101725 ustep: 1 
iter: 3  value: 324.0895 mgc: 4.519804e-08 ustep: 1 
mgc: 1.798561e-14 
iter: 1  mgc: 1.798561e-14 
outer mgc:  1.188243 
iter: 1  value: 323.9442 mgc: 1.254986 ustep: 1 
iter: 2  value: 323.9442 mgc: 0.006815292 ustep: 1 
iter: 3  value: 323.9442 mgc: 2.693935e-07 ustep: 1 
iter: 4  mgc: 1.84297e-14 
iter: 1  value: 324.0456 mgc: 0.3541126 ustep: 1 
iter: 2  value: 324.0456 mgc: 0.001035328 ustep: 1 
iter: 3  value: 324.0456 mgc: 2.123477e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  value: 324.0531 mgc: 0.1922588 ustep: 1 
iter: 2  value: 324.0531 mgc: 0.0002172112 ustep: 1 
iter: 3  mgc: 9.130829e-10 
iter: 1  mgc: 9.130829e-10 
outer mgc:  0.415332 
iter: 1  value: 324.0229 mgc: 0.7849261 ustep: 1 
iter: 2  value: 324.0229 mgc: 0.002106613 ustep: 1 
iter: 3  value: 324.0229 mgc: 3.284566e-08 ustep: 1 
mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  0.601535 
iter: 1  value: 323.9819 mgc: 0.20052 ustep: 1 
iter: 2  value: 323.9819 mgc: 6.304755e-05 ustep: 1 
iter: 3  mgc: 8.291146e-12 
iter: 1  mgc: 8.291146e-12 
outer mgc:  0.2742943 
iter: 1  value: 323.9285 mgc: 0.1958812 ustep: 1 
iter: 2  value: 323.9285 mgc: 7.518676e-05 ustep: 1 
iter: 3  mgc: 4.13336e-11 
iter: 1  value: 323.8391 mgc: 0.3032009 ustep: 1 
iter: 2  value: 323.8391 mgc: 0.0002155578 ustep: 1 
iter: 3  mgc: 2.18108e-10 
iter: 1  value: 323.6409 mgc: 0.6776093 ustep: 1 
iter: 2  value: 323.6409 mgc: 0.001020156 ustep: 1 
iter: 3  mgc: 5.128331e-09 
iter: 1  mgc: 5.128331e-09 
outer mgc:  0.5319184 
iter: 1  value: 323.3427 mgc: 0.9294499 ustep: 1 
iter: 2  value: 323.3427 mgc: 0.001474792 ustep: 1 
iter: 3  value: 323.3427 mgc: 2.007614e-08 ustep: 1 
mgc: 1.887379e-14 
iter: 1  mgc: 1.887379e-14 
outer mgc:  0.9037116 
iter: 1  value: 323.1786 mgc: 0.6850862 ustep: 1 
iter: 2  value: 323.1786 mgc: 0.0004835987 ustep: 1 
iter: 3  mgc: 1.16917e-09 
iter: 1  mgc: 1.16917e-09 
outer mgc:  0.5830777 
iter: 1  value: 322.8254 mgc: 0.8821064 ustep: 1 
iter: 2  value: 322.8254 mgc: 0.002788811 ustep: 1 
iter: 3  value: 322.8254 mgc: 8.293516e-08 ustep: 1 
mgc: 1.565414e-14 
iter: 1  mgc: 1.565414e-14 
outer mgc:  0.5096634 
iter: 1  value: 322.4077 mgc: 1.035715 ustep: 1 
iter: 2  value: 322.4077 mgc: 0.001111085 ustep: 1 
iter: 3  mgc: 3.880246e-09 
iter: 1  mgc: 3.880246e-09 
outer mgc:  0.3987539 
iter: 1  value: 322.0594 mgc: 1.483398 ustep: 1 
iter: 2  value: 322.0594 mgc: 0.007380907 ustep: 1 
iter: 3  value: 322.0594 mgc: 3.499513e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  value: 322.281 mgc: 0.5121518 ustep: 1 
iter: 2  value: 322.281 mgc: 0.000919143 ustep: 1 
iter: 3  mgc: 5.611187e-09 
iter: 1  mgc: 5.611187e-09 
outer mgc:  0.3943942 
iter: 1  value: 322.2477 mgc: 0.2205083 ustep: 1 
iter: 2  value: 322.2477 mgc: 0.0003111575 ustep: 1 
iter: 3  mgc: 6.630234e-10 
iter: 1  mgc: 6.630234e-10 
outer mgc:  0.09686533 
iter: 1  value: 322.1708 mgc: 0.2914292 ustep: 1 
iter: 2  value: 322.1708 mgc: 0.0002088868 ustep: 1 
iter: 3  mgc: 8.04703e-10 
iter: 1  mgc: 8.04703e-10 
outer mgc:  0.1852637 
iter: 1  value: 322.1239 mgc: 0.2433671 ustep: 1 
iter: 2  value: 322.1239 mgc: 3.535218e-05 ustep: 1 
iter: 3  mgc: 2.926726e-11 
iter: 1  mgc: 2.926726e-11 
outer mgc:  0.05176423 
iter: 1  value: 322.1177 mgc: 0.1568715 ustep: 1 
iter: 2  value: 322.1177 mgc: 0.0001429693 ustep: 1 
iter: 3  mgc: 1.207463e-10 
iter: 1  value: 322.1211 mgc: 0.06886392 ustep: 1 
iter: 2  value: 322.1211 mgc: 2.759022e-05 ustep: 1 
iter: 3  mgc: 4.489853e-12 
iter: 1  mgc: 4.489853e-12 
outer mgc:  0.01336611 
iter: 1  value: 322.1236 mgc: 0.04889172 ustep: 1 
iter: 2  value: 322.1236 mgc: 1.488567e-06 ustep: 1 
iter: 3  mgc: 4.574119e-14 
iter: 1  mgc: 4.574119e-14 
outer mgc:  0.01256768 
iter: 1  value: 322.1171 mgc: 0.0155434 ustep: 1 
iter: 2  value: 322.1171 mgc: 1.059475e-07 ustep: 1 
iter: 3  mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.007322922 
iter: 1  value: 322.1174 mgc: 0.001845882 ustep: 1 
iter: 2  mgc: 2.899825e-09 
iter: 1  mgc: 2.899825e-09 
outer mgc:  0.0002285023 
iter: 1  value: 322.1171 mgc: 0.0005813535 ustep: 1 
iter: 2  mgc: 1.797584e-10 
iter: 1  mgc: 1.797584e-10 
outer mgc:  3.446529e-05 
iter: 1  mgc: 1.797584e-10 
iter: 1  mgc: 1.797584e-10 
outer mgc:  3.446529e-05 
iter: 1  value: 322.1184 mgc: 0.04254758 ustep: 1 
iter: 2  value: 322.1184 mgc: 9.868175e-07 ustep: 1 
iter: 3  mgc: 2.819966e-14 
outer mgc:  0.2033231 
iter: 1  value: 322.1159 mgc: 0.04253072 ustep: 1 
iter: 2  value: 322.1159 mgc: 9.875915e-07 ustep: 1 
iter: 3  mgc: 1.776357e-14 
outer mgc:  0.2033139 
iter: 1  value: 322.1173 mgc: 0.01703508 ustep: 1 
iter: 2  value: 322.1173 mgc: 1.576778e-07 ustep: 1 
iter: 3  mgc: 1.554312e-14 
outer mgc:  0.09494757 
iter: 1  value: 322.1169 mgc: 0.01702508 ustep: 1 
iter: 2  value: 322.1169 mgc: 1.574668e-07 ustep: 1 
iter: 3  mgc: 1.976197e-14 
outer mgc:  0.0949242 
iter: 1  value: 322.117 mgc: 0.04575053 ustep: 1 
iter: 2  value: 322.117 mgc: 6.302551e-06 ustep: 1 
iter: 3  mgc: 3.93463e-13 
outer mgc:  0.04037109 
iter: 1  value: 322.1172 mgc: 0.04574528 ustep: 1 
iter: 2  value: 322.1172 mgc: 6.306184e-06 ustep: 1 
iter: 3  mgc: 3.943512e-13 
outer mgc:  0.04035092 
iter: 1  value: 322.1176 mgc: 0.02669234 ustep: 1 
iter: 2  value: 322.1176 mgc: 2.949299e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
outer mgc:  0.1062491 
iter: 1  value: 322.1166 mgc: 0.02669519 ustep: 1 
iter: 2  value: 322.1166 mgc: 2.950187e-06 ustep: 1 
iter: 3  mgc: 8.437695e-14 
outer mgc:  0.1063117 
iter: 1  value: 322.1166 mgc: 0.04246649 ustep: 1 
iter: 2  value: 322.1166 mgc: 7.271675e-06 ustep: 1 
iter: 3  mgc: 3.375078e-13 
outer mgc:  0.06618599 
iter: 1  value: 322.1176 mgc: 0.0424526 ustep: 1 
iter: 2  value: 322.1176 mgc: 7.276787e-06 ustep: 1 
iter: 3  mgc: 3.339551e-13 
outer mgc:  0.06616717 
iter: 1  value: 322.1168 mgc: 0.02110462 ustep: 1 
iter: 2  value: 322.1168 mgc: 1.852139e-06 ustep: 1 
iter: 3  mgc: 3.4861e-14 
outer mgc:  0.08617667 
iter: 1  value: 322.1174 mgc: 0.02109566 ustep: 1 
iter: 2  value: 322.1174 mgc: 1.85181e-06 ustep: 1 
iter: 3  mgc: 2.348122e-14 
outer mgc:  0.08609659 
iter: 1  value: 322.1155 mgc: 0.01099049 ustep: 1 
iter: 2  value: 322.1155 mgc: 9.988555e-08 ustep: 1 
mgc: 2.264855e-14 
outer mgc:  0.002766297 
iter: 1  value: 322.1187 mgc: 0.01098496 ustep: 1 
iter: 2  value: 322.1187 mgc: 9.990133e-08 ustep: 1 
mgc: 1.509903e-14 
outer mgc:  0.002731551 
iter: 1  value: 322.1153 mgc: 0.004936907 ustep: 1 
iter: 2  value: 322.1153 mgc: 1.454574e-08 ustep: 1 
mgc: 2.753353e-14 
outer mgc:  0.000894534 
iter: 1  value: 322.1189 mgc: 0.004935141 ustep: 1 
iter: 2  value: 322.1189 mgc: 1.45567e-08 ustep: 1 
mgc: 2.864375e-14 
outer mgc:  0.0009061117 
iter: 1  value: 322.1191 mgc: 0.01683786 ustep: 1 
iter: 2  value: 322.1191 mgc: 1.395678e-07 ustep: 1 
mgc: 2.309264e-14 
outer mgc:  0.003563363 
iter: 1  value: 322.115 mgc: 0.01685476 ustep: 1 
iter: 2  value: 322.115 mgc: 1.396651e-07 ustep: 1 
mgc: 1.731948e-14 
outer mgc:  0.003547067 
iter: 1  value: 322.1257 mgc: 0.06914992 ustep: 1 
iter: 2  value: 322.1257 mgc: 2.483097e-06 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.0365932 
iter: 1  value: 322.1085 mgc: 0.06935071 ustep: 1 
iter: 2  value: 322.1085 mgc: 2.483668e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
outer mgc:  0.03650516 
iter: 1  value: 322.1173 mgc: 0.02847505 ustep: 1 
iter: 2  value: 322.1173 mgc: 1.268874e-06 ustep: 1 
iter: 3  mgc: 2.68674e-14 
outer mgc:  0.03244434 
iter: 1  value: 322.1168 mgc: 0.02850354 ustep: 1 
iter: 2  value: 322.1168 mgc: 1.273872e-06 ustep: 1 
iter: 3  mgc: 2.731149e-14 
outer mgc:  0.03254161 
iter: 1  value: 322.1174 mgc: 0.05329353 ustep: 1 
iter: 2  value: 322.1174 mgc: 2.854543e-06 ustep: 1 
iter: 3  mgc: 1.74083e-13 
outer mgc:  0.04000558 
iter: 1  value: 322.1167 mgc: 0.05334685 ustep: 1 
iter: 2  value: 322.1167 mgc: 2.864765e-06 ustep: 1 
iter: 3  mgc: 1.700862e-13 
outer mgc:  0.04005541 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:06:53 2021]
Finished job 0.
1 of 1 steps (100%) done

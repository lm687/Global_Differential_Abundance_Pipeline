Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:10:11 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4433.999197 
final  value 4291.614323 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4230.881 mgc: 73.46729 ustep: 1 
iter: 2  value: 4206.86 mgc: 22.31032 ustep: 1 
iter: 3  value: 4205.537 mgc: 9.772884 ustep: 1 
iter: 4  value: 4205.533 mgc: 0.5238949 ustep: 1 
iter: 5  value: 4205.533 mgc: 0.00199212 ustep: 1 
iter: 6  value: 4205.533 mgc: 2.931155e-08 ustep: 1 
mgc: 6.763701e-12 
iter: 1  mgc: 6.763701e-12 
Matching hessian patterns... Done
outer mgc:  65.61111 
iter: 1  value: 4270.838 mgc: 31.99922 ustep: 1 
iter: 2  value: 4270.255 mgc: 2.650256 ustep: 1 
iter: 3  value: 4270.255 mgc: 0.03338596 ustep: 1 
iter: 4  value: 4270.255 mgc: 7.872601e-06 ustep: 1 
iter: 5  mgc: 9.651391e-12 
iter: 1  value: 4196.89 mgc: 8.770436 ustep: 1 
iter: 2  value: 4196.888 mgc: 0.2047757 ustep: 1 
iter: 3  value: 4196.888 mgc: 0.000304885 ustep: 1 
iter: 4  mgc: 6.828379e-10 
iter: 1  mgc: 6.828379e-10 
outer mgc:  21.33741 
iter: 1  value: 4194.579 mgc: 2.954021 ustep: 1 
iter: 2  value: 4194.578 mgc: 0.08219163 ustep: 1 
iter: 3  value: 4194.578 mgc: 3.681254e-05 ustep: 1 
iter: 4  mgc: 2.23791e-11 
iter: 1  mgc: 2.23791e-11 
outer mgc:  21.14647 
iter: 1  value: 4192.217 mgc: 10.58789 ustep: 1 
iter: 2  value: 4192.207 mgc: 0.2642925 ustep: 1 
iter: 3  value: 4192.207 mgc: 0.0004693496 ustep: 1 
iter: 4  mgc: 2.240431e-09 
iter: 1  mgc: 2.240431e-09 
outer mgc:  21.55195 
iter: 1  value: 4188.367 mgc: 3.57866 ustep: 1 
iter: 2  value: 4188.367 mgc: 0.03349701 ustep: 1 
iter: 3  value: 4188.367 mgc: 8.130765e-06 ustep: 1 
iter: 4  mgc: 6.726703e-12 
iter: 1  mgc: 6.726703e-12 
outer mgc:  7.489961 
iter: 1  value: 4184.267 mgc: 16.70342 ustep: 1 
iter: 2  value: 4184.242 mgc: 0.6885056 ustep: 1 
iter: 3  value: 4184.242 mgc: 0.003265108 ustep: 1 
iter: 4  value: 4184.242 mgc: 7.54326e-08 ustep: 1 
mgc: 4.644063e-12 
iter: 1  mgc: 4.644063e-12 
outer mgc:  27.24829 
iter: 1  value: 4173.667 mgc: 15.54239 ustep: 1 
iter: 2  value: 4173.64 mgc: 0.4840149 ustep: 1 
iter: 3  value: 4173.64 mgc: 0.001538319 ustep: 1 
iter: 4  value: 4173.64 mgc: 3.699651e-08 ustep: 1 
mgc: 7.485138e-12 
iter: 1  mgc: 7.485138e-12 
outer mgc:  13.56277 
iter: 1  value: 4193.198 mgc: 25.0506 ustep: 1 
iter: 2  value: 4192.605 mgc: 1.658478 ustep: 1 
iter: 3  value: 4192.605 mgc: 0.02478103 ustep: 1 
iter: 4  value: 4192.605 mgc: 7.128995e-06 ustep: 1 
iter: 5  mgc: 6.759759e-12 
iter: 1  value: 4174.001 mgc: 5.395829 ustep: 1 
iter: 2  value: 4173.999 mgc: 0.1177058 ustep: 1 
iter: 3  value: 4173.999 mgc: 0.0001311857 ustep: 1 
iter: 4  mgc: 1.89098e-10 
iter: 1  value: 4172.882 mgc: 2.315769 ustep: 1 
iter: 2  value: 4172.882 mgc: 0.023068 ustep: 1 
iter: 3  value: 4172.882 mgc: 4.89613e-06 ustep: 1 
iter: 4  mgc: 5.391354e-12 
iter: 1  mgc: 5.391354e-12 
outer mgc:  9.25022 
iter: 1  value: 4172.586 mgc: 2.281349 ustep: 1 
iter: 2  value: 4172.586 mgc: 0.0126478 ustep: 1 
iter: 3  value: 4172.586 mgc: 9.904923e-07 ustep: 1 
iter: 4  mgc: 9.783063e-12 
iter: 1  mgc: 9.783063e-12 
outer mgc:  10.26539 
iter: 1  value: 4171.806 mgc: 2.683272 ustep: 1 
iter: 2  value: 4171.806 mgc: 0.0203431 ustep: 1 
iter: 3  value: 4171.806 mgc: 2.51629e-06 ustep: 1 
iter: 4  mgc: 4.368172e-12 
iter: 1  mgc: 4.368172e-12 
outer mgc:  5.004064 
iter: 1  value: 4170.823 mgc: 0.8009612 ustep: 1 
iter: 2  value: 4170.823 mgc: 0.003066888 ustep: 1 
iter: 3  value: 4170.823 mgc: 5.678584e-08 ustep: 1 
mgc: 7.459144e-12 
iter: 1  mgc: 7.459144e-12 
outer mgc:  8.310257 
iter: 1  value: 4168.992 mgc: 3.61499 ustep: 1 
iter: 2  value: 4168.992 mgc: 0.07353649 ustep: 1 
iter: 3  value: 4168.992 mgc: 3.186969e-05 ustep: 1 
iter: 4  mgc: 8.840928e-12 
iter: 1  mgc: 8.840928e-12 
outer mgc:  4.967525 
iter: 1  value: 4168.868 mgc: 14.06296 ustep: 1 
iter: 2  value: 4168.856 mgc: 0.3331347 ustep: 1 
iter: 3  value: 4168.856 mgc: 0.0005594527 ustep: 1 
iter: 4  mgc: 1.880073e-09 
iter: 1  value: 4168.385 mgc: 7.367588 ustep: 1 
iter: 2  value: 4168.384 mgc: 0.1023469 ustep: 1 
iter: 3  value: 4168.384 mgc: 5.564476e-05 ustep: 1 
iter: 4  mgc: 1.852385e-11 
iter: 1  mgc: 1.852385e-11 
outer mgc:  4.483303 
iter: 1  value: 4167.818 mgc: 1.829247 ustep: 1 
iter: 2  value: 4167.818 mgc: 0.008233083 ustep: 1 
iter: 3  value: 4167.818 mgc: 3.863551e-07 ustep: 1 
iter: 4  mgc: 1.094014e-11 
iter: 1  mgc: 1.094014e-11 
outer mgc:  1.761752 
iter: 1  value: 4167.609 mgc: 6.522982 ustep: 1 
iter: 2  value: 4167.605 mgc: 0.153235 ustep: 1 
iter: 3  value: 4167.605 mgc: 0.0001527227 ustep: 1 
iter: 4  mgc: 2.281045e-10 
iter: 1  value: 4167.602 mgc: 0.8767639 ustep: 1 
iter: 2  value: 4167.602 mgc: 0.00258398 ustep: 1 
iter: 3  value: 4167.602 mgc: 2.67717e-08 ustep: 1 
mgc: 7.579493e-12 
iter: 1  mgc: 7.579493e-12 
outer mgc:  8.045761 
iter: 1  value: 4167.235 mgc: 2.982443 ustep: 1 
iter: 2  value: 4167.235 mgc: 0.03903697 ustep: 1 
iter: 3  value: 4167.235 mgc: 1.095212e-05 ustep: 1 
iter: 4  mgc: 8.607226e-12 
iter: 1  mgc: 8.607226e-12 
outer mgc:  2.653038 
iter: 1  value: 4167.092 mgc: 4.415972 ustep: 1 
iter: 2  value: 4167.09 mgc: 0.1038308 ustep: 1 
iter: 3  value: 4167.09 mgc: 9.409123e-05 ustep: 1 
iter: 4  mgc: 1.194178e-10 
iter: 1  mgc: 1.194178e-10 
outer mgc:  2.17726 
iter: 1  value: 4167.089 mgc: 1.33384 ustep: 1 
iter: 2  value: 4167.089 mgc: 0.008652918 ustep: 1 
iter: 3  value: 4167.089 mgc: 1.858643e-07 ustep: 1 
iter: 4  mgc: 6.261658e-12 
iter: 1  value: 4167.134 mgc: 1.578136 ustep: 1 
iter: 2  value: 4167.134 mgc: 0.01113834 ustep: 1 
iter: 3  value: 4167.134 mgc: 9.693601e-07 ustep: 1 
iter: 4  mgc: 5.439316e-12 
iter: 1  value: 4167.055 mgc: 0.599671 ustep: 1 
iter: 2  value: 4167.055 mgc: 0.001641053 ustep: 1 
iter: 3  value: 4167.055 mgc: 2.111594e-08 ustep: 1 
mgc: 4.26742e-12 
iter: 1  mgc: 4.26742e-12 
outer mgc:  1.993486 
iter: 1  value: 4167.021 mgc: 0.8226475 ustep: 1 
iter: 2  value: 4167.021 mgc: 0.002772518 ustep: 1 
iter: 3  value: 4167.021 mgc: 5.788862e-08 ustep: 1 
mgc: 4.931472e-12 
iter: 1  mgc: 4.931472e-12 
outer mgc:  1.107604 
iter: 1  value: 4167.001 mgc: 0.1051185 ustep: 1 
iter: 2  value: 4167.001 mgc: 8.749032e-05 ustep: 1 
iter: 3  mgc: 3.146017e-11 
iter: 1  mgc: 3.146017e-11 
outer mgc:  0.6815136 
iter: 1  value: 4166.976 mgc: 0.3887386 ustep: 1 
iter: 2  value: 4166.976 mgc: 0.0006180272 ustep: 1 
iter: 3  mgc: 2.215873e-09 
iter: 1  value: 4166.938 mgc: 0.2019685 ustep: 1 
iter: 2  value: 4166.938 mgc: 0.0001795708 ustep: 1 
iter: 3  mgc: 3.717147e-10 
iter: 1  mgc: 3.717147e-10 
outer mgc:  0.3654946 
iter: 1  value: 4166.868 mgc: 1.187973 ustep: 1 
iter: 2  value: 4166.868 mgc: 0.005330962 ustep: 1 
iter: 3  value: 4166.868 mgc: 1.651009e-07 ustep: 1 
iter: 4  mgc: 2.523537e-12 
iter: 1  value: 4166.905 mgc: 2.566988 ustep: 1 
iter: 2  value: 4166.904 mgc: 0.02533169 ustep: 1 
iter: 3  value: 4166.904 mgc: 3.608568e-06 ustep: 1 
iter: 4  mgc: 1.129319e-12 
iter: 1  mgc: 1.129319e-12 
outer mgc:  3.381051 
iter: 1  value: 4167.118 mgc: 2.392787 ustep: 1 
iter: 2  value: 4167.117 mgc: 0.02738913 ustep: 1 
iter: 3  value: 4167.117 mgc: 4.856285e-06 ustep: 1 
iter: 4  mgc: 5.132561e-13 
iter: 1  value: 4178.246 mgc: 6.10659 ustep: 1 
iter: 2  value: 4178.234 mgc: 0.3909509 ustep: 1 
iter: 3  value: 4178.234 mgc: 0.0007056181 ustep: 1 
iter: 4  mgc: 8.167566e-09 
iter: 1  mgc: 8.167566e-09 
outer mgc:  17.35434 
iter: 1  value: 4166.916 mgc: 13.03976 ustep: 1 
iter: 2  value: 4166.85 mgc: 1.213036 ustep: 1 
iter: 3  value: 4166.85 mgc: 0.006612891 ustep: 1 
iter: 4  value: 4166.85 mgc: 2.236795e-07 ustep: 1 
mgc: 9.187096e-13 
iter: 1  value: 4169.086 mgc: 5.961697 ustep: 1 
iter: 2  value: 4169.083 mgc: 0.2654087 ustep: 1 
iter: 3  value: 4169.083 mgc: 0.0003425433 ustep: 1 
iter: 4  mgc: 1.008574e-09 
iter: 1  mgc: 1.008574e-09 
outer mgc:  11.9578 
iter: 1  value: 4170.281 mgc: 5.433068 ustep: 1 
iter: 2  value: 4170.27 mgc: 0.2549154 ustep: 1 
iter: 3  value: 4170.27 mgc: 0.0009793205 ustep: 1 
iter: 4  value: 4170.27 mgc: 1.72778e-08 ustep: 1 
mgc: 7.675804e-14 
iter: 1  mgc: 7.675804e-14 
outer mgc:  8.885257 
iter: 1  value: 4174.302 mgc: 2.846721 ustep: 1 
iter: 2  value: 4174.302 mgc: 0.06663003 ustep: 1 
iter: 3  value: 4174.302 mgc: 6.254587e-05 ustep: 1 
iter: 4  mgc: 6.792611e-11 
iter: 1  mgc: 6.792611e-11 
outer mgc:  6.534458 
iter: 1  value: 4173.255 mgc: 2.911301 ustep: 1 
iter: 2  value: 4173.255 mgc: 0.05172514 ustep: 1 
iter: 3  value: 4173.255 mgc: 2.246906e-05 ustep: 1 
iter: 4  mgc: 6.617373e-12 
iter: 1  mgc: 6.617373e-12 
outer mgc:  4.287357 
iter: 1  value: 4170.298 mgc: 2.174885 ustep: 1 
iter: 2  value: 4170.297 mgc: 0.02740919 ustep: 1 
iter: 3  value: 4170.297 mgc: 1.281504e-05 ustep: 1 
iter: 4  mgc: 2.899903e-12 
iter: 1  mgc: 2.899903e-12 
outer mgc:  3.092569 
iter: 1  value: 4171.141 mgc: 0.9709027 ustep: 1 
iter: 2  value: 4171.141 mgc: 0.005004226 ustep: 1 
iter: 3  value: 4171.141 mgc: 4.167292e-07 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  2.042538 
iter: 1  value: 4171.99 mgc: 0.5009049 ustep: 1 
iter: 2  value: 4171.99 mgc: 0.003162717 ustep: 1 
iter: 3  value: 4171.99 mgc: 1.089285e-07 ustep: 1 
iter: 4  mgc: 4.773959e-14 
iter: 1  mgc: 4.773959e-14 
outer mgc:  0.9727726 
iter: 1  value: 4171.782 mgc: 0.644926 ustep: 1 
iter: 2  value: 4171.782 mgc: 0.00279839 ustep: 1 
iter: 3  value: 4171.782 mgc: 2.272951e-08 ustep: 1 
mgc: 5.440093e-14 
iter: 1  mgc: 5.440093e-14 
outer mgc:  0.2344799 
iter: 1  value: 4171.645 mgc: 0.2290973 ustep: 1 
iter: 2  value: 4171.645 mgc: 0.0007037436 ustep: 1 
iter: 3  mgc: 2.448291e-09 
iter: 1  mgc: 2.448291e-09 
outer mgc:  0.1975947 
iter: 1  value: 4171.641 mgc: 0.02153614 ustep: 1 
iter: 2  value: 4171.641 mgc: 6.598565e-06 ustep: 1 
iter: 3  mgc: 5.506706e-13 
iter: 1  mgc: 5.506706e-13 
outer mgc:  0.07374001 
iter: 1  value: 4171.644 mgc: 0.008597622 ustep: 1 
iter: 2  value: 4171.644 mgc: 1.034465e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  0.01735316 
iter: 1  value: 4171.645 mgc: 0.0007174684 ustep: 1 
iter: 2  mgc: 5.801591e-09 
iter: 1  mgc: 5.801591e-09 
outer mgc:  0.004116531 
iter: 1  value: 4171.645 mgc: 0.0002809796 ustep: 1 
iter: 2  mgc: 1.271218e-09 
iter: 1  mgc: 1.271218e-09 
outer mgc:  0.0002255447 
iter: 1  mgc: 1.271218e-09 
iter: 1  mgc: 1.271218e-09 
outer mgc:  0.0002255447 
iter: 1  value: 4171.645 mgc: 0.0241226 ustep: 1 
iter: 2  value: 4171.645 mgc: 3.263422e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
outer mgc:  0.08157737 
iter: 1  value: 4171.644 mgc: 0.02412223 ustep: 1 
iter: 2  value: 4171.644 mgc: 3.271953e-06 ustep: 1 
iter: 3  mgc: 5.973e-14 
outer mgc:  0.08155405 
iter: 1  value: 4171.645 mgc: 0.01331883 ustep: 1 
iter: 2  value: 4171.645 mgc: 1.070134e-06 ustep: 1 
iter: 3  mgc: 5.040413e-14 
outer mgc:  0.1348635 
iter: 1  value: 4171.644 mgc: 0.01331877 ustep: 1 
iter: 2  value: 4171.644 mgc: 1.071369e-06 ustep: 1 
iter: 3  mgc: 4.285461e-14 
outer mgc:  0.1348118 
iter: 1  value: 4171.644 mgc: 0.01915256 ustep: 1 
iter: 2  value: 4171.644 mgc: 4.639896e-06 ustep: 1 
iter: 3  mgc: 3.796408e-13 
outer mgc:  0.06098479 
iter: 1  value: 4171.645 mgc: 0.01914055 ustep: 1 
iter: 2  value: 4171.645 mgc: 4.647423e-06 ustep: 1 
iter: 3  mgc: 3.645417e-13 
outer mgc:  0.06105296 
iter: 1  value: 4171.644 mgc: 0.01041441 ustep: 1 
iter: 2  value: 4171.644 mgc: 1.825578e-06 ustep: 1 
iter: 3  mgc: 7.638334e-14 
outer mgc:  0.09685008 
iter: 1  value: 4171.645 mgc: 0.01040789 ustep: 1 
iter: 2  value: 4171.645 mgc: 1.826453e-06 ustep: 1 
iter: 3  mgc: 6.816769e-14 
outer mgc:  0.0972863 
iter: 1  value: 4171.647 mgc: 0.00527778 ustep: 1 
iter: 2  value: 4171.647 mgc: 1.97508e-07 ustep: 1 
iter: 3  mgc: 6.605827e-14 
outer mgc:  0.005832468 
iter: 1  value: 4171.642 mgc: 0.00528306 ustep: 1 
iter: 2  value: 4171.642 mgc: 1.976841e-07 ustep: 1 
iter: 3  mgc: 5.040413e-14 
outer mgc:  0.005801967 
iter: 1  value: 4171.647 mgc: 0.003755139 ustep: 1 
iter: 2  value: 4171.647 mgc: 2.485028e-07 ustep: 1 
iter: 3  mgc: 6.039613e-14 
outer mgc:  0.005635031 
iter: 1  value: 4171.642 mgc: 0.003758896 ustep: 1 
iter: 2  value: 4171.642 mgc: 2.487584e-07 ustep: 1 
iter: 3  mgc: 4.751755e-14 
outer mgc:  0.00556769 
iter: 1  value: 4171.641 mgc: 0.003428032 ustep: 1 
iter: 2  value: 4171.641 mgc: 1.355381e-07 ustep: 1 
mgc: 4.973799e-14 
outer mgc:  0.003262364 
iter: 1  value: 4171.649 mgc: 0.003427583 ustep: 1 
iter: 2  value: 4171.649 mgc: 1.35516e-07 ustep: 1 
mgc: 3.641532e-14 
outer mgc:  0.00326608 
iter: 1  value: 4171.641 mgc: 0.002110633 ustep: 1 
iter: 2  value: 4171.641 mgc: 6.912669e-08 ustep: 1 
mgc: 6.328271e-14 
outer mgc:  0.001771703 
iter: 1  value: 4171.649 mgc: 0.002110715 ustep: 1 
iter: 2  value: 4171.649 mgc: 6.915643e-08 ustep: 1 
mgc: 7.105427e-14 
outer mgc:  0.001850813 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:10:13 2021]
Finished job 0.
1 of 1 steps (100%) done

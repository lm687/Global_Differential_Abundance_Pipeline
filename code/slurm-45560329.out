Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 18:37:53 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_50_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_50_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_50_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10748.822632 
iter  10 value 5457.330744
final  value 5456.626420 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5953.754 mgc: 1.915162 ustep: 0.6827823 
iter: 2  value: 5930.648 mgc: 0.9785754 ustep: 0.5831969 
iter: 3  value: 5894.579 mgc: 1.432417 ustep: 0.5138385 
iter: 4  value: 5874.223 mgc: 1.452772 ustep: 0.4678382 
iter: 5  value: 5854.452 mgc: 1.26951 ustep: 0.437834 
iter: 6  value: 5839.2 mgc: 1.174246 ustep: 0.4183432 
iter: 7  value: 5827.032 mgc: 1.068613 ustep: 0.4056783 
iter: 8  value: 5804.039 mgc: 1.1632 ustep: 0.6369651 
iter: 9  value: 5773.951 mgc: 3.355815 ustep: 0.5506356 
iter: 10  value: 5759.99 mgc: 2.487432 ustep: 0.4920867 
iter: 11  value: 5753.37 mgc: 0.9084965 ustep: 0.4536202 
iter: 12  value: 5739.119 mgc: 1.133508 ustep: 0.673546 
iter: 13  value: 5729.382 mgc: 2.470431 ustep: 0.5765234 
iter: 14  value: 5723.149 mgc: 1.178796 ustep: 0.509353 
iter: 15  value: 5720.286 mgc: 0.9145562 ustep: 0.4649005 
iter: 16  value: 5717.662 mgc: 0.9323366 ustep: 0.681868 
iter: 17  value: 5716.594 mgc: 0.6745547 ustep: 0.5825335 
iter: 18  value: 5714.004 mgc: 0.7590643 ustep: 0.5133919 
iter: 19  value: 5712.758 mgc: 0.9387189 ustep: 0.4675456 
iter: 20  value: 5711.413 mgc: 0.7293562 ustep: 0.4376437 
iter: 21  value: 5709.873 mgc: 1.016775 ustep: 0.4182197 
iter: 22  value: 5708.56 mgc: 0.8279408 ustep: 0.6467344 
iter: 23  value: 5708.244 mgc: 0.570242 ustep: 0.8042176 
iter: 24  value: 5708.218 mgc: 0.1337377 ustep: 0.8967921 
iter: 25  value: 5708.217 mgc: 0.02122133 ustep: 0.9469964 
iter: 26  value: 5708.217 mgc: 0.002082432 ustep: 0.9731401 
iter: 27  value: 5708.217 mgc: 0.000103844 ustep: 0.98648 
iter: 28  value: 5708.217 mgc: 2.571687e-06 ustep: 0.9932177 
iter: 29  value: 5708.217 mgc: 5.782827e-08 ustep: 0.9966034 
iter: 30  mgc: 8.724785e-10 
iter: 1  mgc: 8.724785e-10 
Matching hessian patterns... Done
outer mgc:  139.8165 
iter: 1  value: 5596.813 mgc: 0.8612795 ustep: 1 
iter: 2  value: 5593.498 mgc: 0.2235719 ustep: 0.8994163 
iter: 3  value: 5588.803 mgc: 1.923317 ustep: 0.772724 
iter: 4  value: 5587.74 mgc: 1.06102 ustep: 0.6521695 
iter: 5  value: 5587.066 mgc: 0.4121691 ustep: 0.5612975 
iter: 6  value: 5586.719 mgc: 0.6053058 ustep: 0.749223 
iter: 7  value: 5585.695 mgc: 1.773584 ustep: 0.8655901 
iter: 8  value: 5585.107 mgc: 1.34703 ustep: 0.7360664 
iter: 9  value: 5585.013 mgc: 0.144218 ustep: 0.6230522 
iter: 10  value: 5582.95 mgc: 0.1944489 ustep: 0.7893576 
iter: 11  value: 5582.576 mgc: 0.5145364 ustep: 0.8884692 
iter: 12  value: 5582.55 mgc: 0.07645739 ustep: 0.7603246 
iter: 13  value: 5582.285 mgc: 0.05869076 ustep: 0.8719788 
iter: 14  value: 5580.749 mgc: 0.3008219 ustep: 0.7426412 
iter: 15  value: 5580.095 mgc: 0.5077844 ustep: 0.8617801 
iter: 16  value: 5580.077 mgc: 0.1969826 ustep: 0.9283283 
iter: 17  value: 5580.077 mgc: 0.007949737 ustep: 0.9635016 
iter: 18  value: 5580.077 mgc: 0.000793763 ustep: 0.981583 
iter: 19  value: 5580.077 mgc: 3.836432e-05 ustep: 0.9907496 
iter: 20  value: 5580.077 mgc: 9.307568e-07 ustep: 0.9953645 
iter: 21  value: 5580.077 mgc: 1.135699e-08 ustep: 0.9976798 
iter: 22  mgc: 6.957579e-11 
iter: 1  mgc: 6.957579e-11 
outer mgc:  59.19165 
iter: 1  value: 5539.976 mgc: 1.323695 ustep: 1 
iter: 2  value: 5538.147 mgc: 0.3103865 ustep: 1 
iter: 3  value: 5538.14 mgc: 0.02235875 ustep: 1 
iter: 4  value: 5538.14 mgc: 7.501922e-05 ustep: 1 
iter: 5  mgc: 9.225354e-10 
iter: 1  mgc: 9.225354e-10 
outer mgc:  63.23305 
iter: 1  value: 5503.743 mgc: 1.348923 ustep: 1 
iter: 2  value: 5503.02 mgc: 0.295948 ustep: 1 
iter: 3  value: 5503.018 mgc: 0.02208206 ustep: 1 
iter: 4  value: 5503.018 mgc: 3.162133e-05 ustep: 1 
iter: 5  mgc: 7.64398e-11 
iter: 1  mgc: 7.64398e-11 
outer mgc:  64.99549 
iter: 1  value: 5443.082 mgc: 1.217732 ustep: 1 
iter: 2  value: 5443.038 mgc: 0.05276274 ustep: 1 
iter: 3  value: 5443.038 mgc: 0.0002065459 ustep: 1 
iter: 4  value: 5443.038 mgc: 5.162751e-08 ustep: 1 
iter: 5  mgc: 1.582068e-15 
iter: 1  mgc: 1.582068e-15 
outer mgc:  46.11617 
iter: 1  value: 5373.9 mgc: 1.773411 ustep: 1 
iter: 2  value: 5373.683 mgc: 0.2145994 ustep: 1 
iter: 3  value: 5373.683 mgc: 0.004749134 ustep: 1 
iter: 4  value: 5373.683 mgc: 8.56536e-07 ustep: 1 
iter: 5  mgc: 2.864375e-14 
iter: 1  value: 5307.657 mgc: 5.148804 ustep: 1 
iter: 2  value: 5307.392 mgc: 0.2221017 ustep: 1 
iter: 3  value: 5307.392 mgc: 0.002824496 ustep: 1 
iter: 4  value: 5307.392 mgc: 3.19979e-07 ustep: 1 
iter: 5  mgc: 6.106227e-15 
iter: 1  mgc: 6.106227e-15 
outer mgc:  48.57285 
iter: 1  value: 5180.743 mgc: 7.532566 ustep: 1 
iter: 2  value: 5180.668 mgc: 0.1099751 ustep: 1 
iter: 3  value: 5180.668 mgc: 0.0007038882 ustep: 1 
iter: 4  value: 5180.668 mgc: 1.620538e-08 ustep: 1 
iter: 5  mgc: 1.184816e-15 
iter: 1  mgc: 1.184816e-15 
outer mgc:  41.67003 
iter: 1  value: 5106.229 mgc: 4.816684 ustep: 1 
iter: 2  value: 5106.217 mgc: 0.1218011 ustep: 1 
iter: 3  value: 5106.217 mgc: 0.0002277466 ustep: 1 
iter: 4  mgc: 1.848219e-09 
iter: 1  mgc: 1.848219e-09 
outer mgc:  62.70939 
iter: 1  value: 5060.662 mgc: 4.460347 ustep: 1 
iter: 2  value: 5060.641 mgc: 0.06968999 ustep: 1 
iter: 3  value: 5060.641 mgc: 0.0002152994 ustep: 1 
iter: 4  mgc: 1.502683e-09 
iter: 1  mgc: 1.502683e-09 
outer mgc:  57.4381 
iter: 1  value: 5014.397 mgc: 2.987949 ustep: 1 
iter: 2  value: 5014.396 mgc: 0.07009599 ustep: 1 
iter: 3  value: 5014.396 mgc: 6.767863e-05 ustep: 1 
iter: 4  mgc: 6.428025e-11 
iter: 1  mgc: 6.428025e-11 
outer mgc:  29.38379 
iter: 1  value: 4944.485 mgc: 39.09969 ustep: 1 
iter: 2  value: 4944.464 mgc: 0.2668535 ustep: 1 
iter: 3  value: 4944.464 mgc: 0.001372137 ustep: 1 
iter: 4  value: 4944.464 mgc: 5.601587e-08 ustep: 1 
iter: 5  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  35.51804 
iter: 1  value: 4948.801 mgc: 20.26323 ustep: 1 
iter: 2  value: 4948.786 mgc: 0.2098143 ustep: 1 
iter: 3  value: 4948.786 mgc: 0.0005892188 ustep: 1 
iter: 4  mgc: 1.366709e-10 
iter: 1  mgc: 1.366709e-10 
outer mgc:  26.05818 
iter: 1  value: 4930.878 mgc: 17.07421 ustep: 1 
iter: 2  value: 4930.876 mgc: 0.1694943 ustep: 1 
iter: 3  value: 4930.876 mgc: 4.806712e-05 ustep: 1 
iter: 4  mgc: 4.070078e-12 
iter: 1  mgc: 4.070078e-12 
outer mgc:  41.70737 
iter: 1  value: 4881.198 mgc: 24.97591 ustep: 1 
iter: 2  value: 4881.197 mgc: 0.04672187 ustep: 1 
iter: 3  value: 4881.197 mgc: 3.263478e-06 ustep: 1 
iter: 4  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  44.56367 
iter: 1  value: 4833.642 mgc: 37.68039 ustep: 1 
iter: 2  value: 4833.641 mgc: 0.0698868 ustep: 1 
iter: 3  value: 4833.641 mgc: 5.970377e-05 ustep: 1 
iter: 4  mgc: 4.183587e-11 
iter: 1  mgc: 4.183587e-11 
outer mgc:  20.93859 
iter: 1  value: 4805.87 mgc: 14.26282 ustep: 1 
iter: 2  value: 4805.87 mgc: 0.02863441 ustep: 1 
iter: 3  value: 4805.87 mgc: 2.424193e-06 ustep: 1 
iter: 4  mgc: 1.887379e-14 
iter: 1  value: 4790.584 mgc: 10.41955 ustep: 1 
iter: 2  value: 4790.584 mgc: 0.0033375 ustep: 1 
iter: 3  mgc: 5.859423e-09 
iter: 1  mgc: 5.859423e-09 
outer mgc:  15.50159 
iter: 1  value: 4880.348 mgc: 5.562564 ustep: 1 
iter: 2  value: 4880.339 mgc: 0.1371871 ustep: 1 
iter: 3  value: 4880.339 mgc: 0.0004476245 ustep: 1 
iter: 4  mgc: 3.365806e-09 
iter: 1  value: 4803.727 mgc: 2.430199 ustep: 1 
iter: 2  value: 4803.727 mgc: 0.001851366 ustep: 1 
iter: 3  mgc: 9.292564e-09 
iter: 1  mgc: 9.292564e-09 
outer mgc:  13.72818 
iter: 1  value: 4826.865 mgc: 4.327579 ustep: 1 
iter: 2  value: 4826.865 mgc: 0.004640681 ustep: 1 
iter: 3  value: 4826.865 mgc: 1.130291e-07 ustep: 1 
iter: 4  mgc: 3.413936e-15 
iter: 1  mgc: 3.413936e-15 
outer mgc:  26.48314 
iter: 1  value: 4816.831 mgc: 7.426087 ustep: 1 
iter: 2  value: 4816.831 mgc: 0.004006911 ustep: 1 
iter: 3  value: 4816.831 mgc: 4.084364e-08 ustep: 1 
mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  18.68178 
iter: 1  value: 4817.085 mgc: 1.72796 ustep: 1 
iter: 2  value: 4817.085 mgc: 0.0004833647 ustep: 1 
iter: 3  mgc: 9.515569e-10 
iter: 1  mgc: 9.515569e-10 
outer mgc:  7.955063 
iter: 1  value: 4834.997 mgc: 6.403098 ustep: 1 
iter: 2  value: 4834.997 mgc: 0.0315478 ustep: 1 
iter: 3  value: 4834.997 mgc: 1.467954e-05 ustep: 1 
iter: 4  mgc: 2.617906e-12 
iter: 1  mgc: 2.617906e-12 
outer mgc:  5.25096 
iter: 1  value: 4844.651 mgc: 0.7470042 ustep: 1 
iter: 2  value: 4844.651 mgc: 0.000920492 ustep: 1 
iter: 3  mgc: 4.993503e-10 
iter: 1  mgc: 4.993503e-10 
outer mgc:  7.381855 
iter: 1  value: 4843.57 mgc: 0.8948382 ustep: 1 
iter: 2  value: 4843.57 mgc: 0.0008123706 ustep: 1 
iter: 3  mgc: 9.177312e-09 
iter: 1  mgc: 9.177312e-09 
outer mgc:  2.62095 
iter: 1  value: 4846.291 mgc: 1.063568 ustep: 1 
iter: 2  value: 4846.291 mgc: 0.001499928 ustep: 1 
iter: 3  value: 4846.291 mgc: 7.4676e-08 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  value: 4849.953 mgc: 1.499258 ustep: 1 
iter: 2  value: 4849.953 mgc: 0.003760579 ustep: 1 
iter: 3  value: 4849.953 mgc: 4.132533e-07 ustep: 1 
iter: 4  mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  1.768588 
iter: 1  value: 4847.23 mgc: 4.244108 ustep: 1 
iter: 2  value: 4847.23 mgc: 0.004332893 ustep: 1 
iter: 3  value: 4847.23 mgc: 6.513419e-08 ustep: 1 
iter: 4  mgc: 6.27276e-15 
iter: 1  mgc: 6.27276e-15 
outer mgc:  2.038401 
iter: 1  value: 4846.358 mgc: 0.6003983 ustep: 1 
iter: 2  value: 4846.358 mgc: 0.0002114532 ustep: 1 
iter: 3  mgc: 1.185503e-09 
iter: 1  mgc: 1.185503e-09 
outer mgc:  0.7395429 
iter: 1  value: 4838.966 mgc: 1.748492 ustep: 1 
iter: 2  value: 4838.966 mgc: 0.00144589 ustep: 1 
iter: 3  value: 4838.966 mgc: 1.893546e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.3419795 
iter: 1  value: 4832.13 mgc: 1.328677 ustep: 1 
iter: 2  value: 4832.13 mgc: 0.000584527 ustep: 1 
iter: 3  mgc: 3.678845e-09 
iter: 1  mgc: 3.678845e-09 
outer mgc:  0.3448039 
iter: 1  value: 4826.366 mgc: 0.7183511 ustep: 1 
iter: 2  value: 4826.366 mgc: 0.000130716 ustep: 1 
iter: 3  mgc: 5.717067e-10 
iter: 1  mgc: 5.717067e-10 
outer mgc:  0.06881033 
iter: 1  value: 4821.978 mgc: 0.4506936 ustep: 1 
iter: 2  value: 4821.978 mgc: 2.064692e-05 ustep: 1 
iter: 3  mgc: 6.994405e-13 
iter: 1  mgc: 6.994405e-13 
outer mgc:  0.07302153 
iter: 1  value: 4817.125 mgc: 0.6422175 ustep: 1 
iter: 2  value: 4817.125 mgc: 1.521999e-05 ustep: 1 
iter: 3  mgc: 6.039613e-13 
iter: 1  mgc: 6.039613e-13 
outer mgc:  0.07660569 
iter: 1  value: 4813.023 mgc: 0.4793478 ustep: 1 
iter: 2  value: 4813.023 mgc: 1.558555e-05 ustep: 1 
iter: 3  mgc: 1.156852e-12 
iter: 1  mgc: 1.156852e-12 
outer mgc:  0.02769298 
iter: 1  value: 4807.867 mgc: 0.5920696 ustep: 1 
iter: 2  value: 4807.867 mgc: 1.530608e-05 ustep: 1 
iter: 3  mgc: 8.28726e-13 
iter: 1  mgc: 8.28726e-13 
outer mgc:  0.01154431 
iter: 1  value: 4802.901 mgc: 0.5721714 ustep: 1 
iter: 2  value: 4802.901 mgc: 2.967588e-06 ustep: 1 
iter: 3  mgc: 4.574119e-14 
iter: 1  mgc: 4.574119e-14 
outer mgc:  0.01781484 
iter: 1  value: 4794.699 mgc: 1.005499 ustep: 1 
iter: 2  value: 4794.699 mgc: 5.363254e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
iter: 1  mgc: 8.970602e-14 
outer mgc:  0.02188873 
iter: 1  value: 4787.536 mgc: 0.8588431 ustep: 1 
iter: 2  value: 4787.536 mgc: 2.888461e-06 ustep: 1 
iter: 3  mgc: 7.194245e-14 
iter: 1  mgc: 7.194245e-14 
outer mgc:  0.01737327 
iter: 1  value: 4776.912 mgc: 1.36011 ustep: 1 
iter: 2  value: 4776.912 mgc: 3.525421e-06 ustep: 1 
iter: 3  mgc: 9.969803e-14 
iter: 1  mgc: 9.969803e-14 
outer mgc:  0.01134712 
iter: 1  value: 4768.23 mgc: 1.0444 ustep: 1 
iter: 2  value: 4768.23 mgc: 9.147656e-07 ustep: 1 
iter: 3  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.009043998 
iter: 1  value: 4757.996 mgc: 1.268696 ustep: 1 
iter: 2  value: 4757.996 mgc: 4.487327e-07 ustep: 1 
iter: 3  mgc: 1.071226e-13 
iter: 1  mgc: 1.071226e-13 
outer mgc:  0.00736767 
iter: 1  value: 4749.541 mgc: 1.050579 ustep: 1 
iter: 2  value: 4749.541 mgc: 2.693769e-07 ustep: 1 
iter: 3  mgc: 3.247402e-13 
iter: 1  mgc: 3.247402e-13 
outer mgc:  0.003269798 
iter: 1  value: 4739.176 mgc: 1.342017 ustep: 1 
iter: 2  value: 4739.176 mgc: 2.347657e-07 ustep: 1 
iter: 3  mgc: 2.235989e-13 
iter: 1  mgc: 2.235989e-13 
outer mgc:  0.003857391 
iter: 1  value: 4730.566 mgc: 1.007633 ustep: 1 
iter: 2  value: 4730.566 mgc: 3.725325e-08 ustep: 1 
mgc: 4.551914e-13 
iter: 1  mgc: 4.551914e-13 
outer mgc:  0.003411027 
iter: 1  value: 4720.108 mgc: 1.325848 ustep: 1 
iter: 2  value: 4720.108 mgc: 2.856031e-08 ustep: 1 
mgc: 4.334311e-13 
iter: 1  mgc: 4.334311e-13 
outer mgc:  0.002440491 
iter: 1  value: 4711.45 mgc: 1.088333 ustep: 1 
iter: 2  value: 4711.45 mgc: 1.54771e-08 ustep: 1 
mgc: 7.194245e-13 
iter: 1  mgc: 7.194245e-13 
outer mgc:  0.001340118 
iter: 1  value: 4700.964 mgc: 1.362629 ustep: 1 
iter: 2  value: 4700.964 mgc: 1.318824e-08 ustep: 1 
mgc: 9.117151e-13 
iter: 1  mgc: 9.117151e-13 
outer mgc:  0.0006613786 
iter: 1  value: 4692.307 mgc: 1.041918 ustep: 1 
iter: 2  mgc: 2.227977e-09 
iter: 1  mgc: 2.227977e-09 
outer mgc:  0.0008283313 
iter: 1  value: 4681.834 mgc: 1.319135 ustep: 1 
iter: 2  mgc: 1.444024e-09 
iter: 1  mgc: 1.444024e-09 
outer mgc:  0.0005552309 
iter: 1  value: 4673.181 mgc: 1.123016 ustep: 1 
iter: 2  mgc: 1.63536e-09 
iter: 1  mgc: 1.63536e-09 
outer mgc:  0.0001834126 
iter: 1  value: 4662.706 mgc: 1.417936 ustep: 1 
iter: 2  mgc: 1.19614e-09 
iter: 1  mgc: 1.19614e-09 
outer mgc:  0.0002424534 
iter: 1  value: 4654.046 mgc: 1.019596 ustep: 1 
iter: 2  mgc: 8.909962e-11 
iter: 1  mgc: 8.909962e-11 
outer mgc:  NaN 
Error in nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) : 
  NA/NaN gradient evaluation
[Sat Aug 14 18:37:58 2021]
Finished job 0.
1 of 1 steps (100%) done

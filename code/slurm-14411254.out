Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:39:19 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21937.090180 
iter  10 value 18316.510921
iter  10 value 18316.510919
final  value 18316.510919 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6825.099 mgc: 149.3533 ustep: 1 
iter: 2  value: 4778.75 mgc: 100.5779 ustep: 0.1336527 
iter: 3  value: 4404.74 mgc: 107.4095 ustep: 0.203518 
iter: 4  value: 4017.379 mgc: 81.77713 ustep: 0.1392616 
iter: 5  value: 3852.487 mgc: 108.5149 ustep: 0.1102124 
iter: 6  value: 3605.362 mgc: 78.99249 ustep: 0.09594352 
iter: 7  value: 3486.101 mgc: 90.41795 ustep: 0.3098165 
iter: 8  value: 3458.495 mgc: 59.30722 ustep: 0.556656 
iter: 9  value: 3423.744 mgc: 54.63584 ustep: 0.7461192 
iter: 10  value: 3423.193 mgc: 6.902512 ustep: 0.8637955 
iter: 11  value: 3423.193 mgc: 0.07931171 ustep: 0.9294131 
iter: 12  value: 3423.193 mgc: 0.0001491687 ustep: 0.9640643 
iter: 13  value: 3423.193 mgc: 1.752944e-06 ustep: 0.9818696 
iter: 14  value: 3423.193 mgc: 3.949999e-08 ustep: 0.9908942 
iter: 15  mgc: 4.478647e-10 
iter: 1  mgc: 4.478647e-10 
Matching hessian patterns... Done
outer mgc:  1428.371 
iter: 1  value: 2587.241 mgc: 31.89353 ustep: 1 
iter: 2  value: 2565.986 mgc: 7.749636 ustep: 1 
iter: 3  value: 2565.954 mgc: 0.4671315 ustep: 1 
iter: 4  value: 2565.954 mgc: 0.003802205 ustep: 1 
iter: 5  value: 2565.954 mgc: 3.350888e-07 ustep: 1 
iter: 6  mgc: 4.007905e-14 
iter: 1  mgc: 4.007905e-14 
outer mgc:  421.365 
iter: 1  value: 2203.009 mgc: 17.28185 ustep: 1 
iter: 2  value: 2201.372 mgc: 1.388599 ustep: 1 
iter: 3  value: 2201.372 mgc: 0.0213488 ustep: 1 
iter: 4  value: 2201.372 mgc: 8.978713e-06 ustep: 1 
iter: 5  mgc: 5.249023e-12 
iter: 1  mgc: 5.249023e-12 
outer mgc:  167.2375 
iter: 1  value: 2097.783 mgc: 24.39318 ustep: 1 
iter: 2  value: 2093.495 mgc: 3.288156 ustep: 1 
iter: 3  value: 2093.492 mgc: 0.1569933 ustep: 1 
iter: 4  value: 2093.492 mgc: 0.001268002 ustep: 1 
iter: 5  value: 2093.492 mgc: 2.263559e-07 ustep: 1 
iter: 6  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  84.38635 
iter: 1  value: 2637.411 mgc: 45.51764 ustep: 1 
iter: 2  value: 2295.182 mgc: 23.33057 ustep: 1 
iter: 3  value: 2289.882 mgc: 2.853938 ustep: 1 
iter: 4  value: 2289.877 mgc: 0.1144993 ustep: 1 
iter: 5  value: 2289.877 mgc: 0.0003352585 ustep: 1 
iter: 6  mgc: 2.899917e-09 
iter: 1  value: 2081.185 mgc: 10.26102 ustep: 1 
iter: 2  value: 2080.924 mgc: 0.5644406 ustep: 1 
iter: 3  value: 2080.924 mgc: 0.003422591 ustep: 1 
iter: 4  value: 2080.924 mgc: 2.409244e-07 ustep: 1 
iter: 5  mgc: 4.746203e-14 
iter: 1  mgc: 4.746203e-14 
outer mgc:  92.989 
iter: 1  value: 2069.875 mgc: 1.190093 ustep: 1 
iter: 2  value: 2069.875 mgc: 0.007711977 ustep: 1 
iter: 3  value: 2069.875 mgc: 3.921719e-06 ustep: 1 
iter: 4  mgc: 2.027267e-12 
iter: 1  mgc: 2.027267e-12 
outer mgc:  74.95046 
iter: 1  value: 2045.372 mgc: 19.93833 ustep: 1 
iter: 2  value: 2041.045 mgc: 2.360024 ustep: 1 
iter: 3  value: 2041.044 mgc: 0.05339754 ustep: 1 
iter: 4  value: 2041.044 mgc: 7.810144e-05 ustep: 1 
iter: 5  mgc: 2.813516e-10 
iter: 1  mgc: 2.813516e-10 
outer mgc:  71.73444 
iter: 1  value: 2026.766 mgc: 27.79492 ustep: 1 
iter: 2  value: 1997.566 mgc: 5.249816 ustep: 1 
iter: 3  value: 1997.503 mgc: 0.2820174 ustep: 1 
iter: 4  value: 1997.503 mgc: 0.002247686 ustep: 1 
iter: 5  value: 1997.503 mgc: 1.457871e-07 ustep: 1 
iter: 6  mgc: 4.22995e-14 
iter: 1  mgc: 4.22995e-14 
outer mgc:  46.20808 
iter: 1  value: 2035.364 mgc: 20.62621 ustep: 1 
iter: 2  value: 2029.391 mgc: 2.605138 ustep: 1 
iter: 3  value: 2029.389 mgc: 0.06105706 ustep: 1 
iter: 4  value: 2029.389 mgc: 6.065688e-05 ustep: 1 
iter: 5  mgc: 6.000467e-11 
iter: 1  value: 2004.596 mgc: 8.59691 ustep: 1 
iter: 2  value: 2004.49 mgc: 0.3775924 ustep: 1 
iter: 3  value: 2004.49 mgc: 0.001424215 ustep: 1 
iter: 4  value: 2004.49 mgc: 3.769064e-08 ustep: 1 
mgc: 3.452794e-14 
iter: 1  value: 1994.137 mgc: 3.182317 ustep: 1 
iter: 2  value: 1994.135 mgc: 0.04760878 ustep: 1 
iter: 3  value: 1994.135 mgc: 2.420497e-05 ustep: 1 
iter: 4  mgc: 1.101619e-11 
iter: 1  mgc: 1.101619e-11 
outer mgc:  36.28132 
iter: 1  value: 1991.059 mgc: 3.488824 ustep: 1 
iter: 2  value: 1991.059 mgc: 0.03468462 ustep: 1 
iter: 3  value: 1991.059 mgc: 6.583637e-06 ustep: 1 
iter: 4  mgc: 5.857537e-13 
iter: 1  mgc: 5.857537e-13 
outer mgc:  32.49359 
iter: 1  value: 1984.898 mgc: 3.036344 ustep: 1 
iter: 2  value: 1984.894 mgc: 0.07768815 ustep: 1 
iter: 3  value: 1984.894 mgc: 4.225324e-05 ustep: 1 
iter: 4  mgc: 4.122436e-11 
iter: 1  mgc: 4.122436e-11 
outer mgc:  43.85135 
iter: 1  value: 1975.95 mgc: 11.46533 ustep: 1 
iter: 2  value: 1975.806 mgc: 0.3887183 ustep: 1 
iter: 3  value: 1975.806 mgc: 0.002264151 ustep: 1 
iter: 4  value: 1975.806 mgc: 1.145893e-07 ustep: 1 
iter: 5  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  50.04745 
iter: 1  value: 1980.797 mgc: 13.30713 ustep: 1 
iter: 2  value: 1980.336 mgc: 0.8868232 ustep: 1 
iter: 3  value: 1980.336 mgc: 0.00464989 ustep: 1 
iter: 4  value: 1980.336 mgc: 3.135496e-07 ustep: 1 
iter: 5  mgc: 4.352074e-14 
iter: 1  value: 1974.667 mgc: 6.771696 ustep: 1 
iter: 2  value: 1974.643 mgc: 0.2109765 ustep: 1 
iter: 3  value: 1974.643 mgc: 0.0003018608 ustep: 1 
iter: 4  mgc: 1.48629e-09 
iter: 1  mgc: 1.48629e-09 
outer mgc:  36.00614 
iter: 1  value: 1972.331 mgc: 6.053839 ustep: 1 
iter: 2  value: 1972.328 mgc: 0.0883507 ustep: 1 
iter: 3  value: 1972.328 mgc: 5.160328e-05 ustep: 1 
iter: 4  mgc: 2.702838e-11 
iter: 1  mgc: 2.702838e-11 
outer mgc:  26.95621 
iter: 1  value: 1972.892 mgc: 2.64097 ustep: 1 
iter: 2  value: 1972.891 mgc: 0.0443772 ustep: 1 
iter: 3  value: 1972.891 mgc: 4.060959e-05 ustep: 1 
iter: 4  mgc: 3.57625e-11 
iter: 1  value: 1972.009 mgc: 1.131446 ustep: 1 
iter: 2  value: 1972.009 mgc: 0.00772671 ustep: 1 
iter: 3  value: 1972.009 mgc: 1.100345e-06 ustep: 1 
iter: 4  mgc: 3.963496e-14 
iter: 1  mgc: 3.963496e-14 
outer mgc:  20.58562 
iter: 1  value: 1971.675 mgc: 1.428711 ustep: 1 
iter: 2  value: 1971.675 mgc: 0.006242636 ustep: 1 
iter: 3  value: 1971.675 mgc: 6.626922e-07 ustep: 1 
iter: 4  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  12.9216 
iter: 1  value: 1971.005 mgc: 0.7849106 ustep: 1 
iter: 2  value: 1971.005 mgc: 0.007437014 ustep: 1 
iter: 3  value: 1971.005 mgc: 7.873574e-07 ustep: 1 
iter: 4  mgc: 4.485301e-14 
iter: 1  mgc: 4.485301e-14 
outer mgc:  9.469403 
iter: 1  value: 1970.716 mgc: 3.395882 ustep: 1 
iter: 2  value: 1970.716 mgc: 0.03410054 ustep: 1 
iter: 3  value: 1970.716 mgc: 9.078864e-06 ustep: 1 
iter: 4  mgc: 1.146416e-12 
iter: 1  value: 1970.886 mgc: 1.680645 ustep: 1 
iter: 2  value: 1970.886 mgc: 0.00985304 ustep: 1 
iter: 3  value: 1970.886 mgc: 9.32068e-07 ustep: 1 
iter: 4  mgc: 3.38618e-14 
iter: 1  mgc: 3.38618e-14 
outer mgc:  14.28619 
iter: 1  value: 1970.893 mgc: 0.9548013 ustep: 1 
iter: 2  value: 1970.893 mgc: 0.004125328 ustep: 1 
iter: 3  value: 1970.893 mgc: 1.370717e-07 ustep: 1 
iter: 4  mgc: 3.530509e-14 
iter: 1  mgc: 3.530509e-14 
outer mgc:  6.150372 
iter: 1  value: 1970.95 mgc: 0.8083444 ustep: 1 
iter: 2  value: 1970.95 mgc: 0.001791913 ustep: 1 
iter: 3  value: 1970.95 mgc: 4.957864e-08 ustep: 1 
iter: 4  mgc: 3.189116e-14 
iter: 1  mgc: 3.189116e-14 
outer mgc:  4.404146 
iter: 1  value: 1970.761 mgc: 0.8898362 ustep: 1 
iter: 2  value: 1970.761 mgc: 0.001967124 ustep: 1 
iter: 3  value: 1970.761 mgc: 1.357194e-08 ustep: 1 
mgc: 4.463097e-14 
iter: 1  mgc: 4.463097e-14 
outer mgc:  4.410425 
iter: 1  value: 1970.699 mgc: 0.9483985 ustep: 1 
iter: 2  value: 1970.699 mgc: 0.003361194 ustep: 1 
iter: 3  value: 1970.699 mgc: 1.142985e-07 ustep: 1 
iter: 4  mgc: 5.195844e-14 
iter: 1  mgc: 5.195844e-14 
outer mgc:  3.943053 
iter: 1  value: 1970.659 mgc: 0.8542976 ustep: 1 
iter: 2  value: 1970.659 mgc: 0.002316021 ustep: 1 
iter: 3  value: 1970.659 mgc: 4.122446e-08 ustep: 1 
mgc: 4.52971e-14 
iter: 1  value: 1970.681 mgc: 0.6218014 ustep: 1 
iter: 2  value: 1970.681 mgc: 0.001271847 ustep: 1 
iter: 3  value: 1970.681 mgc: 1.318609e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  value: 1970.675 mgc: 0.2991187 ustep: 1 
iter: 2  value: 1970.675 mgc: 0.0002953112 ustep: 1 
iter: 3  mgc: 7.092645e-10 
iter: 1  mgc: 7.092645e-10 
outer mgc:  1.421888 
iter: 1  value: 1970.697 mgc: 0.1093692 ustep: 1 
iter: 2  value: 1970.697 mgc: 3.124003e-05 ustep: 1 
iter: 3  mgc: 1.397224e-11 
iter: 1  mgc: 1.397224e-11 
outer mgc:  1.746668 
iter: 1  value: 1970.696 mgc: 0.1946002 ustep: 1 
iter: 2  value: 1970.696 mgc: 0.0001028467 ustep: 1 
iter: 3  mgc: 1.567431e-10 
iter: 1  mgc: 1.567431e-10 
outer mgc:  0.9674576 
iter: 1  value: 1970.7 mgc: 0.08123917 ustep: 1 
iter: 2  value: 1970.7 mgc: 5.26484e-05 ustep: 1 
iter: 3  mgc: 1.401645e-11 
iter: 1  mgc: 1.401645e-11 
outer mgc:  0.4585681 
iter: 1  value: 1970.693 mgc: 0.05291553 ustep: 1 
iter: 2  value: 1970.693 mgc: 1.550265e-05 ustep: 1 
iter: 3  mgc: 3.904432e-12 
iter: 1  mgc: 3.904432e-12 
outer mgc:  0.5582204 
iter: 1  value: 1970.666 mgc: 0.1009277 ustep: 1 
iter: 2  value: 1970.666 mgc: 5.356374e-05 ustep: 1 
iter: 3  mgc: 4.477307e-11 
iter: 1  mgc: 4.477307e-11 
outer mgc:  0.3327335 
iter: 1  value: 1970.718 mgc: 0.1343634 ustep: 1 
iter: 2  value: 1970.718 mgc: 7.5316e-05 ustep: 1 
iter: 3  mgc: 2.431699e-11 
iter: 1  value: 1970.688 mgc: 0.0596862 ustep: 1 
iter: 2  value: 1970.688 mgc: 1.484449e-05 ustep: 1 
iter: 3  mgc: 9.299228e-13 
iter: 1  mgc: 9.299228e-13 
outer mgc:  0.2244163 
iter: 1  value: 1970.692 mgc: 0.05087884 ustep: 1 
iter: 2  value: 1970.692 mgc: 9.030753e-06 ustep: 1 
iter: 3  mgc: 1.295852e-12 
iter: 1  mgc: 1.295852e-12 
outer mgc:  0.4781716 
iter: 1  value: 1970.698 mgc: 0.02960421 ustep: 1 
iter: 2  value: 1970.698 mgc: 3.221201e-06 ustep: 1 
iter: 3  mgc: 1.474376e-13 
iter: 1  mgc: 1.474376e-13 
outer mgc:  0.2374169 
iter: 1  value: 1970.697 mgc: 0.04120658 ustep: 1 
iter: 2  value: 1970.697 mgc: 5.355121e-06 ustep: 1 
iter: 3  mgc: 3.077538e-13 
iter: 1  mgc: 3.077538e-13 
outer mgc:  0.2120743 
iter: 1  value: 1970.69 mgc: 0.02941209 ustep: 1 
iter: 2  value: 1970.69 mgc: 2.839865e-06 ustep: 1 
iter: 3  mgc: 1.250111e-13 
iter: 1  mgc: 1.250111e-13 
outer mgc:  0.08283845 
iter: 1  value: 1970.715 mgc: 0.02455079 ustep: 1 
iter: 2  value: 1970.715 mgc: 4.699137e-06 ustep: 1 
iter: 3  mgc: 5.808687e-13 
iter: 1  value: 1970.696 mgc: 0.003381258 ustep: 1 
iter: 2  value: 1970.696 mgc: 1.343178e-07 ustep: 1 
iter: 3  mgc: 4.196643e-14 
iter: 1  mgc: 4.196643e-14 
outer mgc:  0.01625865 
iter: 1  value: 1970.696 mgc: 0.001905771 ustep: 1 
iter: 2  value: 1970.696 mgc: 4.405575e-08 ustep: 1 
iter: 3  mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  0.02123758 
iter: 1  value: 1970.696 mgc: 0.001881058 ustep: 1 
iter: 2  value: 1970.696 mgc: 1.095429e-08 ustep: 1 
mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  0.007789775 
iter: 1  value: 1970.696 mgc: 0.0004569884 ustep: 1 
iter: 2  mgc: 7.53885e-10 
iter: 1  mgc: 7.53885e-10 
outer mgc:  0.0007581131 
iter: 1  mgc: 7.53885e-10 
iter: 1  mgc: 7.53885e-10 
outer mgc:  0.0007581131 
iter: 1  value: 1970.694 mgc: 0.04985654 ustep: 1 
iter: 2  value: 1970.694 mgc: 8.841984e-06 ustep: 1 
iter: 3  mgc: 6.045373e-13 
outer mgc:  0.3034419 
iter: 1  value: 1970.699 mgc: 0.04984143 ustep: 1 
iter: 2  value: 1970.699 mgc: 8.854624e-06 ustep: 1 
iter: 3  mgc: 6.138701e-13 
outer mgc:  0.3028876 
iter: 1  value: 1970.696 mgc: 0.02590068 ustep: 1 
iter: 2  value: 1970.696 mgc: 3.202774e-06 ustep: 1 
iter: 3  mgc: 9.769963e-14 
outer mgc:  0.7629049 
iter: 1  value: 1970.697 mgc: 0.02589443 ustep: 1 
iter: 2  value: 1970.697 mgc: 3.203678e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
outer mgc:  0.7644082 
iter: 1  value: 1970.7 mgc: 0.05469633 ustep: 1 
iter: 2  value: 1970.7 mgc: 8.657618e-06 ustep: 1 
iter: 3  mgc: 6.492584e-13 
outer mgc:  0.3135087 
iter: 1  value: 1970.693 mgc: 0.05470166 ustep: 1 
iter: 2  value: 1970.693 mgc: 8.647244e-06 ustep: 1 
iter: 3  mgc: 6.030731e-13 
outer mgc:  0.3142464 
iter: 1  value: 1970.7 mgc: 0.02748377 ustep: 1 
iter: 2  value: 1970.7 mgc: 2.542638e-06 ustep: 1 
iter: 3  mgc: 6.539214e-14 
outer mgc:  1.134412 
iter: 1  value: 1970.693 mgc: 0.02748443 ustep: 1 
iter: 2  value: 1970.693 mgc: 2.542124e-06 ustep: 1 
iter: 3  mgc: 7.460699e-14 
outer mgc:  1.133674 
iter: 1  value: 1970.69 mgc: 0.00453464 ustep: 1 
iter: 2  value: 1970.69 mgc: 4.895879e-07 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  0.03920557 
iter: 1  value: 1970.702 mgc: 0.004531725 ustep: 1 
iter: 2  value: 1970.702 mgc: 4.893283e-07 ustep: 1 
iter: 3  mgc: 3.780309e-14 
outer mgc:  0.0390686 
iter: 1  value: 1970.711 mgc: 0.01104394 ustep: 1 
iter: 2  value: 1970.711 mgc: 2.059091e-06 ustep: 1 
iter: 3  mgc: 8.748557e-14 
outer mgc:  0.3284428 
iter: 1  value: 1970.681 mgc: 0.01107177 ustep: 1 
iter: 2  value: 1970.681 mgc: 2.066175e-06 ustep: 1 
iter: 3  mgc: 9.192647e-14 
outer mgc:  0.3297565 
iter: 1  value: 1970.703 mgc: 0.01321147 ustep: 1 
iter: 2  value: 1970.703 mgc: 3.341494e-06 ustep: 1 
iter: 3  mgc: 4.725109e-13 
outer mgc:  0.3559472 
iter: 1  value: 1970.689 mgc: 0.01324309 ustep: 1 
iter: 2  value: 1970.689 mgc: 3.358383e-06 ustep: 1 
iter: 3  mgc: 4.600764e-13 
outer mgc:  0.3552713 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:39:22 2021]
Finished job 0.
1 of 1 steps (100%) done

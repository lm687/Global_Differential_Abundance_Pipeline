Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:40:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_10_100_10_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2204.914863 
final  value 1933.322582 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1901.116 mgc: 5.048443 ustep: 0.8994163 
iter: 2  value: 1885.149 mgc: 4.269061 ustep: 0.772724 
iter: 3  value: 1884.352 mgc: 3.446485 ustep: 0.8790593 
iter: 4  value: 1881.772 mgc: 2.662727 ustep: 0.9375879 
iter: 5  value: 1879.496 mgc: 3.157061 ustep: 0.8218571 
iter: 6  value: 1878.577 mgc: 1.21772 ustep: 0.9065727 
iter: 7  value: 1878.569 mgc: 0.1796302 ustep: 0.9521459 
iter: 8  value: 1878.569 mgc: 0.001202069 ustep: 0.9757821 
iter: 9  value: 1878.569 mgc: 2.255548e-05 ustep: 0.987818 
iter: 10  value: 1878.569 mgc: 2.29145e-07 ustep: 0.993891 
iter: 11  mgc: 1.231805e-09 
iter: 1  mgc: 1.231805e-09 
Matching hessian patterns... Done
outer mgc:  9.752706 
iter: 1  value: 1858.472 mgc: 2.169017 ustep: 1 
iter: 2  value: 1857.951 mgc: 0.7796397 ustep: 1 
iter: 3  value: 1857.95 mgc: 0.03630902 ustep: 1 
iter: 4  value: 1857.95 mgc: 0.0001066916 ustep: 1 
iter: 5  mgc: 9.463708e-10 
iter: 1  value: 1899.61 mgc: 13.7258 ustep: 1 
iter: 2  value: 1860.742 mgc: 19.35078 ustep: 1 
iter: 3  value: 1857.388 mgc: 6.258355 ustep: 1 
iter: 4  value: 1857.323 mgc: 1.212036 ustep: 1 
iter: 5  value: 1857.323 mgc: 0.01869658 ustep: 1 
iter: 6  value: 1857.323 mgc: 3.852933e-05 ustep: 1 
iter: 7  mgc: 4.454392e-11 
iter: 1  mgc: 9.463708e-10 
outer mgc:  7.44902 
iter: 1  value: 1843.836 mgc: 8.153653 ustep: 1 
iter: 2  value: 1836.415 mgc: 5.703244 ustep: 1 
iter: 3  value: 1836.327 mgc: 0.6008222 ustep: 1 
iter: 4  value: 1836.327 mgc: 0.01556261 ustep: 1 
iter: 5  value: 1836.327 mgc: 1.198968e-05 ustep: 1 
iter: 6  mgc: 7.013501e-12 
iter: 1  mgc: 7.013501e-12 
outer mgc:  12.20355 
iter: 1  value: 1866.995 mgc: 29.60686 ustep: 1 
iter: 2  value: 1864.77 mgc: 4.553241 ustep: 1 
iter: 3  value: 1864.77 mgc: 0.07923104 ustep: 1 
iter: 4  value: 1864.77 mgc: 7.083134e-06 ustep: 1 
iter: 5  mgc: 4.267697e-13 
iter: 1  value: 1829.254 mgc: 3.341245 ustep: 1 
iter: 2  value: 1829.249 mgc: 0.1283042 ustep: 1 
iter: 3  value: 1829.249 mgc: 0.0009098588 ustep: 1 
iter: 4  value: 1829.249 mgc: 1.120008e-08 ustep: 1 
mgc: 4.413137e-15 
iter: 1  mgc: 4.413137e-15 
outer mgc:  4.240303 
iter: 1  value: 1824.924 mgc: 2.822 ustep: 1 
iter: 2  value: 1824.923 mgc: 0.04770023 ustep: 1 
iter: 3  value: 1824.923 mgc: 0.0001277096 ustep: 1 
iter: 4  mgc: 3.256666e-10 
iter: 1  mgc: 3.256666e-10 
outer mgc:  5.463654 
iter: 1  value: 1821.785 mgc: 2.78093 ustep: 1 
iter: 2  value: 1821.784 mgc: 0.1152244 ustep: 1 
iter: 3  value: 1821.784 mgc: 0.000184314 ustep: 1 
iter: 4  mgc: 4.554053e-10 
iter: 1  mgc: 4.554053e-10 
outer mgc:  3.771182 
iter: 1  value: 1819.333 mgc: 2.493919 ustep: 1 
iter: 2  value: 1819.333 mgc: 0.03347902 ustep: 1 
iter: 3  value: 1819.333 mgc: 1.323215e-05 ustep: 1 
iter: 4  mgc: 1.795009e-12 
iter: 1  mgc: 1.795009e-12 
outer mgc:  2.517461 
iter: 1  value: 1817.035 mgc: 1.154015 ustep: 1 
iter: 2  value: 1817.035 mgc: 0.01388509 ustep: 1 
iter: 3  value: 1817.035 mgc: 2.27776e-06 ustep: 1 
iter: 4  mgc: 1.34226e-13 
iter: 1  mgc: 1.34226e-13 
outer mgc:  5.515985 
iter: 1  value: 1816.213 mgc: 1.415651 ustep: 1 
iter: 2  value: 1816.213 mgc: 0.00437422 ustep: 1 
iter: 3  value: 1816.213 mgc: 2.927224e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  2.511964 
iter: 1  value: 1815.092 mgc: 0.5407522 ustep: 1 
iter: 2  value: 1815.092 mgc: 0.003126161 ustep: 1 
iter: 3  value: 1815.092 mgc: 7.517732e-08 ustep: 1 
iter: 4  mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  1.712917 
iter: 1  value: 1814.491 mgc: 0.8708512 ustep: 1 
iter: 2  value: 1814.491 mgc: 0.005083552 ustep: 1 
iter: 3  value: 1814.491 mgc: 9.479723e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  value: 1814.702 mgc: 0.3600438 ustep: 1 
iter: 2  value: 1814.702 mgc: 0.0009975387 ustep: 1 
iter: 3  mgc: 3.865807e-09 
iter: 1  mgc: 3.865807e-09 
outer mgc:  1.222648 
iter: 1  value: 1814.258 mgc: 0.2441312 ustep: 1 
iter: 2  value: 1814.258 mgc: 0.0004879424 ustep: 1 
iter: 3  mgc: 5.305533e-10 
iter: 1  value: 1813.421 mgc: 0.3507274 ustep: 1 
iter: 2  value: 1813.421 mgc: 0.001293504 ustep: 1 
iter: 3  value: 1813.421 mgc: 1.092097e-08 ustep: 1 
mgc: 9.325873e-15 
iter: 1  value: 1811.517 mgc: 0.8331353 ustep: 1 
iter: 2  value: 1811.517 mgc: 0.004213812 ustep: 1 
iter: 3  value: 1811.517 mgc: 3.32066e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.493109 
iter: 1  value: 1807.78 mgc: 2.719429 ustep: 1 
iter: 2  value: 1807.78 mgc: 0.006108283 ustep: 1 
iter: 3  value: 1807.78 mgc: 2.712456e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  value: 1810.319 mgc: 0.6640731 ustep: 1 
iter: 2  value: 1810.319 mgc: 0.00145158 ustep: 1 
iter: 3  mgc: 3.143589e-09 
iter: 1  mgc: 3.143589e-09 
outer mgc:  0.655223 
iter: 1  value: 1808.736 mgc: 0.5657303 ustep: 1 
iter: 2  value: 1808.736 mgc: 0.0006697708 ustep: 1 
iter: 3  mgc: 6.375596e-10 
iter: 1  mgc: 6.375596e-10 
outer mgc:  0.4273192 
iter: 1  value: 1806.826 mgc: 0.6765542 ustep: 1 
iter: 2  value: 1806.826 mgc: 0.0004226968 ustep: 1 
iter: 3  mgc: 1.544169e-10 
iter: 1  value: 1804.285 mgc: 0.9192221 ustep: 1 
iter: 2  value: 1804.285 mgc: 0.0005652918 ustep: 1 
iter: 3  mgc: 1.199388e-09 
iter: 1  mgc: 1.199388e-09 
outer mgc:  0.458312 
iter: 1  value: 1799.168 mgc: 2.313518 ustep: 1 
iter: 2  value: 1799.168 mgc: 0.002709611 ustep: 1 
iter: 3  value: 1799.168 mgc: 1.688e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.4002283 
iter: 1  value: 1798.392 mgc: 0.383063 ustep: 1 
iter: 2  value: 1798.392 mgc: 0.0001669923 ustep: 1 
iter: 3  mgc: 5.753709e-11 
iter: 1  mgc: 5.753709e-11 
outer mgc:  0.06439143 
iter: 1  value: 1797.589 mgc: 0.2539241 ustep: 1 
iter: 2  value: 1797.589 mgc: 5.66569e-05 ustep: 1 
iter: 3  mgc: 6.197709e-12 
iter: 1  mgc: 6.197709e-12 
outer mgc:  0.0252995 
iter: 1  value: 1796.843 mgc: 0.2212709 ustep: 1 
iter: 2  value: 1796.843 mgc: 2.893043e-05 ustep: 1 
iter: 3  mgc: 1.541878e-12 
iter: 1  mgc: 1.541878e-12 
outer mgc:  0.02217008 
iter: 1  value: 1795.446 mgc: 0.4600787 ustep: 1 
iter: 2  value: 1795.446 mgc: 4.273404e-05 ustep: 1 
iter: 3  mgc: 3.171685e-12 
iter: 1  mgc: 3.171685e-12 
outer mgc:  0.03925123 
iter: 1  value: 1794.385 mgc: 0.3704912 ustep: 1 
iter: 2  value: 1794.385 mgc: 1.62856e-06 ustep: 1 
iter: 3  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.04561069 
iter: 1  value: 1792.803 mgc: 0.6908455 ustep: 1 
iter: 2  value: 1792.803 mgc: 0.0001228611 ustep: 1 
iter: 3  mgc: 2.865352e-11 
iter: 1  mgc: 2.865352e-11 
outer mgc:  0.04384391 
iter: 1  value: 1791.525 mgc: 1.12153 ustep: 1 
iter: 2  value: 1791.525 mgc: 0.0009326318 ustep: 1 
iter: 3  mgc: 2.078437e-09 
iter: 1  mgc: 2.078437e-09 
outer mgc:  0.02818238 
iter: 1  value: 1790.676 mgc: 1.337971 ustep: 1 
iter: 2  value: 1790.676 mgc: 0.001082316 ustep: 1 
iter: 3  mgc: 3.485061e-09 
iter: 1  mgc: 3.485061e-09 
outer mgc:  0.005446871 
iter: 1  value: 1790.046 mgc: 0.4951011 ustep: 1 
iter: 2  value: 1790.046 mgc: 1.2582e-05 ustep: 1 
iter: 3  mgc: 4.871659e-13 
iter: 1  mgc: 4.871659e-13 
outer mgc:  0.0152704 
iter: 1  value: 1788.106 mgc: 2.029386 ustep: 1 
iter: 2  value: 1788.106 mgc: 2.811968e-06 ustep: 1 
iter: 3  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  0.03231343 
iter: 1  value: 1786.386 mgc: 2.262165 ustep: 1 
iter: 2  value: 1786.386 mgc: 2.403771e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.02120677 
iter: 1  value: 1784.473 mgc: 3.004467 ustep: 1 
iter: 2  value: 1784.473 mgc: 3.222284e-06 ustep: 1 
iter: 3  mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  0.005081497 
iter: 1  value: 1783.081 mgc: 1.712116 ustep: 1 
iter: 2  value: 1783.081 mgc: 4.958074e-07 ustep: 1 
iter: 3  mgc: 4.574119e-14 
iter: 1  mgc: 4.574119e-14 
outer mgc:  0.006911922 
iter: 1  value: 1781.474 mgc: 0.8404589 ustep: 1 
iter: 2  value: 1781.474 mgc: 3.043683e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.009530347 
iter: 1  value: 1779.515 mgc: 4.141974 ustep: 1 
iter: 2  value: 1779.515 mgc: 2.63227e-07 ustep: 1 
iter: 3  mgc: 1.176836e-13 
iter: 1  mgc: 1.176836e-13 
outer mgc:  0.006531069 
iter: 1  value: 1777.29 mgc: 15.71447 ustep: 1 
iter: 2  value: 1777.29 mgc: 1.250826e-06 ustep: 1 
iter: 3  mgc: 1.29674e-13 
iter: 1  mgc: 1.29674e-13 
outer mgc:  0.002814494 
iter: 1  value: 1775.458 mgc: 25.01199 ustep: 1 
iter: 2  value: 1775.458 mgc: 2.133821e-06 ustep: 1 
iter: 3  mgc: 2.069456e-13 
iter: 1  mgc: 2.069456e-13 
outer mgc:  0.002553198 
iter: 1  value: 1773.908 mgc: 29.69387 ustep: 1 
iter: 2  value: 1773.908 mgc: 2.59534e-06 ustep: 1 
iter: 3  mgc: 3.756995e-13 
iter: 1  mgc: 3.756995e-13 
outer mgc:  0.002754099 
iter: 1  value: 1773.071 mgc: 13.72954 ustep: 1 
iter: 2  value: 1773.071 mgc: 9.143944e-07 ustep: 1 
iter: 3  mgc: 3.366196e-13 
iter: 1  mgc: 3.366196e-13 
outer mgc:  0.00139362 
iter: 1  value: 1772.296 mgc: 7.178575 ustep: 1 
iter: 2  value: 1772.296 mgc: 4.721859e-07 ustep: 1 
iter: 3  mgc: 4.112266e-13 
iter: 1  mgc: 4.112266e-13 
outer mgc:  0.001728271 
iter: 1  value: 1770.923 mgc: 2.517634 ustep: 1 
iter: 2  value: 1770.923 mgc: 4.230502e-07 ustep: 1 
iter: 3  mgc: 3.099743e-13 
iter: 1  mgc: 3.099743e-13 
outer mgc:  0.002948694 
iter: 1  value: 1769.175 mgc: 16.80241 ustep: 1 
iter: 2  value: 1769.175 mgc: 6.268731e-08 ustep: 1 
mgc: 5.990763e-13 
iter: 1  mgc: 5.990763e-13 
outer mgc:  0.004626245 
iter: 1  value: 1767.083 mgc: 53.14665 ustep: 1 
iter: 2  value: 1767.083 mgc: 9.761059e-07 ustep: 1 
iter: 3  mgc: 1.049383e-12 
iter: 1  mgc: 1.049383e-12 
outer mgc:  0.003885879 
iter: 1  value: 1765.368 mgc: 58.28553 ustep: 1 
iter: 2  value: 1765.368 mgc: 1.385964e-06 ustep: 1 
iter: 3  mgc: 1.544986e-12 
iter: 1  mgc: 1.544986e-12 
outer mgc:  0.001414395 
iter: 1  value: 1764.094 mgc: 29.15705 ustep: 1 
iter: 2  value: 1764.094 mgc: 4.310014e-07 ustep: 1 
iter: 3  mgc: 3.427481e-12 
iter: 1  mgc: 3.427481e-12 
outer mgc:  0.0005738864 
iter: 1  value: 1762.958 mgc: 3.481487 ustep: 1 
iter: 2  value: 1762.958 mgc: 5.7747e-08 ustep: 1 
mgc: 2.326583e-12 
iter: 1  mgc: 2.326583e-12 
outer mgc:  0.001623726 
iter: 1  value: 1761.081 mgc: 31.31961 ustep: 1 
iter: 2  mgc: 8.546273e-09 
iter: 1  mgc: 8.546273e-09 
outer mgc:  0.002184962 
iter: 1  value: 1759.096 mgc: 72.68343 ustep: 1 
iter: 2  value: 1759.096 mgc: 1.199063e-07 ustep: 1 
mgc: 5.085266e-12 
iter: 1  mgc: 5.085266e-12 
outer mgc:  0.001518767 
iter: 1  value: 1757.438 mgc: 61.23073 ustep: 1 
iter: 2  value: 1757.438 mgc: 1.153696e-07 ustep: 1 
mgc: 8.129497e-12 
iter: 1  mgc: 8.129497e-12 
outer mgc:  0.0004955615 
iter: 1  value: 1756.016 mgc: 28.34713 ustep: 1 
iter: 2  value: 1756.016 mgc: 3.925434e-08 ustep: 1 
mgc: 9.445333e-12 
iter: 1  mgc: 9.445333e-12 
outer mgc:  0.0002480044 
iter: 1  mgc: 9.445333e-12 
iter: 1  mgc: 9.445333e-12 
outer mgc:  0.0002480044 
iter: 1  value: 1756.015 mgc: 0.005418641 ustep: 1 
iter: 2  value: 1756.015 mgc: 8.16664e-08 ustep: 1 
mgc: 7.03837e-12 
outer mgc:  0.03607572 
iter: 1  value: 1756.017 mgc: 0.005414564 ustep: 1 
iter: 2  value: 1756.017 mgc: 8.165073e-08 ustep: 1 
mgc: 6.997514e-12 
outer mgc:  0.03642444 
iter: 1  value: 1756.016 mgc: 0.003170236 ustep: 1 
iter: 2  value: 1756.016 mgc: 2.971432e-08 ustep: 1 
mgc: 8.807177e-12 
outer mgc:  0.01649773 
iter: 1  value: 1756.016 mgc: 0.003168461 ustep: 1 
iter: 2  value: 1756.016 mgc: 2.97007e-08 ustep: 1 
mgc: 1.519318e-11 
outer mgc:  0.01697856 
iter: 1  value: 1756.016 mgc: 0.006980132 ustep: 1 
iter: 2  value: 1756.016 mgc: 9.451694e-08 ustep: 1 
mgc: 1.539924e-11 
outer mgc:  0.0506439 
iter: 1  value: 1756.016 mgc: 0.006980694 ustep: 1 
iter: 2  value: 1756.016 mgc: 9.445551e-08 ustep: 1 
mgc: 1.707079e-11 
outer mgc:  0.0505639 
iter: 1  value: 1756.016 mgc: 0.003708774 ustep: 1 
iter: 2  value: 1756.016 mgc: 3.152039e-08 ustep: 1 
mgc: 5.603518e-12 
outer mgc:  0.02682304 
iter: 1  value: 1756.016 mgc: 0.003709562 ustep: 1 
iter: 2  value: 1756.016 mgc: 3.151478e-08 ustep: 1 
mgc: 5.488499e-12 
outer mgc:  0.02681325 
iter: 1  value: 1756.025 mgc: 61.29468 ustep: 1 
iter: 2  value: 1756.025 mgc: 1.021747e-07 ustep: 1 
mgc: 1.01199e-11 
outer mgc:  0.0009132209 
iter: 1  value: 1756.007 mgc: 61.35601 ustep: 1 
iter: 2  value: 1756.007 mgc: 1.019098e-07 ustep: 1 
mgc: 7.542855e-12 
outer mgc:  0.0008275175 
iter: 1  value: 1756.025 mgc: 61.23903 ustep: 1 
iter: 2  value: 1756.025 mgc: 2.104829e-08 ustep: 1 
mgc: 1.651257e-11 
outer mgc:  0.0009729632 
iter: 1  value: 1756.007 mgc: 61.42302 ustep: 1 
iter: 2  value: 1756.007 mgc: 2.100832e-08 ustep: 1 
mgc: 1.540545e-11 
outer mgc:  0.0008873075 
iter: 1  value: 1756.016 mgc: 3.510735e-05 ustep: 1 
mgc: 1.886624e-11 
outer mgc:  0.0002480043 
iter: 1  value: 1756.016 mgc: 3.510774e-05 ustep: 1 
mgc: 8.038903e-12 
outer mgc:  0.0002480046 
iter: 1  value: 1756.015 mgc: 0.003262013 ustep: 1 
iter: 2  value: 1756.015 mgc: 3.304055e-08 ustep: 1 
mgc: 7.980727e-12 
outer mgc:  0.01469747 
iter: 1  value: 1756.017 mgc: 0.003260217 ustep: 1 
iter: 2  value: 1756.017 mgc: 3.294982e-08 ustep: 1 
mgc: 1.110667e-11 
outer mgc:  0.01477988 
[Fri Aug 13 11:41:00 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:15:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.8_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0.8_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.8_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2238.971844 
iter  10 value 1440.887610
final  value 1440.824745 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 829.7143 mgc: 158.0095 ustep: 1 
iter: 2  value: 480.9881 mgc: 57.75681 ustep: 0.1336527 
iter: 3  value: 368.3786 mgc: 46.34569 ustep: 0.3656489 
iter: 4  value: 362.0074 mgc: 7.680145 ustep: 0.6047286 
iter: 5  value: 361.763 mgc: 1.084559 ustep: 0.7776652 
iter: 6  value: 361.761 mgc: 0.1053214 ustep: 0.8818651 
iter: 7  value: 361.761 mgc: 0.003731246 ustep: 0.9390828 
iter: 8  value: 361.761 mgc: 5.358826e-05 ustep: 0.969066 
iter: 9  value: 361.761 mgc: 3.883711e-07 ustep: 0.984413 
iter: 10  mgc: 1.612926e-09 
iter: 1  mgc: 1.612926e-09 
Matching hessian patterns... Done
outer mgc:  124.4631 
iter: 1  value: 273.8906 mgc: 26.50745 ustep: 1 
iter: 2  value: 272.1744 mgc: 4.478172 ustep: 1 
iter: 3  value: 272.172 mgc: 0.1683167 ustep: 1 
iter: 4  value: 272.172 mgc: 0.0004243814 ustep: 1 
iter: 5  mgc: 3.301842e-09 
iter: 1  mgc: 3.301842e-09 
outer mgc:  43.95962 
iter: 1  value: 234.3601 mgc: 19.51612 ustep: 1 
iter: 2  value: 234.101 mgc: 1.68706 ustep: 1 
iter: 3  value: 234.1009 mgc: 0.02335702 ustep: 1 
iter: 4  value: 234.1009 mgc: 7.660007e-06 ustep: 1 
iter: 5  mgc: 1.063316e-12 
iter: 1  mgc: 1.063316e-12 
outer mgc:  34.68406 
iter: 1  value: 236.4422 mgc: 20.19212 ustep: 1 
iter: 2  value: 235.8576 mgc: 2.601527 ustep: 1 
iter: 3  value: 235.857 mgc: 0.08968978 ustep: 1 
iter: 4  value: 235.857 mgc: 0.0001197627 ustep: 1 
iter: 5  mgc: 3.722435e-10 
iter: 1  value: 214.4316 mgc: 6.001521 ustep: 1 
iter: 2  value: 214.422 mgc: 0.3811223 ustep: 1 
iter: 3  value: 214.422 mgc: 0.002275168 ustep: 1 
iter: 4  value: 214.422 mgc: 8.272972e-08 ustep: 1 
mgc: 2.475797e-14 
iter: 1  mgc: 2.475797e-14 
outer mgc:  26.89415 
iter: 1  value: 208.9887 mgc: 27.12524 ustep: 1 
iter: 2  value: 202.3253 mgc: 7.581828 ustep: 1 
iter: 3  value: 202.2703 mgc: 0.5085686 ustep: 1 
iter: 4  value: 202.2703 mgc: 0.006246456 ustep: 1 
iter: 5  value: 202.2703 mgc: 1.130272e-06 ustep: 1 
iter: 6  mgc: 7.061018e-14 
iter: 1  mgc: 7.061018e-14 
outer mgc:  12.31543 
iter: 1  value: 198.8553 mgc: 25.88571 ustep: 1 
iter: 2  value: 196.5296 mgc: 4.917599 ustep: 1 
iter: 3  value: 196.5249 mgc: 0.2569766 ustep: 1 
iter: 4  value: 196.5249 mgc: 0.001362165 ustep: 1 
iter: 5  value: 196.5249 mgc: 4.091777e-08 ustep: 1 
mgc: 3.408385e-14 
iter: 1  mgc: 3.408385e-14 
outer mgc:  6.105213 
iter: 1  value: 198.0417 mgc: 23.23687 ustep: 1 
iter: 2  value: 196.3641 mgc: 4.01372 ustep: 1 
iter: 3  value: 196.3623 mgc: 0.168471 ustep: 1 
iter: 4  value: 196.3623 mgc: 0.0003554742 ustep: 1 
iter: 5  mgc: 1.592639e-09 
iter: 1  mgc: 1.592639e-09 
outer mgc:  10.31317 
iter: 1  value: 205.3774 mgc: 38.6855 ustep: 1 
iter: 2  value: 191.5606 mgc: 11.68125 ustep: 1 
iter: 3  value: 191.4681 mgc: 1.104177 ustep: 1 
iter: 4  value: 191.4681 mgc: 0.02309831 ustep: 1 
iter: 5  value: 191.4681 mgc: 1.093228e-05 ustep: 1 
iter: 6  mgc: 2.519651e-12 
iter: 1  mgc: 2.519651e-12 
outer mgc:  7.059845 
iter: 1  value: 190.4107 mgc: 13.9247 ustep: 1 
iter: 2  value: 189.8903 mgc: 2.501281 ustep: 1 
iter: 3  value: 189.8899 mgc: 0.06692234 ustep: 1 
iter: 4  value: 189.8899 mgc: 0.0001169537 ustep: 1 
iter: 5  mgc: 3.729568e-10 
iter: 1  mgc: 3.729568e-10 
outer mgc:  8.314622 
iter: 1  value: 198.5713 mgc: 33.21064 ustep: 1 
iter: 2  value: 197.1616 mgc: 3.277889 ustep: 1 
iter: 3  value: 197.158 mgc: 0.2069269 ustep: 1 
iter: 4  value: 197.158 mgc: 0.00121314 ustep: 1 
iter: 5  value: 197.158 mgc: 4.966562e-08 ustep: 1 
mgc: 3.225198e-14 
iter: 1  value: 188.3965 mgc: 9.572622 ustep: 1 
iter: 2  value: 188.38 mgc: 0.3931698 ustep: 1 
iter: 3  value: 188.38 mgc: 0.002700064 ustep: 1 
iter: 4  value: 188.38 mgc: 1.613316e-07 ustep: 1 
iter: 5  mgc: 1.929013e-14 
iter: 1  mgc: 1.929013e-14 
outer mgc:  8.582467 
iter: 1  value: 187.3999 mgc: 4.526362 ustep: 1 
iter: 2  value: 187.3997 mgc: 0.0437735 ustep: 1 
iter: 3  value: 187.3997 mgc: 4.852025e-05 ustep: 1 
iter: 4  mgc: 9.334089e-11 
iter: 1  mgc: 9.334089e-11 
outer mgc:  5.61078 
iter: 1  value: 187.1538 mgc: 5.371032 ustep: 1 
iter: 2  value: 187.1523 mgc: 0.1235806 ustep: 1 
iter: 3  value: 187.1523 mgc: 0.0002607223 ustep: 1 
iter: 4  mgc: 1.64314e-09 
iter: 1  mgc: 1.64314e-09 
outer mgc:  2.659603 
iter: 1  value: 187.0961 mgc: 12.42284 ustep: 1 
iter: 2  value: 187.0694 mgc: 0.5363047 ustep: 1 
iter: 3  value: 187.0694 mgc: 0.002826704 ustep: 1 
iter: 4  value: 187.0694 mgc: 9.187025e-08 ustep: 1 
iter: 5  mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  5.458709 
iter: 1  value: 186.8015 mgc: 5.25667 ustep: 1 
iter: 2  value: 186.8007 mgc: 0.08819431 ustep: 1 
iter: 3  value: 186.8007 mgc: 8.287309e-05 ustep: 1 
iter: 4  mgc: 1.149556e-10 
iter: 1  mgc: 1.149556e-10 
outer mgc:  1.226381 
iter: 1  value: 186.8319 mgc: 1.409272 ustep: 1 
iter: 2  value: 186.8319 mgc: 0.02025941 ustep: 1 
iter: 3  value: 186.8319 mgc: 4.987363e-06 ustep: 1 
iter: 4  mgc: 3.38396e-13 
iter: 1  value: 186.7423 mgc: 0.5507302 ustep: 1 
iter: 2  value: 186.7423 mgc: 0.003180077 ustep: 1 
iter: 3  value: 186.7423 mgc: 1.225049e-07 ustep: 1 
iter: 4  mgc: 3.282097e-14 
iter: 1  mgc: 3.282097e-14 
outer mgc:  1.149132 
iter: 1  value: 186.659 mgc: 0.3007148 ustep: 1 
iter: 2  value: 186.659 mgc: 0.002653765 ustep: 1 
iter: 3  value: 186.659 mgc: 1.216113e-07 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.2702048 
iter: 1  value: 186.7454 mgc: 0.8145974 ustep: 1 
iter: 2  value: 186.7454 mgc: 0.007268659 ustep: 1 
iter: 3  value: 186.7454 mgc: 5.710621e-07 ustep: 1 
iter: 4  mgc: 1.595946e-14 
iter: 1  value: 186.6832 mgc: 0.2834408 ustep: 1 
iter: 2  value: 186.6832 mgc: 0.0008339937 ustep: 1 
iter: 3  mgc: 7.484159e-09 
iter: 1  mgc: 7.484159e-09 
outer mgc:  0.1046546 
iter: 1  value: 186.6566 mgc: 0.1248236 ustep: 1 
iter: 2  value: 186.6566 mgc: 7.092373e-05 ustep: 1 
iter: 3  mgc: 6.223466e-11 
iter: 1  mgc: 6.223466e-11 
outer mgc:  0.1213703 
iter: 1  value: 186.6632 mgc: 0.09459742 ustep: 1 
iter: 2  value: 186.6632 mgc: 9.690614e-05 ustep: 1 
iter: 3  mgc: 1.27476e-10 
iter: 1  value: 186.6603 mgc: 0.06502484 ustep: 1 
iter: 2  value: 186.6603 mgc: 3.771468e-05 ustep: 1 
iter: 3  mgc: 1.56542e-11 
iter: 1  mgc: 1.56542e-11 
outer mgc:  0.09595681 
iter: 1  value: 186.6625 mgc: 0.03404441 ustep: 1 
iter: 2  value: 186.6625 mgc: 5.011191e-06 ustep: 1 
iter: 3  mgc: 6.097345e-13 
iter: 1  mgc: 6.097345e-13 
outer mgc:  0.005622973 
iter: 1  value: 186.6623 mgc: 0.00843092 ustep: 1 
iter: 2  value: 186.6623 mgc: 4.451468e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.002108591 
iter: 1  value: 186.6623 mgc: 0.001426614 ustep: 1 
iter: 2  value: 186.6623 mgc: 1.514014e-08 ustep: 1 
mgc: 3.513856e-14 
iter: 1  mgc: 3.513856e-14 
outer mgc:  0.0001331315 
iter: 1  value: 186.6623 mgc: 4.792111e-05 ustep: 1 
iter: 2  mgc: 6.939116e-11 
iter: 1  mgc: 6.939116e-11 
outer mgc:  3.109518e-05 
iter: 1  mgc: 6.939116e-11 
iter: 1  mgc: 6.939116e-11 
outer mgc:  3.109518e-05 
iter: 1  value: 186.6626 mgc: 0.046508 ustep: 1 
iter: 2  value: 186.6626 mgc: 7.796549e-06 ustep: 1 
iter: 3  mgc: 5.619949e-13 
outer mgc:  0.01801256 
iter: 1  value: 186.662 mgc: 0.04651452 ustep: 1 
iter: 2  value: 186.662 mgc: 7.789662e-06 ustep: 1 
iter: 3  mgc: 5.544454e-13 
outer mgc:  0.01801045 
iter: 1  value: 186.663 mgc: 0.02311121 ustep: 1 
iter: 2  value: 186.663 mgc: 1.154915e-06 ustep: 1 
iter: 3  mgc: 4.47975e-14 
outer mgc:  0.07958947 
iter: 1  value: 186.6617 mgc: 0.02311828 ustep: 1 
iter: 2  value: 186.6617 mgc: 1.155918e-06 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.07957116 
iter: 1  value: 186.6618 mgc: 0.02655581 ustep: 1 
iter: 2  value: 186.6618 mgc: 7.527787e-06 ustep: 1 
iter: 3  mgc: 6.012968e-13 
outer mgc:  0.02259269 
iter: 1  value: 186.6628 mgc: 0.02653729 ustep: 1 
iter: 2  value: 186.6628 mgc: 7.53274e-06 ustep: 1 
iter: 3  mgc: 6.052936e-13 
outer mgc:  0.02257749 
iter: 1  value: 186.662 mgc: 0.01224882 ustep: 1 
iter: 2  value: 186.662 mgc: 1.64177e-06 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.03761494 
iter: 1  value: 186.6626 mgc: 0.01223996 ustep: 1 
iter: 2  value: 186.6626 mgc: 1.640981e-06 ustep: 1 
iter: 3  mgc: 3.98015e-14 
outer mgc:  0.03761127 
iter: 1  value: 186.6618 mgc: 0.002807231 ustep: 1 
iter: 2  value: 186.6618 mgc: 1.934916e-07 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.007194026 
iter: 1  value: 186.6628 mgc: 0.002805707 ustep: 1 
iter: 2  value: 186.6628 mgc: 1.929749e-07 ustep: 1 
iter: 3  mgc: 4.17999e-14 
outer mgc:  0.007181618 
iter: 1  value: 186.663 mgc: 0.004760042 ustep: 1 
iter: 2  value: 186.663 mgc: 3.948706e-07 ustep: 1 
iter: 3  mgc: 2.087219e-14 
outer mgc:  0.01856427 
iter: 1  value: 186.6616 mgc: 0.004769736 ustep: 1 
iter: 2  value: 186.6616 mgc: 3.963134e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
outer mgc:  0.01853016 
iter: 1  value: 186.6649 mgc: 0.006066267 ustep: 1 
iter: 2  value: 186.6649 mgc: 1.270047e-06 ustep: 1 
iter: 3  mgc: 5.906386e-14 
outer mgc:  0.01020527 
iter: 1  value: 186.6597 mgc: 0.006078767 ustep: 1 
iter: 2  value: 186.6597 mgc: 1.272128e-06 ustep: 1 
iter: 3  mgc: 5.995204e-14 
outer mgc:  0.01019764 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:15:29 2021]
Finished job 0.
1 of 1 steps (100%) done

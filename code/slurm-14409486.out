Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:46:30 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4393.350542 
final  value 4051.142280 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3932.089 mgc: 4.649795 ustep: 1 
iter: 2  value: 3923.582 mgc: 3.766537 ustep: 1 
iter: 3  value: 3905.323 mgc: 4.387279 ustep: 0.6827823 
iter: 4  value: 3901.682 mgc: 3.517466 ustep: 0.8263238 
iter: 5  value: 3901.275 mgc: 0.9601027 ustep: 0.9090326 
iter: 6  value: 3901.27 mgc: 0.1415948 ustep: 0.9534367 
iter: 7  value: 3901.27 mgc: 0.004599594 ustep: 0.9764432 
iter: 8  value: 3901.27 mgc: 7.765739e-05 ustep: 0.9881526 
iter: 9  value: 3901.27 mgc: 7.596006e-07 ustep: 0.9940592 
iter: 10  mgc: 4.07071e-09 
iter: 1  mgc: 4.07071e-09 
Matching hessian patterns... Done
outer mgc:  22.4605 
iter: 1  value: 3866.845 mgc: 1.089851 ustep: 1 
iter: 2  value: 3866.837 mgc: 0.08422176 ustep: 1 
iter: 3  value: 3866.837 mgc: 0.0003718526 ustep: 1 
iter: 4  value: 3866.837 mgc: 1.259078e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  value: 3839.88 mgc: 3.886136 ustep: 1 
iter: 2  value: 3839.79 mgc: 0.5863487 ustep: 1 
iter: 3  value: 3839.79 mgc: 0.007296328 ustep: 1 
iter: 4  value: 3839.79 mgc: 1.213467e-06 ustep: 1 
iter: 5  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  30.02628 
iter: 1  value: 4029.417 mgc: 14.01464 ustep: 0.6827823 
iter: 2  value: 3909.055 mgc: 13.59748 ustep: 0.8263238 
iter: 3  value: 3895.529 mgc: 8.194122 ustep: 0.4507029 
iter: 4  value: 3886.1 mgc: 13.90234 ustep: 0.671377 
iter: 5  value: 3884.786 mgc: 7.601231 ustep: 0.5749649 
iter: 6  value: 3880.356 mgc: 8.969509 ustep: 0.7582886 
iter: 7  value: 3880.32 mgc: 0.83958 ustep: 0.8708106 
iter: 8  value: 3880.32 mgc: 0.00315764 ustep: 0.933179 
iter: 9  value: 3880.32 mgc: 2.042794e-05 ustep: 0.9660153 
iter: 10  value: 3880.32 mgc: 8.485037e-08 ustep: 0.9828625 
iter: 11  mgc: 2.583507e-10 
iter: 1  value: 3826.879 mgc: 4.730487 ustep: 1 
iter: 2  value: 3826.095 mgc: 0.9660839 ustep: 1 
iter: 3  value: 3826.095 mgc: 0.01654707 ustep: 1 
iter: 4  value: 3826.095 mgc: 8.294686e-06 ustep: 1 
iter: 5  mgc: 1.611267e-12 
iter: 1  mgc: 1.611267e-12 
outer mgc:  15.81223 
iter: 1  value: 3816.301 mgc: 4.355439 ustep: 1 
iter: 2  value: 3816.29 mgc: 0.1964469 ustep: 1 
iter: 3  value: 3816.29 mgc: 0.001194493 ustep: 1 
iter: 4  value: 3816.29 mgc: 7.930226e-08 ustep: 1 
iter: 5  mgc: 3.330669e-15 
iter: 1  mgc: 3.330669e-15 
outer mgc:  19.64285 
iter: 1  value: 3807.096 mgc: 7.400914 ustep: 1 
iter: 2  value: 3807.081 mgc: 0.2598571 ustep: 1 
iter: 3  value: 3807.081 mgc: 0.0003770312 ustep: 1 
iter: 4  mgc: 1.232936e-09 
iter: 1  mgc: 1.232936e-09 
outer mgc:  32.11513 
iter: 1  value: 3784.46 mgc: 7.294932 ustep: 1 
iter: 2  value: 3784.458 mgc: 0.06575082 ustep: 1 
iter: 3  value: 3784.458 mgc: 6.105773e-05 ustep: 1 
iter: 4  mgc: 4.528172e-11 
iter: 1  mgc: 4.528172e-11 
outer mgc:  7.077655 
iter: 1  value: 3778.11 mgc: 4.662365 ustep: 1 
iter: 2  value: 3778.109 mgc: 0.02770975 ustep: 1 
iter: 3  value: 3778.109 mgc: 5.674573e-06 ustep: 1 
iter: 4  mgc: 1.350031e-13 
iter: 1  value: 3781.94 mgc: 1.34273 ustep: 1 
iter: 2  value: 3781.94 mgc: 0.004364093 ustep: 1 
iter: 3  value: 3781.94 mgc: 2.728431e-07 ustep: 1 
iter: 4  mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  1.777465 
iter: 1  value: 3777.915 mgc: 1.437545 ustep: 1 
iter: 2  value: 3777.915 mgc: 0.001391024 ustep: 1 
iter: 3  value: 3777.915 mgc: 3.467107e-08 ustep: 1 
mgc: 8.437695e-15 
iter: 1  mgc: 8.437695e-15 
outer mgc:  2.250922 
iter: 1  value: 3774.545 mgc: 1.403607 ustep: 1 
iter: 2  value: 3774.545 mgc: 0.002857071 ustep: 1 
iter: 3  value: 3774.545 mgc: 7.521619e-08 ustep: 1 
mgc: 5.342948e-15 
iter: 1  value: 3777.298 mgc: 0.719161 ustep: 1 
iter: 2  value: 3777.298 mgc: 0.0003038615 ustep: 1 
iter: 3  mgc: 2.158973e-10 
iter: 1  value: 3777.662 mgc: 0.2643168 ustep: 1 
iter: 2  value: 3777.662 mgc: 4.010524e-05 ustep: 1 
iter: 3  mgc: 4.803047e-12 
iter: 1  mgc: 4.803047e-12 
outer mgc:  1.534826 
iter: 1  value: 3777.171 mgc: 0.3599218 ustep: 1 
iter: 2  value: 3777.171 mgc: 7.365619e-05 ustep: 1 
iter: 3  mgc: 7.597034e-11 
iter: 1  mgc: 7.597034e-11 
outer mgc:  1.362734 
iter: 1  value: 3775.833 mgc: 0.443794 ustep: 1 
iter: 2  value: 3775.833 mgc: 0.0002967032 ustep: 1 
iter: 3  mgc: 1.048271e-09 
iter: 1  mgc: 1.048271e-09 
outer mgc:  1.032951 
iter: 1  value: 3774.33 mgc: 0.4549284 ustep: 1 
iter: 2  value: 3774.33 mgc: 0.0001668874 ustep: 1 
iter: 3  mgc: 1.293277e-10 
iter: 1  mgc: 1.293277e-10 
outer mgc:  1.016941 
iter: 1  value: 3771.094 mgc: 0.836192 ustep: 1 
iter: 2  value: 3771.094 mgc: 0.0006871092 ustep: 1 
iter: 3  mgc: 1.428042e-09 
iter: 1  value: 3765.745 mgc: 1.361608 ustep: 1 
iter: 2  value: 3765.745 mgc: 0.001105848 ustep: 1 
iter: 3  mgc: 2.875869e-09 
iter: 1  mgc: 2.875869e-09 
outer mgc:  2.835721 
iter: 1  value: 3756.969 mgc: 2.576502 ustep: 1 
iter: 2  value: 3756.969 mgc: 0.001874835 ustep: 1 
iter: 3  mgc: 3.313961e-09 
iter: 1  mgc: 3.313961e-09 
outer mgc:  5.712078 
iter: 1  value: 3749.464 mgc: 3.233692 ustep: 1 
iter: 2  value: 3749.464 mgc: 0.001025482 ustep: 1 
iter: 3  mgc: 1.12452e-09 
iter: 1  mgc: 1.12452e-09 
outer mgc:  3.31929 
iter: 1  value: 3743.283 mgc: 4.680911 ustep: 1 
iter: 2  value: 3743.283 mgc: 0.0004329847 ustep: 1 
iter: 3  mgc: 1.407021e-10 
iter: 1  value: 3747.261 mgc: 1.486168 ustep: 1 
iter: 2  value: 3747.261 mgc: 7.06568e-05 ustep: 1 
iter: 3  mgc: 5.465406e-12 
iter: 1  mgc: 5.465406e-12 
outer mgc:  2.910092 
iter: 1  value: 3745.069 mgc: 0.2639214 ustep: 1 
iter: 2  value: 3745.069 mgc: 1.684557e-05 ustep: 1 
iter: 3  mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  3.624854 
iter: 1  value: 3742.059 mgc: 1.27731 ustep: 1 
iter: 2  value: 3742.059 mgc: 5.061536e-05 ustep: 1 
iter: 3  mgc: 1.430411e-12 
iter: 1  mgc: 1.430411e-12 
outer mgc:  1.490043 
iter: 1  value: 3738.808 mgc: 0.821419 ustep: 1 
iter: 2  value: 3738.808 mgc: 3.963468e-05 ustep: 1 
iter: 3  mgc: 2.2915e-13 
iter: 1  mgc: 2.2915e-13 
outer mgc:  0.7227473 
iter: 1  value: 3731.942 mgc: 1.926508 ustep: 1 
iter: 2  value: 3731.942 mgc: 0.0001224591 ustep: 1 
iter: 3  mgc: 1.040501e-12 
iter: 1  mgc: 1.040501e-12 
outer mgc:  0.7477625 
iter: 1  value: 3725.193 mgc: 1.816315 ustep: 1 
iter: 2  value: 3725.193 mgc: 5.348366e-05 ustep: 1 
iter: 3  mgc: 1.24345e-13 
iter: 1  mgc: 1.24345e-13 
outer mgc:  0.4750586 
iter: 1  value: 3718.369 mgc: 1.788946 ustep: 1 
iter: 2  value: 3718.369 mgc: 3.19437e-05 ustep: 1 
iter: 3  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.2246552 
iter: 1  value: 3704.132 mgc: 4.633548 ustep: 1 
iter: 2  value: 3704.132 mgc: 5.767233e-05 ustep: 1 
iter: 3  mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  0.04721351 
iter: 1  value: 3691.765 mgc: 3.781912 ustep: 1 
iter: 2  value: 3691.765 mgc: 1.327441e-05 ustep: 1 
iter: 3  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.02982561 
iter: 1  value: 3679.412 mgc: 3.778861 ustep: 1 
iter: 2  value: 3679.412 mgc: 4.309796e-06 ustep: 1 
mgc: 4.857226e-15 
iter: 1  mgc: 4.857226e-15 
outer mgc:  0.01233655 
iter: 1  value: 3667.079 mgc: 3.775765 ustep: 1 
iter: 2  value: 3667.079 mgc: 1.390448e-06 ustep: 1 
mgc: 6.605827e-15 
iter: 1  mgc: 6.605827e-15 
outer mgc:  0.007433518 
iter: 1  value: 3654.77 mgc: 3.771531 ustep: 1 
iter: 2  value: 3654.77 mgc: 4.475707e-07 ustep: 1 
mgc: 1.154632e-14 
iter: 1  mgc: 1.154632e-14 
outer mgc:  0.004747753 
iter: 1  value: 3642.484 mgc: 3.765846 ustep: 1 
iter: 2  value: 3642.484 mgc: 1.438068e-07 ustep: 1 
mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  0.003076643 
iter: 1  value: 3630.223 mgc: 3.762047 ustep: 1 
iter: 2  value: 3630.223 mgc: 4.611579e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.001894349 
iter: 1  value: 3615.475 mgc: 4.886307 ustep: 1 
iter: 2  value: 3615.475 mgc: 1.931436e-08 ustep: 1 
mgc: 8.382184e-15 
iter: 1  mgc: 8.382184e-15 
outer mgc:  0.0009789375 
iter: 1  value: 3601.629 mgc: 4.479816 ustep: 1 
iter: 2  mgc: 4.48669e-09 
iter: 1  mgc: 4.48669e-09 
outer mgc:  0.0004779043 
iter: 1  value: 3587.809 mgc: 4.48357 ustep: 1 
iter: 2  mgc: 1.23039e-09 
iter: 1  mgc: 1.23039e-09 
outer mgc:  0.0002351652 
iter: 1  value: 3574.016 mgc: 4.489219 ustep: 1 
iter: 2  mgc: 3.372e-10 
iter: 1  mgc: 3.372e-10 
outer mgc:  0.0001230016 
iter: 1  value: 3560.246 mgc: 4.496555 ustep: 1 
iter: 2  mgc: 9.238077e-11 
iter: 1  mgc: 9.238077e-11 
outer mgc:  6.936885e-05 
iter: 1  value: 3546.499 mgc: 4.505531 ustep: 1 
iter: 2  mgc: 2.528067e-11 
iter: 1  mgc: 2.528067e-11 
outer mgc:  3.87569e-05 
iter: 1  value: 3532.774 mgc: 4.516075 ustep: 1 
iter: 2  mgc: 6.924239e-12 
iter: 1  mgc: 6.924239e-12 
outer mgc:  2.057529e-05 
iter: 1  value: 3519.069 mgc: 4.528103 ustep: 1 
iter: 2  mgc: 1.884271e-12 
iter: 1  mgc: 1.884271e-12 
outer mgc:  1.026012e-05 
iter: 1  value: 3505.383 mgc: 4.541524 ustep: 1 
iter: 2  mgc: 5.289102e-13 
iter: 1  mgc: 5.289102e-13 
outer mgc:  5.065996e-06 
iter: 1  value: 3491.715 mgc: 4.556261 ustep: 1 
iter: 2  mgc: 1.429967e-13 
iter: 1  mgc: 1.429967e-13 
outer mgc:  2.60306e-06 
iter: 1  mgc: 1.429967e-13 
iter: 1  mgc: 1.429967e-13 
outer mgc:  2.60306e-06 
iter: 1  value: 3491.716 mgc: 0.005357713 ustep: 1 
mgc: 1.376677e-14 
outer mgc:  0.08300108 
iter: 1  value: 3491.716 mgc: 0.005355195 ustep: 1 
mgc: 1.210143e-14 
outer mgc:  0.08293739 
iter: 1  value: 3491.716 mgc: 0.003237838 ustep: 1 
mgc: 2.553513e-14 
outer mgc:  0.04734018 
iter: 1  value: 3491.716 mgc: 0.003237735 ustep: 1 
mgc: 7.993606e-15 
outer mgc:  0.04731215 
iter: 1  value: 3491.716 mgc: 0.005550867 ustep: 1 
mgc: 1.598721e-14 
outer mgc:  0.1060965 
iter: 1  value: 3491.716 mgc: 0.005551307 ustep: 1 
mgc: 1.731948e-14 
outer mgc:  0.1061014 
iter: 1  value: 3491.716 mgc: 0.002816313 ustep: 1 
mgc: 1.981748e-14 
outer mgc:  0.05323718 
iter: 1  value: 3491.716 mgc: 0.002817549 ustep: 1 
mgc: 1.909584e-14 
outer mgc:  0.0532302 
iter: 1  value: 3491.735 mgc: 0.08017529 ustep: 1 
mgc: 1.509903e-14 
outer mgc:  2.607193e-06 
iter: 1  value: 3491.695 mgc: 0.08025551 ustep: 1 
mgc: 1.576517e-14 
outer mgc:  2.598937e-06 
iter: 1  value: 3491.735 mgc: 0.0842235 ustep: 1 
mgc: 1.998401e-14 
outer mgc:  2.604831e-06 
iter: 1  value: 3491.695 mgc: 0.08447241 ustep: 1 
mgc: 1.021405e-14 
outer mgc:  2.601294e-06 
iter: 1  value: 3491.711 mgc: 0.001580289 ustep: 1 
mgc: 1.64313e-14 
outer mgc:  2.603038e-06 
iter: 1  value: 3491.72 mgc: 0.001579928 ustep: 1 
mgc: 1.912359e-14 
outer mgc:  2.603082e-06 
iter: 1  value: 3491.716 mgc: 0.003045393 ustep: 1 
mgc: 1.526557e-14 
outer mgc:  0.03424865 
iter: 1  value: 3491.716 mgc: 0.003042828 ustep: 1 
mgc: 1.132427e-14 
outer mgc:  0.03424126 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:46:32 2021]
Finished job 0.
1 of 1 steps (100%) done

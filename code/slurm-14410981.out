Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:31:06 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4528.479854 
final  value 4210.888396 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4337.288 mgc: 4.986421 ustep: 1 
iter: 2  value: 4331.776 mgc: 2.490478 ustep: 0.8994163 
iter: 3  value: 4309.38 mgc: 4.569646 ustep: 0.772724 
iter: 4  value: 4299.802 mgc: 2.13348 ustep: 0.6521695 
iter: 5  value: 4299.243 mgc: 1.187472 ustep: 0.8075894 
iter: 6  value: 4299.235 mgc: 0.09361164 ustep: 0.8986699 
iter: 7  value: 4299.235 mgc: 0.00652972 ustep: 0.9479872 
iter: 8  value: 4299.235 mgc: 0.0002377401 ustep: 0.973649 
iter: 9  value: 4299.235 mgc: 4.818954e-06 ustep: 0.9867379 
iter: 10  value: 4299.235 mgc: 5.042202e-08 ustep: 0.9933475 
iter: 11  mgc: 2.719709e-10 
iter: 1  mgc: 2.719709e-10 
Matching hessian patterns... Done
outer mgc:  30.54325 
iter: 1  value: 4254.488 mgc: 1.523082 ustep: 1 
iter: 2  value: 4254.477 mgc: 0.1383243 ustep: 1 
iter: 3  value: 4254.477 mgc: 0.00186524 ustep: 1 
iter: 4  value: 4254.477 mgc: 3.97623e-07 ustep: 1 
iter: 5  mgc: 1.765255e-14 
iter: 1  value: 4156.381 mgc: 22.55644 ustep: 1 
iter: 2  value: 4153.978 mgc: 4.017841 ustep: 1 
iter: 3  value: 4153.977 mgc: 0.05728405 ustep: 1 
iter: 4  value: 4153.977 mgc: 5.909345e-05 ustep: 1 
iter: 5  mgc: 1.305955e-11 
iter: 1  mgc: 1.305955e-11 
outer mgc:  25.44306 
iter: 1  value: 4318.378 mgc: 113.8337 ustep: 1 
iter: 2  value: 4318.327 mgc: 0.8222889 ustep: 1 
iter: 3  value: 4318.327 mgc: 0.00838348 ustep: 1 
iter: 4  value: 4318.327 mgc: 1.260886e-06 ustep: 1 
iter: 5  mgc: 3.819167e-14 
iter: 1  value: 4143.791 mgc: 6.900391 ustep: 1 
iter: 2  value: 4143.772 mgc: 0.3821845 ustep: 1 
iter: 3  value: 4143.772 mgc: 0.001849481 ustep: 1 
iter: 4  value: 4143.772 mgc: 4.008145e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  42.48656 
iter: 1  value: 4195.302 mgc: 18.03193 ustep: 1 
iter: 2  value: 4193.143 mgc: 3.159014 ustep: 1 
iter: 3  value: 4193.142 mgc: 0.05036447 ustep: 1 
iter: 4  value: 4193.142 mgc: 1.085046e-05 ustep: 1 
iter: 5  mgc: 9.667822e-13 
iter: 1  value: 4137.664 mgc: 4.753417 ustep: 1 
iter: 2  value: 4137.663 mgc: 0.06253711 ustep: 1 
iter: 3  value: 4137.663 mgc: 2.02218e-05 ustep: 1 
iter: 4  mgc: 6.873613e-12 
iter: 1  mgc: 6.873613e-12 
outer mgc:  14.5073 
iter: 1  value: 4134.199 mgc: 1.348319 ustep: 1 
iter: 2  value: 4134.199 mgc: 0.01657181 ustep: 1 
iter: 3  value: 4134.199 mgc: 2.373894e-06 ustep: 1 
iter: 4  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  14.65865 
iter: 1  value: 4132.889 mgc: 4.670718 ustep: 1 
iter: 2  value: 4132.888 mgc: 0.0812763 ustep: 1 
iter: 3  value: 4132.888 mgc: 3.735478e-05 ustep: 1 
iter: 4  mgc: 9.180656e-12 
iter: 1  value: 4132.574 mgc: 2.163472 ustep: 1 
iter: 2  value: 4132.574 mgc: 0.01503013 ustep: 1 
iter: 3  value: 4132.574 mgc: 1.448774e-06 ustep: 1 
iter: 4  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  8.237299 
iter: 1  value: 4131.242 mgc: 1.17682 ustep: 1 
iter: 2  value: 4131.242 mgc: 0.008783196 ustep: 1 
iter: 3  value: 4131.242 mgc: 6.01924e-07 ustep: 1 
iter: 4  mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  9.866986 
iter: 1  value: 4127.999 mgc: 3.104256 ustep: 1 
iter: 2  value: 4127.999 mgc: 0.03858159 ustep: 1 
iter: 3  value: 4127.999 mgc: 8.029658e-06 ustep: 1 
iter: 4  mgc: 3.23741e-13 
iter: 1  mgc: 3.23741e-13 
outer mgc:  9.370818 
iter: 1  value: 4122.01 mgc: 5.416183 ustep: 1 
iter: 2  value: 4122.009 mgc: 0.07311478 ustep: 1 
iter: 3  value: 4122.009 mgc: 1.569098e-05 ustep: 1 
iter: 4  mgc: 5.52447e-13 
iter: 1  mgc: 5.52447e-13 
outer mgc:  15.47601 
iter: 1  value: 4117.617 mgc: 3.267186 ustep: 1 
iter: 2  value: 4117.617 mgc: 0.02263388 ustep: 1 
iter: 3  value: 4117.617 mgc: 1.187731e-06 ustep: 1 
iter: 4  mgc: 5.417888e-14 
iter: 1  mgc: 5.417888e-14 
outer mgc:  5.937817 
iter: 1  value: 4119.858 mgc: 6.344048 ustep: 1 
iter: 2  value: 4119.858 mgc: 0.07670845 ustep: 1 
iter: 3  value: 4119.858 mgc: 1.316311e-05 ustep: 1 
iter: 4  mgc: 3.732015e-13 
iter: 1  value: 4117.481 mgc: 1.95825 ustep: 1 
iter: 2  value: 4117.481 mgc: 0.003952169 ustep: 1 
iter: 3  value: 4117.481 mgc: 4.621143e-08 ustep: 1 
mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  6.560182 
iter: 1  value: 4119.626 mgc: 2.801388 ustep: 1 
iter: 2  value: 4119.626 mgc: 0.0160132 ustep: 1 
iter: 3  value: 4119.626 mgc: 4.492079e-07 ustep: 1 
iter: 4  mgc: 6.650236e-14 
iter: 1  value: 4117.472 mgc: 1.367511 ustep: 1 
iter: 2  value: 4117.472 mgc: 0.001924397 ustep: 1 
iter: 3  mgc: 7.834075e-09 
iter: 1  value: 4117.353 mgc: 0.663197 ustep: 1 
iter: 2  value: 4117.353 mgc: 0.0004319937 ustep: 1 
iter: 3  mgc: 4.0645e-10 
iter: 1  mgc: 4.0645e-10 
outer mgc:  1.6446 
iter: 1  value: 4117.36 mgc: 0.352002 ustep: 1 
iter: 2  value: 4117.36 mgc: 0.0001754614 ustep: 1 
iter: 3  mgc: 1.165521e-10 
iter: 1  mgc: 1.165521e-10 
outer mgc:  1.978594 
iter: 1  value: 4117.332 mgc: 0.4056887 ustep: 1 
iter: 2  value: 4117.332 mgc: 0.0002854011 ustep: 1 
iter: 3  mgc: 3.438725e-10 
iter: 1  mgc: 3.438725e-10 
outer mgc:  3.067491 
iter: 1  value: 4117.376 mgc: 0.5451524 ustep: 1 
iter: 2  value: 4117.376 mgc: 0.0008262532 ustep: 1 
iter: 3  mgc: 7.36911e-09 
iter: 1  mgc: 7.36911e-09 
outer mgc:  1.746912 
iter: 1  value: 4117.397 mgc: 0.7971417 ustep: 1 
iter: 2  value: 4117.397 mgc: 0.001944195 ustep: 1 
iter: 3  value: 4117.397 mgc: 3.017736e-08 ustep: 1 
mgc: 4.019007e-14 
iter: 1  value: 4117.354 mgc: 0.3768062 ustep: 1 
iter: 2  value: 4117.354 mgc: 0.0004511084 ustep: 1 
iter: 3  mgc: 1.427861e-09 
iter: 1  mgc: 1.427861e-09 
outer mgc:  1.150413 
iter: 1  value: 4117.311 mgc: 0.4738793 ustep: 1 
iter: 2  value: 4117.311 mgc: 0.0002006887 ustep: 1 
iter: 3  mgc: 1.124354e-10 
iter: 1  value: 4117.343 mgc: 0.1571018 ustep: 1 
iter: 2  value: 4117.343 mgc: 2.623439e-05 ustep: 1 
iter: 3  mgc: 2.000178e-12 
iter: 1  mgc: 2.000178e-12 
outer mgc:  0.7388507 
iter: 1  value: 4117.32 mgc: 0.1059147 ustep: 1 
iter: 2  value: 4117.32 mgc: 1.266043e-05 ustep: 1 
iter: 3  mgc: 3.126388e-13 
iter: 1  mgc: 3.126388e-13 
outer mgc:  0.447681 
iter: 1  value: 4117.267 mgc: 0.1021458 ustep: 1 
iter: 2  value: 4117.267 mgc: 1.071051e-05 ustep: 1 
iter: 3  mgc: 6.012968e-13 
iter: 1  value: 4117.205 mgc: 0.07407903 ustep: 1 
iter: 2  value: 4117.205 mgc: 6.812935e-06 ustep: 1 
iter: 3  mgc: 1.980638e-13 
iter: 1  value: 4116.874 mgc: 0.3978311 ustep: 1 
iter: 2  value: 4116.874 mgc: 0.0001838754 ustep: 1 
iter: 3  mgc: 1.246931e-10 
iter: 1  value: 4115.837 mgc: 1.235814 ustep: 1 
iter: 2  value: 4115.837 mgc: 0.001440694 ustep: 1 
iter: 3  mgc: 7.090634e-09 
iter: 1  mgc: 7.090634e-09 
outer mgc:  0.8979787 
iter: 1  value: 4114.064 mgc: 5.836598 ustep: 1 
iter: 2  value: 4114.064 mgc: 0.01911248 ustep: 1 
iter: 3  value: 4114.064 mgc: 2.470898e-06 ustep: 1 
iter: 4  mgc: 6.641909e-14 
iter: 1  value: 4115.265 mgc: 1.910883 ustep: 1 
iter: 2  value: 4115.265 mgc: 0.003060338 ustep: 1 
iter: 3  value: 4115.265 mgc: 4.423098e-08 ustep: 1 
mgc: 3.774758e-14 
iter: 1  mgc: 3.774758e-14 
outer mgc:  1.420798 
iter: 1  value: 4114.724 mgc: 0.4808668 ustep: 1 
iter: 2  value: 4114.724 mgc: 0.0002049788 ustep: 1 
iter: 3  mgc: 5.087131e-11 
iter: 1  mgc: 5.087131e-11 
outer mgc:  0.7486132 
iter: 1  value: 4114.313 mgc: 4.565361 ustep: 1 
iter: 2  value: 4114.313 mgc: 0.0182054 ustep: 1 
iter: 3  value: 4114.313 mgc: 9.876754e-07 ustep: 1 
iter: 4  mgc: 7.460699e-14 
iter: 1  value: 4114.628 mgc: 1.122963 ustep: 1 
iter: 2  value: 4114.628 mgc: 0.001354118 ustep: 1 
iter: 3  mgc: 6.384549e-09 
iter: 1  mgc: 6.384549e-09 
outer mgc:  0.9986127 
iter: 1  value: 4114.485 mgc: 0.1678728 ustep: 1 
iter: 2  value: 4114.485 mgc: 2.307858e-05 ustep: 1 
iter: 3  mgc: 1.188383e-12 
iter: 1  mgc: 1.188383e-12 
outer mgc:  0.1761834 
iter: 1  value: 4114.279 mgc: 0.247417 ustep: 1 
iter: 2  value: 4114.279 mgc: 6.524935e-05 ustep: 1 
iter: 3  mgc: 2.25735e-11 
iter: 1  mgc: 2.25735e-11 
outer mgc:  0.3334199 
iter: 1  value: 4114.141 mgc: 0.1534105 ustep: 1 
iter: 2  value: 4114.141 mgc: 1.991691e-05 ustep: 1 
iter: 3  mgc: 3.703704e-13 
iter: 1  value: 4113.906 mgc: 0.2583872 ustep: 1 
iter: 2  value: 4113.906 mgc: 5.068268e-05 ustep: 1 
iter: 3  mgc: 3.670841e-12 
iter: 1  value: 4112.83 mgc: 1.232932 ustep: 1 
iter: 2  value: 4112.83 mgc: 0.0007720914 ustep: 1 
iter: 3  mgc: 9.482841e-10 
iter: 1  mgc: 9.482841e-10 
outer mgc:  0.2899444 
iter: 1  value: 4111.328 mgc: 1.315771 ustep: 1 
iter: 2  value: 4111.328 mgc: 0.0007705874 ustep: 1 
iter: 3  mgc: 9.760388e-10 
iter: 1  mgc: 9.760388e-10 
outer mgc:  0.2067093 
iter: 1  value: 4109.624 mgc: 2.376599 ustep: 1 
iter: 2  value: 4109.624 mgc: 0.001934122 ustep: 1 
iter: 3  mgc: 1.82065e-09 
iter: 1  mgc: 1.82065e-09 
outer mgc:  0.2539972 
iter: 1  value: 4109.497 mgc: 0.9429922 ustep: 1 
iter: 2  value: 4109.497 mgc: 0.0005352888 ustep: 1 
iter: 3  mgc: 2.089846e-10 
iter: 1  mgc: 2.089846e-10 
outer mgc:  0.05434385 
iter: 1  value: 4109.109 mgc: 0.3766573 ustep: 1 
iter: 2  value: 4109.109 mgc: 4.228136e-05 ustep: 1 
iter: 3  mgc: 9.272583e-13 
iter: 1  mgc: 9.272583e-13 
outer mgc:  0.03875375 
iter: 1  value: 4108.796 mgc: 0.3120384 ustep: 1 
iter: 2  value: 4108.796 mgc: 2.349959e-05 ustep: 1 
iter: 3  mgc: 5.915268e-13 
iter: 1  mgc: 5.915268e-13 
outer mgc:  0.01245543 
iter: 1  value: 4108.423 mgc: 0.3785936 ustep: 1 
iter: 2  value: 4108.423 mgc: 3.225465e-05 ustep: 1 
iter: 3  mgc: 1.076472e-12 
iter: 1  mgc: 1.076472e-12 
outer mgc:  0.007024792 
iter: 1  value: 4108.369 mgc: 0.04795189 ustep: 1 
iter: 2  value: 4108.369 mgc: 5.103759e-07 ustep: 1 
iter: 3  mgc: 5.12923e-14 
iter: 1  mgc: 5.12923e-14 
outer mgc:  0.002612723 
iter: 1  value: 4108.362 mgc: 0.007982843 ustep: 1 
iter: 2  value: 4108.362 mgc: 1.392701e-08 ustep: 1 
mgc: 7.638334e-14 
iter: 1  mgc: 7.638334e-14 
outer mgc:  0.00033384 
iter: 1  mgc: 7.638334e-14 
iter: 1  mgc: 7.638334e-14 
outer mgc:  0.00033384 
iter: 1  value: 4108.362 mgc: 0.02676338 ustep: 1 
iter: 2  value: 4108.362 mgc: 1.110395e-06 ustep: 1 
iter: 3  mgc: 5.928591e-14 
outer mgc:  0.2405211 
iter: 1  value: 4108.362 mgc: 0.02675767 ustep: 1 
iter: 2  value: 4108.362 mgc: 1.110862e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
outer mgc:  0.2411111 
iter: 1  value: 4108.362 mgc: 0.01421442 ustep: 1 
iter: 2  value: 4108.362 mgc: 3.277732e-07 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.182852 
iter: 1  value: 4108.361 mgc: 0.01421308 ustep: 1 
iter: 2  value: 4108.361 mgc: 3.282689e-07 ustep: 1 
iter: 3  mgc: 7.172041e-14 
outer mgc:  0.1828066 
iter: 1  value: 4108.362 mgc: 0.01644245 ustep: 1 
iter: 2  value: 4108.362 mgc: 1.854938e-07 ustep: 1 
iter: 3  mgc: 4.685141e-14 
outer mgc:  0.2441783 
iter: 1  value: 4108.362 mgc: 0.01642939 ustep: 1 
iter: 2  value: 4108.362 mgc: 1.850883e-07 ustep: 1 
iter: 3  mgc: 8.337775e-14 
outer mgc:  0.2433416 
iter: 1  value: 4108.362 mgc: 0.008113788 ustep: 1 
iter: 2  value: 4108.362 mgc: 3.375828e-08 ustep: 1 
mgc: 6.927792e-14 
outer mgc:  0.121132 
iter: 1  value: 4108.362 mgc: 0.008106411 ustep: 1 
iter: 2  value: 4108.362 mgc: 3.368993e-08 ustep: 1 
mgc: 4.085621e-14 
outer mgc:  0.1206128 
iter: 1  value: 4108.37 mgc: 0.08839186 ustep: 1 
iter: 2  value: 4108.37 mgc: 1.64764e-06 ustep: 1 
iter: 3  mgc: 4.918288e-14 
outer mgc:  0.02798111 
iter: 1  value: 4108.354 mgc: 0.0884803 ustep: 1 
iter: 2  value: 4108.354 mgc: 1.649961e-06 ustep: 1 
iter: 3  mgc: 5.861978e-14 
outer mgc:  0.02788438 
iter: 1  value: 4108.378 mgc: 0.09202275 ustep: 1 
iter: 2  value: 4108.378 mgc: 2.11371e-06 ustep: 1 
iter: 3  mgc: 6.838974e-14 
outer mgc:  0.01539491 
iter: 1  value: 4108.346 mgc: 0.09229551 ustep: 1 
iter: 2  value: 4108.346 mgc: 2.112804e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
outer mgc:  0.01541373 
iter: 1  value: 4108.357 mgc: 0.004459562 ustep: 1 
iter: 2  mgc: 4.542643e-09 
outer mgc:  0.0002518765 
iter: 1  value: 4108.367 mgc: 0.004458205 ustep: 1 
iter: 2  mgc: 4.549221e-09 
outer mgc:  0.0004158862 
iter: 1  value: 4108.358 mgc: 0.004204657 ustep: 1 
iter: 2  value: 4108.358 mgc: 3.547257e-08 ustep: 1 
mgc: 7.727152e-14 
outer mgc:  0.007671742 
iter: 1  value: 4108.366 mgc: 0.00420511 ustep: 1 
iter: 2  value: 4108.366 mgc: 3.548876e-08 ustep: 1 
mgc: 5.273559e-14 
outer mgc:  0.007748368 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:31:08 2021]
Finished job 0.
1 of 1 steps (100%) done

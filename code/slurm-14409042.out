Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:33:46 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_80_3_0.6_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.6, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.6_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11070.716033 
iter  10 value 8471.255042
final  value 8471.254614 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8735.834 mgc: 3.776159 ustep: 0.8994163 
iter: 2  value: 8720.01 mgc: 4.962151 ustep: 0.9483808 
iter: 3  value: 8695.493 mgc: 3.830775 ustep: 0.5282516 
iter: 4  value: 8648.617 mgc: 5.598351 ustep: 0.4773018 
iter: 5  value: 8645.328 mgc: 3.133898 ustep: 0.6909013 
iter: 6  value: 8645.026 mgc: 0.8816299 ustep: 0.8312216 
iter: 7  value: 8645.019 mgc: 0.1311645 ustep: 0.9117224 
iter: 8  value: 8645.019 mgc: 0.0088621 ustep: 0.9548461 
iter: 9  value: 8645.019 mgc: 0.0005109875 ustep: 0.9771645 
iter: 10  value: 8645.019 mgc: 1.814019e-05 ustep: 0.9885175 
iter: 11  value: 8645.019 mgc: 3.119728e-07 ustep: 0.9942427 
iter: 12  mgc: 2.671047e-09 
iter: 1  mgc: 2.671047e-09 
Matching hessian patterns... Done
outer mgc:  55.84957 
iter: 1  value: 8553.185 mgc: 0.9071342 ustep: 1 
iter: 2  value: 8553.172 mgc: 0.07114549 ustep: 1 
iter: 3  value: 8553.172 mgc: 0.0003832331 ustep: 1 
iter: 4  value: 8553.172 mgc: 1.158542e-08 ustep: 1 
mgc: 3.025358e-15 
iter: 1  value: 8471.558 mgc: 29.95085 ustep: 1 
iter: 2  value: 8448.856 mgc: 4.472032 ustep: 1 
iter: 3  value: 8448.76 mgc: 0.5160236 ustep: 1 
iter: 4  value: 8448.76 mgc: 0.01900969 ustep: 1 
iter: 5  value: 8448.76 mgc: 2.926112e-05 ustep: 1 
iter: 6  mgc: 6.9507e-11 
iter: 1  mgc: 6.9507e-11 
outer mgc:  122.6693 
iter: 1  value: 8625.038 mgc: 34.36405 ustep: 1 
iter: 2  value: 8624.942 mgc: 0.9886278 ustep: 1 
iter: 3  value: 8624.942 mgc: 0.006388691 ustep: 1 
iter: 4  value: 8624.942 mgc: 9.360646e-07 ustep: 1 
iter: 5  mgc: 3.197442e-14 
iter: 1  value: 8368.948 mgc: 4.495314 ustep: 1 
iter: 2  value: 8368.946 mgc: 0.07622014 ustep: 1 
iter: 3  value: 8368.946 mgc: 7.302223e-05 ustep: 1 
iter: 4  mgc: 3.559784e-10 
iter: 1  mgc: 3.559784e-10 
outer mgc:  38.70051 
iter: 1  value: 8416.481 mgc: 9.512826 ustep: 1 
iter: 2  value: 8342.838 mgc: 8.468392 ustep: 1 
iter: 3  value: 8342.57 mgc: 0.8598488 ustep: 1 
iter: 4  value: 8342.57 mgc: 0.03851089 ustep: 1 
iter: 5  value: 8342.57 mgc: 9.133915e-05 ustep: 1 
iter: 6  mgc: 5.117491e-10 
iter: 1  mgc: 5.117491e-10 
outer mgc:  85.72975 
iter: 1  value: 8271.567 mgc: 8.873432 ustep: 1 
iter: 2  value: 8271.564 mgc: 0.1399199 ustep: 1 
iter: 3  value: 8271.564 mgc: 8.488863e-05 ustep: 1 
iter: 4  mgc: 9.405632e-11 
iter: 1  mgc: 9.405632e-11 
outer mgc:  68.14435 
iter: 1  value: 8273.758 mgc: 17.92372 ustep: 1 
iter: 2  value: 8249.676 mgc: 7.079246 ustep: 1 
iter: 3  value: 8249.614 mgc: 0.3653882 ustep: 1 
iter: 4  value: 8249.614 mgc: 0.003416241 ustep: 1 
iter: 5  value: 8249.614 mgc: 2.916216e-07 ustep: 1 
iter: 6  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  120.8476 
iter: 1  value: 8248.77 mgc: 50.59109 ustep: 1 
iter: 2  value: 8248.653 mgc: 0.9422423 ustep: 1 
iter: 3  value: 8248.653 mgc: 0.02041955 ustep: 1 
iter: 4  value: 8248.653 mgc: 2.877425e-06 ustep: 1 
iter: 5  mgc: 1.350031e-13 
iter: 1  value: 8225.093 mgc: 16.06455 ustep: 1 
iter: 2  value: 8225.07 mgc: 0.3123153 ustep: 1 
iter: 3  value: 8225.07 mgc: 0.0008857901 ustep: 1 
iter: 4  value: 8225.07 mgc: 1.696676e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  78.70177 
iter: 1  value: 8226.226 mgc: 10.6906 ustep: 1 
iter: 2  value: 8225.723 mgc: 0.835275 ustep: 1 
iter: 3  value: 8225.723 mgc: 0.01116964 ustep: 1 
iter: 4  value: 8225.723 mgc: 2.715881e-06 ustep: 1 
iter: 5  mgc: 1.563194e-13 
iter: 1  value: 8218.885 mgc: 6.665361 ustep: 1 
iter: 2  value: 8218.857 mgc: 0.1915558 ustep: 1 
iter: 3  value: 8218.857 mgc: 0.0005850194 ustep: 1 
iter: 4  mgc: 7.607106e-09 
iter: 1  mgc: 7.607106e-09 
outer mgc:  32.1533 
iter: 1  value: 8213.642 mgc: 4.098144 ustep: 1 
iter: 2  value: 8213.642 mgc: 0.05100162 ustep: 1 
iter: 3  value: 8213.642 mgc: 1.279318e-05 ustep: 1 
iter: 4  mgc: 1.120437e-12 
iter: 1  mgc: 1.120437e-12 
outer mgc:  19.56726 
iter: 1  value: 8212.375 mgc: 2.334888 ustep: 1 
iter: 2  value: 8212.375 mgc: 0.0193893 ustep: 1 
iter: 3  value: 8212.375 mgc: 1.725229e-06 ustep: 1 
iter: 4  mgc: 3.885781e-14 
iter: 1  mgc: 3.885781e-14 
outer mgc:  16.36484 
iter: 1  value: 8217.329 mgc: 8.657012 ustep: 1 
iter: 2  value: 8217.327 mgc: 0.1563702 ustep: 1 
iter: 3  value: 8217.327 mgc: 0.0001203864 ustep: 1 
iter: 4  mgc: 3.064713e-10 
iter: 1  value: 8211.958 mgc: 1.687155 ustep: 1 
iter: 2  value: 8211.958 mgc: 0.006359977 ustep: 1 
iter: 3  value: 8211.958 mgc: 4.461878e-07 ustep: 1 
iter: 4  mgc: 3.452794e-14 
iter: 1  mgc: 3.452794e-14 
outer mgc:  17.14502 
iter: 1  value: 8212.131 mgc: 1.484876 ustep: 1 
iter: 2  value: 8212.131 mgc: 0.007180471 ustep: 1 
iter: 3  value: 8212.131 mgc: 1.670479e-07 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  3.856414 
iter: 1  value: 8211.028 mgc: 0.3400536 ustep: 1 
iter: 2  value: 8211.028 mgc: 0.000369784 ustep: 1 
iter: 3  mgc: 4.469225e-10 
iter: 1  mgc: 4.469225e-10 
outer mgc:  4.940572 
iter: 1  value: 8210.483 mgc: 0.5712719 ustep: 1 
iter: 2  value: 8210.483 mgc: 0.0008243827 ustep: 1 
iter: 3  mgc: 9.146054e-09 
iter: 1  mgc: 9.146054e-09 
outer mgc:  8.120532 
iter: 1  value: 8211.024 mgc: 1.400773 ustep: 1 
iter: 2  value: 8211.024 mgc: 0.004685249 ustep: 1 
iter: 3  value: 8211.024 mgc: 2.973058e-07 ustep: 1 
iter: 4  mgc: 4.723999e-14 
iter: 1  mgc: 4.723999e-14 
outer mgc:  3.027485 
iter: 1  value: 8211.123 mgc: 0.4992978 ustep: 1 
iter: 2  value: 8211.123 mgc: 0.000930499 ustep: 1 
iter: 3  value: 8211.123 mgc: 1.705745e-08 ustep: 1 
mgc: 6.350476e-14 
iter: 1  mgc: 6.350476e-14 
outer mgc:  0.9938186 
iter: 1  value: 8209.95 mgc: 0.5694303 ustep: 1 
iter: 2  value: 8209.95 mgc: 0.0007943274 ustep: 1 
iter: 3  mgc: 1.545221e-09 
iter: 1  value: 8210.904 mgc: 0.1666334 ustep: 1 
iter: 2  value: 8210.904 mgc: 9.044839e-05 ustep: 1 
iter: 3  mgc: 3.116973e-11 
iter: 1  value: 8211.028 mgc: 0.0670159 ustep: 1 
iter: 2  value: 8211.028 mgc: 1.474342e-05 ustep: 1 
iter: 3  mgc: 8.570922e-13 
iter: 1  mgc: 8.570922e-13 
outer mgc:  1.262651 
iter: 1  value: 8210.87 mgc: 0.09169463 ustep: 1 
iter: 2  value: 8210.87 mgc: 2.890367e-05 ustep: 1 
iter: 3  mgc: 4.487966e-12 
iter: 1  mgc: 4.487966e-12 
outer mgc:  0.9658963 
iter: 1  value: 8210.583 mgc: 0.1404809 ustep: 1 
iter: 2  value: 8210.583 mgc: 4.702794e-05 ustep: 1 
iter: 3  mgc: 5.517586e-12 
iter: 1  value: 8210.215 mgc: 0.1693496 ustep: 1 
iter: 2  value: 8210.215 mgc: 6.927694e-05 ustep: 1 
iter: 3  mgc: 1.216449e-11 
iter: 1  value: 8209.124 mgc: 0.5228078 ustep: 1 
iter: 2  value: 8209.124 mgc: 0.0006085736 ustep: 1 
iter: 3  mgc: 8.064669e-10 
iter: 1  mgc: 8.064669e-10 
outer mgc:  1.298468 
iter: 1  value: 8208.368 mgc: 0.6958882 ustep: 1 
iter: 2  value: 8208.368 mgc: 0.001249192 ustep: 1 
iter: 3  mgc: 4.351135e-09 
iter: 1  value: 8206.909 mgc: 1.166161 ustep: 1 
iter: 2  value: 8206.909 mgc: 0.003255927 ustep: 1 
iter: 3  value: 8206.909 mgc: 2.657897e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  3.075807 
iter: 1  value: 8206.715 mgc: 0.7875225 ustep: 1 
iter: 2  value: 8206.715 mgc: 0.003758891 ustep: 1 
iter: 3  value: 8206.715 mgc: 3.949778e-07 ustep: 1 
iter: 4  mgc: 5.571932e-14 
iter: 1  mgc: 5.571932e-14 
outer mgc:  2.879721 
iter: 1  value: 8206.14 mgc: 0.8819305 ustep: 1 
iter: 2  value: 8206.14 mgc: 0.007863463 ustep: 1 
iter: 3  value: 8206.14 mgc: 5.072594e-07 ustep: 1 
iter: 4  mgc: 4.396483e-14 
iter: 1  value: 8206.332 mgc: 0.3590757 ustep: 1 
iter: 2  value: 8206.332 mgc: 0.001537214 ustep: 1 
iter: 3  value: 8206.332 mgc: 3.706166e-08 ustep: 1 
mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  1.275983 
iter: 1  value: 8203.395 mgc: 1.54366 ustep: 1 
iter: 2  value: 8203.395 mgc: 0.003288755 ustep: 1 
iter: 3  value: 8203.395 mgc: 2.006768e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  1.676118 
iter: 1  value: 8201.998 mgc: 0.693899 ustep: 1 
iter: 2  value: 8201.998 mgc: 0.0009867875 ustep: 1 
iter: 3  value: 8201.998 mgc: 1.460009e-08 ustep: 1 
mgc: 4.962697e-14 
iter: 1  mgc: 4.962697e-14 
outer mgc:  2.299653 
iter: 1  value: 8201.055 mgc: 0.6317715 ustep: 1 
iter: 2  value: 8201.055 mgc: 0.0005477655 ustep: 1 
iter: 3  mgc: 5.186376e-10 
iter: 1  mgc: 5.186376e-10 
outer mgc:  2.355599 
iter: 1  value: 8199.991 mgc: 0.381082 ustep: 1 
iter: 2  value: 8199.991 mgc: 0.0001791435 ustep: 1 
iter: 3  mgc: 5.419487e-11 
iter: 1  mgc: 5.419487e-11 
outer mgc:  0.9825314 
iter: 1  value: 8198.99 mgc: 0.5441395 ustep: 1 
iter: 2  value: 8198.99 mgc: 0.0003906391 ustep: 1 
iter: 3  mgc: 2.163265e-10 
iter: 1  mgc: 2.163265e-10 
outer mgc:  0.7152003 
iter: 1  value: 8197.958 mgc: 0.4458191 ustep: 1 
iter: 2  value: 8197.958 mgc: 0.0002571253 ustep: 1 
iter: 3  mgc: 8.506262e-11 
iter: 1  value: 8194.965 mgc: 1.34904 ustep: 1 
iter: 2  value: 8194.965 mgc: 0.001811399 ustep: 1 
iter: 3  mgc: 3.254273e-09 
iter: 1  mgc: 3.254273e-09 
outer mgc:  0.4585815 
iter: 1  value: 8191.159 mgc: 1.591899 ustep: 1 
iter: 2  value: 8191.159 mgc: 0.001768055 ustep: 1 
iter: 3  mgc: 2.276975e-09 
iter: 1  mgc: 2.276975e-09 
outer mgc:  0.5222075 
iter: 1  value: 8187.271 mgc: 1.736343 ustep: 1 
iter: 2  value: 8187.271 mgc: 0.001538368 ustep: 1 
iter: 3  mgc: 1.220691e-09 
iter: 1  mgc: 1.220691e-09 
outer mgc:  0.3205625 
iter: 1  value: 8185.179 mgc: 0.8012372 ustep: 1 
iter: 2  value: 8185.179 mgc: 0.000280423 ustep: 1 
iter: 3  mgc: 3.44329e-11 
iter: 1  mgc: 3.44329e-11 
outer mgc:  0.1349526 
iter: 1  value: 8183.424 mgc: 0.7036425 ustep: 1 
iter: 2  value: 8183.424 mgc: 0.0001855574 ustep: 1 
iter: 3  mgc: 1.303135e-11 
iter: 1  mgc: 1.303135e-11 
outer mgc:  0.02552646 
iter: 1  value: 8182.576 mgc: 0.3255974 ustep: 1 
iter: 2  value: 8182.576 mgc: 3.721291e-05 ustep: 1 
iter: 3  mgc: 4.956036e-13 
iter: 1  mgc: 4.956036e-13 
outer mgc:  0.02015785 
iter: 1  value: 8182.306 mgc: 0.1054609 ustep: 1 
iter: 2  value: 8182.306 mgc: 3.695623e-06 ustep: 1 
iter: 3  mgc: 3.164136e-14 
iter: 1  mgc: 3.164136e-14 
outer mgc:  0.008968943 
iter: 1  value: 8182.297 mgc: 0.008721 ustep: 1 
iter: 2  value: 8182.297 mgc: 1.486991e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.000624234 
iter: 1  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.000624234 
iter: 1  value: 8182.3 mgc: 0.020411 ustep: 1 
iter: 2  value: 8182.3 mgc: 1.954935e-06 ustep: 1 
iter: 3  mgc: 1.003642e-13 
outer mgc:  0.4351638 
iter: 1  value: 8182.296 mgc: 0.0204178 ustep: 1 
iter: 2  value: 8182.296 mgc: 1.950367e-06 ustep: 1 
iter: 3  mgc: 1.024736e-13 
outer mgc:  0.4365995 
iter: 1  value: 8182.3 mgc: 0.009751544 ustep: 1 
iter: 2  value: 8182.3 mgc: 3.231834e-07 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.3083206 
iter: 1  value: 8182.295 mgc: 0.009756276 ustep: 1 
iter: 2  value: 8182.295 mgc: 3.231077e-07 ustep: 1 
iter: 3  mgc: 4.751755e-14 
outer mgc:  0.3084863 
iter: 1  value: 8182.3 mgc: 0.01340726 ustep: 1 
iter: 2  value: 8182.3 mgc: 8.040452e-08 ustep: 1 
mgc: 4.263256e-14 
outer mgc:  0.5073481 
iter: 1  value: 8182.295 mgc: 0.01339635 ustep: 1 
iter: 2  value: 8182.295 mgc: 8.02421e-08 ustep: 1 
mgc: 4.185541e-14 
outer mgc:  0.5064465 
iter: 1  value: 8182.298 mgc: 0.00704556 ustep: 1 
iter: 2  value: 8182.298 mgc: 2.625141e-08 ustep: 1 
mgc: 4.780551e-14 
outer mgc:  0.2503272 
iter: 1  value: 8182.297 mgc: 0.007039936 ustep: 1 
iter: 2  value: 8182.297 mgc: 2.620158e-08 ustep: 1 
mgc: 4.973799e-14 
outer mgc:  0.2503263 
iter: 1  value: 8182.311 mgc: 0.1026416 ustep: 1 
iter: 2  value: 8182.311 mgc: 2.607878e-06 ustep: 1 
iter: 3  mgc: 4.574119e-14 
outer mgc:  0.1041165 
iter: 1  value: 8182.284 mgc: 0.1027443 ustep: 1 
iter: 2  value: 8182.284 mgc: 2.609423e-06 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.1052145 
iter: 1  value: 8182.345 mgc: 0.1150065 ustep: 1 
iter: 2  value: 8182.345 mgc: 3.263482e-06 ustep: 1 
iter: 3  mgc: 4.241052e-14 
outer mgc:  0.05342518 
iter: 1  value: 8182.25 mgc: 0.1153395 ustep: 1 
iter: 2  value: 8182.25 mgc: 3.256755e-06 ustep: 1 
iter: 3  mgc: 4.107825e-14 
outer mgc:  0.05226339 
iter: 1  value: 8182.287 mgc: 0.003817964 ustep: 1 
iter: 2  mgc: 4.63791e-09 
outer mgc:  0.001174072 
iter: 1  value: 8182.308 mgc: 0.0038171 ustep: 1 
iter: 2  mgc: 4.643447e-09 
outer mgc:  0.0008364042 
iter: 1  value: 8182.287 mgc: 0.005388312 ustep: 1 
iter: 2  value: 8182.287 mgc: 8.666807e-08 ustep: 1 
iter: 3  mgc: 4.577935e-14 
outer mgc:  0.02615593 
iter: 1  value: 8182.308 mgc: 0.005386349 ustep: 1 
iter: 2  value: 8182.308 mgc: 8.669509e-08 ustep: 1 
iter: 3  mgc: 4.224399e-14 
outer mgc:  0.02596605 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:33:49 2021]
Finished job 0.
1 of 1 steps (100%) done

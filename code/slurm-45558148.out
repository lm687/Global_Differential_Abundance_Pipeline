Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 14:28:35 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4251.629557 
iter  10 value 2898.082870
final  value 2889.374885 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3740.967 mgc: 118.8716 ustep: 1 
iter: 2  value: 3658.517 mgc: 49.48601 ustep: 0.6827823 
iter: 3  value: 3504.053 mgc: 120.6296 ustep: 0.8263238 
iter: 4  value: 3434.461 mgc: 51.68768 ustep: 0.07213116 
iter: 5  value: 3417.519 mgc: 32.67918 ustep: 0.2686456 
iter: 6  value: 3417.255 mgc: 3.30727 ustep: 0.5183585 
iter: 7  value: 3417.251 mgc: 0.2156548 ustep: 0.7199992 
iter: 8  value: 3417.251 mgc: 0.01203423 ustep: 0.8485428 
iter: 9  value: 3417.251 mgc: 0.002031533 ustep: 0.9211717 
iter: 10  value: 3417.251 mgc: 0.0001789416 ustep: 0.9597809 
iter: 11  value: 3417.251 mgc: 8.059186e-06 ustep: 0.9796861 
iter: 12  value: 3417.251 mgc: 1.831255e-07 ustep: 0.989792 
iter: 13  mgc: 2.092131e-09 
iter: 1  mgc: 2.092131e-09 
Matching hessian patterns... Done
outer mgc:  1046.012 
iter: 1  value: 2169.008 mgc: 34.27884 ustep: 1 
iter: 2  value: 2144.536 mgc: 23.00935 ustep: 1 
iter: 3  value: 2144.408 mgc: 2.264238 ustep: 1 
iter: 4  value: 2144.408 mgc: 0.0422653 ustep: 1 
iter: 5  value: 2144.408 mgc: 1.601981e-05 ustep: 1 
iter: 6  mgc: 2.305822e-12 
iter: 1  value: 1575.548 mgc: 73.36471 ustep: 1 
iter: 2  value: 654.1274 mgc: 139.2408 ustep: 1 
iter: 3  value: 608.6837 mgc: 84.51283 ustep: 0.2494656 
iter: 4  value: 381.6805 mgc: 132.0998 ustep: 0.4995153 
iter: 5  value: 364.7816 mgc: 30.41365 ustep: 0.7067933 
iter: 6  value: 362.4444 mgc: 11.34562 ustep: 0.8407259 
iter: 7  value: 362.4321 mgc: 0.7982722 ustep: 0.9169194 
iter: 8  value: 362.4321 mgc: 0.008084968 ustep: 0.9575633 
iter: 9  value: 362.4321 mgc: 3.099027e-05 ustep: 0.9785538 
iter: 10  value: 362.4321 mgc: 7.249143e-07 ustep: 0.9892199 
iter: 11  mgc: 8.521478e-09 
iter: 1  mgc: 8.521478e-09 
outer mgc:  78.5572 
iter: 1  value: 628.219 mgc: 58.59465 ustep: 1 
iter: 2  value: 524.5928 mgc: 25.54998 ustep: 1 
iter: 3  value: 523.7881 mgc: 3.983974 ustep: 1 
iter: 4  value: 523.788 mgc: 0.05121314 ustep: 1 
iter: 5  value: 523.788 mgc: 1.444722e-05 ustep: 1 
iter: 6  mgc: 1.903366e-12 
iter: 1  value: 324.0315 mgc: 7.324753 ustep: 1 
iter: 2  value: 323.9513 mgc: 0.5419122 ustep: 1 
iter: 3  value: 323.9513 mgc: 0.002727966 ustep: 1 
iter: 4  value: 323.9513 mgc: 1.941329e-06 ustep: 1 
iter: 5  mgc: 1.16844e-12 
iter: 1  mgc: 1.16844e-12 
outer mgc:  16.39142 
iter: 1  value: 337.303 mgc: 11.78335 ustep: 1 
iter: 2  value: 336.8604 mgc: 0.8792684 ustep: 1 
iter: 3  value: 336.8583 mgc: 0.07511695 ustep: 1 
iter: 4  value: 336.8583 mgc: 0.0008050365 ustep: 1 
iter: 5  value: 336.8583 mgc: 9.377534e-08 ustep: 1 
iter: 6  mgc: 2.020606e-14 
iter: 1  value: 318.487 mgc: 4.222422 ustep: 1 
iter: 2  value: 318.4865 mgc: 0.04173852 ustep: 1 
iter: 3  value: 318.4865 mgc: 1.789945e-05 ustep: 1 
iter: 4  mgc: 4.06315e-11 
iter: 1  mgc: 4.06315e-11 
outer mgc:  14.98187 
iter: 1  value: 315.7 mgc: 9.538635 ustep: 1 
iter: 2  value: 315.694 mgc: 0.2868523 ustep: 1 
iter: 3  value: 315.694 mgc: 0.0005077071 ustep: 1 
iter: 4  mgc: 2.767808e-09 
iter: 1  mgc: 2.767808e-09 
outer mgc:  27.32473 
iter: 1  value: 310.1615 mgc: 4.125328 ustep: 1 
iter: 2  value: 310.1539 mgc: 0.1433444 ustep: 1 
iter: 3  value: 310.1539 mgc: 0.0003407463 ustep: 1 
iter: 4  mgc: 8.87348e-09 
iter: 1  mgc: 8.87348e-09 
outer mgc:  12.95655 
iter: 1  value: 305.9469 mgc: 10.83983 ustep: 1 
iter: 2  value: 305.9314 mgc: 0.3136254 ustep: 1 
iter: 3  value: 305.9314 mgc: 0.0006765817 ustep: 1 
iter: 4  value: 305.9314 mgc: 3.295673e-08 ustep: 1 
iter: 5  mgc: 2.506328e-14 
iter: 1  mgc: 2.506328e-14 
outer mgc:  14.32894 
iter: 1  value: 299.7224 mgc: 12.74011 ustep: 1 
iter: 2  value: 299.227 mgc: 0.8465522 ustep: 1 
iter: 3  value: 299.2267 mgc: 0.02601483 ustep: 1 
iter: 4  value: 299.2267 mgc: 4.669182e-05 ustep: 1 
iter: 5  mgc: 1.52232e-10 
iter: 1  value: 299.61 mgc: 17.44152 ustep: 1 
iter: 2  value: 299.0402 mgc: 1.026213 ustep: 1 
iter: 3  value: 299.0398 mgc: 0.02940143 ustep: 1 
iter: 4  value: 299.0398 mgc: 5.630794e-05 ustep: 1 
iter: 5  mgc: 2.101861e-10 
iter: 1  mgc: 1.52232e-10 
outer mgc:  8.62082 
iter: 1  value: 296.3243 mgc: 15.07487 ustep: 1 
iter: 2  value: 296.0598 mgc: 0.9592437 ustep: 1 
iter: 3  value: 296.0597 mgc: 0.009110343 ustep: 1 
iter: 4  value: 296.0597 mgc: 4.899271e-06 ustep: 1 
iter: 5  mgc: 1.966871e-12 
iter: 1  mgc: 1.966871e-12 
outer mgc:  18.35512 
iter: 1  value: 294.4654 mgc: 18.49663 ustep: 1 
iter: 2  value: 293.7751 mgc: 1.350803 ustep: 1 
iter: 3  value: 293.7747 mgc: 0.02581964 ustep: 1 
iter: 4  value: 293.7747 mgc: 4.197525e-05 ustep: 1 
iter: 5  mgc: 1.262292e-10 
iter: 1  mgc: 1.262292e-10 
outer mgc:  14.24505 
iter: 1  value: 296.3316 mgc: 9.520248 ustep: 1 
iter: 2  value: 296.1783 mgc: 0.3707831 ustep: 1 
iter: 3  value: 296.1782 mgc: 0.01549255 ustep: 1 
iter: 4  value: 296.1782 mgc: 3.262392e-05 ustep: 1 
iter: 5  mgc: 1.456408e-10 
iter: 1  value: 293.1263 mgc: 6.08046 ustep: 1 
iter: 2  value: 293.1259 mgc: 0.0659033 ustep: 1 
iter: 3  value: 293.1259 mgc: 1.91749e-05 ustep: 1 
iter: 4  mgc: 1.167555e-11 
iter: 1  mgc: 1.167555e-11 
outer mgc:  15.19998 
iter: 1  value: 291.0925 mgc: 4.750916 ustep: 1 
iter: 2  value: 291.0922 mgc: 0.05222423 ustep: 1 
iter: 3  value: 291.0922 mgc: 5.178156e-05 ustep: 1 
iter: 4  mgc: 4.244589e-10 
iter: 1  mgc: 4.244589e-10 
outer mgc:  2.887771 
iter: 1  value: 291.4794 mgc: 1.427525 ustep: 1 
iter: 2  value: 291.4794 mgc: 0.007066176 ustep: 1 
iter: 3  value: 291.4794 mgc: 8.874109e-07 ustep: 1 
iter: 4  mgc: 1.846301e-13 
iter: 1  value: 291.1697 mgc: 1.649842 ustep: 1 
iter: 2  value: 291.1697 mgc: 0.003643138 ustep: 1 
iter: 3  value: 291.1697 mgc: 6.771764e-08 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  2.526731 
iter: 1  value: 291.2445 mgc: 1.154617 ustep: 1 
iter: 2  value: 291.2445 mgc: 0.005470541 ustep: 1 
iter: 3  value: 291.2445 mgc: 8.628841e-07 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  value: 291.1826 mgc: 0.583015 ustep: 1 
iter: 2  value: 291.1826 mgc: 0.001567966 ustep: 1 
iter: 3  value: 291.1826 mgc: 4.977896e-08 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  3.004932 
iter: 1  value: 291.0633 mgc: 0.2738875 ustep: 1 
iter: 2  value: 291.0633 mgc: 0.0004515077 ustep: 1 
iter: 3  value: 291.0633 mgc: 2.213589e-08 ustep: 1 
mgc: 4.218847e-14 
iter: 1  mgc: 4.218847e-14 
outer mgc:  0.7553872 
iter: 1  value: 291.0158 mgc: 0.2045521 ustep: 1 
iter: 2  value: 291.0158 mgc: 0.0001390025 ustep: 1 
iter: 3  mgc: 3.462042e-09 
iter: 1  value: 290.9929 mgc: 0.370703 ustep: 1 
iter: 2  value: 290.9929 mgc: 0.0004258869 ustep: 1 
iter: 3  value: 290.9929 mgc: 3.619894e-08 ustep: 1 
iter: 4  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  0.9603153 
iter: 1  value: 291.0601 mgc: 3.067008 ustep: 1 
iter: 2  value: 291.06 mgc: 0.02035144 ustep: 1 
iter: 3  value: 291.06 mgc: 9.634084e-06 ustep: 1 
iter: 4  mgc: 6.396661e-12 
iter: 1  value: 291.0182 mgc: 1.263782 ustep: 1 
iter: 2  value: 291.0182 mgc: 0.004026031 ustep: 1 
iter: 3  value: 291.0182 mgc: 6.427024e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  value: 290.9757 mgc: 0.4035623 ustep: 1 
iter: 2  value: 290.9757 mgc: 0.0004190643 ustep: 1 
iter: 3  mgc: 6.907834e-10 
iter: 1  mgc: 6.907834e-10 
outer mgc:  0.6132751 
iter: 1  value: 290.9217 mgc: 0.1780517 ustep: 1 
iter: 2  value: 290.9217 mgc: 0.0001089769 ustep: 1 
iter: 3  mgc: 1.388071e-09 
iter: 1  mgc: 1.388071e-09 
outer mgc:  0.9010361 
iter: 1  value: 290.9144 mgc: 0.2718186 ustep: 1 
iter: 2  value: 290.9144 mgc: 0.0002997408 ustep: 1 
iter: 3  mgc: 8.118852e-10 
iter: 1  mgc: 8.118852e-10 
outer mgc:  0.4753399 
iter: 1  value: 290.9167 mgc: 0.2158697 ustep: 1 
iter: 2  value: 290.9167 mgc: 0.0001590337 ustep: 1 
iter: 3  mgc: 2.676298e-10 
iter: 1  mgc: 2.676298e-10 
outer mgc:  0.1771915 
iter: 1  value: 290.8992 mgc: 0.05814103 ustep: 1 
iter: 2  value: 290.8992 mgc: 8.075923e-06 ustep: 1 
iter: 3  mgc: 4.223288e-13 
iter: 1  mgc: 4.223288e-13 
outer mgc:  0.09154654 
iter: 1  value: 290.902 mgc: 0.07402357 ustep: 1 
iter: 2  value: 290.902 mgc: 1.855496e-05 ustep: 1 
iter: 3  mgc: 3.422221e-12 
iter: 1  mgc: 3.422221e-12 
outer mgc:  0.03220793 
iter: 1  value: 290.9029 mgc: 0.1393856 ustep: 1 
iter: 2  value: 290.9029 mgc: 0.0002598586 ustep: 1 
iter: 3  mgc: 1.406149e-09 
iter: 1  value: 290.9023 mgc: 0.06935023 ustep: 1 
iter: 2  value: 290.9023 mgc: 6.409401e-05 ustep: 1 
iter: 3  mgc: 8.554893e-11 
iter: 1  mgc: 8.554893e-11 
outer mgc:  0.02637188 
iter: 1  value: 290.9011 mgc: 0.01842641 ustep: 1 
iter: 2  value: 290.9011 mgc: 3.467455e-06 ustep: 1 
iter: 3  mgc: 8.053558e-13 
iter: 1  mgc: 8.053558e-13 
outer mgc:  0.008743382 
iter: 1  value: 290.9009 mgc: 0.009391365 ustep: 1 
iter: 2  value: 290.9009 mgc: 3.257468e-07 ustep: 1 
iter: 3  mgc: 2.668699e-14 
iter: 1  mgc: 2.668699e-14 
outer mgc:  0.008112228 
iter: 1  value: 290.9011 mgc: 0.004260293 ustep: 1 
iter: 2  value: 290.9011 mgc: 6.298561e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.0002281301 
iter: 1  value: 290.9011 mgc: 9.640328e-05 ustep: 1 
iter: 2  mgc: 7.373213e-11 
iter: 1  mgc: 7.373213e-11 
outer mgc:  3.264796e-05 
iter: 1  mgc: 7.373213e-11 
iter: 1  mgc: 7.373213e-11 
outer mgc:  3.264796e-05 
iter: 1  value: 290.9015 mgc: 0.04056757 ustep: 1 
iter: 2  value: 290.9015 mgc: 4.837793e-06 ustep: 1 
iter: 3  mgc: 1.169065e-13 
outer mgc:  0.09023017 
iter: 1  value: 290.9009 mgc: 0.04055851 ustep: 1 
iter: 2  value: 290.9009 mgc: 4.844076e-06 ustep: 1 
iter: 3  mgc: 1.066924e-13 
outer mgc:  0.09025039 
iter: 1  value: 290.8995 mgc: 0.01740502 ustep: 1 
iter: 2  value: 290.8995 mgc: 8.260337e-07 ustep: 1 
iter: 3  mgc: 2.844947e-14 
outer mgc:  0.138755 
iter: 1  value: 290.9029 mgc: 0.01739532 ustep: 1 
iter: 2  value: 290.9029 mgc: 8.25793e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.1386616 
iter: 1  value: 290.9013 mgc: 0.03433249 ustep: 1 
iter: 2  value: 290.9013 mgc: 1.204017e-06 ustep: 1 
iter: 3  mgc: 3.497203e-14 
outer mgc:  0.07855306 
iter: 1  value: 290.901 mgc: 0.03433275 ustep: 1 
iter: 2  value: 290.901 mgc: 1.200388e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.07854313 
iter: 1  value: 290.9035 mgc: 0.01997902 ustep: 1 
iter: 2  value: 290.9035 mgc: 5.549615e-07 ustep: 1 
iter: 3  mgc: 4.071743e-14 
outer mgc:  0.1469267 
iter: 1  value: 290.8989 mgc: 0.01998893 ustep: 1 
iter: 2  value: 290.8989 mgc: 5.542629e-07 ustep: 1 
iter: 3  mgc: 2.898376e-14 
outer mgc:  0.1470047 
iter: 1  value: 290.9001 mgc: 0.002815893 ustep: 1 
iter: 2  value: 290.9001 mgc: 4.145789e-08 ustep: 1 
mgc: 3.330669e-14 
outer mgc:  0.005139189 
iter: 1  value: 290.9022 mgc: 0.002814802 ustep: 1 
iter: 2  value: 290.9022 mgc: 4.144808e-08 ustep: 1 
mgc: 3.68594e-14 
outer mgc:  0.005073473 
iter: 1  value: 290.9049 mgc: 0.01180043 ustep: 1 
iter: 2  value: 290.9049 mgc: 9.223865e-07 ustep: 1 
iter: 3  mgc: 1.314504e-13 
outer mgc:  0.1325818 
iter: 1  value: 290.8975 mgc: 0.01183251 ustep: 1 
iter: 2  value: 290.8975 mgc: 9.288085e-07 ustep: 1 
iter: 3  mgc: 1.123546e-13 
outer mgc:  0.1327036 
iter: 1  value: 290.903 mgc: 0.01147595 ustep: 1 
iter: 2  value: 290.903 mgc: 4.233546e-07 ustep: 1 
iter: 3  mgc: 3.597123e-14 
outer mgc:  0.139062 
iter: 1  value: 290.8994 mgc: 0.01150538 ustep: 1 
iter: 2  value: 290.8994 mgc: 4.236793e-07 ustep: 1 
iter: 3  mgc: 2.747802e-14 
outer mgc:  0.139382 
[Sat Aug 14 14:28:37 2021]
Finished job 0.
1 of 1 steps (100%) done

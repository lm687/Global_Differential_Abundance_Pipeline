Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:03:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4506.507608 
final  value 4263.247701 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 541.5101 mgc: 53.76316 ustep: 1 
iter: 2  value: 526.4842 mgc: 15.4158 ustep: 1 
iter: 3  value: 525.556 mgc: 2.360077 ustep: 1 
iter: 4  value: 525.537 mgc: 0.2943965 ustep: 1 
iter: 5  value: 525.5369 mgc: 0.009296632 ustep: 1 
iter: 6  value: 525.5369 mgc: 9.815172e-06 ustep: 1 
iter: 7  mgc: 1.099204e-11 
iter: 1  mgc: 1.099204e-11 
Matching hessian patterns... Done
outer mgc:  183.196 
iter: 1  value: 484.5749 mgc: 33.58613 ustep: 1 
iter: 2  value: 483.3589 mgc: 3.394445 ustep: 1 
iter: 3  value: 483.3584 mgc: 0.1216807 ustep: 1 
iter: 4  value: 483.3584 mgc: 0.0001970775 ustep: 1 
iter: 5  mgc: 5.206857e-10 
iter: 1  mgc: 5.206857e-10 
outer mgc:  147.7229 
iter: 1  value: 432.1352 mgc: 26.03617 ustep: 1 
iter: 2  value: 431.6419 mgc: 3.919447 ustep: 1 
iter: 3  value: 431.6418 mgc: 0.07037465 ustep: 1 
iter: 4  value: 431.6418 mgc: 3.380226e-05 ustep: 1 
iter: 5  mgc: 1.940859e-11 
iter: 1  mgc: 1.940859e-11 
outer mgc:  44.14593 
iter: 1  value: 413.1703 mgc: 5.521426 ustep: 1 
iter: 2  value: 413.1439 mgc: 0.2815504 ustep: 1 
iter: 3  value: 413.1439 mgc: 0.004774343 ustep: 1 
iter: 4  value: 413.1439 mgc: 1.665775e-06 ustep: 1 
iter: 5  mgc: 1.89182e-13 
iter: 1  mgc: 1.89182e-13 
outer mgc:  20.26814 
iter: 1  value: 413.7011 mgc: 29.65798 ustep: 1 
iter: 2  value: 412.6481 mgc: 4.222907 ustep: 1 
iter: 3  value: 412.6462 mgc: 0.1286795 ustep: 1 
iter: 4  value: 412.6462 mgc: 0.0008479322 ustep: 1 
iter: 5  value: 412.6462 mgc: 2.990411e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  value: 410.2556 mgc: 15.2237 ustep: 1 
iter: 2  value: 410.2188 mgc: 0.9005665 ustep: 1 
iter: 3  value: 410.2188 mgc: 0.003766543 ustep: 1 
iter: 4  value: 410.2188 mgc: 3.558446e-07 ustep: 1 
iter: 5  mgc: 2.409184e-14 
iter: 1  mgc: 2.409184e-14 
outer mgc:  31.18283 
iter: 1  value: 405.5425 mgc: 9.622833 ustep: 1 
iter: 2  value: 405.2731 mgc: 0.9648854 ustep: 1 
iter: 3  value: 405.2731 mgc: 0.009330723 ustep: 1 
iter: 4  value: 405.2731 mgc: 1.83947e-06 ustep: 1 
iter: 5  mgc: 1.776357e-13 
iter: 1  mgc: 1.776357e-13 
outer mgc:  11.53001 
iter: 1  value: 406.9073 mgc: 16.33072 ustep: 1 
iter: 2  value: 406.7562 mgc: 0.8116019 ustep: 1 
iter: 3  value: 406.7562 mgc: 0.004312788 ustep: 1 
iter: 4  value: 406.7562 mgc: 1.185046e-06 ustep: 1 
iter: 5  mgc: 1.181277e-13 
iter: 1  value: 404.7525 mgc: 7.888754 ustep: 1 
iter: 2  value: 404.7504 mgc: 0.180704 ustep: 1 
iter: 3  value: 404.7504 mgc: 0.0001216566 ustep: 1 
iter: 4  mgc: 5.485079e-11 
iter: 1  mgc: 5.485079e-11 
outer mgc:  12.78 
iter: 1  value: 403.5832 mgc: 11.49936 ustep: 1 
iter: 2  value: 403.5723 mgc: 0.3102867 ustep: 1 
iter: 3  value: 403.5723 mgc: 0.0006431771 ustep: 1 
iter: 4  mgc: 3.524224e-09 
iter: 1  mgc: 3.524224e-09 
outer mgc:  7.34497 
iter: 1  value: 402.9556 mgc: 4.39039 ustep: 1 
iter: 2  value: 402.9533 mgc: 0.1014823 ustep: 1 
iter: 3  value: 402.9533 mgc: 0.0001828945 ustep: 1 
iter: 4  mgc: 2.034017e-09 
iter: 1  mgc: 2.034017e-09 
outer mgc:  9.826862 
iter: 1  value: 402.7565 mgc: 4.734982 ustep: 1 
iter: 2  value: 402.7557 mgc: 0.06859352 ustep: 1 
iter: 3  value: 402.7557 mgc: 6.221893e-05 ustep: 1 
iter: 4  mgc: 2.437108e-10 
iter: 1  mgc: 2.437108e-10 
outer mgc:  8.27423 
iter: 1  value: 402.1306 mgc: 2.758986 ustep: 1 
iter: 2  value: 402.1305 mgc: 0.01788797 ustep: 1 
iter: 3  value: 402.1305 mgc: 2.120476e-05 ustep: 1 
iter: 4  mgc: 2.764455e-11 
iter: 1  mgc: 2.764455e-11 
outer mgc:  3.930762 
iter: 1  value: 402.1713 mgc: 5.006779 ustep: 1 
iter: 2  value: 402.1707 mgc: 0.07770424 ustep: 1 
iter: 3  value: 402.1707 mgc: 5.54439e-05 ustep: 1 
iter: 4  mgc: 2.828626e-11 
iter: 1  mgc: 2.828626e-11 
outer mgc:  6.325493 
iter: 1  value: 402.1709 mgc: 3.96011 ustep: 1 
iter: 2  value: 402.1708 mgc: 0.03767565 ustep: 1 
iter: 3  value: 402.1708 mgc: 7.303876e-06 ustep: 1 
iter: 4  mgc: 5.12923e-13 
iter: 1  mgc: 5.12923e-13 
outer mgc:  8.273599 
iter: 1  value: 401.947 mgc: 0.2375657 ustep: 1 
iter: 2  value: 401.947 mgc: 0.0007190757 ustep: 1 
iter: 3  mgc: 7.468371e-09 
iter: 1  mgc: 7.468371e-09 
outer mgc:  0.7053603 
iter: 1  value: 401.9868 mgc: 1.390501 ustep: 1 
iter: 2  value: 401.9868 mgc: 0.005461474 ustep: 1 
iter: 3  value: 401.9868 mgc: 8.41952e-08 ustep: 1 
iter: 4  mgc: 3.419487e-14 
iter: 1  value: 401.939 mgc: 0.3638071 ustep: 1 
iter: 2  value: 401.939 mgc: 0.000380297 ustep: 1 
iter: 3  mgc: 4.357624e-10 
iter: 1  mgc: 4.357624e-10 
outer mgc:  0.6284894 
iter: 1  value: 401.9333 mgc: 0.2265223 ustep: 1 
iter: 2  value: 401.9333 mgc: 0.0001411814 ustep: 1 
iter: 3  mgc: 7.537126e-11 
iter: 1  mgc: 7.537126e-11 
outer mgc:  0.2866592 
iter: 1  value: 401.9322 mgc: 0.1485146 ustep: 1 
iter: 2  value: 401.9322 mgc: 8.073251e-05 ustep: 1 
iter: 3  mgc: 3.055936e-11 
iter: 1  mgc: 3.055936e-11 
outer mgc:  0.2831131 
iter: 1  value: 401.939 mgc: 0.06367655 ustep: 1 
iter: 2  value: 401.939 mgc: 3.812652e-05 ustep: 1 
iter: 3  mgc: 2.60747e-11 
iter: 1  value: 401.9484 mgc: 0.07479665 ustep: 1 
iter: 2  value: 401.9484 mgc: 5.204276e-05 ustep: 1 
iter: 3  mgc: 4.867395e-11 
iter: 1  mgc: 4.867395e-11 
outer mgc:  0.1633677 
iter: 1  value: 401.9078 mgc: 0.2196854 ustep: 1 
iter: 2  value: 401.9078 mgc: 0.0002066233 ustep: 1 
iter: 3  mgc: 1.178932e-09 
iter: 1  value: 401.932 mgc: 0.1597635 ustep: 1 
iter: 2  value: 401.932 mgc: 9.664807e-05 ustep: 1 
iter: 3  mgc: 6.551559e-11 
iter: 1  mgc: 6.551559e-11 
outer mgc:  0.2080264 
iter: 1  value: 401.9333 mgc: 0.2202637 ustep: 1 
iter: 2  value: 401.9333 mgc: 0.0001721207 ustep: 1 
iter: 3  mgc: 2.594098e-10 
iter: 1  mgc: 2.594098e-10 
outer mgc:  0.1329152 
iter: 1  value: 401.9328 mgc: 0.09205381 ustep: 1 
iter: 2  value: 401.9328 mgc: 4.110249e-05 ustep: 1 
iter: 3  mgc: 2.724398e-11 
iter: 1  mgc: 2.724398e-11 
outer mgc:  0.08145993 
iter: 1  value: 401.9398 mgc: 0.05821754 ustep: 1 
iter: 2  value: 401.9398 mgc: 1.697901e-05 ustep: 1 
iter: 3  mgc: 2.680522e-12 
iter: 1  value: 401.9362 mgc: 0.03411883 ustep: 1 
iter: 2  value: 401.9362 mgc: 5.935286e-06 ustep: 1 
iter: 3  mgc: 3.255174e-13 
iter: 1  mgc: 3.255174e-13 
outer mgc:  0.049356 
iter: 1  value: 401.9357 mgc: 0.05271498 ustep: 1 
iter: 2  value: 401.9357 mgc: 1.128243e-05 ustep: 1 
iter: 3  mgc: 3.550493e-13 
iter: 1  mgc: 3.550493e-13 
outer mgc:  0.03282809 
iter: 1  value: 401.9363 mgc: 0.02336061 ustep: 1 
iter: 2  value: 401.9363 mgc: 2.252883e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.02829978 
iter: 1  value: 401.9357 mgc: 0.01265459 ustep: 1 
iter: 2  value: 401.9357 mgc: 3.850243e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
iter: 1  value: 401.9361 mgc: 0.007278013 ustep: 1 
iter: 2  value: 401.9361 mgc: 1.393336e-07 ustep: 1 
iter: 3  mgc: 2.564615e-14 
iter: 1  mgc: 2.564615e-14 
outer mgc:  0.01430062 
iter: 1  value: 401.9359 mgc: 0.005430192 ustep: 1 
iter: 2  value: 401.9359 mgc: 1.004982e-07 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.001203339 
iter: 1  value: 401.9359 mgc: 0.0009271655 ustep: 1 
iter: 2  mgc: 2.078022e-09 
iter: 1  mgc: 2.078022e-09 
outer mgc:  0.001057533 
iter: 1  mgc: 2.078022e-09 
iter: 1  mgc: 2.078022e-09 
outer mgc:  0.001057533 
iter: 1  value: 401.9363 mgc: 0.05624254 ustep: 1 
iter: 2  value: 401.9363 mgc: 7.350925e-06 ustep: 1 
iter: 3  mgc: 2.038369e-13 
outer mgc:  0.07819346 
iter: 1  value: 401.9356 mgc: 0.05623425 ustep: 1 
iter: 2  value: 401.9356 mgc: 7.36198e-06 ustep: 1 
iter: 3  mgc: 2.118306e-13 
outer mgc:  0.07836206 
iter: 1  value: 401.9363 mgc: 0.02897199 ustep: 1 
iter: 2  value: 401.9363 mgc: 2.318034e-06 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.2595503 
iter: 1  value: 401.9358 mgc: 0.02896811 ustep: 1 
iter: 2  value: 401.9358 mgc: 2.316553e-06 ustep: 1 
iter: 3  mgc: 2.564615e-14 
outer mgc:  0.2574348 
iter: 1  value: 401.9359 mgc: 0.05374683 ustep: 1 
iter: 2  value: 401.9359 mgc: 8.600922e-06 ustep: 1 
iter: 3  mgc: 5.062617e-13 
outer mgc:  0.07172592 
iter: 1  value: 401.936 mgc: 0.05374877 ustep: 1 
iter: 2  value: 401.936 mgc: 8.608187e-06 ustep: 1 
iter: 3  mgc: 5.138112e-13 
outer mgc:  0.07171716 
iter: 1  value: 401.9363 mgc: 0.02853901 ustep: 1 
iter: 2  value: 401.9363 mgc: 2.866197e-06 ustep: 1 
iter: 3  mgc: 8.126833e-14 
outer mgc:  0.2299658 
iter: 1  value: 401.9358 mgc: 0.02853385 ustep: 1 
iter: 2  value: 401.9358 mgc: 2.866338e-06 ustep: 1 
iter: 3  mgc: 7.682743e-14 
outer mgc:  0.2319419 
iter: 1  value: 401.9349 mgc: 0.00432858 ustep: 1 
iter: 2  value: 401.9349 mgc: 1.589987e-07 ustep: 1 
mgc: 3.28626e-14 
outer mgc:  0.01038086 
iter: 1  value: 401.9369 mgc: 0.004325194 ustep: 1 
iter: 2  value: 401.9369 mgc: 1.588355e-07 ustep: 1 
mgc: 2.220446e-14 
outer mgc:  0.0104225 
iter: 1  value: 401.9378 mgc: 0.01151778 ustep: 1 
iter: 2  value: 401.9378 mgc: 1.009849e-06 ustep: 1 
iter: 3  mgc: 5.240253e-14 
outer mgc:  0.05792736 
iter: 1  value: 401.9341 mgc: 0.01154491 ustep: 1 
iter: 2  value: 401.9341 mgc: 1.015327e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.05684256 
iter: 1  value: 401.9379 mgc: 0.01103567 ustep: 1 
iter: 2  value: 401.9379 mgc: 4.453569e-07 ustep: 1 
iter: 3  mgc: 1.998401e-14 
outer mgc:  0.05675591 
iter: 1  value: 401.934 mgc: 0.01106189 ustep: 1 
iter: 2  value: 401.934 mgc: 4.487051e-07 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.05843932 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:03:53 2021]
Finished job 0.
1 of 1 steps (100%) done

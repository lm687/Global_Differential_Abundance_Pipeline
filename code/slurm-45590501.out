Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 03:30:35 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_4_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_10_4_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_4_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2749.021718 
iter  10 value 2239.152357
final  value 2239.109642 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1874.729 mgc: 114.5301 ustep: 0.4367355 
iter: 2  value: 764.32 mgc: 91.36708 ustep: 0.1263996 
iter: 3  value: 560.9832 mgc: 115.8648 ustep: 0.3555917 
iter: 4  value: 518.6983 mgc: 45.18494 ustep: 0.5963555 
iter: 5  value: 507.5103 mgc: 33.80427 ustep: 0.7722633 
iter: 6  value: 507.465 mgc: 1.648496 ustep: 0.8787973 
iter: 7  value: 507.465 mgc: 0.01146602 ustep: 0.9374481 
iter: 8  value: 507.465 mgc: 5.699147e-05 ustep: 0.9682222 
iter: 9  value: 507.465 mgc: 1.300888e-06 ustep: 0.9839844 
iter: 10  value: 507.465 mgc: 1.490593e-08 ustep: 0.9919607 
iter: 11  mgc: 8.553847e-11 
iter: 1  mgc: 8.553847e-11 
Matching hessian patterns... Done
outer mgc:  180.2032 
iter: 1  value: 344.7841 mgc: 34.57869 ustep: 1 
iter: 2  value: 336.5636 mgc: 10.42961 ustep: 1 
iter: 3  value: 336.5267 mgc: 0.7433017 ustep: 1 
iter: 4  value: 336.5267 mgc: 0.008458547 ustep: 1 
iter: 5  value: 336.5267 mgc: 1.136694e-06 ustep: 1 
iter: 6  mgc: 2.048361e-14 
iter: 1  mgc: 2.048361e-14 
outer mgc:  68.00765 
iter: 1  value: 295.0207 mgc: 21.31208 ustep: 1 
iter: 2  value: 294.6621 mgc: 1.640233 ustep: 1 
iter: 3  value: 294.662 mgc: 0.02408818 ustep: 1 
iter: 4  value: 294.662 mgc: 5.753449e-06 ustep: 1 
iter: 5  mgc: 4.123368e-13 
iter: 1  mgc: 4.123368e-13 
outer mgc:  8.270686 
iter: 1  value: 289.5958 mgc: 15.78321 ustep: 1 
iter: 2  value: 289.3531 mgc: 1.916439 ustep: 1 
iter: 3  value: 289.3529 mgc: 0.02964266 ustep: 1 
iter: 4  value: 289.3529 mgc: 7.932331e-05 ustep: 1 
iter: 5  mgc: 2.037295e-09 
iter: 1  mgc: 2.037295e-09 
outer mgc:  11.93788 
iter: 1  value: 289.9693 mgc: 13.61847 ustep: 1 
iter: 2  value: 289.9244 mgc: 0.8509907 ustep: 1 
iter: 3  value: 289.9244 mgc: 0.004231342 ustep: 1 
iter: 4  value: 289.9244 mgc: 1.916232e-07 ustep: 1 
iter: 5  mgc: 3.419487e-14 
iter: 1  value: 287.3264 mgc: 2.943969 ustep: 1 
iter: 2  value: 287.3258 mgc: 0.08188829 ustep: 1 
iter: 3  value: 287.3258 mgc: 0.0002209316 ustep: 1 
iter: 4  mgc: 3.216048e-09 
iter: 1  mgc: 3.216048e-09 
outer mgc:  9.590816 
iter: 1  value: 284.2751 mgc: 10.86646 ustep: 1 
iter: 2  value: 284.2594 mgc: 0.4587534 ustep: 1 
iter: 3  value: 284.2594 mgc: 0.001496001 ustep: 1 
iter: 4  value: 284.2594 mgc: 4.771776e-08 ustep: 1 
iter: 5  mgc: 1.626217e-14 
iter: 1  mgc: 1.626217e-14 
outer mgc:  9.337146 
iter: 1  value: 282.7807 mgc: 12.28585 ustep: 1 
iter: 2  value: 282.757 mgc: 0.568739 ustep: 1 
iter: 3  value: 282.757 mgc: 0.002254864 ustep: 1 
iter: 4  value: 282.757 mgc: 2.540909e-07 ustep: 1 
iter: 5  mgc: 3.042011e-14 
iter: 1  mgc: 3.042011e-14 
outer mgc:  8.237497 
iter: 1  value: 281.4624 mgc: 8.249534 ustep: 1 
iter: 2  value: 281.4335 mgc: 0.5015565 ustep: 1 
iter: 3  value: 281.4335 mgc: 0.004114015 ustep: 1 
iter: 4  value: 281.4335 mgc: 4.341554e-07 ustep: 1 
iter: 5  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  9.303135 
iter: 1  value: 279.1774 mgc: 7.279135 ustep: 1 
iter: 2  value: 279.1494 mgc: 0.255911 ustep: 1 
iter: 3  value: 279.1494 mgc: 0.007093837 ustep: 1 
iter: 4  value: 279.1494 mgc: 5.970431e-06 ustep: 1 
iter: 5  mgc: 4.232614e-12 
iter: 1  mgc: 4.232614e-12 
outer mgc:  6.796591 
iter: 1  value: 278.2508 mgc: 6.338248 ustep: 1 
iter: 2  value: 278.1395 mgc: 1.011966 ustep: 1 
iter: 3  value: 278.1394 mgc: 0.01615567 ustep: 1 
iter: 4  value: 278.1394 mgc: 4.355755e-06 ustep: 1 
iter: 5  mgc: 4.243203e-13 
iter: 1  mgc: 4.243203e-13 
outer mgc:  4.699808 
iter: 1  value: 276.9406 mgc: 4.185636 ustep: 1 
iter: 2  value: 276.9198 mgc: 0.3765188 ustep: 1 
iter: 3  value: 276.9198 mgc: 0.002435038 ustep: 1 
iter: 4  value: 276.9198 mgc: 1.466274e-07 ustep: 1 
iter: 5  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  2.958766 
iter: 1  value: 275.7492 mgc: 11.38598 ustep: 1 
iter: 2  value: 275.7271 mgc: 0.5463786 ustep: 1 
iter: 3  value: 275.7271 mgc: 0.002348228 ustep: 1 
iter: 4  value: 275.7271 mgc: 2.313537e-07 ustep: 1 
iter: 5  mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  4.016166 
iter: 1  value: 275.2561 mgc: 7.530696 ustep: 1 
iter: 2  value: 275.2437 mgc: 0.2613844 ustep: 1 
iter: 3  value: 275.2437 mgc: 0.0007400743 ustep: 1 
iter: 4  value: 275.2437 mgc: 1.203421e-08 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  2.424202 
iter: 1  value: 275.1183 mgc: 5.628232 ustep: 1 
iter: 2  value: 275.0514 mgc: 0.7475394 ustep: 1 
iter: 3  value: 275.0514 mgc: 0.008999041 ustep: 1 
iter: 4  value: 275.0514 mgc: 1.504305e-06 ustep: 1 
iter: 5  mgc: 5.795364e-14 
iter: 1  mgc: 5.795364e-14 
outer mgc:  2.808388 
iter: 1  value: 275.4246 mgc: 7.252596 ustep: 1 
iter: 2  value: 275.4225 mgc: 0.2476947 ustep: 1 
iter: 3  value: 275.4225 mgc: 0.0005125561 ustep: 1 
iter: 4  mgc: 2.212349e-09 
iter: 1  value: 274.9144 mgc: 5.231952 ustep: 1 
iter: 2  value: 274.9139 mgc: 0.1016996 ustep: 1 
iter: 3  value: 274.9139 mgc: 9.225369e-05 ustep: 1 
iter: 4  mgc: 3.006804e-10 
iter: 1  mgc: 3.006804e-10 
outer mgc:  5.560817 
iter: 1  value: 275.1435 mgc: 3.487149 ustep: 1 
iter: 2  value: 275.1435 mgc: 0.03808911 ustep: 1 
iter: 3  value: 275.1435 mgc: 7.537784e-06 ustep: 1 
iter: 4  mgc: 4.061196e-13 
iter: 1  value: 274.9627 mgc: 3.081842 ustep: 1 
iter: 2  value: 274.9626 mgc: 0.03505575 ustep: 1 
iter: 3  value: 274.9626 mgc: 9.787266e-06 ustep: 1 
iter: 4  mgc: 7.582823e-13 
iter: 1  mgc: 7.582823e-13 
outer mgc:  4.495534 
iter: 1  value: 274.7891 mgc: 1.899658 ustep: 1 
iter: 2  value: 274.7891 mgc: 0.01593996 ustep: 1 
iter: 3  value: 274.7891 mgc: 2.08269e-06 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.511073 
iter: 1  value: 274.7551 mgc: 1.604688 ustep: 1 
iter: 2  value: 274.7551 mgc: 0.01146246 ustep: 1 
iter: 3  value: 274.7551 mgc: 1.267921e-06 ustep: 1 
iter: 4  mgc: 3.502754e-14 
iter: 1  mgc: 3.502754e-14 
outer mgc:  0.7408962 
iter: 1  value: 274.696 mgc: 1.232809 ustep: 1 
iter: 2  value: 274.696 mgc: 0.006132739 ustep: 1 
iter: 3  value: 274.696 mgc: 1.535304e-07 ustep: 1 
iter: 4  mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  0.4028358 
iter: 1  value: 274.8391 mgc: 0.8293036 ustep: 1 
iter: 2  value: 274.8391 mgc: 0.002937937 ustep: 1 
iter: 3  value: 274.8391 mgc: 2.276851e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  value: 274.7408 mgc: 0.171023 ustep: 1 
iter: 2  value: 274.7408 mgc: 0.0004457587 ustep: 1 
iter: 3  value: 274.7408 mgc: 1.97702e-08 ustep: 1 
mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  0.8529876 
iter: 1  value: 274.7445 mgc: 0.4954748 ustep: 1 
iter: 2  value: 274.7445 mgc: 0.0007979565 ustep: 1 
iter: 3  mgc: 5.184249e-09 
iter: 1  mgc: 5.184249e-09 
outer mgc:  0.1723186 
iter: 1  value: 274.7656 mgc: 0.7437036 ustep: 1 
iter: 2  value: 274.7656 mgc: 0.001750901 ustep: 1 
iter: 3  value: 274.7656 mgc: 2.489739e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  value: 274.7513 mgc: 0.3457109 ustep: 1 
iter: 2  value: 274.7513 mgc: 0.0004484472 ustep: 1 
iter: 3  mgc: 1.655274e-09 
iter: 1  mgc: 1.655274e-09 
outer mgc:  0.07799008 
iter: 1  value: 274.7337 mgc: 0.09655478 ustep: 1 
iter: 2  value: 274.7337 mgc: 5.441971e-05 ustep: 1 
iter: 3  mgc: 1.000302e-10 
iter: 1  value: 274.7419 mgc: 0.04246827 ustep: 1 
iter: 2  value: 274.7419 mgc: 1.005771e-05 ustep: 1 
iter: 3  mgc: 2.211564e-12 
iter: 1  mgc: 2.211564e-12 
outer mgc:  0.06452294 
iter: 1  value: 274.744 mgc: 0.01840724 ustep: 1 
iter: 2  value: 274.744 mgc: 3.391555e-06 ustep: 1 
iter: 3  mgc: 1.960654e-13 
iter: 1  mgc: 1.960654e-13 
outer mgc:  0.03004708 
iter: 1  value: 274.7429 mgc: 0.06292176 ustep: 1 
iter: 2  value: 274.7429 mgc: 2.053728e-05 ustep: 1 
iter: 3  mgc: 4.7502e-12 
iter: 1  value: 274.7436 mgc: 0.01606805 ustep: 1 
iter: 2  value: 274.7436 mgc: 1.757462e-06 ustep: 1 
iter: 3  mgc: 3.841372e-14 
iter: 1  mgc: 3.841372e-14 
outer mgc:  0.02649155 
iter: 1  value: 274.7433 mgc: 0.01915776 ustep: 1 
iter: 2  value: 274.7433 mgc: 4.143533e-06 ustep: 1 
iter: 3  mgc: 2.846612e-13 
iter: 1  mgc: 2.846612e-13 
outer mgc:  0.00737451 
iter: 1  value: 274.7441 mgc: 0.01779513 ustep: 1 
iter: 2  value: 274.7441 mgc: 1.722479e-06 ustep: 1 
iter: 3  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.004510551 
iter: 1  value: 274.7442 mgc: 0.01508585 ustep: 1 
iter: 2  value: 274.7442 mgc: 4.839004e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.003733296 
iter: 1  value: 274.7433 mgc: 0.01640703 ustep: 1 
iter: 2  value: 274.7433 mgc: 1.278434e-06 ustep: 1 
iter: 3  mgc: 8.326673e-14 
iter: 1  value: 274.7438 mgc: 0.00761329 ustep: 1 
iter: 2  value: 274.7438 mgc: 2.751717e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.001427005 
iter: 1  value: 274.7438 mgc: 0.0038876 ustep: 1 
iter: 2  value: 274.7438 mgc: 1.158881e-07 ustep: 1 
iter: 3  mgc: 2.198242e-14 
iter: 1  mgc: 2.198242e-14 
outer mgc:  0.0004744816 
iter: 1  value: 274.7439 mgc: 0.00112883 ustep: 1 
iter: 2  value: 274.7439 mgc: 1.311268e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  0.0003115238 
iter: 1  value: 274.7437 mgc: 0.0007096847 ustep: 1 
iter: 2  mgc: 3.334836e-09 
iter: 1  mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  0.0003115238 
iter: 1  value: 274.7433 mgc: 0.01864928 ustep: 1 
iter: 2  value: 274.7433 mgc: 5.859744e-06 ustep: 1 
iter: 3  mgc: 6.015743e-13 
outer mgc:  0.009807127 
iter: 1  value: 274.7445 mgc: 0.01863597 ustep: 1 
iter: 2  value: 274.7445 mgc: 5.863903e-06 ustep: 1 
iter: 3  mgc: 6.019768e-13 
outer mgc:  0.009813423 
iter: 1  value: 274.7436 mgc: 0.007268662 ustep: 1 
iter: 2  value: 274.7436 mgc: 8.873301e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.01985496 
iter: 1  value: 274.7441 mgc: 0.007262483 ustep: 1 
iter: 2  value: 274.7441 mgc: 8.864446e-07 ustep: 1 
iter: 3  mgc: 4.396483e-14 
outer mgc:  0.01958636 
iter: 1  value: 274.7443 mgc: 0.04917095 ustep: 1 
iter: 2  value: 274.7443 mgc: 8.341852e-06 ustep: 1 
iter: 3  mgc: 4.260481e-13 
outer mgc:  0.03458191 
iter: 1  value: 274.7435 mgc: 0.04917326 ustep: 1 
iter: 2  value: 274.7435 mgc: 8.351309e-06 ustep: 1 
iter: 3  mgc: 4.309331e-13 
outer mgc:  0.03458012 
iter: 1  value: 274.7437 mgc: 0.02317959 ustep: 1 
iter: 2  value: 274.7437 mgc: 1.761693e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.08617757 
iter: 1  value: 274.7441 mgc: 0.02317831 ustep: 1 
iter: 2  value: 274.7441 mgc: 1.76117e-06 ustep: 1 
iter: 3  mgc: 2.978173e-14 
outer mgc:  0.08649501 
iter: 1  value: 274.7445 mgc: 0.04945477 ustep: 1 
iter: 2  value: 274.7445 mgc: 7.03206e-06 ustep: 1 
iter: 3  mgc: 4.03011e-13 
outer mgc:  0.02140494 
iter: 1  value: 274.7432 mgc: 0.04945921 ustep: 1 
iter: 2  value: 274.7432 mgc: 7.038861e-06 ustep: 1 
iter: 3  mgc: 4.054534e-13 
outer mgc:  0.02152237 
iter: 1  value: 274.7448 mgc: 0.02628467 ustep: 1 
iter: 2  value: 274.7448 mgc: 3.001915e-06 ustep: 1 
iter: 3  mgc: 7.926992e-14 
outer mgc:  0.1017964 
iter: 1  value: 274.743 mgc: 0.02628229 ustep: 1 
iter: 2  value: 274.743 mgc: 3.004138e-06 ustep: 1 
iter: 3  mgc: 7.771561e-14 
outer mgc:  0.1019635 
iter: 1  value: 274.7429 mgc: 0.005407282 ustep: 1 
iter: 2  value: 274.7429 mgc: 3.535161e-07 ustep: 1 
iter: 3  mgc: 2.131628e-14 
outer mgc:  0.005841201 
iter: 1  value: 274.7448 mgc: 0.005401902 ustep: 1 
iter: 2  value: 274.7448 mgc: 3.527911e-07 ustep: 1 
iter: 3  mgc: 3.18634e-14 
outer mgc:  0.005752502 
iter: 1  value: 274.7429 mgc: 0.002861339 ustep: 1 
iter: 2  value: 274.7429 mgc: 2.77198e-07 ustep: 1 
iter: 3  mgc: 2.431388e-14 
outer mgc:  0.004430532 
iter: 1  value: 274.7448 mgc: 0.002859164 ustep: 1 
iter: 2  value: 274.7448 mgc: 2.769763e-07 ustep: 1 
iter: 3  mgc: 3.874678e-14 
outer mgc:  0.004434014 
iter: 1  value: 274.7444 mgc: 0.00380961 ustep: 1 
iter: 2  value: 274.7444 mgc: 1.708642e-07 ustep: 1 
iter: 3  mgc: 2.059464e-14 
outer mgc:  0.007307779 
iter: 1  value: 274.7434 mgc: 0.003807203 ustep: 1 
iter: 2  value: 274.7434 mgc: 1.706651e-07 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.006681534 
iter: 1  value: 274.7461 mgc: 0.00400806 ustep: 1 
iter: 2  value: 274.7461 mgc: 1.589659e-06 ustep: 1 
iter: 3  mgc: 2.580158e-13 
outer mgc:  0.02341913 
iter: 1  value: 274.7417 mgc: 0.004017525 ustep: 1 
iter: 2  value: 274.7417 mgc: 1.5926e-06 ustep: 1 
iter: 3  mgc: 2.584599e-13 
outer mgc:  0.02343282 
iter: 1  value: 274.7456 mgc: 0.005325746 ustep: 1 
iter: 2  value: 274.7456 mgc: 2.812141e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.0197582 
iter: 1  value: 274.7421 mgc: 0.005337328 ustep: 1 
iter: 2  value: 274.7421 mgc: 2.822271e-07 ustep: 1 
iter: 3  mgc: 4.971024e-14 
outer mgc:  0.01971409 
iter: 1  value: 274.7444 mgc: 0.006929427 ustep: 1 
iter: 2  value: 274.7444 mgc: 3.584157e-07 ustep: 1 
iter: 3  mgc: 3.352874e-14 
outer mgc:  0.03026408 
iter: 1  value: 274.7434 mgc: 0.006946791 ustep: 1 
iter: 2  value: 274.7434 mgc: 3.605682e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.03041104 
[Mon Aug 16 03:30:39 2021]
Finished job 0.
1 of 1 steps (100%) done

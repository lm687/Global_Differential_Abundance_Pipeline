Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:45:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.05_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21996.415244 
final  value 18891.310084 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17686.1 mgc: 6.465031 ustep: 0.564674 
iter: 2  value: 17626.07 mgc: 5.253685 ustep: 0.7514728 
iter: 3  value: 17608.62 mgc: 5.087179 ustep: 0.3839721 
iter: 4  value: 17601.9 mgc: 3.715176 ustep: 0.6196929 
iter: 5  value: 17601.27 mgc: 1.515851 ustep: 0.787227 
iter: 6  value: 17601.26 mgc: 0.1544493 ustep: 0.8872694 
iter: 7  value: 17601.26 mgc: 0.01452551 ustep: 0.9419556 
iter: 8  value: 17601.26 mgc: 0.0007088229 ustep: 0.9705469 
iter: 9  value: 17601.26 mgc: 1.972255e-05 ustep: 0.9851649 
iter: 10  value: 17601.26 mgc: 2.994921e-07 ustep: 0.9925555 
iter: 11  mgc: 2.349097e-09 
iter: 1  mgc: 2.349097e-09 
Matching hessian patterns... Done
outer mgc:  110.7037 
iter: 1  value: 17421.37 mgc: 1.992657 ustep: 1 
iter: 2  value: 17421.11 mgc: 0.3065687 ustep: 1 
iter: 3  value: 17421.11 mgc: 0.00597763 ustep: 1 
iter: 4  value: 17421.11 mgc: 4.776147e-06 ustep: 1 
iter: 5  mgc: 3.254987e-12 
iter: 1  value: 17626.56 mgc: 15.17634 ustep: 1 
iter: 2  value: 17455.14 mgc: 11.27143 ustep: 1 
iter: 3  value: 17442.59 mgc: 6.759384 ustep: 0.2520791 
iter: 4  value: 17437.02 mgc: 8.775967 ustep: 0.5021246 
iter: 5  value: 17436.47 mgc: 2.838536 ustep: 0.7086366 
iter: 6  value: 17436.47 mgc: 0.09147517 ustep: 0.8418214 
iter: 7  value: 17436.47 mgc: 0.002188651 ustep: 0.9175165 
iter: 8  value: 17436.47 mgc: 2.396967e-05 ustep: 0.957875 
iter: 9  value: 17436.47 mgc: 1.301827e-07 ustep: 0.978713 
iter: 10  mgc: 3.532763e-10 
iter: 1  mgc: 3.254987e-12 
outer mgc:  69.77473 
iter: 1  value: 17288.72 mgc: 2.974151 ustep: 1 
iter: 2  value: 17288.35 mgc: 0.4154564 ustep: 1 
iter: 3  value: 17288.35 mgc: 0.007715662 ustep: 1 
iter: 4  value: 17288.35 mgc: 5.365318e-06 ustep: 1 
iter: 5  mgc: 3.209488e-12 
iter: 1  mgc: 3.209488e-12 
outer mgc:  49.42823 
iter: 1  value: 17229.71 mgc: 7.591015 ustep: 1 
iter: 2  value: 17227.3 mgc: 2.162808 ustep: 1 
iter: 3  value: 17227.3 mgc: 0.05850857 ustep: 1 
iter: 4  value: 17227.3 mgc: 0.0002661712 ustep: 1 
iter: 5  mgc: 4.59895e-09 
iter: 1  mgc: 4.59895e-09 
outer mgc:  140.4255 
iter: 1  value: 17180.39 mgc: 12.18977 ustep: 1 
iter: 2  value: 17169.14 mgc: 2.709515 ustep: 1 
iter: 3  value: 17169.12 mgc: 0.1114077 ustep: 1 
iter: 4  value: 17169.12 mgc: 0.0006270896 ustep: 1 
iter: 5  value: 17169.12 mgc: 1.309537e-08 ustep: 1 
mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  84.02144 
iter: 1  value: 17146.04 mgc: 16.07881 ustep: 1 
iter: 2  value: 17145.57 mgc: 1.241956 ustep: 1 
iter: 3  value: 17145.57 mgc: 0.01305655 ustep: 1 
iter: 4  value: 17145.57 mgc: 2.095481e-06 ustep: 1 
iter: 5  mgc: 6.558643e-14 
iter: 1  value: 17140.85 mgc: 4.650182 ustep: 1 
iter: 2  value: 17140.8 mgc: 0.3356516 ustep: 1 
iter: 3  value: 17140.8 mgc: 0.002333078 ustep: 1 
iter: 4  value: 17140.8 mgc: 1.176379e-07 ustep: 1 
iter: 5  mgc: 1.004752e-14 
iter: 1  mgc: 1.004752e-14 
outer mgc:  36.62346 
iter: 1  value: 17119.83 mgc: 6.994566 ustep: 1 
iter: 2  value: 17119.76 mgc: 0.294358 ustep: 1 
iter: 3  value: 17119.76 mgc: 0.00234578 ustep: 1 
iter: 4  value: 17119.76 mgc: 1.433737e-07 ustep: 1 
iter: 5  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  28.89544 
iter: 1  value: 17112.96 mgc: 2.772033 ustep: 1 
iter: 2  value: 17112.96 mgc: 0.06426501 ustep: 1 
iter: 3  value: 17112.96 mgc: 3.963954e-05 ustep: 1 
iter: 4  mgc: 1.345013e-11 
iter: 1  value: 17115.34 mgc: 1.454135 ustep: 1 
iter: 2  value: 17115.34 mgc: 0.01666718 ustep: 1 
iter: 3  value: 17115.34 mgc: 4.309709e-06 ustep: 1 
iter: 4  mgc: 2.411404e-13 
iter: 1  mgc: 2.411404e-13 
outer mgc:  28.47034 
iter: 1  value: 17115.15 mgc: 2.071068 ustep: 1 
iter: 2  value: 17115.15 mgc: 0.02433567 ustep: 1 
iter: 3  value: 17115.15 mgc: 3.713795e-06 ustep: 1 
iter: 4  mgc: 7.327472e-14 
iter: 1  value: 17115.25 mgc: 0.7430435 ustep: 1 
iter: 2  value: 17115.25 mgc: 0.00235295 ustep: 1 
iter: 3  value: 17115.25 mgc: 2.158045e-07 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  9.186287 
iter: 1  value: 17110.76 mgc: 0.4603048 ustep: 1 
iter: 2  value: 17110.76 mgc: 0.002633898 ustep: 1 
iter: 3  value: 17110.76 mgc: 7.54877e-08 ustep: 1 
iter: 4  mgc: 8.743006e-15 
iter: 1  mgc: 8.743006e-15 
outer mgc:  4.016214 
iter: 1  value: 17109.45 mgc: 0.6646786 ustep: 1 
iter: 2  value: 17109.45 mgc: 0.002913864 ustep: 1 
iter: 3  value: 17109.45 mgc: 7.403649e-08 ustep: 1 
iter: 4  mgc: 7.632783e-15 
iter: 1  mgc: 7.632783e-15 
outer mgc:  2.026898 
iter: 1  value: 17104.35 mgc: 0.9607183 ustep: 1 
iter: 2  value: 17104.35 mgc: 0.001373094 ustep: 1 
iter: 3  value: 17104.35 mgc: 5.058265e-08 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 17108.27 mgc: 0.2118992 ustep: 1 
iter: 2  value: 17108.27 mgc: 8.897712e-05 ustep: 1 
iter: 3  mgc: 5.199308e-11 
iter: 1  mgc: 5.199308e-11 
outer mgc:  2.63683 
iter: 1  value: 17106.34 mgc: 0.3310499 ustep: 1 
iter: 2  value: 17106.34 mgc: 0.0003379442 ustep: 1 
iter: 3  mgc: 1.145524e-09 
iter: 1  value: 17107.84 mgc: 0.1094397 ustep: 1 
iter: 2  value: 17107.84 mgc: 3.470802e-05 ustep: 1 
iter: 3  mgc: 4.549783e-11 
iter: 1  mgc: 4.549783e-11 
outer mgc:  2.718363 
iter: 1  value: 17107.82 mgc: 0.06114666 ustep: 1 
iter: 2  value: 17107.82 mgc: 1.19157e-05 ustep: 1 
iter: 3  mgc: 4.76108e-12 
iter: 1  mgc: 4.76108e-12 
outer mgc:  0.6248711 
iter: 1  value: 17106.85 mgc: 0.1170287 ustep: 1 
iter: 2  value: 17106.85 mgc: 7.402677e-05 ustep: 1 
iter: 3  mgc: 5.693224e-11 
iter: 1  value: 17105.07 mgc: 0.2179978 ustep: 1 
iter: 2  value: 17105.07 mgc: 0.0002377784 ustep: 1 
iter: 3  mgc: 6.33031e-10 
iter: 1  mgc: 6.33031e-10 
outer mgc:  1.626404 
iter: 1  value: 17103.34 mgc: 0.2451104 ustep: 1 
iter: 2  value: 17103.34 mgc: 0.0004504391 ustep: 1 
iter: 3  mgc: 1.765728e-09 
iter: 1  mgc: 1.765728e-09 
outer mgc:  1.124727 
iter: 1  value: 17102.38 mgc: 0.1079458 ustep: 1 
iter: 2  value: 17102.38 mgc: 0.0002222257 ustep: 1 
iter: 3  mgc: 2.771841e-10 
iter: 1  mgc: 2.771841e-10 
outer mgc:  0.4540472 
iter: 1  value: 17101.36 mgc: 0.2690176 ustep: 1 
iter: 2  value: 17101.36 mgc: 0.0001557607 ustep: 1 
iter: 3  mgc: 1.783373e-10 
iter: 1  mgc: 1.783373e-10 
outer mgc:  1.632462 
iter: 1  value: 17100.29 mgc: 0.1774812 ustep: 1 
iter: 2  value: 17100.29 mgc: 0.000175127 ustep: 1 
iter: 3  mgc: 2.368994e-10 
iter: 1  mgc: 2.368994e-10 
outer mgc:  2.611775 
iter: 1  value: 17098.91 mgc: 0.2107126 ustep: 1 
iter: 2  value: 17098.91 mgc: 0.0003227945 ustep: 1 
iter: 3  mgc: 5.341461e-10 
iter: 1  mgc: 5.341461e-10 
outer mgc:  0.8476049 
iter: 1  value: 17098.01 mgc: 0.3959365 ustep: 1 
iter: 2  value: 17098.01 mgc: 0.0005826966 ustep: 1 
iter: 3  mgc: 2.148004e-09 
iter: 1  mgc: 2.148004e-09 
outer mgc:  0.5411579 
iter: 1  value: 17096.89 mgc: 0.1757933 ustep: 1 
iter: 2  value: 17096.89 mgc: 0.0001187986 ustep: 1 
iter: 3  mgc: 9.474022e-11 
iter: 1  mgc: 9.474022e-11 
outer mgc:  0.4247477 
iter: 1  value: 17095.64 mgc: 0.1845678 ustep: 1 
iter: 2  value: 17095.64 mgc: 0.0001874452 ustep: 1 
iter: 3  mgc: 2.173639e-10 
iter: 1  mgc: 2.173639e-10 
outer mgc:  0.7074674 
iter: 1  value: 17093.96 mgc: 0.1913847 ustep: 1 
iter: 2  value: 17093.96 mgc: 0.0001076364 ustep: 1 
iter: 3  mgc: 6.405987e-11 
iter: 1  mgc: 6.405987e-11 
outer mgc:  1.364874 
iter: 1  value: 17092.19 mgc: 0.2002101 ustep: 1 
iter: 2  value: 17092.19 mgc: 0.0001090746 ustep: 1 
iter: 3  mgc: 7.130341e-11 
iter: 1  value: 17090.23 mgc: 0.2157847 ustep: 1 
iter: 2  value: 17090.23 mgc: 0.0001376333 ustep: 1 
iter: 3  mgc: 9.415846e-11 
iter: 1  mgc: 9.415846e-11 
outer mgc:  1.090228 
iter: 1  value: 17087.29 mgc: 0.3137588 ustep: 1 
iter: 2  value: 17087.29 mgc: 0.0002992307 ustep: 1 
iter: 3  mgc: 4.726752e-10 
iter: 1  mgc: 4.726752e-10 
outer mgc:  0.4504562 
iter: 1  value: 17084.27 mgc: 0.4235537 ustep: 1 
iter: 2  value: 17084.27 mgc: 0.0001990273 ustep: 1 
iter: 3  mgc: 3.193801e-10 
iter: 1  mgc: 3.193801e-10 
outer mgc:  0.2276698 
iter: 1  value: 17080.36 mgc: 0.4289313 ustep: 1 
iter: 2  value: 17080.36 mgc: 0.0005335594 ustep: 1 
iter: 3  mgc: 9.036567e-10 
iter: 1  mgc: 9.036567e-10 
outer mgc:  0.1653115 
iter: 1  value: 17077.49 mgc: 0.2870505 ustep: 1 
iter: 2  value: 17077.49 mgc: 0.0001312576 ustep: 1 
iter: 3  mgc: 8.630874e-11 
iter: 1  mgc: 8.630874e-11 
outer mgc:  0.03761624 
iter: 1  value: 17076.43 mgc: 0.09544169 ustep: 1 
iter: 2  value: 17076.43 mgc: 2.02971e-05 ustep: 1 
iter: 3  mgc: 1.581846e-12 
iter: 1  mgc: 1.581846e-12 
outer mgc:  0.03445416 
iter: 1  value: 17076.27 mgc: 0.01577393 ustep: 1 
iter: 2  value: 17076.27 mgc: 5.75881e-07 ustep: 1 
iter: 3  mgc: 6.77236e-15 
iter: 1  mgc: 6.77236e-15 
outer mgc:  0.01149002 
iter: 1  value: 17076.32 mgc: 0.004893 ustep: 1 
iter: 2  value: 17076.32 mgc: 5.06601e-08 ustep: 1 
mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.0003346732 
iter: 1  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.0003346732 
iter: 1  value: 17076.33 mgc: 0.00619796 ustep: 1 
iter: 2  value: 17076.33 mgc: 3.281021e-07 ustep: 1 
iter: 3  mgc: 1.04361e-14 
outer mgc:  0.3623428 
iter: 1  value: 17076.31 mgc: 0.006198498 ustep: 1 
iter: 2  value: 17076.31 mgc: 3.27088e-07 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.3623293 
iter: 1  value: 17076.32 mgc: 0.003320975 ustep: 1 
iter: 2  value: 17076.32 mgc: 1.278201e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.2158529 
iter: 1  value: 17076.32 mgc: 0.003321216 ustep: 1 
iter: 2  value: 17076.32 mgc: 1.276561e-07 ustep: 1 
iter: 3  mgc: 7.549517e-15 
outer mgc:  0.215955 
iter: 1  value: 17076.32 mgc: 0.004431229 ustep: 1 
iter: 2  value: 17076.32 mgc: 7.904637e-08 ustep: 1 
iter: 3  mgc: 8.437695e-15 
outer mgc:  0.2465326 
iter: 1  value: 17076.32 mgc: 0.004428091 ustep: 1 
iter: 2  value: 17076.32 mgc: 7.892416e-08 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.2460265 
iter: 1  value: 17076.32 mgc: 0.002209155 ustep: 1 
iter: 2  value: 17076.32 mgc: 2.52343e-08 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.1196923 
iter: 1  value: 17076.32 mgc: 0.002207709 ustep: 1 
iter: 2  value: 17076.32 mgc: 2.519179e-08 ustep: 1 
mgc: 9.103829e-15 
outer mgc:  0.1191875 
iter: 1  value: 17076.38 mgc: 0.0343393 ustep: 1 
iter: 2  value: 17076.38 mgc: 5.565901e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.06214933 
iter: 1  value: 17076.26 mgc: 0.03443498 ustep: 1 
iter: 2  value: 17076.26 mgc: 5.597617e-07 ustep: 1 
iter: 3  mgc: 9.28424e-15 
outer mgc:  0.0615787 
iter: 1  value: 17076.4 mgc: 0.0292767 ustep: 1 
iter: 2  value: 17076.4 mgc: 1.368906e-06 ustep: 1 
iter: 3  mgc: 9.325873e-15 
outer mgc:  0.02968129 
iter: 1  value: 17076.24 mgc: 0.02936252 ustep: 1 
iter: 2  value: 17076.24 mgc: 1.368088e-06 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.02940915 
iter: 1  value: 17076.29 mgc: 0.003386961 ustep: 1 
iter: 2  value: 17076.29 mgc: 1.716499e-08 ustep: 1 
mgc: 8.881784e-15 
outer mgc:  0.00227465 
iter: 1  value: 17076.35 mgc: 0.003385425 ustep: 1 
iter: 2  value: 17076.35 mgc: 1.720147e-08 ustep: 1 
mgc: 8.65974e-15 
outer mgc:  0.002946067 
iter: 1  value: 17076.3 mgc: 0.005118071 ustep: 1 
iter: 2  value: 17076.3 mgc: 1.59364e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.1354004 
iter: 1  value: 17076.34 mgc: 0.00511447 ustep: 1 
iter: 2  value: 17076.34 mgc: 1.591834e-07 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.1360533 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:45:08 2021]
Finished job 0.
1 of 1 steps (100%) done

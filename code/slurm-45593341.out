Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:32:24 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22015.091653 
final  value 14955.045495 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 5575.272 mgc: 141.1976 ustep: 1 
iter: 2  value: 4967.789 mgc: 27.35377 ustep: 1 
iter: 3  value: 4801.101 mgc: 35.99152 ustep: 1 
iter: 4  value: 4797.316 mgc: 6.057985 ustep: 1 
iter: 5  value: 4797.302 mgc: 0.4233791 ustep: 1 
iter: 6  value: 4797.302 mgc: 0.002838742 ustep: 1 
iter: 7  value: 4797.302 mgc: 1.73263e-07 ustep: 1 
iter: 8  mgc: 4.318768e-14 
iter: 1  mgc: 4.318768e-14 
Matching hessian patterns... Done
outer mgc:  2396.382 
iter: 1  value: 2879.194 mgc: 28.38384 ustep: 1 
iter: 2  value: 2848.581 mgc: 8.584351 ustep: 1 
iter: 3  value: 2848.518 mgc: 0.4829579 ustep: 1 
iter: 4  value: 2848.518 mgc: 0.002676974 ustep: 1 
iter: 5  value: 2848.518 mgc: 2.797498e-07 ustep: 1 
iter: 6  mgc: 4.501954e-14 
iter: 1  value: 1940.408 mgc: 29.93139 ustep: 1 
iter: 2  value: 1904.243 mgc: 6.912298 ustep: 1 
iter: 3  value: 1904.109 mgc: 0.4860727 ustep: 1 
iter: 4  value: 1904.109 mgc: 0.006670627 ustep: 1 
iter: 5  value: 1904.109 mgc: 1.248608e-06 ustep: 1 
iter: 6  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  335.0796 
iter: 1  value: 1548.121 mgc: 31.07282 ustep: 1 
iter: 2  value: 1518.491 mgc: 5.023552 ustep: 1 
iter: 3  value: 1518.42 mgc: 0.3454785 ustep: 1 
iter: 4  value: 1518.42 mgc: 0.003217649 ustep: 1 
iter: 5  value: 1518.42 mgc: 3.001558e-07 ustep: 1 
iter: 6  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  435.1562 
iter: 1  value: 2274.627 mgc: 39.83744 ustep: 1 
iter: 2  value: 2264.486 mgc: 5.029363 ustep: 1 
iter: 3  value: 2264.48 mgc: 0.203589 ustep: 1 
iter: 4  value: 2264.48 mgc: 0.0003829476 ustep: 1 
iter: 5  mgc: 1.720615e-09 
iter: 1  value: 1340.154 mgc: 12.23865 ustep: 1 
iter: 2  value: 1340.116 mgc: 0.3200125 ustep: 1 
iter: 3  value: 1340.116 mgc: 0.0008550803 ustep: 1 
iter: 4  mgc: 9.640057e-09 
iter: 1  mgc: 9.640057e-09 
outer mgc:  71.67522 
iter: 1  value: 1315.423 mgc: 15.72322 ustep: 1 
iter: 2  value: 1314.638 mgc: 0.9192953 ustep: 1 
iter: 3  value: 1314.637 mgc: 0.03343296 ustep: 1 
iter: 4  value: 1314.637 mgc: 7.409858e-05 ustep: 1 
iter: 5  mgc: 3.764282e-10 
iter: 1  mgc: 3.764282e-10 
outer mgc:  160.5416 
iter: 1  value: 1295.471 mgc: 7.887916 ustep: 1 
iter: 2  value: 1295.396 mgc: 0.3824014 ustep: 1 
iter: 3  value: 1295.396 mgc: 0.001137919 ustep: 1 
iter: 4  value: 1295.396 mgc: 1.039507e-08 ustep: 1 
mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  202.789 
iter: 1  value: 1251.933 mgc: 25.05884 ustep: 1 
iter: 2  value: 1242.572 mgc: 3.385038 ustep: 1 
iter: 3  value: 1242.569 mgc: 0.08852915 ustep: 1 
iter: 4  value: 1242.569 mgc: 0.0001330921 ustep: 1 
iter: 5  mgc: 7.789187e-10 
iter: 1  mgc: 7.789187e-10 
outer mgc:  106.0053 
iter: 1  value: 1220.295 mgc: 18.81683 ustep: 1 
iter: 2  value: 1217.283 mgc: 1.528126 ustep: 1 
iter: 3  value: 1217.282 mgc: 0.03166917 ustep: 1 
iter: 4  value: 1217.282 mgc: 2.113692e-05 ustep: 1 
iter: 5  mgc: 8.762768e-12 
iter: 1  mgc: 8.762768e-12 
outer mgc:  186.8077 
iter: 1  value: 1177.904 mgc: 7.739827 ustep: 1 
iter: 2  value: 1177.457 mgc: 0.6299643 ustep: 1 
iter: 3  value: 1177.457 mgc: 0.01199561 ustep: 1 
iter: 4  value: 1177.457 mgc: 6.427364e-06 ustep: 1 
iter: 5  mgc: 1.848299e-12 
iter: 1  mgc: 1.848299e-12 
outer mgc:  145.2914 
iter: 1  value: 1192.489 mgc: 20.68333 ustep: 1 
iter: 2  value: 1190.432 mgc: 1.494301 ustep: 1 
iter: 3  value: 1190.431 mgc: 0.01642608 ustep: 1 
iter: 4  value: 1190.431 mgc: 6.997403e-06 ustep: 1 
iter: 5  mgc: 1.731948e-12 
iter: 1  value: 1162.672 mgc: 9.354601 ustep: 1 
iter: 2  value: 1162.648 mgc: 0.2210565 ustep: 1 
iter: 3  value: 1162.648 mgc: 0.0002184886 ustep: 1 
iter: 4  mgc: 2.506996e-10 
iter: 1  mgc: 2.506996e-10 
outer mgc:  78.72082 
iter: 1  value: 1153.519 mgc: 10.46985 ustep: 1 
iter: 2  value: 1153.417 mgc: 0.4722834 ustep: 1 
iter: 3  value: 1153.417 mgc: 0.001476399 ustep: 1 
iter: 4  value: 1153.417 mgc: 1.456045e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  83.34952 
iter: 1  value: 1139.485 mgc: 6.577962 ustep: 1 
iter: 2  value: 1139.474 mgc: 0.2770344 ustep: 1 
iter: 3  value: 1139.474 mgc: 0.0005867841 ustep: 1 
iter: 4  mgc: 6.313076e-09 
iter: 1  mgc: 6.313076e-09 
outer mgc:  35.30492 
iter: 1  value: 1140.897 mgc: 3.005209 ustep: 1 
iter: 2  value: 1140.897 mgc: 0.05071813 ustep: 1 
iter: 3  value: 1140.897 mgc: 2.127338e-05 ustep: 1 
iter: 4  mgc: 1.252154e-11 
iter: 1  value: 1137.046 mgc: 1.282565 ustep: 1 
iter: 2  value: 1137.046 mgc: 0.007297289 ustep: 1 
iter: 3  value: 1137.046 mgc: 2.499802e-07 ustep: 1 
iter: 4  mgc: 3.841372e-14 
iter: 1  mgc: 3.841372e-14 
outer mgc:  11.78619 
iter: 1  value: 1133.936 mgc: 1.322655 ustep: 1 
iter: 2  value: 1133.936 mgc: 0.00638257 ustep: 1 
iter: 3  value: 1133.936 mgc: 1.118051e-06 ustep: 1 
iter: 4  mgc: 6.57252e-14 
iter: 1  mgc: 6.57252e-14 
outer mgc:  10.9226 
iter: 1  value: 1131.881 mgc: 2.845781 ustep: 1 
iter: 2  value: 1131.881 mgc: 0.0100238 ustep: 1 
iter: 3  value: 1131.881 mgc: 7.451012e-07 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  value: 1133.236 mgc: 0.9247082 ustep: 1 
iter: 2  value: 1133.236 mgc: 0.002230401 ustep: 1 
iter: 3  value: 1133.236 mgc: 2.200944e-08 ustep: 1 
mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  11.94019 
iter: 1  value: 1132.693 mgc: 0.7750639 ustep: 1 
iter: 2  value: 1132.693 mgc: 0.003490773 ustep: 1 
iter: 3  value: 1132.693 mgc: 7.760516e-08 ustep: 1 
iter: 4  mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  12.68541 
iter: 1  value: 1131.769 mgc: 1.450507 ustep: 1 
iter: 2  value: 1131.769 mgc: 0.002755996 ustep: 1 
iter: 3  value: 1131.769 mgc: 5.302186e-08 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  value: 1132.184 mgc: 0.8201067 ustep: 1 
iter: 2  value: 1132.184 mgc: 0.001262422 ustep: 1 
iter: 3  mgc: 6.784101e-09 
iter: 1  mgc: 6.784101e-09 
outer mgc:  6.123106 
iter: 1  value: 1131.985 mgc: 0.6952392 ustep: 1 
iter: 2  value: 1131.985 mgc: 0.0009674887 ustep: 1 
iter: 3  value: 1131.985 mgc: 1.217804e-08 ustep: 1 
mgc: 4.145295e-14 
iter: 1  mgc: 4.145295e-14 
outer mgc:  2.210023 
iter: 1  value: 1131.314 mgc: 0.5291414 ustep: 1 
iter: 2  value: 1131.314 mgc: 0.0005021791 ustep: 1 
iter: 3  mgc: 1.060028e-09 
iter: 1  mgc: 1.060028e-09 
outer mgc:  6.505029 
iter: 1  value: 1130.965 mgc: 0.3726583 ustep: 1 
iter: 2  value: 1130.965 mgc: 0.0007852284 ustep: 1 
iter: 3  mgc: 3.73673e-09 
iter: 1  mgc: 3.73673e-09 
outer mgc:  4.546464 
iter: 1  value: 1130.76 mgc: 0.2717782 ustep: 1 
iter: 2  value: 1130.76 mgc: 0.0003258267 ustep: 1 
iter: 3  mgc: 3.368283e-10 
iter: 1  mgc: 3.368283e-10 
outer mgc:  1.16404 
iter: 1  value: 1130.644 mgc: 0.406812 ustep: 1 
iter: 2  value: 1130.644 mgc: 0.0007097303 ustep: 1 
iter: 3  mgc: 3.626362e-09 
iter: 1  value: 1130.727 mgc: 0.06657659 ustep: 1 
iter: 2  value: 1130.727 mgc: 1.915263e-05 ustep: 1 
iter: 3  mgc: 2.636114e-12 
iter: 1  mgc: 2.636114e-12 
outer mgc:  0.8560368 
iter: 1  value: 1130.698 mgc: 0.08682094 ustep: 1 
iter: 2  value: 1130.698 mgc: 3.66761e-05 ustep: 1 
iter: 3  mgc: 7.626788e-12 
iter: 1  mgc: 7.626788e-12 
outer mgc:  0.8642261 
iter: 1  value: 1130.618 mgc: 0.07562999 ustep: 1 
iter: 2  value: 1130.618 mgc: 1.027745e-05 ustep: 1 
iter: 3  mgc: 4.352074e-13 
iter: 1  mgc: 4.352074e-13 
outer mgc:  0.764601 
iter: 1  value: 1130.562 mgc: 0.04260854 ustep: 1 
iter: 2  value: 1130.562 mgc: 1.17503e-05 ustep: 1 
iter: 3  mgc: 9.725554e-13 
iter: 1  mgc: 9.725554e-13 
outer mgc:  0.4234594 
iter: 1  value: 1130.512 mgc: 0.02716632 ustep: 1 
iter: 2  value: 1130.512 mgc: 3.5682e-06 ustep: 1 
iter: 3  mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  0.283142 
iter: 1  value: 1130.504 mgc: 0.06785289 ustep: 1 
iter: 2  value: 1130.504 mgc: 1.833021e-05 ustep: 1 
iter: 3  mgc: 3.216094e-12 
iter: 1  value: 1130.5 mgc: 0.05094065 ustep: 1 
iter: 2  value: 1130.5 mgc: 6.368432e-06 ustep: 1 
iter: 3  mgc: 4.068412e-13 
iter: 1  mgc: 4.068412e-13 
outer mgc:  0.508799 
iter: 1  value: 1130.447 mgc: 0.04255466 ustep: 1 
iter: 2  value: 1130.447 mgc: 7.378295e-06 ustep: 1 
iter: 3  mgc: 2.264855e-13 
iter: 1  mgc: 2.264855e-13 
outer mgc:  0.2234551 
iter: 1  value: 1130.358 mgc: 0.03118863 ustep: 1 
iter: 2  value: 1130.358 mgc: 5.824412e-06 ustep: 1 
iter: 3  mgc: 2.033929e-13 
iter: 1  mgc: 2.033929e-13 
outer mgc:  0.1864991 
iter: 1  value: 1130.368 mgc: 0.01375719 ustep: 1 
iter: 2  value: 1130.368 mgc: 1.783298e-06 ustep: 1 
iter: 3  mgc: 5.939693e-14 
iter: 1  value: 1130.362 mgc: 0.01178106 ustep: 1 
iter: 2  value: 1130.362 mgc: 9.702206e-07 ustep: 1 
iter: 3  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  0.2714032 
iter: 1  value: 1130.364 mgc: 0.01291905 ustep: 1 
iter: 2  value: 1130.364 mgc: 6.200438e-07 ustep: 1 
iter: 3  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  0.19077 
iter: 1  value: 1130.364 mgc: 0.00670213 ustep: 1 
iter: 2  value: 1130.364 mgc: 2.390558e-07 ustep: 1 
iter: 3  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  0.04297686 
iter: 1  value: 1130.353 mgc: 0.02139767 ustep: 1 
iter: 2  value: 1130.353 mgc: 1.351036e-06 ustep: 1 
iter: 3  mgc: 4.798939e-14 
iter: 1  value: 1130.362 mgc: 0.007601521 ustep: 1 
iter: 2  value: 1130.362 mgc: 1.686635e-07 ustep: 1 
iter: 3  mgc: 3.663736e-14 
iter: 1  mgc: 3.663736e-14 
outer mgc:  0.04547497 
iter: 1  value: 1130.363 mgc: 0.005303561 ustep: 1 
iter: 2  value: 1130.363 mgc: 8.306004e-08 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.02825168 
iter: 1  value: 1130.362 mgc: 0.00230504 ustep: 1 
iter: 2  value: 1130.362 mgc: 1.7294e-08 ustep: 1 
mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  0.01161803 
iter: 1  value: 1130.357 mgc: 0.002206208 ustep: 1 
iter: 2  value: 1130.357 mgc: 1.50852e-08 ustep: 1 
mgc: 3.597123e-14 
iter: 1  mgc: 3.597123e-14 
outer mgc:  0.0204964 
iter: 1  value: 1130.356 mgc: 0.0008322899 ustep: 1 
iter: 2  mgc: 3.915337e-09 
iter: 1  mgc: 3.915337e-09 
outer mgc:  0.007115235 
iter: 1  value: 1130.357 mgc: 0.0003962108 ustep: 1 
iter: 2  mgc: 1.522785e-09 
iter: 1  mgc: 1.522785e-09 
outer mgc:  0.006117317 
iter: 1  value: 1130.359 mgc: 0.000784165 ustep: 1 
iter: 2  mgc: 3.803308e-09 
iter: 1  value: 1130.357 mgc: 0.0002445343 ustep: 1 
iter: 2  mgc: 4.288889e-10 
iter: 1  mgc: 4.288889e-10 
outer mgc:  0.001821258 
iter: 1  value: 1130.357 mgc: 0.0002963193 ustep: 1 
iter: 2  mgc: 3.108113e-10 
iter: 1  mgc: 3.108113e-10 
outer mgc:  0.001709318 
iter: 1  mgc: 3.108113e-10 
iter: 1  mgc: 3.108113e-10 
outer mgc:  0.001709318 
iter: 1  value: 1130.366 mgc: 0.04444266 ustep: 1 
iter: 2  value: 1130.366 mgc: 4.800768e-06 ustep: 1 
iter: 3  mgc: 1.829648e-13 
outer mgc:  0.9261559 
iter: 1  value: 1130.349 mgc: 0.04444496 ustep: 1 
iter: 2  value: 1130.349 mgc: 4.796773e-06 ustep: 1 
iter: 3  mgc: 2.033929e-13 
outer mgc:  0.9289732 
iter: 1  value: 1130.365 mgc: 0.0214452 ustep: 1 
iter: 2  value: 1130.365 mgc: 7.527029e-07 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  0.8853589 
iter: 1  value: 1130.35 mgc: 0.02145438 ustep: 1 
iter: 2  value: 1130.35 mgc: 7.534446e-07 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.8891247 
iter: 1  value: 1130.352 mgc: 0.02895996 ustep: 1 
iter: 2  value: 1130.352 mgc: 3.487289e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
outer mgc:  0.8788697 
iter: 1  value: 1130.364 mgc: 0.02894399 ustep: 1 
iter: 2  value: 1130.364 mgc: 3.488516e-06 ustep: 1 
iter: 3  mgc: 8.193446e-14 
outer mgc:  0.8760386 
iter: 1  value: 1130.354 mgc: 0.008460659 ustep: 1 
iter: 2  value: 1130.354 mgc: 3.099404e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.4791828 
iter: 1  value: 1130.361 mgc: 0.008453594 ustep: 1 
iter: 2  value: 1130.361 mgc: 3.09416e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.4765952 
iter: 1  value: 1130.34 mgc: 0.005942522 ustep: 1 
iter: 2  value: 1130.34 mgc: 2.099002e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.01977181 
iter: 1  value: 1130.374 mgc: 0.005939545 ustep: 1 
iter: 2  value: 1130.374 mgc: 2.099804e-07 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  0.01863158 
iter: 1  value: 1130.374 mgc: 0.02796218 ustep: 1 
iter: 2  value: 1130.374 mgc: 4.269308e-06 ustep: 1 
iter: 3  mgc: 2.033929e-13 
outer mgc:  0.3188648 
iter: 1  value: 1130.341 mgc: 0.02803141 ustep: 1 
iter: 2  value: 1130.341 mgc: 4.281992e-06 ustep: 1 
iter: 3  mgc: 1.962874e-13 
outer mgc:  0.3203029 
iter: 1  value: 1130.396 mgc: 0.02469596 ustep: 1 
iter: 2  value: 1130.396 mgc: 4.037041e-06 ustep: 1 
iter: 3  mgc: 1.136868e-13 
outer mgc:  0.2578766 
iter: 1  value: 1130.318 mgc: 0.02476351 ustep: 1 
iter: 2  value: 1130.318 mgc: 4.045484e-06 ustep: 1 
iter: 3  mgc: 1.105782e-13 
outer mgc:  0.2580965 
[Mon Aug 16 08:32:26 2021]
Finished job 0.
1 of 1 steps (100%) done

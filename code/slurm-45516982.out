Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:03:27 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4321.940744 
final  value 4000.819037 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3946.822 mgc: 5.124505 ustep: 0.8994163 
iter: 2  value: 3935.895 mgc: 2.364346 ustep: 0.9483808 
iter: 3  value: 3924.705 mgc: 3.289831 ustep: 0.8382098 
iter: 4  value: 3924.365 mgc: 0.9828792 ustep: 0.9155464 
iter: 5  value: 3924.361 mgc: 0.1242329 ustep: 0.9568462 
iter: 6  value: 3924.361 mgc: 0.0007216694 ustep: 0.9781873 
iter: 7  value: 3924.361 mgc: 1.391684e-05 ustep: 0.9890346 
iter: 8  value: 3924.361 mgc: 1.475482e-07 ustep: 0.9945028 
iter: 9  mgc: 8.147765e-10 
iter: 1  mgc: 8.147765e-10 
Matching hessian patterns... Done
outer mgc:  24.45879 
iter: 1  value: 3888.102 mgc: 0.8438534 ustep: 1 
iter: 2  value: 3888.099 mgc: 0.07868715 ustep: 1 
iter: 3  value: 3888.099 mgc: 0.0006542085 ustep: 1 
iter: 4  value: 3888.099 mgc: 4.569434e-08 ustep: 1 
iter: 5  mgc: 2.88658e-15 
iter: 1  value: 3859.561 mgc: 3.699793 ustep: 1 
iter: 2  value: 3859.471 mgc: 0.8160608 ustep: 1 
iter: 3  value: 3859.471 mgc: 0.0258912 ustep: 1 
iter: 4  value: 3859.471 mgc: 2.775762e-05 ustep: 1 
iter: 5  mgc: 3.417e-11 
iter: 1  mgc: 3.417e-11 
outer mgc:  38.6456 
iter: 1  value: 3995.424 mgc: 13.29604 ustep: 1 
iter: 2  value: 3958.354 mgc: 11.71269 ustep: 1 
iter: 3  value: 3957.782 mgc: 1.593205 ustep: 1 
iter: 4  value: 3957.779 mgc: 0.1671045 ustep: 1 
iter: 5  value: 3957.779 mgc: 0.002021239 ustep: 1 
iter: 6  value: 3957.779 mgc: 3.615885e-07 ustep: 1 
iter: 7  mgc: 1.687539e-14 
iter: 1  value: 3846.244 mgc: 4.897719 ustep: 1 
iter: 2  value: 3845.079 mgc: 1.202214 ustep: 1 
iter: 3  value: 3845.077 mgc: 0.04102026 ustep: 1 
iter: 4  value: 3845.077 mgc: 7.530485e-05 ustep: 1 
iter: 5  mgc: 2.57953e-10 
iter: 1  mgc: 2.57953e-10 
outer mgc:  11.60132 
iter: 1  value: 3831.685 mgc: 2.983307 ustep: 1 
iter: 2  value: 3831.681 mgc: 0.1877628 ustep: 1 
iter: 3  value: 3831.681 mgc: 0.00105682 ustep: 1 
iter: 4  value: 3831.681 mgc: 3.389214e-08 ustep: 1 
mgc: 5.551115e-15 
iter: 1  mgc: 5.551115e-15 
outer mgc:  9.232735 
iter: 1  value: 3827.628 mgc: 4.958402 ustep: 1 
iter: 2  value: 3827.618 mgc: 0.2130363 ustep: 1 
iter: 3  value: 3827.618 mgc: 0.0005984132 ustep: 1 
iter: 4  mgc: 3.820429e-09 
iter: 1  value: 3826.764 mgc: 1.94348 ustep: 1 
iter: 2  value: 3826.762 mgc: 0.05672286 ustep: 1 
iter: 3  value: 3826.762 mgc: 7.942495e-05 ustep: 1 
iter: 4  mgc: 1.007392e-10 
iter: 1  mgc: 1.007392e-10 
outer mgc:  7.938284 
iter: 1  value: 3821.76 mgc: 2.609488 ustep: 1 
iter: 2  value: 3821.759 mgc: 0.02237018 ustep: 1 
iter: 3  value: 3821.759 mgc: 1.706514e-05 ustep: 1 
iter: 4  mgc: 2.596368e-12 
iter: 1  mgc: 2.596368e-12 
outer mgc:  10.47291 
iter: 1  value: 3810.426 mgc: 3.784113 ustep: 1 
iter: 2  value: 3810.425 mgc: 0.09374425 ustep: 1 
iter: 3  value: 3810.425 mgc: 5.221049e-05 ustep: 1 
iter: 4  mgc: 1.638245e-11 
iter: 1  mgc: 1.638245e-11 
outer mgc:  6.180929 
iter: 1  value: 3803.117 mgc: 4.23853 ustep: 1 
iter: 2  value: 3803.117 mgc: 0.03623191 ustep: 1 
iter: 3  value: 3803.117 mgc: 1.036232e-05 ustep: 1 
iter: 4  mgc: 9.006129e-13 
iter: 1  mgc: 9.006129e-13 
outer mgc:  4.35661 
iter: 1  value: 3794.435 mgc: 6.909911 ustep: 1 
iter: 2  value: 3794.435 mgc: 0.02090492 ustep: 1 
iter: 3  value: 3794.435 mgc: 8.030677e-06 ustep: 1 
iter: 4  mgc: 1.74083e-13 
iter: 1  mgc: 1.74083e-13 
outer mgc:  12.71356 
iter: 1  value: 3790.047 mgc: 4.645574 ustep: 1 
iter: 2  value: 3790.047 mgc: 0.02134097 ustep: 1 
iter: 3  value: 3790.047 mgc: 1.086224e-06 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  value: 3794.38 mgc: 1.759707 ustep: 1 
iter: 2  value: 3794.38 mgc: 0.005579214 ustep: 1 
iter: 3  value: 3794.38 mgc: 7.62799e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  16.28743 
iter: 1  value: 3792.776 mgc: 0.966695 ustep: 1 
iter: 2  value: 3792.776 mgc: 0.0004788636 ustep: 1 
iter: 3  mgc: 9.638755e-10 
iter: 1  mgc: 9.638755e-10 
outer mgc:  2.045059 
iter: 1  value: 3791.18 mgc: 0.8409648 ustep: 1 
iter: 2  value: 3791.18 mgc: 0.0008456735 ustep: 1 
iter: 3  mgc: 6.68873e-10 
iter: 1  mgc: 6.68873e-10 
outer mgc:  3.075998 
iter: 1  value: 3787.948 mgc: 1.570881 ustep: 1 
iter: 2  value: 3787.948 mgc: 0.002599352 ustep: 1 
iter: 3  mgc: 1.204385e-09 
iter: 1  mgc: 1.204385e-09 
outer mgc:  4.35257 
iter: 1  value: 3784.605 mgc: 1.912217 ustep: 1 
iter: 2  value: 3784.605 mgc: 0.001946825 ustep: 1 
iter: 3  mgc: 4.05191e-10 
iter: 1  value: 3786.862 mgc: 0.9484445 ustep: 1 
iter: 2  value: 3786.862 mgc: 0.0005592118 ustep: 1 
iter: 3  mgc: 1.890816e-10 
iter: 1  value: 3787.606 mgc: 0.380053 ustep: 1 
iter: 2  value: 3787.606 mgc: 9.563074e-05 ustep: 1 
iter: 3  mgc: 8.042012e-12 
iter: 1  mgc: 8.042012e-12 
outer mgc:  3.021186 
iter: 1  value: 3786.697 mgc: 0.2910203 ustep: 1 
iter: 2  value: 3786.697 mgc: 5.588238e-05 ustep: 1 
iter: 3  mgc: 1.332534e-11 
iter: 1  mgc: 1.332534e-11 
outer mgc:  1.210924 
iter: 1  value: 3784.745 mgc: 0.6608526 ustep: 1 
iter: 2  value: 3784.745 mgc: 0.000272152 ustep: 1 
iter: 3  mgc: 4.984813e-11 
iter: 1  mgc: 4.984813e-11 
outer mgc:  1.68727 
iter: 1  value: 3781.196 mgc: 1.52388 ustep: 1 
iter: 2  value: 3781.196 mgc: 0.001157359 ustep: 1 
iter: 3  mgc: 3.739853e-09 
iter: 1  value: 3777.553 mgc: 1.562537 ustep: 1 
iter: 2  value: 3777.553 mgc: 0.0008531979 ustep: 1 
iter: 3  mgc: 1.283447e-09 
iter: 1  mgc: 1.283447e-09 
outer mgc:  1.615679 
iter: 1  value: 3769.261 mgc: 3.517928 ustep: 1 
iter: 2  value: 3769.261 mgc: 0.001744101 ustep: 1 
iter: 3  mgc: 2.08093e-09 
iter: 1  mgc: 2.08093e-09 
outer mgc:  1.241837 
iter: 1  value: 3760.566 mgc: 5.567354 ustep: 1 
iter: 2  value: 3760.566 mgc: 0.001267453 ustep: 1 
iter: 3  mgc: 3.582423e-10 
iter: 1  mgc: 3.582423e-10 
outer mgc:  0.5331669 
iter: 1  value: 3751.619 mgc: 2.893342 ustep: 1 
iter: 2  value: 3751.619 mgc: 0.000230873 ustep: 1 
iter: 3  mgc: 1.726619e-12 
iter: 1  mgc: 1.726619e-12 
outer mgc:  0.5340356 
iter: 1  value: 3742.684 mgc: 3.376317 ustep: 1 
iter: 2  value: 3742.684 mgc: 9.864512e-05 ustep: 1 
iter: 3  mgc: 2.371436e-13 
iter: 1  mgc: 2.371436e-13 
outer mgc:  0.1983585 
iter: 1  value: 3728.8 mgc: 6.137508 ustep: 1 
iter: 2  value: 3728.8 mgc: 8.187533e-05 ustep: 1 
iter: 3  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.05222095 
iter: 1  value: 3716.293 mgc: 5.342499 ustep: 1 
iter: 2  value: 3716.293 mgc: 1.844826e-05 ustep: 1 
iter: 3  mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.02496529 
iter: 1  value: 3703.658 mgc: 5.462414 ustep: 1 
iter: 2  value: 3703.658 mgc: 5.817718e-06 ustep: 1 
mgc: 7.660539e-15 
iter: 1  mgc: 7.660539e-15 
outer mgc:  0.01260385 
iter: 1  value: 3690.885 mgc: 5.553312 ustep: 1 
iter: 2  value: 3690.885 mgc: 1.837457e-06 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.006505757 
iter: 1  value: 3677.95 mgc: 5.657953 ustep: 1 
iter: 2  value: 3677.95 mgc: 5.895396e-07 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.004302838 
iter: 1  value: 3664.829 mgc: 5.775767 ustep: 1 
iter: 2  value: 3664.829 mgc: 1.914103e-07 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.001996313 
iter: 1  value: 3651.502 mgc: 5.907462 ustep: 1 
iter: 2  value: 3651.502 mgc: 6.254173e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  0.0009186449 
iter: 1  value: 3637.963 mgc: 6.046 ustep: 1 
iter: 2  value: 3637.963 mgc: 2.039194e-08 ustep: 1 
mgc: 4.08007e-15 
iter: 1  mgc: 4.08007e-15 
outer mgc:  0.0004831251 
iter: 1  value: 3624.215 mgc: 6.183771 ustep: 1 
iter: 2  mgc: 6.583614e-09 
iter: 1  mgc: 6.583614e-09 
outer mgc:  0.0002777665 
iter: 1  value: 3610.274 mgc: 6.311929 ustep: 1 
iter: 2  mgc: 2.196535e-09 
iter: 1  mgc: 2.196535e-09 
outer mgc:  0.0001668686 
iter: 1  value: 3596.167 mgc: 6.423208 ustep: 1 
iter: 2  mgc: 7.150742e-10 
iter: 1  mgc: 7.150742e-10 
outer mgc:  8.972484e-05 
iter: 1  value: 3581.924 mgc: 6.512565 ustep: 1 
iter: 2  mgc: 2.247917e-10 
iter: 1  mgc: 2.247917e-10 
outer mgc:  4.933331e-05 
iter: 1  value: 3567.576 mgc: 6.577859 ustep: 1 
iter: 2  mgc: 6.851808e-11 
iter: 1  mgc: 6.851808e-11 
outer mgc:  2.481009e-05 
iter: 1  value: 3553.154 mgc: 6.61918 ustep: 1 
iter: 2  mgc: 2.033884e-11 
iter: 1  mgc: 2.033884e-11 
outer mgc:  1.39078e-05 
iter: 1  value: 3538.682 mgc: 6.638243 ustep: 1 
iter: 2  mgc: 5.900613e-12 
iter: 1  mgc: 5.900613e-12 
outer mgc:  7.014997e-06 
iter: 1  value: 3524.182 mgc: 6.637502 ustep: 1 
iter: 2  mgc: 1.679545e-12 
iter: 1  mgc: 1.679545e-12 
outer mgc:  4.038679e-06 
iter: 1  value: 3509.671 mgc: 6.61966 ustep: 1 
iter: 2  mgc: 4.685141e-13 
iter: 1  mgc: 4.685141e-13 
outer mgc:  1.944063e-06 
iter: 1  value: 3495.161 mgc: 6.587246 ustep: 1 
iter: 2  mgc: 1.336709e-13 
iter: 1  mgc: 1.336709e-13 
outer mgc:  1.387669e-06 
iter: 1  value: 3480.661 mgc: 6.542494 ustep: 1 
iter: 2  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  6.659215e-07 
iter: 1  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  6.659215e-07 
iter: 1  value: 3480.661 mgc: 0.005967906 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.09148923 
iter: 1  value: 3480.661 mgc: 0.005964526 ustep: 1 
mgc: 9.325873e-15 
outer mgc:  0.09140887 
iter: 1  value: 3480.661 mgc: 0.003342484 ustep: 1 
mgc: 6.661338e-15 
outer mgc:  0.05267571 
iter: 1  value: 3480.661 mgc: 0.003340925 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.0526356 
iter: 1  value: 3480.661 mgc: 0.006857134 ustep: 1 
mgc: 6.883383e-15 
outer mgc:  0.1257514 
iter: 1  value: 3480.661 mgc: 0.006856858 ustep: 1 
mgc: 1.065814e-14 
outer mgc:  0.1257519 
iter: 1  value: 3480.661 mgc: 0.003407309 ustep: 1 
mgc: 5.107026e-15 
outer mgc:  0.06301855 
iter: 1  value: 3480.661 mgc: 0.003407439 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.06300406 
iter: 1  value: 3480.681 mgc: 0.02471835 ustep: 1 
mgc: 6.515621e-15 
outer mgc:  6.65764e-07 
iter: 1  value: 3480.641 mgc: 0.02478702 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  6.660787e-07 
iter: 1  value: 3480.681 mgc: 0.02903517 ustep: 1 
mgc: 1.04361e-14 
outer mgc:  6.658595e-07 
iter: 1  value: 3480.641 mgc: 0.02910845 ustep: 1 
mgc: 9.103829e-15 
outer mgc:  6.659834e-07 
iter: 1  value: 3480.671 mgc: 0.003583355 ustep: 1 
mgc: 7.993606e-15 
outer mgc:  6.659201e-07 
iter: 1  value: 3480.651 mgc: 0.003584207 ustep: 1 
mgc: 1.065814e-14 
outer mgc:  6.659229e-07 
iter: 1  value: 3480.661 mgc: 0.004919159 ustep: 1 
mgc: 8.21565e-15 
outer mgc:  0.03098631 
iter: 1  value: 3480.661 mgc: 0.004916142 ustep: 1 
mgc: 5.995204e-15 
outer mgc:  0.03097845 
[Fri Aug 13 11:03:30 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:41:49 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21864.581769 
iter  10 value 11885.023478
final  value 11884.645984 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13250.23 mgc: 1.788335 ustep: 0.8994163 
iter: 2  value: 13182.52 mgc: 3.429288 ustep: 0.523213 
iter: 3  value: 13148.58 mgc: 1.330036 ustep: 0.473989 
iter: 4  value: 13120.88 mgc: 1.034735 ustep: 0.6884997 
iter: 5  value: 13098.4 mgc: 2.936613 ustep: 0.587359 
iter: 6  value: 13092.37 mgc: 0.8628015 ustep: 0.7664169 
iter: 7  value: 13090.2 mgc: 1.922531 ustep: 0.6470399 
iter: 8  value: 13089.78 mgc: 0.4736951 ustep: 0.5576858 
iter: 9  value: 13089.23 mgc: 0.3650043 ustep: 0.7468089 
iter: 10  value: 13089 mgc: 0.2561172 ustep: 0.8641947 
iter: 11  value: 13088.98 mgc: 0.1438843 ustep: 0.9296277 
iter: 12  value: 13088.98 mgc: 0.007131697 ustep: 0.9641756 
iter: 13  value: 13088.98 mgc: 0.004330301 ustep: 0.9819263 
iter: 14  value: 13088.98 mgc: 0.002383251 ustep: 0.9909228 
iter: 15  value: 13088.98 mgc: 0.001205678 ustep: 0.9954515 
iter: 16  value: 13088.98 mgc: 0.0005758996 ustep: 0.9977234 
iter: 17  value: 13088.98 mgc: 0.0002773084 ustep: 0.9988612 
iter: 18  value: 13088.98 mgc: 0.0001653367 ustep: 0.9994305 
iter: 19  value: 13088.98 mgc: 0.0003356158 ustep: 0.9830265 
iter: 20  value: 13088.98 mgc: 0.0001572943 ustep: 0.9914778 
iter: 21  value: 13088.98 mgc: 0.000362347 ustep: 0.9345627 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 22  value: 13088.98 mgc: 0.0003123326 ustep: 0.9667312 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 23  value: 13088.98 mgc: 0.0003871494 ustep: 0.9832266 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 24  value: 13088.98 mgc: 0.0007784791 ustep: 0.9081413 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 25  value: 13088.98 mgc: 0.0007344442 ustep: 0.9529692 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 26  value: 13088.98 mgc: 0.0009322946 ustep: 0.9762038 
Not improving much - will try early exit...PD hess?: FALSE 
Error in newton(par = c(u_large = 1, u_large = 1, u_large = 1, u_large = 1,  : 
  Newton drop out: Too many failed attempts.
iter: 1  value: 13250.23 mgc: 1.788335 ustep: 0.8994163 
iter: 2  value: 13182.52 mgc: 3.429288 ustep: 0.523213 
iter: 3  value: 13148.58 mgc: 1.330036 ustep: 0.473989 
iter: 4  value: 13120.88 mgc: 1.034735 ustep: 0.6884997 
iter: 5  value: 13098.4 mgc: 2.936613 ustep: 0.587359 
iter: 6  value: 13092.37 mgc: 0.8628015 ustep: 0.7664169 
iter: 7  value: 13090.2 mgc: 1.922531 ustep: 0.6470399 
iter: 8  value: 13089.78 mgc: 0.4736951 ustep: 0.5576858 
iter: 9  value: 13089.23 mgc: 0.3650043 ustep: 0.7468089 
iter: 10  value: 13089 mgc: 0.2561172 ustep: 0.8641947 
iter: 11  value: 13088.98 mgc: 0.1438843 ustep: 0.9296277 
iter: 12  value: 13088.98 mgc: 0.007131697 ustep: 0.9641756 
iter: 13  value: 13088.98 mgc: 0.004330301 ustep: 0.9819263 
iter: 14  value: 13088.98 mgc: 0.002383251 ustep: 0.9909228 
iter: 15  value: 13088.98 mgc: 0.001205678 ustep: 0.9954515 
iter: 16  value: 13088.98 mgc: 0.0005758996 ustep: 0.9977234 
iter: 17  value: 13088.98 mgc: 0.0002773084 ustep: 0.9988612 
iter: 18  value: 13088.98 mgc: 0.0001653367 ustep: 0.9994305 
iter: 19  value: 13088.98 mgc: 0.0003356158 ustep: 0.9830265 
iter: 20  value: 13088.98 mgc: 0.0001572943 ustep: 0.9914778 
iter: 21  value: 13088.98 mgc: 0.000362347 ustep: 0.9345627 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 22  value: 13088.98 mgc: 0.0003123326 ustep: 0.9667312 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 23  value: 13088.98 mgc: 0.0003871494 ustep: 0.9832266 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 24  value: 13088.98 mgc: 0.0007784791 ustep: 0.9081413 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 25  value: 13088.98 mgc: 0.0007344442 ustep: 0.9529692 
Not improving much - will try early exit...PD hess?: FALSE 
iter: 26  value: 13088.98 mgc: 0.0009322946 ustep: 0.9762038 
Not improving much - will try early exit...PD hess?: FALSE 
Error in newton(par = c(u_large = 1, u_large = 1, u_large = 1, u_large = 1,  : 
  Newton drop out: Too many failed attempts.
In addition: Warning message:
In nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) :
  NA/NaN function evaluation
outer mgc:  NaN 
Error in nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) : 
  gradient function must return a numeric vector of length 8
[Mon Aug 16 08:41:51 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 00:39:09 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_50_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_50_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_50_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10947.671457 
iter  10 value 7873.824478
final  value 7867.514949 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8420.522 mgc: 3.381682 ustep: 1 
iter: 2  value: 8417.196 mgc: 1.62528 ustep: 1 
iter: 3  value: 8417.041 mgc: 0.6467651 ustep: 1 
iter: 4  value: 8417.039 mgc: 0.07118221 ustep: 1 
iter: 5  value: 8417.039 mgc: 0.0002779231 ustep: 1 
iter: 6  mgc: 5.411511e-09 
iter: 1  mgc: 5.411511e-09 
Matching hessian patterns... Done
outer mgc:  74.47349 
iter: 1  value: 8358.886 mgc: 0.9500266 ustep: 1 
iter: 2  value: 8358.81 mgc: 0.1063187 ustep: 1 
iter: 3  value: 8358.81 mgc: 0.005484205 ustep: 1 
iter: 4  value: 8358.81 mgc: 1.341608e-05 ustep: 1 
iter: 5  mgc: 1.088888e-10 
iter: 1  mgc: 1.088888e-10 
outer mgc:  50.0731 
iter: 1  value: 8308.335 mgc: 1.672892 ustep: 1 
iter: 2  value: 8308.314 mgc: 0.1773222 ustep: 1 
iter: 3  value: 8308.314 mgc: 0.006239223 ustep: 1 
iter: 4  value: 8308.314 mgc: 8.905748e-06 ustep: 1 
iter: 5  mgc: 1.837516e-11 
iter: 1  mgc: 1.837516e-11 
outer mgc:  50.73208 
iter: 1  value: 8253.96 mgc: 2.023645 ustep: 1 
iter: 2  value: 8253.937 mgc: 0.1842111 ustep: 1 
iter: 3  value: 8253.937 mgc: 0.001192189 ustep: 1 
iter: 4  value: 8253.937 mgc: 3.794313e-08 ustep: 1 
iter: 5  mgc: 1.387779e-15 
iter: 1  mgc: 1.387779e-15 
outer mgc:  50.17194 
iter: 1  value: 8134.353 mgc: 1.729142 ustep: 1 
iter: 2  value: 8134.304 mgc: 0.09420708 ustep: 1 
iter: 3  value: 8134.304 mgc: 0.000742205 ustep: 1 
iter: 4  value: 8134.304 mgc: 1.309348e-07 ustep: 1 
iter: 5  mgc: 4.662937e-15 
iter: 1  value: 7943.252 mgc: 5.439458 ustep: 1 
iter: 2  value: 7940.872 mgc: 0.6026993 ustep: 1 
iter: 3  value: 7940.858 mgc: 0.07573388 ustep: 1 
iter: 4  value: 7940.858 mgc: 0.0009390473 ustep: 1 
iter: 5  value: 7940.858 mgc: 2.367604e-07 ustep: 1 
iter: 6  mgc: 1.332268e-14 
iter: 1  value: 11457.39 mgc: 261.734 ustep: 0.6827823 
iter: 2  value: 11246.31 mgc: 24.14842 ustep: 0.1286779 
iter: 3  value: 11144.23 mgc: 54.70268 ustep: 0.1992187 
iter: 4  value: 11134.3 mgc: 11.83507 ustep: 0.4463946 
iter: 5  value: 11134.2 mgc: 1.318911 ustep: 0.6681608 
iter: 6  value: 11134.2 mgc: 0.02980139 ustep: 0.8174293 
iter: 7  value: 11134.2 mgc: 0.0008727402 ustep: 0.9041276 
iter: 8  value: 11134.2 mgc: 2.436591e-05 ustep: 0.9508611 
iter: 9  value: 11134.2 mgc: 4.303471e-07 ustep: 0.9751236 
iter: 10  mgc: 3.785328e-09 
iter: 1  mgc: 1.332268e-14 
outer mgc:  44.85305 
iter: 1  value: 8563.636 mgc: 63.32204 ustep: 1 
iter: 2  value: 8563.62 mgc: 0.5006251 ustep: 1 
iter: 3  value: 8563.62 mgc: 0.0007055284 ustep: 1 
iter: 4  mgc: 1.770505e-09 
iter: 1  value: 7894.982 mgc: 4.130516 ustep: 1 
iter: 2  value: 7894.606 mgc: 0.4065025 ustep: 1 
iter: 3  value: 7894.606 mgc: 0.007381805 ustep: 1 
iter: 4  value: 7894.606 mgc: 4.868786e-06 ustep: 1 
iter: 5  mgc: 2.676137e-12 
iter: 1  mgc: 2.676137e-12 
outer mgc:  50.79892 
iter: 1  value: 7849.51 mgc: 4.245929 ustep: 1 
iter: 2  value: 7849.505 mgc: 0.123347 ustep: 1 
iter: 3  value: 7849.505 mgc: 0.0002107141 ustep: 1 
iter: 4  mgc: 2.076967e-09 
iter: 1  mgc: 2.076967e-09 
outer mgc:  48.61066 
iter: 1  value: 7812.322 mgc: 4.795627 ustep: 1 
iter: 2  value: 7812.308 mgc: 0.1435167 ustep: 1 
iter: 3  value: 7812.308 mgc: 0.0002200796 ustep: 1 
iter: 4  mgc: 2.162744e-09 
iter: 1  mgc: 2.162744e-09 
outer mgc:  61.76156 
iter: 1  value: 7764.429 mgc: 8.007733 ustep: 1 
iter: 2  value: 7764.428 mgc: 0.04692002 ustep: 1 
iter: 3  value: 7764.428 mgc: 0.0001696534 ustep: 1 
iter: 4  mgc: 1.826064e-09 
iter: 1  mgc: 1.826064e-09 
outer mgc:  53.79289 
iter: 1  value: 7723.603 mgc: 4.788123 ustep: 1 
iter: 2  value: 7723.603 mgc: 0.01360894 ustep: 1 
iter: 3  value: 7723.603 mgc: 2.72852e-06 ustep: 1 
iter: 4  mgc: 2.868816e-13 
iter: 1  mgc: 2.868816e-13 
outer mgc:  37.80522 
iter: 1  value: 7699.33 mgc: 5.896111 ustep: 1 
iter: 2  value: 7699.329 mgc: 0.01664053 ustep: 1 
iter: 3  value: 7699.329 mgc: 9.073303e-06 ustep: 1 
iter: 4  mgc: 2.193801e-12 
iter: 1  mgc: 2.193801e-12 
outer mgc:  19.2615 
iter: 1  value: 7683.125 mgc: 7.306825 ustep: 1 
iter: 2  value: 7683.124 mgc: 0.034959 ustep: 1 
iter: 3  value: 7683.124 mgc: 2.420036e-05 ustep: 1 
iter: 4  mgc: 1.468248e-11 
iter: 1  mgc: 1.468248e-11 
outer mgc:  106.1819 
iter: 1  value: 7671.851 mgc: 6.543001 ustep: 1 
iter: 2  value: 7671.85 mgc: 0.02125975 ustep: 1 
iter: 3  value: 7671.85 mgc: 5.014068e-06 ustep: 1 
iter: 4  mgc: 4.636291e-13 
iter: 1  mgc: 4.636291e-13 
outer mgc:  105.6207 
iter: 1  value: 7663.775 mgc: 8.829649 ustep: 1 
iter: 2  value: 7663.775 mgc: 0.06529649 ustep: 1 
iter: 3  value: 7663.775 mgc: 4.889016e-05 ustep: 1 
iter: 4  mgc: 4.915623e-11 
iter: 1  mgc: 4.915623e-11 
outer mgc:  11.18353 
iter: 1  value: 7667.842 mgc: 10.58354 ustep: 1 
iter: 2  value: 7667.839 mgc: 0.08975128 ustep: 1 
iter: 3  value: 7667.839 mgc: 0.0001967733 ustep: 1 
iter: 4  mgc: 9.886847e-10 
iter: 1  mgc: 9.886847e-10 
outer mgc:  13.11367 
iter: 1  value: 7670.554 mgc: 5.841962 ustep: 1 
iter: 2  value: 7670.554 mgc: 0.02671678 ustep: 1 
iter: 3  value: 7670.554 mgc: 1.891789e-06 ustep: 1 
iter: 4  mgc: 7.993606e-14 
iter: 1  value: 7669.98 mgc: 2.221496 ustep: 1 
iter: 2  value: 7669.98 mgc: 0.003213361 ustep: 1 
iter: 3  mgc: 6.502035e-09 
iter: 1  value: 7667.591 mgc: 0.5763614 ustep: 1 
iter: 2  value: 7667.591 mgc: 0.0001534976 ustep: 1 
iter: 3  mgc: 1.395151e-11 
iter: 1  mgc: 1.395151e-11 
outer mgc:  20.35849 
iter: 1  value: 7667.158 mgc: 0.6454581 ustep: 1 
iter: 2  value: 7667.158 mgc: 0.0004042552 ustep: 1 
iter: 3  mgc: 3.643551e-09 
iter: 1  mgc: 3.643551e-09 
outer mgc:  7.892356 
iter: 1  value: 7666.688 mgc: 0.6867258 ustep: 1 
iter: 2  value: 7666.688 mgc: 0.0003352898 ustep: 1 
iter: 3  mgc: 6.645222e-10 
iter: 1  mgc: 6.645222e-10 
outer mgc:  10.11652 
iter: 1  value: 7665.576 mgc: 0.8279563 ustep: 1 
iter: 2  value: 7665.576 mgc: 0.002017065 ustep: 1 
iter: 3  value: 7665.576 mgc: 7.279551e-08 ustep: 1 
iter: 4  mgc: 5.379031e-14 
iter: 1  value: 7664.222 mgc: 0.6239298 ustep: 1 
iter: 2  value: 7664.222 mgc: 0.003036388 ustep: 1 
iter: 3  value: 7664.222 mgc: 1.825806e-07 ustep: 1 
iter: 4  mgc: 4.42979e-14 
iter: 1  value: 7661.862 mgc: 1.434985 ustep: 1 
iter: 2  value: 7661.862 mgc: 0.01684373 ustep: 1 
iter: 3  value: 7661.862 mgc: 6.401927e-06 ustep: 1 
iter: 4  mgc: 9.467982e-13 
iter: 1  mgc: 9.467982e-13 
outer mgc:  11.6263 
iter: 1  value: 7684.593 mgc: 5.687304 ustep: 1 
iter: 2  value: 7684.569 mgc: 0.3705872 ustep: 1 
iter: 3  value: 7684.569 mgc: 0.005822948 ustep: 1 
iter: 4  value: 7684.569 mgc: 1.876467e-06 ustep: 1 
iter: 5  mgc: 2.025047e-13 
iter: 1  value: 7669.609 mgc: 2.973314 ustep: 1 
iter: 2  value: 7669.609 mgc: 0.04986977 ustep: 1 
iter: 3  value: 7669.609 mgc: 6.216855e-05 ustep: 1 
iter: 4  mgc: 1.210703e-10 
iter: 1  mgc: 1.210703e-10 
outer mgc:  3.684449 
iter: 1  value: 7675.107 mgc: 5.394391 ustep: 1 
iter: 2  value: 7675.106 mgc: 0.02875219 ustep: 1 
iter: 3  value: 7675.106 mgc: 1.645603e-05 ustep: 1 
iter: 4  mgc: 8.903989e-12 
iter: 1  value: 7670.64 mgc: 1.255709 ustep: 1 
iter: 2  value: 7670.64 mgc: 0.001462214 ustep: 1 
iter: 3  value: 7670.64 mgc: 6.663605e-08 ustep: 1 
iter: 4  mgc: 6.661338e-14 
iter: 1  mgc: 6.661338e-14 
outer mgc:  8.241007 
iter: 1  value: 7668.971 mgc: 1.238784 ustep: 1 
iter: 2  value: 7668.971 mgc: 0.002429403 ustep: 1 
iter: 3  value: 7668.971 mgc: 8.670312e-08 ustep: 1 
iter: 4  mgc: 5.634382e-14 
iter: 1  mgc: 5.634382e-14 
outer mgc:  3.789901 
iter: 1  value: 7667.357 mgc: 1.330885 ustep: 1 
iter: 2  value: 7667.357 mgc: 0.001696582 ustep: 1 
iter: 3  value: 7667.357 mgc: 2.429168e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  7.571102 
iter: 1  value: 7666.645 mgc: 0.5613579 ustep: 1 
iter: 2  value: 7666.645 mgc: 0.0003336194 ustep: 1 
iter: 3  mgc: 7.269056e-10 
iter: 1  value: 7665.31 mgc: 0.7682785 ustep: 1 
iter: 2  value: 7665.31 mgc: 0.0005526121 ustep: 1 
iter: 3  mgc: 1.719754e-09 
iter: 1  value: 7663.393 mgc: 1.552489 ustep: 1 
iter: 2  value: 7663.393 mgc: 0.001915496 ustep: 1 
iter: 3  value: 7663.393 mgc: 2.373041e-08 ustep: 1 
mgc: 6.084022e-14 
iter: 1  mgc: 6.084022e-14 
outer mgc:  4.207205 
iter: 1  value: 7667.081 mgc: 3.327887 ustep: 1 
iter: 2  value: 7667.08 mgc: 0.03298407 ustep: 1 
iter: 3  value: 7667.08 mgc: 2.892484e-05 ustep: 1 
iter: 4  mgc: 2.939693e-11 
iter: 1  value: 7664.875 mgc: 1.599504 ustep: 1 
iter: 2  value: 7664.875 mgc: 0.006564801 ustep: 1 
iter: 3  value: 7664.875 mgc: 1.067358e-06 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  1.150838 
iter: 1  value: 7662.87 mgc: 1.483915 ustep: 1 
iter: 2  value: 7662.87 mgc: 0.008236804 ustep: 1 
iter: 3  value: 7662.87 mgc: 8.271556e-07 ustep: 1 
iter: 4  mgc: 6.084022e-14 
iter: 1  value: 7664.026 mgc: 0.5870281 ustep: 1 
iter: 2  value: 7664.026 mgc: 0.001481149 ustep: 1 
iter: 3  value: 7664.026 mgc: 2.719889e-08 ustep: 1 
iter: 4  mgc: 6.616929e-14 
iter: 1  mgc: 6.616929e-14 
outer mgc:  1.146746 
iter: 1  value: 7663.886 mgc: 0.1838321 ustep: 1 
iter: 2  value: 7663.886 mgc: 0.00017533 ustep: 1 
iter: 3  mgc: 6.969758e-10 
iter: 1  mgc: 6.969758e-10 
outer mgc:  0.2114228 
iter: 1  value: 7663.417 mgc: 0.2376558 ustep: 1 
iter: 2  value: 7663.417 mgc: 5.650594e-05 ustep: 1 
iter: 3  mgc: 8.083312e-11 
iter: 1  mgc: 8.083312e-11 
outer mgc:  0.1403632 
iter: 1  value: 7663.22 mgc: 0.1058356 ustep: 1 
iter: 2  value: 7663.22 mgc: 5.371257e-06 ustep: 1 
iter: 3  mgc: 7.072121e-14 
iter: 1  mgc: 7.072121e-14 
outer mgc:  0.03728185 
iter: 1  value: 7663.08 mgc: 0.09275665 ustep: 1 
iter: 2  value: 7663.08 mgc: 4.43271e-06 ustep: 1 
iter: 3  mgc: 4.698325e-14 
iter: 1  mgc: 4.698325e-14 
outer mgc:  0.03960473 
iter: 1  value: 7662.944 mgc: 0.07755485 ustep: 1 
iter: 2  value: 7662.944 mgc: 3.15873e-06 ustep: 1 
iter: 3  mgc: 5.040413e-14 
iter: 1  mgc: 5.040413e-14 
outer mgc:  0.005120704 
iter: 1  value: 7662.943 mgc: 0.002229987 ustep: 1 
iter: 2  mgc: 3.75632e-09 
iter: 1  mgc: 3.75632e-09 
outer mgc:  0.0007401626 
iter: 1  mgc: 3.75632e-09 
iter: 1  mgc: 3.75632e-09 
outer mgc:  0.0007401626 
iter: 1  value: 7662.946 mgc: 0.02133254 ustep: 1 
iter: 2  value: 7662.946 mgc: 1.194951e-06 ustep: 1 
iter: 3  mgc: 8.437695e-14 
outer mgc:  0.5784651 
iter: 1  value: 7662.941 mgc: 0.02133393 ustep: 1 
iter: 2  value: 7662.941 mgc: 1.190827e-06 ustep: 1 
iter: 3  mgc: 8.082424e-14 
outer mgc:  0.5770272 
iter: 1  value: 7662.941 mgc: 0.01145089 ustep: 1 
iter: 2  value: 7662.941 mgc: 8.160661e-08 ustep: 1 
mgc: 6.483702e-14 
outer mgc:  0.4304433 
iter: 1  value: 7662.945 mgc: 0.01144913 ustep: 1 
iter: 2  value: 7662.945 mgc: 8.129524e-08 ustep: 1 
mgc: 4.987677e-14 
outer mgc:  0.4298975 
iter: 1  value: 7662.945 mgc: 0.01683851 ustep: 1 
iter: 2  value: 7662.945 mgc: 1.914905e-07 ustep: 1 
iter: 3  mgc: 5.018208e-14 
outer mgc:  0.5867866 
iter: 1  value: 7662.941 mgc: 0.0168316 ustep: 1 
iter: 2  value: 7662.941 mgc: 1.920631e-07 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  0.5880097 
iter: 1  value: 7662.945 mgc: 0.01144913 ustep: 1 
iter: 2  value: 7662.945 mgc: 8.077429e-08 ustep: 1 
mgc: 5.950795e-14 
outer mgc:  0.4303485 
iter: 1  value: 7662.941 mgc: 0.01145089 ustep: 1 
iter: 2  value: 7662.941 mgc: 8.108483e-08 ustep: 1 
mgc: 4.585221e-14 
outer mgc:  0.430845 
iter: 1  value: 7662.958 mgc: 0.05903996 ustep: 1 
iter: 2  value: 7662.958 mgc: 2.876033e-06 ustep: 1 
iter: 3  mgc: 7.904788e-14 
outer mgc:  0.1218299 
iter: 1  value: 7662.928 mgc: 0.05920732 ustep: 1 
iter: 2  value: 7662.928 mgc: 2.877299e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
outer mgc:  0.1210609 
iter: 1  value: 7662.984 mgc: 0.05676628 ustep: 1 
iter: 2  value: 7662.984 mgc: 2.166482e-06 ustep: 1 
iter: 3  mgc: 5.606626e-14 
outer mgc:  0.07735245 
iter: 1  value: 7662.902 mgc: 0.05693736 ustep: 1 
iter: 2  value: 7662.902 mgc: 2.166896e-06 ustep: 1 
iter: 3  mgc: 5.861978e-14 
outer mgc:  0.07789557 
iter: 1  value: 7662.932 mgc: 0.004894393 ustep: 1 
iter: 2  value: 7662.932 mgc: 1.308542e-08 ustep: 1 
mgc: 6.57252e-14 
outer mgc:  0.002176677 
iter: 1  value: 7662.954 mgc: 0.004892867 ustep: 1 
iter: 2  value: 7662.954 mgc: 1.309911e-08 ustep: 1 
mgc: 5.684342e-14 
outer mgc:  0.002826352 
iter: 1  value: 7662.931 mgc: 0.004840189 ustep: 1 
iter: 2  value: 7662.931 mgc: 6.251471e-08 ustep: 1 
iter: 3  mgc: 5.824508e-14 
outer mgc:  0.01578632 
iter: 1  value: 7662.955 mgc: 0.004839545 ustep: 1 
iter: 2  value: 7662.955 mgc: 6.253004e-08 ustep: 1 
iter: 3  mgc: 6.750156e-14 
outer mgc:  0.01619794 
[Sat Aug 14 00:39:12 2021]
Finished job 0.
1 of 1 steps (100%) done

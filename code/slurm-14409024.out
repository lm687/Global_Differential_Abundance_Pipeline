Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:33:04 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2224.689885 
iter  10 value 1803.636242
final  value 1803.507743 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1727.141 mgc: 49.51728 ustep: 1 
iter: 2  value: 1720.479 mgc: 9.615354 ustep: 1 
iter: 3  value: 1720.442 mgc: 0.6392206 ustep: 1 
iter: 4  value: 1720.442 mgc: 0.01831879 ustep: 1 
iter: 5  value: 1720.442 mgc: 1.85945e-05 ustep: 1 
iter: 6  mgc: 1.878164e-11 
iter: 1  mgc: 1.878164e-11 
Matching hessian patterns... Done
outer mgc:  389.7405 
iter: 1  value: 1348.819 mgc: 22.64241 ustep: 1 
iter: 2  value: 1348.811 mgc: 0.430936 ustep: 1 
iter: 3  value: 1348.811 mgc: 0.001415271 ustep: 1 
iter: 4  value: 1348.811 mgc: 1.091387e-07 ustep: 1 
iter: 5  mgc: 3.391731e-14 
iter: 1  value: 704.3002 mgc: 65.23674 ustep: 1 
iter: 2  value: 646.6733 mgc: 51.29662 ustep: 1 
iter: 3  value: 645.474 mgc: 8.701573 ustep: 1 
iter: 4  value: 645.4728 mgc: 0.2932869 ustep: 1 
iter: 5  value: 645.4728 mgc: 0.0002040163 ustep: 1 
iter: 6  mgc: 3.933197e-09 
iter: 1  mgc: 3.933197e-09 
outer mgc:  196.1379 
iter: 1  value: 299.4274 mgc: 65.96133 ustep: 1 
iter: 2  value: 297.3431 mgc: 5.014257 ustep: 1 
iter: 3  value: 297.3422 mgc: 0.1184153 ustep: 1 
iter: 4  value: 297.3422 mgc: 0.0002076815 ustep: 1 
iter: 5  mgc: 2.387794e-09 
iter: 1  mgc: 2.387794e-09 
outer mgc:  141.1975 
iter: 1  value: 4051.42 mgc: 549.0154 ustep: 1 
iter: 2  value: 3567.327 mgc: 147.39 ustep: 0.1336527 
iter: 3  value: 1791.078 mgc: 138.071 ustep: 0.1075309 
iter: 4  value: 950.9048 mgc: 163.5636 ustep: 0.09457213 
iter: 5  value: 845.1658 mgc: 109.5623 ustep: 0.1678745 
iter: 6  value: 695.6876 mgc: 95.63598 ustep: 0.4097839 
iter: 7  value: 680.1961 mgc: 34.39179 ustep: 0.6401797 
iter: 8  value: 679.7612 mgc: 6.602453 ustep: 0.8001323 
iter: 9  value: 679.7611 mgc: 0.1001594 ustep: 0.8945117 
iter: 10  value: 679.7611 mgc: 0.0002785277 ustep: 0.9457917 
iter: 11  value: 679.7611 mgc: 3.868456e-07 ustep: 0.972521 
mgc: 2.713161e-10 
iter: 1  value: 207.9382 mgc: 36.7745 ustep: 1 
iter: 2  value: 201.2409 mgc: 11.81548 ustep: 1 
iter: 3  value: 201.2341 mgc: 0.5448237 ustep: 1 
iter: 4  value: 201.2341 mgc: 0.00158757 ustep: 1 
iter: 5  value: 201.2341 mgc: 1.362022e-08 ustep: 1 
mgc: 2.170486e-14 
iter: 1  mgc: 2.170486e-14 
outer mgc:  37.30901 
iter: 1  value: 181.3377 mgc: 7.890903 ustep: 1 
iter: 2  value: 181.3329 mgc: 0.3106483 ustep: 1 
iter: 3  value: 181.3329 mgc: 0.0004672583 ustep: 1 
iter: 4  mgc: 1.111305e-09 
iter: 1  mgc: 1.111305e-09 
outer mgc:  35.53488 
iter: 1  value: 295.3396 mgc: 39.24352 ustep: 1 
iter: 2  value: 291.3025 mgc: 9.316964 ustep: 1 
iter: 3  value: 291.3005 mgc: 0.2715106 ustep: 1 
iter: 4  value: 291.3005 mgc: 0.0004370139 ustep: 1 
iter: 5  mgc: 1.092888e-09 
iter: 1  value: 176.1921 mgc: 5.926979 ustep: 1 
iter: 2  value: 176.1903 mgc: 0.1675401 ustep: 1 
iter: 3  value: 176.1903 mgc: 0.0002238662 ustep: 1 
iter: 4  mgc: 3.907122e-10 
iter: 1  mgc: 3.907122e-10 
outer mgc:  14.94493 
iter: 1  value: 170.3253 mgc: 2.621483 ustep: 1 
iter: 2  value: 170.3253 mgc: 0.02072249 ustep: 1 
iter: 3  value: 170.3253 mgc: 9.974358e-07 ustep: 1 
iter: 4  mgc: 9.57151e-14 
iter: 1  mgc: 9.57151e-14 
outer mgc:  10.47343 
iter: 1  value: 166.6031 mgc: 3.387041 ustep: 1 
iter: 2  value: 166.6029 mgc: 0.05673555 ustep: 1 
iter: 3  value: 166.6029 mgc: 1.010373e-05 ustep: 1 
iter: 4  mgc: 3.162803e-12 
iter: 1  mgc: 3.162803e-12 
outer mgc:  11.20465 
iter: 1  value: 165.2238 mgc: 10.57194 ustep: 1 
iter: 2  value: 165.2016 mgc: 0.6021045 ustep: 1 
iter: 3  value: 165.2016 mgc: 0.002775735 ustep: 1 
iter: 4  value: 165.2016 mgc: 6.02738e-08 ustep: 1 
mgc: 3.966272e-14 
iter: 1  mgc: 3.966272e-14 
outer mgc:  19.54931 
iter: 1  value: 161.8472 mgc: 10.65904 ustep: 1 
iter: 2  value: 161.8343 mgc: 0.4473687 ustep: 1 
iter: 3  value: 161.8343 mgc: 0.0007859774 ustep: 1 
iter: 4  mgc: 2.737277e-09 
iter: 1  mgc: 2.737277e-09 
outer mgc:  9.458846 
iter: 1  value: 159.2689 mgc: 17.0679 ustep: 1 
iter: 2  value: 159.1868 mgc: 1.068913 ustep: 1 
iter: 3  value: 159.1868 mgc: 0.007698273 ustep: 1 
iter: 4  value: 159.1868 mgc: 4.150162e-07 ustep: 1 
iter: 5  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  5.045157 
iter: 1  value: 157.0174 mgc: 8.155813 ustep: 1 
iter: 2  value: 157.0135 mgc: 0.2528252 ustep: 1 
iter: 3  value: 157.0135 mgc: 0.0001879722 ustep: 1 
iter: 4  mgc: 1.146359e-10 
iter: 1  mgc: 1.146359e-10 
outer mgc:  6.270274 
iter: 1  value: 155.9945 mgc: 13.30616 ustep: 1 
iter: 2  value: 155.9568 mgc: 0.8819236 ustep: 1 
iter: 3  value: 155.9568 mgc: 0.004310275 ustep: 1 
iter: 4  value: 155.9568 mgc: 1.060893e-07 ustep: 1 
mgc: 3.441691e-14 
iter: 1  mgc: 3.441691e-14 
outer mgc:  10.68369 
iter: 1  value: 155.1881 mgc: 6.37938 ustep: 1 
iter: 2  value: 155.1855 mgc: 0.1366381 ustep: 1 
iter: 3  value: 155.1855 mgc: 0.0004148577 ustep: 1 
iter: 4  mgc: 6.114089e-09 
iter: 1  mgc: 6.114089e-09 
outer mgc:  2.904668 
iter: 1  value: 157.1271 mgc: 2.248473 ustep: 1 
iter: 2  value: 157.127 mgc: 0.04094644 ustep: 1 
iter: 3  value: 157.127 mgc: 2.646674e-05 ustep: 1 
iter: 4  mgc: 2.362999e-11 
iter: 1  value: 154.9985 mgc: 1.380133 ustep: 1 
iter: 2  value: 154.9985 mgc: 0.002958014 ustep: 1 
iter: 3  value: 154.9985 mgc: 1.332679e-08 ustep: 1 
mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  2.69847 
iter: 1  value: 154.8473 mgc: 1.266519 ustep: 1 
iter: 2  value: 154.8473 mgc: 0.01038767 ustep: 1 
iter: 3  value: 154.8473 mgc: 1.435687e-06 ustep: 1 
iter: 4  mgc: 5.856426e-14 
iter: 1  mgc: 5.856426e-14 
outer mgc:  1.944115 
iter: 1  value: 154.8985 mgc: 1.677346 ustep: 1 
iter: 2  value: 154.8985 mgc: 0.008699593 ustep: 1 
iter: 3  value: 154.8985 mgc: 4.752178e-07 ustep: 1 
iter: 4  mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  1.841436 
iter: 1  value: 154.7362 mgc: 1.795359 ustep: 1 
iter: 2  value: 154.7362 mgc: 0.005538057 ustep: 1 
iter: 3  value: 154.7362 mgc: 6.695478e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  1.222828 
iter: 1  value: 154.8031 mgc: 0.4794458 ustep: 1 
iter: 2  value: 154.8031 mgc: 0.0007119119 ustep: 1 
iter: 3  mgc: 3.148476e-09 
iter: 1  mgc: 3.148476e-09 
outer mgc:  0.4042102 
iter: 1  value: 154.7886 mgc: 0.7652007 ustep: 1 
iter: 2  value: 154.7886 mgc: 0.002537002 ustep: 1 
iter: 3  value: 154.7886 mgc: 7.174462e-08 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  0.08966341 
iter: 1  value: 154.7987 mgc: 0.3621141 ustep: 1 
iter: 2  value: 154.7987 mgc: 0.0004342623 ustep: 1 
iter: 3  mgc: 1.068719e-09 
iter: 1  mgc: 1.068719e-09 
outer mgc:  0.1092814 
iter: 1  value: 154.7913 mgc: 0.1350799 ustep: 1 
iter: 2  value: 154.7913 mgc: 5.541518e-05 ustep: 1 
iter: 3  mgc: 1.738876e-11 
iter: 1  mgc: 1.738876e-11 
outer mgc:  0.08325435 
iter: 1  value: 154.7922 mgc: 0.03076548 ustep: 1 
iter: 2  value: 154.7922 mgc: 5.785734e-06 ustep: 1 
iter: 3  mgc: 5.989792e-13 
iter: 1  mgc: 5.989792e-13 
outer mgc:  0.02287096 
iter: 1  value: 154.7924 mgc: 0.0107382 ustep: 1 
iter: 2  value: 154.7924 mgc: 3.803116e-07 ustep: 1 
iter: 3  mgc: 2.663147e-14 
iter: 1  mgc: 2.663147e-14 
outer mgc:  0.00116875 
iter: 1  value: 154.7923 mgc: 0.0005762773 ustep: 1 
iter: 2  mgc: 1.073486e-09 
iter: 1  mgc: 1.073486e-09 
outer mgc:  9.099616e-05 
iter: 1  value: 154.7923 mgc: 3.134578e-05 ustep: 1 
iter: 2  mgc: 1.502047e-11 
iter: 1  mgc: 1.502047e-11 
outer mgc:  3.074364e-06 
iter: 1  mgc: 1.502047e-11 
iter: 1  mgc: 1.502047e-11 
outer mgc:  3.074364e-06 
iter: 1  value: 154.7924 mgc: 0.04720545 ustep: 1 
iter: 2  value: 154.7924 mgc: 4.17472e-06 ustep: 1 
iter: 3  mgc: 5.062617e-14 
outer mgc:  0.08746864 
iter: 1  value: 154.7923 mgc: 0.04719479 ustep: 1 
iter: 2  value: 154.7923 mgc: 4.180301e-06 ustep: 1 
iter: 3  mgc: 5.373479e-14 
outer mgc:  0.08746606 
iter: 1  value: 154.7927 mgc: 0.027983 ustep: 1 
iter: 2  value: 154.7927 mgc: 1.926924e-06 ustep: 1 
iter: 3  mgc: 5.639933e-14 
outer mgc:  0.1125808 
iter: 1  value: 154.792 mgc: 0.0279823 ustep: 1 
iter: 2  value: 154.792 mgc: 1.924471e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.1125887 
iter: 1  value: 154.7923 mgc: 0.05101602 ustep: 1 
iter: 2  value: 154.7923 mgc: 6.262044e-06 ustep: 1 
iter: 3  mgc: 2.309264e-13 
outer mgc:  0.05869684 
iter: 1  value: 154.7924 mgc: 0.05102091 ustep: 1 
iter: 2  value: 154.7924 mgc: 6.267601e-06 ustep: 1 
iter: 3  mgc: 2.49134e-13 
outer mgc:  0.05869888 
iter: 1  value: 154.7925 mgc: 0.0279144 ustep: 1 
iter: 2  value: 154.7925 mgc: 2.452821e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.1093907 
iter: 1  value: 154.7922 mgc: 0.02791285 ustep: 1 
iter: 2  value: 154.7922 mgc: 2.455117e-06 ustep: 1 
iter: 3  mgc: 6.328271e-14 
outer mgc:  0.1093934 
iter: 1  value: 154.7914 mgc: 0.003681374 ustep: 1 
iter: 2  value: 154.7914 mgc: 3.978577e-08 ustep: 1 
mgc: 2.242651e-14 
outer mgc:  0.002802649 
iter: 1  value: 154.7932 mgc: 0.003679575 ustep: 1 
iter: 2  value: 154.7932 mgc: 3.977735e-08 ustep: 1 
mgc: 4.943268e-14 
outer mgc:  0.002800421 
iter: 1  value: 154.7949 mgc: 0.02289271 ustep: 1 
iter: 2  value: 154.7949 mgc: 1.938857e-06 ustep: 1 
iter: 3  mgc: 5.756506e-14 
outer mgc:  0.03832638 
iter: 1  value: 154.7897 mgc: 0.02295402 ustep: 1 
iter: 2  value: 154.7897 mgc: 1.949267e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.03833654 
iter: 1  value: 154.7929 mgc: 0.01545389 ustep: 1 
iter: 2  value: 154.7929 mgc: 4.715139e-07 ustep: 1 
iter: 3  mgc: 2.470246e-14 
outer mgc:  0.04715557 
iter: 1  value: 154.7918 mgc: 0.01546935 ustep: 1 
iter: 2  value: 154.7918 mgc: 4.733001e-07 ustep: 1 
iter: 3  mgc: 2.531308e-14 
outer mgc:  0.0472624 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:33:06 2021]
Finished job 0.
1 of 1 steps (100%) done

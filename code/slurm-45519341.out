Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:33:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4357.096337 
final  value 3269.922950 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 683.3478 mgc: 119.9307 ustep: 1 
iter: 2  value: 597.9262 mgc: 18.32618 ustep: 1 
iter: 3  value: 592.464 mgc: 9.935071 ustep: 1 
iter: 4  value: 592.3972 mgc: 0.9174013 ustep: 1 
iter: 5  value: 592.3969 mgc: 0.03536173 ustep: 1 
iter: 6  value: 592.3969 mgc: 0.000238034 ustep: 1 
iter: 7  value: 592.3969 mgc: 1.097042e-08 ustep: 1 
mgc: 3.053113e-14 
iter: 1  mgc: 3.053113e-14 
Matching hessian patterns... Done
outer mgc:  231.035 
iter: 1  value: 473.8374 mgc: 31.2772 ustep: 1 
iter: 2  value: 470.6699 mgc: 5.022774 ustep: 1 
iter: 3  value: 470.668 mgc: 0.124535 ustep: 1 
iter: 4  value: 470.668 mgc: 0.0002619436 ustep: 1 
iter: 5  mgc: 1.81211e-09 
iter: 1  mgc: 1.81211e-09 
outer mgc:  58.51892 
iter: 1  value: 434.4565 mgc: 10.39284 ustep: 1 
iter: 2  value: 434.297 mgc: 0.9959273 ustep: 1 
iter: 3  value: 434.297 mgc: 0.007208226 ustep: 1 
iter: 4  value: 434.297 mgc: 1.820678e-06 ustep: 1 
iter: 5  mgc: 8.189456e-14 
iter: 1  mgc: 8.189456e-14 
outer mgc:  35.94794 
iter: 1  value: 460.6461 mgc: 35.3938 ustep: 1 
iter: 2  value: 454.8847 mgc: 5.334488 ustep: 1 
iter: 3  value: 454.8729 mgc: 0.2867869 ustep: 1 
iter: 4  value: 454.8729 mgc: 0.003968586 ustep: 1 
iter: 5  value: 454.8729 mgc: 7.817922e-07 ustep: 1 
iter: 6  mgc: 4.327094e-14 
iter: 1  value: 431.9371 mgc: 12.34 ustep: 1 
iter: 2  value: 431.9059 mgc: 0.4158117 ustep: 1 
iter: 3  value: 431.9059 mgc: 0.001350877 ustep: 1 
iter: 4  value: 431.9059 mgc: 5.543677e-08 ustep: 1 
iter: 5  mgc: 3.180789e-14 
iter: 1  mgc: 3.180789e-14 
outer mgc:  25.75133 
iter: 1  value: 425.8254 mgc: 3.148012 ustep: 1 
iter: 2  value: 425.8234 mgc: 0.1111917 ustep: 1 
iter: 3  value: 425.8234 mgc: 0.000994256 ustep: 1 
iter: 4  value: 425.8234 mgc: 8.093e-08 ustep: 1 
iter: 5  mgc: 2.942091e-14 
iter: 1  mgc: 2.942091e-14 
outer mgc:  7.534186 
iter: 1  value: 424.416 mgc: 13.52887 ustep: 1 
iter: 2  value: 424.3354 mgc: 0.6875629 ustep: 1 
iter: 3  value: 424.3354 mgc: 0.004406631 ustep: 1 
iter: 4  value: 424.3354 mgc: 2.500771e-07 ustep: 1 
iter: 5  mgc: 2.831069e-14 
iter: 1  mgc: 2.831069e-14 
outer mgc:  23.44411 
iter: 1  value: 418.1206 mgc: 22.3581 ustep: 1 
iter: 2  value: 416.8065 mgc: 2.76654 ustep: 1 
iter: 3  value: 416.8061 mgc: 0.08345626 ustep: 1 
iter: 4  value: 416.8061 mgc: 9.671159e-05 ustep: 1 
iter: 5  mgc: 1.92234e-10 
iter: 1  value: 499.244 mgc: 58.33076 ustep: 1 
iter: 2  value: 410.164 mgc: 25.55393 ustep: 1 
iter: 3  value: 409.7429 mgc: 2.334839 ustep: 1 
iter: 4  value: 409.7428 mgc: 0.05375576 ustep: 1 
iter: 5  value: 409.7428 mgc: 3.831349e-05 ustep: 1 
iter: 6  mgc: 1.937617e-11 
iter: 1  mgc: 1.937617e-11 
outer mgc:  46.02286 
iter: 1  value: 459.1433 mgc: 170.5952 ustep: 1 
iter: 2  value: 443.5678 mgc: 15.28708 ustep: 1 
iter: 3  value: 443.4652 mgc: 0.7277702 ustep: 1 
iter: 4  value: 443.4651 mgc: 0.008959981 ustep: 1 
iter: 5  value: 443.4651 mgc: 2.282851e-06 ustep: 1 
iter: 6  mgc: 1.469797e-13 
iter: 1  value: 404.7472 mgc: 22.51991 ustep: 1 
iter: 2  value: 404.5551 mgc: 0.9385569 ustep: 1 
iter: 3  value: 404.5551 mgc: 0.01184915 ustep: 1 
iter: 4  value: 404.5551 mgc: 1.99766e-06 ustep: 1 
iter: 5  mgc: 7.038814e-14 
iter: 1  mgc: 7.038814e-14 
outer mgc:  30.4328 
iter: 1  value: 400.1921 mgc: 9.011371 ustep: 1 
iter: 2  value: 400.1871 mgc: 0.2165069 ustep: 1 
iter: 3  value: 400.1871 mgc: 0.0008341066 ustep: 1 
iter: 4  value: 400.1871 mgc: 5.395317e-08 ustep: 1 
iter: 5  mgc: 2.031708e-14 
iter: 1  mgc: 2.031708e-14 
outer mgc:  11.9143 
iter: 1  value: 398.5878 mgc: 16.34699 ustep: 1 
iter: 2  value: 398.4376 mgc: 0.8158239 ustep: 1 
iter: 3  value: 398.4376 mgc: 0.007833332 ustep: 1 
iter: 4  value: 398.4376 mgc: 9.030795e-07 ustep: 1 
iter: 5  mgc: 4.094641e-14 
iter: 1  mgc: 4.094641e-14 
outer mgc:  20.31726 
iter: 1  value: 395.2065 mgc: 9.807576 ustep: 1 
iter: 2  value: 395.1691 mgc: 0.3795474 ustep: 1 
iter: 3  value: 395.1691 mgc: 0.00124402 ustep: 1 
iter: 4  value: 395.1691 mgc: 1.468647e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  6.552836 
iter: 1  value: 396.7678 mgc: 15.43899 ustep: 1 
iter: 2  value: 396.6738 mgc: 0.6705383 ustep: 1 
iter: 3  value: 396.6738 mgc: 0.004988691 ustep: 1 
iter: 4  value: 396.6738 mgc: 3.189084e-07 ustep: 1 
iter: 5  mgc: 2.242651e-14 
iter: 1  value: 395.2842 mgc: 6.339794 ustep: 1 
iter: 2  value: 395.2822 mgc: 0.09843246 ustep: 1 
iter: 3  value: 395.2822 mgc: 0.000114822 ustep: 1 
iter: 4  mgc: 1.730718e-10 
iter: 1  value: 394.8809 mgc: 2.31435 ustep: 1 
iter: 2  value: 394.8808 mgc: 0.01402753 ustep: 1 
iter: 3  value: 394.8808 mgc: 2.225346e-06 ustep: 1 
iter: 4  mgc: 7.01661e-14 
iter: 1  mgc: 7.01661e-14 
outer mgc:  3.202773 
iter: 1  value: 394.7532 mgc: 0.8462557 ustep: 1 
iter: 2  value: 394.7532 mgc: 0.0017336 ustep: 1 
iter: 3  value: 394.7532 mgc: 2.510593e-08 ustep: 1 
mgc: 4.019007e-14 
iter: 1  mgc: 4.019007e-14 
outer mgc:  3.111567 
iter: 1  value: 394.3762 mgc: 2.755111 ustep: 1 
iter: 2  value: 394.3761 mgc: 0.02639579 ustep: 1 
iter: 3  value: 394.3761 mgc: 7.386897e-06 ustep: 1 
iter: 4  mgc: 7.150947e-13 
iter: 1  mgc: 7.150947e-13 
outer mgc:  4.223331 
iter: 1  value: 393.9019 mgc: 1.650451 ustep: 1 
iter: 2  value: 393.9018 mgc: 0.01698282 ustep: 1 
iter: 3  value: 393.9018 mgc: 3.661917e-06 ustep: 1 
iter: 4  mgc: 2.566836e-13 
iter: 1  mgc: 2.566836e-13 
outer mgc:  2.43493 
iter: 1  value: 393.6264 mgc: 0.7828726 ustep: 1 
iter: 2  value: 393.6264 mgc: 0.003756728 ustep: 1 
iter: 3  value: 393.6264 mgc: 7.261762e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  2.532064 
iter: 1  value: 393.1861 mgc: 4.972023 ustep: 1 
iter: 2  value: 393.1845 mgc: 0.09287495 ustep: 1 
iter: 3  value: 393.1845 mgc: 7.465659e-05 ustep: 1 
iter: 4  mgc: 8.116113e-11 
iter: 1  mgc: 8.116113e-11 
outer mgc:  3.703381 
iter: 1  value: 393.4753 mgc: 0.9961289 ustep: 1 
iter: 2  value: 393.4753 mgc: 0.009434884 ustep: 1 
iter: 3  value: 393.4753 mgc: 2.034587e-06 ustep: 1 
iter: 4  mgc: 1.030287e-13 
iter: 1  mgc: 1.030287e-13 
outer mgc:  1.542452 
iter: 1  value: 393.2342 mgc: 4.415879 ustep: 1 
iter: 2  value: 393.2325 mgc: 0.08172934 ustep: 1 
iter: 3  value: 393.2325 mgc: 7.718621e-05 ustep: 1 
iter: 4  mgc: 1.046812e-10 
iter: 1  value: 393.4119 mgc: 2.796592 ustep: 1 
iter: 2  value: 393.4116 mgc: 0.03110796 ustep: 1 
iter: 3  value: 393.4116 mgc: 1.168471e-05 ustep: 1 
iter: 4  mgc: 2.31748e-12 
iter: 1  value: 393.4091 mgc: 1.346145 ustep: 1 
iter: 2  value: 393.4091 mgc: 0.007037523 ustep: 1 
iter: 3  value: 393.4091 mgc: 6.014922e-07 ustep: 1 
iter: 4  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  2.046928 
iter: 1  value: 393.311 mgc: 0.6906108 ustep: 1 
iter: 2  value: 393.311 mgc: 0.001438059 ustep: 1 
iter: 3  value: 393.311 mgc: 1.199061e-08 ustep: 1 
mgc: 4.318768e-14 
iter: 1  mgc: 4.318768e-14 
outer mgc:  0.6632331 
iter: 1  value: 393.2821 mgc: 0.591002 ustep: 1 
iter: 2  value: 393.2821 mgc: 0.003200213 ustep: 1 
iter: 3  value: 393.2821 mgc: 1.571722e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.5353553 
iter: 1  value: 393.1895 mgc: 1.202672 ustep: 1 
iter: 2  value: 393.1895 mgc: 0.007221724 ustep: 1 
iter: 3  value: 393.1895 mgc: 3.324412e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  value: 393.2434 mgc: 0.522286 ustep: 1 
iter: 2  value: 393.2434 mgc: 0.001045722 ustep: 1 
iter: 3  value: 393.2434 mgc: 1.127693e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.5577903 
iter: 1  value: 393.24 mgc: 0.09778413 ustep: 1 
iter: 2  value: 393.24 mgc: 0.0001840415 ustep: 1 
iter: 3  mgc: 1.515854e-09 
iter: 1  mgc: 1.515854e-09 
outer mgc:  0.1675721 
iter: 1  value: 393.2287 mgc: 0.03782767 ustep: 1 
iter: 2  value: 393.2287 mgc: 6.865776e-05 ustep: 1 
iter: 3  mgc: 2.009628e-10 
iter: 1  mgc: 2.009628e-10 
outer mgc:  0.1576679 
iter: 1  value: 393.2339 mgc: 0.03592828 ustep: 1 
iter: 2  value: 393.2339 mgc: 1.192635e-05 ustep: 1 
iter: 3  mgc: 3.352874e-12 
iter: 1  mgc: 3.352874e-12 
outer mgc:  0.04864512 
iter: 1  value: 393.2332 mgc: 0.01935909 ustep: 1 
iter: 2  value: 393.2332 mgc: 1.820557e-06 ustep: 1 
iter: 3  mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  0.006853461 
iter: 1  value: 393.233 mgc: 0.003831296 ustep: 1 
iter: 2  value: 393.233 mgc: 3.418098e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.002949254 
iter: 1  value: 393.233 mgc: 0.0008700418 ustep: 1 
iter: 2  mgc: 1.716918e-09 
iter: 1  mgc: 1.716918e-09 
outer mgc:  1.200147e-05 
iter: 1  mgc: 1.716918e-09 
iter: 1  mgc: 1.716918e-09 
outer mgc:  1.200147e-05 
iter: 1  value: 393.2347 mgc: 0.05100769 ustep: 1 
iter: 2  value: 393.2347 mgc: 6.525385e-06 ustep: 1 
iter: 3  mgc: 3.148592e-13 
outer mgc:  0.1190345 
iter: 1  value: 393.2315 mgc: 0.05101344 ustep: 1 
iter: 2  value: 393.2315 mgc: 6.518841e-06 ustep: 1 
iter: 3  mgc: 3.293477e-13 
outer mgc:  0.1190527 
iter: 1  value: 393.2345 mgc: 0.02690346 ustep: 1 
iter: 2  value: 393.2345 mgc: 1.400472e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.2183221 
iter: 1  value: 393.2318 mgc: 0.02691108 ustep: 1 
iter: 2  value: 393.2318 mgc: 1.400562e-06 ustep: 1 
iter: 3  mgc: 3.733125e-14 
outer mgc:  0.218339 
iter: 1  value: 393.2324 mgc: 0.04549795 ustep: 1 
iter: 2  value: 393.2324 mgc: 8.277467e-06 ustep: 1 
iter: 3  mgc: 7.256799e-13 
outer mgc:  0.03769789 
iter: 1  value: 393.2337 mgc: 0.04548186 ustep: 1 
iter: 2  value: 393.2337 mgc: 8.284586e-06 ustep: 1 
iter: 3  mgc: 7.331531e-13 
outer mgc:  0.03768127 
iter: 1  value: 393.2325 mgc: 0.02252938 ustep: 1 
iter: 2  value: 393.2325 mgc: 1.986474e-06 ustep: 1 
iter: 3  mgc: 3.375078e-14 
outer mgc:  0.1148973 
iter: 1  value: 393.2337 mgc: 0.02251858 ustep: 1 
iter: 2  value: 393.2337 mgc: 1.986279e-06 ustep: 1 
iter: 3  mgc: 3.774758e-14 
outer mgc:  0.1148755 
iter: 1  value: 393.2314 mgc: 0.005277499 ustep: 1 
iter: 2  value: 393.2314 mgc: 2.095505e-07 ustep: 1 
iter: 3  mgc: 4.196643e-14 
outer mgc:  0.0123798 
iter: 1  value: 393.2347 mgc: 0.005272774 ustep: 1 
iter: 2  value: 393.2347 mgc: 2.092498e-07 ustep: 1 
iter: 3  mgc: 3.130829e-14 
outer mgc:  0.01238678 
iter: 1  value: 393.2369 mgc: 0.01204645 ustep: 1 
iter: 2  value: 393.2369 mgc: 1.447999e-06 ustep: 1 
iter: 3  mgc: 7.283063e-14 
outer mgc:  0.03227667 
iter: 1  value: 393.2292 mgc: 0.01207296 ustep: 1 
iter: 2  value: 393.2292 mgc: 1.451621e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.03229019 
iter: 1  value: 393.2351 mgc: 0.007044171 ustep: 1 
iter: 2  value: 393.2351 mgc: 2.865203e-06 ustep: 1 
iter: 3  mgc: 4.72955e-13 
outer mgc:  0.03672492 
iter: 1  value: 393.231 mgc: 0.007059478 ustep: 1 
iter: 2  value: 393.231 mgc: 2.872503e-06 ustep: 1 
iter: 3  mgc: 4.747314e-13 
outer mgc:  0.03677623 
[Fri Aug 13 11:33:05 2021]
Finished job 0.
1 of 1 steps (100%) done

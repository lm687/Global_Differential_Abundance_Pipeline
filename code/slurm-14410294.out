Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:10:13 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_80_3_0.6_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.6, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.6_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21982.133284 
iter  10 value 16926.285132
iter  10 value 16926.285124
final  value 16926.285124 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 7984.611 mgc: 125.0996 ustep: 1 
iter: 2  value: 7933.3 mgc: 80.93265 ustep: 0.4367355 
iter: 3  value: 7278.669 mgc: 117.8734 ustep: 0.1263996 
iter: 4  value: 6752.475 mgc: 83.70535 ustep: 0.1040152 
iter: 5  value: 6680.192 mgc: 82.73275 ustep: 0.3225816 
iter: 6  value: 6661.795 mgc: 37.52368 ustep: 0.5680059 
iter: 7  value: 6661.116 mgc: 7.994128 ustep: 0.7536863 
iter: 8  value: 6661.116 mgc: 0.119901 ustep: 0.8681642 
iter: 9  value: 6661.116 mgc: 0.0005898028 ustep: 0.9317601 
iter: 10  value: 6661.116 mgc: 4.337731e-06 ustep: 0.9652807 
iter: 11  value: 6661.116 mgc: 3.878049e-08 ustep: 0.9824888 
iter: 12  mgc: 3.153775e-10 
iter: 1  mgc: 3.153775e-10 
Matching hessian patterns... Done
outer mgc:  3101.059 
iter: 1  value: 3695.619 mgc: 32.62705 ustep: 1 
iter: 2  value: 3494.475 mgc: 17.28975 ustep: 1 
iter: 3  value: 3492.626 mgc: 2.050804 ustep: 1 
iter: 4  value: 3492.626 mgc: 0.0487529 ustep: 1 
iter: 5  value: 3492.626 mgc: 4.399338e-05 ustep: 1 
iter: 6  mgc: 4.719292e-11 
iter: 1  value: 1918.536 mgc: 44.99623 ustep: 1 
iter: 2  value: 1503.242 mgc: 25.45217 ustep: 1 
iter: 3  value: 1498.319 mgc: 3.91344 ustep: 1 
iter: 4  value: 1498.315 mgc: 0.1910068 ustep: 1 
iter: 5  value: 1498.315 mgc: 0.000539196 ustep: 1 
iter: 6  mgc: 4.345666e-09 
iter: 1  mgc: 4.345666e-09 
outer mgc:  237.5912 
iter: 1  value: 1248.742 mgc: 52.0039 ustep: 1 
iter: 2  value: 1244.339 mgc: 6.085524 ustep: 1 
iter: 3  value: 1244.334 mgc: 0.2738281 ustep: 1 
iter: 4  value: 1244.334 mgc: 0.001489674 ustep: 1 
iter: 5  value: 1244.334 mgc: 4.186508e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  205.4683 
iter: 1  value: 27771.5 mgc: 269.1645 ustep: 0.2494656 
iter: 2  value: 20696.24 mgc: 153.8572 ustep: 0.1588666 
iter: 3  value: 16690.65 mgc: 179.9802 ustep: 0.3986409 
iter: 4  value: 11248.37 mgc: 190.4816 ustep: 0.1172538 
iter: 5  value: 9990.522 mgc: 194.0023 ustep: 0.3424892 
iter: 6  value: 9904.907 mgc: 144.2173 ustep: 0.1974635 
iter: 7  value: 9723.012 mgc: 135.5508 ustep: 0.1366237 
iter: 8  value: 9556.947 mgc: 204.0849 ustep: 0.1089551 
iter: 9  value: 9488.827 mgc: 160.026 ustep: 0.1815385 
iter: 10  value: 9453.315 mgc: 125.6257 ustep: 0.4261307 
iter: 11  value: 9390.56 mgc: 92.05266 ustep: 0.6528216 
iter: 12  value: 9351.684 mgc: 71.59777 ustep: 0.807993 
iter: 13  value: 9349.28 mgc: 16.43951 ustep: 0.8988944 
iter: 14  value: 9349.279 mgc: 0.3435954 ustep: 0.9481056 
iter: 15  value: 9349.279 mgc: 9.089794e-05 ustep: 0.9737098 
iter: 16  value: 9349.279 mgc: 4.513367e-08 ustep: 0.9867687 
mgc: 2.604139e-11 
iter: 1  value: 1243.567 mgc: 17.16234 ustep: 1 
iter: 2  value: 1243.558 mgc: 0.2364109 ustep: 1 
iter: 3  value: 1243.558 mgc: 8.578436e-05 ustep: 1 
iter: 4  mgc: 1.574918e-11 
iter: 1  mgc: 1.574918e-11 
outer mgc:  310.6991 
iter: 1  value: 1206.889 mgc: 7.509482 ustep: 1 
iter: 2  value: 1206.887 mgc: 0.07688771 ustep: 1 
iter: 3  value: 1206.887 mgc: 1.111556e-05 ustep: 1 
iter: 4  mgc: 2.571277e-13 
iter: 1  mgc: 2.571277e-13 
outer mgc:  65.45334 
iter: 1  value: 1204 mgc: 4.58992 ustep: 1 
iter: 2  value: 1204 mgc: 0.01719658 ustep: 1 
iter: 3  value: 1204 mgc: 2.995272e-06 ustep: 1 
iter: 4  mgc: 2.060574e-13 
iter: 1  mgc: 2.060574e-13 
outer mgc:  68.26617 
iter: 1  value: 1206.787 mgc: 5.083915 ustep: 1 
iter: 2  value: 1206.786 mgc: 0.06992172 ustep: 1 
iter: 3  value: 1206.786 mgc: 2.643142e-05 ustep: 1 
iter: 4  mgc: 6.42153e-12 
iter: 1  mgc: 6.42153e-12 
outer mgc:  101.8162 
iter: 1  value: 1205.604 mgc: 6.98181 ustep: 1 
iter: 2  value: 1205.602 mgc: 0.1269525 ustep: 1 
iter: 3  value: 1205.602 mgc: 3.857766e-05 ustep: 1 
iter: 4  mgc: 4.22018e-12 
iter: 1  mgc: 4.22018e-12 
outer mgc:  61.43239 
iter: 1  value: 1202.651 mgc: 5.385875 ustep: 1 
iter: 2  value: 1202.65 mgc: 0.1548839 ustep: 1 
iter: 3  value: 1202.65 mgc: 0.0001312793 ustep: 1 
iter: 4  mgc: 9.260592e-11 
iter: 1  mgc: 9.260592e-11 
outer mgc:  45.81699 
iter: 1  value: 1203.275 mgc: 2.939804 ustep: 1 
iter: 2  value: 1203.275 mgc: 0.0537119 ustep: 1 
iter: 3  value: 1203.275 mgc: 1.803077e-05 ustep: 1 
iter: 4  mgc: 2.059686e-12 
iter: 1  mgc: 2.059686e-12 
outer mgc:  42.71462 
iter: 1  value: 1205.921 mgc: 2.635135 ustep: 1 
iter: 2  value: 1205.921 mgc: 0.02553703 ustep: 1 
iter: 3  value: 1205.921 mgc: 1.013819e-05 ustep: 1 
iter: 4  mgc: 4.39293e-12 
iter: 1  mgc: 4.39293e-12 
outer mgc:  58.8495 
iter: 1  value: 1205.678 mgc: 3.535698 ustep: 1 
iter: 2  value: 1205.678 mgc: 0.01659397 ustep: 1 
iter: 3  value: 1205.678 mgc: 1.086385e-06 ustep: 1 
iter: 4  mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  46.81678 
iter: 1  value: 1202.575 mgc: 3.454772 ustep: 1 
iter: 2  value: 1202.574 mgc: 0.02725109 ustep: 1 
iter: 3  value: 1202.574 mgc: 1.903413e-06 ustep: 1 
iter: 4  mgc: 4.374279e-14 
iter: 1  mgc: 4.374279e-14 
outer mgc:  15.93698 
iter: 1  value: 1202.614 mgc: 1.058005 ustep: 1 
iter: 2  value: 1202.614 mgc: 0.005458111 ustep: 1 
iter: 3  value: 1202.614 mgc: 2.237814e-07 ustep: 1 
iter: 4  mgc: 3.56104e-14 
iter: 1  mgc: 3.56104e-14 
outer mgc:  8.004944 
iter: 1  value: 1203.041 mgc: 2.158841 ustep: 1 
iter: 2  value: 1203.041 mgc: 0.007224802 ustep: 1 
iter: 3  value: 1203.041 mgc: 3.853791e-07 ustep: 1 
iter: 4  mgc: 4.307665e-14 
iter: 1  value: 1202.485 mgc: 0.7211955 ustep: 1 
iter: 2  value: 1202.485 mgc: 0.0007545257 ustep: 1 
iter: 3  mgc: 4.4081e-09 
iter: 1  mgc: 4.4081e-09 
outer mgc:  4.54258 
iter: 1  value: 1202.708 mgc: 0.5797528 ustep: 1 
iter: 2  value: 1202.708 mgc: 0.001994431 ustep: 1 
iter: 3  value: 1202.708 mgc: 2.787567e-08 ustep: 1 
mgc: 3.796963e-14 
iter: 1  value: 1202.529 mgc: 0.2593642 ustep: 1 
iter: 2  value: 1202.529 mgc: 0.0003988602 ustep: 1 
iter: 3  mgc: 1.104831e-09 
iter: 1  mgc: 1.104831e-09 
outer mgc:  3.765103 
iter: 1  value: 1202.67 mgc: 0.4615509 ustep: 1 
iter: 2  value: 1202.67 mgc: 0.0004599657 ustep: 1 
iter: 3  mgc: 5.579275e-10 
iter: 1  value: 1202.574 mgc: 0.2111401 ustep: 1 
iter: 2  value: 1202.574 mgc: 9.576388e-05 ustep: 1 
iter: 3  mgc: 2.421086e-11 
iter: 1  mgc: 2.421086e-11 
outer mgc:  3.000884 
iter: 1  value: 1202.552 mgc: 0.1548675 ustep: 1 
iter: 2  value: 1202.552 mgc: 5.738683e-05 ustep: 1 
iter: 3  mgc: 1.182349e-11 
iter: 1  mgc: 1.182349e-11 
outer mgc:  2.833915 
iter: 1  value: 1202.531 mgc: 0.2061763 ustep: 1 
iter: 2  value: 1202.531 mgc: 8.145307e-05 ustep: 1 
iter: 3  mgc: 2.45941e-11 
iter: 1  mgc: 2.45941e-11 
outer mgc:  2.722513 
iter: 1  value: 1202.26 mgc: 0.2457058 ustep: 1 
iter: 2  value: 1202.26 mgc: 0.0002030202 ustep: 1 
iter: 3  mgc: 1.427329e-10 
iter: 1  value: 1201.935 mgc: 0.1752622 ustep: 1 
iter: 2  value: 1201.935 mgc: 0.0001064437 ustep: 1 
iter: 3  mgc: 4.480549e-11 
iter: 1  value: 1201.137 mgc: 0.4520333 ustep: 1 
iter: 2  value: 1201.137 mgc: 0.0006914222 ustep: 1 
iter: 3  mgc: 1.857025e-09 
iter: 1  mgc: 1.857025e-09 
outer mgc:  6.729314 
iter: 1  value: 1199.546 mgc: 1.055826 ustep: 1 
iter: 2  value: 1199.546 mgc: 0.00999849 ustep: 1 
iter: 3  value: 1199.546 mgc: 3.984407e-07 ustep: 1 
iter: 4  mgc: 3.619327e-14 
iter: 1  value: 1200.395 mgc: 0.5886115 ustep: 1 
iter: 2  value: 1200.395 mgc: 0.002412011 ustep: 1 
iter: 3  value: 1200.395 mgc: 2.898866e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  5.608353 
iter: 1  value: 1201.226 mgc: 0.5827854 ustep: 1 
iter: 2  value: 1201.226 mgc: 0.001849468 ustep: 1 
iter: 3  value: 1201.226 mgc: 1.730517e-08 ustep: 1 
mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  8.716135 
iter: 1  value: 1200.698 mgc: 1.022709 ustep: 1 
iter: 2  value: 1200.698 mgc: 0.001612945 ustep: 1 
iter: 3  value: 1200.698 mgc: 1.638077e-08 ustep: 1 
mgc: 5.018208e-14 
iter: 1  mgc: 5.018208e-14 
outer mgc:  12.87276 
iter: 1  value: 1200.92 mgc: 1.317381 ustep: 1 
iter: 2  value: 1200.92 mgc: 0.004063971 ustep: 1 
iter: 3  value: 1200.92 mgc: 4.022483e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  12.7871 
iter: 1  value: 1200.611 mgc: 0.5679641 ustep: 1 
iter: 2  value: 1200.611 mgc: 0.0005126862 ustep: 1 
iter: 3  mgc: 7.814822e-10 
iter: 1  mgc: 7.814822e-10 
outer mgc:  3.444605 
iter: 1  value: 1200.316 mgc: 0.3113579 ustep: 1 
iter: 2  value: 1200.316 mgc: 0.0004879034 ustep: 1 
iter: 3  mgc: 1.553865e-09 
iter: 1  mgc: 1.553865e-09 
outer mgc:  1.000403 
iter: 1  value: 1200.17 mgc: 0.1496036 ustep: 1 
iter: 2  value: 1200.17 mgc: 5.117044e-05 ustep: 1 
iter: 3  mgc: 8.693934e-12 
iter: 1  mgc: 8.693934e-12 
outer mgc:  0.7316769 
iter: 1  value: 1200.107 mgc: 0.193654 ustep: 1 
iter: 2  value: 1200.107 mgc: 8.480634e-05 ustep: 1 
iter: 3  mgc: 1.736655e-11 
iter: 1  mgc: 1.736655e-11 
outer mgc:  1.719843 
iter: 1  value: 1200.042 mgc: 0.1618225 ustep: 1 
iter: 2  value: 1200.042 mgc: 8.41222e-05 ustep: 1 
iter: 3  mgc: 2.339062e-11 
iter: 1  mgc: 2.339062e-11 
outer mgc:  1.875151 
iter: 1  value: 1199.848 mgc: 0.1458743 ustep: 1 
iter: 2  value: 1199.848 mgc: 3.391871e-05 ustep: 1 
iter: 3  mgc: 4.592771e-12 
iter: 1  mgc: 4.592771e-12 
outer mgc:  0.8324995 
iter: 1  value: 1199.721 mgc: 0.06875199 ustep: 1 
iter: 2  value: 1199.721 mgc: 1.240626e-05 ustep: 1 
iter: 3  mgc: 7.01661e-13 
iter: 1  value: 1199.47 mgc: 0.1255482 ustep: 1 
iter: 2  value: 1199.47 mgc: 4.878985e-05 ustep: 1 
iter: 3  mgc: 7.68452e-12 
iter: 1  mgc: 7.68452e-12 
outer mgc:  1.308271 
iter: 1  value: 1199.254 mgc: 0.1228804 ustep: 1 
iter: 2  value: 1199.254 mgc: 9.28164e-05 ustep: 1 
iter: 3  mgc: 3.50511e-10 
iter: 1  mgc: 3.50511e-10 
outer mgc:  0.5992575 
iter: 1  value: 1199.135 mgc: 0.1254265 ustep: 1 
iter: 2  value: 1199.135 mgc: 3.793579e-05 ustep: 1 
iter: 3  mgc: 3.028422e-11 
iter: 1  mgc: 3.028422e-11 
outer mgc:  0.853318 
iter: 1  value: 1199.213 mgc: 0.05681468 ustep: 1 
iter: 2  value: 1199.213 mgc: 1.690593e-05 ustep: 1 
iter: 3  mgc: 1.738165e-12 
iter: 1  mgc: 1.738165e-12 
outer mgc:  0.4269991 
iter: 1  value: 1199.149 mgc: 0.08577734 ustep: 1 
iter: 2  value: 1199.149 mgc: 5.231795e-05 ustep: 1 
iter: 3  mgc: 1.525358e-11 
iter: 1  mgc: 1.525358e-11 
outer mgc:  0.3261872 
iter: 1  value: 1199.179 mgc: 0.0420548 ustep: 1 
iter: 2  value: 1199.179 mgc: 1.063386e-05 ustep: 1 
iter: 3  mgc: 6.243894e-13 
iter: 1  mgc: 6.243894e-13 
outer mgc:  0.1040801 
iter: 1  value: 1199.177 mgc: 0.01127566 ustep: 1 
iter: 2  value: 1199.177 mgc: 7.747327e-07 ustep: 1 
iter: 3  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  0.05328477 
iter: 1  value: 1199.179 mgc: 0.005585445 ustep: 1 
iter: 2  value: 1199.179 mgc: 1.282358e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  0.002573003 
iter: 1  value: 1199.179 mgc: 0.0004123314 ustep: 1 
iter: 2  mgc: 2.435447e-10 
iter: 1  mgc: 2.435447e-10 
outer mgc:  0.0006418987 
iter: 1  mgc: 2.435447e-10 
iter: 1  mgc: 2.435447e-10 
outer mgc:  0.0006418987 
iter: 1  value: 1199.175 mgc: 0.0380815 ustep: 1 
iter: 2  value: 1199.175 mgc: 3.781213e-06 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  1.091569 
iter: 1  value: 1199.183 mgc: 0.03806745 ustep: 1 
iter: 2  value: 1199.183 mgc: 3.782879e-06 ustep: 1 
iter: 3  mgc: 7.471801e-14 
outer mgc:  1.092349 
iter: 1  value: 1199.175 mgc: 0.01204105 ustep: 1 
iter: 2  value: 1199.175 mgc: 4.345163e-07 ustep: 1 
iter: 3  mgc: 4.746203e-14 
outer mgc:  0.6846093 
iter: 1  value: 1199.183 mgc: 0.0120319 ustep: 1 
iter: 2  value: 1199.183 mgc: 4.339372e-07 ustep: 1 
iter: 3  mgc: 5.689893e-14 
outer mgc:  0.6835639 
iter: 1  value: 1199.185 mgc: 0.04639219 ustep: 1 
iter: 2  value: 1199.185 mgc: 2.896055e-06 ustep: 1 
iter: 3  mgc: 7.283063e-14 
outer mgc:  1.019641 
iter: 1  value: 1199.174 mgc: 0.04639519 ustep: 1 
iter: 2  value: 1199.174 mgc: 2.89199e-06 ustep: 1 
iter: 3  mgc: 7.460699e-14 
outer mgc:  1.018627 
iter: 1  value: 1199.188 mgc: 0.02569922 ustep: 1 
iter: 2  value: 1199.188 mgc: 4.867503e-07 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  1.047273 
iter: 1  value: 1199.17 mgc: 0.02570817 ustep: 1 
iter: 2  value: 1199.17 mgc: 4.87091e-07 ustep: 1 
iter: 3  mgc: 4.096723e-14 
outer mgc:  1.048896 
iter: 1  value: 1199.164 mgc: 0.006223116 ustep: 1 
iter: 2  value: 1199.164 mgc: 1.61033e-07 ustep: 1 
mgc: 5.062617e-14 
outer mgc:  0.01457782 
iter: 1  value: 1199.194 mgc: 0.006220557 ustep: 1 
iter: 2  value: 1199.194 mgc: 1.611188e-07 ustep: 1 
mgc: 4.007905e-14 
outer mgc:  0.01586809 
iter: 1  value: 1199.214 mgc: 0.03876625 ustep: 1 
iter: 2  value: 1199.214 mgc: 7.873566e-06 ustep: 1 
iter: 3  mgc: 3.774758e-13 
outer mgc:  0.3830297 
iter: 1  value: 1199.143 mgc: 0.03887023 ustep: 1 
iter: 2  value: 1199.143 mgc: 7.887728e-06 ustep: 1 
iter: 3  mgc: 3.756995e-13 
outer mgc:  0.3843254 
iter: 1  value: 1199.195 mgc: 0.03175048 ustep: 1 
iter: 2  value: 1199.195 mgc: 3.223686e-06 ustep: 1 
iter: 3  mgc: 6.306067e-14 
outer mgc:  0.4460743 
iter: 1  value: 1199.163 mgc: 0.03183228 ustep: 1 
iter: 2  value: 1199.163 mgc: 3.225764e-06 ustep: 1 
iter: 3  mgc: 6.927792e-14 
outer mgc:  0.4453515 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:10:15 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:26:12 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4408.731114 
iter  10 value 2990.327422
final  value 2990.305317 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2917.699 mgc: 4.452522 ustep: 1 
iter: 2  value: 2879.332 mgc: 2.918214 ustep: 0.8994163 
iter: 3  value: 2870.616 mgc: 3.614957 ustep: 0.9483808 
iter: 4  value: 2869.524 mgc: 2.478022 ustep: 0.8382098 
iter: 5  value: 2867.919 mgc: 2.26832 ustep: 0.9155464 
iter: 6  value: 2867.803 mgc: 0.6399702 ustep: 0.9568462 
iter: 7  value: 2867.803 mgc: 0.02893094 ustep: 0.9781873 
iter: 8  value: 2867.803 mgc: 0.0002181515 ustep: 0.9890346 
iter: 9  value: 2867.803 mgc: 1.193982e-06 ustep: 0.9945028 
iter: 10  mgc: 8.459683e-09 
iter: 1  mgc: 8.459683e-09 
Matching hessian patterns... Done
outer mgc:  22.96482 
iter: 1  value: 2860.45 mgc: 1.169261 ustep: 1 
iter: 2  value: 2860.377 mgc: 0.1170461 ustep: 1 
iter: 3  value: 2860.377 mgc: 0.005221108 ustep: 1 
iter: 4  value: 2860.377 mgc: 8.962488e-06 ustep: 1 
iter: 5  mgc: 2.710943e-11 
iter: 1  mgc: 2.710943e-11 
outer mgc:  38.39805 
iter: 1  value: 2842.416 mgc: 0.9221116 ustep: 1 
iter: 2  value: 2842.369 mgc: 0.1531383 ustep: 1 
iter: 3  value: 2842.369 mgc: 0.002634803 ustep: 1 
iter: 4  value: 2842.369 mgc: 1.349755e-06 ustep: 1 
iter: 5  mgc: 9.667406e-13 
iter: 1  mgc: 9.667406e-13 
outer mgc:  20.54714 
iter: 1  value: 2815.643 mgc: 0.5628068 ustep: 1 
iter: 2  value: 2815.541 mgc: 0.1917524 ustep: 1 
iter: 3  value: 2815.541 mgc: 0.01757236 ustep: 1 
iter: 4  value: 2815.541 mgc: 0.0001799916 ustep: 1 
iter: 5  value: 2815.541 mgc: 1.938204e-08 ustep: 1 
iter: 6  mgc: 2.234324e-15 
iter: 1  value: 2782.754 mgc: 1.526486 ustep: 1 
iter: 2  value: 2778.437 mgc: 2.26917 ustep: 1 
iter: 3  value: 2778.327 mgc: 0.2655135 ustep: 1 
iter: 4  value: 2778.326 mgc: 0.01669569 ustep: 1 
iter: 5  value: 2778.326 mgc: 8.595247e-05 ustep: 1 
iter: 6  mgc: 2.615397e-09 
iter: 1  value: 2899.803 mgc: 191.0319 ustep: 1 
iter: 2  value: 2778.117 mgc: 14.73369 ustep: 1 
iter: 3  value: 2778.067 mgc: 13.36412 ustep: 0.989901 
iter: 4  value: 2768.314 mgc: 10.48008 ustep: 0.9949382 
iter: 5  value: 2768.145 mgc: 2.541289 ustep: 0.9974661 
iter: 6  value: 2768.144 mgc: 0.05888355 ustep: 0.9987324 
iter: 7  value: 2768.144 mgc: 0.0001207927 ustep: 0.9993661 
iter: 8  value: 2768.144 mgc: 1.800213e-08 ustep: 0.999683 
mgc: 1.183054e-12 
iter: 1  mgc: 2.615397e-09 
outer mgc:  19.64846 
iter: 1  value: 2738.371 mgc: 52.83089 ustep: 1 
iter: 2  value: 2736.89 mgc: 1.594221 ustep: 1 
iter: 3  value: 2736.883 mgc: 0.1962258 ustep: 1 
iter: 4  value: 2736.883 mgc: 0.001201128 ustep: 1 
iter: 5  value: 2736.883 mgc: 6.64674e-08 ustep: 1 
iter: 6  mgc: 3.663736e-15 
iter: 1  mgc: 3.663736e-15 
outer mgc:  21.43388 
iter: 1  value: 2719.657 mgc: 19.30174 ustep: 1 
iter: 2  value: 2719.645 mgc: 0.2097367 ustep: 1 
iter: 3  value: 2719.645 mgc: 0.001501809 ustep: 1 
iter: 4  value: 2719.645 mgc: 4.249371e-08 ustep: 1 
iter: 5  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  36.42337 
iter: 1  value: 2823.942 mgc: 149.9991 ustep: 1 
iter: 2  value: 2823.864 mgc: 1.268017 ustep: 1 
iter: 3  value: 2823.864 mgc: 0.002191962 ustep: 1 
iter: 4  mgc: 5.076943e-09 
iter: 1  value: 2697.937 mgc: 2.392842 ustep: 1 
iter: 2  value: 2697.936 mgc: 0.1032838 ustep: 1 
iter: 3  value: 2697.936 mgc: 9.155961e-05 ustep: 1 
iter: 4  mgc: 2.479936e-10 
iter: 1  mgc: 2.479936e-10 
outer mgc:  13.54268 
iter: 1  value: 2694.677 mgc: 7.765619 ustep: 1 
iter: 2  value: 2694.676 mgc: 0.1112481 ustep: 1 
iter: 3  value: 2694.676 mgc: 4.99619e-05 ustep: 1 
iter: 4  mgc: 4.629608e-11 
iter: 1  mgc: 4.629608e-11 
outer mgc:  21.13398 
iter: 1  value: 2693.591 mgc: 2.079686 ustep: 1 
iter: 2  value: 2693.59 mgc: 0.1204876 ustep: 1 
iter: 3  value: 2693.59 mgc: 4.183532e-05 ustep: 1 
iter: 4  mgc: 2.187317e-11 
iter: 1  mgc: 2.187317e-11 
outer mgc:  4.911763 
iter: 1  value: 2690.733 mgc: 9.705968 ustep: 1 
iter: 2  value: 2690.732 mgc: 0.1122402 ustep: 1 
iter: 3  value: 2690.732 mgc: 8.1595e-05 ustep: 1 
iter: 4  mgc: 3.322254e-10 
iter: 1  mgc: 3.322254e-10 
outer mgc:  5.763001 
iter: 1  value: 2692.831 mgc: 4.422079 ustep: 1 
iter: 2  value: 2692.83 mgc: 0.02403699 ustep: 1 
iter: 3  value: 2692.83 mgc: 4.721549e-05 ustep: 1 
iter: 4  mgc: 1.982783e-10 
iter: 1  value: 2691.472 mgc: 2.60656 ustep: 1 
iter: 2  value: 2691.472 mgc: 0.005299504 ustep: 1 
iter: 3  value: 2691.472 mgc: 2.782413e-06 ustep: 1 
iter: 4  mgc: 5.564438e-13 
iter: 1  value: 2690.47 mgc: 1.131883 ustep: 1 
iter: 2  value: 2690.47 mgc: 0.0008240834 ustep: 1 
iter: 3  value: 2690.47 mgc: 2.406058e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  6.644872 
iter: 1  value: 2690.851 mgc: 1.307044 ustep: 1 
iter: 2  value: 2690.851 mgc: 0.001559983 ustep: 1 
iter: 3  value: 2690.851 mgc: 7.051242e-08 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  mgc: 5.107026e-15 
outer mgc:  1.068075 
iter: 1  value: 2691.54 mgc: 1.262868 ustep: 1 
iter: 2  value: 2691.54 mgc: 0.003066487 ustep: 1 
iter: 3  value: 2691.54 mgc: 9.734576e-07 ustep: 1 
iter: 4  mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  1.801821 
iter: 1  value: 2693.121 mgc: 1.411349 ustep: 1 
iter: 2  value: 2693.121 mgc: 0.01090393 ustep: 1 
iter: 3  value: 2693.121 mgc: 1.457614e-05 ustep: 1 
iter: 4  mgc: 2.082912e-11 
iter: 1  mgc: 2.082912e-11 
outer mgc:  0.8585297 
iter: 1  value: 2693.23 mgc: 0.800948 ustep: 1 
iter: 2  value: 2693.23 mgc: 0.001185129 ustep: 1 
iter: 3  value: 2693.23 mgc: 4.160704e-08 ustep: 1 
iter: 4  mgc: 6.550316e-15 
iter: 1  value: 2693.234 mgc: 0.3323049 ustep: 1 
iter: 2  value: 2693.234 mgc: 0.0002190201 ustep: 1 
iter: 3  mgc: 1.099187e-09 
iter: 1  mgc: 1.099187e-09 
outer mgc:  0.3638037 
iter: 1  value: 2694.086 mgc: 0.3857234 ustep: 1 
iter: 2  value: 2694.086 mgc: 0.001529978 ustep: 1 
iter: 3  value: 2694.086 mgc: 2.298653e-07 ustep: 1 
iter: 4  mgc: 7.049916e-15 
iter: 1  mgc: 7.049916e-15 
outer mgc:  0.4968234 
iter: 1  value: 2695.052 mgc: 0.258035 ustep: 1 
iter: 2  value: 2695.052 mgc: 0.001981865 ustep: 1 
iter: 3  value: 2695.052 mgc: 5.23488e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.6621935 
iter: 1  value: 2695.425 mgc: 0.1985257 ustep: 1 
iter: 2  value: 2695.425 mgc: 0.0002223222 ustep: 1 
iter: 3  mgc: 2.007754e-09 
iter: 1  mgc: 2.007754e-09 
outer mgc:  0.1917682 
iter: 1  value: 2695.217 mgc: 0.3420894 ustep: 1 
iter: 2  value: 2695.217 mgc: 0.0003688228 ustep: 1 
iter: 3  value: 2695.217 mgc: 2.194296e-08 ustep: 1 
iter: 4  mgc: 5.995204e-15 
iter: 1  mgc: 5.995204e-15 
outer mgc:  0.1113412 
iter: 1  value: 2695.425 mgc: 0.1612218 ustep: 1 
iter: 2  value: 2695.425 mgc: 5.871886e-05 ustep: 1 
iter: 3  mgc: 4.601279e-10 
iter: 1  mgc: 4.601279e-10 
outer mgc:  0.04075506 
iter: 1  value: 2695.684 mgc: 0.1120477 ustep: 1 
iter: 2  value: 2695.684 mgc: 2.613971e-05 ustep: 1 
iter: 3  mgc: 8.378054e-11 
iter: 1  value: 2696.014 mgc: 0.1410348 ustep: 1 
iter: 2  value: 2696.014 mgc: 4.25151e-05 ustep: 1 
iter: 3  mgc: 2.179767e-10 
iter: 1  mgc: 2.179767e-10 
outer mgc:  0.07865622 
iter: 1  value: 2697.157 mgc: 0.443571 ustep: 1 
iter: 2  value: 2697.157 mgc: 0.0003030927 ustep: 1 
iter: 3  mgc: 3.66911e-09 
iter: 1  mgc: 3.66911e-09 
outer mgc:  0.1302696 
iter: 1  value: 2700.037 mgc: 1.050928 ustep: 1 
iter: 2  value: 2700.037 mgc: 0.004524073 ustep: 1 
iter: 3  value: 2700.037 mgc: 1.821578e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.2654453 
iter: 1  value: 2698.768 mgc: 0.5320026 ustep: 1 
iter: 2  value: 2698.768 mgc: 0.0006851113 ustep: 1 
iter: 3  mgc: 2.866232e-09 
iter: 1  mgc: 2.866232e-09 
outer mgc:  0.1148482 
iter: 1  value: 2699.009 mgc: 0.1575098 ustep: 1 
iter: 2  value: 2699.009 mgc: 0.0001145512 ustep: 1 
iter: 3  mgc: 1.497606e-10 
iter: 1  mgc: 1.497606e-10 
outer mgc:  0.04581808 
iter: 1  value: 2699.307 mgc: 0.1591303 ustep: 1 
iter: 2  value: 2699.307 mgc: 0.0001229986 ustep: 1 
iter: 3  mgc: 9.861845e-11 
iter: 1  mgc: 9.861845e-11 
outer mgc:  0.006104678 
iter: 1  value: 2699.268 mgc: 0.01886995 ustep: 1 
iter: 2  value: 2699.268 mgc: 1.658812e-06 ustep: 1 
iter: 3  mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  0.002018919 
iter: 1  value: 2699.268 mgc: 0.00136537 ustep: 1 
iter: 2  mgc: 3.314293e-09 
iter: 1  mgc: 3.314293e-09 
outer mgc:  0.0005156003 
iter: 1  mgc: 3.314293e-09 
iter: 1  mgc: 3.314293e-09 
outer mgc:  0.0005156003 
iter: 1  value: 2699.271 mgc: 0.004904089 ustep: 1 
iter: 2  value: 2699.271 mgc: 6.681469e-08 ustep: 1 
iter: 3  mgc: 4.551914e-15 
outer mgc:  0.06106556 
iter: 1  value: 2699.266 mgc: 0.004905532 ustep: 1 
iter: 2  value: 2699.266 mgc: 6.657982e-08 ustep: 1 
iter: 3  mgc: 4.440892e-15 
outer mgc:  0.06004499 
iter: 1  value: 2699.269 mgc: 0.002461599 ustep: 1 
iter: 2  value: 2699.269 mgc: 2.236697e-08 ustep: 1 
mgc: 7.549517e-15 
outer mgc:  0.02742575 
iter: 1  value: 2699.267 mgc: 0.002462857 ustep: 1 
iter: 2  value: 2699.267 mgc: 2.237768e-08 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.02721333 
iter: 1  value: 2699.268 mgc: 0.004662603 ustep: 1 
iter: 2  value: 2699.268 mgc: 1.248574e-07 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.05605599 
iter: 1  value: 2699.268 mgc: 0.004660238 ustep: 1 
iter: 2  value: 2699.268 mgc: 1.248621e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.05667887 
iter: 1  value: 2699.268 mgc: 0.002423818 ustep: 1 
iter: 2  value: 2699.268 mgc: 2.370146e-08 ustep: 1 
mgc: 4.607426e-15 
outer mgc:  0.02537085 
iter: 1  value: 2699.269 mgc: 0.002422556 ustep: 1 
iter: 2  value: 2699.269 mgc: 2.368883e-08 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.02546712 
iter: 1  value: 2699.282 mgc: 0.01601337 ustep: 1 
iter: 2  value: 2699.282 mgc: 8.423791e-07 ustep: 1 
iter: 3  mgc: 7.904788e-14 
outer mgc:  0.01177055 
iter: 1  value: 2699.254 mgc: 0.01605522 ustep: 1 
iter: 2  value: 2699.254 mgc: 8.431033e-07 ustep: 1 
iter: 3  mgc: 8.082424e-14 
outer mgc:  0.01195379 
iter: 1  value: 2699.281 mgc: 0.01342691 ustep: 1 
iter: 2  value: 2699.281 mgc: 9.013849e-07 ustep: 1 
iter: 3  mgc: 1.24345e-14 
outer mgc:  0.01322108 
iter: 1  value: 2699.255 mgc: 0.01346501 ustep: 1 
iter: 2  value: 2699.255 mgc: 8.989565e-07 ustep: 1 
iter: 3  mgc: 1.287859e-14 
outer mgc:  0.01303065 
iter: 1  value: 2699.263 mgc: 0.00234671 ustep: 1 
iter: 2  value: 2699.263 mgc: 2.237519e-08 ustep: 1 
mgc: 5.329071e-15 
outer mgc:  0.001101458 
iter: 1  value: 2699.274 mgc: 0.002345752 ustep: 1 
iter: 2  value: 2699.274 mgc: 2.241016e-08 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.0012366 
iter: 1  value: 2699.264 mgc: 0.002725571 ustep: 1 
iter: 2  value: 2699.264 mgc: 1.143162e-07 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.02186059 
iter: 1  value: 2699.273 mgc: 0.002723343 ustep: 1 
iter: 2  value: 2699.273 mgc: 1.140742e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.0219942 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:26:14 2021]
Finished job 0.
1 of 1 steps (100%) done

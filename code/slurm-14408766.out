Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:24:58 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22241.405784 
final  value 22040.080964 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3034.115 mgc: 75.31307 ustep: 1 
iter: 2  value: 2639.877 mgc: 37.24048 ustep: 1 
iter: 3  value: 2606.02 mgc: 34.11374 ustep: 1 
iter: 4  value: 2605.756 mgc: 3.93014 ustep: 1 
iter: 5  value: 2605.756 mgc: 0.1121432 ustep: 1 
iter: 6  value: 2605.756 mgc: 0.0001031711 ustep: 1 
iter: 7  mgc: 8.857989e-11 
iter: 1  mgc: 8.857989e-11 
Matching hessian patterns... Done
outer mgc:  705.0269 
iter: 1  value: 2469.783 mgc: 32.8622 ustep: 1 
iter: 2  value: 2467.225 mgc: 3.017528 ustep: 1 
iter: 3  value: 2467.224 mgc: 0.08526782 ustep: 1 
iter: 4  value: 2467.224 mgc: 0.0001178996 ustep: 1 
iter: 5  mgc: 2.264106e-10 
iter: 1  mgc: 2.264106e-10 
outer mgc:  528.4888 
iter: 1  value: 2352.894 mgc: 29.4212 ustep: 1 
iter: 2  value: 2350.581 mgc: 2.46092 ustep: 1 
iter: 3  value: 2350.58 mgc: 0.03117852 ustep: 1 
iter: 4  value: 2350.58 mgc: 1.309391e-05 ustep: 1 
iter: 5  mgc: 2.315481e-12 
iter: 1  mgc: 2.315481e-12 
outer mgc:  416.3814 
iter: 1  value: 2191.411 mgc: 19.06742 ustep: 1 
iter: 2  value: 2188.842 mgc: 2.1371 ustep: 1 
iter: 3  value: 2188.841 mgc: 0.07075777 ustep: 1 
iter: 4  value: 2188.841 mgc: 8.53794e-05 ustep: 1 
iter: 5  mgc: 1.248304e-10 
iter: 1  mgc: 1.248304e-10 
outer mgc:  31.9109 
iter: 1  value: 2290.65 mgc: 32.93927 ustep: 1 
iter: 2  value: 2288.935 mgc: 2.544524 ustep: 1 
iter: 3  value: 2288.935 mgc: 0.03592171 ustep: 1 
iter: 4  value: 2288.935 mgc: 1.015774e-05 ustep: 1 
iter: 5  mgc: 1.004086e-12 
iter: 1  value: 2188.59 mgc: 4.628516 ustep: 1 
iter: 2  value: 2188.589 mgc: 0.05366135 ustep: 1 
iter: 3  value: 2188.589 mgc: 2.023839e-05 ustep: 1 
iter: 4  mgc: 4.099832e-12 
iter: 1  value: 2187.079 mgc: 2.068409 ustep: 1 
iter: 2  value: 2187.079 mgc: 0.01054274 ustep: 1 
iter: 3  value: 2187.079 mgc: 7.977478e-07 ustep: 1 
iter: 4  mgc: 3.130829e-14 
iter: 1  mgc: 3.130829e-14 
outer mgc:  27.54407 
iter: 1  value: 2186.106 mgc: 1.725102 ustep: 1 
iter: 2  value: 2186.106 mgc: 0.009518809 ustep: 1 
iter: 3  value: 2186.106 mgc: 9.925317e-07 ustep: 1 
iter: 4  mgc: 2.819966e-14 
iter: 1  mgc: 2.819966e-14 
outer mgc:  28.0241 
iter: 1  value: 2184.56 mgc: 1.695989 ustep: 1 
iter: 2  value: 2184.56 mgc: 0.008903912 ustep: 1 
iter: 3  value: 2184.56 mgc: 7.954241e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  16.38846 
iter: 1  value: 2182.603 mgc: 2.009586 ustep: 1 
iter: 2  value: 2182.603 mgc: 0.014713 ustep: 1 
iter: 3  value: 2182.603 mgc: 1.630613e-06 ustep: 1 
iter: 4  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  16.58451 
iter: 1  value: 2181.432 mgc: 5.887734 ustep: 1 
iter: 2  value: 2181.427 mgc: 0.08874062 ustep: 1 
iter: 3  value: 2181.427 mgc: 5.40994e-05 ustep: 1 
iter: 4  mgc: 2.679146e-11 
iter: 1  mgc: 2.679146e-11 
outer mgc:  22.29279 
iter: 1  value: 2179.788 mgc: 6.324661 ustep: 1 
iter: 2  value: 2179.777 mgc: 0.118795 ustep: 1 
iter: 3  value: 2179.777 mgc: 9.758681e-05 ustep: 1 
iter: 4  mgc: 6.769296e-11 
iter: 1  mgc: 6.769296e-11 
outer mgc:  10.58169 
iter: 1  value: 2183.37 mgc: 4.680067 ustep: 1 
iter: 2  value: 2183.366 mgc: 0.1007841 ustep: 1 
iter: 3  value: 2183.366 mgc: 7.764206e-05 ustep: 1 
iter: 4  mgc: 8.576961e-11 
iter: 1  value: 2179.111 mgc: 1.465157 ustep: 1 
iter: 2  value: 2179.111 mgc: 0.006738286 ustep: 1 
iter: 3  value: 2179.111 mgc: 4.982151e-07 ustep: 1 
iter: 4  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  7.217242 
iter: 1  value: 2179.204 mgc: 2.045795 ustep: 1 
iter: 2  value: 2179.204 mgc: 0.01282352 ustep: 1 
iter: 3  value: 2179.204 mgc: 1.666014e-06 ustep: 1 
iter: 4  mgc: 2.88658e-14 
iter: 1  value: 2178.955 mgc: 0.5695143 ustep: 1 
iter: 2  value: 2178.955 mgc: 0.0009816747 ustep: 1 
iter: 3  mgc: 9.863224e-09 
iter: 1  mgc: 9.863224e-09 
outer mgc:  4.873076 
iter: 1  value: 2178.844 mgc: 0.1112958 ustep: 1 
iter: 2  value: 2178.844 mgc: 6.041887e-05 ustep: 1 
iter: 3  mgc: 5.962786e-11 
iter: 1  mgc: 5.962786e-11 
outer mgc:  4.713973 
iter: 1  value: 2178.706 mgc: 0.399776 ustep: 1 
iter: 2  value: 2178.706 mgc: 0.0006604715 ustep: 1 
iter: 3  mgc: 3.035058e-09 
iter: 1  mgc: 3.035058e-09 
outer mgc:  6.23604 
iter: 1  value: 2178.54 mgc: 0.2277671 ustep: 1 
iter: 2  value: 2178.54 mgc: 0.0003879195 ustep: 1 
iter: 3  mgc: 2.673451e-09 
iter: 1  mgc: 2.673451e-09 
outer mgc:  1.740834 
iter: 1  value: 2178.566 mgc: 0.1740694 ustep: 1 
iter: 2  value: 2178.566 mgc: 8.089043e-05 ustep: 1 
iter: 3  mgc: 7.510614e-11 
iter: 1  value: 2178.528 mgc: 0.05846087 ustep: 1 
iter: 2  value: 2178.528 mgc: 9.113366e-06 ustep: 1 
iter: 3  mgc: 9.778844e-13 
iter: 1  mgc: 9.778844e-13 
outer mgc:  1.788009 
iter: 1  value: 2178.519 mgc: 0.2989424 ustep: 1 
iter: 2  value: 2178.519 mgc: 0.0003033936 ustep: 1 
iter: 3  mgc: 9.967769e-10 
iter: 1  value: 2178.519 mgc: 0.08252477 ustep: 1 
iter: 2  value: 2178.519 mgc: 2.306645e-05 ustep: 1 
iter: 3  mgc: 5.756284e-12 
iter: 1  mgc: 5.756284e-12 
outer mgc:  0.7876235 
iter: 1  value: 2178.518 mgc: 0.07579853 ustep: 1 
iter: 2  value: 2178.518 mgc: 1.825456e-05 ustep: 1 
iter: 3  mgc: 2.44782e-12 
iter: 1  mgc: 2.44782e-12 
outer mgc:  0.8703462 
iter: 1  value: 2178.517 mgc: 0.136842 ustep: 1 
iter: 2  value: 2178.517 mgc: 6.628095e-05 ustep: 1 
iter: 3  mgc: 3.641976e-11 
iter: 1  mgc: 3.641976e-11 
outer mgc:  1.390253 
iter: 1  value: 2178.539 mgc: 0.08654216 ustep: 1 
iter: 2  value: 2178.539 mgc: 1.776433e-05 ustep: 1 
iter: 3  mgc: 1.449285e-12 
iter: 1  mgc: 1.449285e-12 
outer mgc:  1.231159 
iter: 1  value: 2178.535 mgc: 0.1860802 ustep: 1 
iter: 2  value: 2178.535 mgc: 8.789988e-05 ustep: 1 
iter: 3  mgc: 5.059553e-11 
iter: 1  mgc: 5.059553e-11 
outer mgc:  1.240493 
iter: 1  value: 2178.506 mgc: 0.277509 ustep: 1 
iter: 2  value: 2178.506 mgc: 0.000193557 ustep: 1 
iter: 3  mgc: 2.280838e-10 
iter: 1  value: 2178.52 mgc: 0.09848365 ustep: 1 
iter: 2  value: 2178.52 mgc: 2.445187e-05 ustep: 1 
iter: 3  mgc: 3.637313e-12 
iter: 1  mgc: 3.637313e-12 
outer mgc:  1.163189 
iter: 1  value: 2178.516 mgc: 0.1002787 ustep: 1 
iter: 2  value: 2178.516 mgc: 3.496185e-05 ustep: 1 
iter: 3  mgc: 1.746514e-11 
iter: 1  value: 2178.519 mgc: 0.0481419 ustep: 1 
iter: 2  value: 2178.519 mgc: 7.142822e-06 ustep: 1 
iter: 3  mgc: 5.222489e-13 
iter: 1  mgc: 5.222489e-13 
outer mgc:  0.5600598 
iter: 1  value: 2178.511 mgc: 0.05093593 ustep: 1 
iter: 2  value: 2178.511 mgc: 8.275283e-06 ustep: 1 
iter: 3  mgc: 6.674661e-13 
iter: 1  mgc: 6.674661e-13 
outer mgc:  0.4548882 
iter: 1  value: 2178.501 mgc: 0.05788372 ustep: 1 
iter: 2  value: 2178.501 mgc: 1.356761e-05 ustep: 1 
iter: 3  mgc: 1.373235e-12 
iter: 1  mgc: 1.373235e-12 
outer mgc:  0.2534004 
iter: 1  value: 2178.502 mgc: 0.06237577 ustep: 1 
iter: 2  value: 2178.502 mgc: 1.25079e-05 ustep: 1 
iter: 3  mgc: 1.055822e-12 
iter: 1  mgc: 1.055822e-12 
outer mgc:  0.3479084 
iter: 1  value: 2178.532 mgc: 0.1962302 ustep: 1 
iter: 2  value: 2178.532 mgc: 0.0001009442 ustep: 1 
iter: 3  mgc: 1.783325e-10 
iter: 1  value: 2178.506 mgc: 0.03491309 ustep: 1 
iter: 2  value: 2178.506 mgc: 4.355854e-06 ustep: 1 
iter: 3  mgc: 1.464384e-13 
iter: 1  mgc: 1.464384e-13 
outer mgc:  0.4102185 
iter: 1  value: 2178.505 mgc: 0.03600444 ustep: 1 
iter: 2  value: 2178.505 mgc: 4.043584e-06 ustep: 1 
iter: 3  mgc: 1.314504e-13 
iter: 1  mgc: 1.314504e-13 
outer mgc:  0.1028766 
iter: 1  value: 2178.502 mgc: 0.02745196 ustep: 1 
iter: 2  value: 2178.502 mgc: 1.764542e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.06647786 
iter: 1  value: 2178.505 mgc: 0.01738436 ustep: 1 
iter: 2  value: 2178.505 mgc: 8.893158e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  0.08203907 
iter: 1  value: 2178.5 mgc: 0.01396155 ustep: 1 
iter: 2  value: 2178.5 mgc: 9.517355e-07 ustep: 1 
iter: 3  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  0.1230687 
iter: 1  value: 2178.499 mgc: 0.01241542 ustep: 1 
iter: 2  value: 2178.499 mgc: 4.590666e-07 ustep: 1 
iter: 3  mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  0.06259651 
iter: 1  value: 2178.501 mgc: 0.01456289 ustep: 1 
iter: 2  value: 2178.501 mgc: 1.166766e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  0.06695281 
iter: 1  value: 2178.503 mgc: 0.01459884 ustep: 1 
iter: 2  value: 2178.503 mgc: 7.167935e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  value: 2178.501 mgc: 0.007526946 ustep: 1 
iter: 2  value: 2178.501 mgc: 1.854331e-07 ustep: 1 
iter: 3  mgc: 2.664535e-14 
iter: 1  value: 2178.501 mgc: 0.004003601 ustep: 1 
iter: 2  value: 2178.501 mgc: 4.832576e-08 ustep: 1 
iter: 3  mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  0.04269126 
iter: 1  value: 2178.501 mgc: 0.001160074 ustep: 1 
iter: 2  mgc: 3.895204e-09 
iter: 1  mgc: 3.895204e-09 
outer mgc:  0.03063151 
iter: 1  value: 2178.501 mgc: 0.002216848 ustep: 1 
iter: 2  value: 2178.501 mgc: 1.767838e-08 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  0.01175856 
iter: 1  value: 2178.501 mgc: 0.002356297 ustep: 1 
iter: 2  value: 2178.501 mgc: 3.672334e-08 ustep: 1 
iter: 3  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.00597492 
iter: 1  value: 2178.501 mgc: 0.003221274 ustep: 1 
iter: 2  value: 2178.501 mgc: 4.141032e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.00597492 
iter: 1  value: 2178.501 mgc: 0.05775065 ustep: 1 
iter: 2  value: 2178.501 mgc: 8.999404e-06 ustep: 1 
iter: 3  mgc: 6.581402e-13 
outer mgc:  0.2631742 
iter: 1  value: 2178.5 mgc: 0.05774827 ustep: 1 
iter: 2  value: 2178.5 mgc: 9.01127e-06 ustep: 1 
iter: 3  mgc: 6.590284e-13 
outer mgc:  0.2683328 
iter: 1  value: 2178.504 mgc: 0.03021603 ustep: 1 
iter: 2  value: 2178.504 mgc: 2.966648e-06 ustep: 1 
iter: 3  mgc: 1.021405e-13 
outer mgc:  1.149733 
iter: 1  value: 2178.499 mgc: 0.03020992 ustep: 1 
iter: 2  value: 2178.499 mgc: 2.966818e-06 ustep: 1 
iter: 3  mgc: 9.370282e-14 
outer mgc:  1.161729 
iter: 1  value: 2178.5 mgc: 0.05618685 ustep: 1 
iter: 2  value: 2178.5 mgc: 9.322625e-06 ustep: 1 
iter: 3  mgc: 6.181722e-13 
outer mgc:  0.2837963 
iter: 1  value: 2178.501 mgc: 0.05617976 ustep: 1 
iter: 2  value: 2178.501 mgc: 9.331372e-06 ustep: 1 
iter: 3  mgc: 6.161738e-13 
outer mgc:  0.2804873 
iter: 1  value: 2178.5 mgc: 0.02821094 ustep: 1 
iter: 2  value: 2178.5 mgc: 2.338394e-06 ustep: 1 
iter: 3  mgc: 4.662937e-14 
outer mgc:  1.03475 
iter: 1  value: 2178.502 mgc: 0.02820182 ustep: 1 
iter: 2  value: 2178.502 mgc: 2.338654e-06 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  1.02898 
iter: 1  value: 2178.496 mgc: 0.004598419 ustep: 1 
iter: 2  value: 2178.496 mgc: 2.982166e-07 ustep: 1 
iter: 3  mgc: 2.797762e-14 
outer mgc:  0.06430108 
iter: 1  value: 2178.506 mgc: 0.004594627 ustep: 1 
iter: 2  value: 2178.506 mgc: 2.977775e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
outer mgc:  0.06375338 
iter: 1  value: 2178.508 mgc: 0.009816452 ustep: 1 
iter: 2  value: 2178.508 mgc: 1.471667e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
outer mgc:  0.2425895 
iter: 1  value: 2178.494 mgc: 0.00983844 ustep: 1 
iter: 2  value: 2178.494 mgc: 1.477061e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.2518362 
iter: 1  value: 2178.51 mgc: 0.009079965 ustep: 1 
iter: 2  value: 2178.51 mgc: 1.442236e-06 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.242765 
iter: 1  value: 2178.492 mgc: 0.009099311 ustep: 1 
iter: 2  value: 2178.492 mgc: 1.447038e-06 ustep: 1 
iter: 3  mgc: 3.619327e-14 
outer mgc:  0.239675 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:25:00 2021]
Finished job 0.
1 of 1 steps (100%) done

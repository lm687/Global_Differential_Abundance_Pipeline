Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:13:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2111.532819 
final  value 1954.631257 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 187.8961 mgc: 87.22118 ustep: 1 
iter: 2  value: 152.5478 mgc: 20.42346 ustep: 1 
iter: 3  value: 151.5818 mgc: 4.245329 ustep: 1 
iter: 4  value: 151.5808 mgc: 0.1475364 ustep: 1 
iter: 5  value: 151.5808 mgc: 0.0005680133 ustep: 1 
iter: 6  mgc: 8.515852e-09 
iter: 1  mgc: 8.515852e-09 
Matching hessian patterns... Done
outer mgc:  18.98795 
iter: 1  value: 151.4207 mgc: 17.63525 ustep: 1 
iter: 2  value: 147.5657 mgc: 5.565712 ustep: 1 
iter: 3  value: 147.5554 mgc: 0.2732941 ustep: 1 
iter: 4  value: 147.5554 mgc: 0.001332157 ustep: 1 
iter: 5  value: 147.5554 mgc: 4.48138e-08 ustep: 1 
mgc: 1.909584e-14 
iter: 1  mgc: 1.909584e-14 
outer mgc:  24.77973 
iter: 1  value: 148.3595 mgc: 8.514241 ustep: 1 
iter: 2  value: 148.3543 mgc: 0.2336786 ustep: 1 
iter: 3  value: 148.3543 mgc: 0.001087902 ustep: 1 
iter: 4  value: 148.3543 mgc: 2.410118e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  value: 141.8699 mgc: 3.855231 ustep: 1 
iter: 2  value: 141.8686 mgc: 0.1120298 ustep: 1 
iter: 3  value: 141.8686 mgc: 0.0001448878 ustep: 1 
iter: 4  mgc: 2.518922e-10 
iter: 1  mgc: 2.518922e-10 
outer mgc:  20.85278 
iter: 1  value: 140.5187 mgc: 18.91541 ustep: 1 
iter: 2  value: 140.3696 mgc: 1.352612 ustep: 1 
iter: 3  value: 140.3696 mgc: 0.0150053 ustep: 1 
iter: 4  value: 140.3696 mgc: 2.947378e-06 ustep: 1 
iter: 5  mgc: 1.898481e-13 
iter: 1  mgc: 1.898481e-13 
outer mgc:  27.55697 
iter: 1  value: 131.9716 mgc: 6.700546 ustep: 1 
iter: 2  value: 131.959 mgc: 0.3270842 ustep: 1 
iter: 3  value: 131.959 mgc: 0.00154824 ustep: 1 
iter: 4  value: 131.959 mgc: 4.834597e-08 ustep: 1 
mgc: 2.697842e-14 
iter: 1  mgc: 2.697842e-14 
outer mgc:  6.73759 
iter: 1  value: 129.3875 mgc: 28.9343 ustep: 1 
iter: 2  value: 128.3066 mgc: 3.591514 ustep: 1 
iter: 3  value: 128.3061 mgc: 0.07735219 ustep: 1 
iter: 4  value: 128.3061 mgc: 6.849555e-05 ustep: 1 
iter: 5  mgc: 5.381073e-11 
iter: 1  mgc: 5.381073e-11 
outer mgc:  21.03822 
iter: 1  value: 120.3096 mgc: 16.54786 ustep: 1 
iter: 2  value: 120.2312 mgc: 1.435822 ustep: 1 
iter: 3  value: 120.2312 mgc: 0.01422734 ustep: 1 
iter: 4  value: 120.2312 mgc: 1.452944e-06 ustep: 1 
iter: 5  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  25.32028 
iter: 1  value: 147.2814 mgc: 49.47506 ustep: 1 
iter: 2  value: 146.1579 mgc: 4.926954 ustep: 1 
iter: 3  value: 146.1577 mgc: 0.07390475 ustep: 1 
iter: 4  value: 146.1577 mgc: 3.294875e-05 ustep: 1 
iter: 5  mgc: 3.264944e-12 
iter: 1  value: 117.3432 mgc: 10.07589 ustep: 1 
iter: 2  value: 117.3405 mgc: 0.2140438 ustep: 1 
iter: 3  value: 117.3405 mgc: 0.0002332078 ustep: 1 
iter: 4  mgc: 2.78042e-10 
iter: 1  mgc: 2.78042e-10 
outer mgc:  10.37457 
iter: 1  value: 116.3443 mgc: 3.17566 ustep: 1 
iter: 2  value: 116.3441 mgc: 0.04719442 ustep: 1 
iter: 3  value: 116.3441 mgc: 1.082283e-05 ustep: 1 
iter: 4  mgc: 5.847545e-13 
iter: 1  mgc: 5.847545e-13 
outer mgc:  5.615722 
iter: 1  value: 115.7151 mgc: 7.137562 ustep: 1 
iter: 2  value: 115.7141 mgc: 0.09400232 ustep: 1 
iter: 3  value: 115.7141 mgc: 0.0001023194 ustep: 1 
iter: 4  mgc: 5.560175e-11 
iter: 1  mgc: 5.560175e-11 
outer mgc:  5.58244 
iter: 1  value: 115.6181 mgc: 5.780039 ustep: 1 
iter: 2  value: 115.6177 mgc: 0.1115506 ustep: 1 
iter: 3  value: 115.6177 mgc: 4.645858e-05 ustep: 1 
iter: 4  mgc: 8.093304e-12 
iter: 1  value: 115.4688 mgc: 3.475064 ustep: 1 
iter: 2  value: 115.4688 mgc: 0.02400108 ustep: 1 
iter: 3  value: 115.4688 mgc: 2.499702e-06 ustep: 1 
iter: 4  mgc: 2.420286e-14 
iter: 1  mgc: 2.420286e-14 
outer mgc:  2.564923 
iter: 1  value: 115.5533 mgc: 1.1687 ustep: 1 
iter: 2  value: 115.5533 mgc: 0.00864034 ustep: 1 
iter: 3  value: 115.5533 mgc: 4.339762e-07 ustep: 1 
iter: 4  mgc: 1.953993e-14 
iter: 1  value: 115.4634 mgc: 0.8244532 ustep: 1 
iter: 2  value: 115.4634 mgc: 0.002949115 ustep: 1 
iter: 3  value: 115.4634 mgc: 3.812389e-08 ustep: 1 
mgc: 1.987299e-14 
iter: 1  mgc: 1.987299e-14 
outer mgc:  1.152738 
iter: 1  value: 115.4681 mgc: 0.4149727 ustep: 1 
iter: 2  value: 115.4681 mgc: 0.000791115 ustep: 1 
iter: 3  mgc: 3.720801e-09 
iter: 1  mgc: 3.720801e-09 
outer mgc:  0.563452 
iter: 1  value: 115.4056 mgc: 0.5285025 ustep: 1 
iter: 2  value: 115.4056 mgc: 0.0008681156 ustep: 1 
iter: 3  mgc: 1.245299e-09 
iter: 1  mgc: 1.245299e-09 
outer mgc:  0.3348659 
iter: 1  value: 115.3982 mgc: 0.7630428 ustep: 1 
iter: 2  value: 115.3982 mgc: 0.001627342 ustep: 1 
iter: 3  value: 115.3982 mgc: 1.264932e-08 ustep: 1 
mgc: 1.376677e-14 
iter: 1  value: 115.3989 mgc: 0.2376258 ustep: 1 
iter: 2  value: 115.3989 mgc: 0.000156619 ustep: 1 
iter: 3  mgc: 1.199711e-10 
iter: 1  mgc: 1.199711e-10 
outer mgc:  0.1995981 
iter: 1  value: 115.3929 mgc: 0.2879452 ustep: 1 
iter: 2  value: 115.3929 mgc: 0.0001418253 ustep: 1 
iter: 3  mgc: 8.682444e-11 
iter: 1  value: 115.3989 mgc: 0.1706976 ustep: 1 
iter: 2  value: 115.3989 mgc: 4.494255e-05 ustep: 1 
iter: 3  mgc: 8.733569e-12 
iter: 1  mgc: 8.733569e-12 
outer mgc:  0.2542192 
iter: 1  value: 115.3966 mgc: 0.08873444 ustep: 1 
iter: 2  value: 115.3966 mgc: 1.290228e-05 ustep: 1 
iter: 3  mgc: 7.271961e-13 
iter: 1  mgc: 7.271961e-13 
outer mgc:  0.1428873 
iter: 1  value: 115.3908 mgc: 0.04324434 ustep: 1 
iter: 2  value: 115.3908 mgc: 4.847491e-06 ustep: 1 
iter: 3  mgc: 1.398881e-13 
iter: 1  value: 115.3794 mgc: 0.08960434 ustep: 1 
iter: 2  value: 115.3794 mgc: 2.071192e-05 ustep: 1 
iter: 3  mgc: 2.543521e-12 
iter: 1  mgc: 2.543521e-12 
outer mgc:  0.3099071 
iter: 1  value: 115.3544 mgc: 0.1075895 ustep: 1 
iter: 2  value: 115.3544 mgc: 5.636854e-05 ustep: 1 
iter: 3  mgc: 1.814993e-11 
iter: 1  value: 115.3147 mgc: 0.1672062 ustep: 1 
iter: 2  value: 115.3147 mgc: 5.523541e-05 ustep: 1 
iter: 3  mgc: 1.593659e-11 
iter: 1  mgc: 1.593659e-11 
outer mgc:  0.3209207 
iter: 1  value: 115.2075 mgc: 0.5539817 ustep: 1 
iter: 2  value: 115.2075 mgc: 0.0005424059 ustep: 1 
iter: 3  mgc: 1.591443e-09 
iter: 1  mgc: 1.591443e-09 
outer mgc:  0.3280864 
iter: 1  value: 115.2257 mgc: 0.2601479 ustep: 1 
iter: 2  value: 115.2257 mgc: 0.0001575948 ustep: 1 
iter: 3  mgc: 7.048406e-11 
iter: 1  value: 115.2138 mgc: 0.1612252 ustep: 1 
iter: 2  value: 115.2138 mgc: 3.664213e-05 ustep: 1 
iter: 3  mgc: 3.978484e-12 
iter: 1  mgc: 3.978484e-12 
outer mgc:  0.3021723 
iter: 1  value: 115.2267 mgc: 0.1485964 ustep: 1 
iter: 2  value: 115.2267 mgc: 9.009562e-05 ustep: 1 
iter: 3  mgc: 3.288669e-11 
iter: 1  mgc: 3.288669e-11 
outer mgc:  0.3079366 
iter: 1  value: 115.2495 mgc: 0.1464681 ustep: 1 
iter: 2  value: 115.2495 mgc: 8.351401e-05 ustep: 1 
iter: 3  mgc: 2.700773e-11 
iter: 1  mgc: 2.700773e-11 
outer mgc:  0.1031557 
iter: 1  value: 115.2229 mgc: 0.09030881 ustep: 1 
iter: 2  value: 115.2229 mgc: 4.800265e-05 ustep: 1 
iter: 3  mgc: 1.29301e-11 
iter: 1  mgc: 1.29301e-11 
outer mgc:  0.08420367 
iter: 1  value: 115.2355 mgc: 0.06089003 ustep: 1 
iter: 2  value: 115.2355 mgc: 1.814138e-05 ustep: 1 
iter: 3  mgc: 1.96998e-12 
iter: 1  mgc: 1.96998e-12 
outer mgc:  0.04306006 
iter: 1  value: 115.2342 mgc: 0.05930864 ustep: 1 
iter: 2  value: 115.2342 mgc: 9.528637e-06 ustep: 1 
iter: 3  mgc: 5.746514e-13 
iter: 1  mgc: 5.746514e-13 
outer mgc:  0.01878002 
iter: 1  value: 115.2339 mgc: 0.03063008 ustep: 1 
iter: 2  value: 115.2339 mgc: 3.052332e-06 ustep: 1 
iter: 3  mgc: 6.883383e-14 
iter: 1  mgc: 6.883383e-14 
outer mgc:  0.009130427 
iter: 1  value: 115.2339 mgc: 0.005593379 ustep: 1 
iter: 2  value: 115.2339 mgc: 1.899402e-07 ustep: 1 
mgc: 7.21645e-15 
iter: 1  mgc: 7.21645e-15 
outer mgc:  0.00322713 
iter: 1  value: 115.2339 mgc: 0.001263166 ustep: 1 
iter: 2  mgc: 3.088251e-09 
iter: 1  mgc: 3.088251e-09 
outer mgc:  0.0002192464 
iter: 1  value: 115.2339 mgc: 0.0001057958 ustep: 1 
iter: 2  mgc: 6.152279e-11 
iter: 1  mgc: 6.152279e-11 
outer mgc:  0.0001086184 
iter: 1  mgc: 6.152279e-11 
iter: 1  mgc: 6.152279e-11 
outer mgc:  0.0001086184 
iter: 1  value: 115.2345 mgc: 0.05210756 ustep: 1 
iter: 2  value: 115.2345 mgc: 5.259752e-06 ustep: 1 
iter: 3  mgc: 7.371881e-14 
outer mgc:  0.1043361 
iter: 1  value: 115.2335 mgc: 0.05211582 ustep: 1 
iter: 2  value: 115.2335 mgc: 5.266671e-06 ustep: 1 
iter: 3  mgc: 6.128431e-14 
outer mgc:  0.1042701 
iter: 1  value: 115.2342 mgc: 0.02506154 ustep: 1 
iter: 2  value: 115.2342 mgc: 1.221896e-06 ustep: 1 
iter: 3  mgc: 1.687539e-14 
outer mgc:  0.140642 
iter: 1  value: 115.2338 mgc: 0.02506482 ustep: 1 
iter: 2  value: 115.2338 mgc: 1.222009e-06 ustep: 1 
iter: 3  mgc: 1.998401e-14 
outer mgc:  0.1404214 
iter: 1  value: 115.2334 mgc: 0.03262741 ustep: 1 
iter: 2  value: 115.2334 mgc: 4.351953e-06 ustep: 1 
iter: 3  mgc: 7.405188e-14 
outer mgc:  0.1011107 
iter: 1  value: 115.2345 mgc: 0.03260703 ustep: 1 
iter: 2  value: 115.2345 mgc: 4.352694e-06 ustep: 1 
iter: 3  mgc: 7.871481e-14 
outer mgc:  0.1011745 
iter: 1  value: 115.2337 mgc: 0.01530881 ustep: 1 
iter: 2  value: 115.2337 mgc: 9.594932e-07 ustep: 1 
iter: 3  mgc: 3.053113e-14 
outer mgc:  0.08876076 
iter: 1  value: 115.2343 mgc: 0.01529913 ustep: 1 
iter: 2  value: 115.2343 mgc: 9.58909e-07 ustep: 1 
iter: 3  mgc: 1.809664e-14 
outer mgc:  0.08876151 
iter: 1  value: 115.232 mgc: 0.005440863 ustep: 1 
iter: 2  value: 115.232 mgc: 1.473587e-07 ustep: 1 
mgc: 1.687539e-14 
outer mgc:  0.001691024 
iter: 1  value: 115.2359 mgc: 0.005437732 ustep: 1 
iter: 2  value: 115.2359 mgc: 1.474408e-07 ustep: 1 
mgc: 2.930989e-14 
outer mgc:  0.001707051 
iter: 1  value: 115.2356 mgc: 0.02116888 ustep: 1 
iter: 2  value: 115.2356 mgc: 7.939429e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
outer mgc:  0.02852061 
iter: 1  value: 115.2323 mgc: 0.02122191 ustep: 1 
iter: 2  value: 115.2323 mgc: 7.969513e-07 ustep: 1 
iter: 3  mgc: 1.731948e-14 
outer mgc:  0.0285405 
iter: 1  value: 115.2376 mgc: 0.01681931 ustep: 1 
iter: 2  value: 115.2376 mgc: 1.619778e-06 ustep: 1 
iter: 3  mgc: 2.176037e-14 
outer mgc:  0.02206181 
iter: 1  value: 115.2303 mgc: 0.01685823 ustep: 1 
iter: 2  value: 115.2303 mgc: 1.621469e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.02207109 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:13:45 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:04:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2159.871760 
final  value 2118.458955 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1947.596 mgc: 3.224951 ustep: 0.8994163 
iter: 2  value: 1945.04 mgc: 1.887529 ustep: 0.9483808 
iter: 3  value: 1943.734 mgc: 2.564814 ustep: 0.973851 
iter: 4  value: 1943.613 mgc: 0.4261822 ustep: 0.9868402 
iter: 5  value: 1943.613 mgc: 0.02095685 ustep: 0.993399 
iter: 6  value: 1943.613 mgc: 2.739073e-05 ustep: 0.9966944 
iter: 7  value: 1943.613 mgc: 7.563216e-08 ustep: 0.998346 
iter: 8  mgc: 1.05424e-10 
iter: 1  mgc: 1.05424e-10 
Matching hessian patterns... Done
outer mgc:  8.877212 
iter: 1  value: 1925.285 mgc: 0.7504006 ustep: 1 
iter: 2  value: 1925.284 mgc: 0.03960592 ustep: 1 
iter: 3  value: 1925.284 mgc: 9.002608e-05 ustep: 1 
iter: 4  mgc: 5.323735e-10 
iter: 1  value: 1915.126 mgc: 4.798451 ustep: 1 
iter: 2  value: 1915.106 mgc: 0.3634323 ustep: 1 
iter: 3  value: 1915.106 mgc: 0.00461734 ustep: 1 
iter: 4  value: 1915.106 mgc: 1.451035e-06 ustep: 1 
iter: 5  mgc: 1.021405e-13 
iter: 1  mgc: 5.323735e-10 
outer mgc:  6.10781 
iter: 1  value: 1911.776 mgc: 1.970354 ustep: 1 
iter: 2  value: 1911.773 mgc: 0.1101639 ustep: 1 
iter: 3  value: 1911.773 mgc: 0.0007412264 ustep: 1 
iter: 4  value: 1911.773 mgc: 5.786008e-08 ustep: 1 
iter: 5  mgc: 3.330669e-15 
iter: 1  mgc: 3.330669e-15 
outer mgc:  5.826198 
iter: 1  value: 1911.748 mgc: 7.273283 ustep: 1 
iter: 2  value: 1911.739 mgc: 0.3171126 ustep: 1 
iter: 3  value: 1911.739 mgc: 0.000388448 ustep: 1 
iter: 4  mgc: 3.884766e-09 
iter: 1  value: 1908.714 mgc: 2.051896 ustep: 1 
iter: 2  value: 1908.714 mgc: 0.01822118 ustep: 1 
iter: 3  value: 1908.714 mgc: 1.105595e-05 ustep: 1 
iter: 4  mgc: 1.109418e-11 
iter: 1  mgc: 1.109418e-11 
outer mgc:  4.633374 
iter: 1  value: 1905.86 mgc: 1.822152 ustep: 1 
iter: 2  value: 1905.86 mgc: 0.03471829 ustep: 1 
iter: 3  value: 1905.86 mgc: 5.662598e-05 ustep: 1 
iter: 4  mgc: 1.078795e-10 
iter: 1  mgc: 1.078795e-10 
outer mgc:  5.535056 
iter: 1  value: 1903.241 mgc: 10.05444 ustep: 1 
iter: 2  value: 1903.239 mgc: 0.08298892 ustep: 1 
iter: 3  value: 1903.239 mgc: 0.0001677909 ustep: 1 
iter: 4  mgc: 5.595033e-10 
iter: 1  value: 1904.098 mgc: 2.646868 ustep: 1 
iter: 2  value: 1904.098 mgc: 0.01545265 ustep: 1 
iter: 3  value: 1904.098 mgc: 1.271743e-05 ustep: 1 
iter: 4  mgc: 1.638689e-12 
iter: 1  mgc: 1.638689e-12 
outer mgc:  3.119534 
iter: 1  value: 1901.55 mgc: 1.552911 ustep: 1 
iter: 2  value: 1901.549 mgc: 0.02531022 ustep: 1 
iter: 3  value: 1901.549 mgc: 2.045361e-05 ustep: 1 
iter: 4  mgc: 1.17919e-11 
iter: 1  mgc: 1.17919e-11 
outer mgc:  1.104768 
iter: 1  value: 1899.524 mgc: 1.843921 ustep: 1 
iter: 2  value: 1899.524 mgc: 0.02006618 ustep: 1 
iter: 3  value: 1899.524 mgc: 1.247598e-06 ustep: 1 
iter: 4  mgc: 1.065814e-14 
iter: 1  value: 1900.52 mgc: 0.7261665 ustep: 1 
iter: 2  value: 1900.52 mgc: 0.003998521 ustep: 1 
iter: 3  value: 1900.52 mgc: 7.103494e-08 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  1.488627 
iter: 1  value: 1899.394 mgc: 1.353469 ustep: 1 
iter: 2  value: 1899.394 mgc: 0.004023807 ustep: 1 
iter: 3  value: 1899.394 mgc: 8.001995e-07 ustep: 1 
iter: 4  mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  0.7421921 
iter: 1  value: 1898.405 mgc: 1.118942 ustep: 1 
iter: 2  value: 1898.405 mgc: 0.004687268 ustep: 1 
iter: 3  value: 1898.405 mgc: 2.721485e-07 ustep: 1 
iter: 4  mgc: 3.108624e-15 
iter: 1  mgc: 3.108624e-15 
outer mgc:  1.357372 
iter: 1  value: 1897.254 mgc: 1.159226 ustep: 1 
iter: 2  value: 1897.254 mgc: 0.001346339 ustep: 1 
iter: 3  value: 1897.254 mgc: 8.249819e-08 ustep: 1 
mgc: 2.664535e-15 
iter: 1  mgc: 2.664535e-15 
outer mgc:  0.3243563 
iter: 1  value: 1896.345 mgc: 0.8856446 ustep: 1 
iter: 2  value: 1896.345 mgc: 0.001043379 ustep: 1 
iter: 3  mgc: 5.165224e-09 
iter: 1  mgc: 5.165224e-09 
outer mgc:  0.5408599 
iter: 1  value: 1895.789 mgc: 0.5006365 ustep: 1 
iter: 2  value: 1895.789 mgc: 0.000111269 ustep: 1 
iter: 3  mgc: 7.183982e-10 
iter: 1  value: 1895.072 mgc: 0.7180634 ustep: 1 
iter: 2  value: 1895.072 mgc: 0.0001404723 ustep: 1 
iter: 3  mgc: 8.143819e-10 
iter: 1  mgc: 8.143819e-10 
outer mgc:  0.6580065 
iter: 1  value: 1893.841 mgc: 1.512082 ustep: 1 
iter: 2  value: 1893.841 mgc: 0.001665118 ustep: 1 
iter: 3  value: 1893.841 mgc: 3.137126e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.4580991 
iter: 1  value: 1893.151 mgc: 1.000603 ustep: 1 
iter: 2  value: 1893.151 mgc: 0.00154466 ustep: 1 
iter: 3  mgc: 5.725102e-09 
iter: 1  mgc: 5.725102e-09 
outer mgc:  0.3410763 
iter: 1  value: 1892.639 mgc: 1.845386 ustep: 1 
iter: 2  value: 1892.639 mgc: 0.0004043744 ustep: 1 
iter: 3  mgc: 2.850864e-09 
iter: 1  value: 1892.035 mgc: 2.901605 ustep: 1 
iter: 2  value: 1892.035 mgc: 0.0007958257 ustep: 1 
iter: 3  value: 1892.035 mgc: 1.084984e-08 ustep: 1 
mgc: 1.387779e-14 
iter: 1  mgc: 1.387779e-14 
outer mgc:  0.3067449 
iter: 1  value: 1891.107 mgc: 4.289693 ustep: 1 
iter: 2  value: 1891.107 mgc: 0.001209819 ustep: 1 
iter: 3  value: 1891.107 mgc: 3.570375e-08 ustep: 1 
mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.09506155 
iter: 1  value: 1889.728 mgc: 1.034712 ustep: 1 
iter: 2  value: 1889.728 mgc: 9.11658e-05 ustep: 1 
iter: 3  mgc: 1.314926e-10 
iter: 1  mgc: 1.314926e-10 
outer mgc:  0.07651708 
iter: 1  value: 1887.385 mgc: 1.570794 ustep: 1 
iter: 2  value: 1887.385 mgc: 0.0001352087 ustep: 1 
iter: 3  mgc: 3.948668e-10 
iter: 1  mgc: 3.948668e-10 
outer mgc:  0.0531528 
iter: 1  value: 1885.498 mgc: 2.48225 ustep: 1 
iter: 2  value: 1885.498 mgc: 7.603521e-05 ustep: 1 
iter: 3  mgc: 6.120848e-11 
iter: 1  mgc: 6.120848e-11 
outer mgc:  0.04345812 
iter: 1  value: 1883.971 mgc: 2.100845 ustep: 1 
iter: 2  value: 1883.971 mgc: 1.276401e-05 ustep: 1 
iter: 3  mgc: 6.113554e-12 
iter: 1  mgc: 6.113554e-12 
outer mgc:  0.01151536 
iter: 1  value: 1881.843 mgc: 2.243489 ustep: 1 
iter: 2  value: 1881.843 mgc: 1.005145e-05 ustep: 1 
iter: 3  mgc: 4.11049e-12 
iter: 1  mgc: 4.11049e-12 
outer mgc:  0.01067962 
iter: 1  value: 1880.072 mgc: 2.270647 ustep: 1 
iter: 2  value: 1880.072 mgc: 3.441111e-06 ustep: 1 
iter: 3  mgc: 8.093526e-14 
iter: 1  mgc: 8.093526e-14 
outer mgc:  0.003847481 
iter: 1  value: 1878.012 mgc: 1.436094 ustep: 1 
iter: 2  value: 1878.012 mgc: 9.433683e-07 ustep: 1 
iter: 3  mgc: 1.310063e-13 
iter: 1  mgc: 1.310063e-13 
outer mgc:  0.00426742 
iter: 1  value: 1876.295 mgc: 1.343581 ustep: 1 
iter: 2  value: 1876.295 mgc: 2.421657e-07 ustep: 1 
iter: 3  mgc: 2.011724e-13 
iter: 1  mgc: 2.011724e-13 
outer mgc:  0.001669188 
iter: 1  value: 1874.195 mgc: 1.271758 ustep: 1 
iter: 2  value: 1874.195 mgc: 1.58827e-07 ustep: 1 
iter: 3  mgc: 2.196021e-13 
iter: 1  mgc: 2.196021e-13 
outer mgc:  0.002091536 
iter: 1  value: 1872.46 mgc: 1.5929 ustep: 1 
iter: 2  value: 1872.46 mgc: 8.095814e-08 ustep: 1 
iter: 3  mgc: 5.067058e-13 
iter: 1  mgc: 5.067058e-13 
outer mgc:  0.0007235472 
iter: 1  value: 1870.367 mgc: 1.560061 ustep: 1 
iter: 2  value: 1870.367 mgc: 5.02344e-08 ustep: 1 
iter: 3  mgc: 6.927792e-13 
iter: 1  mgc: 6.927792e-13 
outer mgc:  0.0009612479 
iter: 1  value: 1868.636 mgc: 1.653451 ustep: 1 
iter: 2  value: 1868.636 mgc: 1.896304e-08 ustep: 1 
mgc: 1.050937e-12 
iter: 1  mgc: 1.050937e-12 
outer mgc:  0.0003267778 
iter: 1  value: 1866.54 mgc: 1.459928 ustep: 1 
iter: 2  mgc: 9.788664e-09 
iter: 1  mgc: 9.788664e-09 
outer mgc:  0.0004414787 
iter: 1  value: 1864.807 mgc: 1.541303 ustep: 1 
iter: 2  mgc: 3.550224e-09 
iter: 1  mgc: 3.550224e-09 
outer mgc:  0.0001531641 
iter: 1  value: 1862.71 mgc: 1.431722 ustep: 1 
iter: 2  mgc: 2.04362e-09 
iter: 1  mgc: 2.04362e-09 
outer mgc:  0.0002060447 
iter: 1  value: 1860.977 mgc: 1.577914 ustep: 1 
iter: 2  mgc: 8.060477e-10 
iter: 1  mgc: 8.060477e-10 
outer mgc:  7.220178e-05 
iter: 1  value: 1858.88 mgc: 1.479191 ustep: 1 
iter: 2  mgc: 4.645564e-10 
iter: 1  mgc: 4.645564e-10 
outer mgc:  9.537408e-05 
iter: 1  value: 1857.147 mgc: 1.583433 ustep: 1 
iter: 2  mgc: 1.835672e-10 
iter: 1  mgc: 1.835672e-10 
outer mgc:  3.351897e-05 
iter: 1  value: 1855.05 mgc: 1.465874 ustep: 1 
iter: 2  mgc: 9.402035e-11 
iter: 1  mgc: 9.402035e-11 
outer mgc:  4.41362e-05 
iter: 1  value: 1853.317 mgc: 1.56523 ustep: 1 
iter: 2  mgc: 4.745448e-11 
iter: 1  mgc: 4.745448e-11 
outer mgc:  1.564631e-05 
iter: 1  value: 1851.22 mgc: 1.464294 ustep: 1 
iter: 2  mgc: 3.88436e-11 
iter: 1  mgc: 3.88436e-11 
outer mgc:  2.04735e-05 
iter: 1  value: 1849.487 mgc: 1.56824 ustep: 1 
iter: 2  mgc: 4.549539e-11 
iter: 1  mgc: 4.549539e-11 
outer mgc:  7.307316e-06 
iter: 1  value: 1847.39 mgc: 1.472507 ustep: 1 
iter: 2  mgc: 4.121503e-11 
iter: 1  mgc: 4.121503e-11 
outer mgc:  9.48666e-06 
iter: 1  value: 1845.657 mgc: 1.566456 ustep: 1 
iter: 2  mgc: 1.622824e-10 
iter: 1  mgc: 1.622824e-10 
outer mgc:  3.405376e-06 
iter: 1  mgc: 1.622824e-10 
iter: 1  mgc: 1.622824e-10 
outer mgc:  3.405376e-06 
iter: 1  value: 1845.659 mgc: 0.004696689 ustep: 1 
iter: 2  mgc: 5.094284e-09 
outer mgc:  0.03915149 
iter: 1  value: 1845.655 mgc: 0.00469617 ustep: 1 
iter: 2  mgc: 5.109554e-09 
outer mgc:  0.03913079 
iter: 1  value: 1845.658 mgc: 0.00255145 ustep: 1 
iter: 2  value: 1845.658 mgc: 1.435072e-08 ustep: 1 
mgc: 1.212893e-10 
outer mgc:  0.01863624 
iter: 1  value: 1845.656 mgc: 0.0025512 ustep: 1 
iter: 2  value: 1845.656 mgc: 1.433018e-08 ustep: 1 
mgc: 1.226499e-10 
outer mgc:  0.01862195 
iter: 1  value: 1845.656 mgc: 0.004222138 ustep: 1 
iter: 2  value: 1845.656 mgc: 3.252792e-07 ustep: 1 
iter: 3  mgc: 1.046838e-10 
outer mgc:  0.02223434 
iter: 1  value: 1845.658 mgc: 0.004220119 ustep: 1 
iter: 2  value: 1845.658 mgc: 3.251469e-07 ustep: 1 
iter: 3  mgc: 1.039528e-10 
outer mgc:  0.02223268 
iter: 1  value: 1845.657 mgc: 0.002703305 ustep: 1 
iter: 2  value: 1845.657 mgc: 1.207533e-07 ustep: 1 
iter: 3  mgc: 1.952802e-10 
outer mgc:  0.01569717 
iter: 1  value: 1845.657 mgc: 0.0027029 ustep: 1 
iter: 2  value: 1845.657 mgc: 1.207686e-07 ustep: 1 
iter: 3  mgc: 1.330592e-10 
outer mgc:  0.01569704 
iter: 1  value: 1845.667 mgc: 723.2382 ustep: 1 
iter: 2  value: 1845.667 mgc: 3.456489e-07 ustep: 1 
iter: 3  mgc: 1.466953e-10 
outer mgc:  0.004486866 
iter: 1  value: 1845.647 mgc: 725.4111 ustep: 1 
iter: 2  value: 1845.647 mgc: 3.450967e-07 ustep: 1 
iter: 3  mgc: 4.186207e-11 
outer mgc:  0.004468145 
iter: 1  value: 1845.661 mgc: 723.9633 ustep: 1 
iter: 2  value: 1845.661 mgc: 8.399705e-07 ustep: 1 
iter: 3  mgc: 1.63819e-10 
outer mgc:  0.01079103 
iter: 1  value: 1845.652 mgc: 724.6876 ustep: 1 
iter: 2  value: 1845.652 mgc: 8.397331e-07 ustep: 1 
iter: 3  mgc: 1.343381e-10 
outer mgc:  0.01077117 
iter: 1  value: 1845.657 mgc: 1.364404e-05 ustep: 1 
mgc: 1.463574e-10 
outer mgc:  3.405165e-06 
iter: 1  value: 1845.657 mgc: 1.364414e-05 ustep: 1 
mgc: 1.131444e-10 
outer mgc:  3.405601e-06 
iter: 1  value: 1845.655 mgc: 0.002499888 ustep: 1 
iter: 2  value: 1845.655 mgc: 1.34775e-07 ustep: 1 
iter: 3  mgc: 1.573299e-10 
outer mgc:  0.01505237 
iter: 1  value: 1845.659 mgc: 0.00249779 ustep: 1 
iter: 2  value: 1845.659 mgc: 1.344334e-07 ustep: 1 
iter: 3  mgc: 1.080376e-10 
outer mgc:  0.01504899 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:04:07 2021]
Finished job 0.
1 of 1 steps (100%) done

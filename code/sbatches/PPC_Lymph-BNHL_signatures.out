Loading required package: ggplot2
Registered S3 methods overwritten by 'ggplot2':
  method         from 
  [.quosures     rlang
  c.quosures     rlang
  print.quosures rlang
Loading required package: StanHeaders
rstan (Version 2.18.2, GitRev: 2e1f913d3ca3)
For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

Loading required package: coda

Attaching package: ‘coda’

The following object is masked from ‘package:rstan’:

    traceplot

Loading required package: MASS

Attaching package: ‘MASS’

The following object is masked from ‘package:dplyr’:

    select

##
## Markov Chain Monte Carlo Package (MCMCpack)
## Copyright (C) 2003-2020 Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park
##
## Support provided by the U.S. National Science Foundation
## (Grants SES-0350646 and SES-0350613)
##
Warning messages:
1: package ‘MCMCpack’ was built under R version 4.0.1 
2: package ‘coda’ was built under R version 4.0.1 
------------------------------------------------------------------------------
You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)
------------------------------------------------------------------------------

Attaching package: ‘plyr’

The following objects are masked from ‘package:dplyr’:

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize


Attaching package: ‘CompSign’

The following object is masked from ‘package:plyr’:

    summarise

The following object is masked from ‘package:dplyr’:

    summarise

Warning message:
package ‘CompSign’ was built under R version 4.0.1 
[1] "../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData"
[2] "../data/inference/Lymph-BNHL_signatures_20000_DMROO.RData" 
[3] "../data/inference/Lymph-BNHL_signatures_ROO.RData"         
Arguments read[1] "../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData"
[2] "../data/inference/Lymph-BNHL_signatures_20000_DMROO.RData" 
[3] "../data/inference/Lymph-BNHL_signatures_ROO.RData"         
Warning message:
In cbind(`../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData` = c("../data/inference/Lymph-BNHL",  :
  number of rows of result is not a multiple of vector length (arg 3)
     ../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData
[1,] "../data/inference/Lymph-BNHL"                            
[2,] "signatures"                                              
[3,] "20000"                                                   
[4,] "LNMROO.RData"                                            
     ../data/inference/Lymph-BNHL_signatures_20000_DMROO.RData
[1,] "../data/inference/Lymph-BNHL"                           
[2,] "signatures"                                             
[3,] "20000"                                                  
[4,] "DMROO.RData"                                            
     ../data/inference/Lymph-BNHL_signatures_ROO.RData
[1,] "../data/inference/Lymph-BNHL"                   
[2,] "signatures"                                     
[3,] "ROO.RData"                                      
[4,] "../data/inference/Lymph-BNHL"                   
Warning message:
NAs introduced by coercion 
[1] "../data/roo/Lymph-BNHL_signatures_ROO.RDS"
List object objects_sigs_per_CT loaded
[1] "../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData"
Stan model 'stan_LNM_ME' does not contain samples.
[1] "../data/inference/Lymph-BNHL_signatures_20000_DMROO.RData"
Stan model 'stan_DM_ME' does not contain samples.
[1] "../data/inference/Lymph-BNHL_signatures_ROO.RData"
[1] 102
[1] 20000    51
[1] 20000     2    15
[1] 51 16
 [1] "00b9d0e6-69dc-4345-bffd-ce32880c8eef_active"
 [2] "03ad38a6-0902-4aaa-84a3-91ea88fa9883_active"
 [3] "05616329-e7ba-4efd-87b1-d79cd0f7af3d_active"
 [4] "0e7f46ca-6f5c-4538-b6d6-00af65d57fcf_active"
 [5] "140d5fa9-afbe-444e-a7e7-6a4cb4ab2923_active"
 [6] "1b1780d5-06da-40ee-9e15-02631a68027b_active"
 [7] "1d1eeba2-4d7b-4380-b0b6-26d246bc4158_active"
 [8] "22578b9f-78dc-464c-9bb9-382f033283d0_active"
 [9] "28f8d45f-4763-472e-9c4d-6787ba00164b_active"
[10] "2b36ac4b-eed3-4591-8b4f-b44049dfc5ed_active"
[11] "2c3ada8b-9650-4859-9857-43209c0f7cea_active"
[12] "2f0a660c-ba3c-49bb-90f7-39b0034cea82_active"
[13] "3b55c58d-f95a-4a1d-9aa1-8d2c026656a9_active"
[14] "3e7ccab5-5b1d-4147-b907-77cab8f0837e_active"
[15] "3e94aa64-7dd3-4d63-a5de-b4050d3dfafa_active"
[16] "4adc846a-42cb-4ebd-a954-e31eb29d7572_active"
[17] "4d1a4587-adb4-4a65-943e-f19efe8de142_active"
[18] "4de7441f-a609-4a75-9fe7-17a647079ac1_active"
[19] "4e7e6e1f-c648-446f-bdf6-0b1fcc6dfa83_active"
[20] "578ba169-1d2f-4187-b174-082bbc6a5bd2_active"
[21] "626c9788-d70c-449b-b9dc-5e3f6fc00991_active"
[22] "71982a1b-52a4-440f-bd5d-62a0e6cc7fd9_active"
[23] "78bd2aa8-e5f6-4b4b-96f0-d406fbdbcee8_active"
[24] "79e81ab3-5466-4324-9387-2de00d62315c_active"
[25] "81b4dd02-34ec-4ddc-8818-ed888a60ad88_active"
[26] "858631eb-4e91-4aad-809c-c3948519313d_active"
[27] "866ecfe7-caa6-4565-9418-6b9d6c8a3b43_active"
[28] "874f64e9-8a0d-4f88-92c4-7e831842b1d1_active"
[29] "890e840c-1d1d-4874-a8eb-f9d9a2b50a1c_active"
[30] "897a4500-6fb8-4e81-aa07-021a26d632fb_active"
[31] "8ddcf0d9-312f-4055-8984-55d463face34_active"
[32] "8fc11cb6-9d79-41c3-bb45-0dadda890e8d_active"
[33] "9b3e7a03-cf8c-4da8-bc36-20129d7783ba_active"
[34] "9e842227-2bc6-4185-bedb-abeb03836b51_active"
[35] "a29278af-7ecf-403e-b6a9-623ea7879d05_active"
[36] "a31b6123-c1b7-4cd0-86d8-b2e640cce9da_active"
[37] "aa20b9ab-dba9-4002-ad45-cafa2f85cef7_active"
[38] "aa847c3d-d3a7-46aa-a81b-db5099a458fb_active"
[39] "ad0700e2-048a-4856-a77a-bc0b6f25f0e2_active"
[40] "b330c50b-c45f-413d-918f-33275d0d8f91_active"
[41] "b9dbc78e-44ce-427c-bbeb-de8d097bde2c_active"
[42] "bd403458-5154-488b-931a-a7e737a6bf8c_active"
[43] "bd6bd940-ef06-433a-80d9-dca5683e9cd2_active"
[44] "c66926a8-474d-482c-bfb7-043029c8b737_active"
[45] "d31cce9d-1b38-44fd-9378-0d128e12a011_active"
[46] "d6ee68e5-ceb3-4a63-b3bd-e64fe5398102_active"
[47] "e2fa7251-507e-4d76-95a3-a228adc3885a_active"
[48] "ebe0ed67-2d3f-45cd-8f9b-4912595b16a0_active"
[49] "f047cb85-8f88-45d5-83c3-0416c9f3fff7_active"
[50] "f04aecf0-eb12-4ab9-928e-7bcf201b0b40_active"
[51] "f2c08ac1-4755-4c36-a11d-338d8df9fa0d_active"
     ICGC.Donor
170     DO27821
567     DO27835
5167   DO221127
630     DO52674
4008    DO27833
9875   DO222304
621     DO52695
7338    DO27765
1113    DO27775
637     DO27799
2099    DO27857
3181    DO27829
1729    DO52690
7746    DO52652
1018    DO27859
1648    DO52684
1108    DO27763
1760    DO52668
1654    DO52693
4394    DO27769
2096    DO52664
7293    DO52661
1027    DO52658
153     DO52696
566     DO27773
1765    DO52650
836     DO52662
3998    DO27795
1674   DO221124
4570   DO222306
850     DO52673
9987    DO52677
556     DO52663
5107    DO52647
1199   DO222307
173     DO27815
4022    DO27764
5744   DO222303
2112    DO27825
6702    DO27823
1024    DO27855
4558   DO222309
1124    DO27797
665     DO27847
3963    DO52657
172     DO27843
4012   DO221129
578     DO52689
1665    DO52669
1664    DO27781
1688    DO52656
                                                                                                File.Name
170                         00b9d0e6-69dc-4345-bffd-ce32880c8eef.svcp_1-0-4.20150127.somatic.indel.vcf.gz
567                       03ad38a6-0902-4aaa-84a3-91ea88fa9883.svcp_1-0-2.20150121.somatic.snv_mnv.vcf.gz
5167                      05616329-e7ba-4efd-87b1-d79cd0f7af3d.svcp_1-0-5.20150629.somatic.snv_mnv.vcf.gz
630                        0e7f46ca-6f5c-4538-b6d6-00af65d57fcf.consensus.20160830.somatic.snv_mnv.vcf.gz
4008                 140d5fa9-afbe-444e-a7e7-6a4cb4ab2923.broad-mutect-v3.20160222.somatic.snv_mnv.vcf.gz
9875 1b1780d5-06da-40ee-9e15-02631a68027b.dkfz-snvCalling_1-0-132-1-hpc.1508061549.somatic.snv_mnv.vcf.gz
621                   1d1eeba2-4d7b-4380-b0b6-26d246bc4158.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
7338                      22578b9f-78dc-464c-9bb9-382f033283d0.svcp_1-0-5.20150225.somatic.snv_mnv.vcf.gz
1113                         28f8d45f-4763-472e-9c4d-6787ba00164b.consensus.20161006.somatic.indel.vcf.gz
637                        2b36ac4b-eed3-4591-8b4f-b44049dfc5ed.consensus.20160830.somatic.snv_mnv.vcf.gz
2099                  2c3ada8b-9650-4859-9857-43209c0f7cea.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
3181                  2f0a660c-ba3c-49bb-90f7-39b0034cea82.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
1729                        3b55c58d-f95a-4a1d-9aa1-8d2c026656a9.svcp_1-0-5.20150225.somatic.indel.vcf.gz
7746                         3e7ccab5-5b1d-4147-b907-77cab8f0837e.consensus.20161006.somatic.indel.vcf.gz
1018 3e94aa64-7dd3-4d63-a5de-b4050d3dfafa.dkfz-snvCalling_1-0-132-1-hpc.1510121220.somatic.snv_mnv.vcf.gz
1648 4adc846a-42cb-4ebd-a954-e31eb29d7572.dkfz-indelCalling_1-0-132-1-hpc.1509181746.somatic.indel.vcf.gz
1108                         4d1a4587-adb4-4a65-943e-f19efe8de142.consensus.20161006.somatic.indel.vcf.gz
1760                       4de7441f-a609-4a75-9fe7-17a647079ac1.consensus.20160830.somatic.snv_mnv.vcf.gz
1654 4e7e6e1f-c648-446f-bdf6-0b1fcc6dfa83.dkfz-indelCalling_1-0-132-1-hpc.1509181700.somatic.indel.vcf.gz
4394 578ba169-1d2f-4187-b174-082bbc6a5bd2.dkfz-snvCalling_1-0-132-1-hpc.1509181751.somatic.snv_mnv.vcf.gz
2096                      626c9788-d70c-449b-b9dc-5e3f6fc00991.svcp_1-0-4.20150127.somatic.snv_mnv.vcf.gz
7293                     71982a1b-52a4-440f-bd5d-62a0e6cc7fd9.broad-snowman.20151023.somatic.indel.vcf.gz
1027 78bd2aa8-e5f6-4b4b-96f0-d406fbdbcee8.dkfz-snvCalling_1-0-132-1-hpc.1509181934.somatic.snv_mnv.vcf.gz
153                       79e81ab3-5466-4324-9387-2de00d62315c.svcp_1-0-4.20150127.somatic.snv_mnv.vcf.gz
566                   81b4dd02-34ec-4ddc-8818-ed888a60ad88.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
1765                       858631eb-4e91-4aad-809c-c3948519313d.consensus.20160830.somatic.snv_mnv.vcf.gz
836                  866ecfe7-caa6-4565-9418-6b9d6c8a3b43.broad-mutect-v3.20160222.somatic.snv_mnv.vcf.gz
3998                  874f64e9-8a0d-4f88-92c4-7e831842b1d1.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
1674                  890e840c-1d1d-4874-a8eb-f9d9a2b50a1c.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
4570 897a4500-6fb8-4e81-aa07-021a26d632fb.dkfz-snvCalling_1-0-132-1-hpc.1508061549.somatic.snv_mnv.vcf.gz
850                      8ddcf0d9-312f-4055-8984-55d463face34.broad-snowman.20151023.somatic.indel.vcf.gz
9987                 8fc11cb6-9d79-41c3-bb45-0dadda890e8d.broad-mutect-v3.20160222.somatic.snv_mnv.vcf.gz
556                  9b3e7a03-cf8c-4da8-bc36-20129d7783ba.broad-mutect-v3.20160222.somatic.snv_mnv.vcf.gz
5107 9e842227-2bc6-4185-bedb-abeb03836b51.dkfz-indelCalling_1-0-132-1-hpc.1509181750.somatic.indel.vcf.gz
1199 a29278af-7ecf-403e-b6a9-623ea7879d05.dkfz-indelCalling_1-0-132-1-hpc.1508061746.somatic.indel.vcf.gz
173                  a31b6123-c1b7-4cd0-86d8-b2e640cce9da.broad-mutect-v3.20160222.somatic.snv_mnv.vcf.gz
4022                  aa20b9ab-dba9-4002-ad45-cafa2f85cef7.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
5744                      aa847c3d-d3a7-46aa-a81b-db5099a458fb.svcp_1-0-5.20150308.somatic.snv_mnv.vcf.gz
2112                  ad0700e2-048a-4856-a77a-bc0b6f25f0e2.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
6702 b330c50b-c45f-413d-918f-33275d0d8f91.dkfz-snvCalling_1-0-132-1-hpc.1509181843.somatic.snv_mnv.vcf.gz
1024 b9dbc78e-44ce-427c-bbeb-de8d097bde2c.dkfz-indelCalling_1-0-132-1-hpc.1509182002.somatic.indel.vcf.gz
4558 bd403458-5154-488b-931a-a7e737a6bf8c.dkfz-snvCalling_1-0-132-1-hpc.1508061747.somatic.snv_mnv.vcf.gz
1124                       bd6bd940-ef06-433a-80d9-dca5683e9cd2.consensus.20160830.somatic.snv_mnv.vcf.gz
665                        c66926a8-474d-482c-bfb7-043029c8b737.consensus.20160830.somatic.snv_mnv.vcf.gz
3963                        d31cce9d-1b38-44fd-9378-0d128e12a011.svcp_1-0-2.20150121.somatic.indel.vcf.gz
172                      d6ee68e5-ceb3-4a63-b3bd-e64fe5398102.broad-snowman.20151023.somatic.indel.vcf.gz
4012                      e2fa7251-507e-4d76-95a3-a228adc3885a.svcp_1-0-5.20150625.somatic.snv_mnv.vcf.gz
578                        ebe0ed67-2d3f-45cd-8f9b-4912595b16a0.consensus.20160830.somatic.snv_mnv.vcf.gz
1665                      f047cb85-8f88-45d5-83c3-0416c9f3fff7.svcp_1-0-2.20150120.somatic.snv_mnv.vcf.gz
1664 f04aecf0-eb12-4ab9-928e-7bcf201b0b40.dkfz-indelCalling_1-0-132-1-hpc.1509181739.somatic.indel.vcf.gz
1688                  f2c08ac1-4755-4c36-a11d-338d8df9fa0d.MUSE_1-0rc-vcf.20151023.somatic.snv_mnv.vcf.gz
null device 
          1 
Warning message:
In if (is.na(colours)) { :
  the condition has length > 1 and only the first element will be used
$`../data/inference/Lymph-BNHL_signatures_20000_LNMROO.RData`
NULL

$`../data/inference/Lymph-BNHL_signatures_20000_DMROO.RData`
NULL

$`../data/inference/Lymph-BNHL_signatures_ROO.RData`
NULL

Warning messages:
1: In if (length(projected_observed_idx) == 1 & is.na(projected_observed_idx)) { :
  the condition has length > 1 and only the first element will be used
2: In if (length(projected_observed_idx) == 1 & is.na(projected_observed_idx)) { :
  the condition has length > 1 and only the first element will be used
pdf 
  2 
Error in 1:dim(posteriors[[model_idx]]$theta)[3] : argument of length 0
Calls: sapply ... lapply -> FUN -> lapply -> FUN -> lapply -> FUN -> lapply
Execution halted

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:52:17 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.005_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.005_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.005_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4533.972915 
final  value 4274.901477 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 365.9149 mgc: 90.05834 ustep: 1 
iter: 2  value: 323.15 mgc: 23.00777 ustep: 1 
iter: 3  value: 322.7176 mgc: 2.126704 ustep: 1 
iter: 4  value: 322.7173 mgc: 0.07592124 ustep: 1 
iter: 5  value: 322.7173 mgc: 9.354307e-05 ustep: 1 
iter: 6  mgc: 1.529632e-10 
iter: 1  mgc: 1.529632e-10 
Matching hessian patterns... Done
outer mgc:  86.68364 
iter: 1  value: 395.7318 mgc: 36.91713 ustep: 1 
iter: 2  value: 392.0283 mgc: 5.243418 ustep: 1 
iter: 3  value: 392.0269 mgc: 0.109867 ustep: 1 
iter: 4  value: 392.0269 mgc: 8.609494e-05 ustep: 1 
iter: 5  mgc: 7.347994e-11 
iter: 1  value: 306.2388 mgc: 11.83865 ustep: 1 
iter: 2  value: 306.2071 mgc: 0.4862381 ustep: 1 
iter: 3  value: 306.2071 mgc: 0.001338855 ustep: 1 
iter: 4  value: 306.2071 mgc: 1.237705e-08 ustep: 1 
mgc: 1.997708e-14 
iter: 1  mgc: 1.997708e-14 
outer mgc:  19.33162 
iter: 1  value: 299.7609 mgc: 3.905831 ustep: 1 
iter: 2  value: 299.7608 mgc: 0.04004781 ustep: 1 
iter: 3  value: 299.7608 mgc: 5.434733e-06 ustep: 1 
iter: 4  mgc: 7.981393e-13 
iter: 1  value: 297.2111 mgc: 4.458059 ustep: 1 
iter: 2  value: 297.2109 mgc: 0.05228684 ustep: 1 
iter: 3  value: 297.2109 mgc: 1.095535e-05 ustep: 1 
iter: 4  mgc: 1.0691e-11 
iter: 1  mgc: 1.0691e-11 
outer mgc:  50.12926 
iter: 1  value: 303.0466 mgc: 45.60684 ustep: 1 
iter: 2  value: 279.9213 mgc: 13.27308 ustep: 1 
iter: 3  value: 279.8876 mgc: 0.7205274 ustep: 1 
iter: 4  value: 279.8876 mgc: 0.002993225 ustep: 1 
iter: 5  value: 279.8876 mgc: 5.560733e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  50.44237 
iter: 1  value: 283.2833 mgc: 32.70516 ustep: 1 
iter: 2  value: 281.6817 mgc: 3.250925 ustep: 1 
iter: 3  value: 281.681 mgc: 0.06439275 ustep: 1 
iter: 4  value: 281.681 mgc: 8.179244e-05 ustep: 1 
iter: 5  mgc: 1.224585e-10 
iter: 1  value: 274.4375 mgc: 30.55484 ustep: 1 
iter: 2  value: 273.994 mgc: 2.223852 ustep: 1 
iter: 3  value: 273.994 mgc: 0.03378024 ustep: 1 
iter: 4  value: 273.994 mgc: 8.243952e-06 ustep: 1 
iter: 5  mgc: 5.009326e-13 
iter: 1  mgc: 5.009326e-13 
outer mgc:  45.78871 
iter: 1  value: 278.0522 mgc: 40.08173 ustep: 1 
iter: 2  value: 276.2565 mgc: 5.065283 ustep: 1 
iter: 3  value: 276.2563 mgc: 0.07285124 ustep: 1 
iter: 4  value: 276.2563 mgc: 2.682494e-05 ustep: 1 
iter: 5  mgc: 3.656353e-12 
iter: 1  value: 268.0529 mgc: 17.85988 ustep: 1 
iter: 2  value: 267.9035 mgc: 1.057992 ustep: 1 
iter: 3  value: 267.9035 mgc: 0.005336853 ustep: 1 
iter: 4  value: 267.9035 mgc: 1.634449e-07 ustep: 1 
mgc: 2.375877e-14 
iter: 1  mgc: 2.375877e-14 
outer mgc:  34.20616 
iter: 1  value: 261.3926 mgc: 5.388029 ustep: 1 
iter: 2  value: 261.3909 mgc: 0.08828446 ustep: 1 
iter: 3  value: 261.3909 mgc: 9.930887e-05 ustep: 1 
iter: 4  mgc: 2.914748e-10 
iter: 1  mgc: 2.914748e-10 
outer mgc:  10.05627 
iter: 1  value: 260.6158 mgc: 13.33389 ustep: 1 
iter: 2  value: 260.6071 mgc: 0.3800067 ustep: 1 
iter: 3  value: 260.6071 mgc: 0.0004963884 ustep: 1 
iter: 4  value: 260.6071 mgc: 1.201809e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  30.27741 
iter: 1  value: 257.7524 mgc: 9.177818 ustep: 1 
iter: 2  value: 257.7475 mgc: 0.1661173 ustep: 1 
iter: 3  value: 257.7475 mgc: 0.0001297232 ustep: 1 
iter: 4  mgc: 8.115775e-11 
iter: 1  mgc: 8.115775e-11 
outer mgc:  13.09442 
iter: 1  value: 255.9128 mgc: 2.534221 ustep: 1 
iter: 2  value: 255.9128 mgc: 0.01460492 ustep: 1 
iter: 3  value: 255.9128 mgc: 9.729593e-06 ustep: 1 
iter: 4  mgc: 3.95739e-12 
iter: 1  mgc: 3.95739e-12 
outer mgc:  5.598012 
iter: 1  value: 255.0596 mgc: 4.776837 ustep: 1 
iter: 2  value: 255.0593 mgc: 0.05262401 ustep: 1 
iter: 3  value: 255.0593 mgc: 9.994137e-06 ustep: 1 
iter: 4  mgc: 4.623857e-12 
iter: 1  mgc: 4.623857e-12 
outer mgc:  13.27962 
iter: 1  value: 254.49 mgc: 6.630893 ustep: 1 
iter: 2  value: 254.4884 mgc: 0.08581068 ustep: 1 
iter: 3  value: 254.4884 mgc: 6.756455e-05 ustep: 1 
iter: 4  mgc: 7.779111e-11 
iter: 1  mgc: 7.779111e-11 
outer mgc:  7.181259 
iter: 1  value: 253.924 mgc: 3.722547 ustep: 1 
iter: 2  value: 253.924 mgc: 0.02347995 ustep: 1 
iter: 3  value: 253.924 mgc: 1.817986e-06 ustep: 1 
iter: 4  mgc: 6.750156e-14 
iter: 1  mgc: 6.750156e-14 
outer mgc:  7.620855 
iter: 1  value: 255.2516 mgc: 3.112013 ustep: 1 
iter: 2  value: 255.2516 mgc: 0.03088409 ustep: 1 
iter: 3  value: 255.2516 mgc: 4.362967e-06 ustep: 1 
iter: 4  mgc: 8.348877e-14 
iter: 1  value: 253.7215 mgc: 0.8177667 ustep: 1 
iter: 2  value: 253.7215 mgc: 0.002179467 ustep: 1 
iter: 3  value: 253.7215 mgc: 2.093571e-08 ustep: 1 
mgc: 1.70107e-14 
iter: 1  mgc: 1.70107e-14 
outer mgc:  4.813284 
iter: 1  value: 253.6195 mgc: 2.143829 ustep: 1 
iter: 2  value: 253.6195 mgc: 0.008516029 ustep: 1 
iter: 3  value: 253.6195 mgc: 2.130506e-07 ustep: 1 
mgc: 2.389755e-14 
iter: 1  mgc: 2.389755e-14 
outer mgc:  6.293238 
iter: 1  value: 253.4155 mgc: 1.364643 ustep: 1 
iter: 2  value: 253.4155 mgc: 0.00212502 ustep: 1 
iter: 3  value: 253.4155 mgc: 2.540557e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  1.651477 
iter: 1  value: 253.328 mgc: 0.8436965 ustep: 1 
iter: 2  value: 253.328 mgc: 0.0008387726 ustep: 1 
iter: 3  mgc: 1.938796e-09 
iter: 1  mgc: 1.938796e-09 
outer mgc:  1.919531 
iter: 1  value: 253.1641 mgc: 0.6108687 ustep: 1 
iter: 2  value: 253.1641 mgc: 0.001558093 ustep: 1 
iter: 3  value: 253.1641 mgc: 2.211593e-08 ustep: 1 
mgc: 1.776357e-14 
iter: 1  mgc: 1.776357e-14 
outer mgc:  1.913547 
iter: 1  value: 253.6138 mgc: 4.79775 ustep: 1 
iter: 2  value: 253.6137 mgc: 0.0353574 ustep: 1 
iter: 3  value: 253.6137 mgc: 2.187766e-06 ustep: 1 
iter: 4  mgc: 1.965095e-14 
iter: 1  value: 253.1236 mgc: 0.6218079 ustep: 1 
iter: 2  value: 253.1236 mgc: 0.000661264 ustep: 1 
iter: 3  mgc: 7.861041e-10 
iter: 1  mgc: 7.861041e-10 
outer mgc:  1.808402 
iter: 1  value: 253.0976 mgc: 0.4454952 ustep: 1 
iter: 2  value: 253.0976 mgc: 0.0002104962 ustep: 1 
iter: 3  mgc: 1.471241e-10 
iter: 1  mgc: 1.471241e-10 
outer mgc:  1.437999 
iter: 1  value: 253.0613 mgc: 0.3618215 ustep: 1 
iter: 2  value: 253.0613 mgc: 0.0002188707 ustep: 1 
iter: 3  mgc: 1.225823e-10 
iter: 1  value: 253.041 mgc: 0.1128082 ustep: 1 
iter: 2  value: 253.041 mgc: 2.976706e-05 ustep: 1 
iter: 3  mgc: 6.226575e-12 
iter: 1  value: 252.9854 mgc: 0.3998667 ustep: 1 
iter: 2  value: 252.9854 mgc: 0.0003820426 ustep: 1 
iter: 3  mgc: 1.032347e-09 
iter: 1  mgc: 1.032347e-09 
outer mgc:  1.061508 
iter: 1  value: 252.608 mgc: 1.725569 ustep: 1 
iter: 2  value: 252.608 mgc: 0.005842508 ustep: 1 
iter: 3  value: 252.608 mgc: 3.88477e-07 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  3.158326 
iter: 1  value: 252.3703 mgc: 1.311082 ustep: 1 
iter: 2  value: 252.3703 mgc: 0.003407358 ustep: 1 
iter: 3  value: 252.3703 mgc: 5.01519e-08 ustep: 1 
mgc: 3.408385e-14 
iter: 1  mgc: 3.408385e-14 
outer mgc:  2.401832 
iter: 1  value: 252.2364 mgc: 2.664194 ustep: 1 
iter: 2  value: 252.2357 mgc: 0.03535413 ustep: 1 
iter: 3  value: 252.2357 mgc: 2.267062e-05 ustep: 1 
iter: 4  mgc: 9.641177e-12 
iter: 1  value: 252.2944 mgc: 0.694914 ustep: 1 
iter: 2  value: 252.2943 mgc: 0.003285037 ustep: 1 
iter: 3  value: 252.2943 mgc: 1.198812e-07 ustep: 1 
iter: 4  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.6535921 
iter: 1  value: 252.4518 mgc: 0.4448385 ustep: 1 
iter: 2  value: 252.4518 mgc: 0.001060195 ustep: 1 
iter: 3  value: 252.4518 mgc: 4.341123e-08 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.7614833 
iter: 1  value: 252.4196 mgc: 0.4811125 ustep: 1 
iter: 2  value: 252.4196 mgc: 0.0004983861 ustep: 1 
iter: 3  mgc: 2.077566e-09 
iter: 1  mgc: 2.077566e-09 
outer mgc:  0.2890903 
iter: 1  value: 252.3994 mgc: 0.1324832 ustep: 1 
iter: 2  value: 252.3994 mgc: 2.381386e-05 ustep: 1 
iter: 3  mgc: 1.043254e-11 
iter: 1  mgc: 1.043254e-11 
outer mgc:  0.07936992 
iter: 1  value: 252.4044 mgc: 0.05352168 ustep: 1 
iter: 2  value: 252.4044 mgc: 4.901707e-06 ustep: 1 
iter: 3  mgc: 5.151435e-14 
iter: 1  mgc: 5.151435e-14 
outer mgc:  0.03740463 
iter: 1  value: 252.4055 mgc: 0.01169555 ustep: 1 
iter: 2  value: 252.4055 mgc: 4.94423e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.00978576 
iter: 1  value: 252.4048 mgc: 0.002973264 ustep: 1 
iter: 2  mgc: 7.505841e-09 
iter: 1  mgc: 7.505841e-09 
outer mgc:  0.001124496 
iter: 1  value: 252.4049 mgc: 0.0003651481 ustep: 1 
iter: 2  mgc: 1.968434e-10 
iter: 1  mgc: 1.968434e-10 
outer mgc:  3.918864e-05 
iter: 1  mgc: 1.968434e-10 
iter: 1  mgc: 1.968434e-10 
outer mgc:  3.918864e-05 
iter: 1  value: 252.4049 mgc: 0.05133262 ustep: 1 
iter: 2  value: 252.4049 mgc: 5.219725e-06 ustep: 1 
iter: 3  mgc: 7.172041e-14 
outer mgc:  0.2570383 
iter: 1  value: 252.4052 mgc: 0.05131722 ustep: 1 
iter: 2  value: 252.4052 mgc: 5.225111e-06 ustep: 1 
iter: 3  mgc: 7.799317e-14 
outer mgc:  0.2570412 
iter: 1  value: 252.4049 mgc: 0.02586417 ustep: 1 
iter: 2  value: 252.4049 mgc: 1.465365e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.2722144 
iter: 1  value: 252.4052 mgc: 0.02585432 ustep: 1 
iter: 2  value: 252.4052 mgc: 1.46547e-06 ustep: 1 
iter: 3  mgc: 1.865175e-14 
outer mgc:  0.2722107 
iter: 1  value: 252.4055 mgc: 0.0574443 ustep: 1 
iter: 2  value: 252.4055 mgc: 3.812408e-06 ustep: 1 
iter: 3  mgc: 8.704149e-14 
outer mgc:  0.2134122 
iter: 1  value: 252.4046 mgc: 0.05743625 ustep: 1 
iter: 2  value: 252.4046 mgc: 3.80262e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.2134363 
iter: 1  value: 252.4055 mgc: 0.0302277 ustep: 1 
iter: 2  value: 252.4055 mgc: 9.165554e-07 ustep: 1 
iter: 3  mgc: 2.384898e-14 
outer mgc:  0.3008704 
iter: 1  value: 252.4047 mgc: 0.03022375 ustep: 1 
iter: 2  value: 252.4047 mgc: 9.172936e-07 ustep: 1 
iter: 3  mgc: 4.48825e-14 
outer mgc:  0.3008537 
iter: 1  value: 252.4026 mgc: 0.006383586 ustep: 1 
iter: 2  value: 252.4026 mgc: 6.531655e-08 ustep: 1 
mgc: 1.687539e-14 
outer mgc:  0.004212126 
iter: 1  value: 252.4072 mgc: 0.006380922 ustep: 1 
iter: 2  value: 252.4072 mgc: 6.532389e-08 ustep: 1 
mgc: 3.056756e-14 
outer mgc:  0.004134379 
iter: 1  value: 252.4108 mgc: 0.03075013 ustep: 1 
iter: 2  value: 252.4108 mgc: 2.422345e-06 ustep: 1 
iter: 3  mgc: 3.190026e-14 
outer mgc:  0.09199584 
iter: 1  value: 252.3991 mgc: 0.03083453 ustep: 1 
iter: 2  value: 252.3991 mgc: 2.437101e-06 ustep: 1 
iter: 3  mgc: 2.644066e-14 
outer mgc:  0.09196421 
iter: 1  value: 252.4074 mgc: 0.02279775 ustep: 1 
iter: 2  value: 252.4074 mgc: 8.004146e-07 ustep: 1 
iter: 3  mgc: 1.576517e-14 
outer mgc:  0.1048792 
iter: 1  value: 252.4025 mgc: 0.02282056 ustep: 1 
iter: 2  value: 252.4025 mgc: 8.005686e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.1051315 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:52:19 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:04:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21877.765117 
iter  10 value 19433.985931
iter  10 value 19433.985931
final  value 19433.985931 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 10706.29 mgc: 99.28541 ustep: 1 
iter: 2  value: 10264 mgc: 45.10297 ustep: 1 
iter: 3  value: 10089.53 mgc: 95.9709 ustep: 1 
iter: 4  value: 10086.68 mgc: 7.072648 ustep: 1 
iter: 5  value: 10086.55 mgc: 2.19659 ustep: 1 
iter: 6  value: 10086.55 mgc: 0.09683566 ustep: 1 
iter: 7  value: 10086.55 mgc: 0.0002161027 ustep: 1 
iter: 8  mgc: 1.083492e-09 
iter: 1  mgc: 1.083492e-09 
Matching hessian patterns... Done
outer mgc:  3896.248 
iter: 1  value: 6494.715 mgc: 32.55114 ustep: 1 
iter: 2  value: 6479.022 mgc: 13.3485 ustep: 1 
iter: 3  value: 6478.978 mgc: 1.110871 ustep: 1 
iter: 4  value: 6478.978 mgc: 0.01133312 ustep: 1 
iter: 5  value: 6478.978 mgc: 1.232808e-06 ustep: 1 
iter: 6  mgc: 3.524958e-14 
iter: 1  value: 4172.025 mgc: 74.60163 ustep: 1 
iter: 2  value: 3793.52 mgc: 42.38255 ustep: 1 
iter: 3  value: 3791.131 mgc: 4.804517 ustep: 1 
iter: 4  value: 3791.13 mgc: 0.1938953 ustep: 1 
iter: 5  value: 3791.13 mgc: 0.0002102244 ustep: 1 
iter: 6  mgc: 3.894798e-10 
iter: 1  mgc: 3.894798e-10 
outer mgc:  1517.151 
iter: 1  value: 3702.427 mgc: 79.80306 ustep: 1 
iter: 2  value: 2897.605 mgc: 77.78124 ustep: 1 
iter: 3  value: 2885.736 mgc: 26.55555 ustep: 1 
iter: 4  value: 2885.592 mgc: 3.617945 ustep: 1 
iter: 5  value: 2885.592 mgc: 0.02885439 ustep: 1 
iter: 6  value: 2885.592 mgc: 1.175042e-06 ustep: 1 
iter: 7  mgc: 4.382952e-14 
iter: 1  mgc: 4.382952e-14 
outer mgc:  1148.466 
iter: 1  value: 4926.976 mgc: 60.80984 ustep: 1 
iter: 2  value: 4726.253 mgc: 21.10055 ustep: 1 
iter: 3  value: 4725.149 mgc: 2.182122 ustep: 1 
iter: 4  value: 4725.149 mgc: 0.03987411 ustep: 1 
iter: 5  value: 4725.149 mgc: 2.66021e-05 ustep: 1 
iter: 6  mgc: 1.189626e-11 
iter: 1  value: 2271.098 mgc: 46.22833 ustep: 1 
iter: 2  value: 2082.192 mgc: 21.0409 ustep: 1 
iter: 3  value: 2080.515 mgc: 2.720832 ustep: 1 
iter: 4  value: 2080.514 mgc: 0.1231896 ustep: 1 
iter: 5  value: 2080.514 mgc: 0.0002913565 ustep: 1 
iter: 6  mgc: 1.641618e-09 
iter: 1  mgc: 1.641618e-09 
outer mgc:  222.3241 
iter: 1  value: 2040.249 mgc: 44.09611 ustep: 1 
iter: 2  value: 2007.115 mgc: 10.97358 ustep: 1 
iter: 3  value: 2007.092 mgc: 0.6212139 ustep: 1 
iter: 4  value: 2007.092 mgc: 0.00289109 ustep: 1 
iter: 5  value: 2007.092 mgc: 6.385654e-08 ustep: 1 
mgc: 3.630429e-14 
iter: 1  mgc: 3.630429e-14 
outer mgc:  191.018 
iter: 1  value: 2046.22 mgc: 26.9216 ustep: 1 
iter: 2  value: 2045.234 mgc: 1.885827 ustep: 1 
iter: 3  value: 2045.234 mgc: 0.0169468 ustep: 1 
iter: 4  value: 2045.234 mgc: 2.873877e-06 ustep: 1 
iter: 5  mgc: 1.003642e-13 
iter: 1  value: 1996.547 mgc: 23.67884 ustep: 1 
iter: 2  value: 1995.305 mgc: 1.631132 ustep: 1 
iter: 3  value: 1995.305 mgc: 0.01705756 ustep: 1 
iter: 4  value: 1995.305 mgc: 2.455875e-06 ustep: 1 
iter: 5  mgc: 5.684342e-14 
iter: 1  mgc: 5.684342e-14 
outer mgc:  232.1477 
iter: 1  value: 1975.049 mgc: 28.23453 ustep: 1 
iter: 2  value: 1969.655 mgc: 4.895319 ustep: 1 
iter: 3  value: 1969.654 mgc: 0.1352862 ustep: 1 
iter: 4  value: 1969.654 mgc: 0.0001169184 ustep: 1 
iter: 5  mgc: 8.773204e-11 
iter: 1  mgc: 8.773204e-11 
outer mgc:  204.3556 
iter: 1  value: 1941.17 mgc: 18.05234 ustep: 1 
iter: 2  value: 1939.869 mgc: 1.535123 ustep: 1 
iter: 3  value: 1939.869 mgc: 0.03097908 ustep: 1 
iter: 4  value: 1939.869 mgc: 1.459434e-05 ustep: 1 
iter: 5  mgc: 3.239187e-12 
iter: 1  mgc: 3.239187e-12 
outer mgc:  20.41012 
iter: 1  value: 1975.984 mgc: 13.36898 ustep: 1 
iter: 2  value: 1975.874 mgc: 1.024009 ustep: 1 
iter: 3  value: 1975.874 mgc: 0.004357545 ustep: 1 
iter: 4  value: 1975.874 mgc: 1.161239e-07 ustep: 1 
iter: 5  mgc: 3.330669e-14 
iter: 1  value: 1938.762 mgc: 2.997596 ustep: 1 
iter: 2  value: 1938.761 mgc: 0.03065854 ustep: 1 
iter: 3  value: 1938.761 mgc: 5.892857e-06 ustep: 1 
iter: 4  mgc: 3.552714e-13 
iter: 1  mgc: 3.552714e-13 
outer mgc:  26.19601 
iter: 1  value: 1939.033 mgc: 3.150906 ustep: 1 
iter: 2  value: 1939.033 mgc: 0.04152913 ustep: 1 
iter: 3  value: 1939.033 mgc: 1.304922e-05 ustep: 1 
iter: 4  mgc: 1.588951e-12 
iter: 1  value: 1938.754 mgc: 2.08176 ustep: 1 
iter: 2  value: 1938.754 mgc: 0.01289123 ustep: 1 
iter: 3  value: 1938.754 mgc: 1.348149e-06 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  27.0227 
iter: 1  value: 1938.135 mgc: 1.21057 ustep: 1 
iter: 2  value: 1938.135 mgc: 0.004330686 ustep: 1 
iter: 3  value: 1938.135 mgc: 1.157323e-07 ustep: 1 
iter: 4  mgc: 4.13003e-14 
iter: 1  mgc: 4.13003e-14 
outer mgc:  5.027279 
iter: 1  value: 1937.433 mgc: 0.6263703 ustep: 1 
iter: 2  value: 1937.433 mgc: 0.001693334 ustep: 1 
iter: 3  value: 1937.433 mgc: 1.732833e-08 ustep: 1 
mgc: 3.191891e-14 
iter: 1  mgc: 3.191891e-14 
outer mgc:  4.423687 
iter: 1  value: 1937.443 mgc: 1.615368 ustep: 1 
iter: 2  value: 1937.443 mgc: 0.009982416 ustep: 1 
iter: 3  value: 1937.443 mgc: 7.418589e-07 ustep: 1 
iter: 4  mgc: 4.884981e-14 
iter: 1  value: 1937.531 mgc: 0.8042064 ustep: 1 
iter: 2  value: 1937.531 mgc: 0.001881885 ustep: 1 
iter: 3  value: 1937.531 mgc: 2.799588e-08 ustep: 1 
mgc: 3.408385e-14 
iter: 1  value: 1937.431 mgc: 0.23766 ustep: 1 
iter: 2  value: 1937.431 mgc: 0.0001637183 ustep: 1 
iter: 3  mgc: 2.118328e-10 
iter: 1  mgc: 2.118328e-10 
outer mgc:  1.92445 
iter: 1  value: 1937.392 mgc: 0.04437777 ustep: 1 
iter: 2  value: 1937.392 mgc: 1.187297e-05 ustep: 1 
iter: 3  mgc: 8.224532e-13 
iter: 1  mgc: 8.224532e-13 
outer mgc:  1.793077 
iter: 1  value: 1937.382 mgc: 0.1452833 ustep: 1 
iter: 2  value: 1937.382 mgc: 7.737312e-05 ustep: 1 
iter: 3  mgc: 5.012613e-11 
iter: 1  mgc: 5.012613e-11 
outer mgc:  2.746363 
iter: 1  value: 1937.353 mgc: 0.3643904 ustep: 1 
iter: 2  value: 1937.353 mgc: 0.0003656391 ustep: 1 
iter: 3  mgc: 6.351861e-10 
iter: 1  mgc: 6.351861e-10 
outer mgc:  1.940914 
iter: 1  value: 1937.351 mgc: 0.4704092 ustep: 1 
iter: 2  value: 1937.351 mgc: 0.000762799 ustep: 1 
iter: 3  mgc: 4.35048e-09 
iter: 1  mgc: 4.35048e-09 
outer mgc:  1.550179 
iter: 1  value: 1937.268 mgc: 0.2737254 ustep: 1 
iter: 2  value: 1937.268 mgc: 0.0002330551 ustep: 1 
iter: 3  mgc: 2.225398e-10 
iter: 1  mgc: 2.225398e-10 
outer mgc:  2.037216 
iter: 1  value: 1937.259 mgc: 0.5759487 ustep: 1 
iter: 2  value: 1937.259 mgc: 0.0007148406 ustep: 1 
iter: 3  mgc: 2.319843e-09 
iter: 1  value: 1937.248 mgc: 0.2797415 ustep: 1 
iter: 2  value: 1937.248 mgc: 0.0001325486 ustep: 1 
iter: 3  mgc: 1.157616e-10 
iter: 1  mgc: 1.157616e-10 
outer mgc:  3.063923 
iter: 1  value: 1937.285 mgc: 0.1884452 ustep: 1 
iter: 2  value: 1937.285 mgc: 0.0001256634 ustep: 1 
iter: 3  mgc: 9.452794e-11 
iter: 1  value: 1937.261 mgc: 0.1864861 ustep: 1 
iter: 2  value: 1937.261 mgc: 8.56118e-05 ustep: 1 
iter: 3  mgc: 5.375878e-11 
iter: 1  mgc: 5.375878e-11 
outer mgc:  1.604145 
iter: 1  value: 1937.259 mgc: 0.1134614 ustep: 1 
iter: 2  value: 1937.259 mgc: 3.720481e-05 ustep: 1 
iter: 3  mgc: 1.346523e-11 
iter: 1  mgc: 1.346523e-11 
outer mgc:  0.5080408 
iter: 1  value: 1937.253 mgc: 0.1210057 ustep: 1 
iter: 2  value: 1937.253 mgc: 5.51963e-05 ustep: 1 
iter: 3  mgc: 2.263878e-11 
iter: 1  mgc: 2.263878e-11 
outer mgc:  0.9492995 
iter: 1  value: 1937.245 mgc: 0.1133189 ustep: 1 
iter: 2  value: 1937.245 mgc: 3.486229e-05 ustep: 1 
iter: 3  mgc: 5.583978e-12 
iter: 1  mgc: 5.583978e-12 
outer mgc:  0.5886556 
iter: 1  value: 1937.227 mgc: 0.1270904 ustep: 1 
iter: 2  value: 1937.227 mgc: 0.0001205269 ustep: 1 
iter: 3  mgc: 2.132823e-10 
iter: 1  value: 1937.24 mgc: 0.01589387 ustep: 1 
iter: 2  value: 1937.24 mgc: 1.885673e-06 ustep: 1 
iter: 3  mgc: 6.261658e-14 
iter: 1  mgc: 6.261658e-14 
outer mgc:  0.3858793 
iter: 1  value: 1937.242 mgc: 0.03437469 ustep: 1 
iter: 2  value: 1937.242 mgc: 3.009683e-06 ustep: 1 
iter: 3  mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  0.329855 
iter: 1  value: 1937.24 mgc: 0.04687732 ustep: 1 
iter: 2  value: 1937.24 mgc: 7.07201e-06 ustep: 1 
iter: 3  mgc: 4.400924e-13 
iter: 1  mgc: 4.400924e-13 
outer mgc:  0.2509485 
iter: 1  value: 1937.236 mgc: 0.05579608 ustep: 1 
iter: 2  value: 1937.236 mgc: 1.423228e-05 ustep: 1 
iter: 3  mgc: 2.905232e-12 
iter: 1  mgc: 2.905232e-12 
outer mgc:  0.2744557 
iter: 1  value: 1937.234 mgc: 0.04945533 ustep: 1 
iter: 2  value: 1937.234 mgc: 6.503358e-06 ustep: 1 
iter: 3  mgc: 1.44329e-13 
iter: 1  mgc: 1.44329e-13 
outer mgc:  0.6666618 
iter: 1  value: 1937.234 mgc: 0.04530591 ustep: 1 
iter: 2  value: 1937.234 mgc: 6.864298e-06 ustep: 1 
iter: 3  mgc: 6.541434e-13 
iter: 1  mgc: 6.541434e-13 
outer mgc:  0.356602 
iter: 1  value: 1937.215 mgc: 0.03306631 ustep: 1 
iter: 2  value: 1937.215 mgc: 2.337356e-06 ustep: 1 
iter: 3  mgc: 8.437695e-14 
iter: 1  value: 1937.225 mgc: 0.02460917 ustep: 1 
iter: 2  value: 1937.225 mgc: 1.06392e-06 ustep: 1 
iter: 3  mgc: 4.440892e-14 
iter: 1  value: 1937.229 mgc: 0.02191907 ustep: 1 
iter: 2  value: 1937.229 mgc: 1.030195e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  0.3996277 
iter: 1  value: 1937.228 mgc: 0.02117231 ustep: 1 
iter: 2  value: 1937.228 mgc: 1.281633e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  0.05397704 
iter: 1  value: 1937.224 mgc: 0.005693647 ustep: 1 
iter: 2  value: 1937.224 mgc: 7.619304e-08 ustep: 1 
iter: 3  mgc: 4.751755e-14 
iter: 1  mgc: 4.751755e-14 
outer mgc:  0.07725682 
iter: 1  value: 1937.223 mgc: 0.008764333 ustep: 1 
iter: 2  value: 1937.223 mgc: 2.226384e-07 ustep: 1 
iter: 3  mgc: 3.574918e-14 
iter: 1  value: 1937.224 mgc: 0.004451865 ustep: 1 
iter: 2  value: 1937.224 mgc: 5.273167e-08 ustep: 1 
mgc: 3.075318e-14 
iter: 1  mgc: 3.075318e-14 
outer mgc:  0.02507057 
iter: 1  value: 1937.223 mgc: 0.003631395 ustep: 1 
iter: 2  value: 1937.223 mgc: 7.582839e-08 ustep: 1 
iter: 3  mgc: 3.452794e-14 
iter: 1  mgc: 3.452794e-14 
outer mgc:  0.04809008 
iter: 1  value: 1937.223 mgc: 0.001352769 ustep: 1 
iter: 2  mgc: 7.549493e-09 
iter: 1  mgc: 7.549493e-09 
outer mgc:  0.003584343 
iter: 1  value: 1937.223 mgc: 0.0008668637 ustep: 1 
iter: 2  mgc: 2.235699e-09 
iter: 1  mgc: 2.235699e-09 
outer mgc:  0.002426435 
iter: 1  mgc: 2.235699e-09 
iter: 1  mgc: 2.235699e-09 
outer mgc:  0.002426435 
iter: 1  value: 1937.223 mgc: 0.05538976 ustep: 1 
iter: 2  value: 1937.223 mgc: 8.409503e-06 ustep: 1 
iter: 3  mgc: 5.586642e-13 
outer mgc:  0.3339101 
iter: 1  value: 1937.224 mgc: 0.05538204 ustep: 1 
iter: 2  value: 1937.224 mgc: 8.42016e-06 ustep: 1 
iter: 3  mgc: 5.488943e-13 
outer mgc:  0.336809 
iter: 1  value: 1937.223 mgc: 0.02899723 ustep: 1 
iter: 2  value: 1937.223 mgc: 2.912858e-06 ustep: 1 
iter: 3  mgc: 1.185718e-13 
outer mgc:  0.9811744 
iter: 1  value: 1937.224 mgc: 0.0289975 ustep: 1 
iter: 2  value: 1937.224 mgc: 2.914914e-06 ustep: 1 
iter: 3  mgc: 1.185718e-13 
outer mgc:  0.9859958 
iter: 1  value: 1937.224 mgc: 0.05027822 ustep: 1 
iter: 2  value: 1937.224 mgc: 6.144216e-06 ustep: 1 
iter: 3  mgc: 2.149392e-13 
outer mgc:  0.3586318 
iter: 1  value: 1937.222 mgc: 0.0502787 ustep: 1 
iter: 2  value: 1937.222 mgc: 6.15067e-06 ustep: 1 
iter: 3  mgc: 2.14051e-13 
outer mgc:  0.3543228 
iter: 1  value: 1937.231 mgc: 0.02903338 ustep: 1 
iter: 2  value: 1937.231 mgc: 3.527055e-06 ustep: 1 
iter: 3  mgc: 7.993606e-14 
outer mgc:  1.015522 
iter: 1  value: 1937.217 mgc: 0.02903788 ustep: 1 
iter: 2  value: 1937.217 mgc: 3.53116e-06 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  1.01178 
iter: 1  value: 1937.218 mgc: 0.004556142 ustep: 1 
iter: 2  value: 1937.218 mgc: 2.011535e-07 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.04002009 
iter: 1  value: 1937.229 mgc: 0.004553167 ustep: 1 
iter: 2  value: 1937.229 mgc: 2.01003e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.04047593 
iter: 1  value: 1937.232 mgc: 0.01287106 ustep: 1 
iter: 2  value: 1937.232 mgc: 2.303855e-06 ustep: 1 
iter: 3  mgc: 7.327472e-14 
outer mgc:  0.3659063 
iter: 1  value: 1937.215 mgc: 0.01290381 ustep: 1 
iter: 2  value: 1937.215 mgc: 2.313275e-06 ustep: 1 
iter: 3  mgc: 7.860379e-14 
outer mgc:  0.3640121 
iter: 1  value: 1937.232 mgc: 0.01193511 ustep: 1 
iter: 2  value: 1937.232 mgc: 5.85816e-07 ustep: 1 
iter: 3  mgc: 3.830269e-14 
outer mgc:  0.367024 
iter: 1  value: 1937.215 mgc: 0.0119657 ustep: 1 
iter: 2  value: 1937.215 mgc: 5.863716e-07 ustep: 1 
iter: 3  mgc: 3.630429e-14 
outer mgc:  0.3665048 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:04:53 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:34:04 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4269.207354 
final  value 3902.073136 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3960.748 mgc: 4.077223 ustep: 0.8994163 
iter: 2  value: 3928.722 mgc: 2.615594 ustep: 0.772724 
iter: 3  value: 3921.239 mgc: 2.434762 ustep: 0.6521695 
iter: 4  value: 3921.12 mgc: 0.310329 ustep: 0.8075894 
iter: 5  value: 3921.118 mgc: 0.04147789 ustep: 0.8986699 
iter: 6  value: 3921.118 mgc: 0.003397007 ustep: 0.9479872 
iter: 7  value: 3921.118 mgc: 0.0001449475 ustep: 0.973649 
iter: 8  value: 3921.118 mgc: 3.148289e-06 ustep: 0.9867379 
iter: 9  value: 3921.118 mgc: 3.445634e-08 ustep: 0.9933475 
iter: 10  mgc: 1.891807e-10 
iter: 1  mgc: 1.891807e-10 
Matching hessian patterns... Done
outer mgc:  29.78669 
iter: 1  value: 3874.415 mgc: 1.521506 ustep: 1 
iter: 2  value: 3874.334 mgc: 0.239017 ustep: 1 
iter: 3  value: 3874.333 mgc: 0.002949747 ustep: 1 
iter: 4  value: 3874.333 mgc: 5.190919e-07 ustep: 1 
iter: 5  mgc: 1.765255e-14 
iter: 1  value: 3818.983 mgc: 20.81524 ustep: 1 
iter: 2  value: 3795.618 mgc: 10.55606 ustep: 1 
iter: 3  value: 3795.52 mgc: 0.7939996 ustep: 1 
iter: 4  value: 3795.52 mgc: 0.007942496 ustep: 1 
iter: 5  value: 3795.52 mgc: 8.363854e-07 ustep: 1 
iter: 6  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  61.27199 
iter: 1  value: 6431.481 mgc: 106.6541 ustep: 1 
iter: 2  value: 6430.905 mgc: 4.925844 ustep: 1 
iter: 3  value: 6430.905 mgc: 0.02296349 ustep: 1 
iter: 4  value: 6430.905 mgc: 2.342993e-06 ustep: 1 
iter: 5  mgc: 2.131628e-13 
iter: 1  value: 3772.638 mgc: 7.321115 ustep: 1 
iter: 2  value: 3772.621 mgc: 0.2315198 ustep: 1 
iter: 3  value: 3772.621 mgc: 0.0006854639 ustep: 1 
iter: 4  mgc: 5.936259e-09 
iter: 1  mgc: 5.936259e-09 
outer mgc:  24.56792 
iter: 1  value: 3764.529 mgc: 1.60821 ustep: 1 
iter: 2  value: 3764.529 mgc: 0.02320579 ustep: 1 
iter: 3  value: 3764.529 mgc: 2.37791e-05 ustep: 1 
iter: 4  mgc: 2.673539e-11 
iter: 1  mgc: 2.673539e-11 
outer mgc:  14.80772 
iter: 1  value: 3768.642 mgc: 6.541301 ustep: 1 
iter: 2  value: 3768.632 mgc: 0.282637 ustep: 1 
iter: 3  value: 3768.632 mgc: 0.0004643659 ustep: 1 
iter: 4  mgc: 1.899853e-09 
iter: 1  value: 3762.882 mgc: 1.92201 ustep: 1 
iter: 2  value: 3762.882 mgc: 0.01912907 ustep: 1 
iter: 3  value: 3762.882 mgc: 3.214606e-06 ustep: 1 
iter: 4  mgc: 9.747758e-14 
iter: 1  mgc: 9.747758e-14 
outer mgc:  9.489593 
iter: 1  value: 3761.152 mgc: 1.956318 ustep: 1 
iter: 2  value: 3761.152 mgc: 0.0211523 ustep: 1 
iter: 3  value: 3761.152 mgc: 4.363391e-06 ustep: 1 
iter: 4  mgc: 8.85958e-14 
iter: 1  mgc: 8.85958e-14 
outer mgc:  10.15372 
iter: 1  value: 3757.452 mgc: 2.269881 ustep: 1 
iter: 2  value: 3757.452 mgc: 0.02748358 ustep: 1 
iter: 3  value: 3757.452 mgc: 5.271974e-06 ustep: 1 
iter: 4  mgc: 1.916245e-13 
iter: 1  mgc: 1.916245e-13 
outer mgc:  10.4462 
iter: 1  value: 3753.917 mgc: 2.935661 ustep: 1 
iter: 2  value: 3753.916 mgc: 0.02110324 ustep: 1 
iter: 3  value: 3753.916 mgc: 8.168161e-06 ustep: 1 
iter: 4  mgc: 2.554401e-12 
iter: 1  mgc: 2.554401e-12 
outer mgc:  8.146435 
iter: 1  value: 3752.188 mgc: 2.205809 ustep: 1 
iter: 2  value: 3752.188 mgc: 0.02685244 ustep: 1 
iter: 3  value: 3752.188 mgc: 3.58549e-06 ustep: 1 
iter: 4  mgc: 5.52336e-14 
iter: 1  mgc: 5.52336e-14 
outer mgc:  6.128642 
iter: 1  value: 3751.101 mgc: 2.735287 ustep: 1 
iter: 2  value: 3751.1 mgc: 0.06010651 ustep: 1 
iter: 3  value: 3751.1 mgc: 1.86539e-05 ustep: 1 
iter: 4  mgc: 1.172484e-11 
iter: 1  mgc: 1.172484e-11 
outer mgc:  5.049802 
iter: 1  value: 3748.977 mgc: 4.178675 ustep: 1 
iter: 2  value: 3748.977 mgc: 0.05793987 ustep: 1 
iter: 3  value: 3748.977 mgc: 1.766079e-05 ustep: 1 
iter: 4  mgc: 1.021183e-12 
iter: 1  mgc: 1.021183e-12 
outer mgc:  7.472601 
iter: 1  value: 3747.231 mgc: 5.513347 ustep: 1 
iter: 2  value: 3747.23 mgc: 0.06654856 ustep: 1 
iter: 3  value: 3747.23 mgc: 1.628984e-05 ustep: 1 
iter: 4  mgc: 1.034595e-11 
iter: 1  mgc: 1.034595e-11 
outer mgc:  9.05866 
iter: 1  value: 3746.466 mgc: 1.982792 ustep: 1 
iter: 2  value: 3746.466 mgc: 0.02544675 ustep: 1 
iter: 3  value: 3746.466 mgc: 6.150364e-06 ustep: 1 
iter: 4  mgc: 1.380229e-12 
iter: 1  mgc: 1.380229e-12 
outer mgc:  10.12891 
iter: 1  value: 3746.901 mgc: 3.875391 ustep: 1 
iter: 2  value: 3746.901 mgc: 0.02529642 ustep: 1 
iter: 3  value: 3746.901 mgc: 6.360957e-06 ustep: 1 
iter: 4  mgc: 1.744382e-12 
iter: 1  value: 3746.416 mgc: 2.717035 ustep: 1 
iter: 2  value: 3746.416 mgc: 0.01145232 ustep: 1 
iter: 3  value: 3746.416 mgc: 2.380303e-07 ustep: 1 
iter: 4  mgc: 1.172396e-13 
iter: 1  mgc: 1.172396e-13 
outer mgc:  12.25051 
iter: 1  value: 3745.927 mgc: 1.378796 ustep: 1 
iter: 2  value: 3745.927 mgc: 0.003823194 ustep: 1 
iter: 3  value: 3745.927 mgc: 4.03957e-08 ustep: 1 
mgc: 1.016964e-13 
iter: 1  mgc: 1.016964e-13 
outer mgc:  1.544542 
iter: 1  value: 3745.67 mgc: 0.6518537 ustep: 1 
iter: 2  value: 3745.67 mgc: 0.00200876 ustep: 1 
iter: 3  value: 3745.67 mgc: 6.857991e-08 ustep: 1 
iter: 4  mgc: 8.082424e-14 
iter: 1  mgc: 8.082424e-14 
outer mgc:  3.020529 
iter: 1  value: 3745.287 mgc: 0.622216 ustep: 1 
iter: 2  value: 3745.287 mgc: 0.0009446557 ustep: 1 
iter: 3  value: 3745.287 mgc: 1.380027e-08 ustep: 1 
mgc: 7.549517e-14 
iter: 1  mgc: 7.549517e-14 
outer mgc:  1.95048 
iter: 1  value: 3744.743 mgc: 0.6113745 ustep: 1 
iter: 2  value: 3744.743 mgc: 0.001051828 ustep: 1 
iter: 3  mgc: 3.530677e-09 
iter: 1  value: 3744.241 mgc: 0.4039174 ustep: 1 
iter: 2  value: 3744.241 mgc: 0.0005199192 ustep: 1 
iter: 3  mgc: 1.601327e-09 
iter: 1  mgc: 1.601327e-09 
outer mgc:  2.837647 
iter: 1  value: 3743.677 mgc: 0.6336726 ustep: 1 
iter: 2  value: 3743.677 mgc: 0.002128554 ustep: 1 
iter: 3  value: 3743.677 mgc: 4.510006e-08 ustep: 1 
mgc: 1.328382e-13 
iter: 1  mgc: 1.328382e-13 
outer mgc:  1.061073 
iter: 1  value: 3742.063 mgc: 1.633653 ustep: 1 
iter: 2  value: 3742.063 mgc: 0.005989445 ustep: 1 
iter: 3  value: 3742.063 mgc: 7.571943e-08 ustep: 1 
mgc: 1.336153e-13 
iter: 1  mgc: 1.336153e-13 
outer mgc:  3.680552 
iter: 1  value: 3741.346 mgc: 1.010371 ustep: 1 
iter: 2  value: 3741.346 mgc: 0.002573352 ustep: 1 
iter: 3  value: 3741.346 mgc: 1.431417e-08 ustep: 1 
mgc: 1.378897e-13 
iter: 1  value: 3739.711 mgc: 2.760923 ustep: 1 
iter: 2  value: 3739.711 mgc: 0.01561875 ustep: 1 
iter: 3  value: 3739.711 mgc: 5.073215e-07 ustep: 1 
iter: 4  mgc: 1.945111e-13 
iter: 1  mgc: 1.945111e-13 
outer mgc:  3.812963 
iter: 1  value: 3739.251 mgc: 4.490487 ustep: 1 
iter: 2  value: 3739.25 mgc: 0.03347635 ustep: 1 
iter: 3  value: 3739.25 mgc: 3.756489e-05 ustep: 1 
iter: 4  mgc: 4.734346e-11 
iter: 1  value: 3739.28 mgc: 3.55641 ustep: 1 
iter: 2  value: 3739.28 mgc: 0.01853296 ustep: 1 
iter: 3  value: 3739.28 mgc: 1.835558e-06 ustep: 1 
iter: 4  mgc: 1.212364e-13 
iter: 1  mgc: 1.212364e-13 
outer mgc:  4.550255 
iter: 1  value: 3737.739 mgc: 2.048302 ustep: 1 
iter: 2  value: 3737.739 mgc: 0.004179861 ustep: 1 
iter: 3  value: 3737.739 mgc: 3.450039e-08 ustep: 1 
mgc: 1.403322e-13 
iter: 1  mgc: 1.403322e-13 
outer mgc:  3.057577 
iter: 1  value: 3737.249 mgc: 2.258078 ustep: 1 
iter: 2  value: 3737.249 mgc: 0.004386341 ustep: 1 
iter: 3  value: 3737.249 mgc: 3.926918e-08 ustep: 1 
mgc: 1.261213e-13 
iter: 1  mgc: 1.261213e-13 
outer mgc:  3.652749 
iter: 1  value: 3736.209 mgc: 2.338165 ustep: 1 
iter: 2  value: 3736.209 mgc: 0.008148946 ustep: 1 
iter: 3  value: 3736.209 mgc: 1.428994e-06 ustep: 1 
iter: 4  mgc: 1.962874e-13 
iter: 1  mgc: 1.962874e-13 
outer mgc:  1.67401 
iter: 1  value: 3735.569 mgc: 0.9055649 ustep: 1 
iter: 2  value: 3735.569 mgc: 0.000975797 ustep: 1 
iter: 3  mgc: 6.467904e-09 
iter: 1  mgc: 6.467904e-09 
outer mgc:  0.620868 
iter: 1  value: 3734.771 mgc: 1.024279 ustep: 1 
iter: 2  value: 3734.771 mgc: 0.001332854 ustep: 1 
iter: 3  mgc: 9.889968e-09 
iter: 1  mgc: 9.889968e-09 
outer mgc:  0.2416524 
iter: 1  value: 3733.249 mgc: 2.051804 ustep: 1 
iter: 2  value: 3733.249 mgc: 0.001632689 ustep: 1 
iter: 3  mgc: 4.519306e-09 
iter: 1  mgc: 4.519306e-09 
outer mgc:  0.3965619 
iter: 1  value: 3732.175 mgc: 1.393687 ustep: 1 
iter: 2  value: 3732.175 mgc: 0.0005892435 ustep: 1 
iter: 3  mgc: 7.030589e-10 
iter: 1  mgc: 7.030589e-10 
outer mgc:  0.1239144 
iter: 1  value: 3731.298 mgc: 1.112156 ustep: 1 
iter: 2  value: 3731.298 mgc: 0.0004448084 ustep: 1 
iter: 3  mgc: 2.009877e-10 
iter: 1  mgc: 2.009877e-10 
outer mgc:  0.03310518 
iter: 1  value: 3730.846 mgc: 0.5634117 ustep: 1 
iter: 2  value: 3730.846 mgc: 7.396721e-05 ustep: 1 
iter: 3  mgc: 1.028866e-11 
iter: 1  mgc: 1.028866e-11 
outer mgc:  0.01598337 
iter: 1  value: 3730.665 mgc: 0.2187717 ustep: 1 
iter: 2  value: 3730.665 mgc: 1.021567e-05 ustep: 1 
iter: 3  mgc: 1.829648e-13 
iter: 1  mgc: 1.829648e-13 
outer mgc:  0.006781565 
iter: 1  value: 3730.631 mgc: 0.04404053 ustep: 1 
iter: 2  value: 3730.631 mgc: 4.380621e-07 ustep: 1 
iter: 3  mgc: 1.253997e-13 
iter: 1  mgc: 1.253997e-13 
outer mgc:  0.0008779214 
iter: 1  value: 3730.629 mgc: 0.001413738 ustep: 1 
iter: 2  mgc: 3.681337e-09 
iter: 1  mgc: 3.681337e-09 
outer mgc:  0.0006093708 
iter: 1  mgc: 3.681337e-09 
iter: 1  mgc: 3.681337e-09 
outer mgc:  0.0006093708 
iter: 1  value: 3730.629 mgc: 0.02684213 ustep: 1 
iter: 2  value: 3730.629 mgc: 5.025334e-07 ustep: 1 
iter: 3  mgc: 1.252332e-13 
outer mgc:  0.3883802 
iter: 1  value: 3730.628 mgc: 0.02682675 ustep: 1 
iter: 2  value: 3730.628 mgc: 5.016412e-07 ustep: 1 
iter: 3  mgc: 1.083578e-13 
outer mgc:  0.3894226 
iter: 1  value: 3730.629 mgc: 0.013118 ustep: 1 
iter: 2  value: 3730.629 mgc: 7.586828e-08 ustep: 1 
mgc: 1.652012e-13 
outer mgc:  0.2095803 
iter: 1  value: 3730.629 mgc: 0.01311074 ustep: 1 
iter: 2  value: 3730.629 mgc: 7.575034e-08 ustep: 1 
mgc: 1.216804e-13 
outer mgc:  0.2099189 
iter: 1  value: 3730.629 mgc: 0.03268546 ustep: 1 
iter: 2  value: 3730.629 mgc: 2.168398e-06 ustep: 1 
iter: 3  mgc: 2.122746e-13 
outer mgc:  0.3417447 
iter: 1  value: 3730.629 mgc: 0.03268236 ustep: 1 
iter: 2  value: 3730.629 mgc: 2.161018e-06 ustep: 1 
iter: 3  mgc: 2.136069e-13 
outer mgc:  0.3406559 
iter: 1  value: 3730.629 mgc: 0.0167922 ustep: 1 
iter: 2  value: 3730.629 mgc: 4.688649e-07 ustep: 1 
iter: 3  mgc: 1.005862e-13 
outer mgc:  0.2433126 
iter: 1  value: 3730.628 mgc: 0.0167946 ustep: 1 
iter: 2  value: 3730.628 mgc: 4.685108e-07 ustep: 1 
iter: 3  mgc: 1.509903e-13 
outer mgc:  0.2427241 
iter: 1  value: 3730.644 mgc: 0.1815487 ustep: 1 
iter: 2  value: 3730.644 mgc: 7.082411e-06 ustep: 1 
iter: 3  mgc: 1.967315e-13 
outer mgc:  0.1155115 
iter: 1  value: 3730.614 mgc: 0.1820931 ustep: 1 
iter: 2  value: 3730.614 mgc: 7.087843e-06 ustep: 1 
iter: 3  mgc: 1.638689e-13 
outer mgc:  0.1150218 
iter: 1  value: 3730.634 mgc: 0.1806667 ustep: 1 
iter: 2  value: 3730.634 mgc: 5.414489e-06 ustep: 1 
iter: 3  mgc: 9.65894e-14 
outer mgc:  0.1344235 
iter: 1  value: 3730.624 mgc: 0.1808474 ustep: 1 
iter: 2  value: 3730.624 mgc: 5.408895e-06 ustep: 1 
iter: 3  mgc: 1.065814e-13 
outer mgc:  0.1350295 
iter: 1  value: 3730.626 mgc: 0.002646532 ustep: 1 
iter: 2  mgc: 1.671943e-09 
outer mgc:  0.0006827904 
iter: 1  value: 3730.631 mgc: 0.002646172 ustep: 1 
iter: 2  mgc: 1.673035e-09 
outer mgc:  0.0005359218 
iter: 1  value: 3730.626 mgc: 0.003232495 ustep: 1 
iter: 2  mgc: 8.472499e-09 
outer mgc:  0.003575916 
iter: 1  value: 3730.632 mgc: 0.003233537 ustep: 1 
iter: 2  mgc: 8.484926e-09 
outer mgc:  0.003082334 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:34:07 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:40:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_10_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_10_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_10_100_10_3_0.8_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2167.562046 
final  value 2096.709016 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2066.204 mgc: 3.016306 ustep: 0.6827823 
iter: 2  value: 2065.988 mgc: 0.5186099 ustep: 0.8263238 
iter: 3  value: 2065.985 mgc: 0.05661024 ustep: 0.9090326 
iter: 4  value: 2065.985 mgc: 0.003601972 ustep: 0.9534367 
iter: 5  value: 2065.985 mgc: 0.0001262172 ustep: 0.9764432 
iter: 6  value: 2065.985 mgc: 2.49963e-06 ustep: 0.9881526 
iter: 7  value: 2065.985 mgc: 2.618204e-08 ustep: 0.9940592 
iter: 8  mgc: 1.398162e-10 
iter: 1  mgc: 1.398162e-10 
Matching hessian patterns... Done
outer mgc:  14.50393 
iter: 1  value: 2043.554 mgc: 0.6769287 ustep: 1 
iter: 2  value: 2043.553 mgc: 0.02812224 ustep: 1 
iter: 3  value: 2043.553 mgc: 6.963751e-05 ustep: 1 
iter: 4  mgc: 3.161524e-10 
iter: 1  value: 2025.811 mgc: 7.07719 ustep: 1 
iter: 2  value: 2025.786 mgc: 0.6084857 ustep: 1 
iter: 3  value: 2025.786 mgc: 0.003531168 ustep: 1 
iter: 4  value: 2025.786 mgc: 1.138218e-07 ustep: 1 
mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  45.71306 
iter: 1  value: 2626.728 mgc: 432.653 ustep: 0.05030795 
iter: 2  value: 2424.276 mgc: 28.97122 ustep: 0.06153264 
iter: 3  value: 2383.328 mgc: 38.04973 ustep: 0.2481329 
iter: 4  value: 2365.178 mgc: 23.38825 ustep: 0.4981796 
iter: 5  value: 2364.772 mgc: 2.468518 ustep: 0.7058478 
iter: 6  value: 2364.77 mgc: 0.1545279 ustep: 0.8401635 
iter: 7  value: 2364.77 mgc: 0.002181049 ustep: 0.9166127 
iter: 8  value: 2364.77 mgc: 1.585007e-05 ustep: 0.9574032 
iter: 9  value: 2364.77 mgc: 5.884526e-08 ustep: 0.978472 
mgc: 1.084155e-10 
iter: 1  value: 2011.897 mgc: 8.603652 ustep: 1 
iter: 2  value: 2011.857 mgc: 0.6917278 ustep: 1 
iter: 3  value: 2011.857 mgc: 0.002494452 ustep: 1 
iter: 4  value: 2011.857 mgc: 6.061618e-08 ustep: 1 
mgc: 1.487699e-14 
iter: 1  mgc: 1.487699e-14 
outer mgc:  16.19645 
iter: 1  value: 2010.87 mgc: 4.541227 ustep: 1 
iter: 2  value: 2010.852 mgc: 0.437843 ustep: 1 
iter: 3  value: 2010.852 mgc: 0.002649284 ustep: 1 
iter: 4  value: 2010.852 mgc: 9.875786e-08 ustep: 1 
mgc: 1.221245e-14 
iter: 1  mgc: 1.221245e-14 
outer mgc:  12.11731 
iter: 1  value: 2009.955 mgc: 4.80951 ustep: 1 
iter: 2  value: 2009.898 mgc: 0.5203522 ustep: 1 
iter: 3  value: 2009.898 mgc: 0.003326449 ustep: 1 
iter: 4  value: 2009.898 mgc: 1.576329e-07 ustep: 1 
iter: 5  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  4.31996 
iter: 1  value: 2005.832 mgc: 3.761269 ustep: 1 
iter: 2  value: 2005.831 mgc: 0.1214864 ustep: 1 
iter: 3  value: 2005.831 mgc: 8.034458e-05 ustep: 1 
iter: 4  mgc: 4.83289e-11 
iter: 1  mgc: 4.83289e-11 
outer mgc:  3.721794 
iter: 1  value: 2009.277 mgc: 5.36766 ustep: 1 
iter: 2  value: 2009.275 mgc: 0.09554621 ustep: 1 
iter: 3  value: 2009.275 mgc: 0.0001034888 ustep: 1 
iter: 4  mgc: 3.187075e-10 
iter: 1  value: 2005.545 mgc: 1.39506 ustep: 1 
iter: 2  value: 2005.545 mgc: 0.01643246 ustep: 1 
iter: 3  value: 2005.545 mgc: 2.551112e-06 ustep: 1 
iter: 4  mgc: 5.639933e-14 
iter: 1  mgc: 5.639933e-14 
outer mgc:  3.139591 
iter: 1  value: 2004.997 mgc: 0.8915248 ustep: 1 
iter: 2  value: 2004.997 mgc: 0.007055697 ustep: 1 
iter: 3  value: 2004.997 mgc: 5.473754e-07 ustep: 1 
iter: 4  mgc: 1.182388e-14 
iter: 1  mgc: 1.182388e-14 
outer mgc:  2.321911 
iter: 1  value: 2004.006 mgc: 0.8051648 ustep: 1 
iter: 2  value: 2004.006 mgc: 0.005623213 ustep: 1 
iter: 3  value: 2004.006 mgc: 3.271397e-07 ustep: 1 
iter: 4  mgc: 8.881784e-15 
iter: 1  value: 2002.092 mgc: 1.382899 ustep: 1 
iter: 2  value: 2002.092 mgc: 0.01456533 ustep: 1 
iter: 3  value: 2002.092 mgc: 1.411837e-06 ustep: 1 
iter: 4  mgc: 1.021405e-14 
iter: 1  value: 1995.064 mgc: 9.094254 ustep: 1 
iter: 2  value: 1995.064 mgc: 0.02143477 ustep: 1 
iter: 3  value: 1995.064 mgc: 2.4901e-06 ustep: 1 
iter: 4  mgc: 1.554312e-14 
iter: 1  mgc: 1.554312e-14 
outer mgc:  5.500185 
iter: 1  value: 1992.474 mgc: 42.10203 ustep: 1 
iter: 2  value: 1992.474 mgc: 0.03277208 ustep: 1 
iter: 3  value: 1992.474 mgc: 1.832017e-06 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  value: 1994.684 mgc: 1.930704 ustep: 1 
iter: 2  value: 1994.684 mgc: 0.01628058 ustep: 1 
iter: 3  value: 1994.684 mgc: 1.486572e-06 ustep: 1 
iter: 4  mgc: 1.376677e-14 
iter: 1  mgc: 1.376677e-14 
outer mgc:  4.78078 
iter: 1  value: 1994.298 mgc: 1.737141 ustep: 1 
iter: 2  value: 1994.298 mgc: 0.0160059 ustep: 1 
iter: 3  value: 1994.298 mgc: 9.617061e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  1.904836 
iter: 1  value: 1993.192 mgc: 1.230815 ustep: 1 
iter: 2  value: 1993.192 mgc: 0.008587054 ustep: 1 
iter: 3  value: 1993.192 mgc: 5.638229e-08 ustep: 1 
mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  1.531302 
iter: 1  value: 1994.407 mgc: 3.341708 ustep: 1 
iter: 2  value: 1994.407 mgc: 0.05076176 ustep: 1 
iter: 3  value: 1994.407 mgc: 6.494712e-06 ustep: 1 
iter: 4  mgc: 1.811884e-13 
iter: 1  mgc: 1.811884e-13 
outer mgc:  1.638434 
iter: 1  value: 1993.679 mgc: 3.214862 ustep: 1 
iter: 2  value: 1993.679 mgc: 0.01836472 ustep: 1 
iter: 3  value: 1993.679 mgc: 4.540676e-06 ustep: 1 
iter: 4  mgc: 1.216804e-13 
iter: 1  mgc: 1.216804e-13 
outer mgc:  1.154471 
iter: 1  value: 1996.169 mgc: 2.261163 ustep: 1 
iter: 2  value: 1996.169 mgc: 0.04234501 ustep: 1 
iter: 3  value: 1996.169 mgc: 2.697473e-05 ustep: 1 
iter: 4  mgc: 9.332091e-12 
iter: 1  value: 1994.219 mgc: 0.6079119 ustep: 1 
iter: 2  value: 1994.219 mgc: 0.002451795 ustep: 1 
iter: 3  value: 1994.219 mgc: 3.451709e-08 ustep: 1 
mgc: 1.14353e-14 
iter: 1  mgc: 1.14353e-14 
outer mgc:  1.539081 
iter: 1  value: 1994.127 mgc: 1.274898 ustep: 1 
iter: 2  value: 1994.127 mgc: 0.00336942 ustep: 1 
iter: 3  value: 1994.127 mgc: 1.402639e-07 ustep: 1 
mgc: 9.603429e-15 
iter: 1  mgc: 9.603429e-15 
outer mgc:  0.5559543 
iter: 1  value: 1993.515 mgc: 0.5028656 ustep: 1 
iter: 2  value: 1993.515 mgc: 0.0002882826 ustep: 1 
iter: 3  mgc: 9.964125e-10 
iter: 1  mgc: 9.964125e-10 
outer mgc:  0.3010926 
iter: 1  value: 1992.962 mgc: 0.5479516 ustep: 1 
iter: 2  value: 1992.962 mgc: 0.0002369405 ustep: 1 
iter: 3  mgc: 3.667067e-10 
iter: 1  value: 1991.742 mgc: 1.44788 ustep: 1 
iter: 2  value: 1991.742 mgc: 0.001061084 ustep: 1 
iter: 3  mgc: 8.399562e-09 
iter: 1  mgc: 8.399562e-09 
outer mgc:  0.447934 
iter: 1  value: 1990.836 mgc: 1.358741 ustep: 1 
iter: 2  value: 1990.836 mgc: 0.001457929 ustep: 1 
iter: 3  mgc: 6.823056e-09 
iter: 1  mgc: 6.823056e-09 
outer mgc:  0.5433999 
iter: 1  value: 1989.754 mgc: 0.9184112 ustep: 1 
iter: 2  value: 1989.754 mgc: 0.0001474954 ustep: 1 
iter: 3  mgc: 3.587651e-10 
iter: 1  mgc: 3.587651e-10 
outer mgc:  0.2779742 
iter: 1  value: 1987.901 mgc: 1.352706 ustep: 1 
iter: 2  value: 1987.901 mgc: 0.0004618182 ustep: 1 
iter: 3  mgc: 3.061439e-09 
iter: 1  mgc: 3.061439e-09 
outer mgc:  0.06069781 
iter: 1  value: 1986.182 mgc: 1.15435 ustep: 1 
iter: 2  value: 1986.182 mgc: 8.011402e-05 ustep: 1 
iter: 3  mgc: 6.59881e-11 
iter: 1  mgc: 6.59881e-11 
outer mgc:  0.1021239 
iter: 1  value: 1984.168 mgc: 1.423958 ustep: 1 
iter: 2  value: 1984.168 mgc: 9.147952e-05 ustep: 1 
iter: 3  mgc: 1.039886e-10 
iter: 1  mgc: 1.039886e-10 
outer mgc:  0.06036728 
iter: 1  value: 1982.405 mgc: 1.301728 ustep: 1 
iter: 2  value: 1982.405 mgc: 5.715757e-05 ustep: 1 
iter: 3  mgc: 3.223999e-11 
iter: 1  mgc: 3.223999e-11 
outer mgc:  0.03563095 
iter: 1  value: 1980.952 mgc: 0.9295921 ustep: 1 
iter: 2  value: 1980.952 mgc: 1.282395e-05 ustep: 1 
iter: 3  mgc: 2.021383e-12 
iter: 1  mgc: 2.021383e-12 
outer mgc:  0.01743978 
iter: 1  value: 1978.803 mgc: 1.425585 ustep: 1 
iter: 2  value: 1978.803 mgc: 3.992771e-06 ustep: 1 
iter: 3  mgc: 2.373657e-13 
iter: 1  mgc: 2.373657e-13 
outer mgc:  0.01729161 
iter: 1  value: 1977.033 mgc: 1.179447 ustep: 1 
iter: 2  value: 1977.033 mgc: 2.480493e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
iter: 1  mgc: 9.414691e-14 
outer mgc:  0.004247897 
iter: 1  value: 1974.986 mgc: 1.416638 ustep: 1 
iter: 2  value: 1974.986 mgc: 1.21439e-06 ustep: 1 
iter: 3  mgc: 1.003642e-13 
iter: 1  mgc: 1.003642e-13 
outer mgc:  0.007328414 
iter: 1  value: 1973.281 mgc: 1.095367 ustep: 1 
iter: 2  value: 1973.281 mgc: 2.769883e-07 ustep: 1 
iter: 3  mgc: 2.375877e-13 
iter: 1  mgc: 2.375877e-13 
outer mgc:  0.003726728 
iter: 1  value: 1971.183 mgc: 1.419794 ustep: 1 
iter: 2  value: 1971.183 mgc: 1.9952e-07 ustep: 1 
iter: 3  mgc: 2.895462e-13 
iter: 1  mgc: 2.895462e-13 
outer mgc:  0.002533658 
iter: 1  value: 1969.449 mgc: 1.172893 ustep: 1 
iter: 2  value: 1969.449 mgc: 7.774337e-08 ustep: 1 
mgc: 1.81799e-13 
iter: 1  mgc: 1.81799e-13 
outer mgc:  0.000640423 
iter: 1  value: 1967.358 mgc: 1.359314 ustep: 1 
iter: 2  value: 1967.358 mgc: 4.806005e-08 ustep: 1 
mgc: 3.268497e-13 
iter: 1  mgc: 3.268497e-13 
outer mgc:  0.0008375161 
iter: 1  value: 1965.629 mgc: 1.086555 ustep: 1 
iter: 2  value: 1965.629 mgc: 1.268807e-08 ustep: 1 
mgc: 6.07181e-13 
iter: 1  mgc: 6.07181e-13 
outer mgc:  0.0003273647 
iter: 1  value: 1963.534 mgc: 1.407601 ustep: 1 
iter: 2  value: 1963.534 mgc: 1.258778e-08 ustep: 1 
mgc: 8.136825e-13 
iter: 1  mgc: 8.136825e-13 
outer mgc:  0.0003670184 
iter: 1  value: 1961.802 mgc: 1.083267 ustep: 1 
iter: 2  mgc: 2.685928e-09 
iter: 1  mgc: 2.685928e-09 
outer mgc:  0.0001583886 
iter: 1  value: 1959.705 mgc: 1.358608 ustep: 1 
iter: 2  mgc: 2.074641e-09 
iter: 1  mgc: 2.074641e-09 
outer mgc:  0.0001731934 
iter: 1  value: 1957.973 mgc: 1.121656 ustep: 1 
iter: 2  mgc: 6.605326e-10 
iter: 1  mgc: 6.605326e-10 
outer mgc:  5.533522e-05 
iter: 1  value: 1955.876 mgc: 1.36804 ustep: 1 
iter: 2  mgc: 4.380318e-10 
iter: 1  mgc: 4.380318e-10 
outer mgc:  5.302564e-05 
iter: 1  value: 1954.144 mgc: 1.081241 ustep: 1 
iter: 2  mgc: 1.299076e-10 
iter: 1  mgc: 1.299076e-10 
outer mgc:  2.992792e-05 
iter: 1  value: 1952.046 mgc: 1.376302 ustep: 1 
iter: 2  mgc: 1.084323e-10 
iter: 1  mgc: 1.084323e-10 
outer mgc:  2.227266e-05 
iter: 1  value: 1950.314 mgc: 1.087452 ustep: 1 
iter: 2  mgc: 3.309442e-11 
iter: 1  mgc: 3.309442e-11 
outer mgc:  1.152931e-05 
iter: 1  value: 1948.216 mgc: 1.365964 ustep: 1 
iter: 2  mgc: 3.246636e-11 
iter: 1  mgc: 3.246636e-11 
outer mgc:  1.181904e-05 
iter: 1  value: 1946.483 mgc: 1.089069 ustep: 1 
iter: 2  mgc: 5.214995e-11 
iter: 1  mgc: 5.214995e-11 
outer mgc:  5.360902e-06 
iter: 1  mgc: 5.214995e-11 
iter: 1  mgc: 5.214995e-11 
outer mgc:  5.360902e-06 
iter: 1  value: 1946.482 mgc: 0.01064212 ustep: 1 
iter: 2  value: 1946.482 mgc: 9.117685e-07 ustep: 1 
iter: 3  mgc: 3.74345e-11 
outer mgc:  0.04552692 
iter: 1  value: 1946.485 mgc: 0.0106355 ustep: 1 
iter: 2  value: 1946.485 mgc: 9.100839e-07 ustep: 1 
iter: 3  mgc: 3.919798e-11 
outer mgc:  0.04553107 
iter: 1  value: 1946.483 mgc: 0.005843137 ustep: 1 
iter: 2  value: 1946.483 mgc: 2.589486e-07 ustep: 1 
mgc: 3.310818e-11 
outer mgc:  0.0278235 
iter: 1  value: 1946.484 mgc: 0.005840622 ustep: 1 
iter: 2  value: 1946.484 mgc: 2.58517e-07 ustep: 1 
mgc: 4.053557e-11 
outer mgc:  0.02781323 
iter: 1  value: 1946.482 mgc: 0.01140479 ustep: 1 
iter: 2  value: 1946.482 mgc: 1.150441e-06 ustep: 1 
iter: 3  mgc: 2.728484e-11 
outer mgc:  0.04435865 
iter: 1  value: 1946.485 mgc: 0.01140127 ustep: 1 
iter: 2  value: 1946.485 mgc: 1.148926e-06 ustep: 1 
iter: 3  mgc: 2.941769e-11 
outer mgc:  0.04436617 
iter: 1  value: 1946.483 mgc: 0.006151639 ustep: 1 
iter: 2  value: 1946.483 mgc: 3.18395e-07 ustep: 1 
iter: 3  mgc: 3.129519e-11 
outer mgc:  0.0383804 
iter: 1  value: 1946.484 mgc: 0.006151223 ustep: 1 
iter: 2  value: 1946.484 mgc: 3.182218e-07 ustep: 1 
iter: 3  mgc: 3.452705e-11 
outer mgc:  0.03838164 
iter: 1  value: 1946.49 mgc: 148.6264 ustep: 1 
iter: 2  value: 1946.49 mgc: 4.061287e-07 ustep: 1 
iter: 3  mgc: 4.034462e-11 
outer mgc:  0.004146016 
iter: 1  value: 1946.477 mgc: 149.0729 ustep: 1 
iter: 2  value: 1946.477 mgc: 4.057972e-07 ustep: 1 
iter: 3  mgc: 2.031753e-11 
outer mgc:  0.004149062 
iter: 1  value: 1946.489 mgc: 148.7696 ustep: 1 
iter: 2  value: 1946.489 mgc: 2.823709e-07 ustep: 1 
iter: 3  mgc: 2.594724e-11 
outer mgc:  0.005589674 
iter: 1  value: 1946.478 mgc: 148.9184 ustep: 1 
iter: 2  value: 1946.478 mgc: 2.825397e-07 ustep: 1 
iter: 3  mgc: 2.560085e-11 
outer mgc:  0.005587403 
iter: 1  value: 1946.484 mgc: 2.978338e-05 ustep: 1 
mgc: 5.392331e-11 
outer mgc:  5.361036e-06 
iter: 1  value: 1946.483 mgc: 2.978363e-05 ustep: 1 
mgc: 3.157519e-11 
outer mgc:  5.360761e-06 
iter: 1  value: 1946.481 mgc: 0.003482334 ustep: 1 
iter: 2  value: 1946.481 mgc: 7.417078e-08 ustep: 1 
mgc: 4.185363e-11 
outer mgc:  0.009006964 
iter: 1  value: 1946.486 mgc: 0.003481073 ustep: 1 
iter: 2  value: 1946.486 mgc: 7.413387e-08 ustep: 1 
mgc: 5.105427e-11 
outer mgc:  0.009018927 
[Fri Aug 13 11:41:00 2021]
Finished job 0.
1 of 1 steps (100%) done

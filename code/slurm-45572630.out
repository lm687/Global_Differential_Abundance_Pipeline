Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 00:00:47 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2211.506537 
final  value 1979.253146 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1354.218 mgc: 74.92679 ustep: 0.4367355 
iter: 2  value: 571.6351 mgc: 61.58517 ustep: 0.1263996 
iter: 3  value: 373.7879 mgc: 95.01133 ustep: 0.3555917 
iter: 4  value: 357.8357 mgc: 22.24086 ustep: 0.5963555 
iter: 5  value: 356.8583 mgc: 5.108533 ustep: 0.7722633 
iter: 6  value: 356.8423 mgc: 0.6345486 ustep: 0.8787973 
iter: 7  value: 356.8423 mgc: 0.01872163 ustep: 0.9374481 
iter: 8  value: 356.8423 mgc: 0.0001113288 ustep: 0.9682222 
iter: 9  value: 356.8423 mgc: 2.980953e-07 ustep: 0.9839844 
iter: 10  mgc: 3.987002e-10 
iter: 1  mgc: 3.987002e-10 
Matching hessian patterns... Done
outer mgc:  178.278 
iter: 1  value: 194.5627 mgc: 26.77595 ustep: 1 
iter: 2  value: 191.4593 mgc: 5.418498 ustep: 1 
iter: 3  value: 191.4544 mgc: 0.2778023 ustep: 1 
iter: 4  value: 191.4544 mgc: 0.0009446102 ustep: 1 
iter: 5  value: 191.4544 mgc: 1.253107e-08 ustep: 1 
mgc: 1.604272e-14 
iter: 1  mgc: 1.604272e-14 
outer mgc:  77.23715 
iter: 1  value: 142.8108 mgc: 16.70006 ustep: 1 
iter: 2  value: 142.2528 mgc: 2.189537 ustep: 1 
iter: 3  value: 142.2525 mgc: 0.05944701 ustep: 1 
iter: 4  value: 142.2525 mgc: 0.0001128137 ustep: 1 
iter: 5  mgc: 4.085746e-10 
iter: 1  mgc: 4.085746e-10 
outer mgc:  9.806928 
iter: 1  value: 142.1926 mgc: 22.36112 ustep: 1 
iter: 2  value: 142.0137 mgc: 1.039304 ustep: 1 
iter: 3  value: 142.0137 mgc: 0.006133482 ustep: 1 
iter: 4  value: 142.0137 mgc: 3.564845e-07 ustep: 1 
iter: 5  mgc: 1.287859e-14 
iter: 1  value: 137.9934 mgc: 10.1384 ustep: 1 
iter: 2  value: 137.9807 mgc: 0.2704711 ustep: 1 
iter: 3  value: 137.9807 mgc: 0.0005441714 ustep: 1 
iter: 4  mgc: 3.293521e-09 
iter: 1  mgc: 3.293521e-09 
outer mgc:  5.962551 
iter: 1  value: 135.9372 mgc: 4.725989 ustep: 1 
iter: 2  value: 135.9349 mgc: 0.1463477 ustep: 1 
iter: 3  value: 135.9349 mgc: 0.000373213 ustep: 1 
iter: 4  mgc: 3.295162e-09 
iter: 1  mgc: 3.295162e-09 
outer mgc:  12.68338 
iter: 1  value: 135.9838 mgc: 34.61792 ustep: 1 
iter: 2  value: 131.993 mgc: 7.023016 ustep: 1 
iter: 3  value: 131.9903 mgc: 0.2437778 ustep: 1 
iter: 4  value: 131.9903 mgc: 0.0004576972 ustep: 1 
iter: 5  mgc: 1.755732e-09 
iter: 1  mgc: 1.755732e-09 
outer mgc:  21.02835 
iter: 1  value: 121.6794 mgc: 22.01562 ustep: 1 
iter: 2  value: 121.4464 mgc: 2.445585 ustep: 1 
iter: 3  value: 121.4464 mgc: 0.02509121 ustep: 1 
iter: 4  value: 121.4464 mgc: 2.815383e-06 ustep: 1 
iter: 5  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  13.23665 
iter: 1  value: 130.2629 mgc: 15.5597 ustep: 1 
iter: 2  value: 129.8219 mgc: 2.182179 ustep: 1 
iter: 3  value: 129.8218 mgc: 0.0613079 ustep: 1 
iter: 4  value: 129.8218 mgc: 4.77304e-05 ustep: 1 
iter: 5  mgc: 2.778844e-11 
iter: 1  value: 119.0212 mgc: 5.645262 ustep: 1 
iter: 2  value: 119.0157 mgc: 0.2445834 ustep: 1 
iter: 3  value: 119.0157 mgc: 0.0008909104 ustep: 1 
iter: 4  value: 119.0157 mgc: 1.092862e-08 ustep: 1 
mgc: 1.865175e-14 
iter: 1  mgc: 1.865175e-14 
outer mgc:  5.367897 
iter: 1  value: 120.055 mgc: 11.11807 ustep: 1 
iter: 2  value: 120.0437 mgc: 0.4957712 ustep: 1 
iter: 3  value: 120.0437 mgc: 0.001183101 ustep: 1 
iter: 4  mgc: 6.729336e-09 
iter: 1  value: 118.4493 mgc: 3.732147 ustep: 1 
iter: 2  value: 118.4492 mgc: 0.05112376 ustep: 1 
iter: 3  value: 118.4492 mgc: 1.271743e-05 ustep: 1 
iter: 4  mgc: 7.658318e-13 
iter: 1  mgc: 7.658318e-13 
outer mgc:  8.313867 
iter: 1  value: 117.7939 mgc: 4.314802 ustep: 1 
iter: 2  value: 117.7935 mgc: 0.06426761 ustep: 1 
iter: 3  value: 117.7935 mgc: 2.73631e-05 ustep: 1 
iter: 4  mgc: 4.85878e-12 
iter: 1  mgc: 4.85878e-12 
outer mgc:  6.288346 
iter: 1  value: 116.6027 mgc: 5.722976 ustep: 1 
iter: 2  value: 116.6018 mgc: 0.1171539 ustep: 1 
iter: 3  value: 116.6018 mgc: 7.054108e-05 ustep: 1 
iter: 4  mgc: 6.257084e-11 
iter: 1  mgc: 6.257084e-11 
outer mgc:  6.850441 
iter: 1  value: 115.9613 mgc: 5.478728 ustep: 1 
iter: 2  value: 115.9581 mgc: 0.1867392 ustep: 1 
iter: 3  value: 115.9581 mgc: 0.0002628606 ustep: 1 
iter: 4  mgc: 7.114285e-10 
iter: 1  mgc: 7.114285e-10 
outer mgc:  6.973289 
iter: 1  value: 114.9917 mgc: 4.723046 ustep: 1 
iter: 2  value: 114.9916 mgc: 0.07449686 ustep: 1 
iter: 3  value: 114.9916 mgc: 1.921152e-05 ustep: 1 
iter: 4  mgc: 1.365574e-12 
iter: 1  mgc: 1.365574e-12 
outer mgc:  6.452636 
iter: 1  value: 119.1953 mgc: 10.46197 ustep: 1 
iter: 2  value: 119.1937 mgc: 0.1322448 ustep: 1 
iter: 3  value: 119.1937 mgc: 5.0358e-05 ustep: 1 
iter: 4  mgc: 1.543743e-11 
iter: 1  value: 114.8041 mgc: 1.610051 ustep: 1 
iter: 2  value: 114.8041 mgc: 0.00281073 ustep: 1 
iter: 3  value: 114.8041 mgc: 2.495542e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  2.037209 
iter: 1  value: 114.7603 mgc: 0.8760589 ustep: 1 
iter: 2  value: 114.7603 mgc: 0.002459518 ustep: 1 
iter: 3  value: 114.7603 mgc: 3.216322e-08 ustep: 1 
mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  1.990297 
iter: 1  value: 114.6061 mgc: 0.7843914 ustep: 1 
iter: 2  value: 114.6061 mgc: 0.0009841384 ustep: 1 
iter: 3  mgc: 4.753353e-09 
iter: 1  value: 114.3652 mgc: 0.9969686 ustep: 1 
iter: 2  value: 114.3652 mgc: 0.005170214 ustep: 1 
iter: 3  value: 114.3652 mgc: 1.146917e-07 ustep: 1 
mgc: 1.731948e-14 
iter: 1  value: 114.0193 mgc: 1.562791 ustep: 1 
iter: 2  value: 114.0193 mgc: 0.009715987 ustep: 1 
iter: 3  value: 114.0193 mgc: 3.505528e-07 ustep: 1 
iter: 4  mgc: 1.770806e-14 
iter: 1  mgc: 1.770806e-14 
outer mgc:  3.116429 
iter: 1  value: 113.1534 mgc: 3.226166 ustep: 1 
iter: 2  value: 113.1534 mgc: 0.02525306 ustep: 1 
iter: 3  value: 113.1534 mgc: 3.970279e-06 ustep: 1 
iter: 4  mgc: 1.356693e-13 
iter: 1  mgc: 1.356693e-13 
outer mgc:  1.231215 
iter: 1  value: 111.9082 mgc: 4.124566 ustep: 1 
iter: 2  value: 111.9082 mgc: 0.01830465 ustep: 1 
iter: 3  value: 111.9082 mgc: 1.657203e-06 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  value: 112.5303 mgc: 1.93564 ustep: 1 
iter: 2  value: 112.5303 mgc: 0.005660921 ustep: 1 
iter: 3  value: 112.5303 mgc: 2.299693e-07 ustep: 1 
iter: 4  mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  0.7202128 
iter: 1  value: 112.4866 mgc: 0.5725307 ustep: 1 
iter: 2  value: 112.4866 mgc: 0.0008506751 ustep: 1 
iter: 3  mgc: 2.563551e-09 
iter: 1  mgc: 2.563551e-09 
outer mgc:  0.929296 
iter: 1  value: 112.2186 mgc: 0.8346395 ustep: 1 
iter: 2  value: 112.2186 mgc: 0.00137126 ustep: 1 
iter: 3  mgc: 6.79137e-09 
iter: 1  mgc: 6.79137e-09 
outer mgc:  0.3754142 
iter: 1  value: 111.9316 mgc: 0.8661787 ustep: 1 
iter: 2  value: 111.9316 mgc: 0.0006416799 ustep: 1 
iter: 3  mgc: 1.129711e-09 
iter: 1  mgc: 1.129711e-09 
outer mgc:  0.08283632 
iter: 1  value: 111.6201 mgc: 0.805422 ustep: 1 
iter: 2  value: 111.6201 mgc: 0.001004585 ustep: 1 
iter: 3  mgc: 3.276993e-09 
iter: 1  mgc: 3.276993e-09 
outer mgc:  0.09019449 
iter: 1  value: 111.4988 mgc: 0.3540249 ustep: 1 
iter: 2  value: 111.4988 mgc: 7.957887e-05 ustep: 1 
iter: 3  mgc: 2.115907e-11 
iter: 1  mgc: 2.115907e-11 
outer mgc:  0.06934409 
iter: 1  value: 111.4715 mgc: 0.0780574 ustep: 1 
iter: 2  value: 111.4715 mgc: 4.149946e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.03421078 
iter: 1  value: 111.4734 mgc: 0.01087914 ustep: 1 
iter: 2  value: 111.4734 mgc: 6.322536e-08 ustep: 1 
mgc: 2.076117e-14 
iter: 1  mgc: 2.076117e-14 
outer mgc:  0.001105983 
iter: 1  value: 111.4737 mgc: 0.001341792 ustep: 1 
iter: 2  mgc: 3.721564e-09 
iter: 1  mgc: 3.721564e-09 
outer mgc:  9.431339e-05 
iter: 1  value: 111.4736 mgc: 0.0001419188 ustep: 1 
iter: 2  mgc: 2.342304e-11 
iter: 1  mgc: 2.342304e-11 
outer mgc:  4.881496e-06 
iter: 1  mgc: 2.342304e-11 
iter: 1  mgc: 2.342304e-11 
outer mgc:  4.881496e-06 
iter: 1  value: 111.4732 mgc: 0.04075763 ustep: 1 
iter: 2  value: 111.4732 mgc: 3.40988e-06 ustep: 1 
iter: 3  mgc: 3.619327e-14 
outer mgc:  0.1443452 
iter: 1  value: 111.4742 mgc: 0.04074363 ustep: 1 
iter: 2  value: 111.4742 mgc: 3.410365e-06 ustep: 1 
iter: 3  mgc: 2.908784e-14 
outer mgc:  0.1443356 
iter: 1  value: 111.4735 mgc: 0.01658918 ustep: 1 
iter: 2  value: 111.4735 mgc: 4.748561e-07 ustep: 1 
iter: 3  mgc: 2.775558e-14 
outer mgc:  0.09496894 
iter: 1  value: 111.4739 mgc: 0.01658018 ustep: 1 
iter: 2  value: 111.4739 mgc: 4.745023e-07 ustep: 1 
iter: 3  mgc: 1.210143e-14 
outer mgc:  0.09492722 
iter: 1  value: 111.4744 mgc: 0.04284808 ustep: 1 
iter: 2  value: 111.4744 mgc: 2.152036e-06 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.1989545 
iter: 1  value: 111.4731 mgc: 0.04283905 ustep: 1 
iter: 2  value: 111.4731 mgc: 2.15247e-06 ustep: 1 
iter: 3  mgc: 2.597922e-14 
outer mgc:  0.1989619 
iter: 1  value: 111.4744 mgc: 0.02537873 ustep: 1 
iter: 2  value: 111.4744 mgc: 1.175024e-06 ustep: 1 
iter: 3  mgc: 3.130829e-14 
outer mgc:  0.1636268 
iter: 1  value: 111.473 mgc: 0.02537697 ustep: 1 
iter: 2  value: 111.473 mgc: 1.175637e-06 ustep: 1 
iter: 3  mgc: 3.075318e-14 
outer mgc:  0.1636218 
iter: 1  value: 111.4722 mgc: 0.004051036 ustep: 1 
iter: 2  mgc: 9.401857e-09 
outer mgc:  0.0003863759 
iter: 1  value: 111.4751 mgc: 0.00405013 ustep: 1 
iter: 2  mgc: 9.408441e-09 
outer mgc:  0.0003895717 
iter: 1  value: 111.4769 mgc: 0.06325905 ustep: 1 
iter: 2  value: 111.4769 mgc: 3.397254e-06 ustep: 1 
iter: 3  mgc: 1.048051e-13 
outer mgc:  0.06307629 
iter: 1  value: 111.4704 mgc: 0.06332234 ustep: 1 
iter: 2  value: 111.4704 mgc: 3.404534e-06 ustep: 1 
iter: 3  mgc: 1.052491e-13 
outer mgc:  0.06312665 
iter: 1  value: 111.4779 mgc: 0.06580372 ustep: 1 
iter: 2  value: 111.4779 mgc: 2.098508e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.06030342 
iter: 1  value: 111.4694 mgc: 0.06599882 ustep: 1 
iter: 2  value: 111.4694 mgc: 2.094979e-06 ustep: 1 
iter: 3  mgc: 6.794565e-14 
outer mgc:  0.06030867 
[Sun Aug 15 00:00:48 2021]
Finished job 0.
1 of 1 steps (100%) done

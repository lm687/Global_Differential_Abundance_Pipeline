Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:40:51 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4321.940744 
iter  10 value 3506.600892
final  value 3506.591979 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2081.137 mgc: 46.41908 ustep: 1 
iter: 2  value: 2065.718 mgc: 9.981339 ustep: 1 
iter: 3  value: 2065.166 mgc: 1.82082 ustep: 1 
iter: 4  value: 2065.163 mgc: 0.1567737 ustep: 1 
iter: 5  value: 2065.163 mgc: 0.00141314 ustep: 1 
iter: 6  value: 2065.163 mgc: 1.174826e-07 ustep: 1 
iter: 7  mgc: 2.775558e-14 
iter: 1  mgc: 2.775558e-14 
Matching hessian patterns... Done
outer mgc:  678.3411 
iter: 1  value: 1359.351 mgc: 21.24338 ustep: 1 
iter: 2  value: 1359.33 mgc: 0.5421656 ustep: 1 
iter: 3  value: 1359.33 mgc: 0.0007536424 ustep: 1 
iter: 4  mgc: 6.925522e-09 
iter: 1  value: 911.4831 mgc: 84.6212 ustep: 1 
iter: 2  value: 880.7423 mgc: 22.59874 ustep: 1 
iter: 3  value: 880.5128 mgc: 1.405474 ustep: 1 
iter: 4  value: 880.5128 mgc: 0.01253296 ustep: 1 
iter: 5  value: 880.5128 mgc: 8.006554e-06 ustep: 1 
iter: 6  mgc: 4.180434e-12 
iter: 1  mgc: 4.180434e-12 
outer mgc:  425.4108 
iter: 1  value: 680.3662 mgc: 63.64755 ustep: 1 
iter: 2  value: 338.7136 mgc: 62.59641 ustep: 1 
iter: 3  value: 335.8367 mgc: 7.857339 ustep: 1 
iter: 4  value: 335.8302 mgc: 0.1754403 ustep: 1 
iter: 5  value: 335.8302 mgc: 0.0007297158 ustep: 1 
iter: 6  value: 335.8302 mgc: 2.321722e-08 ustep: 1 
mgc: 2.740863e-14 
iter: 1  mgc: 2.740863e-14 
outer mgc:  150.8229 
iter: 1  value: 613.3561 mgc: 76.73225 ustep: 1 
iter: 2  value: 613.0185 mgc: 1.960821 ustep: 1 
iter: 3  value: 613.0185 mgc: 0.007914194 ustep: 1 
iter: 4  value: 613.0185 mgc: 4.560968e-07 ustep: 1 
iter: 5  mgc: 4.252154e-14 
iter: 1  value: 323.1035 mgc: 41.52185 ustep: 1 
iter: 2  value: 321.1975 mgc: 3.322173 ustep: 1 
iter: 3  value: 321.197 mgc: 0.0480524 ustep: 1 
iter: 4  value: 321.197 mgc: 3.297994e-05 ustep: 1 
iter: 5  mgc: 4.915446e-11 
iter: 1  mgc: 4.915446e-11 
outer mgc:  136.8088 
iter: 1  value: 351.2152 mgc: 47.61846 ustep: 1 
iter: 2  value: 246.7246 mgc: 27.86443 ustep: 1 
iter: 3  value: 246.3246 mgc: 1.983888 ustep: 1 
iter: 4  value: 246.3245 mgc: 0.01999812 ustep: 1 
iter: 5  value: 246.3245 mgc: 2.155322e-06 ustep: 1 
iter: 6  mgc: 4.016232e-14 
iter: 1  mgc: 4.016232e-14 
outer mgc:  17.90433 
iter: 1  value: 280.4976 mgc: 11.18414 ustep: 1 
iter: 2  value: 280.2237 mgc: 1.025691 ustep: 1 
iter: 3  value: 280.2237 mgc: 0.009697837 ustep: 1 
iter: 4  value: 280.2237 mgc: 2.60133e-06 ustep: 1 
iter: 5  mgc: 1.598721e-13 
iter: 1  value: 241.8872 mgc: 2.597238 ustep: 1 
iter: 2  value: 241.887 mgc: 0.03775234 ustep: 1 
iter: 3  value: 241.887 mgc: 2.734201e-06 ustep: 1 
iter: 4  mgc: 8.371082e-14 
iter: 1  mgc: 8.371082e-14 
outer mgc:  13.08275 
iter: 1  value: 236.9767 mgc: 13.10203 ustep: 1 
iter: 2  value: 236.9535 mgc: 0.5186428 ustep: 1 
iter: 3  value: 236.9535 mgc: 0.001214709 ustep: 1 
iter: 4  value: 236.9535 mgc: 1.224726e-08 ustep: 1 
mgc: 1.709743e-14 
iter: 1  value: 239.353 mgc: 28.67958 ustep: 1 
iter: 2  value: 238.373 mgc: 3.201415 ustep: 1 
iter: 3  value: 238.3728 mgc: 0.05055065 ustep: 1 
iter: 4  value: 238.3728 mgc: 2.830631e-05 ustep: 1 
iter: 5  mgc: 1.414335e-11 
iter: 1  mgc: 1.709743e-14 
outer mgc:  14.76698 
iter: 1  value: 226.5266 mgc: 19.11163 ustep: 1 
iter: 2  value: 226.391 mgc: 1.147521 ustep: 1 
iter: 3  value: 226.391 mgc: 0.005870081 ustep: 1 
iter: 4  value: 226.391 mgc: 5.413925e-07 ustep: 1 
iter: 5  mgc: 2.220446e-14 
iter: 1  value: 528.3182 mgc: 87.06188 ustep: 1 
iter: 2  value: 506.804 mgc: 21.29361 ustep: 1 
iter: 3  value: 506.7677 mgc: 0.9124395 ustep: 1 
iter: 4  value: 506.7677 mgc: 0.003036703 ustep: 1 
iter: 5  value: 506.7677 mgc: 3.473507e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  11.25201 
iter: 1  value: 256.6375 mgc: 44.22179 ustep: 1 
iter: 2  value: 254.0005 mgc: 5.768711 ustep: 1 
iter: 3  value: 253.9996 mgc: 0.08373563 ustep: 1 
iter: 4  value: 253.9996 mgc: 0.0001071598 ustep: 1 
iter: 5  mgc: 2.174725e-10 
iter: 1  value: 223.961 mgc: 10.28409 ustep: 1 
iter: 2  value: 223.9566 mgc: 0.2669612 ustep: 1 
iter: 3  value: 223.9566 mgc: 0.0002449642 ustep: 1 
iter: 4  mgc: 3.666938e-10 
iter: 1  mgc: 3.666938e-10 
outer mgc:  27.06468 
iter: 1  value: 218.9511 mgc: 3.972073 ustep: 1 
iter: 2  value: 218.9497 mgc: 0.08998535 ustep: 1 
iter: 3  value: 218.9497 mgc: 5.824959e-05 ustep: 1 
iter: 4  mgc: 8.876677e-11 
iter: 1  mgc: 8.876677e-11 
outer mgc:  10.17697 
iter: 1  value: 218.1649 mgc: 17.46651 ustep: 1 
iter: 2  value: 218.096 mgc: 0.7504453 ustep: 1 
iter: 3  value: 218.096 mgc: 0.003635833 ustep: 1 
iter: 4  value: 218.096 mgc: 2.96816e-07 ustep: 1 
iter: 5  mgc: 3.241851e-14 
iter: 1  value: 216.8552 mgc: 9.301659 ustep: 1 
iter: 2  value: 216.8526 mgc: 0.1826914 ustep: 1 
iter: 3  value: 216.8526 mgc: 0.0001696277 ustep: 1 
iter: 4  mgc: 5.856569e-10 
iter: 1  mgc: 5.856569e-10 
outer mgc:  23.04456 
iter: 1  value: 213.2722 mgc: 8.947297 ustep: 1 
iter: 2  value: 213.2705 mgc: 0.1279602 ustep: 1 
iter: 3  value: 213.2705 mgc: 2.895345e-05 ustep: 1 
iter: 4  mgc: 2.170708e-12 
iter: 1  mgc: 2.170708e-12 
outer mgc:  13.35298 
iter: 1  value: 210.4672 mgc: 5.120591 ustep: 1 
iter: 2  value: 210.4668 mgc: 0.05015136 ustep: 1 
iter: 3  value: 210.4668 mgc: 5.460517e-05 ustep: 1 
iter: 4  mgc: 6.070699e-11 
iter: 1  mgc: 6.070699e-11 
outer mgc:  9.692778 
iter: 1  value: 210.8983 mgc: 6.388361 ustep: 1 
iter: 2  value: 210.898 mgc: 0.07408393 ustep: 1 
iter: 3  value: 210.898 mgc: 2.970152e-05 ustep: 1 
iter: 4  mgc: 1.644107e-11 
iter: 1  value: 210.0544 mgc: 1.348829 ustep: 1 
iter: 2  value: 210.0544 mgc: 0.003355552 ustep: 1 
iter: 3  value: 210.0544 mgc: 2.422593e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  5.072415 
iter: 1  value: 209.7498 mgc: 2.071698 ustep: 1 
iter: 2  value: 209.7498 mgc: 0.007741918 ustep: 1 
iter: 3  value: 209.7498 mgc: 1.251204e-07 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  7.538363 
iter: 1  value: 209.2229 mgc: 2.25803 ustep: 1 
iter: 2  value: 209.2229 mgc: 0.005015513 ustep: 1 
iter: 3  value: 209.2229 mgc: 1.868865e-07 ustep: 1 
iter: 4  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  2.211699 
iter: 1  value: 208.9784 mgc: 1.429477 ustep: 1 
iter: 2  value: 208.9784 mgc: 0.0012773 ustep: 1 
iter: 3  value: 208.9784 mgc: 1.537749e-08 ustep: 1 
mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  3.544405 
iter: 1  value: 208.8077 mgc: 0.8337754 ustep: 1 
iter: 2  value: 208.8077 mgc: 0.00136306 ustep: 1 
iter: 3  mgc: 2.659546e-09 
iter: 1  mgc: 2.659546e-09 
outer mgc:  3.033958 
iter: 1  value: 208.4557 mgc: 0.5528447 ustep: 1 
iter: 2  value: 208.4557 mgc: 0.0008483908 ustep: 1 
iter: 3  mgc: 9.72022e-10 
iter: 1  value: 208.0114 mgc: 1.190641 ustep: 1 
iter: 2  value: 208.0114 mgc: 0.001171239 ustep: 1 
iter: 3  value: 208.0114 mgc: 1.036901e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  2.296607 
iter: 1  value: 207.6774 mgc: 1.549761 ustep: 1 
iter: 2  value: 207.6774 mgc: 0.001847249 ustep: 1 
iter: 3  value: 207.6774 mgc: 1.253502e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  5.13213 
iter: 1  value: 207.4337 mgc: 1.402501 ustep: 1 
iter: 2  value: 207.4337 mgc: 0.00216464 ustep: 1 
iter: 3  value: 207.4337 mgc: 4.922251e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  3.581049 
iter: 1  value: 206.9745 mgc: 1.063931 ustep: 1 
iter: 2  value: 206.9745 mgc: 0.0009293917 ustep: 1 
iter: 3  mgc: 1.930324e-09 
iter: 1  mgc: 1.930324e-09 
outer mgc:  3.771836 
iter: 1  value: 206.0118 mgc: 1.427327 ustep: 1 
iter: 2  value: 206.0118 mgc: 0.003144738 ustep: 1 
iter: 3  value: 206.0118 mgc: 9.412689e-08 ustep: 1 
iter: 4  mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  4.179285 
iter: 1  value: 205.3503 mgc: 1.232658 ustep: 1 
iter: 2  value: 205.3503 mgc: 0.002020609 ustep: 1 
iter: 3  value: 205.3503 mgc: 4.114206e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  1.043617 
iter: 1  value: 204.8531 mgc: 1.154854 ustep: 1 
iter: 2  value: 204.8531 mgc: 0.0007886507 ustep: 1 
iter: 3  mgc: 1.044375e-09 
iter: 1  mgc: 1.044375e-09 
outer mgc:  0.9187693 
iter: 1  value: 204.4351 mgc: 0.9891393 ustep: 1 
iter: 2  value: 204.4351 mgc: 0.0005868831 ustep: 1 
iter: 3  mgc: 3.95568e-10 
iter: 1  value: 204.6837 mgc: 0.3649416 ustep: 1 
iter: 2  value: 204.6837 mgc: 8.459862e-05 ustep: 1 
iter: 3  mgc: 8.311574e-12 
iter: 1  mgc: 8.311574e-12 
outer mgc:  0.7244277 
iter: 1  value: 204.2975 mgc: 1.163701 ustep: 1 
iter: 2  value: 204.2975 mgc: 0.000928371 ustep: 1 
iter: 3  mgc: 8.369216e-10 
iter: 1  mgc: 8.369216e-10 
outer mgc:  0.5434223 
iter: 1  value: 204.4279 mgc: 0.4769764 ustep: 1 
iter: 2  value: 204.4279 mgc: 0.0001489309 ustep: 1 
iter: 3  mgc: 4.594458e-11 
iter: 1  mgc: 4.594458e-11 
outer mgc:  0.01418337 
iter: 1  value: 204.4237 mgc: 0.01053829 ustep: 1 
iter: 2  value: 204.4237 mgc: 7.508132e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.002946545 
iter: 1  value: 204.422 mgc: 0.002826417 ustep: 1 
iter: 2  mgc: 5.292414e-09 
iter: 1  mgc: 5.292414e-09 
outer mgc:  7.050168e-05 
iter: 1  value: 204.4219 mgc: 0.0001525209 ustep: 1 
iter: 2  mgc: 1.506173e-11 
iter: 1  mgc: 1.506173e-11 
outer mgc:  7.777975e-06 
iter: 1  mgc: 1.506173e-11 
iter: 1  mgc: 1.506173e-11 
outer mgc:  7.777975e-06 
iter: 1  value: 204.4226 mgc: 0.05440454 ustep: 1 
iter: 2  value: 204.4226 mgc: 2.788341e-06 ustep: 1 
iter: 3  mgc: 9.237056e-14 
outer mgc:  0.3813355 
iter: 1  value: 204.4216 mgc: 0.05440976 ustep: 1 
iter: 2  value: 204.4216 mgc: 2.780947e-06 ustep: 1 
iter: 3  mgc: 1.136868e-13 
outer mgc:  0.3813769 
iter: 1  value: 204.4223 mgc: 0.02796073 ustep: 1 
iter: 2  value: 204.4223 mgc: 4.449574e-07 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.3475688 
iter: 1  value: 204.4218 mgc: 0.02796535 ustep: 1 
iter: 2  value: 204.4218 mgc: 4.440606e-07 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.3476068 
iter: 1  value: 204.4222 mgc: 0.04175937 ustep: 1 
iter: 2  value: 204.4222 mgc: 1.229773e-06 ustep: 1 
iter: 3  mgc: 2.253753e-14 
outer mgc:  0.4513009 
iter: 1  value: 204.4221 mgc: 0.04174555 ustep: 1 
iter: 2  value: 204.4221 mgc: 1.230489e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  0.4512194 
iter: 1  value: 204.4223 mgc: 0.02773754 ustep: 1 
iter: 2  value: 204.4223 mgc: 4.754436e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.3430733 
iter: 1  value: 204.4218 mgc: 0.02773233 ustep: 1 
iter: 2  value: 204.4218 mgc: 4.760175e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.3430227 
iter: 1  value: 204.4186 mgc: 0.005800125 ustep: 1 
iter: 2  value: 204.4186 mgc: 1.953013e-08 ustep: 1 
mgc: 2.620126e-14 
outer mgc:  0.001550514 
iter: 1  value: 204.4252 mgc: 0.005798474 ustep: 1 
iter: 2  value: 204.4252 mgc: 1.954484e-08 ustep: 1 
mgc: 2.847722e-14 
outer mgc:  0.00155307 
iter: 1  value: 204.4249 mgc: 0.04966345 ustep: 1 
iter: 2  value: 204.4249 mgc: 1.73097e-06 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.1070563 
iter: 1  value: 204.419 mgc: 0.04971314 ustep: 1 
iter: 2  value: 204.419 mgc: 1.734651e-06 ustep: 1 
iter: 3  mgc: 2.131628e-14 
outer mgc:  0.1071844 
iter: 1  value: 204.4347 mgc: 0.0595444 ustep: 1 
iter: 2  value: 204.4347 mgc: 3.675775e-06 ustep: 1 
iter: 3  mgc: 4.973799e-14 
outer mgc:  0.0825635 
iter: 1  value: 204.4092 mgc: 0.05970741 ustep: 1 
iter: 2  value: 204.4092 mgc: 3.682638e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.08242699 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:40:53 2021]
Finished job 0.
1 of 1 steps (100%) done

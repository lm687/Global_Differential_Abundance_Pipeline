Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:04:29 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21988.724958 
iter  10 value 17826.441378
final  value 17826.440558 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 16944.87 mgc: 4.094602 ustep: 0.6827823 
iter: 2  value: 16937.6 mgc: 2.942668 ustep: 0.8263238 
iter: 3  value: 16936.64 mgc: 1.643456 ustep: 0.9090326 
iter: 4  value: 16936.44 mgc: 0.8605728 ustep: 0.9534367 
iter: 5  value: 16936.44 mgc: 0.03157766 ustep: 0.9764432 
iter: 6  value: 16936.44 mgc: 0.0005391979 ustep: 0.9881526 
iter: 7  value: 16936.44 mgc: 7.447674e-06 ustep: 0.9940592 
iter: 8  value: 16936.44 mgc: 6.792951e-08 ustep: 0.9970255 
iter: 9  mgc: 3.327622e-10 
iter: 1  mgc: 3.327622e-10 
Matching hessian patterns... Done
outer mgc:  240.131 
iter: 1  value: 16776.77 mgc: 1.462631 ustep: 1 
iter: 2  value: 16776.73 mgc: 0.124799 ustep: 1 
iter: 3  value: 16776.73 mgc: 0.001878842 ustep: 1 
iter: 4  value: 16776.73 mgc: 2.529913e-07 ustep: 1 
iter: 5  mgc: 1.637579e-14 
iter: 1  mgc: 1.637579e-14 
outer mgc:  98.98503 
iter: 1  value: 16607.25 mgc: 1.498006 ustep: 1 
iter: 2  value: 16607.24 mgc: 0.07649798 ustep: 1 
iter: 3  value: 16607.24 mgc: 0.0001959612 ustep: 1 
iter: 4  mgc: 2.057168e-09 
iter: 1  value: 16181.18 mgc: 34.79229 ustep: 1 
iter: 2  value: 16181.07 mgc: 0.2781109 ustep: 1 
iter: 3  value: 16181.07 mgc: 0.0005351326 ustep: 1 
iter: 4  mgc: 3.039116e-09 
iter: 1  mgc: 3.039116e-09 
outer mgc:  110.8583 
iter: 1  value: 16670.29 mgc: 14.3029 ustep: 1 
iter: 2  value: 16670.29 mgc: 0.008535806 ustep: 1 
iter: 3  mgc: 3.922924e-10 
iter: 1  value: 16131.36 mgc: 2.894677 ustep: 1 
iter: 2  value: 16131.36 mgc: 0.01454968 ustep: 1 
iter: 3  value: 16131.36 mgc: 8.242179e-08 ustep: 1 
iter: 4  mgc: 2.858824e-15 
iter: 1  mgc: 2.858824e-15 
outer mgc:  89.51467 
iter: 1  value: 16050.51 mgc: 1.962601 ustep: 1 
iter: 2  value: 16050.51 mgc: 0.003605896 ustep: 1 
iter: 3  value: 16050.51 mgc: 9.453763e-08 ustep: 1 
iter: 4  mgc: 3.330669e-15 
iter: 1  mgc: 3.330669e-15 
outer mgc:  73.64047 
iter: 1  value: 15952.63 mgc: 2.508703 ustep: 1 
iter: 2  value: 15952.63 mgc: 0.005116271 ustep: 1 
iter: 3  value: 15952.63 mgc: 6.150454e-08 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  56.65312 
iter: 1  value: 15896.58 mgc: 1.79459 ustep: 1 
iter: 2  value: 15896.58 mgc: 0.0001601073 ustep: 1 
iter: 3  mgc: 9.07886e-11 
iter: 1  mgc: 9.07886e-11 
outer mgc:  37.59832 
iter: 1  value: 15827.09 mgc: 2.705002 ustep: 1 
iter: 2  value: 15827.09 mgc: 0.0006214114 ustep: 1 
iter: 3  mgc: 3.592149e-10 
iter: 1  mgc: 3.592149e-10 
outer mgc:  81.28018 
iter: 1  value: 15794.02 mgc: 4.093586 ustep: 1 
iter: 2  value: 15794.02 mgc: 0.0003164327 ustep: 1 
iter: 3  mgc: 8.980328e-11 
iter: 1  value: 15809.77 mgc: 2.170682 ustep: 1 
iter: 2  value: 15809.77 mgc: 7.776195e-05 ustep: 1 
iter: 3  mgc: 6.901146e-13 
iter: 1  mgc: 6.901146e-13 
outer mgc:  83.70538 
iter: 1  value: 15802.34 mgc: 1.609898 ustep: 1 
iter: 2  value: 15802.34 mgc: 0.0006810418 ustep: 1 
iter: 3  mgc: 2.713798e-10 
iter: 1  mgc: 2.713798e-10 
outer mgc:  36.38648 
iter: 1  value: 15792.22 mgc: 3.441484 ustep: 1 
iter: 2  value: 15792.22 mgc: 0.0004645542 ustep: 1 
iter: 3  mgc: 1.49179e-10 
iter: 1  mgc: 1.49179e-10 
outer mgc:  17.592 
iter: 1  value: 15801.29 mgc: 2.065663 ustep: 1 
iter: 2  value: 15801.29 mgc: 0.001312645 ustep: 1 
iter: 3  mgc: 2.981761e-09 
iter: 1  value: 15790.41 mgc: 0.4970485 ustep: 1 
iter: 2  value: 15790.41 mgc: 6.98734e-05 ustep: 1 
iter: 3  mgc: 6.676437e-12 
iter: 1  mgc: 6.676437e-12 
outer mgc:  15.6878 
iter: 1  value: 15789.56 mgc: 0.5076807 ustep: 1 
iter: 2  value: 15789.56 mgc: 4.626551e-05 ustep: 1 
iter: 3  mgc: 9.06164e-13 
iter: 1  mgc: 9.06164e-13 
outer mgc:  25.84514 
iter: 1  value: 15793.28 mgc: 0.4454791 ustep: 1 
iter: 2  value: 15793.28 mgc: 6.273198e-05 ustep: 1 
iter: 3  mgc: 3.342659e-12 
iter: 1  mgc: 3.342659e-12 
outer mgc:  10.02428 
iter: 1  value: 15797.16 mgc: 0.6137979 ustep: 1 
iter: 2  value: 15797.16 mgc: 9.163607e-05 ustep: 1 
iter: 3  mgc: 1.201883e-11 
iter: 1  mgc: 1.201883e-11 
outer mgc:  10.0844 
iter: 1  value: 15799.93 mgc: 0.6435068 ustep: 1 
iter: 2  value: 15799.93 mgc: 0.0001286527 ustep: 1 
iter: 3  mgc: 3.135225e-11 
iter: 1  mgc: 3.135225e-11 
outer mgc:  5.865182 
iter: 1  value: 15803.02 mgc: 0.297368 ustep: 1 
iter: 2  value: 15803.02 mgc: 7.34955e-05 ustep: 1 
iter: 3  mgc: 8.399059e-12 
iter: 1  mgc: 8.399059e-12 
outer mgc:  6.758601 
iter: 1  value: 15817.11 mgc: 0.6479323 ustep: 1 
iter: 2  value: 15817.11 mgc: 0.0003844065 ustep: 1 
iter: 3  mgc: 2.983138e-10 
iter: 1  mgc: 2.983138e-10 
outer mgc:  5.781154 
iter: 1  value: 15830.52 mgc: 0.870441 ustep: 1 
iter: 2  value: 15830.52 mgc: 0.000544853 ustep: 1 
iter: 3  mgc: 7.517591e-10 
iter: 1  mgc: 7.517591e-10 
outer mgc:  4.717447 
iter: 1  value: 15844.63 mgc: 1.339846 ustep: 1 
iter: 2  value: 15844.63 mgc: 0.0005170233 ustep: 1 
iter: 3  mgc: 1.834607e-09 
iter: 1  value: 15886.23 mgc: 2.880662 ustep: 1 
iter: 2  value: 15886.23 mgc: 0.007658151 ustep: 1 
iter: 3  value: 15886.23 mgc: 4.826004e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 16034.78 mgc: 4.542195 ustep: 1 
iter: 2  value: 16034.6 mgc: 1.144447 ustep: 1 
iter: 3  value: 16034.6 mgc: 0.02401022 ustep: 1 
iter: 4  value: 16034.6 mgc: 1.237431e-06 ustep: 1 
iter: 5  mgc: 2.78666e-14 
iter: 1  mgc: 7.105427e-15 
outer mgc:  6.526536 
iter: 1  value: 15932.49 mgc: 2.861254 ustep: 1 
iter: 2  value: 15932.49 mgc: 0.031316 ustep: 1 
iter: 3  value: 15932.49 mgc: 3.705251e-06 ustep: 1 
iter: 4  mgc: 8.348877e-14 
iter: 1  mgc: 8.348877e-14 
outer mgc:  6.868888 
iter: 1  value: 15956.97 mgc: 9.562564 ustep: 1 
iter: 2  value: 15956.96 mgc: 0.2581902 ustep: 1 
iter: 3  value: 15956.96 mgc: 0.0007534583 ustep: 1 
iter: 4  mgc: 3.330642e-09 
iter: 1  value: 15932.26 mgc: 1.939501 ustep: 1 
iter: 2  value: 15932.26 mgc: 0.003199923 ustep: 1 
iter: 3  value: 15932.26 mgc: 1.080223e-08 ustep: 1 
mgc: 7.771561e-15 
iter: 1  mgc: 7.771561e-15 
outer mgc:  7.536317 
iter: 1  value: 15931.3 mgc: 2.015433 ustep: 1 
iter: 2  value: 15931.3 mgc: 0.003420257 ustep: 1 
iter: 3  value: 15931.3 mgc: 1.506158e-08 ustep: 1 
mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  7.204197 
iter: 1  value: 15923.99 mgc: 1.866349 ustep: 1 
iter: 2  value: 15923.99 mgc: 0.002594196 ustep: 1 
iter: 3  mgc: 8.245864e-09 
iter: 1  mgc: 8.245864e-09 
outer mgc:  2.214218 
iter: 1  value: 15925.61 mgc: 1.070549 ustep: 1 
iter: 2  value: 15925.61 mgc: 0.0007749781 ustep: 1 
iter: 3  mgc: 6.144523e-10 
iter: 1  value: 15924.35 mgc: 0.3130044 ustep: 1 
iter: 2  value: 15924.35 mgc: 2.899076e-05 ustep: 1 
iter: 3  mgc: 4.662493e-12 
iter: 1  value: 15923.98 mgc: 0.07950844 ustep: 1 
iter: 2  value: 15923.98 mgc: 6.789182e-06 ustep: 1 
iter: 3  mgc: 1.416645e-13 
iter: 1  mgc: 1.416645e-13 
outer mgc:  2.839754 
iter: 1  value: 15923.47 mgc: 0.09383473 ustep: 1 
iter: 2  value: 15923.47 mgc: 5.521459e-06 ustep: 1 
iter: 3  mgc: 4.52971e-14 
iter: 1  mgc: 4.52971e-14 
outer mgc:  1.111361 
iter: 1  value: 15922.24 mgc: 0.137176 ustep: 1 
iter: 2  value: 15922.24 mgc: 1.796415e-05 ustep: 1 
iter: 3  mgc: 5.195844e-13 
iter: 1  mgc: 5.195844e-13 
outer mgc:  1.065223 
iter: 1  value: 15920.65 mgc: 0.1269873 ustep: 1 
iter: 2  value: 15920.65 mgc: 8.319706e-06 ustep: 1 
iter: 3  mgc: 9.592327e-14 
iter: 1  value: 15915.99 mgc: 0.379169 ustep: 1 
iter: 2  value: 15915.99 mgc: 7.042699e-05 ustep: 1 
iter: 3  mgc: 6.325607e-12 
iter: 1  mgc: 6.325607e-12 
outer mgc:  0.6632268 
iter: 1  value: 15906.86 mgc: 2.680132 ustep: 1 
iter: 2  value: 15906.86 mgc: 0.002696704 ustep: 1 
iter: 3  mgc: 4.520105e-09 
iter: 1  mgc: 4.520105e-09 
outer mgc:  1.866221 
iter: 1  value: 15888.17 mgc: 2.950884 ustep: 1 
iter: 2  value: 15888.17 mgc: 0.002094035 ustep: 1 
iter: 3  mgc: 3.209004e-09 
iter: 1  mgc: 3.209004e-09 
outer mgc:  1.242997 
iter: 1  value: 15875.42 mgc: 1.648711 ustep: 1 
iter: 2  value: 15875.42 mgc: 0.0001883562 ustep: 1 
iter: 3  mgc: 2.36442e-11 
iter: 1  mgc: 2.36442e-11 
outer mgc:  0.5541219 
iter: 1  value: 15864.34 mgc: 1.064607 ustep: 1 
iter: 2  value: 15864.34 mgc: 6.42701e-05 ustep: 1 
iter: 3  mgc: 1.816769e-12 
iter: 1  mgc: 1.816769e-12 
outer mgc:  0.2863015 
iter: 1  value: 15844.31 mgc: 2.21728 ustep: 1 
iter: 2  value: 15844.31 mgc: 0.0001132396 ustep: 1 
iter: 3  mgc: 8.955059e-12 
iter: 1  mgc: 8.955059e-12 
outer mgc:  0.6238126 
iter: 1  value: 15829.7 mgc: 2.197739 ustep: 1 
iter: 2  value: 15829.7 mgc: 8.61081e-05 ustep: 1 
iter: 3  mgc: 2.804867e-12 
iter: 1  mgc: 2.804867e-12 
outer mgc:  0.1290675 
iter: 1  value: 15816.09 mgc: 1.969671 ustep: 1 
iter: 2  value: 15816.09 mgc: 3.151786e-05 ustep: 1 
iter: 3  mgc: 4.796163e-13 
iter: 1  mgc: 4.796163e-13 
outer mgc:  0.1089019 
iter: 1  value: 15795.73 mgc: 2.560563 ustep: 1 
iter: 2  value: 15795.73 mgc: 2.291951e-05 ustep: 1 
iter: 3  mgc: 2.917666e-13 
iter: 1  mgc: 2.917666e-13 
outer mgc:  0.1231481 
iter: 1  value: 15778.67 mgc: 1.589546 ustep: 1 
iter: 2  value: 15778.67 mgc: 4.66419e-06 ustep: 1 
iter: 3  mgc: 9.148238e-14 
iter: 1  mgc: 9.148238e-14 
outer mgc:  0.07709353 
iter: 1  value: 15758.14 mgc: 2.292281 ustep: 1 
iter: 2  value: 15758.14 mgc: 3.978845e-06 ustep: 1 
iter: 3  mgc: 1.758593e-13 
iter: 1  mgc: 1.758593e-13 
outer mgc:  0.04847742 
iter: 1  value: 15741.18 mgc: 1.631387 ustep: 1 
iter: 2  value: 15741.18 mgc: 1.05173e-06 ustep: 1 
iter: 3  mgc: 3.055334e-13 
iter: 1  mgc: 3.055334e-13 
outer mgc:  0.01736702 
iter: 1  value: 15720.48 mgc: 2.303196 ustep: 1 
iter: 2  value: 15720.48 mgc: 9.935469e-07 ustep: 1 
iter: 3  mgc: 6.146195e-13 
iter: 1  mgc: 6.146195e-13 
outer mgc:  0.01741932 
iter: 1  value: 15703.37 mgc: 2.169719 ustep: 1 
iter: 2  value: 15703.37 mgc: 4.829203e-07 ustep: 1 
iter: 3  mgc: 5.697665e-13 
iter: 1  mgc: 5.697665e-13 
outer mgc:  0.00644782 
iter: 1  value: 15682.51 mgc: 2.800675 ustep: 1 
iter: 2  value: 15682.51 mgc: 2.902903e-07 ustep: 1 
iter: 3  mgc: 6.674661e-13 
iter: 1  mgc: 6.674661e-13 
outer mgc:  0.01861724 
iter: 1  value: 15665.26 mgc: 1.93361 ustep: 1 
iter: 2  value: 15665.26 mgc: 9.348368e-08 ustep: 1 
iter: 3  mgc: 1.269873e-12 
iter: 1  mgc: 1.269873e-12 
outer mgc:  0.007023725 
iter: 1  value: 15644.28 mgc: 2.037746 ustep: 1 
iter: 2  value: 15644.28 mgc: 3.110328e-08 ustep: 1 
mgc: 2.085887e-12 
iter: 1  mgc: 2.085887e-12 
outer mgc:  0.01297751 
iter: 1  value: 15626.96 mgc: 1.67188 ustep: 1 
iter: 2  value: 15626.96 mgc: 1.475861e-08 ustep: 1 
mgc: 3.104406e-12 
iter: 1  mgc: 3.104406e-12 
outer mgc:  0.004213598 
iter: 1  value: 15605.95 mgc: 1.995008 ustep: 1 
iter: 2  mgc: 7.763764e-09 
iter: 1  mgc: 7.763764e-09 
outer mgc:  0.007375462 
iter: 1  value: 15588.61 mgc: 1.870195 ustep: 1 
iter: 2  mgc: 5.282363e-09 
iter: 1  mgc: 5.282363e-09 
outer mgc:  0.002476501 
iter: 1  value: 15567.59 mgc: 2.661069 ustep: 1 
iter: 2  mgc: 1.776108e-09 
iter: 1  mgc: 1.776108e-09 
outer mgc:  0.004651813 
iter: 1  value: 15550.24 mgc: 2.080113 ustep: 1 
iter: 2  mgc: 1.480948e-09 
iter: 1  mgc: 1.480948e-09 
outer mgc:  0.001614113 
iter: 1  value: 15529.23 mgc: 2.419012 ustep: 1 
iter: 2  mgc: 4.184924e-10 
iter: 1  mgc: 4.184924e-10 
outer mgc:  0.002639313 
iter: 1  value: 15511.88 mgc: 1.649581 ustep: 1 
iter: 2  mgc: 2.421809e-10 
iter: 1  mgc: 2.421809e-10 
outer mgc:  0.0008140561 
iter: 1  mgc: 2.421809e-10 
iter: 1  mgc: 2.421809e-10 
outer mgc:  0.0008140561 
iter: 1  value: 15511.88 mgc: 0.004988618 ustep: 1 
iter: 2  value: 15511.88 mgc: 2.17379e-08 ustep: 1 
iter: 3  mgc: 3.520295e-11 
outer mgc:  0.3572974 
iter: 1  value: 15511.88 mgc: 0.004986893 ustep: 1 
iter: 2  value: 15511.88 mgc: 2.165117e-08 ustep: 1 
iter: 3  mgc: 2.332001e-11 
outer mgc:  0.3558521 
iter: 1  value: 15511.88 mgc: 0.002944516 ustep: 1 
iter: 2  mgc: 4.425e-10 
outer mgc:  0.2070398 
iter: 1  value: 15511.88 mgc: 0.002944605 ustep: 1 
iter: 2  mgc: 4.419556e-10 
outer mgc:  0.2057044 
iter: 1  value: 15511.88 mgc: 0.00524575 ustep: 1 
iter: 2  value: 15511.88 mgc: 4.134249e-08 ustep: 1 
iter: 3  mgc: 2.523537e-11 
outer mgc:  0.345835 
iter: 1  value: 15511.88 mgc: 0.005244873 ustep: 1 
iter: 2  value: 15511.88 mgc: 4.130374e-08 ustep: 1 
iter: 3  mgc: 4.236034e-11 
outer mgc:  0.3464 
iter: 1  value: 15511.88 mgc: 0.002847794 ustep: 1 
iter: 2  mgc: 2.935111e-09 
outer mgc:  0.2151219 
iter: 1  value: 15511.88 mgc: 0.002847369 ustep: 1 
iter: 2  mgc: 2.943917e-09 
outer mgc:  0.2168249 
iter: 1  value: 15511.97 mgc: 121.7504 ustep: 1 
iter: 2  value: 15511.97 mgc: 7.610859e-07 ustep: 1 
iter: 3  mgc: 1.913847e-11 
outer mgc:  0.02940574 
iter: 1  value: 15511.79 mgc: 122.1162 ustep: 1 
iter: 2  value: 15511.79 mgc: 7.596874e-07 ustep: 1 
iter: 3  mgc: 2.738165e-11 
outer mgc:  0.02923377 
iter: 1  value: 15511.96 mgc: 121.8685 ustep: 1 
iter: 2  value: 15511.96 mgc: 4.482139e-07 ustep: 1 
iter: 3  mgc: 3.52971e-11 
outer mgc:  0.03967348 
iter: 1  value: 15511.81 mgc: 121.9905 ustep: 1 
iter: 2  value: 15511.81 mgc: 4.475467e-07 ustep: 1 
iter: 3  mgc: 3.063469e-11 
outer mgc:  0.03949993 
iter: 1  value: 15511.88 mgc: 5.034872e-05 ustep: 1 
mgc: 3.199574e-11 
outer mgc:  0.000814056 
iter: 1  value: 15511.88 mgc: 5.034796e-05 ustep: 1 
mgc: 3.559952e-11 
outer mgc:  0.0008140561 
iter: 1  value: 15511.87 mgc: 0.004144955 ustep: 1 
iter: 2  value: 15511.87 mgc: 3.013937e-08 ustep: 1 
iter: 3  mgc: 2.535838e-11 
outer mgc:  0.1454497 
iter: 1  value: 15511.9 mgc: 0.004141792 ustep: 1 
iter: 2  value: 15511.9 mgc: 3.005854e-08 ustep: 1 
iter: 3  mgc: 3.442868e-11 
outer mgc:  0.1442327 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:04:33 2021]
Finished job 0.
1 of 1 steps (100%) done

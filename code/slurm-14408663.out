Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:19:48 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4448.281157 
final  value 3972.098380 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 775.1678 mgc: 117.5199 ustep: 1 
iter: 2  value: 649.8609 mgc: 49.42273 ustep: 1 
iter: 3  value: 645.5132 mgc: 9.451099 ustep: 1 
iter: 4  value: 645.4952 mgc: 0.3972295 ustep: 1 
iter: 5  value: 645.4952 mgc: 0.005936968 ustep: 1 
iter: 6  value: 645.4952 mgc: 1.299006e-06 ustep: 1 
iter: 7  mgc: 8.126833e-14 
iter: 1  mgc: 8.126833e-14 
Matching hessian patterns... Done
outer mgc:  358.6703 
iter: 1  value: 389.8994 mgc: 42.53056 ustep: 1 
iter: 2  value: 380.0971 mgc: 10.27477 ustep: 1 
iter: 3  value: 380.0606 mgc: 0.7701666 ustep: 1 
iter: 4  value: 380.0606 mgc: 0.005854887 ustep: 1 
iter: 5  value: 380.0606 mgc: 3.72067e-07 ustep: 1 
iter: 6  mgc: 3.343419e-14 
iter: 1  mgc: 3.343419e-14 
outer mgc:  97.60606 
iter: 1  value: 348.0503 mgc: 24.60375 ustep: 1 
iter: 2  value: 347.8038 mgc: 1.930289 ustep: 1 
iter: 3  value: 347.8038 mgc: 0.01572526 ustep: 1 
iter: 4  value: 347.8038 mgc: 1.345816e-06 ustep: 1 
iter: 5  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  13.90926 
iter: 1  value: 342.9508 mgc: 34.88613 ustep: 1 
iter: 2  value: 336.6834 mgc: 6.660575 ustep: 1 
iter: 3  value: 336.6719 mgc: 0.3033778 ustep: 1 
iter: 4  value: 336.6719 mgc: 0.001079935 ustep: 1 
iter: 5  value: 336.6719 mgc: 1.976261e-08 ustep: 1 
mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  22.03798 
iter: 1  value: 340.4497 mgc: 28.21052 ustep: 1 
iter: 2  value: 339.7771 mgc: 3.949805 ustep: 1 
iter: 3  value: 339.777 mgc: 0.05486577 ustep: 1 
iter: 4  value: 339.777 mgc: 1.158188e-05 ustep: 1 
iter: 5  mgc: 5.955236e-13 
iter: 1  value: 329.1571 mgc: 8.251409 ustep: 1 
iter: 2  value: 329.1478 mgc: 0.1841469 ustep: 1 
iter: 3  value: 329.1478 mgc: 0.0005328124 ustep: 1 
iter: 4  mgc: 5.680474e-09 
iter: 1  mgc: 5.680474e-09 
outer mgc:  6.732802 
iter: 1  value: 327.9867 mgc: 5.787356 ustep: 1 
iter: 2  value: 327.985 mgc: 0.172685 ustep: 1 
iter: 3  value: 327.985 mgc: 0.0003436374 ustep: 1 
iter: 4  mgc: 3.346672e-09 
iter: 1  mgc: 3.346672e-09 
outer mgc:  8.51017 
iter: 1  value: 329.108 mgc: 2.434819 ustep: 1 
iter: 2  value: 329.108 mgc: 0.02343044 ustep: 1 
iter: 3  value: 329.108 mgc: 4.803429e-06 ustep: 1 
iter: 4  mgc: 6.763479e-13 
iter: 1  value: 327.6176 mgc: 1.099607 ustep: 1 
iter: 2  value: 327.6176 mgc: 0.004607044 ustep: 1 
iter: 3  value: 327.6176 mgc: 2.154676e-07 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  7.322472 
iter: 1  value: 327.7358 mgc: 5.010593 ustep: 1 
iter: 2  value: 327.7354 mgc: 0.06050513 ustep: 1 
iter: 3  value: 327.7354 mgc: 2.901743e-05 ustep: 1 
iter: 4  mgc: 7.162715e-12 
iter: 1  value: 327.3863 mgc: 2.296183 ustep: 1 
iter: 2  value: 327.3863 mgc: 0.01284987 ustep: 1 
iter: 3  value: 327.3863 mgc: 1.306288e-06 ustep: 1 
iter: 4  mgc: 3.064216e-14 
iter: 1  mgc: 3.064216e-14 
outer mgc:  3.497405 
iter: 1  value: 327.3843 mgc: 1.10698 ustep: 1 
iter: 2  value: 327.3843 mgc: 0.004133249 ustep: 1 
iter: 3  value: 327.3843 mgc: 7.28029e-08 ustep: 1 
mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  3.784543 
iter: 1  value: 327.3615 mgc: 0.5811361 ustep: 1 
iter: 2  value: 327.3615 mgc: 0.002939568 ustep: 1 
iter: 3  value: 327.3615 mgc: 1.511732e-07 ustep: 1 
iter: 4  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  4.046184 
iter: 1  value: 327.215 mgc: 2.151799 ustep: 1 
iter: 2  value: 327.215 mgc: 0.01855121 ustep: 1 
iter: 3  value: 327.215 mgc: 2.690001e-06 ustep: 1 
iter: 4  mgc: 6.039613e-14 
iter: 1  mgc: 6.039613e-14 
outer mgc:  1.306068 
iter: 1  value: 327.2768 mgc: 2.076424 ustep: 1 
iter: 2  value: 327.2768 mgc: 0.01278032 ustep: 1 
iter: 3  value: 327.2768 mgc: 1.38476e-06 ustep: 1 
iter: 4  mgc: 3.419487e-14 
iter: 1  value: 327.2329 mgc: 0.9693882 ustep: 1 
iter: 2  value: 327.2329 mgc: 0.002950837 ustep: 1 
iter: 3  value: 327.2329 mgc: 4.398591e-08 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  2.059852 
iter: 1  value: 327.287 mgc: 1.405363 ustep: 1 
iter: 2  value: 327.287 mgc: 0.003521658 ustep: 1 
iter: 3  value: 327.287 mgc: 1.086742e-07 ustep: 1 
mgc: 3.647083e-14 
iter: 1  value: 327.247 mgc: 0.5349146 ustep: 1 
iter: 2  value: 327.247 mgc: 0.0003945127 ustep: 1 
iter: 3  mgc: 1.359475e-09 
iter: 1  mgc: 1.359475e-09 
outer mgc:  1.869295 
iter: 1  value: 327.2171 mgc: 0.5735672 ustep: 1 
iter: 2  value: 327.2171 mgc: 0.000776008 ustep: 1 
iter: 3  mgc: 4.750817e-09 
iter: 1  mgc: 4.750817e-09 
outer mgc:  0.7432087 
iter: 1  value: 327.2234 mgc: 0.2281052 ustep: 1 
iter: 2  value: 327.2234 mgc: 0.0001265177 ustep: 1 
iter: 3  mgc: 7.223733e-11 
iter: 1  mgc: 7.223733e-11 
outer mgc:  1.288597 
iter: 1  value: 327.1819 mgc: 0.1738767 ustep: 1 
iter: 2  value: 327.1819 mgc: 0.0001495517 ustep: 1 
iter: 3  mgc: 1.603102e-09 
iter: 1  mgc: 1.603102e-09 
outer mgc:  0.5618866 
iter: 1  value: 327.2145 mgc: 0.3638012 ustep: 1 
iter: 2  value: 327.2145 mgc: 0.0008633618 ustep: 1 
iter: 3  value: 327.2145 mgc: 1.549007e-08 ustep: 1 
mgc: 1.465494e-14 
iter: 1  mgc: 1.465494e-14 
outer mgc:  0.9265769 
iter: 1  value: 327.2024 mgc: 0.0683534 ustep: 1 
iter: 2  value: 327.2024 mgc: 3.910647e-05 ustep: 1 
iter: 3  mgc: 2.488187e-11 
iter: 1  mgc: 2.488187e-11 
outer mgc:  1.846646 
iter: 1  value: 327.1881 mgc: 0.2635288 ustep: 1 
iter: 2  value: 327.1881 mgc: 0.0001656832 ustep: 1 
iter: 3  mgc: 3.454121e-10 
iter: 1  mgc: 3.454121e-10 
outer mgc:  0.256364 
iter: 1  value: 327.1846 mgc: 0.3005674 ustep: 1 
iter: 2  value: 327.1846 mgc: 0.0002020874 ustep: 1 
iter: 3  mgc: 4.530377e-10 
iter: 1  mgc: 4.530377e-10 
outer mgc:  0.3025125 
iter: 1  value: 327.1654 mgc: 0.4600435 ustep: 1 
iter: 2  value: 327.1654 mgc: 0.0006002724 ustep: 1 
iter: 3  mgc: 2.866528e-09 
iter: 1  mgc: 2.866528e-09 
outer mgc:  0.3329504 
iter: 1  value: 327.1762 mgc: 0.4167008 ustep: 1 
iter: 2  value: 327.1762 mgc: 0.0007213465 ustep: 1 
iter: 3  mgc: 6.568326e-09 
iter: 1  value: 327.1706 mgc: 0.1792022 ustep: 1 
iter: 2  value: 327.1706 mgc: 8.313942e-05 ustep: 1 
iter: 3  mgc: 8.013079e-11 
iter: 1  mgc: 8.013079e-11 
outer mgc:  0.08306092 
iter: 1  value: 327.1762 mgc: 0.1193087 ustep: 1 
iter: 2  value: 327.1762 mgc: 7.618192e-05 ustep: 1 
iter: 3  mgc: 7.101342e-11 
iter: 1  mgc: 7.101342e-11 
outer mgc:  0.07799048 
iter: 1  value: 327.178 mgc: 0.01920325 ustep: 1 
iter: 2  value: 327.178 mgc: 4.542351e-06 ustep: 1 
iter: 3  mgc: 4.169998e-13 
iter: 1  mgc: 4.169998e-13 
outer mgc:  0.04315326 
iter: 1  value: 327.178 mgc: 0.0448824 ustep: 1 
iter: 2  value: 327.178 mgc: 7.441342e-06 ustep: 1 
iter: 3  mgc: 8.06688e-13 
iter: 1  mgc: 8.06688e-13 
outer mgc:  0.05229941 
iter: 1  value: 327.1758 mgc: 0.05140577 ustep: 1 
iter: 2  value: 327.1758 mgc: 1.113856e-05 ustep: 1 
iter: 3  mgc: 2.35989e-12 
iter: 1  value: 327.1769 mgc: 0.02519731 ustep: 1 
iter: 2  value: 327.1769 mgc: 2.608036e-06 ustep: 1 
iter: 3  mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  0.02090902 
iter: 1  value: 327.1766 mgc: 0.02869667 ustep: 1 
iter: 2  value: 327.1766 mgc: 1.971742e-06 ustep: 1 
iter: 3  mgc: 4.751755e-14 
iter: 1  mgc: 4.751755e-14 
outer mgc:  0.01050304 
iter: 1  value: 327.177 mgc: 0.007635155 ustep: 1 
iter: 2  value: 327.177 mgc: 1.701015e-07 ustep: 1 
mgc: 2.331468e-14 
iter: 1  mgc: 2.331468e-14 
outer mgc:  0.001604424 
iter: 1  value: 327.1769 mgc: 0.00212708 ustep: 1 
iter: 2  value: 327.1769 mgc: 2.220378e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  0.0008656416 
iter: 1  value: 327.1769 mgc: 0.0008448492 ustep: 1 
iter: 2  mgc: 2.456938e-09 
iter: 1  mgc: 2.456938e-09 
outer mgc:  3.398171e-05 
iter: 1  mgc: 2.456938e-09 
iter: 1  mgc: 2.456938e-09 
outer mgc:  3.398171e-05 
iter: 1  value: 327.1766 mgc: 0.05697208 ustep: 1 
iter: 2  value: 327.1766 mgc: 9.001412e-06 ustep: 1 
iter: 3  mgc: 7.626122e-13 
outer mgc:  0.04021613 
iter: 1  value: 327.1772 mgc: 0.05696297 ustep: 1 
iter: 2  value: 327.1772 mgc: 9.009056e-06 ustep: 1 
iter: 3  mgc: 7.726042e-13 
outer mgc:  0.04019869 
iter: 1  value: 327.1765 mgc: 0.03126313 ustep: 1 
iter: 2  value: 327.1765 mgc: 2.060005e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.1749525 
iter: 1  value: 327.1774 mgc: 0.03125505 ustep: 1 
iter: 2  value: 327.1774 mgc: 2.058977e-06 ustep: 1 
iter: 3  mgc: 6.17284e-14 
outer mgc:  0.1749538 
iter: 1  value: 327.1775 mgc: 0.05639707 ustep: 1 
iter: 2  value: 327.1775 mgc: 7.848814e-06 ustep: 1 
iter: 3  mgc: 2.899903e-13 
outer mgc:  0.0685074 
iter: 1  value: 327.1763 mgc: 0.05639158 ustep: 1 
iter: 2  value: 327.1763 mgc: 7.838685e-06 ustep: 1 
iter: 3  mgc: 2.939871e-13 
outer mgc:  0.06855492 
iter: 1  value: 327.1782 mgc: 0.03337791 ustep: 1 
iter: 2  value: 327.1782 mgc: 1.9914e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.2384085 
iter: 1  value: 327.1758 mgc: 0.03337992 ustep: 1 
iter: 2  value: 327.1758 mgc: 1.993341e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.2385057 
iter: 1  value: 327.1759 mgc: 0.004761012 ustep: 1 
iter: 2  value: 327.1759 mgc: 1.000439e-07 ustep: 1 
mgc: 2.975398e-14 
outer mgc:  0.01243914 
iter: 1  value: 327.1778 mgc: 0.004756409 ustep: 1 
iter: 2  value: 327.1778 mgc: 9.98906e-08 ustep: 1 
mgc: 3.774758e-14 
outer mgc:  0.01243403 
iter: 1  value: 327.1784 mgc: 0.00711214 ustep: 1 
iter: 2  value: 327.1784 mgc: 7.063241e-07 ustep: 1 
iter: 3  mgc: 3.197442e-14 
outer mgc:  0.0529529 
iter: 1  value: 327.1754 mgc: 0.007128741 ustep: 1 
iter: 2  value: 327.1754 mgc: 7.09008e-07 ustep: 1 
iter: 3  mgc: 2.214895e-14 
outer mgc:  0.05303631 
iter: 1  value: 327.1789 mgc: 0.009409164 ustep: 1 
iter: 2  value: 327.1789 mgc: 4.379052e-07 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.05053135 
iter: 1  value: 327.1749 mgc: 0.009427948 ustep: 1 
iter: 2  value: 327.1749 mgc: 4.398057e-07 ustep: 1 
iter: 3  mgc: 3.574918e-14 
outer mgc:  0.05060482 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:19:51 2021]
Finished job 0.
1 of 1 steps (100%) done

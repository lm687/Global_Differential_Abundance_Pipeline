Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:51:58 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_4_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_4_0.02_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_4_0.02_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=4, beta_intensity=0.02, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_4_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_4_0.02_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_4_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_4_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_4_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 5538.245973 
iter  10 value 5080.970284
final  value 5080.896699 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2150.663 mgc: 96.92635 ustep: 0.4367355 
iter: 2  value: 2145.599 mgc: 91.52296 ustep: 0.2368445 
iter: 3  value: 1168.235 mgc: 140.903 ustep: 0.07996042 
iter: 4  value: 830.4039 mgc: 68.76798 ustep: 0.07973897 
iter: 5  value: 775.3407 mgc: 46.08677 ustep: 0.2824527 
iter: 6  value: 774.936 mgc: 3.406151 ustep: 0.5315096 
iter: 7  value: 774.9314 mgc: 0.3569254 ustep: 0.7290742 
iter: 8  value: 774.9313 mgc: 0.01075457 ustep: 0.853873 
iter: 9  value: 774.9313 mgc: 0.0001186947 ustep: 0.9240601 
iter: 10  value: 774.9313 mgc: 6.437798e-07 ustep: 0.9612843 
iter: 11  mgc: 3.867178e-09 
iter: 1  mgc: 3.867178e-09 
Matching hessian patterns... Done
outer mgc:  246.3207 
iter: 1  value: 614.8721 mgc: 28.21068 ustep: 1 
iter: 2  value: 614.148 mgc: 2.475613 ustep: 1 
iter: 3  value: 614.1479 mgc: 0.0472761 ustep: 1 
iter: 4  value: 614.1479 mgc: 1.90484e-05 ustep: 1 
iter: 5  mgc: 3.105738e-12 
iter: 1  mgc: 3.105738e-12 
outer mgc:  74.29558 
iter: 1  value: 557.5632 mgc: 12.41426 ustep: 1 
iter: 2  value: 557.0892 mgc: 1.589635 ustep: 1 
iter: 3  value: 557.089 mgc: 0.03425722 ustep: 1 
iter: 4  value: 557.089 mgc: 2.966023e-05 ustep: 1 
iter: 5  mgc: 2.940942e-11 
iter: 1  mgc: 2.940942e-11 
outer mgc:  33.03524 
iter: 1  value: 564.5454 mgc: 30.19093 ustep: 1 
iter: 2  value: 548.9844 mgc: 13.26202 ustep: 1 
iter: 3  value: 548.8979 mgc: 0.7932787 ustep: 1 
iter: 4  value: 548.8979 mgc: 0.007715013 ustep: 1 
iter: 5  value: 548.8979 mgc: 2.468202e-06 ustep: 1 
iter: 6  mgc: 2.559619e-13 
iter: 1  mgc: 2.559619e-13 
outer mgc:  57.48664 
iter: 1  value: 523.939 mgc: 18.45636 ustep: 1 
iter: 2  value: 523.8353 mgc: 0.627078 ustep: 1 
iter: 3  value: 523.8353 mgc: 0.006574031 ustep: 1 
iter: 4  value: 523.8353 mgc: 1.428592e-06 ustep: 1 
iter: 5  mgc: 7.749357e-14 
iter: 1  mgc: 7.749357e-14 
outer mgc:  40.0561 
iter: 1  value: 542.8059 mgc: 38.02701 ustep: 1 
iter: 2  value: 538.3101 mgc: 7.105081 ustep: 1 
iter: 3  value: 538.3024 mgc: 0.2447346 ustep: 1 
iter: 4  value: 538.3024 mgc: 0.001355884 ustep: 1 
iter: 5  value: 538.3024 mgc: 4.201223e-08 ustep: 1 
mgc: 3.157891e-14 
iter: 1  value: 521.2413 mgc: 14.01879 ustep: 1 
iter: 2  value: 521.2092 mgc: 0.6221133 ustep: 1 
iter: 3  value: 521.2092 mgc: 0.00228024 ustep: 1 
iter: 4  value: 521.2092 mgc: 5.978022e-08 ustep: 1 
mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  33.93976 
iter: 1  value: 516.0262 mgc: 3.627292 ustep: 1 
iter: 2  value: 516.0228 mgc: 0.1569876 ustep: 1 
iter: 3  value: 516.0228 mgc: 0.0009091894 ustep: 1 
iter: 4  value: 516.0228 mgc: 3.050159e-08 ustep: 1 
mgc: 1.754152e-14 
iter: 1  mgc: 1.754152e-14 
outer mgc:  8.631811 
iter: 1  value: 514.9417 mgc: 14.80694 ustep: 1 
iter: 2  value: 514.7149 mgc: 1.198763 ustep: 1 
iter: 3  value: 514.7148 mgc: 0.01138619 ustep: 1 
iter: 4  value: 514.7148 mgc: 1.633442e-06 ustep: 1 
iter: 5  mgc: 5.329071e-14 
iter: 1  mgc: 5.329071e-14 
outer mgc:  9.9352 
iter: 1  value: 511.9714 mgc: 8.114776 ustep: 1 
iter: 2  value: 511.9661 mgc: 0.1439589 ustep: 1 
iter: 3  value: 511.9661 mgc: 0.0003602413 ustep: 1 
iter: 4  mgc: 4.108006e-09 
iter: 1  mgc: 4.108006e-09 
outer mgc:  2.905998 
iter: 1  value: 513.1979 mgc: 6.122251 ustep: 1 
iter: 2  value: 513.1905 mgc: 0.2113246 ustep: 1 
iter: 3  value: 513.1905 mgc: 0.0005444767 ustep: 1 
iter: 4  mgc: 3.641252e-09 
iter: 1  value: 511.7631 mgc: 1.99107 ustep: 1 
iter: 2  value: 511.763 mgc: 0.02047636 ustep: 1 
iter: 3  value: 511.763 mgc: 5.130442e-06 ustep: 1 
iter: 4  mgc: 3.209655e-13 
iter: 1  mgc: 3.209655e-13 
outer mgc:  3.996007 
iter: 1  value: 511.5106 mgc: 2.437832 ustep: 1 
iter: 2  value: 511.5104 mgc: 0.04095061 ustep: 1 
iter: 3  value: 511.5104 mgc: 1.394571e-05 ustep: 1 
iter: 4  mgc: 2.75438e-12 
iter: 1  mgc: 2.75438e-12 
outer mgc:  3.795844 
iter: 1  value: 511.1105 mgc: 2.655311 ustep: 1 
iter: 2  value: 511.1104 mgc: 0.02382128 ustep: 1 
iter: 3  value: 511.1104 mgc: 3.17738e-06 ustep: 1 
iter: 4  mgc: 1.798561e-13 
iter: 1  mgc: 1.798561e-13 
outer mgc:  2.275135 
iter: 1  value: 510.9445 mgc: 1.912918 ustep: 1 
iter: 2  value: 510.9444 mgc: 0.02052983 ustep: 1 
iter: 3  value: 510.9444 mgc: 3.239365e-06 ustep: 1 
iter: 4  mgc: 1.532802e-13 
iter: 1  mgc: 1.532802e-13 
outer mgc:  4.301643 
iter: 1  value: 510.7015 mgc: 2.118342 ustep: 1 
iter: 2  value: 510.7014 mgc: 0.01622601 ustep: 1 
iter: 3  value: 510.7014 mgc: 4.08405e-06 ustep: 1 
iter: 4  mgc: 5.240253e-13 
iter: 1  mgc: 5.240253e-13 
outer mgc:  5.433438 
iter: 1  value: 510.5757 mgc: 3.226983 ustep: 1 
iter: 2  value: 510.5756 mgc: 0.021199 ustep: 1 
iter: 3  value: 510.5756 mgc: 2.507757e-06 ustep: 1 
iter: 4  mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  1.518891 
iter: 1  value: 510.5663 mgc: 2.120837 ustep: 1 
iter: 2  value: 510.5662 mgc: 0.02188286 ustep: 1 
iter: 3  value: 510.5662 mgc: 4.700881e-06 ustep: 1 
iter: 4  mgc: 5.369039e-13 
iter: 1  mgc: 5.369039e-13 
outer mgc:  3.589857 
iter: 1  value: 510.3463 mgc: 1.44419 ustep: 1 
iter: 2  value: 510.3463 mgc: 0.01677183 ustep: 1 
iter: 3  value: 510.3463 mgc: 3.686551e-06 ustep: 1 
iter: 4  mgc: 2.657319e-13 
iter: 1  mgc: 2.657319e-13 
outer mgc:  2.835479 
iter: 1  value: 510.3471 mgc: 1.292067 ustep: 1 
iter: 2  value: 510.3471 mgc: 0.01110864 ustep: 1 
iter: 3  value: 510.3471 mgc: 3.114562e-06 ustep: 1 
iter: 4  mgc: 2.385869e-13 
iter: 1  mgc: 2.385869e-13 
outer mgc:  4.614172 
iter: 1  value: 510.3648 mgc: 2.106296 ustep: 1 
iter: 2  value: 510.3648 mgc: 0.01021781 ustep: 1 
iter: 3  value: 510.3648 mgc: 1.790709e-06 ustep: 1 
iter: 4  mgc: 6.57252e-14 
iter: 1  mgc: 6.57252e-14 
outer mgc:  1.338405 
iter: 1  value: 510.3236 mgc: 1.129306 ustep: 1 
iter: 2  value: 510.3236 mgc: 0.007519587 ustep: 1 
iter: 3  value: 510.3236 mgc: 1.392239e-06 ustep: 1 
iter: 4  mgc: 6.528111e-14 
iter: 1  value: 510.3384 mgc: 0.6706832 ustep: 1 
iter: 2  value: 510.3384 mgc: 0.002164363 ustep: 1 
iter: 3  value: 510.3384 mgc: 3.532666e-08 ustep: 1 
mgc: 3.330669e-14 
iter: 1  mgc: 3.330669e-14 
outer mgc:  1.762939 
iter: 1  value: 510.2821 mgc: 0.1039758 ustep: 1 
iter: 2  value: 510.2821 mgc: 0.0001906466 ustep: 1 
iter: 3  mgc: 1.208955e-09 
iter: 1  mgc: 1.208955e-09 
outer mgc:  0.4609228 
iter: 1  value: 510.2987 mgc: 0.6114904 ustep: 1 
iter: 2  value: 510.2987 mgc: 0.00125913 ustep: 1 
iter: 3  mgc: 9.932839e-09 
iter: 1  value: 510.2913 mgc: 0.1744249 ustep: 1 
iter: 2  value: 510.2913 mgc: 0.0001704183 ustep: 1 
iter: 3  mgc: 2.71447e-10 
iter: 1  mgc: 2.71447e-10 
outer mgc:  0.465568 
iter: 1  value: 510.3021 mgc: 0.3319129 ustep: 1 
iter: 2  value: 510.3021 mgc: 0.0002257543 ustep: 1 
iter: 3  mgc: 3.070637e-10 
iter: 1  mgc: 3.070637e-10 
outer mgc:  0.5543813 
iter: 1  value: 510.3137 mgc: 0.3370491 ustep: 1 
iter: 2  value: 510.3137 mgc: 0.0003272981 ustep: 1 
iter: 3  mgc: 6.497209e-10 
iter: 1  mgc: 6.497209e-10 
outer mgc:  0.1613649 
iter: 1  value: 510.3008 mgc: 0.2518018 ustep: 1 
iter: 2  value: 510.3008 mgc: 0.0002143372 ustep: 1 
iter: 3  mgc: 3.043823e-10 
iter: 1  value: 510.3076 mgc: 0.1310773 ustep: 1 
iter: 2  value: 510.3076 mgc: 6.095006e-05 ustep: 1 
iter: 3  mgc: 2.2085e-11 
iter: 1  mgc: 2.2085e-11 
outer mgc:  0.1185653 
iter: 1  value: 510.3017 mgc: 0.06833399 ustep: 1 
iter: 2  value: 510.3017 mgc: 2.658752e-05 ustep: 1 
iter: 3  mgc: 4.313105e-12 
iter: 1  mgc: 4.313105e-12 
outer mgc:  0.1251874 
iter: 1  value: 510.304 mgc: 0.03900381 ustep: 1 
iter: 2  value: 510.304 mgc: 6.844807e-06 ustep: 1 
iter: 3  mgc: 3.417266e-13 
iter: 1  mgc: 3.417266e-13 
outer mgc:  0.09476165 
iter: 1  value: 510.3045 mgc: 0.09332416 ustep: 1 
iter: 2  value: 510.3045 mgc: 4.178616e-05 ustep: 1 
iter: 3  mgc: 1.824874e-11 
iter: 1  mgc: 1.824874e-11 
outer mgc:  0.07867521 
iter: 1  value: 510.3043 mgc: 0.03110977 ustep: 1 
iter: 2  value: 510.3043 mgc: 4.707959e-06 ustep: 1 
iter: 3  mgc: 2.549072e-13 
iter: 1  mgc: 2.549072e-13 
outer mgc:  0.01981846 
iter: 1  value: 510.3041 mgc: 0.03576611 ustep: 1 
iter: 2  value: 510.3041 mgc: 9.205208e-06 ustep: 1 
iter: 3  mgc: 5.335732e-13 
iter: 1  value: 510.304 mgc: 0.01684318 ustep: 1 
iter: 2  value: 510.304 mgc: 1.532366e-06 ustep: 1 
iter: 3  mgc: 3.974598e-14 
iter: 1  mgc: 3.974598e-14 
outer mgc:  0.02553286 
iter: 1  value: 510.3044 mgc: 0.006830095 ustep: 1 
iter: 2  value: 510.3044 mgc: 3.36453e-07 ustep: 1 
iter: 3  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  0.002777336 
iter: 1  value: 510.3043 mgc: 0.002412621 ustep: 1 
iter: 2  value: 510.3043 mgc: 2.127316e-08 ustep: 1 
mgc: 2.200323e-14 
iter: 1  mgc: 2.200323e-14 
outer mgc:  0.006699576 
iter: 1  value: 510.3046 mgc: 0.01012708 ustep: 1 
iter: 2  value: 510.3046 mgc: 6.84227e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
iter: 1  value: 510.3044 mgc: 0.003508757 ustep: 1 
iter: 2  value: 510.3044 mgc: 9.578936e-08 ustep: 1 
iter: 3  mgc: 2.997602e-14 
iter: 1  mgc: 2.997602e-14 
outer mgc:  0.001674663 
iter: 1  value: 510.3043 mgc: 0.004870842 ustep: 1 
iter: 2  value: 510.3043 mgc: 1.035909e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
iter: 1  value: 510.3043 mgc: 0.002168494 ustep: 1 
iter: 2  value: 510.3043 mgc: 1.928279e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  0.004333721 
iter: 1  value: 510.3043 mgc: 0.00139248 ustep: 1 
iter: 2  mgc: 6.86166e-09 
iter: 1  value: 510.3043 mgc: 0.001152307 ustep: 1 
iter: 2  mgc: 3.152233e-09 
iter: 1  mgc: 3.152233e-09 
outer mgc:  0.002348581 
iter: 1  value: 510.3043 mgc: 0.0009164419 ustep: 1 
iter: 2  mgc: 3.725147e-09 
iter: 1  mgc: 3.725147e-09 
outer mgc:  0.001334597 
iter: 1  value: 510.3043 mgc: 0.0005506764 ustep: 1 
iter: 2  mgc: 1.991067e-09 
iter: 1  mgc: 1.991067e-09 
outer mgc:  0.0009165612 
iter: 1  mgc: 1.991067e-09 
iter: 1  mgc: 1.991067e-09 
outer mgc:  0.0009165612 
iter: 1  value: 510.304 mgc: 0.04268866 ustep: 1 
iter: 2  value: 510.304 mgc: 8.861298e-06 ustep: 1 
iter: 3  mgc: 6.59417e-13 
outer mgc:  0.03882947 
iter: 1  value: 510.3047 mgc: 0.04266906 ustep: 1 
iter: 2  value: 510.3047 mgc: 8.873457e-06 ustep: 1 
iter: 3  mgc: 6.551981e-13 
outer mgc:  0.03805402 
iter: 1  value: 510.3041 mgc: 0.01773422 ustep: 1 
iter: 2  value: 510.3041 mgc: 1.907735e-06 ustep: 1 
iter: 3  mgc: 3.896883e-14 
outer mgc:  0.1109841 
iter: 1  value: 510.3047 mgc: 0.01772529 ustep: 1 
iter: 2  value: 510.3047 mgc: 1.906894e-06 ustep: 1 
iter: 3  mgc: 5.417888e-14 
outer mgc:  0.1096561 
iter: 1  value: 510.3042 mgc: 0.04642205 ustep: 1 
iter: 2  value: 510.3042 mgc: 9.072563e-06 ustep: 1 
iter: 3  mgc: 6.98247e-13 
outer mgc:  0.04025178 
iter: 1  value: 510.3045 mgc: 0.0464134 ustep: 1 
iter: 2  value: 510.3045 mgc: 9.082822e-06 ustep: 1 
iter: 3  mgc: 6.94389e-13 
outer mgc:  0.04062277 
iter: 1  value: 510.3045 mgc: 0.02408673 ustep: 1 
iter: 2  value: 510.3045 mgc: 3.511468e-06 ustep: 1 
iter: 3  mgc: 8.160139e-14 
outer mgc:  0.1400272 
iter: 1  value: 510.3043 mgc: 0.02407568 ustep: 1 
iter: 2  value: 510.3043 mgc: 3.513388e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
outer mgc:  0.1413622 
iter: 1  value: 510.3049 mgc: 0.05546947 ustep: 1 
iter: 2  value: 510.3049 mgc: 7.854316e-06 ustep: 1 
iter: 3  mgc: 4.192202e-13 
outer mgc:  0.05033454 
iter: 1  value: 510.3038 mgc: 0.05547307 ustep: 1 
iter: 2  value: 510.3038 mgc: 7.862507e-06 ustep: 1 
iter: 3  mgc: 4.161116e-13 
outer mgc:  0.05014005 
iter: 1  value: 510.3041 mgc: 0.03036158 ustep: 1 
iter: 2  value: 510.3041 mgc: 1.796241e-06 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.2295325 
iter: 1  value: 510.3048 mgc: 0.03036362 ustep: 1 
iter: 2  value: 510.3048 mgc: 1.796256e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.2276785 
iter: 1  value: 510.3026 mgc: 0.003707711 ustep: 1 
iter: 2  value: 510.3026 mgc: 3.196088e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.01222623 
iter: 1  value: 510.3061 mgc: 0.003704233 ustep: 1 
iter: 2  value: 510.3061 mgc: 3.190579e-07 ustep: 1 
iter: 3  mgc: 2.653433e-14 
outer mgc:  0.01251482 
iter: 1  value: 510.3035 mgc: 0.002932168 ustep: 1 
iter: 2  value: 510.3035 mgc: 1.428957e-07 ustep: 1 
iter: 3  mgc: 2.908784e-14 
outer mgc:  0.01434168 
iter: 1  value: 510.3052 mgc: 0.002929186 ustep: 1 
iter: 2  value: 510.3052 mgc: 1.42616e-07 ustep: 1 
iter: 3  mgc: 3.153033e-14 
outer mgc:  0.01452737 
iter: 1  value: 510.304 mgc: 0.003105949 ustep: 1 
iter: 2  value: 510.304 mgc: 1.473155e-07 ustep: 1 
iter: 3  mgc: 3.663736e-14 
outer mgc:  0.01605707 
iter: 1  value: 510.3046 mgc: 0.003104541 ustep: 1 
iter: 2  value: 510.3046 mgc: 1.471447e-07 ustep: 1 
iter: 3  mgc: 2.580401e-14 
outer mgc:  0.01555479 
iter: 1  value: 510.307 mgc: 0.006377164 ustep: 1 
iter: 2  value: 510.307 mgc: 9.166951e-07 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.04930602 
iter: 1  value: 510.3017 mgc: 0.006391379 ustep: 1 
iter: 2  value: 510.3017 mgc: 9.188373e-07 ustep: 1 
iter: 3  mgc: 2.864375e-14 
outer mgc:  0.04930399 
iter: 1  value: 510.3066 mgc: 0.006633229 ustep: 1 
iter: 2  value: 510.3066 mgc: 1.477924e-06 ustep: 1 
iter: 3  mgc: 7.727152e-14 
outer mgc:  0.04928205 
iter: 1  value: 510.3021 mgc: 0.006648167 ustep: 1 
iter: 2  value: 510.3021 mgc: 1.482531e-06 ustep: 1 
iter: 3  mgc: 7.81597e-14 
outer mgc:  0.04912698 
iter: 1  value: 510.3058 mgc: 0.006233217 ustep: 1 
iter: 2  value: 510.3058 mgc: 2.632212e-07 ustep: 1 
iter: 3  mgc: 2.953193e-14 
outer mgc:  0.04781971 
iter: 1  value: 510.3029 mgc: 0.006247112 ustep: 1 
iter: 2  value: 510.3029 mgc: 2.642488e-07 ustep: 1 
iter: 3  mgc: 1.865175e-14 
outer mgc:  0.04799252 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:52:01 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 02:18:58 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_4_4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=4, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_4_4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_4_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2596.529338 
iter  10 value 1233.042338
iter  20 value 1220.442874
final  value 1220.441926 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2260.184 mgc: 127.1693 ustep: 1 
iter: 2  value: 1873.924 mgc: 59.63777 ustep: 1 
iter: 3  value: 1854.535 mgc: 21.70439 ustep: 1 
iter: 4  value: 1854.435 mgc: 1.965289 ustep: 1 
iter: 5  value: 1854.435 mgc: 0.01270326 ustep: 1 
iter: 6  value: 1854.435 mgc: 6.427394e-07 ustep: 1 
iter: 7  mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
Matching hessian patterns... Done
outer mgc:  454.033 
iter: 1  value: 1390.663 mgc: 27.78246 ustep: 1 
iter: 2  value: 1385.233 mgc: 7.295312 ustep: 1 
iter: 3  value: 1385.196 mgc: 0.4770533 ustep: 1 
iter: 4  value: 1385.196 mgc: 0.009730819 ustep: 1 
iter: 5  value: 1385.196 mgc: 5.106198e-06 ustep: 1 
iter: 6  mgc: 1.410649e-12 
iter: 1  value: 879.5559 mgc: 39.21243 ustep: 0.2494656 
iter: 2  value: 707.3676 mgc: 58.07766 ustep: 0.4995153 
iter: 3  value: 703.0572 mgc: 5.360891 ustep: 0.7067933 
iter: 4  value: 703.0112 mgc: 0.5632933 ustep: 0.8407259 
iter: 5  value: 703.0111 mgc: 0.01564215 ustep: 0.9169194 
iter: 6  value: 703.0111 mgc: 0.0002115714 ustep: 0.9575633 
iter: 7  value: 703.0111 mgc: 2.872553e-06 ustep: 0.9785538 
iter: 8  value: 703.0111 mgc: 2.285165e-08 ustep: 0.9892199 
iter: 9  mgc: 9.362966e-11 
iter: 1  mgc: 9.362966e-11 
outer mgc:  166.1037 
iter: 1  value: 384.8675 mgc: 20.99182 ustep: 0.2494656 
iter: 2  value: 200.2962 mgc: 86.24355 ustep: 0.4995153 
iter: 3  value: 187.7699 mgc: 14.70468 ustep: 0.7067933 
iter: 4  value: 187.5039 mgc: 2.16918 ustep: 0.8407259 
iter: 5  value: 187.5031 mgc: 0.1284341 ustep: 0.9169194 
iter: 6  value: 187.5031 mgc: 0.001349178 ustep: 0.9575633 
iter: 7  value: 187.5031 mgc: 8.581455e-06 ustep: 0.9785538 
iter: 8  value: 187.5031 mgc: 4.656401e-08 ustep: 0.9892199 
iter: 9  mgc: 1.450556e-10 
iter: 1  mgc: 1.450556e-10 
outer mgc:  40.46415 
iter: 1  value: 252.6959 mgc: 46.47955 ustep: 1 
iter: 2  value: 130.3039 mgc: 36.40317 ustep: 1 
iter: 3  value: 119.971 mgc: 19.32599 ustep: 1 
iter: 4  value: 119.7686 mgc: 3.016614 ustep: 1 
iter: 5  value: 119.7685 mgc: 0.03581091 ustep: 1 
iter: 6  value: 119.7685 mgc: 2.389803e-05 ustep: 1 
iter: 7  mgc: 9.046847e-12 
iter: 1  mgc: 9.046847e-12 
outer mgc:  27.06992 
iter: 1  value: 311.2896 mgc: 30.27904 ustep: 1 
iter: 2  value: 195.1148 mgc: 51.97648 ustep: 1 
iter: 3  value: 189.9855 mgc: 7.430354 ustep: 1 
iter: 4  value: 189.9391 mgc: 0.7226873 ustep: 1 
iter: 5  value: 189.9391 mgc: 0.01054628 ustep: 1 
iter: 6  value: 189.9391 mgc: 2.267761e-06 ustep: 1 
iter: 7  mgc: 1.065814e-13 
iter: 1  value: 111.4923 mgc: 12.74435 ustep: 1 
iter: 2  value: 110.0773 mgc: 3.54403 ustep: 1 
iter: 3  value: 110.076 mgc: 0.1272873 ustep: 1 
iter: 4  value: 110.076 mgc: 0.0001922746 ustep: 1 
iter: 5  mgc: 4.596705e-10 
iter: 1  mgc: 4.596705e-10 
outer mgc:  17.9441 
iter: 1  value: 113.3135 mgc: 27.72212 ustep: 1 
iter: 2  value: 105.883 mgc: 10.11608 ustep: 1 
iter: 3  value: 105.8697 mgc: 0.4501532 ustep: 1 
iter: 4  value: 105.8697 mgc: 0.00156871 ustep: 1 
iter: 5  value: 105.8697 mgc: 2.686811e-08 ustep: 1 
mgc: 2.9865e-14 
iter: 1  mgc: 2.9865e-14 
outer mgc:  13.24784 
iter: 1  value: 95.47729 mgc: 8.424821 ustep: 1 
iter: 2  value: 95.44545 mgc: 0.5358551 ustep: 1 
iter: 3  value: 95.44545 mgc: 0.002354289 ustep: 1 
iter: 4  value: 95.44545 mgc: 8.817252e-08 ustep: 1 
mgc: 4.396483e-14 
iter: 1  mgc: 4.396483e-14 
outer mgc:  7.180385 
iter: 1  value: 100.7611 mgc: 18.51013 ustep: 1 
iter: 2  value: 100.4203 mgc: 2.174542 ustep: 1 
iter: 3  value: 100.4203 mgc: 0.0195831 ustep: 1 
iter: 4  value: 100.4203 mgc: 3.201596e-06 ustep: 1 
iter: 5  mgc: 9.25926e-14 
iter: 1  value: 93.14853 mgc: 6.250448 ustep: 1 
iter: 2  value: 93.14491 mgc: 0.1587444 ustep: 1 
iter: 3  value: 93.14491 mgc: 0.0001881619 ustep: 1 
iter: 4  mgc: 3.448326e-10 
iter: 1  mgc: 3.448326e-10 
outer mgc:  7.182064 
iter: 1  value: 90.39309 mgc: 3.697896 ustep: 1 
iter: 2  value: 90.3911 mgc: 0.1094847 ustep: 1 
iter: 3  value: 90.3911 mgc: 8.792891e-05 ustep: 1 
iter: 4  mgc: 6.449041e-11 
iter: 1  mgc: 6.449041e-11 
outer mgc:  6.493245 
iter: 1  value: 87.52794 mgc: 4.356408 ustep: 1 
iter: 2  value: 87.52771 mgc: 0.08081186 ustep: 1 
iter: 3  value: 87.52771 mgc: 2.6752e-05 ustep: 1 
iter: 4  mgc: 3.130385e-12 
iter: 1  mgc: 3.130385e-12 
outer mgc:  4.363005 
iter: 1  value: 85.27666 mgc: 3.097919 ustep: 1 
iter: 2  value: 85.27657 mgc: 0.0336334 ustep: 1 
iter: 3  value: 85.27657 mgc: 5.29401e-06 ustep: 1 
iter: 4  mgc: 1.687539e-13 
iter: 1  mgc: 1.687539e-13 
outer mgc:  3.009635 
iter: 1  value: 83.14045 mgc: 2.520102 ustep: 1 
iter: 2  value: 83.14037 mgc: 0.02025692 ustep: 1 
iter: 3  value: 83.14037 mgc: 6.16003e-06 ustep: 1 
iter: 4  mgc: 6.201706e-13 
iter: 1  mgc: 6.201706e-13 
outer mgc:  2.038206 
iter: 1  value: 81.48166 mgc: 1.474211 ustep: 1 
iter: 2  value: 81.48163 mgc: 0.01445977 ustep: 1 
iter: 3  value: 81.48163 mgc: 2.147977e-06 ustep: 1 
iter: 4  mgc: 7.21645e-14 
iter: 1  mgc: 7.21645e-14 
outer mgc:  2.720364 
iter: 1  value: 78.45392 mgc: 3.121985 ustep: 1 
iter: 2  value: 78.45368 mgc: 0.0524918 ustep: 1 
iter: 3  value: 78.45368 mgc: 2.747937e-05 ustep: 1 
iter: 4  mgc: 1.009726e-11 
iter: 1  mgc: 1.009726e-11 
outer mgc:  2.192417 
iter: 1  value: 78.30676 mgc: 3.473062 ustep: 1 
iter: 2  value: 78.30673 mgc: 0.02465215 ustep: 1 
iter: 3  value: 78.30673 mgc: 1.742888e-06 ustep: 1 
iter: 4  mgc: 2.9865e-14 
iter: 1  mgc: 2.9865e-14 
outer mgc:  2.096969 
iter: 1  value: 75.02106 mgc: 4.311521 ustep: 1 
iter: 2  value: 75.02083 mgc: 0.05178636 ustep: 1 
iter: 3  value: 75.02083 mgc: 1.528962e-05 ustep: 1 
iter: 4  mgc: 1.98197e-12 
iter: 1  mgc: 1.98197e-12 
outer mgc:  3.087873 
iter: 1  value: 73.71994 mgc: 1.617693 ustep: 1 
iter: 2  value: 73.71993 mgc: 0.008152516 ustep: 1 
iter: 3  value: 73.71993 mgc: 2.986945e-07 ustep: 1 
iter: 4  mgc: 2.91156e-14 
iter: 1  mgc: 2.91156e-14 
outer mgc:  0.554901 
iter: 1  value: 73.29042 mgc: 1.777998 ustep: 1 
iter: 2  value: 73.29042 mgc: 0.008282835 ustep: 1 
iter: 3  value: 73.29042 mgc: 2.534468e-07 ustep: 1 
iter: 4  mgc: 1.865175e-14 
iter: 1  value: 73.56372 mgc: 1.014699 ustep: 1 
iter: 2  value: 73.56372 mgc: 0.001413797 ustep: 1 
iter: 3  mgc: 5.070721e-09 
iter: 1  mgc: 5.070721e-09 
outer mgc:  0.5986097 
iter: 1  value: 73.04287 mgc: 0.560214 ustep: 1 
iter: 2  value: 73.04287 mgc: 0.001905549 ustep: 1 
iter: 3  value: 73.04287 mgc: 2.459923e-08 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.4112585 
iter: 1  value: 72.52409 mgc: 0.4033688 ustep: 1 
iter: 2  value: 72.52409 mgc: 0.0003342461 ustep: 1 
iter: 3  mgc: 8.053239e-10 
iter: 1  value: 71.89093 mgc: 0.4858039 ustep: 1 
iter: 2  value: 71.89093 mgc: 0.0001845776 ustep: 1 
iter: 3  mgc: 2.605971e-10 
iter: 1  mgc: 2.605971e-10 
outer mgc:  0.08909214 
iter: 1  value: 71.48397 mgc: 0.4949332 ustep: 1 
iter: 2  value: 71.48397 mgc: 4.301286e-05 ustep: 1 
iter: 3  mgc: 9.86522e-12 
iter: 1  mgc: 9.86522e-12 
outer mgc:  0.06051581 
iter: 1  value: 71.34968 mgc: 0.3302591 ustep: 1 
iter: 2  value: 71.34968 mgc: 4.49415e-05 ustep: 1 
iter: 3  mgc: 1.327383e-12 
iter: 1  mgc: 1.327383e-12 
outer mgc:  0.02339055 
iter: 1  value: 71.44416 mgc: 0.2269762 ustep: 1 
iter: 2  value: 71.44416 mgc: 5.090544e-05 ustep: 1 
iter: 3  mgc: 6.171952e-12 
iter: 1  mgc: 6.171952e-12 
outer mgc:  0.04240161 
iter: 1  value: 71.53015 mgc: 0.05925466 ustep: 1 
iter: 2  value: 71.53015 mgc: 8.986355e-06 ustep: 1 
iter: 3  mgc: 2.58682e-13 
iter: 1  mgc: 2.58682e-13 
outer mgc:  0.02951959 
iter: 1  value: 71.56908 mgc: 0.0699227 ustep: 1 
iter: 2  value: 71.56908 mgc: 1.898267e-06 ustep: 1 
iter: 3  mgc: 2.303713e-14 
iter: 1  mgc: 2.303713e-14 
outer mgc:  0.009071864 
iter: 1  value: 71.65818 mgc: 0.1075339 ustep: 1 
iter: 2  value: 71.65818 mgc: 2.47264e-06 ustep: 1 
iter: 3  mgc: 2.464695e-14 
iter: 1  mgc: 2.464695e-14 
outer mgc:  0.008579599 
iter: 1  value: 71.92555 mgc: 0.2927944 ustep: 1 
iter: 2  value: 71.92555 mgc: 2.162328e-05 ustep: 1 
iter: 3  mgc: 3.743672e-13 
iter: 1  mgc: 3.743672e-13 
outer mgc:  0.01898631 
iter: 1  value: 72.0923 mgc: 0.1648419 ustep: 1 
iter: 2  value: 72.0923 mgc: 7.169493e-06 ustep: 1 
iter: 3  mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  0.01386164 
iter: 1  value: 72.2004 mgc: 0.0873617 ustep: 1 
iter: 2  value: 72.2004 mgc: 1.653517e-06 ustep: 1 
iter: 3  mgc: 2.128853e-14 
iter: 1  mgc: 2.128853e-14 
outer mgc:  0.003432758 
iter: 1  value: 72.26681 mgc: 0.07771039 ustep: 1 
iter: 2  value: 72.26681 mgc: 2.012703e-06 ustep: 1 
iter: 3  mgc: 2.481348e-14 
iter: 1  mgc: 2.481348e-14 
outer mgc:  0.005413035 
iter: 1  value: 72.32213 mgc: 0.07975669 ustep: 1 
iter: 2  value: 72.32213 mgc: 1.683238e-06 ustep: 1 
iter: 3  mgc: 3.796963e-14 
iter: 1  mgc: 3.796963e-14 
outer mgc:  0.007068627 
iter: 1  value: 72.36716 mgc: 0.0753544 ustep: 1 
iter: 2  value: 72.36716 mgc: 1.055439e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  0.004123047 
iter: 1  value: 72.37687 mgc: 0.03124145 ustep: 1 
iter: 2  value: 72.37687 mgc: 1.971834e-07 ustep: 1 
iter: 3  mgc: 1.321165e-14 
iter: 1  mgc: 1.321165e-14 
outer mgc:  0.001091121 
iter: 1  value: 72.36878 mgc: 0.02715919 ustep: 1 
iter: 2  value: 72.36878 mgc: 2.205441e-07 ustep: 1 
mgc: 1.687539e-14 
iter: 1  mgc: 1.687539e-14 
outer mgc:  0.001274031 
iter: 1  value: 72.36062 mgc: 0.02297452 ustep: 1 
iter: 2  value: 72.36062 mgc: 1.055022e-07 ustep: 1 
mgc: 3.18634e-14 
iter: 1  mgc: 3.18634e-14 
outer mgc:  0.001034731 
iter: 1  value: 72.35755 mgc: 0.00856163 ustep: 1 
iter: 2  value: 72.35755 mgc: 1.093711e-08 ustep: 1 
mgc: 2.514655e-14 
iter: 1  mgc: 2.514655e-14 
outer mgc:  0.0002971816 
iter: 1  value: 72.35753 mgc: 0.001924757 ustep: 1 
iter: 2  mgc: 1.992903e-09 
iter: 1  mgc: 1.992903e-09 
outer mgc:  7.670722e-05 
iter: 1  value: 72.35807 mgc: 0.001319406 ustep: 1 
iter: 2  mgc: 1.094479e-09 
iter: 1  mgc: 1.094479e-09 
outer mgc:  0.0001125254 
iter: 1  mgc: 1.094479e-09 
iter: 1  mgc: 1.094479e-09 
outer mgc:  0.0001125254 
iter: 1  value: 72.35824 mgc: 0.01478239 ustep: 1 
iter: 2  value: 72.35824 mgc: 1.949959e-07 ustep: 1 
mgc: 1.365574e-14 
outer mgc:  0.09296959 
iter: 1  value: 72.358 mgc: 0.01477229 ustep: 1 
iter: 2  value: 72.358 mgc: 1.947337e-07 ustep: 1 
mgc: 2.153833e-14 
outer mgc:  0.09315112 
iter: 1  value: 72.35805 mgc: 0.0001616586 ustep: 1 
iter: 2  mgc: 2.022029e-10 
outer mgc:  0.0009774785 
iter: 1  value: 72.3581 mgc: 0.0001614976 ustep: 1 
iter: 2  mgc: 2.018379e-10 
outer mgc:  0.001008942 
iter: 1  value: 72.35776 mgc: 0.02519158 ustep: 1 
iter: 2  value: 72.35776 mgc: 2.380864e-06 ustep: 1 
iter: 3  mgc: 4.274359e-14 
outer mgc:  0.0450881 
iter: 1  value: 72.35843 mgc: 0.02518423 ustep: 1 
iter: 2  value: 72.35843 mgc: 2.381414e-06 ustep: 1 
iter: 3  mgc: 5.084821e-14 
outer mgc:  0.04524767 
iter: 1  value: 72.35821 mgc: 0.0007712572 ustep: 1 
iter: 2  mgc: 7.345779e-09 
outer mgc:  0.003863744 
iter: 1  value: 72.35794 mgc: 0.0007720152 ustep: 1 
iter: 2  mgc: 7.357001e-09 
outer mgc:  0.003858414 
iter: 1  value: 72.35796 mgc: 0.02689339 ustep: 1 
iter: 2  value: 72.35796 mgc: 2.385691e-06 ustep: 1 
iter: 3  mgc: 7.105427e-14 
outer mgc:  0.04784723 
iter: 1  value: 72.35823 mgc: 0.02689313 ustep: 1 
iter: 2  value: 72.35823 mgc: 2.389739e-06 ustep: 1 
iter: 3  mgc: 6.528111e-14 
outer mgc:  0.04790525 
iter: 1  value: 72.35798 mgc: 0.0004611407 ustep: 1 
iter: 2  mgc: 3.534932e-09 
outer mgc:  0.001925305 
iter: 1  value: 72.35816 mgc: 0.0004606847 ustep: 1 
iter: 2  mgc: 3.529192e-09 
outer mgc:  0.001956927 
iter: 1  value: 72.36217 mgc: 0.01817241 ustep: 1 
iter: 2  value: 72.36217 mgc: 7.39551e-08 ustep: 1 
mgc: 1.798561e-14 
outer mgc:  0.0007246294 
iter: 1  value: 72.35397 mgc: 0.01816405 ustep: 1 
iter: 2  value: 72.35397 mgc: 7.401169e-08 ustep: 1 
mgc: 2.919887e-14 
outer mgc:  0.0006386535 
iter: 1  value: 72.35606 mgc: 0.008222792 ustep: 1 
iter: 2  value: 72.35606 mgc: 3.836598e-08 ustep: 1 
mgc: 3.932965e-14 
outer mgc:  0.001008535 
iter: 1  value: 72.36008 mgc: 0.008214667 ustep: 1 
iter: 2  value: 72.36008 mgc: 3.840996e-08 ustep: 1 
mgc: 3.752554e-14 
outer mgc:  0.0007841688 
iter: 1  value: 72.36125 mgc: 0.004331894 ustep: 1 
iter: 2  value: 72.36125 mgc: 3.431839e-08 ustep: 1 
mgc: 4.007905e-14 
outer mgc:  0.0005008539 
iter: 1  value: 72.35489 mgc: 0.004335094 ustep: 1 
iter: 2  value: 72.35489 mgc: 3.423308e-08 ustep: 1 
mgc: 2.031708e-14 
outer mgc:  0.0004903617 
iter: 1  value: 72.36725 mgc: 0.01439418 ustep: 1 
iter: 2  value: 72.36725 mgc: 5.529821e-08 ustep: 1 
mgc: 3.93019e-14 
outer mgc:  0.0007554532 
iter: 1  value: 72.34889 mgc: 0.01442797 ustep: 1 
iter: 2  value: 72.34889 mgc: 5.514661e-08 ustep: 1 
mgc: 2.745026e-14 
outer mgc:  0.0008707453 
iter: 1  value: 72.36312 mgc: 0.01585505 ustep: 1 
iter: 2  value: 72.36312 mgc: 3.792805e-07 ustep: 1 
iter: 3  mgc: 1.876277e-14 
outer mgc:  0.008425729 
iter: 1  value: 72.35303 mgc: 0.01589117 ustep: 1 
iter: 2  value: 72.35303 mgc: 3.794435e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.008504635 
iter: 1  value: 72.36162 mgc: 0.01259696 ustep: 1 
iter: 2  value: 72.36162 mgc: 3.929092e-07 ustep: 1 
iter: 3  mgc: 1.790235e-14 
outer mgc:  0.01289212 
iter: 1  value: 72.35453 mgc: 0.01262779 ustep: 1 
iter: 2  value: 72.35453 mgc: 3.932599e-07 ustep: 1 
iter: 3  mgc: 1.74305e-14 
outer mgc:  0.01277636 
[Mon Aug 16 02:19:00 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:05:22 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.005_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.005_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.005, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.005_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.005_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4533.972915 
final  value 4274.901477 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4305.502 mgc: 3.856022 ustep: 1 
iter: 2  value: 4296.272 mgc: 1.99285 ustep: 1 
iter: 3  value: 4292.62 mgc: 3.167025 ustep: 0.6827823 
iter: 4  value: 4292.606 mgc: 0.1421721 ustep: 0.8263238 
iter: 5  value: 4292.606 mgc: 0.01744773 ustep: 0.9090326 
iter: 6  value: 4292.605 mgc: 0.001171721 ustep: 0.9534367 
iter: 7  value: 4292.605 mgc: 4.36461e-05 ustep: 0.9764432 
iter: 8  value: 4292.605 mgc: 8.620999e-07 ustep: 0.9881526 
iter: 9  mgc: 8.712719e-09 
iter: 1  mgc: 8.712719e-09 
Matching hessian patterns... Done
outer mgc:  33.49799 
iter: 1  value: 4245.214 mgc: 1.420806 ustep: 1 
iter: 2  value: 4245.197 mgc: 0.1512266 ustep: 1 
iter: 3  value: 4245.197 mgc: 0.0004672058 ustep: 1 
iter: 4  value: 4245.197 mgc: 1.289607e-08 ustep: 1 
mgc: 4.107825e-15 
iter: 1  value: 4166.459 mgc: 18.55173 ustep: 1 
iter: 2  value: 4162.861 mgc: 4.171161 ustep: 1 
iter: 3  value: 4162.859 mgc: 0.09376533 ustep: 1 
iter: 4  value: 4162.859 mgc: 6.337398e-05 ustep: 1 
iter: 5  mgc: 3.04432e-11 
iter: 1  mgc: 3.04432e-11 
outer mgc:  54.93494 
iter: 1  value: 6549.435 mgc: 138.9103 ustep: 1 
iter: 2  value: 6084.52 mgc: 55.47126 ustep: 1 
iter: 3  value: 6080.492 mgc: 11.61409 ustep: 1 
iter: 4  value: 6080.465 mgc: 1.055556 ustep: 1 
iter: 5  value: 6080.465 mgc: 0.00660985 ustep: 1 
iter: 6  value: 6080.465 mgc: 2.54809e-07 ustep: 1 
iter: 7  mgc: 1.207923e-13 
iter: 1  value: 4152.758 mgc: 7.780504 ustep: 1 
iter: 2  value: 4152.737 mgc: 0.2091097 ustep: 1 
iter: 3  value: 4152.737 mgc: 0.0008888215 ustep: 1 
iter: 4  value: 4152.737 mgc: 1.593644e-08 ustep: 1 
mgc: 3.841372e-14 
iter: 1  mgc: 3.841372e-14 
outer mgc:  37.96146 
iter: 1  value: 4147.768 mgc: 9.501907 ustep: 1 
iter: 2  value: 4147.718 mgc: 0.6304063 ustep: 1 
iter: 3  value: 4147.718 mgc: 0.002182677 ustep: 1 
iter: 4  value: 4147.718 mgc: 9.55769e-08 ustep: 1 
iter: 5  mgc: 3.752554e-14 
iter: 1  mgc: 3.752554e-14 
outer mgc:  25.06672 
iter: 1  value: 4142.329 mgc: 3.989782 ustep: 1 
iter: 2  value: 4142.287 mgc: 0.3602786 ustep: 1 
iter: 3  value: 4142.287 mgc: 0.002212096 ustep: 1 
iter: 4  value: 4142.287 mgc: 1.917508e-07 ustep: 1 
iter: 5  mgc: 6.394885e-14 
iter: 1  mgc: 6.394885e-14 
outer mgc:  5.08717 
iter: 1  value: 4139.959 mgc: 5.191662 ustep: 1 
iter: 2  value: 4139.959 mgc: 0.07180336 ustep: 1 
iter: 3  value: 4139.959 mgc: 3.555035e-05 ustep: 1 
iter: 4  mgc: 3.00231e-11 
iter: 1  value: 4140.4 mgc: 1.963501 ustep: 1 
iter: 2  value: 4140.4 mgc: 0.01393983 ustep: 1 
iter: 3  value: 4140.4 mgc: 1.544333e-06 ustep: 1 
iter: 4  mgc: 6.306067e-14 
iter: 1  mgc: 6.306067e-14 
outer mgc:  8.321658 
iter: 1  value: 4139.091 mgc: 3.385149 ustep: 1 
iter: 2  value: 4139.091 mgc: 0.03014961 ustep: 1 
iter: 3  value: 4139.091 mgc: 3.549874e-06 ustep: 1 
iter: 4  mgc: 5.719869e-13 
iter: 1  mgc: 5.719869e-13 
outer mgc:  12.2371 
iter: 1  value: 4137.42 mgc: 5.026921 ustep: 1 
iter: 2  value: 4137.42 mgc: 0.07381741 ustep: 1 
iter: 3  value: 4137.42 mgc: 1.945026e-05 ustep: 1 
iter: 4  mgc: 1.270983e-12 
iter: 1  mgc: 1.270983e-12 
outer mgc:  7.860285 
iter: 1  value: 4136.876 mgc: 2.836692 ustep: 1 
iter: 2  value: 4136.876 mgc: 0.02942347 ustep: 1 
iter: 3  value: 4136.876 mgc: 2.850125e-06 ustep: 1 
iter: 4  mgc: 1.385558e-13 
iter: 1  mgc: 1.385558e-13 
outer mgc:  6.061803 
iter: 1  value: 4139.262 mgc: 3.956955 ustep: 1 
iter: 2  value: 4139.262 mgc: 0.03943238 ustep: 1 
iter: 3  value: 4139.262 mgc: 1.539016e-05 ustep: 1 
iter: 4  mgc: 1.797673e-12 
iter: 1  value: 4136.752 mgc: 0.9754234 ustep: 1 
iter: 2  value: 4136.752 mgc: 0.002377116 ustep: 1 
iter: 3  value: 4136.752 mgc: 6.176226e-08 ustep: 1 
mgc: 3.327894e-14 
iter: 1  mgc: 3.327894e-14 
outer mgc:  4.305785 
iter: 1  value: 4136.785 mgc: 0.9058403 ustep: 1 
iter: 2  value: 4136.785 mgc: 0.001708679 ustep: 1 
iter: 3  mgc: 9.855813e-09 
iter: 1  mgc: 9.855813e-09 
outer mgc:  2.244074 
iter: 1  value: 4136.881 mgc: 0.5182896 ustep: 1 
iter: 2  value: 4136.881 mgc: 0.0004467449 ustep: 1 
iter: 3  mgc: 1.849662e-09 
iter: 1  mgc: 1.849662e-09 
outer mgc:  1.889588 
iter: 1  value: 4135.789 mgc: 0.9892242 ustep: 1 
iter: 2  value: 4135.789 mgc: 0.002579298 ustep: 1 
iter: 3  value: 4135.789 mgc: 1.785038e-08 ustep: 1 
mgc: 5.950795e-14 
iter: 1  mgc: 5.950795e-14 
outer mgc:  0.9879024 
iter: 1  value: 4135.713 mgc: 1.280928 ustep: 1 
iter: 2  value: 4135.713 mgc: 0.002537747 ustep: 1 
iter: 3  value: 4135.713 mgc: 1.362137e-07 ustep: 1 
iter: 4  mgc: 4.396483e-14 
iter: 1  value: 4135.99 mgc: 1.268979 ustep: 1 
iter: 2  value: 4135.99 mgc: 0.002571742 ustep: 1 
iter: 3  value: 4135.99 mgc: 6.123753e-08 ustep: 1 
iter: 4  mgc: 7.149836e-14 
iter: 1  value: 4135.817 mgc: 0.4342502 ustep: 1 
iter: 2  value: 4135.817 mgc: 0.0003219531 ustep: 1 
iter: 3  mgc: 8.234027e-10 
iter: 1  mgc: 8.234027e-10 
outer mgc:  1.615798 
iter: 1  value: 4135.756 mgc: 0.2919756 ustep: 1 
iter: 2  value: 4135.756 mgc: 0.0002100608 ustep: 1 
iter: 3  mgc: 1.373416e-10 
iter: 1  mgc: 1.373416e-10 
outer mgc:  0.9007928 
iter: 1  value: 4135.716 mgc: 0.1912577 ustep: 1 
iter: 2  value: 4135.716 mgc: 6.482963e-05 ustep: 1 
iter: 3  mgc: 4.338574e-11 
iter: 1  value: 4135.647 mgc: 0.1058291 ustep: 1 
iter: 2  value: 4135.647 mgc: 2.388886e-05 ustep: 1 
iter: 3  mgc: 3.54472e-12 
iter: 1  value: 4135.402 mgc: 0.4060954 ustep: 1 
iter: 2  value: 4135.402 mgc: 0.0003252039 ustep: 1 
iter: 3  mgc: 6.429923e-10 
iter: 1  value: 4134.955 mgc: 0.8827436 ustep: 1 
iter: 2  value: 4134.955 mgc: 0.001275793 ustep: 1 
iter: 3  value: 4134.955 mgc: 1.366823e-08 ustep: 1 
mgc: 4.418688e-14 
iter: 1  mgc: 4.418688e-14 
outer mgc:  1.903245 
iter: 1  value: 4135.66 mgc: 2.461805 ustep: 1 
iter: 2  value: 4135.66 mgc: 0.01431607 ustep: 1 
iter: 3  value: 4135.66 mgc: 1.484303e-06 ustep: 1 
iter: 4  mgc: 9.148238e-14 
iter: 1  value: 4135.056 mgc: 0.8651506 ustep: 1 
iter: 2  value: 4135.056 mgc: 0.001593507 ustep: 1 
iter: 3  value: 4135.056 mgc: 2.223972e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  1.173674 
iter: 1  value: 4134.566 mgc: 0.7755104 ustep: 1 
iter: 2  value: 4134.566 mgc: 0.002107045 ustep: 1 
iter: 3  value: 4134.566 mgc: 9.32688e-08 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  1.147484 
iter: 1  value: 4134.1 mgc: 0.3869114 ustep: 1 
iter: 2  value: 4134.1 mgc: 0.0008726138 ustep: 1 
iter: 3  value: 4134.1 mgc: 1.076984e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.892394 
iter: 1  value: 4133.685 mgc: 0.5994273 ustep: 1 
iter: 2  value: 4133.685 mgc: 0.0004720622 ustep: 1 
iter: 3  mgc: 1.199743e-09 
iter: 1  mgc: 1.199743e-09 
outer mgc:  0.3702031 
iter: 1  value: 4133.132 mgc: 0.9934567 ustep: 1 
iter: 2  value: 4133.132 mgc: 0.002077443 ustep: 1 
iter: 3  value: 4133.132 mgc: 4.935612e-08 ustep: 1 
iter: 4  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  0.2840315 
iter: 1  value: 4132.781 mgc: 0.4369522 ustep: 1 
iter: 2  value: 4132.781 mgc: 0.000239052 ustep: 1 
iter: 3  mgc: 3.009966e-10 
iter: 1  value: 4132.064 mgc: 0.9770848 ustep: 1 
iter: 2  value: 4132.064 mgc: 0.001048371 ustep: 1 
iter: 3  mgc: 5.824432e-09 
iter: 1  mgc: 5.824432e-09 
outer mgc:  1.140483 
iter: 1  value: 4131.253 mgc: 1.301195 ustep: 1 
iter: 2  value: 4131.253 mgc: 0.001970335 ustep: 1 
iter: 3  mgc: 9.45441e-09 
iter: 1  mgc: 9.45441e-09 
outer mgc:  0.8683153 
iter: 1  value: 4130.84 mgc: 0.6058391 ustep: 1 
iter: 2  value: 4130.84 mgc: 0.0003993475 ustep: 1 
iter: 3  mgc: 3.240254e-10 
iter: 1  mgc: 3.240254e-10 
outer mgc:  0.09359412 
iter: 1  value: 4130.638 mgc: 0.2640491 ustep: 1 
iter: 2  value: 4130.638 mgc: 7.196441e-05 ustep: 1 
iter: 3  mgc: 1.349854e-11 
iter: 1  mgc: 1.349854e-11 
outer mgc:  0.0333886 
iter: 1  value: 4130.562 mgc: 0.1084073 ustep: 1 
iter: 2  value: 4130.562 mgc: 1.202909e-05 ustep: 1 
iter: 3  mgc: 3.508305e-13 
iter: 1  mgc: 3.508305e-13 
outer mgc:  0.005586227 
iter: 1  value: 4130.555 mgc: 0.008601456 ustep: 1 
iter: 2  value: 4130.555 mgc: 7.193057e-08 ustep: 1 
mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  0.0004079679 
iter: 1  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  0.0004079679 
iter: 1  value: 4130.556 mgc: 0.01952955 ustep: 1 
iter: 2  value: 4130.556 mgc: 5.898656e-07 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.2697314 
iter: 1  value: 4130.554 mgc: 0.01951973 ustep: 1 
iter: 2  value: 4130.554 mgc: 5.893338e-07 ustep: 1 
iter: 3  mgc: 4.196643e-14 
outer mgc:  0.2704557 
iter: 1  value: 4130.555 mgc: 0.009728586 ustep: 1 
iter: 2  value: 4130.555 mgc: 1.698588e-07 ustep: 1 
iter: 3  mgc: 5.156986e-14 
outer mgc:  0.1538673 
iter: 1  value: 4130.554 mgc: 0.009723398 ustep: 1 
iter: 2  value: 4130.554 mgc: 1.696939e-07 ustep: 1 
iter: 3  mgc: 3.996803e-14 
outer mgc:  0.1541284 
iter: 1  value: 4130.555 mgc: 0.0226644 ustep: 1 
iter: 2  value: 4130.555 mgc: 1.813869e-06 ustep: 1 
iter: 3  mgc: 7.793766e-14 
outer mgc:  0.2185027 
iter: 1  value: 4130.555 mgc: 0.02266165 ustep: 1 
iter: 2  value: 4130.555 mgc: 1.814865e-06 ustep: 1 
iter: 3  mgc: 9.453549e-14 
outer mgc:  0.2177365 
iter: 1  value: 4130.555 mgc: 0.01152126 ustep: 1 
iter: 2  value: 4130.555 mgc: 4.242479e-07 ustep: 1 
iter: 3  mgc: 5.684342e-14 
outer mgc:  0.158831 
iter: 1  value: 4130.555 mgc: 0.01152052 ustep: 1 
iter: 2  value: 4130.555 mgc: 4.241833e-07 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.158495 
iter: 1  value: 4130.569 mgc: 0.06339696 ustep: 1 
iter: 2  value: 4130.569 mgc: 4.420304e-06 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  0.05554945 
iter: 1  value: 4130.541 mgc: 0.06357963 ustep: 1 
iter: 2  value: 4130.541 mgc: 4.424082e-06 ustep: 1 
iter: 3  mgc: 6.360884e-14 
outer mgc:  0.0550468 
iter: 1  value: 4130.561 mgc: 0.05565906 ustep: 1 
iter: 2  value: 4130.561 mgc: 3.06452e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
outer mgc:  0.07277827 
iter: 1  value: 4130.549 mgc: 0.05571475 ustep: 1 
iter: 2  value: 4130.549 mgc: 3.064318e-06 ustep: 1 
iter: 3  mgc: 7.142897e-14 
outer mgc:  0.07353944 
iter: 1  value: 4130.551 mgc: 0.004606638 ustep: 1 
iter: 2  value: 4130.551 mgc: 2.160831e-08 ustep: 1 
mgc: 5.551115e-14 
outer mgc:  0.001114132 
iter: 1  value: 4130.559 mgc: 0.004605418 ustep: 1 
iter: 2  value: 4130.559 mgc: 2.162948e-08 ustep: 1 
mgc: 3.777534e-14 
outer mgc:  0.0004271329 
iter: 1  value: 4130.549 mgc: 0.005575402 ustep: 1 
iter: 2  value: 4130.549 mgc: 9.516881e-08 ustep: 1 
iter: 3  mgc: 2.953193e-14 
outer mgc:  0.009352284 
iter: 1  value: 4130.56 mgc: 0.00557432 ustep: 1 
iter: 2  value: 4130.56 mgc: 9.521131e-08 ustep: 1 
iter: 3  mgc: 4.257705e-14 
outer mgc:  0.009168564 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:05:24 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:48:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4315.349070 
final  value 4244.893828 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3937.285 mgc: 2.275081 ustep: 1 
iter: 2  value: 3932.047 mgc: 1.574365 ustep: 1 
iter: 3  value: 3931.804 mgc: 0.8802686 ustep: 1 
iter: 4  value: 3931.802 mgc: 0.08213592 ustep: 1 
iter: 5  value: 3931.802 mgc: 0.0008148401 ustep: 1 
iter: 6  value: 3931.802 mgc: 5.842939e-08 ustep: 1 
iter: 7  mgc: 1.464107e-15 
iter: 1  mgc: 1.464107e-15 
Matching hessian patterns... Done
outer mgc:  27.19519 
iter: 1  value: 3890.778 mgc: 0.8433998 ustep: 1 
iter: 2  value: 3890.777 mgc: 0.0287413 ustep: 1 
iter: 3  value: 3890.777 mgc: 5.512058e-05 ustep: 1 
iter: 4  mgc: 2.395921e-10 
iter: 1  value: 3858.693 mgc: 3.487055 ustep: 1 
iter: 2  value: 3858.688 mgc: 0.154434 ustep: 1 
iter: 3  value: 3858.688 mgc: 0.001559353 ustep: 1 
iter: 4  value: 3858.688 mgc: 1.771139e-07 ustep: 1 
iter: 5  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  31.74581 
iter: 1  value: 4372.235 mgc: 194.6102 ustep: 0.230263 
iter: 2  value: 4188.461 mgc: 25.39123 ustep: 0.278799 
iter: 3  value: 4075.568 mgc: 10.82058 ustep: 0.1711227 
iter: 4  value: 3994.09 mgc: 8.154647 ustep: 0.2342928 
iter: 5  value: 3964.69 mgc: 6.990079 ustep: 0.2817028 
iter: 6  value: 3961.53 mgc: 6.340645 ustep: 0.5308038 
iter: 7  value: 3961.496 mgc: 0.5930264 ustep: 0.72859 
iter: 8  value: 3961.496 mgc: 0.03394048 ustep: 0.8535895 
iter: 9  value: 3961.496 mgc: 0.0007278473 ustep: 0.9239067 
iter: 10  value: 3961.496 mgc: 7.308087e-06 ustep: 0.9612045 
iter: 11  value: 3961.496 mgc: 3.613072e-08 ustep: 0.9804123 
mgc: 8.865886e-11 
iter: 1  value: 3861.11 mgc: 5.300453 ustep: 1 
iter: 2  value: 3861.01 mgc: 0.3558027 ustep: 1 
iter: 3  value: 3861.01 mgc: 0.006039889 ustep: 1 
iter: 4  value: 3861.01 mgc: 2.801525e-06 ustep: 1 
iter: 5  mgc: 5.4734e-13 
iter: 1  mgc: 5.4734e-13 
outer mgc:  35.22494 
iter: 1  value: 3851.155 mgc: 2.817055 ustep: 1 
iter: 2  value: 3851.148 mgc: 0.1288067 ustep: 1 
iter: 3  value: 3851.148 mgc: 0.0004650772 ustep: 1 
iter: 4  mgc: 2.300095e-09 
iter: 1  mgc: 2.300095e-09 
outer mgc:  7.877756 
iter: 1  value: 3849.559 mgc: 2.341503 ustep: 1 
iter: 2  value: 3849.555 mgc: 0.06994138 ustep: 1 
iter: 3  value: 3849.555 mgc: 0.000319716 ustep: 1 
iter: 4  mgc: 6.265628e-09 
iter: 1  mgc: 6.265628e-09 
outer mgc:  8.509506 
iter: 1  value: 3850.318 mgc: 2.650455 ustep: 1 
iter: 2  value: 3850.314 mgc: 0.0596645 ustep: 1 
iter: 3  value: 3850.314 mgc: 0.0002939473 ustep: 1 
iter: 4  mgc: 7.184681e-09 
iter: 1  value: 3848.691 mgc: 1.006286 ustep: 1 
iter: 2  value: 3848.69 mgc: 0.007583734 ustep: 1 
iter: 3  value: 3848.69 mgc: 2.582244e-06 ustep: 1 
iter: 4  mgc: 5.048115e-13 
iter: 1  mgc: 5.048115e-13 
outer mgc:  5.249203 
iter: 1  value: 3847.854 mgc: 1.027782 ustep: 1 
iter: 2  value: 3847.854 mgc: 0.007288191 ustep: 1 
iter: 3  value: 3847.854 mgc: 1.812826e-06 ustep: 1 
iter: 4  mgc: 1.032507e-13 
iter: 1  mgc: 1.032507e-13 
outer mgc:  6.002395 
iter: 1  value: 3844.333 mgc: 1.919973 ustep: 1 
iter: 2  value: 3844.332 mgc: 0.06089586 ustep: 1 
iter: 3  value: 3844.332 mgc: 0.0001141625 ustep: 1 
iter: 4  mgc: 8.344979e-10 
iter: 1  mgc: 8.344979e-10 
outer mgc:  2.78984 
iter: 1  value: 3842.838 mgc: 2.165752 ustep: 1 
iter: 2  value: 3842.838 mgc: 0.02085685 ustep: 1 
iter: 3  value: 3842.838 mgc: 1.2169e-06 ustep: 1 
iter: 4  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  2.166354 
iter: 1  value: 3842.321 mgc: 2.922824 ustep: 1 
iter: 2  value: 3842.321 mgc: 0.02587724 ustep: 1 
iter: 3  value: 3842.321 mgc: 1.346145e-05 ustep: 1 
iter: 4  mgc: 4.665601e-12 
iter: 1  value: 3842.393 mgc: 1.169393 ustep: 1 
iter: 2  value: 3842.393 mgc: 0.005402005 ustep: 1 
iter: 3  value: 3842.393 mgc: 5.251512e-07 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  1.85859 
iter: 1  value: 3841.679 mgc: 0.6594237 ustep: 1 
iter: 2  value: 3841.679 mgc: 0.0007739679 ustep: 1 
iter: 3  value: 3841.679 mgc: 1.342427e-08 ustep: 1 
mgc: 4.218847e-15 
iter: 1  mgc: 4.218847e-15 
outer mgc:  2.554997 
iter: 1  value: 3841.157 mgc: 0.5821957 ustep: 1 
iter: 2  value: 3841.157 mgc: 0.001076294 ustep: 1 
iter: 3  value: 3841.157 mgc: 1.284694e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.5931402 
iter: 1  value: 3840.888 mgc: 0.3925639 ustep: 1 
iter: 2  value: 3840.888 mgc: 0.0004775692 ustep: 1 
iter: 3  mgc: 1.810584e-09 
iter: 1  mgc: 1.810584e-09 
outer mgc:  1.300465 
iter: 1  value: 3840.376 mgc: 0.1876339 ustep: 1 
iter: 2  value: 3840.376 mgc: 0.0003428982 ustep: 1 
iter: 3  mgc: 1.658417e-09 
iter: 1  value: 3839.748 mgc: 0.3901929 ustep: 1 
iter: 2  value: 3839.748 mgc: 0.0005145081 ustep: 1 
iter: 3  mgc: 2.231583e-09 
iter: 1  mgc: 2.231583e-09 
outer mgc:  2.00478 
iter: 1  value: 3838.907 mgc: 1.03339 ustep: 1 
iter: 2  value: 3838.907 mgc: 0.00214252 ustep: 1 
iter: 3  value: 3838.907 mgc: 1.231134e-08 ustep: 1 
mgc: 5.440093e-15 
iter: 1  mgc: 5.440093e-15 
outer mgc:  1.797917 
iter: 1  value: 3837.512 mgc: 0.6166124 ustep: 1 
iter: 2  value: 3837.512 mgc: 0.0006407621 ustep: 1 
iter: 3  mgc: 2.046389e-09 
iter: 1  mgc: 2.046389e-09 
outer mgc:  0.8694218 
iter: 1  value: 3837.122 mgc: 1.221632 ustep: 1 
iter: 2  value: 3837.122 mgc: 0.004171944 ustep: 1 
iter: 3  value: 3837.122 mgc: 2.529975e-07 ustep: 1 
iter: 4  mgc: 6.099288e-15 
iter: 1  mgc: 6.099288e-15 
outer mgc:  1.531086 
iter: 1  value: 3836.748 mgc: 0.6764701 ustep: 1 
iter: 2  value: 3836.748 mgc: 0.0005083634 ustep: 1 
iter: 3  mgc: 2.810882e-09 
iter: 1  mgc: 2.810882e-09 
outer mgc:  1.19909 
iter: 1  value: 3836.183 mgc: 0.3884839 ustep: 1 
iter: 2  value: 3836.183 mgc: 0.0002921442 ustep: 1 
iter: 3  mgc: 6.128875e-10 
iter: 1  mgc: 6.128875e-10 
outer mgc:  0.4782999 
iter: 1  value: 3836.083 mgc: 0.1635374 ustep: 1 
iter: 2  value: 3836.083 mgc: 2.555894e-05 ustep: 1 
iter: 3  mgc: 1.592326e-11 
iter: 1  value: 3835.874 mgc: 0.2440379 ustep: 1 
iter: 2  value: 3835.874 mgc: 4.788411e-05 ustep: 1 
iter: 3  mgc: 4.980993e-11 
iter: 1  mgc: 4.980993e-11 
outer mgc:  0.5337415 
iter: 1  value: 3835.13 mgc: 0.3315645 ustep: 1 
iter: 2  value: 3835.13 mgc: 8.197262e-05 ustep: 1 
iter: 3  mgc: 1.655489e-10 
iter: 1  value: 3833.394 mgc: 0.747464 ustep: 1 
iter: 2  value: 3833.394 mgc: 0.0003129309 ustep: 1 
iter: 3  mgc: 3.011225e-09 
iter: 1  mgc: 3.011225e-09 
outer mgc:  0.5977637 
iter: 1  value: 3831.55 mgc: 0.9760386 ustep: 1 
iter: 2  value: 3831.55 mgc: 0.001055702 ustep: 1 
iter: 3  value: 3831.55 mgc: 1.413442e-08 ustep: 1 
mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  0.3454881 
iter: 1  value: 3828.917 mgc: 1.230089 ustep: 1 
iter: 2  value: 3828.917 mgc: 0.000694912 ustep: 1 
iter: 3  mgc: 4.068833e-09 
iter: 1  mgc: 4.068833e-09 
outer mgc:  0.30164 
iter: 1  value: 3826.965 mgc: 1.110695 ustep: 1 
iter: 2  value: 3826.965 mgc: 0.0001797032 ustep: 1 
iter: 3  mgc: 5.930381e-10 
iter: 1  mgc: 5.930381e-10 
outer mgc:  0.1603216 
iter: 1  value: 3823.162 mgc: 1.684471 ustep: 1 
iter: 2  value: 3823.162 mgc: 0.0003620459 ustep: 1 
iter: 3  mgc: 1.313651e-09 
iter: 1  mgc: 1.313651e-09 
outer mgc:  0.1264352 
iter: 1  value: 3819.342 mgc: 1.761353 ustep: 1 
iter: 2  value: 3819.342 mgc: 0.000270569 ustep: 1 
iter: 3  mgc: 2.6148e-09 
iter: 1  mgc: 2.6148e-09 
outer mgc:  0.1159015 
iter: 1  value: 3816.433 mgc: 1.316113 ustep: 1 
iter: 2  value: 3816.433 mgc: 5.420181e-05 ustep: 1 
iter: 3  mgc: 1.338218e-11 
iter: 1  mgc: 1.338218e-11 
outer mgc:  0.0852214 
iter: 1  value: 3812.591 mgc: 1.739622 ustep: 1 
iter: 2  value: 3812.591 mgc: 4.158378e-05 ustep: 1 
iter: 3  mgc: 9.108714e-12 
iter: 1  mgc: 9.108714e-12 
outer mgc:  0.02721018 
iter: 1  value: 3809.312 mgc: 1.412304 ustep: 1 
iter: 2  value: 3809.312 mgc: 1.524934e-05 ustep: 1 
iter: 3  mgc: 9.50795e-13 
iter: 1  mgc: 9.50795e-13 
outer mgc:  0.01690374 
iter: 1  value: 3805.283 mgc: 1.802952 ustep: 1 
iter: 2  value: 3805.283 mgc: 1.131127e-05 ustep: 1 
iter: 3  mgc: 4.534151e-13 
iter: 1  mgc: 4.534151e-13 
outer mgc:  0.01473946 
iter: 1  value: 3801.93 mgc: 1.448821 ustep: 1 
iter: 2  value: 3801.93 mgc: 3.664702e-06 ustep: 1 
iter: 3  mgc: 1.976197e-13 
iter: 1  mgc: 1.976197e-13 
outer mgc:  0.01129525 
iter: 1  value: 3797.817 mgc: 1.856363 ustep: 1 
iter: 2  value: 3797.817 mgc: 2.647926e-06 ustep: 1 
iter: 3  mgc: 2.964295e-13 
iter: 1  mgc: 2.964295e-13 
outer mgc:  0.008130508 
iter: 1  value: 3794.406 mgc: 1.478626 ustep: 1 
iter: 2  value: 3794.406 mgc: 8.442133e-07 ustep: 1 
iter: 3  mgc: 3.26128e-13 
iter: 1  mgc: 3.26128e-13 
outer mgc:  0.005609058 
iter: 1  value: 3790.253 mgc: 1.873492 ustep: 1 
iter: 2  value: 3790.253 mgc: 5.95347e-07 ustep: 1 
iter: 3  mgc: 7.475132e-13 
iter: 1  mgc: 7.475132e-13 
outer mgc:  0.003851477 
iter: 1  value: 3786.815 mgc: 1.488997 ustep: 1 
iter: 2  value: 3786.815 mgc: 1.876031e-07 ustep: 1 
iter: 3  mgc: 9.741097e-13 
iter: 1  mgc: 9.741097e-13 
outer mgc:  0.002658964 
iter: 1  value: 3782.639 mgc: 1.884055 ustep: 1 
iter: 2  value: 3782.639 mgc: 1.311049e-07 ustep: 1 
iter: 3  mgc: 1.056932e-12 
iter: 1  mgc: 1.056932e-12 
outer mgc:  0.001836076 
iter: 1  value: 3779.186 mgc: 1.496205 ustep: 1 
iter: 2  value: 3779.186 mgc: 4.112234e-08 ustep: 1 
mgc: 2.380707e-12 
iter: 1  mgc: 2.380707e-12 
outer mgc:  0.001262324 
iter: 1  value: 3775 mgc: 1.889192 ustep: 1 
iter: 2  value: 3775 mgc: 2.858769e-08 ustep: 1 
mgc: 2.779554e-12 
iter: 1  mgc: 2.779554e-12 
outer mgc:  0.0008639465 
iter: 1  value: 3771.541 mgc: 1.499059 ustep: 1 
iter: 2  mgc: 8.945208e-09 
iter: 1  mgc: 8.945208e-09 
outer mgc:  0.0005912117 
iter: 1  value: 3767.35 mgc: 1.891357 ustep: 1 
iter: 2  mgc: 6.20259e-09 
iter: 1  mgc: 6.20259e-09 
outer mgc:  0.0004034422 
iter: 1  value: 3763.887 mgc: 1.5005 ustep: 1 
iter: 2  mgc: 1.936107e-09 
iter: 1  mgc: 1.936107e-09 
outer mgc:  0.0002757825 
iter: 1  value: 3759.694 mgc: 1.892482 ustep: 1 
iter: 2  mgc: 1.345319e-09 
iter: 1  mgc: 1.345319e-09 
outer mgc:  0.0001880237 
iter: 1  value: 3756.23 mgc: 1.501185 ustep: 1 
iter: 2  mgc: 4.225655e-10 
iter: 1  mgc: 4.225655e-10 
outer mgc:  0.0001284409 
iter: 1  value: 3752.036 mgc: 1.892957 ustep: 1 
iter: 2  mgc: 2.93872e-10 
iter: 1  mgc: 2.93872e-10 
outer mgc:  8.750345e-05 
iter: 1  value: 3748.571 mgc: 1.501475 ustep: 1 
iter: 2  mgc: 9.834e-11 
iter: 1  mgc: 9.834e-11 
outer mgc:  5.9754e-05 
iter: 1  mgc: 9.834e-11 
iter: 1  mgc: 9.834e-11 
outer mgc:  5.9754e-05 
iter: 1  value: 3748.571 mgc: 0.005801272 ustep: 1 
iter: 2  value: 3748.571 mgc: 2.418365e-07 ustep: 1 
iter: 3  mgc: 3.257028e-11 
outer mgc:  0.07831794 
iter: 1  value: 3748.571 mgc: 0.00580006 ustep: 1 
iter: 2  value: 3748.571 mgc: 2.410845e-07 ustep: 1 
iter: 3  mgc: 5.808704e-11 
outer mgc:  0.07830834 
iter: 1  value: 3748.571 mgc: 0.003054558 ustep: 1 
iter: 2  value: 3748.571 mgc: 7.700551e-08 ustep: 1 
iter: 3  mgc: 3.924733e-11 
outer mgc:  0.0454013 
iter: 1  value: 3748.571 mgc: 0.003054191 ustep: 1 
iter: 2  value: 3748.571 mgc: 7.685157e-08 ustep: 1 
iter: 3  mgc: 5.864359e-11 
outer mgc:  0.0453818 
iter: 1  value: 3748.573 mgc: 0.005726081 ustep: 1 
iter: 2  value: 3748.573 mgc: 1.094283e-07 ustep: 1 
iter: 3  mgc: 4.000444e-11 
outer mgc:  0.08624313 
iter: 1  value: 3748.569 mgc: 0.005724104 ustep: 1 
iter: 2  value: 3748.569 mgc: 1.090276e-07 ustep: 1 
iter: 3  mgc: 2.351352e-11 
outer mgc:  0.086206 
iter: 1  value: 3748.572 mgc: 0.003036166 ustep: 1 
iter: 2  value: 3748.572 mgc: 3.151802e-08 ustep: 1 
iter: 3  mgc: 4.7224e-11 
outer mgc:  0.04769269 
iter: 1  value: 3748.57 mgc: 0.003036537 ustep: 1 
iter: 2  value: 3748.57 mgc: 3.150036e-08 ustep: 1 
iter: 3  mgc: 4.988698e-11 
outer mgc:  0.04767187 
iter: 1  value: 3748.582 mgc: 173.3137 ustep: 1 
iter: 2  value: 3748.582 mgc: 7.829261e-07 ustep: 1 
iter: 3  mgc: 5.718581e-11 
outer mgc:  0.02559016 
iter: 1  value: 3748.559 mgc: 173.4871 ustep: 1 
iter: 2  value: 3748.559 mgc: 7.846292e-07 ustep: 1 
iter: 3  mgc: 4.428191e-11 
outer mgc:  0.02549168 
iter: 1  value: 3748.587 mgc: 173.146 ustep: 1 
iter: 2  value: 3748.587 mgc: 1.292299e-06 ustep: 1 
iter: 3  mgc: 4.390294e-11 
outer mgc:  0.0201009 
iter: 1  value: 3748.555 mgc: 173.6662 ustep: 1 
iter: 2  value: 3748.555 mgc: 1.291294e-06 ustep: 1 
iter: 3  mgc: 4.534617e-11 
outer mgc:  0.0200827 
iter: 1  value: 3748.571 mgc: 2.660982e-05 ustep: 1 
mgc: 3.160205e-11 
outer mgc:  5.975287e-05 
iter: 1  value: 3748.571 mgc: 2.660943e-05 ustep: 1 
mgc: 3.82987e-11 
outer mgc:  5.975512e-05 
iter: 1  value: 3748.566 mgc: 0.003405118 ustep: 1 
iter: 2  value: 3748.566 mgc: 6.923901e-08 ustep: 1 
iter: 3  mgc: 2.91891e-11 
outer mgc:  0.02782819 
iter: 1  value: 3748.575 mgc: 0.003402517 ustep: 1 
iter: 2  value: 3748.575 mgc: 6.91845e-08 ustep: 1 
iter: 3  mgc: 4.823031e-11 
outer mgc:  0.0279395 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:48:46 2021]
Finished job 0.
1 of 1 steps (100%) done

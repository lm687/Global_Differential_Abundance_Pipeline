Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 22:05:40 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_0.05_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.05, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22076.613941 
iter  10 value 18853.453176
iter  10 value 18853.453176
final  value 18853.453176 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19074.93 mgc: 5.770821 ustep: 0.6827823 
iter: 2  value: 19035.23 mgc: 3.204504 ustep: 0.8263238 
iter: 3  value: 19034.19 mgc: 1.249003 ustep: 0.9090326 
iter: 4  value: 19034.18 mgc: 0.09946445 ustep: 0.9534367 
iter: 5  value: 19034.18 mgc: 0.003605296 ustep: 0.9764432 
iter: 6  value: 19034.18 mgc: 5.556524e-05 ustep: 0.9881526 
iter: 7  value: 19034.18 mgc: 5.424628e-07 ustep: 0.9940592 
iter: 8  mgc: 2.965691e-09 
iter: 1  mgc: 2.965691e-09 
Matching hessian patterns... Done
outer mgc:  155.0714 
iter: 1  value: 18813.5 mgc: 0.9620938 ustep: 1 
iter: 2  value: 18813.47 mgc: 0.09812518 ustep: 1 
iter: 3  value: 18813.47 mgc: 0.0007789901 ustep: 1 
iter: 4  value: 18813.47 mgc: 5.144163e-08 ustep: 1 
iter: 5  mgc: 4.32987e-15 
iter: 1  value: 18794.08 mgc: 22.19783 ustep: 0.6827823 
iter: 2  value: 18583.69 mgc: 24.06732 ustep: 0.8263238 
iter: 3  value: 18579.51 mgc: 2.21923 ustep: 0.9090326 
iter: 4  value: 18579.5 mgc: 0.1412709 ustep: 0.9534367 
iter: 5  value: 18579.5 mgc: 0.001331918 ustep: 0.9764432 
iter: 6  value: 18579.5 mgc: 3.279996e-06 ustep: 0.9881526 
iter: 7  mgc: 4.938507e-09 
iter: 1  mgc: 4.938507e-09 
outer mgc:  402.0547 
iter: 1  value: 29440.25 mgc: 76.93657 ustep: 0.1336527 
iter: 2  value: 25760.47 mgc: 91.47417 ustep: 0.3656489 
iter: 3  value: 24986.97 mgc: 88.29579 ustep: 0.03707444 
iter: 4  value: 24856.3 mgc: 91.57373 ustep: 0.101451 
iter: 5  value: 24669.3 mgc: 91.78197 ustep: 0.02367882 
iter: 6  value: 24664.23 mgc: 12.98936 ustep: 0.1539638 
iter: 7  value: 24663.98 mgc: 1.441997 ustep: 0.392443 
iter: 8  value: 24663.98 mgc: 0.1551433 ustep: 0.6264901 
iter: 9  value: 24663.98 mgc: 0.00615418 ustep: 0.7915321 
iter: 10  value: 24663.98 mgc: 0.0001053285 ustep: 0.8896919 
iter: 11  value: 24663.98 mgc: 8.549785e-07 ustep: 0.9432405 
iter: 12  mgc: 3.635726e-09 
iter: 1  value: 18415.7 mgc: 11.63152 ustep: 1 
iter: 2  value: 18415.5 mgc: 0.3815981 ustep: 1 
iter: 3  value: 18415.5 mgc: 0.004486635 ustep: 1 
iter: 4  value: 18415.5 mgc: 5.691637e-07 ustep: 1 
iter: 5  mgc: 5.248363e-14 
iter: 1  mgc: 5.248363e-14 
outer mgc:  68.76597 
iter: 1  value: 18383.14 mgc: 7.245748 ustep: 1 
iter: 2  value: 18382.84 mgc: 0.4205493 ustep: 1 
iter: 3  value: 18382.84 mgc: 0.007394189 ustep: 1 
iter: 4  value: 18382.84 mgc: 3.12205e-06 ustep: 1 
iter: 5  mgc: 5.615508e-13 
iter: 1  mgc: 5.615508e-13 
outer mgc:  65.7096 
iter: 1  value: 18379.28 mgc: 8.027042 ustep: 1 
iter: 2  value: 18371.11 mgc: 2.112534 ustep: 1 
iter: 3  value: 18371.09 mgc: 0.1050509 ustep: 1 
iter: 4  value: 18371.09 mgc: 0.0003402793 ustep: 1 
iter: 5  mgc: 3.627287e-09 
iter: 1  mgc: 3.627287e-09 
outer mgc:  137.99 
iter: 1  value: 18311.04 mgc: 3.992651 ustep: 1 
iter: 2  value: 18310.93 mgc: 0.3989469 ustep: 1 
iter: 3  value: 18310.93 mgc: 0.002142258 ustep: 1 
iter: 4  value: 18310.93 mgc: 1.931727e-07 ustep: 1 
iter: 5  mgc: 7.083223e-14 
iter: 1  mgc: 7.083223e-14 
outer mgc:  79.20764 
iter: 1  value: 18297.83 mgc: 5.782358 ustep: 1 
iter: 2  value: 18296.9 mgc: 0.7872373 ustep: 1 
iter: 3  value: 18296.9 mgc: 0.01100756 ustep: 1 
iter: 4  value: 18296.9 mgc: 2.255738e-06 ustep: 1 
iter: 5  mgc: 9.903189e-14 
iter: 1  mgc: 9.903189e-14 
outer mgc:  158.7192 
iter: 1  value: 18252.08 mgc: 10.54969 ustep: 1 
iter: 2  value: 18252 mgc: 0.3885248 ustep: 1 
iter: 3  value: 18252 mgc: 0.00155154 ustep: 1 
iter: 4  value: 18252 mgc: 3.471761e-08 ustep: 1 
mgc: 7.81597e-14 
iter: 1  mgc: 7.81597e-14 
outer mgc:  114.2291 
iter: 1  value: 18245.49 mgc: 7.084078 ustep: 1 
iter: 2  value: 18245.47 mgc: 0.272177 ustep: 1 
iter: 3  value: 18245.47 mgc: 0.0006796432 ustep: 1 
iter: 4  mgc: 9.141617e-09 
iter: 1  value: 18241.32 mgc: 3.820783 ustep: 1 
iter: 2  value: 18241.32 mgc: 0.06079274 ustep: 1 
iter: 3  value: 18241.32 mgc: 3.386827e-05 ustep: 1 
iter: 4  mgc: 3.238654e-11 
iter: 1  mgc: 3.238654e-11 
outer mgc:  58.00692 
iter: 1  value: 18237.48 mgc: 5.389838 ustep: 1 
iter: 2  value: 18237.48 mgc: 0.08031659 ustep: 1 
iter: 3  value: 18237.48 mgc: 1.23871e-05 ustep: 1 
iter: 4  mgc: 1.506684e-12 
iter: 1  mgc: 1.506684e-12 
outer mgc:  26.50987 
iter: 1  value: 18231.38 mgc: 3.385897 ustep: 1 
iter: 2  value: 18231.38 mgc: 0.07916738 ustep: 1 
iter: 3  value: 18231.38 mgc: 4.560776e-05 ustep: 1 
iter: 4  mgc: 1.524875e-11 
iter: 1  mgc: 1.524875e-11 
outer mgc:  43.8128 
iter: 1  value: 18229.75 mgc: 2.218764 ustep: 1 
iter: 2  value: 18229.75 mgc: 0.01380758 ustep: 1 
iter: 3  value: 18229.75 mgc: 1.280649e-06 ustep: 1 
iter: 4  mgc: 6.161738e-14 
iter: 1  mgc: 6.161738e-14 
outer mgc:  50.98545 
iter: 1  value: 18228.03 mgc: 1.344914 ustep: 1 
iter: 2  value: 18228.03 mgc: 0.008381471 ustep: 1 
iter: 3  value: 18228.03 mgc: 3.980577e-07 ustep: 1 
iter: 4  mgc: 7.327472e-14 
iter: 1  mgc: 7.327472e-14 
outer mgc:  6.588804 
iter: 1  value: 18226.87 mgc: 0.74506 ustep: 1 
iter: 2  value: 18226.87 mgc: 0.003185292 ustep: 1 
iter: 3  value: 18226.87 mgc: 8.239349e-08 ustep: 1 
mgc: 7.505108e-14 
iter: 1  mgc: 7.505108e-14 
outer mgc:  7.13688 
iter: 1  value: 18225.44 mgc: 0.5317516 ustep: 1 
iter: 2  value: 18225.44 mgc: 0.001473603 ustep: 1 
iter: 3  value: 18225.44 mgc: 1.236911e-08 ustep: 1 
mgc: 9.200973e-14 
iter: 1  mgc: 9.200973e-14 
outer mgc:  14.57637 
iter: 1  value: 18223.82 mgc: 0.613423 ustep: 1 
iter: 2  value: 18223.82 mgc: 0.001850447 ustep: 1 
iter: 3  value: 18223.82 mgc: 2.121609e-08 ustep: 1 
mgc: 6.661338e-14 
iter: 1  mgc: 6.661338e-14 
outer mgc:  5.397937 
iter: 1  value: 18223.48 mgc: 0.4104517 ustep: 1 
iter: 2  value: 18223.48 mgc: 0.0008552295 ustep: 1 
iter: 3  mgc: 4.66924e-09 
iter: 1  mgc: 4.66924e-09 
outer mgc:  5.704153 
iter: 1  value: 18220.92 mgc: 0.9832864 ustep: 1 
iter: 2  value: 18220.92 mgc: 0.005531789 ustep: 1 
iter: 3  value: 18220.92 mgc: 1.84554e-07 ustep: 1 
iter: 4  mgc: 7.105427e-14 
iter: 1  mgc: 7.105427e-14 
outer mgc:  9.763545 
iter: 1  value: 18216.79 mgc: 0.9208759 ustep: 1 
iter: 2  value: 18216.79 mgc: 0.003480143 ustep: 1 
iter: 3  value: 18216.79 mgc: 6.382384e-08 ustep: 1 
mgc: 1.060263e-13 
iter: 1  mgc: 1.060263e-13 
outer mgc:  6.31103 
iter: 1  value: 18218.21 mgc: 0.8012199 ustep: 1 
iter: 2  value: 18218.21 mgc: 0.002282489 ustep: 1 
iter: 3  value: 18218.21 mgc: 1.462512e-07 ustep: 1 
iter: 4  mgc: 6.98816e-14 
iter: 1  mgc: 6.98816e-14 
outer mgc:  16.3057 
iter: 1  value: 18219.49 mgc: 1.083906 ustep: 1 
iter: 2  value: 18219.49 mgc: 0.003538809 ustep: 1 
iter: 3  value: 18219.49 mgc: 1.309433e-07 ustep: 1 
iter: 4  mgc: 6.394885e-14 
iter: 1  mgc: 6.394885e-14 
outer mgc:  10.59577 
iter: 1  value: 18212.4 mgc: 1.076654 ustep: 1 
iter: 2  value: 18212.4 mgc: 0.005988661 ustep: 1 
iter: 3  value: 18212.4 mgc: 3.870918e-07 ustep: 1 
iter: 4  mgc: 6.949996e-14 
iter: 1  mgc: 6.949996e-14 
outer mgc:  5.562232 
iter: 1  value: 18213.2 mgc: 2.699078 ustep: 1 
iter: 2  value: 18213.2 mgc: 0.02794327 ustep: 1 
iter: 3  value: 18213.2 mgc: 1.039684e-05 ustep: 1 
iter: 4  mgc: 2.499834e-12 
iter: 1  value: 18212.51 mgc: 1.145462 ustep: 1 
iter: 2  value: 18212.51 mgc: 0.005134727 ustep: 1 
iter: 3  value: 18212.51 mgc: 3.727965e-07 ustep: 1 
iter: 4  mgc: 5.495604e-14 
iter: 1  mgc: 5.495604e-14 
outer mgc:  5.866368 
iter: 1  value: 18211.73 mgc: 0.552184 ustep: 1 
iter: 2  value: 18211.73 mgc: 0.0005146582 ustep: 1 
iter: 3  mgc: 1.024378e-09 
iter: 1  mgc: 1.024378e-09 
outer mgc:  11.71325 
iter: 1  value: 18210.79 mgc: 0.4611043 ustep: 1 
iter: 2  value: 18210.79 mgc: 0.001213698 ustep: 1 
iter: 3  value: 18210.79 mgc: 2.878764e-08 ustep: 1 
mgc: 6.483702e-14 
iter: 1  mgc: 6.483702e-14 
outer mgc:  4.158692 
iter: 1  value: 18210.67 mgc: 0.1549054 ustep: 1 
iter: 2  value: 18210.67 mgc: 0.0003734734 ustep: 1 
iter: 3  mgc: 2.850424e-09 
iter: 1  value: 18210.53 mgc: 0.1929671 ustep: 1 
iter: 2  value: 18210.53 mgc: 0.0006933325 ustep: 1 
iter: 3  value: 18210.53 mgc: 1.439442e-08 ustep: 1 
mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  4.301901 
iter: 1  value: 18208.84 mgc: 1.335963 ustep: 1 
iter: 2  value: 18208.84 mgc: 0.005939137 ustep: 1 
iter: 3  value: 18208.84 mgc: 1.308591e-07 ustep: 1 
mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  8.809652 
iter: 1  value: 18207.13 mgc: 0.6507826 ustep: 1 
iter: 2  value: 18207.13 mgc: 0.001550967 ustep: 1 
iter: 3  value: 18207.13 mgc: 1.028111e-08 ustep: 1 
mgc: 8.570922e-14 
iter: 1  mgc: 8.570922e-14 
outer mgc:  3.404669 
iter: 1  value: 18199.78 mgc: 1.035461 ustep: 1 
iter: 2  value: 18199.78 mgc: 0.001650053 ustep: 1 
iter: 3  value: 18199.78 mgc: 3.804004e-08 ustep: 1 
iter: 4  mgc: 9.237056e-14 
iter: 1  mgc: 9.237056e-14 
outer mgc:  10.52547 
iter: 1  value: 18195.5 mgc: 0.8837602 ustep: 1 
iter: 2  value: 18195.5 mgc: 0.001880306 ustep: 1 
iter: 3  mgc: 9.278316e-09 
iter: 1  mgc: 9.278316e-09 
outer mgc:  3.01261 
iter: 1  value: 18193.02 mgc: 1.271497 ustep: 1 
iter: 2  value: 18193.02 mgc: 0.002087869 ustep: 1 
iter: 3  value: 18193.02 mgc: 2.344389e-08 ustep: 1 
mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  5.332369 
iter: 1  value: 18189.7 mgc: 0.7479492 ustep: 1 
iter: 2  value: 18189.7 mgc: 0.001208137 ustep: 1 
iter: 3  mgc: 2.8794e-09 
iter: 1  mgc: 2.8794e-09 
outer mgc:  2.636361 
iter: 1  value: 18180.98 mgc: 1.982254 ustep: 1 
iter: 2  value: 18180.98 mgc: 0.005064711 ustep: 1 
iter: 3  value: 18180.98 mgc: 5.524685e-08 ustep: 1 
mgc: 6.707135e-14 
iter: 1  mgc: 6.707135e-14 
outer mgc:  1.528138 
iter: 1  value: 18173.1 mgc: 1.521161 ustep: 1 
iter: 2  value: 18173.1 mgc: 0.001943801 ustep: 1 
iter: 3  mgc: 6.801122e-09 
iter: 1  mgc: 6.801122e-09 
outer mgc:  0.8707335 
iter: 1  value: 18165.76 mgc: 1.479683 ustep: 1 
iter: 2  value: 18165.76 mgc: 0.001440136 ustep: 1 
iter: 3  mgc: 2.862785e-09 
iter: 1  mgc: 2.862785e-09 
outer mgc:  0.4400669 
iter: 1  value: 18159.52 mgc: 1.214268 ustep: 1 
iter: 2  value: 18159.52 mgc: 0.0007789862 ustep: 1 
iter: 3  mgc: 8.634498e-10 
iter: 1  mgc: 8.634498e-10 
outer mgc:  0.3053646 
iter: 1  value: 18155.46 mgc: 0.7869925 ustep: 1 
iter: 2  value: 18155.46 mgc: 0.0002485345 ustep: 1 
iter: 3  mgc: 6.642686e-11 
iter: 1  mgc: 6.642686e-11 
outer mgc:  0.1314422 
iter: 1  value: 18153.28 mgc: 0.3991938 ustep: 1 
iter: 2  value: 18153.28 mgc: 6.566484e-05 ustep: 1 
iter: 3  mgc: 5.054623e-12 
iter: 1  mgc: 5.054623e-12 
outer mgc:  0.08458232 
iter: 1  value: 18152.49 mgc: 0.1478014 ustep: 1 
iter: 2  value: 18152.49 mgc: 7.483286e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  0.02892276 
iter: 1  value: 18152.39 mgc: 0.01792812 ustep: 1 
iter: 2  value: 18152.39 mgc: 1.333317e-07 ustep: 1 
mgc: 6.239453e-14 
iter: 1  mgc: 6.239453e-14 
outer mgc:  0.004381039 
iter: 1  mgc: 6.239453e-14 
iter: 1  mgc: 6.239453e-14 
outer mgc:  0.004381039 
iter: 1  value: 18152.39 mgc: 0.01390015 ustep: 1 
iter: 2  value: 18152.39 mgc: 1.712057e-07 ustep: 1 
iter: 3  mgc: 5.950795e-14 
outer mgc:  0.999769 
iter: 1  value: 18152.39 mgc: 0.01388924 ustep: 1 
iter: 2  value: 18152.39 mgc: 1.708304e-07 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  0.9901587 
iter: 1  value: 18152.39 mgc: 0.008214154 ustep: 1 
iter: 2  value: 18152.39 mgc: 5.926112e-08 ustep: 1 
iter: 3  mgc: 6.039613e-14 
outer mgc:  0.5362193 
iter: 1  value: 18152.39 mgc: 0.008208354 ustep: 1 
iter: 2  value: 18152.39 mgc: 5.915617e-08 ustep: 1 
iter: 3  mgc: 8.260059e-14 
outer mgc:  0.5328214 
iter: 1  value: 18152.39 mgc: 0.02476958 ustep: 1 
iter: 2  value: 18152.39 mgc: 2.888436e-06 ustep: 1 
iter: 3  mgc: 1.811884e-13 
outer mgc:  1.013586 
iter: 1  value: 18152.39 mgc: 0.02477279 ustep: 1 
iter: 2  value: 18152.39 mgc: 2.87989e-06 ustep: 1 
iter: 3  mgc: 2.051692e-13 
outer mgc:  1.021917 
iter: 1  value: 18152.39 mgc: 0.01264556 ustep: 1 
iter: 2  value: 18152.39 mgc: 7.715929e-07 ustep: 1 
iter: 3  mgc: 7.61613e-14 
outer mgc:  0.8054974 
iter: 1  value: 18152.39 mgc: 0.01264646 ustep: 1 
iter: 2  value: 18152.39 mgc: 7.703681e-07 ustep: 1 
iter: 3  mgc: 6.483702e-14 
outer mgc:  0.8094454 
iter: 1  value: 18152.47 mgc: 0.1501831 ustep: 1 
iter: 2  value: 18152.47 mgc: 8.546611e-06 ustep: 1 
iter: 3  mgc: 6.017409e-14 
outer mgc:  0.1848015 
iter: 1  value: 18152.31 mgc: 0.1506327 ustep: 1 
iter: 2  value: 18152.31 mgc: 8.534045e-06 ustep: 1 
iter: 3  mgc: 6.528111e-14 
outer mgc:  0.1851745 
iter: 1  value: 18152.42 mgc: 0.1487932 ustep: 1 
iter: 2  value: 18152.42 mgc: 7.792276e-06 ustep: 1 
iter: 3  mgc: 9.103829e-14 
outer mgc:  0.2868517 
iter: 1  value: 18152.36 mgc: 0.1489421 ustep: 1 
iter: 2  value: 18152.36 mgc: 7.787288e-06 ustep: 1 
iter: 3  mgc: 6.927792e-14 
outer mgc:  0.2852112 
iter: 1  value: 18152.37 mgc: 0.003123576 ustep: 1 
iter: 2  mgc: 3.141392e-09 
outer mgc:  0.004004718 
iter: 1  value: 18152.41 mgc: 0.003122977 ustep: 1 
iter: 2  mgc: 3.144535e-09 
outer mgc:  0.004757605 
iter: 1  value: 18152.37 mgc: 0.00423754 ustep: 1 
iter: 2  value: 18152.37 mgc: 1.255534e-07 ustep: 1 
iter: 3  mgc: 5.728751e-14 
outer mgc:  0.04203472 
iter: 1  value: 18152.41 mgc: 0.004236667 ustep: 1 
iter: 2  value: 18152.41 mgc: 1.256428e-07 ustep: 1 
iter: 3  mgc: 6.039613e-14 
outer mgc:  0.04095624 
[Sun Aug 15 22:05:44 2021]
Finished job 0.
1 of 1 steps (100%) done

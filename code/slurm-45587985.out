Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:04:42 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_80_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2235.676007 
final  value 2125.256659 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2179.509 mgc: 2.982921 ustep: 0.6827823 
iter: 2  value: 2179.25 mgc: 0.4388584 ustep: 0.8263238 
iter: 3  value: 2179.245 mgc: 0.05591841 ustep: 0.9090326 
iter: 4  value: 2179.245 mgc: 0.003475937 ustep: 0.9534367 
iter: 5  value: 2179.245 mgc: 0.0001220447 ustep: 0.9764432 
iter: 6  value: 2179.245 mgc: 2.453241e-06 ustep: 0.9881526 
iter: 7  value: 2179.245 mgc: 2.609462e-08 ustep: 0.9940592 
iter: 8  mgc: 1.413348e-10 
iter: 1  mgc: 1.413348e-10 
Matching hessian patterns... Done
outer mgc:  16.83229 
iter: 1  value: 2155.598 mgc: 0.3420138 ustep: 1 
iter: 2  value: 2155.598 mgc: 0.006172841 ustep: 1 
iter: 3  value: 2155.598 mgc: 4.791046e-06 ustep: 1 
iter: 4  mgc: 3.503864e-13 
iter: 1  value: 2112.526 mgc: 5.045219 ustep: 1 
iter: 2  value: 2112.518 mgc: 0.385707 ustep: 1 
iter: 3  value: 2112.518 mgc: 0.001808727 ustep: 1 
iter: 4  value: 2112.518 mgc: 3.633927e-08 ustep: 1 
mgc: 5.57332e-14 
iter: 1  mgc: 5.57332e-14 
outer mgc:  19.07486 
iter: 1  value: 2458.559 mgc: 151.5489 ustep: 0.1322364 
iter: 2  value: 2299.855 mgc: 15.60658 ustep: 0.1227462 
iter: 3  value: 2250.266 mgc: 26.31849 ustep: 0.09693539 
iter: 4  value: 2234.892 mgc: 8.38442 ustep: 0.1701718 
iter: 5  value: 2234.611 mgc: 7.117896 ustep: 0.4125776 
iter: 6  value: 2234.611 mgc: 0.07186856 ustep: 0.6423578 
iter: 7  value: 2234.611 mgc: 0.002782521 ustep: 0.8014921 
iter: 8  value: 2234.611 mgc: 5.327042e-05 ustep: 0.8952714 
iter: 9  value: 2234.611 mgc: 5.262147e-07 ustep: 0.9461932 
iter: 10  mgc: 2.541494e-09 
iter: 1  value: 2119.172 mgc: 7.945155 ustep: 1 
iter: 2  value: 2116.868 mgc: 4.58801 ustep: 1 
iter: 3  value: 2116.86 mgc: 0.2807798 ustep: 1 
iter: 4  value: 2116.86 mgc: 0.001514688 ustep: 1 
iter: 5  value: 2116.86 mgc: 6.045805e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  value: 2109.832 mgc: 4.319354 ustep: 1 
iter: 2  value: 2109.81 mgc: 0.4325308 ustep: 1 
iter: 3  value: 2109.81 mgc: 0.002564992 ustep: 1 
iter: 4  value: 2109.81 mgc: 9.889328e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  18.29003 
iter: 1  value: 2108.382 mgc: 5.609734 ustep: 1 
iter: 2  value: 2108.38 mgc: 0.1082399 ustep: 1 
iter: 3  value: 2108.38 mgc: 0.0001822588 ustep: 1 
iter: 4  mgc: 2.748757e-10 
iter: 1  mgc: 2.748757e-10 
outer mgc:  17.59181 
iter: 1  value: 2104.56 mgc: 5.819263 ustep: 1 
iter: 2  value: 2104.474 mgc: 0.6665631 ustep: 1 
iter: 3  value: 2104.474 mgc: 0.00731175 ustep: 1 
iter: 4  value: 2104.474 mgc: 9.318332e-07 ustep: 1 
iter: 5  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  7.464122 
iter: 1  value: 2100.43 mgc: 2.409792 ustep: 1 
iter: 2  value: 2100.429 mgc: 0.09076011 ustep: 1 
iter: 3  value: 2100.429 mgc: 5.340413e-05 ustep: 1 
iter: 4  mgc: 3.179379e-11 
iter: 1  value: 2098.355 mgc: 17.70344 ustep: 1 
iter: 2  value: 2098.352 mgc: 0.4007773 ustep: 1 
iter: 3  value: 2098.352 mgc: 0.0001668132 ustep: 1 
iter: 4  mgc: 3.381029e-11 
iter: 1  mgc: 3.179379e-11 
outer mgc:  5.719775 
iter: 1  value: 2103.547 mgc: 10.02101 ustep: 1 
iter: 2  value: 2103.542 mgc: 0.2958759 ustep: 1 
iter: 3  value: 2103.542 mgc: 0.000276636 ustep: 1 
iter: 4  mgc: 2.056675e-10 
iter: 1  value: 2099.057 mgc: 2.145323 ustep: 1 
iter: 2  value: 2099.057 mgc: 0.03518697 ustep: 1 
iter: 3  value: 2099.057 mgc: 1.093051e-05 ustep: 1 
iter: 4  mgc: 9.861001e-13 
iter: 1  mgc: 9.861001e-13 
outer mgc:  8.437011 
iter: 1  value: 2097.037 mgc: 2.897684 ustep: 1 
iter: 2  value: 2097.037 mgc: 0.01121583 ustep: 1 
iter: 3  value: 2097.037 mgc: 7.66213e-07 ustep: 1 
iter: 4  mgc: 2.270406e-14 
iter: 1  mgc: 2.270406e-14 
outer mgc:  6.13415 
iter: 1  value: 2093.117 mgc: 2.920317 ustep: 1 
iter: 2  value: 2093.117 mgc: 0.02677565 ustep: 1 
iter: 3  value: 2093.117 mgc: 1.74512e-06 ustep: 1 
iter: 4  mgc: 3.375078e-14 
iter: 1  mgc: 3.375078e-14 
outer mgc:  6.333053 
iter: 1  value: 2089.909 mgc: 3.792693 ustep: 1 
iter: 2  value: 2089.909 mgc: 0.01496588 ustep: 1 
iter: 3  value: 2089.909 mgc: 7.436611e-07 ustep: 1 
iter: 4  mgc: 5.551115e-14 
iter: 1  mgc: 5.551115e-14 
outer mgc:  7.685235 
iter: 1  value: 2086.739 mgc: 3.556589 ustep: 1 
iter: 2  value: 2086.739 mgc: 0.01212845 ustep: 1 
iter: 3  value: 2086.739 mgc: 1.384297e-07 ustep: 1 
mgc: 4.862777e-14 
iter: 1  mgc: 4.862777e-14 
outer mgc:  5.516154 
iter: 1  value: 2087.916 mgc: 8.67074 ustep: 1 
iter: 2  value: 2087.916 mgc: 0.01479549 ustep: 1 
iter: 3  value: 2087.916 mgc: 6.772242e-07 ustep: 1 
iter: 4  mgc: 3.996803e-14 
iter: 1  value: 2086.57 mgc: 1.643704 ustep: 1 
iter: 2  value: 2086.57 mgc: 0.001035928 ustep: 1 
iter: 3  mgc: 2.790387e-09 
iter: 1  mgc: 2.790387e-09 
outer mgc:  7.442067 
iter: 1  value: 2086.298 mgc: 1.000332 ustep: 1 
iter: 2  value: 2086.298 mgc: 0.0005122683 ustep: 1 
iter: 3  mgc: 1.658689e-10 
iter: 1  mgc: 1.658689e-10 
outer mgc:  1.68277 
iter: 1  value: 2085.795 mgc: 1.320537 ustep: 1 
iter: 2  value: 2085.795 mgc: 0.0006697999 ustep: 1 
iter: 3  mgc: 5.695515e-10 
iter: 1  mgc: 5.695515e-10 
outer mgc:  2.155372 
iter: 1  value: 2084.837 mgc: 3.517645 ustep: 1 
iter: 2  value: 2084.837 mgc: 0.005831015 ustep: 1 
iter: 3  value: 2084.837 mgc: 6.335378e-08 ustep: 1 
mgc: 3.885781e-14 
iter: 1  mgc: 3.885781e-14 
outer mgc:  1.923553 
iter: 1  value: 2084.473 mgc: 1.937691 ustep: 1 
iter: 2  value: 2084.473 mgc: 0.002672197 ustep: 1 
iter: 3  value: 2084.473 mgc: 2.355303e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  value: 2084.62 mgc: 0.460703 ustep: 1 
iter: 2  value: 2084.62 mgc: 0.000172005 ustep: 1 
iter: 3  mgc: 1.555904e-10 
iter: 1  mgc: 1.555904e-10 
outer mgc:  1.527043 
iter: 1  value: 2084.362 mgc: 0.3177865 ustep: 1 
iter: 2  value: 2084.362 mgc: 6.725839e-05 ustep: 1 
iter: 3  mgc: 1.20981e-12 
iter: 1  mgc: 1.20981e-12 
outer mgc:  0.7713261 
iter: 1  value: 2083.666 mgc: 0.890141 ustep: 1 
iter: 2  value: 2083.666 mgc: 0.001438182 ustep: 1 
iter: 3  mgc: 1.251262e-09 
iter: 1  mgc: 1.251262e-09 
outer mgc:  2.252735 
iter: 1  value: 2082.943 mgc: 1.058949 ustep: 1 
iter: 2  value: 2082.943 mgc: 0.0009720281 ustep: 1 
iter: 3  mgc: 6.54401e-10 
iter: 1  mgc: 6.54401e-10 
outer mgc:  1.331031 
iter: 1  value: 2082.253 mgc: 0.712834 ustep: 1 
iter: 2  value: 2082.253 mgc: 0.0006895132 ustep: 1 
iter: 3  mgc: 3.801306e-10 
iter: 1  mgc: 3.801306e-10 
outer mgc:  0.5945566 
iter: 1  value: 2081.604 mgc: 2.124461 ustep: 1 
iter: 2  value: 2081.604 mgc: 0.0004904023 ustep: 1 
iter: 3  mgc: 4.286305e-11 
iter: 1  mgc: 4.286305e-11 
outer mgc:  1.28419 
iter: 1  value: 2080.836 mgc: 1.605632 ustep: 1 
iter: 2  value: 2080.836 mgc: 0.0002268333 ustep: 1 
iter: 3  mgc: 5.214673e-11 
iter: 1  value: 2079.072 mgc: 4.760938 ustep: 1 
iter: 2  value: 2079.072 mgc: 0.001031051 ustep: 1 
iter: 3  mgc: 9.780529e-10 
iter: 1  mgc: 9.780529e-10 
outer mgc:  0.5079442 
iter: 1  value: 2076.988 mgc: 2.573696 ustep: 1 
iter: 2  value: 2076.988 mgc: 0.001482518 ustep: 1 
iter: 3  mgc: 6.244443e-10 
iter: 1  mgc: 6.244443e-10 
outer mgc:  0.4208825 
iter: 1  value: 2076.48 mgc: 1.231596 ustep: 1 
iter: 2  value: 2076.48 mgc: 4.004246e-05 ustep: 1 
iter: 3  mgc: 4.250711e-12 
iter: 1  mgc: 4.250711e-12 
outer mgc:  0.2118675 
iter: 1  value: 2076.024 mgc: 3.116129 ustep: 1 
iter: 2  value: 2076.024 mgc: 0.0002639602 ustep: 1 
iter: 3  mgc: 7.207257e-11 
iter: 1  mgc: 7.207257e-11 
outer mgc:  0.2837776 
iter: 1  value: 2075.625 mgc: 0.3971782 ustep: 1 
iter: 2  value: 2075.625 mgc: 8.920393e-06 ustep: 1 
iter: 3  mgc: 7.149836e-14 
iter: 1  mgc: 7.149836e-14 
outer mgc:  0.2225488 
iter: 1  value: 2074.472 mgc: 4.084904 ustep: 1 
iter: 2  value: 2074.472 mgc: 0.0001667694 ustep: 1 
iter: 3  mgc: 3.554301e-11 
iter: 1  mgc: 3.554301e-11 
outer mgc:  0.133269 
iter: 1  value: 2073.018 mgc: 12.07807 ustep: 1 
iter: 2  value: 2073.018 mgc: 0.0006472353 ustep: 1 
iter: 3  mgc: 2.871621e-10 
iter: 1  mgc: 2.871621e-10 
outer mgc:  0.1992372 
iter: 1  value: 2071.595 mgc: 9.655313 ustep: 1 
iter: 2  value: 2071.595 mgc: 0.0002012829 ustep: 1 
iter: 3  mgc: 8.655299e-12 
iter: 1  mgc: 8.655299e-12 
outer mgc:  0.07187945 
iter: 1  value: 2070.071 mgc: 4.279896 ustep: 1 
iter: 2  value: 2070.071 mgc: 2.078208e-05 ustep: 1 
iter: 3  mgc: 1.574296e-13 
iter: 1  mgc: 1.574296e-13 
outer mgc:  0.03569133 
iter: 1  value: 2068.187 mgc: 2.741708 ustep: 1 
iter: 2  value: 2068.187 mgc: 2.597245e-06 ustep: 1 
iter: 3  mgc: 1.425526e-13 
iter: 1  mgc: 1.425526e-13 
outer mgc:  0.07326513 
iter: 1  value: 2066.582 mgc: 2.064987 ustep: 1 
iter: 2  value: 2066.582 mgc: 1.472267e-06 ustep: 1 
mgc: 1.152411e-13 
iter: 1  mgc: 1.152411e-13 
outer mgc:  0.05895692 
iter: 1  value: 2064.364 mgc: 3.746406 ustep: 1 
iter: 2  value: 2064.364 mgc: 2.029417e-06 ustep: 1 
iter: 3  mgc: 1.39444e-13 
iter: 1  mgc: 1.39444e-13 
outer mgc:  0.01049991 
iter: 1  value: 2062.55 mgc: 3.031511 ustep: 1 
iter: 2  value: 2062.55 mgc: 6.446244e-07 ustep: 1 
iter: 3  mgc: 2.378098e-13 
iter: 1  mgc: 2.378098e-13 
outer mgc:  0.01737369 
iter: 1  value: 2060.568 mgc: 2.567494 ustep: 1 
iter: 2  value: 2060.568 mgc: 1.985249e-07 ustep: 1 
mgc: 2.127187e-13 
iter: 1  mgc: 2.127187e-13 
outer mgc:  0.02620785 
iter: 1  value: 2058.93 mgc: 4.847701 ustep: 1 
iter: 2  value: 2058.93 mgc: 3.40699e-07 ustep: 1 
mgc: 4.671818e-13 
iter: 1  mgc: 4.671818e-13 
outer mgc:  0.01928037 
iter: 1  value: 2056.812 mgc: 11.43201 ustep: 1 
iter: 2  value: 2056.812 mgc: 8.069622e-07 ustep: 1 
mgc: 1.160405e-12 
iter: 1  mgc: 1.160405e-12 
outer mgc:  0.004461113 
iter: 1  value: 2055.062 mgc: 9.400762 ustep: 1 
iter: 2  value: 2055.062 mgc: 2.703569e-07 ustep: 1 
mgc: 9.879875e-13 
iter: 1  mgc: 9.879875e-13 
outer mgc:  0.004323115 
iter: 1  value: 2053.028 mgc: 6.979517 ustep: 1 
iter: 2  value: 2053.028 mgc: 6.644404e-08 ustep: 1 
mgc: 2.810419e-12 
iter: 1  mgc: 2.810419e-12 
outer mgc:  0.007594975 
iter: 1  value: 2051.331 mgc: 2.55585 ustep: 1 
iter: 2  mgc: 5.133828e-09 
iter: 1  mgc: 5.133828e-09 
outer mgc:  0.005573351 
iter: 1  value: 2049.21 mgc: 7.420811 ustep: 1 
iter: 2  value: 2049.21 mgc: 1.334007e-08 ustep: 1 
mgc: 2.634448e-12 
iter: 1  mgc: 2.634448e-12 
outer mgc:  0.00106692 
iter: 1  value: 2047.461 mgc: 6.305582 ustep: 1 
iter: 2  mgc: 4.859439e-09 
iter: 1  mgc: 4.859439e-09 
outer mgc:  0.001593202 
iter: 1  value: 2045.388 mgc: 3.560364 ustep: 1 
iter: 2  mgc: 9.298677e-10 
iter: 1  mgc: 9.298677e-10 
outer mgc:  0.002568286 
iter: 1  value: 2043.674 mgc: 7.86086 ustep: 1 
iter: 2  mgc: 1.987306e-09 
iter: 1  mgc: 1.987306e-09 
outer mgc:  0.001876158 
iter: 1  value: 2041.57 mgc: 19.75667 ustep: 1 
iter: 2  mgc: 5.316618e-09 
iter: 1  mgc: 5.316618e-09 
outer mgc:  0.0004075798 
iter: 1  value: 2039.832 mgc: 16.5087 ustep: 1 
iter: 2  mgc: 1.830134e-09 
iter: 1  mgc: 1.830134e-09 
outer mgc:  0.0004533068 
iter: 1  value: 2037.747 mgc: 11.43494 ustep: 1 
iter: 2  mgc: 3.666447e-10 
iter: 1  mgc: 3.666447e-10 
outer mgc:  0.0007954213 
iter: 1  value: 2036.022 mgc: 4.533977 ustep: 1 
iter: 2  mgc: 1.068791e-10 
iter: 1  mgc: 1.068791e-10 
outer mgc:  0.0005787162 
iter: 1  value: 2033.92 mgc: 20.39051 ustep: 1 
iter: 2  mgc: 2.692222e-10 
iter: 1  mgc: 2.692222e-10 
outer mgc:  0.0001204482 
iter: 1  value: 2032.184 mgc: 17.04783 ustep: 1 
iter: 2  mgc: 1.315286e-10 
iter: 1  mgc: 1.315286e-10 
outer mgc:  0.0001552578 
iter: 1  mgc: 1.315286e-10 
iter: 1  mgc: 1.315286e-10 
outer mgc:  0.0001552578 
iter: 1  value: 2032.185 mgc: 0.01505364 ustep: 1 
iter: 2  mgc: 6.317049e-10 
outer mgc:  0.1367204 
iter: 1  value: 2032.184 mgc: 0.01503952 ustep: 1 
iter: 2  mgc: 6.755105e-10 
outer mgc:  0.1362819 
iter: 1  value: 2032.185 mgc: 0.007939915 ustep: 1 
iter: 2  mgc: 9.023631e-10 
outer mgc:  0.06827778 
iter: 1  value: 2032.184 mgc: 0.007934127 ustep: 1 
iter: 2  mgc: 9.050858e-10 
outer mgc:  0.06795991 
iter: 1  value: 2032.184 mgc: 0.02303989 ustep: 1 
iter: 2  value: 2032.184 mgc: 6.852545e-07 ustep: 1 
iter: 3  mgc: 1.371532e-10 
outer mgc:  0.1332358 
iter: 1  value: 2032.185 mgc: 0.02303392 ustep: 1 
iter: 2  value: 2032.185 mgc: 6.855203e-07 ustep: 1 
iter: 3  mgc: 2.540962e-10 
outer mgc:  0.1333755 
iter: 1  value: 2032.184 mgc: 0.01131589 ustep: 1 
iter: 2  value: 2032.184 mgc: 1.698021e-07 ustep: 1 
mgc: 1.607333e-10 
outer mgc:  0.08507597 
iter: 1  value: 2032.185 mgc: 0.0113127 ustep: 1 
iter: 2  value: 2032.185 mgc: 1.697009e-07 ustep: 1 
mgc: 1.292695e-10 
outer mgc:  0.08529431 
iter: 1  value: 2032.194 mgc: 646.6887 ustep: 1 
iter: 2  value: 2032.194 mgc: 1.368008e-07 ustep: 1 
mgc: 2.518157e-10 
outer mgc:  0.00164785 
iter: 1  value: 2032.174 mgc: 648.6317 ustep: 1 
iter: 2  value: 2032.174 mgc: 1.365323e-07 ustep: 1 
mgc: 8.25171e-11 
outer mgc:  0.001695823 
iter: 1  value: 2032.19 mgc: 647.3381 ustep: 1 
iter: 2  value: 2032.19 mgc: 1.676757e-07 ustep: 1 
mgc: 6.590639e-11 
outer mgc:  0.005916255 
iter: 1  value: 2032.179 mgc: 647.9858 ustep: 1 
iter: 2  value: 2032.179 mgc: 1.676031e-07 ustep: 1 
mgc: 2.642496e-10 
outer mgc:  0.005901639 
iter: 1  value: 2032.184 mgc: 4.519347e-05 ustep: 1 
mgc: 1.33186e-10 
outer mgc:  0.0001552578 
iter: 1  value: 2032.184 mgc: 4.519337e-05 ustep: 1 
mgc: 1.273734e-10 
outer mgc:  0.0001552579 
iter: 1  value: 2032.183 mgc: 0.003432382 ustep: 1 
iter: 2  value: 2032.183 mgc: 1.775983e-08 ustep: 1 
mgc: 7.628786e-11 
outer mgc:  0.005441976 
iter: 1  value: 2032.186 mgc: 0.003432099 ustep: 1 
iter: 2  value: 2032.186 mgc: 1.758328e-08 ustep: 1 
mgc: 1.321601e-10 
outer mgc:  0.005272042 
[Sun Aug 15 23:04:44 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:05:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.05_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.05_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.05_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.05_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.05_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10974.038152 
final  value 10628.760506 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1406.548 mgc: 71.2518 ustep: 1 
iter: 2  value: 1370.609 mgc: 15.95662 ustep: 1 
iter: 3  value: 1369.839 mgc: 5.594298 ustep: 1 
iter: 4  value: 1369.838 mgc: 0.2898762 ustep: 1 
iter: 5  value: 1369.838 mgc: 0.0009730823 ustep: 1 
iter: 6  value: 1369.838 mgc: 1.113575e-08 ustep: 1 
mgc: 4.449219e-14 
iter: 1  mgc: 4.449219e-14 
Matching hessian patterns... Done
outer mgc:  361.2293 
iter: 1  value: 1367.463 mgc: 30.63793 ustep: 1 
iter: 2  value: 1361.862 mgc: 5.909727 ustep: 1 
iter: 3  value: 1361.859 mgc: 0.17914 ustep: 1 
iter: 4  value: 1361.859 mgc: 0.0003362546 ustep: 1 
iter: 5  mgc: 2.796263e-09 
iter: 1  mgc: 2.796263e-09 
outer mgc:  368.9905 
iter: 1  value: 1239.523 mgc: 17.70417 ustep: 1 
iter: 2  value: 1239.169 mgc: 1.362148 ustep: 1 
iter: 3  value: 1239.169 mgc: 0.01162931 ustep: 1 
iter: 4  value: 1239.169 mgc: 1.599017e-06 ustep: 1 
iter: 5  mgc: 3.308465e-14 
iter: 1  mgc: 3.308465e-14 
outer mgc:  44.56503 
iter: 1  value: 1216.294 mgc: 7.94431 ustep: 1 
iter: 2  value: 1216.281 mgc: 0.2944461 ustep: 1 
iter: 3  value: 1216.281 mgc: 0.0009705996 ustep: 1 
iter: 4  value: 1216.281 mgc: 1.066534e-08 ustep: 1 
mgc: 2.553513e-14 
iter: 1  mgc: 2.553513e-14 
outer mgc:  60.43355 
iter: 1  value: 1237.227 mgc: 10.83401 ustep: 1 
iter: 2  value: 1237.196 mgc: 0.4790047 ustep: 1 
iter: 3  value: 1237.196 mgc: 0.00163415 ustep: 1 
iter: 4  value: 1237.196 mgc: 8.940876e-08 ustep: 1 
iter: 5  mgc: 3.68594e-14 
iter: 1  value: 1210.713 mgc: 4.167651 ustep: 1 
iter: 2  value: 1210.712 mgc: 0.06512607 ustep: 1 
iter: 3  value: 1210.712 mgc: 2.042845e-05 ustep: 1 
iter: 4  mgc: 3.253398e-12 
iter: 1  mgc: 3.253398e-12 
outer mgc:  44.72009 
iter: 1  value: 1204.702 mgc: 5.797095 ustep: 1 
iter: 2  value: 1204.7 mgc: 0.1079365 ustep: 1 
iter: 3  value: 1204.7 mgc: 7.532088e-05 ustep: 1 
iter: 4  mgc: 5.407524e-11 
iter: 1  mgc: 5.407524e-11 
outer mgc:  37.59738 
iter: 1  value: 1193.628 mgc: 5.500408 ustep: 1 
iter: 2  value: 1193.612 mgc: 0.1096997 ustep: 1 
iter: 3  value: 1193.612 mgc: 0.0005035311 ustep: 1 
iter: 4  value: 1193.612 mgc: 1.124376e-08 ustep: 1 
mgc: 2.642331e-14 
iter: 1  mgc: 2.642331e-14 
outer mgc:  43.75937 
iter: 1  value: 1176.344 mgc: 26.72382 ustep: 1 
iter: 2  value: 1175.2 mgc: 1.411222 ustep: 1 
iter: 3  value: 1175.199 mgc: 0.01861997 ustep: 1 
iter: 4  value: 1175.199 mgc: 1.051545e-05 ustep: 1 
iter: 5  mgc: 5.802914e-12 
iter: 1  mgc: 5.802914e-12 
outer mgc:  52.35795 
iter: 1  value: 1169.776 mgc: 24.71526 ustep: 1 
iter: 2  value: 1167.888 mgc: 1.799378 ustep: 1 
iter: 3  value: 1167.887 mgc: 0.02697549 ustep: 1 
iter: 4  value: 1167.887 mgc: 1.055838e-05 ustep: 1 
iter: 5  mgc: 6.026957e-12 
iter: 1  mgc: 6.026957e-12 
outer mgc:  45.3915 
iter: 1  value: 1173.299 mgc: 31.23868 ustep: 1 
iter: 2  value: 1171.917 mgc: 3.603502 ustep: 1 
iter: 3  value: 1171.917 mgc: 0.04997309 ustep: 1 
iter: 4  value: 1171.917 mgc: 2.195559e-05 ustep: 1 
iter: 5  mgc: 4.316547e-12 
iter: 1  value: 1162.022 mgc: 16.0045 ustep: 1 
iter: 2  value: 1161.839 mgc: 0.9098689 ustep: 1 
iter: 3  value: 1161.839 mgc: 0.004659834 ustep: 1 
iter: 4  value: 1161.839 mgc: 2.931483e-07 ustep: 1 
iter: 5  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  26.33018 
iter: 1  value: 1159.658 mgc: 11.87026 ustep: 1 
iter: 2  value: 1159.626 mgc: 0.3366663 ustep: 1 
iter: 3  value: 1159.626 mgc: 0.001007368 ustep: 1 
iter: 4  mgc: 9.314765e-09 
iter: 1  mgc: 9.314765e-09 
outer mgc:  49.38958 
iter: 1  value: 1157.253 mgc: 9.16013 ustep: 1 
iter: 2  value: 1157.199 mgc: 0.280103 ustep: 1 
iter: 3  value: 1157.199 mgc: 0.0009604471 ustep: 1 
iter: 4  value: 1157.199 mgc: 3.701861e-08 ustep: 1 
mgc: 3.424691e-14 
iter: 1  mgc: 3.424691e-14 
outer mgc:  41.53603 
iter: 1  value: 1156.987 mgc: 9.183855 ustep: 1 
iter: 2  value: 1156.982 mgc: 0.2351876 ustep: 1 
iter: 3  value: 1156.982 mgc: 0.0002836188 ustep: 1 
iter: 4  mgc: 4.170775e-10 
iter: 1  value: 1155.162 mgc: 5.21422 ustep: 1 
iter: 2  value: 1155.161 mgc: 0.08096356 ustep: 1 
iter: 3  value: 1155.161 mgc: 3.447077e-05 ustep: 1 
iter: 4  mgc: 6.254108e-12 
iter: 1  mgc: 6.254108e-12 
outer mgc:  15.65963 
iter: 1  value: 1154.189 mgc: 6.069264 ustep: 1 
iter: 2  value: 1154.186 mgc: 0.1182943 ustep: 1 
iter: 3  value: 1154.186 mgc: 7.455899e-05 ustep: 1 
iter: 4  mgc: 2.974598e-11 
iter: 1  mgc: 2.974598e-11 
outer mgc:  7.635522 
iter: 1  value: 1153.409 mgc: 3.397503 ustep: 1 
iter: 2  value: 1153.409 mgc: 0.02894696 ustep: 1 
iter: 3  value: 1153.409 mgc: 7.033018e-06 ustep: 1 
iter: 4  mgc: 3.610445e-13 
iter: 1  mgc: 3.610445e-13 
outer mgc:  2.995757 
iter: 1  value: 1153.302 mgc: 2.482363 ustep: 1 
iter: 2  value: 1153.301 mgc: 0.02451296 ustep: 1 
iter: 3  value: 1153.301 mgc: 1.639349e-05 ustep: 1 
iter: 4  mgc: 1.007727e-11 
iter: 1  mgc: 1.007727e-11 
outer mgc:  16.06378 
iter: 1  value: 1153.273 mgc: 1.916596 ustep: 1 
iter: 2  value: 1153.273 mgc: 0.01204302 ustep: 1 
iter: 3  value: 1153.273 mgc: 1.399492e-06 ustep: 1 
iter: 4  mgc: 3.352874e-14 
iter: 1  mgc: 3.352874e-14 
outer mgc:  14.15303 
iter: 1  value: 1153.047 mgc: 1.529416 ustep: 1 
iter: 2  value: 1153.047 mgc: 0.005966804 ustep: 1 
iter: 3  value: 1153.047 mgc: 2.483923e-07 ustep: 1 
iter: 4  mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  1.474589 
iter: 1  value: 1153.07 mgc: 0.8381623 ustep: 1 
iter: 2  value: 1153.07 mgc: 0.003056799 ustep: 1 
iter: 3  value: 1153.07 mgc: 1.673187e-07 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  3.620753 
iter: 1  value: 1153.059 mgc: 0.2298403 ustep: 1 
iter: 2  value: 1153.059 mgc: 0.0003359828 ustep: 1 
iter: 3  mgc: 9.346062e-10 
iter: 1  mgc: 9.346062e-10 
outer mgc:  5.86922 
iter: 1  value: 1153.018 mgc: 0.5125642 ustep: 1 
iter: 2  value: 1153.018 mgc: 0.0007071735 ustep: 1 
iter: 3  mgc: 2.490119e-09 
iter: 1  mgc: 2.490119e-09 
outer mgc:  1.124776 
iter: 1  value: 1153.006 mgc: 0.1790821 ustep: 1 
iter: 2  value: 1153.006 mgc: 0.0001091454 ustep: 1 
iter: 3  mgc: 1.097198e-10 
iter: 1  mgc: 1.097198e-10 
outer mgc:  0.3904182 
iter: 1  value: 1153.012 mgc: 0.1544895 ustep: 1 
iter: 2  value: 1153.012 mgc: 4.832215e-05 ustep: 1 
iter: 3  mgc: 1.970712e-11 
iter: 1  mgc: 1.970712e-11 
outer mgc:  0.5607765 
iter: 1  value: 1152.954 mgc: 0.2912094 ustep: 1 
iter: 2  value: 1152.954 mgc: 0.0005893965 ustep: 1 
iter: 3  mgc: 1.965176e-09 
iter: 1  value: 1152.998 mgc: 0.08194904 ustep: 1 
iter: 2  value: 1152.998 mgc: 3.014205e-05 ustep: 1 
iter: 3  mgc: 7.27951e-12 
iter: 1  mgc: 7.27951e-12 
outer mgc:  0.1342476 
iter: 1  value: 1152.998 mgc: 0.1345097 ustep: 1 
iter: 2  value: 1152.998 mgc: 5.48727e-05 ustep: 1 
iter: 3  mgc: 2.557754e-11 
iter: 1  value: 1152.998 mgc: 0.06361089 ustep: 1 
iter: 2  value: 1152.998 mgc: 1.246894e-05 ustep: 1 
iter: 3  mgc: 8.444356e-13 
iter: 1  value: 1152.998 mgc: 0.02916219 ustep: 1 
iter: 2  value: 1152.998 mgc: 2.621771e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.1121295 
iter: 1  value: 1152.999 mgc: 0.007759938 ustep: 1 
iter: 2  value: 1152.999 mgc: 1.806182e-07 ustep: 1 
iter: 3  mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  0.152924 
iter: 1  value: 1152.998 mgc: 0.01034495 ustep: 1 
iter: 2  value: 1152.998 mgc: 3.426889e-07 ustep: 1 
iter: 3  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.03740344 
iter: 1  value: 1152.999 mgc: 0.00374733 ustep: 1 
iter: 2  value: 1152.999 mgc: 4.710317e-08 ustep: 1 
mgc: 3.075318e-14 
iter: 1  value: 1152.999 mgc: 0.01124183 ustep: 1 
iter: 2  value: 1152.999 mgc: 4.238796e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.07146259 
iter: 1  value: 1153 mgc: 0.03181521 ustep: 1 
iter: 2  value: 1153 mgc: 4.456999e-06 ustep: 1 
iter: 3  mgc: 3.073097e-13 
iter: 1  value: 1152.999 mgc: 0.01670676 ustep: 1 
iter: 2  value: 1152.999 mgc: 9.708546e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  0.02541676 
iter: 1  value: 1152.998 mgc: 0.02319131 ustep: 1 
iter: 2  value: 1152.998 mgc: 2.28432e-06 ustep: 1 
iter: 3  mgc: 4.751755e-14 
iter: 1  value: 1152.999 mgc: 0.006527136 ustep: 1 
iter: 2  value: 1152.999 mgc: 1.8096e-07 ustep: 1 
iter: 3  mgc: 3.4861e-14 
iter: 1  mgc: 3.4861e-14 
outer mgc:  0.03903713 
iter: 1  value: 1152.999 mgc: 0.005228427 ustep: 1 
iter: 2  value: 1152.999 mgc: 5.275666e-08 ustep: 1 
mgc: 2.720046e-14 
iter: 1  mgc: 2.720046e-14 
outer mgc:  0.01643554 
iter: 1  value: 1152.999 mgc: 0.004436192 ustep: 1 
iter: 2  value: 1152.999 mgc: 5.126412e-08 ustep: 1 
iter: 3  mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  0.02445641 
iter: 1  value: 1152.999 mgc: 0.002038001 ustep: 1 
iter: 2  value: 1152.999 mgc: 3.720092e-08 ustep: 1 
mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.02366407 
iter: 1  value: 1152.999 mgc: 0.004306287 ustep: 1 
iter: 2  value: 1152.999 mgc: 4.302353e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.004886908 
iter: 1  value: 1152.999 mgc: 0.002783079 ustep: 1 
iter: 2  value: 1152.999 mgc: 1.982584e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.001955508 
iter: 1  value: 1152.999 mgc: 0.0007702461 ustep: 1 
iter: 2  mgc: 2.793378e-09 
iter: 1  mgc: 2.793378e-09 
outer mgc:  0.0009356918 
iter: 1  mgc: 2.793378e-09 
iter: 1  mgc: 2.793378e-09 
outer mgc:  0.0009356918 
iter: 1  value: 1152.999 mgc: 0.05394241 ustep: 1 
iter: 2  value: 1152.999 mgc: 8.05629e-06 ustep: 1 
iter: 3  mgc: 5.391243e-13 
outer mgc:  0.1818209 
iter: 1  value: 1152.998 mgc: 0.05393858 ustep: 1 
iter: 2  value: 1152.998 mgc: 8.061974e-06 ustep: 1 
iter: 3  mgc: 5.462297e-13 
outer mgc:  0.18091 
iter: 1  value: 1152.999 mgc: 0.02729237 ustep: 1 
iter: 2  value: 1152.999 mgc: 2.050208e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.6121203 
iter: 1  value: 1152.999 mgc: 0.02729983 ustep: 1 
iter: 2  value: 1152.999 mgc: 2.051042e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
outer mgc:  0.6108818 
iter: 1  value: 1152.999 mgc: 0.05410705 ustep: 1 
iter: 2  value: 1152.999 mgc: 8.018e-06 ustep: 1 
iter: 3  mgc: 4.320988e-13 
outer mgc:  0.1900978 
iter: 1  value: 1152.999 mgc: 0.05410178 ustep: 1 
iter: 2  value: 1152.999 mgc: 8.026813e-06 ustep: 1 
iter: 3  mgc: 4.343192e-13 
outer mgc:  0.1916875 
iter: 1  value: 1152.998 mgc: 0.02736666 ustep: 1 
iter: 2  value: 1152.998 mgc: 2.188827e-06 ustep: 1 
iter: 3  mgc: 4.751755e-14 
outer mgc:  0.5741146 
iter: 1  value: 1153 mgc: 0.02736475 ustep: 1 
iter: 2  value: 1153 mgc: 2.189053e-06 ustep: 1 
iter: 3  mgc: 3.574918e-14 
outer mgc:  0.572565 
iter: 1  value: 1152.996 mgc: 0.005775877 ustep: 1 
iter: 2  value: 1152.996 mgc: 4.162373e-07 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.02656288 
iter: 1  value: 1153.001 mgc: 0.005771593 ustep: 1 
iter: 2  value: 1153.001 mgc: 4.158092e-07 ustep: 1 
iter: 3  mgc: 3.019807e-14 
outer mgc:  0.02533702 
iter: 1  value: 1153.003 mgc: 0.0111651 ustep: 1 
iter: 2  value: 1153.003 mgc: 1.033358e-06 ustep: 1 
iter: 3  mgc: 4.196643e-14 
outer mgc:  0.1430974 
iter: 1  value: 1152.994 mgc: 0.01118925 ustep: 1 
iter: 2  value: 1152.994 mgc: 1.03695e-06 ustep: 1 
iter: 3  mgc: 2.88658e-14 
outer mgc:  0.1452096 
iter: 1  value: 1153.004 mgc: 0.01197382 ustep: 1 
iter: 2  value: 1153.004 mgc: 1.842511e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
outer mgc:  0.138494 
iter: 1  value: 1152.993 mgc: 0.01199798 ustep: 1 
iter: 2  value: 1152.993 mgc: 1.847499e-06 ustep: 1 
iter: 3  mgc: 4.263256e-14 
outer mgc:  0.1396318 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:05:59 2021]
Finished job 0.
1 of 1 steps (100%) done

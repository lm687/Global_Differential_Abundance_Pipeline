Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:57:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.05_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.05_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.05_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4368.082460 
iter  10 value 3745.810206
iter  10 value 3745.810193
final  value 3745.810193 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2016.782 mgc: 114.5474 ustep: 0.2494656 
iter: 2  value: 1602.513 mgc: 88.47226 ustep: 0.1588666 
iter: 3  value: 1084.559 mgc: 114.2002 ustep: 0.1193656 
iter: 4  value: 865.232 mgc: 94.3765 ustep: 0.1005487 
iter: 5  value: 665.5073 mgc: 109.2479 ustep: 0.09094898 
iter: 6  value: 557.3747 mgc: 89.78097 ustep: 0.08582982 
iter: 7  value: 489.2266 mgc: 82.13496 ustep: 0.293038 
iter: 8  value: 470.8443 mgc: 41.05051 ustep: 0.5413757 
iter: 9  value: 470.4477 mgc: 6.347511 ustep: 0.7358088 
iter: 10  value: 470.4477 mgc: 0.0600031 ustep: 0.8578072 
iter: 11  value: 470.4477 mgc: 0.0002047764 ustep: 0.9261862 
iter: 12  value: 470.4477 mgc: 1.185738e-06 ustep: 0.9623894 
iter: 13  mgc: 5.687342e-09 
iter: 1  mgc: 5.687342e-09 
Matching hessian patterns... Done
outer mgc:  140.7633 
iter: 1  value: 402.4338 mgc: 28.45463 ustep: 1 
iter: 2  value: 393.6282 mgc: 8.629125 ustep: 1 
iter: 3  value: 393.5818 mgc: 0.55734 ustep: 1 
iter: 4  value: 393.5818 mgc: 0.00570485 ustep: 1 
iter: 5  value: 393.5818 mgc: 6.172725e-07 ustep: 1 
iter: 6  mgc: 3.200218e-14 
iter: 1  mgc: 3.200218e-14 
outer mgc:  77.87888 
iter: 1  value: 385.4332 mgc: 21.38853 ustep: 1 
iter: 2  value: 385.1734 mgc: 1.578036 ustep: 1 
iter: 3  value: 385.1734 mgc: 0.01529693 ustep: 1 
iter: 4  value: 385.1734 mgc: 5.480548e-06 ustep: 1 
iter: 5  mgc: 6.641354e-13 
iter: 1  mgc: 6.641354e-13 
outer mgc:  101.8165 
iter: 1  value: 360.8743 mgc: 26.25272 ustep: 1 
iter: 2  value: 356.0728 mgc: 6.779375 ustep: 1 
iter: 3  value: 356.0586 mgc: 0.4049246 ustep: 1 
iter: 4  value: 356.0586 mgc: 0.002821449 ustep: 1 
iter: 5  value: 356.0586 mgc: 1.840995e-07 ustep: 1 
iter: 6  mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  39.04817 
iter: 1  value: 344.9064 mgc: 12.19278 ustep: 1 
iter: 2  value: 343.9269 mgc: 2.303545 ustep: 1 
iter: 3  value: 343.9252 mgc: 0.1352795 ustep: 1 
iter: 4  value: 343.9252 mgc: 0.0005461011 ustep: 1 
iter: 5  mgc: 8.988356e-09 
iter: 1  mgc: 8.988356e-09 
outer mgc:  18.0206 
iter: 1  value: 354.8995 mgc: 29.66061 ustep: 1 
iter: 2  value: 350.4794 mgc: 5.884097 ustep: 1 
iter: 3  value: 350.4689 mgc: 0.2800779 ustep: 1 
iter: 4  value: 350.4689 mgc: 0.001131905 ustep: 1 
iter: 5  value: 350.4689 mgc: 1.872591e-08 ustep: 1 
mgc: 2.234324e-14 
iter: 1  value: 339.9354 mgc: 13.79128 ustep: 1 
iter: 2  value: 339.8461 mgc: 0.7941161 ustep: 1 
iter: 3  value: 339.8461 mgc: 0.006506566 ustep: 1 
iter: 4  value: 339.8461 mgc: 5.872734e-07 ustep: 1 
iter: 5  mgc: 2.692291e-14 
iter: 1  mgc: 2.692291e-14 
outer mgc:  20.78567 
iter: 1  value: 337.1173 mgc: 12.46142 ustep: 1 
iter: 2  value: 336.9931 mgc: 0.6515396 ustep: 1 
iter: 3  value: 336.9931 mgc: 0.007421496 ustep: 1 
iter: 4  value: 336.9931 mgc: 1.648114e-06 ustep: 1 
iter: 5  mgc: 7.949197e-14 
iter: 1  mgc: 7.949197e-14 
outer mgc:  21.83829 
iter: 1  value: 333.388 mgc: 13.50557 ustep: 1 
iter: 2  value: 333.3353 mgc: 0.567146 ustep: 1 
iter: 3  value: 333.3353 mgc: 0.004023296 ustep: 1 
iter: 4  value: 333.3353 mgc: 3.128641e-07 ustep: 1 
iter: 5  mgc: 2.731149e-14 
iter: 1  mgc: 2.731149e-14 
outer mgc:  5.64248 
iter: 1  value: 333.1003 mgc: 12.03585 ustep: 1 
iter: 2  value: 333.0817 mgc: 0.3220668 ustep: 1 
iter: 3  value: 333.0817 mgc: 0.001146287 ustep: 1 
iter: 4  value: 333.0817 mgc: 1.561412e-08 ustep: 1 
mgc: 3.140543e-14 
iter: 1  mgc: 3.140543e-14 
outer mgc:  7.172584 
iter: 1  value: 331.8332 mgc: 6.174068 ustep: 1 
iter: 2  value: 331.8283 mgc: 0.1688804 ustep: 1 
iter: 3  value: 331.8283 mgc: 0.0003238372 ustep: 1 
iter: 4  mgc: 2.565169e-09 
iter: 1  mgc: 2.565169e-09 
outer mgc:  3.34991 
iter: 1  value: 334.8687 mgc: 15.3299 ustep: 1 
iter: 2  value: 334.7577 mgc: 1.167935 ustep: 1 
iter: 3  value: 334.7577 mgc: 0.009085195 ustep: 1 
iter: 4  value: 334.7577 mgc: 6.109235e-07 ustep: 1 
iter: 5  mgc: 1.931788e-14 
iter: 1  value: 331.7074 mgc: 3.106424 ustep: 1 
iter: 2  value: 331.7072 mgc: 0.02984751 ustep: 1 
iter: 3  value: 331.7072 mgc: 9.187386e-06 ustep: 1 
iter: 4  mgc: 1.175504e-12 
iter: 1  mgc: 1.175504e-12 
outer mgc:  4.704091 
iter: 1  value: 331.7686 mgc: 0.8269514 ustep: 1 
iter: 2  value: 331.7686 mgc: 0.001925207 ustep: 1 
iter: 3  value: 331.7686 mgc: 3.178264e-08 ustep: 1 
mgc: 4.13003e-14 
iter: 1  value: 331.6345 mgc: 0.6917354 ustep: 1 
iter: 2  value: 331.6345 mgc: 0.002061442 ustep: 1 
iter: 3  value: 331.6345 mgc: 2.449873e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  2.24414 
iter: 1  value: 331.6205 mgc: 1.311561 ustep: 1 
iter: 2  value: 331.6205 mgc: 0.005717813 ustep: 1 
iter: 3  value: 331.6205 mgc: 2.992295e-07 ustep: 1 
iter: 4  mgc: 2.16771e-14 
iter: 1  mgc: 2.16771e-14 
outer mgc:  0.7732816 
iter: 1  value: 331.6147 mgc: 1.285389 ustep: 1 
iter: 2  value: 331.6147 mgc: 0.005025001 ustep: 1 
iter: 3  value: 331.6147 mgc: 2.82656e-07 ustep: 1 
iter: 4  mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  1.458056 
iter: 1  value: 331.7763 mgc: 1.234534 ustep: 1 
iter: 2  value: 331.7763 mgc: 0.007722137 ustep: 1 
iter: 3  value: 331.7763 mgc: 3.993266e-07 ustep: 1 
iter: 4  mgc: 2.575717e-14 
iter: 1  value: 331.6149 mgc: 0.5472294 ustep: 1 
iter: 2  value: 331.6149 mgc: 0.001147477 ustep: 1 
iter: 3  mgc: 7.702747e-09 
iter: 1  mgc: 7.702747e-09 
outer mgc:  1.010696 
iter: 1  value: 331.591 mgc: 0.2048954 ustep: 1 
iter: 2  value: 331.591 mgc: 0.0002066793 ustep: 1 
iter: 3  mgc: 9.108621e-10 
iter: 1  mgc: 9.108621e-10 
outer mgc:  0.4109063 
iter: 1  value: 331.6011 mgc: 0.340089 ustep: 1 
iter: 2  value: 331.6011 mgc: 0.0003826146 ustep: 1 
iter: 3  mgc: 2.07885e-09 
iter: 1  mgc: 2.07885e-09 
outer mgc:  0.4631517 
iter: 1  value: 331.6013 mgc: 0.5483041 ustep: 1 
iter: 2  value: 331.6013 mgc: 0.0008502428 ustep: 1 
iter: 3  mgc: 8.126247e-09 
iter: 1  value: 331.6008 mgc: 0.2116434 ustep: 1 
iter: 2  value: 331.6008 mgc: 0.0001537107 ustep: 1 
iter: 3  mgc: 1.269895e-10 
iter: 1  mgc: 1.269895e-10 
outer mgc:  0.5814984 
iter: 1  value: 331.5963 mgc: 0.07090608 ustep: 1 
iter: 2  value: 331.5963 mgc: 1.935581e-05 ustep: 1 
iter: 3  mgc: 3.147926e-12 
iter: 1  mgc: 3.147926e-12 
outer mgc:  0.08636434 
iter: 1  value: 331.5855 mgc: 0.1140573 ustep: 1 
iter: 2  value: 331.5855 mgc: 6.101372e-05 ustep: 1 
iter: 3  mgc: 3.159473e-11 
iter: 1  mgc: 3.159473e-11 
outer mgc:  0.1840133 
iter: 1  value: 331.589 mgc: 0.1749257 ustep: 1 
iter: 2  value: 331.589 mgc: 0.0001376852 ustep: 1 
iter: 3  mgc: 2.860241e-10 
iter: 1  value: 331.5867 mgc: 0.06741559 ustep: 1 
iter: 2  value: 331.5867 mgc: 1.935933e-05 ustep: 1 
iter: 3  mgc: 5.521361e-12 
iter: 1  mgc: 5.521361e-12 
outer mgc:  0.08877951 
iter: 1  value: 331.5894 mgc: 0.08327488 ustep: 1 
iter: 2  value: 331.5894 mgc: 2.112411e-05 ustep: 1 
iter: 3  mgc: 4.113376e-12 
iter: 1  mgc: 4.113376e-12 
outer mgc:  0.08712641 
iter: 1  value: 331.5882 mgc: 0.03701848 ustep: 1 
iter: 2  value: 331.5882 mgc: 3.38534e-06 ustep: 1 
iter: 3  mgc: 9.237056e-14 
iter: 1  mgc: 9.237056e-14 
outer mgc:  0.04373969 
iter: 1  value: 331.583 mgc: 0.05934832 ustep: 1 
iter: 2  value: 331.583 mgc: 1.847471e-05 ustep: 1 
iter: 3  mgc: 1.772804e-12 
iter: 1  value: 331.5869 mgc: 0.01837412 ustep: 1 
iter: 2  value: 331.5869 mgc: 1.771485e-06 ustep: 1 
iter: 3  mgc: 3.708145e-14 
iter: 1  mgc: 3.708145e-14 
outer mgc:  0.03286858 
iter: 1  value: 331.5872 mgc: 0.0131194 ustep: 1 
iter: 2  value: 331.5872 mgc: 4.991357e-07 ustep: 1 
iter: 3  mgc: 2.653433e-14 
iter: 1  mgc: 2.653433e-14 
outer mgc:  0.009320514 
iter: 1  value: 331.5866 mgc: 0.004715002 ustep: 1 
iter: 2  value: 331.5866 mgc: 1.082615e-07 ustep: 1 
mgc: 4.662937e-14 
iter: 1  value: 331.5872 mgc: 0.002407849 ustep: 1 
iter: 2  value: 331.5872 mgc: 2.574559e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  0.01471846 
iter: 1  value: 331.5872 mgc: 0.002263391 ustep: 1 
iter: 2  value: 331.5872 mgc: 2.11547e-08 ustep: 1 
mgc: 2.83662e-14 
iter: 1  mgc: 2.83662e-14 
outer mgc:  0.001046867 
iter: 1  value: 331.587 mgc: 0.001364347 ustep: 1 
iter: 2  mgc: 7.127475e-09 
iter: 1  mgc: 7.127475e-09 
outer mgc:  0.0005309964 
iter: 1  value: 331.5871 mgc: 0.0006394006 ustep: 1 
iter: 2  mgc: 1.695933e-09 
iter: 1  mgc: 1.695933e-09 
outer mgc:  7.545169e-05 
iter: 1  mgc: 1.695933e-09 
iter: 1  mgc: 1.695933e-09 
outer mgc:  7.545169e-05 
iter: 1  value: 331.5864 mgc: 0.0477897 ustep: 1 
iter: 2  value: 331.5864 mgc: 8.239291e-06 ustep: 1 
iter: 3  mgc: 6.084022e-13 
outer mgc:  0.0389108 
iter: 1  value: 331.5878 mgc: 0.04777517 ustep: 1 
iter: 2  value: 331.5878 mgc: 8.246221e-06 ustep: 1 
iter: 3  mgc: 6.004086e-13 
outer mgc:  0.03903547 
iter: 1  value: 331.5866 mgc: 0.02054623 ustep: 1 
iter: 2  value: 331.5866 mgc: 1.406456e-06 ustep: 1 
iter: 3  mgc: 1.820766e-14 
outer mgc:  0.09390388 
iter: 1  value: 331.5877 mgc: 0.02053618 ustep: 1 
iter: 2  value: 331.5877 mgc: 1.405289e-06 ustep: 1 
iter: 3  mgc: 3.175238e-14 
outer mgc:  0.09397738 
iter: 1  value: 331.5877 mgc: 0.05135684 ustep: 1 
iter: 2  value: 331.5877 mgc: 8.630256e-06 ustep: 1 
iter: 3  mgc: 4.942713e-13 
outer mgc:  0.0471281 
iter: 1  value: 331.5865 mgc: 0.05135264 ustep: 1 
iter: 2  value: 331.5865 mgc: 8.640864e-06 ustep: 1 
iter: 3  mgc: 4.873879e-13 
outer mgc:  0.04702021 
iter: 1  value: 331.5879 mgc: 0.02674409 ustep: 1 
iter: 2  value: 331.5879 mgc: 2.784328e-06 ustep: 1 
iter: 3  mgc: 4.796163e-14 
outer mgc:  0.2266415 
iter: 1  value: 331.5864 mgc: 0.02674448 ustep: 1 
iter: 2  value: 331.5864 mgc: 2.786097e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.2267146 
iter: 1  value: 331.5857 mgc: 0.00503333 ustep: 1 
iter: 2  value: 331.5857 mgc: 3.437503e-07 ustep: 1 
iter: 3  mgc: 4.074519e-14 
outer mgc:  0.0132506 
iter: 1  value: 331.5885 mgc: 0.005027793 ustep: 1 
iter: 2  value: 331.5885 mgc: 3.433211e-07 ustep: 1 
iter: 3  mgc: 1.704192e-14 
outer mgc:  0.01332349 
iter: 1  value: 331.59 mgc: 0.005684411 ustep: 1 
iter: 2  value: 331.59 mgc: 6.730612e-07 ustep: 1 
iter: 3  mgc: 3.028133e-14 
outer mgc:  0.04013897 
iter: 1  value: 331.5841 mgc: 0.005694218 ustep: 1 
iter: 2  value: 331.5841 mgc: 6.751304e-07 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.04024571 
iter: 1  value: 331.5882 mgc: 0.006781337 ustep: 1 
iter: 2  value: 331.5882 mgc: 2.349905e-07 ustep: 1 
iter: 3  mgc: 1.532108e-14 
outer mgc:  0.04660325 
iter: 1  value: 331.586 mgc: 0.006793543 ustep: 1 
iter: 2  value: 331.586 mgc: 2.357017e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.04653505 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:57:59 2021]
Finished job 0.
1 of 1 steps (100%) done

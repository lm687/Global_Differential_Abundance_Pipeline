Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:49:20 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4474.647852 
final  value 4292.303833 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3922.938 mgc: 4.900253 ustep: 0.6827823 
iter: 2  value: 3912.024 mgc: 2.265668 ustep: 0.8263238 
iter: 3  value: 3910.627 mgc: 2.796646 ustep: 0.6983222 
iter: 4  value: 3908.61 mgc: 1.864868 ustep: 0.8356732 
iter: 5  value: 3907.457 mgc: 2.276069 ustep: 0.9141602 
iter: 6  value: 3907.442 mgc: 0.1902742 ustep: 0.9561216 
iter: 7  value: 3907.442 mgc: 0.005791897 ustep: 0.9778169 
iter: 8  value: 3907.442 mgc: 6.02494e-05 ustep: 0.9888474 
iter: 9  value: 3907.442 mgc: 3.809796e-07 ustep: 0.9944086 
iter: 10  mgc: 1.374281e-09 
iter: 1  mgc: 1.374281e-09 
Matching hessian patterns... Done
outer mgc:  27.19981 
iter: 1  value: 3868.063 mgc: 0.7929553 ustep: 1 
iter: 2  value: 3868.06 mgc: 0.07513094 ustep: 1 
iter: 3  value: 3868.06 mgc: 0.0005347296 ustep: 1 
iter: 4  value: 3868.06 mgc: 4.332251e-08 ustep: 1 
iter: 5  mgc: 3.497203e-15 
iter: 1  value: 3837.098 mgc: 3.063489 ustep: 1 
iter: 2  value: 3837.09 mgc: 0.2293185 ustep: 1 
iter: 3  value: 3837.09 mgc: 0.0008935439 ustep: 1 
iter: 4  value: 3837.09 mgc: 1.094848e-08 ustep: 1 
mgc: 1.421085e-14 
iter: 1  mgc: 1.421085e-14 
outer mgc:  25.38096 
iter: 1  value: 4115.52 mgc: 13.82903 ustep: 0.6827823 
iter: 2  value: 4071.49 mgc: 20.213 ustep: 0.3543617 
iter: 3  value: 4041.596 mgc: 22.88418 ustep: 0.5953233 
iter: 4  value: 4040.289 mgc: 4.02883 ustep: 0.7715948 
iter: 5  value: 4040.21 mgc: 0.5281343 ustep: 0.8784169 
iter: 6  value: 4040.207 mgc: 0.03997642 ustep: 0.9372452 
iter: 7  value: 4040.207 mgc: 0.002173148 ustep: 0.9681175 
iter: 8  value: 4040.207 mgc: 0.0001625714 ustep: 0.9839312 
iter: 9  value: 4040.207 mgc: 6.087788e-06 ustep: 0.9919339 
iter: 10  value: 4040.207 mgc: 1.14029e-07 ustep: 0.9959592 
iter: 11  mgc: 1.072697e-09 
iter: 1  value: 3832.745 mgc: 4.052827 ustep: 1 
iter: 2  value: 3832.581 mgc: 0.5711009 ustep: 1 
iter: 3  value: 3832.581 mgc: 0.008069775 ustep: 1 
iter: 4  value: 3832.581 mgc: 1.858326e-06 ustep: 1 
iter: 5  mgc: 1.516565e-13 
iter: 1  mgc: 1.516565e-13 
outer mgc:  16.196 
iter: 1  value: 3830.393 mgc: 2.99688 ustep: 1 
iter: 2  value: 3830.378 mgc: 0.3583021 ustep: 1 
iter: 3  value: 3830.378 mgc: 0.005417027 ustep: 1 
iter: 4  value: 3830.378 mgc: 1.239514e-06 ustep: 1 
iter: 5  mgc: 6.57252e-14 
iter: 1  mgc: 6.57252e-14 
outer mgc:  15.41266 
iter: 1  value: 3829.378 mgc: 3.252268 ustep: 1 
iter: 2  value: 3829.282 mgc: 0.3811107 ustep: 1 
iter: 3  value: 3829.282 mgc: 0.004285101 ustep: 1 
iter: 4  value: 3829.282 mgc: 6.130532e-07 ustep: 1 
iter: 5  mgc: 1.457168e-14 
iter: 1  mgc: 1.457168e-14 
outer mgc:  12.46433 
iter: 1  value: 3824.865 mgc: 4.345616 ustep: 1 
iter: 2  value: 3824.851 mgc: 0.3131356 ustep: 1 
iter: 3  value: 3824.851 mgc: 0.001323623 ustep: 1 
iter: 4  value: 3824.851 mgc: 2.266964e-08 ustep: 1 
mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  5.306388 
iter: 1  value: 3821.749 mgc: 6.7705 ustep: 1 
iter: 2  value: 3821.736 mgc: 0.4281719 ustep: 1 
iter: 3  value: 3821.736 mgc: 0.002073612 ustep: 1 
iter: 4  value: 3821.736 mgc: 4.234933e-08 ustep: 1 
mgc: 8.243406e-15 
iter: 1  mgc: 8.243406e-15 
outer mgc:  5.43086 
iter: 1  value: 3821.448 mgc: 2.345333 ustep: 1 
iter: 2  value: 3821.448 mgc: 0.03993996 ustep: 1 
iter: 3  value: 3821.448 mgc: 3.021068e-05 ustep: 1 
iter: 4  mgc: 1.346523e-11 
iter: 1  mgc: 1.346523e-11 
outer mgc:  4.364187 
iter: 1  value: 3820.702 mgc: 2.0167 ustep: 1 
iter: 2  value: 3820.702 mgc: 0.06597229 ustep: 1 
iter: 3  value: 3820.702 mgc: 6.633121e-05 ustep: 1 
iter: 4  mgc: 4.718759e-11 
iter: 1  mgc: 4.718759e-11 
outer mgc:  3.787337 
iter: 1  value: 3821.74 mgc: 0.8858578 ustep: 1 
iter: 2  value: 3821.74 mgc: 0.01361784 ustep: 1 
iter: 3  value: 3821.74 mgc: 1.326452e-05 ustep: 1 
iter: 4  mgc: 9.973161e-12 
iter: 1  mgc: 9.973161e-12 
outer mgc:  2.003987 
iter: 1  value: 3820.799 mgc: 2.815007 ustep: 1 
iter: 2  value: 3820.798 mgc: 0.07463287 ustep: 1 
iter: 3  value: 3820.798 mgc: 6.415111e-05 ustep: 1 
iter: 4  mgc: 4.90874e-11 
iter: 1  value: 3821.179 mgc: 1.198253 ustep: 1 
iter: 2  value: 3821.179 mgc: 0.01518656 ustep: 1 
iter: 3  value: 3821.179 mgc: 3.139533e-06 ustep: 1 
iter: 4  mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  0.9186748 
iter: 1  value: 3820.332 mgc: 0.7511068 ustep: 1 
iter: 2  value: 3820.332 mgc: 0.004054711 ustep: 1 
iter: 3  value: 3820.332 mgc: 6.50507e-07 ustep: 1 
iter: 4  mgc: 7.327472e-15 
iter: 1  mgc: 7.327472e-15 
outer mgc:  1.37258 
iter: 1  value: 3820.152 mgc: 0.6160713 ustep: 1 
iter: 2  value: 3820.152 mgc: 0.00306195 ustep: 1 
iter: 3  value: 3820.152 mgc: 2.0199e-07 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.9987325 
iter: 1  value: 3819.594 mgc: 0.4242354 ustep: 1 
iter: 2  value: 3819.594 mgc: 0.000938208 ustep: 1 
iter: 3  value: 3819.594 mgc: 7.819894e-08 ustep: 1 
iter: 4  mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  0.661211 
iter: 1  value: 3819.478 mgc: 0.2353897 ustep: 1 
iter: 2  value: 3819.478 mgc: 0.0002548489 ustep: 1 
iter: 3  mgc: 8.939655e-09 
iter: 1  mgc: 8.939655e-09 
outer mgc:  0.8466932 
iter: 1  value: 3818.665 mgc: 0.3577676 ustep: 1 
iter: 2  value: 3818.665 mgc: 0.0005140136 ustep: 1 
iter: 3  mgc: 8.269966e-09 
iter: 1  value: 3817.459 mgc: 0.5237553 ustep: 1 
iter: 2  value: 3817.459 mgc: 0.0008769457 ustep: 1 
iter: 3  value: 3817.459 mgc: 2.361243e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  1.029015 
iter: 1  value: 3816.821 mgc: 0.5303911 ustep: 1 
iter: 2  value: 3816.821 mgc: 0.0008888774 ustep: 1 
iter: 3  value: 3816.821 mgc: 1.845042e-08 ustep: 1 
mgc: 6.189493e-15 
iter: 1  mgc: 6.189493e-15 
outer mgc:  0.6144262 
iter: 1  value: 3815.759 mgc: 0.585441 ustep: 1 
iter: 2  value: 3815.759 mgc: 0.001963414 ustep: 1 
iter: 3  value: 3815.759 mgc: 2.326326e-08 ustep: 1 
mgc: 6.494805e-15 
iter: 1  mgc: 6.494805e-15 
outer mgc:  0.3296641 
iter: 1  value: 3814.641 mgc: 0.82115 ustep: 1 
iter: 2  value: 3814.641 mgc: 0.0004864826 ustep: 1 
iter: 3  value: 3814.641 mgc: 1.939625e-08 ustep: 1 
mgc: 4.440892e-15 
iter: 1  mgc: 4.440892e-15 
outer mgc:  0.4806602 
iter: 1  value: 3813.904 mgc: 0.5721557 ustep: 1 
iter: 2  value: 3813.904 mgc: 0.001003556 ustep: 1 
iter: 3  mgc: 6.08946e-09 
iter: 1  mgc: 6.08946e-09 
outer mgc:  0.6053464 
iter: 1  value: 3814.06 mgc: 0.2308112 ustep: 1 
iter: 2  value: 3814.06 mgc: 0.0006918405 ustep: 1 
iter: 3  mgc: 7.917811e-09 
iter: 1  mgc: 7.917811e-09 
outer mgc:  0.3108488 
iter: 1  value: 3813.917 mgc: 0.4448283 ustep: 1 
iter: 2  value: 3813.917 mgc: 0.0004777656 ustep: 1 
iter: 3  mgc: 2.181163e-09 
iter: 1  mgc: 2.181163e-09 
outer mgc:  0.07497768 
iter: 1  value: 3813.68 mgc: 0.140138 ustep: 1 
iter: 2  value: 3813.68 mgc: 1.710362e-05 ustep: 1 
iter: 3  mgc: 6.949996e-12 
iter: 1  mgc: 6.949996e-12 
outer mgc:  0.02087877 
iter: 1  value: 3813.458 mgc: 0.117064 ustep: 1 
iter: 2  value: 3813.458 mgc: 9.360995e-06 ustep: 1 
iter: 3  mgc: 5.287326e-12 
iter: 1  mgc: 5.287326e-12 
outer mgc:  0.01688259 
iter: 1  value: 3813.123 mgc: 0.1729447 ustep: 1 
iter: 2  value: 3813.123 mgc: 2.513839e-05 ustep: 1 
iter: 3  mgc: 2.296741e-11 
iter: 1  mgc: 2.296741e-11 
outer mgc:  0.009016008 
iter: 1  value: 3813.059 mgc: 0.03102589 ustep: 1 
iter: 2  value: 3813.059 mgc: 1.143732e-06 ustep: 1 
iter: 3  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  0.002564491 
iter: 1  value: 3813.052 mgc: 0.003724413 ustep: 1 
iter: 2  value: 3813.052 mgc: 2.123985e-08 ustep: 1 
mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  0.0002609634 
iter: 1  mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  0.0002609634 
iter: 1  value: 3813.051 mgc: 0.005601336 ustep: 1 
iter: 2  value: 3813.051 mgc: 3.317985e-07 ustep: 1 
iter: 3  mgc: 5.995204e-15 
outer mgc:  0.05637738 
iter: 1  value: 3813.053 mgc: 0.005598032 ustep: 1 
iter: 2  value: 3813.053 mgc: 3.314901e-07 ustep: 1 
iter: 3  mgc: 1.021405e-14 
outer mgc:  0.0562506 
iter: 1  value: 3813.051 mgc: 0.003135608 ustep: 1 
iter: 2  value: 3813.051 mgc: 1.409202e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.03414412 
iter: 1  value: 3813.052 mgc: 0.003134125 ustep: 1 
iter: 2  value: 3813.052 mgc: 1.40811e-07 ustep: 1 
iter: 3  mgc: 1.015854e-14 
outer mgc:  0.0338936 
iter: 1  value: 3813.054 mgc: 0.006170551 ustep: 1 
iter: 2  value: 3813.054 mgc: 2.683292e-07 ustep: 1 
iter: 3  mgc: 9.436896e-15 
outer mgc:  0.07682492 
iter: 1  value: 3813.05 mgc: 0.006169996 ustep: 1 
iter: 2  value: 3813.05 mgc: 2.668092e-07 ustep: 1 
iter: 3  mgc: 1.398881e-14 
outer mgc:  0.0771766 
iter: 1  value: 3813.053 mgc: 0.003300232 ustep: 1 
iter: 2  value: 3813.053 mgc: 7.311089e-08 ustep: 1 
iter: 3  mgc: 1.146305e-14 
outer mgc:  0.04586299 
iter: 1  value: 3813.051 mgc: 0.00329985 ustep: 1 
iter: 2  value: 3813.051 mgc: 7.287278e-08 ustep: 1 
iter: 3  mgc: 5.77316e-15 
outer mgc:  0.04637521 
iter: 1  value: 3813.064 mgc: 0.03463817 ustep: 1 
iter: 2  value: 3813.064 mgc: 2.58895e-06 ustep: 1 
iter: 3  mgc: 6.838974e-14 
outer mgc:  0.03006662 
iter: 1  value: 3813.04 mgc: 0.03467282 ustep: 1 
iter: 2  value: 3813.04 mgc: 2.589414e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.02964324 
iter: 1  value: 3813.063 mgc: 0.03421969 ustep: 1 
iter: 2  value: 3813.063 mgc: 1.008785e-06 ustep: 1 
iter: 3  mgc: 1.887379e-14 
outer mgc:  0.02913591 
iter: 1  value: 3813.04 mgc: 0.03432289 ustep: 1 
iter: 2  value: 3813.04 mgc: 1.005715e-06 ustep: 1 
iter: 3  mgc: 1.915135e-14 
outer mgc:  0.02960335 
iter: 1  value: 3813.047 mgc: 0.002211654 ustep: 1 
iter: 2  mgc: 4.734932e-09 
outer mgc:  0.0004554376 
iter: 1  value: 3813.056 mgc: 0.002211038 ustep: 1 
iter: 2  mgc: 4.741295e-09 
outer mgc:  0.0005880854 
iter: 1  value: 3813.046 mgc: 0.004182924 ustep: 1 
iter: 2  value: 3813.046 mgc: 2.05135e-07 ustep: 1 
iter: 3  mgc: 1.509903e-14 
outer mgc:  0.02482293 
iter: 1  value: 3813.058 mgc: 0.004180032 ustep: 1 
iter: 2  value: 3813.058 mgc: 2.049769e-07 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.02495056 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:49:22 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:04:24 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_2_ModeldiagREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=diagREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_2_diagREDMsinglelambda_NA_NA_NA_dataset1.RDS --model diagREDMsinglelambda --optimiser nlminb
Model: diagREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21784.383072 
iter  10 value 18086.802769
iter  10 value 18086.802766
final  value 18086.802766 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 16882.14 mgc: 4.446365 ustep: 1 
iter: 2  value: 16878.48 mgc: 2.921157 ustep: 1 
iter: 3  value: 16873.94 mgc: 2.460366 ustep: 0.4367355 
iter: 4  value: 16873.85 mgc: 0.4685134 ustep: 0.6608936 
iter: 5  value: 16873.84 mgc: 0.09675923 ustep: 0.8129723 
iter: 6  value: 16873.84 mgc: 0.01763823 ustep: 0.9016596 
iter: 7  value: 16873.84 mgc: 0.001831961 ustep: 0.9495626 
iter: 8  value: 16873.84 mgc: 9.412506e-05 ustep: 0.9744576 
iter: 9  value: 16873.84 mgc: 2.441469e-06 ustep: 0.9871475 
iter: 10  value: 16873.84 mgc: 3.1922e-08 ustep: 0.9935536 
iter: 11  mgc: 2.095452e-10 
iter: 1  mgc: 2.095452e-10 
Matching hessian patterns... Done
outer mgc:  104.1569 
iter: 1  value: 16772.38 mgc: 1.572427 ustep: 1 
iter: 2  value: 16771.75 mgc: 0.1514944 ustep: 1 
iter: 3  value: 16771.75 mgc: 0.003504623 ustep: 1 
iter: 4  value: 16771.75 mgc: 8.006955e-07 ustep: 1 
iter: 5  mgc: 8.004708e-14 
iter: 1  value: 16727.89 mgc: 1.412199 ustep: 1 
iter: 2  value: 16727.19 mgc: 0.16166 ustep: 1 
iter: 3  value: 16727.19 mgc: 0.003713867 ustep: 1 
iter: 4  value: 16727.19 mgc: 1.20568e-06 ustep: 1 
iter: 5  mgc: 1.363493e-13 
iter: 1  mgc: 1.363493e-13 
outer mgc:  122.0109 
iter: 1  value: 16513.33 mgc: 5.724574 ustep: 1 
iter: 2  value: 16510.34 mgc: 1.295848 ustep: 1 
iter: 3  value: 16510.33 mgc: 0.1040818 ustep: 1 
iter: 4  value: 16510.33 mgc: 0.001204903 ustep: 1 
iter: 5  value: 16510.33 mgc: 1.654394e-07 ustep: 1 
iter: 6  mgc: 5.606626e-15 
iter: 1  mgc: 5.606626e-15 
outer mgc:  105.0285 
iter: 1  value: 16628.92 mgc: 4.122088 ustep: 1 
iter: 2  value: 16628.36 mgc: 0.5287962 ustep: 1 
iter: 3  value: 16628.36 mgc: 0.04130224 ustep: 1 
iter: 4  value: 16628.36 mgc: 0.0003780357 ustep: 1 
iter: 5  value: 16628.36 mgc: 3.253179e-08 ustep: 1 
iter: 6  mgc: 2.664535e-15 
iter: 1  value: 16476.26 mgc: 2.32886 ustep: 1 
iter: 2  value: 16475.34 mgc: 0.4236564 ustep: 1 
iter: 3  value: 16475.34 mgc: 0.008533333 ustep: 1 
iter: 4  value: 16475.34 mgc: 5.359965e-06 ustep: 1 
iter: 5  mgc: 2.99083e-12 
iter: 1  mgc: 2.99083e-12 
outer mgc:  100.5033 
iter: 1  value: 16312.77 mgc: 4.295444 ustep: 1 
iter: 2  value: 16310.81 mgc: 1.16007 ustep: 1 
iter: 3  value: 16310.81 mgc: 0.03791283 ustep: 1 
iter: 4  value: 16310.81 mgc: 0.0001165983 ustep: 1 
iter: 5  mgc: 1.015366e-09 
iter: 1  mgc: 1.015366e-09 
outer mgc:  32.27781 
iter: 1  value: 16280.21 mgc: 3.890514 ustep: 1 
iter: 2  value: 16280.14 mgc: 0.2702947 ustep: 1 
iter: 3  value: 16280.14 mgc: 0.00193809 ustep: 1 
iter: 4  value: 16280.14 mgc: 7.555476e-08 ustep: 1 
iter: 5  mgc: 3.749361e-15 
iter: 1  mgc: 3.749361e-15 
outer mgc:  41.79727 
iter: 1  value: 16490.27 mgc: 7.001045 ustep: 1 
iter: 2  value: 16480.69 mgc: 2.104796 ustep: 1 
iter: 3  value: 16480.68 mgc: 0.05484082 ustep: 1 
iter: 4  value: 16480.68 mgc: 5.366701e-05 ustep: 1 
iter: 5  mgc: 5.787015e-11 
iter: 1  value: 16261.68 mgc: 0.5267226 ustep: 1 
iter: 2  value: 16261.68 mgc: 0.007672025 ustep: 1 
iter: 3  value: 16261.68 mgc: 1.954795e-06 ustep: 1 
iter: 4  mgc: 1.270095e-13 
iter: 1  mgc: 1.270095e-13 
outer mgc:  26.5843 
iter: 1  value: 16234.65 mgc: 0.7599791 ustep: 1 
iter: 2  value: 16234.65 mgc: 0.007279902 ustep: 1 
iter: 3  value: 16234.65 mgc: 1.909449e-06 ustep: 1 
iter: 4  mgc: 6.517009e-14 
iter: 1  mgc: 6.517009e-14 
outer mgc:  10.22527 
iter: 1  value: 16216.93 mgc: 1.471988 ustep: 1 
iter: 2  value: 16216.93 mgc: 0.0196825 ustep: 1 
iter: 3  value: 16216.93 mgc: 1.075684e-05 ustep: 1 
iter: 4  mgc: 3.149925e-12 
iter: 1  mgc: 3.149925e-12 
outer mgc:  17.93614 
iter: 1  value: 16206.05 mgc: 2.331988 ustep: 1 
iter: 2  value: 16206.04 mgc: 0.05711203 ustep: 1 
iter: 3  value: 16206.04 mgc: 1.420739e-05 ustep: 1 
iter: 4  mgc: 4.798814e-12 
iter: 1  value: 16211.33 mgc: 0.7573446 ustep: 1 
iter: 2  value: 16211.33 mgc: 0.004872726 ustep: 1 
iter: 3  value: 16211.33 mgc: 5.77082e-07 ustep: 1 
iter: 4  mgc: 1.232348e-14 
iter: 1  mgc: 1.232348e-14 
outer mgc:  11.51073 
iter: 1  value: 16208.58 mgc: 0.863452 ustep: 1 
iter: 2  value: 16208.58 mgc: 0.01722148 ustep: 1 
iter: 3  value: 16208.58 mgc: 6.675422e-06 ustep: 1 
iter: 4  mgc: 1.007416e-12 
iter: 1  mgc: 1.007416e-12 
outer mgc:  15.48891 
iter: 1  value: 16200.7 mgc: 0.7019486 ustep: 1 
iter: 2  value: 16200.7 mgc: 0.006318517 ustep: 1 
iter: 3  value: 16200.7 mgc: 7.178968e-07 ustep: 1 
iter: 4  mgc: 1.265654e-14 
iter: 1  mgc: 1.265654e-14 
outer mgc:  6.862177 
iter: 1  value: 16187.56 mgc: 1.118025 ustep: 1 
iter: 2  value: 16187.56 mgc: 0.01683205 ustep: 1 
iter: 3  value: 16187.56 mgc: 4.942272e-06 ustep: 1 
iter: 4  mgc: 4.050094e-13 
iter: 1  mgc: 4.050094e-13 
outer mgc:  16.42611 
iter: 1  value: 16156.01 mgc: 1.695952 ustep: 1 
iter: 2  value: 16156.01 mgc: 0.02278003 ustep: 1 
iter: 3  value: 16156.01 mgc: 6.418644e-06 ustep: 1 
iter: 4  mgc: 4.747314e-13 
iter: 1  mgc: 4.747314e-13 
outer mgc:  15.03918 
iter: 1  value: 16132.48 mgc: 2.359438 ustep: 1 
iter: 2  value: 16132.48 mgc: 0.02366951 ustep: 1 
iter: 3  value: 16132.48 mgc: 3.004547e-06 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  16.33928 
iter: 1  value: 16127.01 mgc: 1.99558 ustep: 1 
iter: 2  value: 16127.01 mgc: 0.009451281 ustep: 1 
iter: 3  value: 16127.01 mgc: 5.012072e-07 ustep: 1 
iter: 4  mgc: 3.552714e-15 
iter: 1  value: 16128.62 mgc: 0.4347846 ustep: 1 
iter: 2  value: 16128.62 mgc: 0.0008261845 ustep: 1 
iter: 3  mgc: 4.522752e-09 
iter: 1  mgc: 4.522752e-09 
outer mgc:  4.371101 
iter: 1  value: 16120.76 mgc: 0.1823703 ustep: 1 
iter: 2  value: 16120.76 mgc: 0.0001030726 ustep: 1 
iter: 3  mgc: 6.831535e-11 
iter: 1  mgc: 6.831535e-11 
outer mgc:  7.879092 
iter: 1  value: 16114.38 mgc: 0.6892056 ustep: 1 
iter: 2  value: 16114.38 mgc: 0.001885372 ustep: 1 
iter: 3  value: 16114.38 mgc: 1.879516e-08 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  16.31192 
iter: 1  value: 16107.8 mgc: 0.78929 ustep: 1 
iter: 2  value: 16107.8 mgc: 0.001723591 ustep: 1 
iter: 3  mgc: 8.452995e-09 
iter: 1  mgc: 8.452995e-09 
outer mgc:  7.351412 
iter: 1  value: 16096.21 mgc: 0.4916679 ustep: 1 
iter: 2  value: 16096.21 mgc: 0.0003204085 ustep: 1 
iter: 3  mgc: 5.764154e-10 
iter: 1  mgc: 5.764154e-10 
outer mgc:  2.911008 
iter: 1  value: 16085.95 mgc: 0.8725925 ustep: 1 
iter: 2  value: 16085.95 mgc: 0.00155377 ustep: 1 
iter: 3  mgc: 8.186163e-09 
iter: 1  value: 16094.8 mgc: 0.2411519 ustep: 1 
iter: 2  value: 16094.8 mgc: 0.0002103186 ustep: 1 
iter: 3  mgc: 1.69494e-10 
iter: 1  value: 16095.72 mgc: 0.06701772 ustep: 1 
iter: 2  value: 16095.72 mgc: 1.771479e-05 ustep: 1 
iter: 3  mgc: 1.313394e-12 
iter: 1  mgc: 1.313394e-12 
outer mgc:  2.48076 
iter: 1  value: 16095.26 mgc: 0.08804398 ustep: 1 
iter: 2  value: 16095.26 mgc: 2.051359e-05 ustep: 1 
iter: 3  mgc: 8.686385e-13 
iter: 1  mgc: 8.686385e-13 
outer mgc:  1.907857 
iter: 1  value: 16093.68 mgc: 0.1131882 ustep: 1 
iter: 2  value: 16093.68 mgc: 3.575848e-05 ustep: 1 
iter: 3  mgc: 5.501377e-12 
iter: 1  value: 16091.91 mgc: 0.1161384 ustep: 1 
iter: 2  value: 16091.91 mgc: 2.269249e-05 ustep: 1 
iter: 3  mgc: 1.312284e-12 
iter: 1  value: 16082.07 mgc: 0.6759006 ustep: 1 
iter: 2  value: 16082.07 mgc: 0.0006259574 ustep: 1 
iter: 3  mgc: 8.256014e-10 
iter: 1  value: 16061.14 mgc: 1.438768 ustep: 1 
iter: 2  value: 16061.14 mgc: 0.001659461 ustep: 1 
iter: 3  mgc: 6.782179e-09 
iter: 1  mgc: 6.782179e-09 
outer mgc:  6.894673 
iter: 1  value: 16025.54 mgc: 2.535251 ustep: 1 
iter: 2  value: 16025.54 mgc: 0.002040527 ustep: 1 
iter: 3  mgc: 4.765548e-09 
iter: 1  mgc: 4.765548e-09 
outer mgc:  5.849645 
iter: 1  value: 15989.45 mgc: 2.585777 ustep: 1 
iter: 2  value: 15989.45 mgc: 0.00128347 ustep: 1 
iter: 3  mgc: 1.503024e-09 
iter: 1  mgc: 1.503024e-09 
outer mgc:  4.57695 
iter: 1  value: 15952.69 mgc: 2.759333 ustep: 1 
iter: 2  value: 15952.69 mgc: 0.001034712 ustep: 1 
iter: 3  mgc: 4.585592e-10 
iter: 1  value: 15975.86 mgc: 0.9845294 ustep: 1 
iter: 2  value: 15975.86 mgc: 0.0002256827 ustep: 1 
iter: 3  mgc: 3.454259e-11 
iter: 1  mgc: 3.454259e-11 
outer mgc:  3.834896 
iter: 1  value: 15960.81 mgc: 0.9711359 ustep: 1 
iter: 2  value: 15960.81 mgc: 0.0001226348 ustep: 1 
iter: 3  mgc: 7.50644e-12 
iter: 1  mgc: 7.50644e-12 
outer mgc:  2.27204 
iter: 1  value: 15922.61 mgc: 2.884337 ustep: 1 
iter: 2  value: 15922.61 mgc: 0.0005322837 ustep: 1 
iter: 3  mgc: 7.126921e-11 
iter: 1  mgc: 7.126921e-11 
outer mgc:  0.8075274 
iter: 1  value: 15884.09 mgc: 2.995783 ustep: 1 
iter: 2  value: 15884.09 mgc: 0.0003115989 ustep: 1 
iter: 3  mgc: 1.154477e-11 
iter: 1  mgc: 1.154477e-11 
outer mgc:  0.6462702 
iter: 1  value: 15845.32 mgc: 3.005368 ustep: 1 
iter: 2  value: 15845.32 mgc: 0.000149377 ustep: 1 
iter: 3  mgc: 1.258771e-12 
iter: 1  mgc: 1.258771e-12 
outer mgc:  0.4754531 
iter: 1  value: 15775.17 mgc: 6.593678 ustep: 1 
iter: 2  value: 15775.17 mgc: 0.0001962907 ustep: 1 
iter: 3  mgc: 5.684342e-13 
iter: 1  mgc: 5.684342e-13 
outer mgc:  0.4726716 
iter: 1  value: 15717.41 mgc: 5.04433 ustep: 1 
iter: 2  value: 15717.41 mgc: 4.009589e-05 ustep: 1 
iter: 3  mgc: 8.881784e-15 
iter: 1  mgc: 8.881784e-15 
outer mgc:  0.2280631 
iter: 1  value: 15659.52 mgc: 5.062232 ustep: 1 
iter: 2  value: 15659.52 mgc: 1.422249e-05 ustep: 1 
iter: 3  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.2293755 
iter: 1  value: 15601.56 mgc: 5.072507 ustep: 1 
iter: 2  value: 15601.56 mgc: 4.927941e-06 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.1057758 
iter: 1  value: 15530.91 mgc: 6.679322 ustep: 1 
iter: 2  value: 15530.91 mgc: 2.295254e-06 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.0387671 
iter: 1  value: 15463.48 mgc: 6.248758 ustep: 1 
iter: 2  value: 15463.48 mgc: 5.911611e-07 ustep: 1 
mgc: 5.329071e-15 
iter: 1  mgc: 5.329071e-15 
outer mgc:  0.0257182 
iter: 1  value: 15396.02 mgc: 6.248018 ustep: 1 
iter: 2  value: 15396.02 mgc: 1.753677e-07 ustep: 1 
mgc: 4.662937e-15 
iter: 1  mgc: 4.662937e-15 
outer mgc:  0.01768698 
iter: 1  value: 15328.56 mgc: 6.249742 ustep: 1 
iter: 2  value: 15328.56 mgc: 5.215777e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.009844669 
iter: 1  value: 15261.1 mgc: 6.249487 ustep: 1 
iter: 2  value: 15261.1 mgc: 1.550097e-08 ustep: 1 
mgc: 4.884981e-15 
iter: 1  mgc: 4.884981e-15 
outer mgc:  0.009354317 
iter: 1  value: 15193.63 mgc: 6.250382 ustep: 1 
iter: 2  mgc: 4.607363e-09 
iter: 1  mgc: 4.607363e-09 
outer mgc:  0.00623753 
iter: 1  value: 15126.16 mgc: 6.250041 ustep: 1 
iter: 2  mgc: 1.36933e-09 
iter: 1  mgc: 1.36933e-09 
outer mgc:  0.003682818 
iter: 1  value: 15058.69 mgc: 6.250394 ustep: 1 
iter: 2  mgc: 4.070664e-10 
iter: 1  mgc: 4.070664e-10 
outer mgc:  0.002463346 
iter: 1  value: 14991.22 mgc: 6.250179 ustep: 1 
iter: 2  mgc: 1.210116e-10 
iter: 1  mgc: 1.210116e-10 
outer mgc:  0.001983395 
iter: 1  value: 14923.75 mgc: 6.250349 ustep: 1 
iter: 2  mgc: 3.597833e-11 
iter: 1  mgc: 3.597833e-11 
outer mgc:  0.001147137 
iter: 1  value: 14856.28 mgc: 6.250256 ustep: 1 
iter: 2  mgc: 1.069722e-11 
iter: 1  mgc: 1.069722e-11 
outer mgc:  0.0007770692 
iter: 1  value: 14788.81 mgc: 6.250335 ustep: 1 
iter: 2  mgc: 3.182343e-12 
iter: 1  mgc: 3.182343e-12 
outer mgc:  0.0005310349 
iter: 1  value: 14721.34 mgc: 6.250294 ustep: 1 
iter: 2  mgc: 9.450218e-13 
iter: 1  mgc: 9.450218e-13 
outer mgc:  0.00031068 
iter: 1  value: 14653.87 mgc: 6.250324 ustep: 1 
iter: 2  mgc: 2.815526e-13 
iter: 1  mgc: 2.815526e-13 
outer mgc:  0.0002030422 
iter: 1  mgc: 2.815526e-13 
iter: 1  mgc: 2.815526e-13 
outer mgc:  0.0002030422 
iter: 1  value: 14653.87 mgc: 0.004382237 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.3797129 
iter: 1  value: 14653.87 mgc: 0.004381083 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.3793369 
iter: 1  value: 14653.87 mgc: 0.002402022 ustep: 1 
mgc: 5.551115e-15 
outer mgc:  0.1871386 
iter: 1  value: 14653.87 mgc: 0.002401354 ustep: 1 
mgc: 4.218847e-15 
outer mgc:  0.1868803 
iter: 1  value: 14653.87 mgc: 0.004580661 ustep: 1 
mgc: 4.773959e-15 
outer mgc:  0.321032 
iter: 1  value: 14653.87 mgc: 0.004580138 ustep: 1 
mgc: 6.217249e-15 
outer mgc:  0.3211666 
iter: 1  value: 14653.87 mgc: 0.002488229 ustep: 1 
mgc: 5.440093e-15 
outer mgc:  0.1740601 
iter: 1  value: 14653.87 mgc: 0.002488516 ustep: 1 
mgc: 4.440892e-15 
outer mgc:  0.1742427 
iter: 1  value: 14653.92 mgc: 0.005525211 ustep: 1 
mgc: 3.552714e-15 
outer mgc:  0.0002030415 
iter: 1  value: 14653.82 mgc: 0.005530739 ustep: 1 
mgc: 5.218048e-15 
outer mgc:  0.0002030429 
iter: 1  value: 14653.92 mgc: 0.005662023 ustep: 1 
mgc: 3.996803e-15 
outer mgc:  0.0002030422 
iter: 1  value: 14653.82 mgc: 0.005667687 ustep: 1 
mgc: 4.662937e-15 
outer mgc:  0.0002030422 
iter: 1  value: 14653.87 mgc: 0.004457217 ustep: 1 
mgc: 5.218048e-15 
outer mgc:  0.1753512 
iter: 1  value: 14653.87 mgc: 0.004454136 ustep: 1 
mgc: 5.77316e-15 
outer mgc:  0.1753716 
[Mon Aug 16 08:04:29 2021]
Finished job 0.
1 of 1 steps (100%) done

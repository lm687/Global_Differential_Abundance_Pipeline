Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:57:32 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.8_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_80_3_0.8_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0.8_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11008.095132 
final  value 10258.640992 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1864.946 mgc: 67.77234 ustep: 1 
iter: 2  value: 1820.14 mgc: 16.85595 ustep: 1 
iter: 3  value: 1820.049 mgc: 1.504529 ustep: 1 
iter: 4  value: 1820.049 mgc: 0.00745294 ustep: 1 
iter: 5  value: 1820.049 mgc: 1.802741e-07 ustep: 1 
mgc: 3.080869e-14 
iter: 1  mgc: 3.080869e-14 
Matching hessian patterns... Done
outer mgc:  847.1789 
iter: 1  value: 1265.619 mgc: 30.994 ustep: 1 
iter: 2  value: 1265.035 mgc: 2.5603 ustep: 1 
iter: 3  value: 1265.035 mgc: 0.01588023 ustep: 1 
iter: 4  value: 1265.035 mgc: 7.170528e-07 ustep: 1 
iter: 5  mgc: 2.700618e-14 
iter: 1  mgc: 2.700618e-14 
outer mgc:  367.2308 
iter: 1  value: 914.809 mgc: 11.98253 ustep: 1 
iter: 2  value: 913.3893 mgc: 1.519688 ustep: 1 
iter: 3  value: 913.3889 mgc: 0.01871322 ustep: 1 
iter: 4  value: 913.3889 mgc: 1.687529e-05 ustep: 1 
iter: 5  mgc: 1.7222e-11 
iter: 1  value: 758.1038 mgc: 13.95217 ustep: 1 
iter: 2  value: 757.15 mgc: 1.607263 ustep: 1 
iter: 3  value: 757.1499 mgc: 0.0109712 ustep: 1 
iter: 4  value: 757.1499 mgc: 4.848776e-06 ustep: 1 
iter: 5  mgc: 1.297851e-12 
iter: 1  mgc: 1.297851e-12 
outer mgc:  216.2585 
iter: 1  value: 723.2426 mgc: 66.91554 ustep: 1 
iter: 2  value: 666.6432 mgc: 17.7011 ustep: 1 
iter: 3  value: 666.6089 mgc: 0.7130912 ustep: 1 
iter: 4  value: 666.6089 mgc: 0.001542263 ustep: 1 
iter: 5  mgc: 7.683718e-09 
iter: 1  mgc: 7.683718e-09 
outer mgc:  251.473 
iter: 1  value: 3120.742 mgc: 210.1339 ustep: 1 
iter: 2  value: 3112.08 mgc: 10.74976 ustep: 1 
iter: 3  value: 3112.078 mgc: 0.1695845 ustep: 1 
iter: 4  value: 3112.078 mgc: 9.642863e-05 ustep: 1 
iter: 5  mgc: 2.90683e-11 
iter: 1  value: 615.6711 mgc: 16.54729 ustep: 1 
iter: 2  value: 615.6272 mgc: 0.2940516 ustep: 1 
iter: 3  value: 615.6272 mgc: 0.000580986 ustep: 1 
iter: 4  mgc: 1.312968e-09 
iter: 1  mgc: 1.312968e-09 
outer mgc:  55.18407 
iter: 1  value: 608.4746 mgc: 11.06906 ustep: 1 
iter: 2  value: 608.4703 mgc: 0.1032436 ustep: 1 
iter: 3  value: 608.4703 mgc: 5.322757e-05 ustep: 1 
iter: 4  mgc: 3.007816e-11 
iter: 1  mgc: 3.007816e-11 
outer mgc:  47.12778 
iter: 1  value: 611.717 mgc: 9.337663 ustep: 1 
iter: 2  value: 611.7137 mgc: 0.1608044 ustep: 1 
iter: 3  value: 611.7137 mgc: 8.414405e-05 ustep: 1 
iter: 4  mgc: 1.872458e-11 
iter: 1  value: 607.8667 mgc: 6.636518 ustep: 1 
iter: 2  value: 607.8655 mgc: 0.06154103 ustep: 1 
iter: 3  value: 607.8655 mgc: 1.580963e-05 ustep: 1 
iter: 4  mgc: 6.42375e-13 
iter: 1  mgc: 6.42375e-13 
outer mgc:  54.47408 
iter: 1  value: 606.2996 mgc: 4.320604 ustep: 1 
iter: 2  value: 606.2995 mgc: 0.02252391 ustep: 1 
iter: 3  value: 606.2995 mgc: 1.634589e-06 ustep: 1 
iter: 4  mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  18.07516 
iter: 1  value: 604.9929 mgc: 2.482766 ustep: 1 
iter: 2  value: 604.9928 mgc: 0.007521524 ustep: 1 
iter: 3  value: 604.9928 mgc: 6.148791e-07 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  8.984436 
iter: 1  value: 603.7184 mgc: 1.4954 ustep: 1 
iter: 2  value: 603.7184 mgc: 0.003022913 ustep: 1 
iter: 3  value: 603.7184 mgc: 2.414026e-08 ustep: 1 
mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  9.362375 
iter: 1  value: 603.2864 mgc: 2.150895 ustep: 1 
iter: 2  value: 603.2864 mgc: 0.007492612 ustep: 1 
iter: 3  value: 603.2864 mgc: 1.487432e-07 ustep: 1 
mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  25.57175 
iter: 1  value: 602.1644 mgc: 2.576161 ustep: 1 
iter: 2  value: 602.1644 mgc: 0.01198179 ustep: 1 
iter: 3  value: 602.1644 mgc: 3.100552e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  10.86957 
iter: 1  value: 601.5293 mgc: 1.464139 ustep: 1 
iter: 2  value: 601.5293 mgc: 0.004281907 ustep: 1 
iter: 3  value: 601.5293 mgc: 5.180663e-08 ustep: 1 
iter: 4  mgc: 2.220446e-14 
iter: 1  value: 601.0835 mgc: 0.7680984 ustep: 1 
iter: 2  value: 601.0835 mgc: 0.002482189 ustep: 1 
iter: 3  value: 601.0835 mgc: 7.274425e-08 ustep: 1 
iter: 4  mgc: 3.241851e-14 
iter: 1  mgc: 3.241851e-14 
outer mgc:  4.948684 
iter: 1  value: 598.2602 mgc: 2.017342 ustep: 1 
iter: 2  value: 598.2601 mgc: 0.01308313 ustep: 1 
iter: 3  value: 598.2601 mgc: 2.258808e-07 ustep: 1 
iter: 4  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  7.340806 
iter: 1  value: 598.7009 mgc: 2.834673 ustep: 1 
iter: 2  value: 598.7007 mgc: 0.02379307 ustep: 1 
iter: 3  value: 598.7007 mgc: 8.346121e-06 ustep: 1 
iter: 4  mgc: 2.102318e-12 
iter: 1  mgc: 2.102318e-12 
outer mgc:  10.96775 
iter: 1  value: 597.7769 mgc: 2.626478 ustep: 1 
iter: 2  value: 597.7769 mgc: 0.003655373 ustep: 1 
iter: 3  value: 597.7769 mgc: 4.610633e-07 ustep: 1 
iter: 4  mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  16.74982 
iter: 1  value: 595.0069 mgc: 3.217788 ustep: 1 
iter: 2  value: 595.0068 mgc: 0.007908918 ustep: 1 
iter: 3  value: 595.0068 mgc: 2.068545e-06 ustep: 1 
iter: 4  mgc: 1.447731e-13 
iter: 1  mgc: 1.447731e-13 
outer mgc:  11.5626 
iter: 1  value: 597.1733 mgc: 3.815409 ustep: 1 
iter: 2  value: 597.1732 mgc: 0.02476362 ustep: 1 
iter: 3  value: 597.1732 mgc: 1.361867e-06 ustep: 1 
iter: 4  mgc: 4.440892e-14 
iter: 1  value: 595.3688 mgc: 1.780304 ustep: 1 
iter: 2  value: 595.3688 mgc: 0.002131455 ustep: 1 
iter: 3  value: 595.3688 mgc: 1.562056e-08 ustep: 1 
mgc: 3.08642e-14 
iter: 1  value: 594.9601 mgc: 0.6230679 ustep: 1 
iter: 2  value: 594.9601 mgc: 0.0002698901 ustep: 1 
iter: 3  mgc: 2.4556e-10 
iter: 1  mgc: 2.4556e-10 
outer mgc:  8.221903 
iter: 1  value: 595.0096 mgc: 0.8582099 ustep: 1 
iter: 2  value: 595.0096 mgc: 0.00075127 ustep: 1 
iter: 3  mgc: 1.562972e-09 
iter: 1  mgc: 1.562972e-09 
outer mgc:  11.09065 
iter: 1  value: 594.9265 mgc: 0.5639941 ustep: 1 
iter: 2  value: 594.9265 mgc: 0.0004340909 ustep: 1 
iter: 3  mgc: 3.781238e-10 
iter: 1  mgc: 3.781238e-10 
outer mgc:  2.437108 
iter: 1  value: 594.9855 mgc: 0.6884775 ustep: 1 
iter: 2  value: 594.9855 mgc: 0.0008201059 ustep: 1 
iter: 3  mgc: 1.202321e-09 
iter: 1  mgc: 1.202321e-09 
outer mgc:  7.560166 
iter: 1  value: 594.7133 mgc: 0.4687953 ustep: 1 
iter: 2  value: 594.7133 mgc: 0.0001510339 ustep: 1 
iter: 3  mgc: 2.30294e-10 
iter: 1  value: 594.3085 mgc: 0.5761412 ustep: 1 
iter: 2  value: 594.3085 mgc: 0.0005930219 ustep: 1 
iter: 3  mgc: 2.338012e-09 
iter: 1  value: 593.3576 mgc: 1.179672 ustep: 1 
iter: 2  value: 593.3576 mgc: 0.002996851 ustep: 1 
iter: 3  value: 593.3576 mgc: 1.691083e-07 ustep: 1 
iter: 4  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  9.647734 
iter: 1  value: 591.9714 mgc: 5.674288 ustep: 1 
iter: 2  value: 591.9687 mgc: 0.05975134 ustep: 1 
iter: 3  value: 591.9687 mgc: 8.734325e-05 ustep: 1 
iter: 4  mgc: 1.902922e-10 
iter: 1  value: 592.7465 mgc: 1.612186 ustep: 1 
iter: 2  value: 592.7465 mgc: 0.004714796 ustep: 1 
iter: 3  value: 592.7465 mgc: 2.322943e-07 ustep: 1 
iter: 4  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  8.874205 
iter: 1  value: 592.5622 mgc: 0.5739134 ustep: 1 
iter: 2  value: 592.5622 mgc: 0.0003459743 ustep: 1 
iter: 3  mgc: 2.331806e-10 
iter: 1  mgc: 2.331806e-10 
outer mgc:  11.251 
iter: 1  value: 592.355 mgc: 1.177126 ustep: 1 
iter: 2  value: 592.355 mgc: 0.0007616748 ustep: 1 
iter: 3  mgc: 5.753074e-10 
iter: 1  value: 592.526 mgc: 0.9691164 ustep: 1 
iter: 2  value: 592.526 mgc: 0.000437321 ustep: 1 
iter: 3  mgc: 5.56942e-10 
iter: 1  value: 592.5151 mgc: 0.4921706 ustep: 1 
iter: 2  value: 592.5151 mgc: 0.0001042523 ustep: 1 
iter: 3  mgc: 6.971312e-11 
iter: 1  mgc: 6.971312e-11 
outer mgc:  6.790404 
iter: 1  value: 592.439 mgc: 0.3397242 ustep: 1 
iter: 2  value: 592.439 mgc: 7.265231e-05 ustep: 1 
iter: 3  mgc: 1.702127e-11 
iter: 1  mgc: 1.702127e-11 
outer mgc:  4.19294 
iter: 1  value: 592.3177 mgc: 0.2243025 ustep: 1 
iter: 2  value: 592.3177 mgc: 3.966989e-05 ustep: 1 
iter: 3  mgc: 4.515499e-12 
iter: 1  mgc: 4.515499e-12 
outer mgc:  2.395679 
iter: 1  value: 592.1084 mgc: 0.228607 ustep: 1 
iter: 2  value: 592.1084 mgc: 7.625248e-05 ustep: 1 
iter: 3  mgc: 1.819878e-11 
iter: 1  value: 591.6822 mgc: 0.4910563 ustep: 1 
iter: 2  value: 591.6822 mgc: 0.0002348015 ustep: 1 
iter: 3  mgc: 2.916289e-10 
iter: 1  mgc: 2.916289e-10 
outer mgc:  1.90781 
iter: 1  value: 591.2997 mgc: 0.688873 ustep: 1 
iter: 2  value: 591.2997 mgc: 0.001037285 ustep: 1 
iter: 3  value: 591.2997 mgc: 2.618824e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  value: 591.5148 mgc: 0.2692487 ustep: 1 
iter: 2  value: 591.5148 mgc: 0.0001610564 ustep: 1 
iter: 3  mgc: 6.243255e-10 
iter: 1  mgc: 6.243255e-10 
outer mgc:  0.5653904 
iter: 1  value: 591.322 mgc: 0.185899 ustep: 1 
iter: 2  value: 591.322 mgc: 2.163189e-05 ustep: 1 
iter: 3  mgc: 1.175948e-12 
iter: 1  mgc: 1.175948e-12 
outer mgc:  0.1241449 
iter: 1  value: 591.1772 mgc: 0.1366079 ustep: 1 
iter: 2  value: 591.1772 mgc: 1.451935e-05 ustep: 1 
iter: 3  mgc: 5.684342e-13 
iter: 1  mgc: 5.684342e-13 
outer mgc:  0.01331081 
iter: 1  value: 591.1713 mgc: 0.006031194 ustep: 1 
iter: 2  value: 591.1713 mgc: 1.355211e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.001761548 
iter: 1  value: 591.1721 mgc: 0.0007083617 ustep: 1 
iter: 2  mgc: 6.442971e-10 
iter: 1  mgc: 6.442971e-10 
outer mgc:  0.001825163 
iter: 1  value: 591.172 mgc: 0.0002874611 ustep: 1 
iter: 2  mgc: 1.998046e-10 
iter: 1  mgc: 1.998046e-10 
outer mgc:  0.0002923524 
iter: 1  mgc: 1.998046e-10 
iter: 1  mgc: 1.998046e-10 
outer mgc:  0.0002923524 
iter: 1  value: 591.1726 mgc: 0.05233004 ustep: 1 
iter: 2  value: 591.1726 mgc: 2.607023e-06 ustep: 1 
iter: 3  mgc: 2.842171e-14 
outer mgc:  1.000217 
iter: 1  value: 591.1724 mgc: 0.05231919 ustep: 1 
iter: 2  value: 591.1724 mgc: 2.609504e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.9999544 
iter: 1  value: 591.1736 mgc: 0.02849599 ustep: 1 
iter: 2  value: 591.1736 mgc: 9.160639e-07 ustep: 1 
iter: 3  mgc: 3.68594e-14 
outer mgc:  0.8675531 
iter: 1  value: 591.1713 mgc: 0.02849564 ustep: 1 
iter: 2  value: 591.1713 mgc: 9.16941e-07 ustep: 1 
iter: 3  mgc: 3.219647e-14 
outer mgc:  0.8674139 
iter: 1  value: 591.1734 mgc: 0.05608077 ustep: 1 
iter: 2  value: 591.1734 mgc: 2.790332e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  0.995352 
iter: 1  value: 591.1716 mgc: 0.05607763 ustep: 1 
iter: 2  value: 591.1716 mgc: 2.795403e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.9954147 
iter: 1  value: 591.1735 mgc: 0.02974911 ustep: 1 
iter: 2  value: 591.1735 mgc: 7.587895e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.8839908 
iter: 1  value: 591.1714 mgc: 0.02974926 ustep: 1 
iter: 2  value: 591.1714 mgc: 7.593845e-07 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.884064 
iter: 1  value: 591.1658 mgc: 0.005329485 ustep: 1 
iter: 2  value: 591.1658 mgc: 2.409302e-08 ustep: 1 
mgc: 3.108624e-14 
outer mgc:  0.003179716 
iter: 1  value: 591.1782 mgc: 0.005328106 ustep: 1 
iter: 2  value: 591.1782 mgc: 2.410599e-08 ustep: 1 
mgc: 2.708944e-14 
outer mgc:  0.003766452 
iter: 1  value: 591.1888 mgc: 0.05211048 ustep: 1 
iter: 2  value: 591.1888 mgc: 2.66575e-06 ustep: 1 
iter: 3  mgc: 3.508305e-14 
outer mgc:  0.3682591 
iter: 1  value: 591.1555 mgc: 0.05226283 ustep: 1 
iter: 2  value: 591.1555 mgc: 2.67234e-06 ustep: 1 
iter: 3  mgc: 5.107026e-14 
outer mgc:  0.3689654 
iter: 1  value: 591.1857 mgc: 0.0502809 ustep: 1 
iter: 2  value: 591.1857 mgc: 1.475721e-06 ustep: 1 
iter: 3  mgc: 6.394885e-14 
outer mgc:  0.3772656 
iter: 1  value: 591.1587 mgc: 0.05042977 ustep: 1 
iter: 2  value: 591.1587 mgc: 1.484431e-06 ustep: 1 
iter: 3  mgc: 6.217249e-14 
outer mgc:  0.3769762 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:57:35 2021]
Finished job 0.
1 of 1 steps (100%) done

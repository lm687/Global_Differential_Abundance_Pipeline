Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 08:32:25 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_80_3_4_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_80_3_4_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_80_3_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22059.036144 
iter  10 value 10901.383667
final  value 10899.371912 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 44610.33 mgc: 161.7549 ustep: 1 
iter: 2  value: 43906.26 mgc: 135.9623 ustep: 0.6827823 
iter: 3  value: 40149.77 mgc: 113.4122 ustep: 0.1964641 
iter: 4  value: 34413.31 mgc: 142.2162 ustep: 0.1361868 
iter: 5  value: 30331.1 mgc: 100.3235 ustep: 0.1087462 
iter: 6  value: 29479.05 mgc: 101.7959 ustep: 0.1813451 
iter: 7  value: 29375.66 mgc: 83.82545 ustep: 0.4259038 
iter: 8  value: 29327.1 mgc: 52.7497 ustep: 0.6526478 
iter: 9  value: 29326.48 mgc: 3.450249 ustep: 0.8078854 
iter: 10  value: 29326.48 mgc: 0.190262 ustep: 0.8988346 
iter: 11  value: 29326.48 mgc: 0.002575108 ustep: 0.9480741 
iter: 12  value: 29326.48 mgc: 1.163755e-05 ustep: 0.9736936 
iter: 13  value: 29326.48 mgc: 2.604235e-08 ustep: 0.9867605 
mgc: 2.917178e-11 
iter: 1  mgc: 2.917178e-11 
Matching hessian patterns... Done
outer mgc:  5520.386 
iter: 1  value: 23617.54 mgc: 30.80217 ustep: 1 
iter: 2  value: 23465.36 mgc: 14.56713 ustep: 1 
iter: 3  value: 23464.26 mgc: 1.400342 ustep: 1 
iter: 4  value: 23464.26 mgc: 0.03758644 ustep: 1 
iter: 5  value: 23464.26 mgc: 2.999374e-05 ustep: 1 
iter: 6  mgc: 2.402589e-11 
iter: 1  value: 14582.04 mgc: 63.23353 ustep: 0.1336527 
iter: 2  value: 9943.104 mgc: 112.3261 ustep: 0.3656489 
iter: 3  value: 9861.261 mgc: 29.50296 ustep: 0.6047286 
iter: 4  value: 9856.519 mgc: 12.6435 ustep: 0.7776652 
iter: 5  value: 9856.484 mgc: 0.725166 ustep: 0.8818651 
iter: 6  value: 9856.484 mgc: 0.01562862 ustep: 0.9390828 
iter: 7  value: 9856.484 mgc: 9.494649e-05 ustep: 0.969066 
iter: 8  value: 9856.484 mgc: 4.142209e-07 ustep: 0.984413 
iter: 9  mgc: 8.347888e-10 
iter: 1  value: 2095.461 mgc: 47.99522 ustep: 0.1336527 
iter: 2  value: 1282.534 mgc: 63.63481 ustep: 0.3656489 
iter: 3  value: 1269.49 mgc: 4.906778 ustep: 0.6047286 
iter: 4  value: 1269.404 mgc: 0.4920169 ustep: 0.7776652 
iter: 5  value: 1269.404 mgc: 0.02054771 ustep: 0.8818651 
iter: 6  value: 1269.404 mgc: 0.0003949305 ustep: 0.9390828 
iter: 7  value: 1269.404 mgc: 3.606726e-06 ustep: 0.969066 
iter: 8  value: 1269.404 mgc: 1.641088e-08 ustep: 0.984413 
mgc: 3.821752e-11 
iter: 1  mgc: 3.821752e-11 
outer mgc:  138.2243 
iter: 1  value: 1434.659 mgc: 35405.38 ustep: 1 
iter: 2  value: 1433.779 mgc: 16.6172 ustep: 1 
iter: 3  value: 1433.779 mgc: 0.0004412042 ustep: 1 
iter: 4  mgc: 5.684342e-14 
iter: 1  value: 936.1464 mgc: 9.236 ustep: 1 
iter: 2  value: 936.0606 mgc: 1.002091 ustep: 1 
iter: 3  value: 936.0606 mgc: 0.009651965 ustep: 1 
iter: 4  value: 936.0606 mgc: 1.041795e-06 ustep: 1 
iter: 5  mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  200.2107 
iter: 1  value: 2997.006 mgc: 53.8174 ustep: 1 
iter: 2  value: 1088.424 mgc: 44.78021 ustep: 1 
iter: 3  value: 994.3976 mgc: 20.22131 ustep: 1 
iter: 4  value: 994.1374 mgc: 1.528741 ustep: 1 
iter: 5  value: 994.1374 mgc: 0.004157664 ustep: 1 
iter: 6  value: 994.1374 mgc: 2.737441e-07 ustep: 1 
iter: 7  mgc: 3.108624e-14 
iter: 1  value: 904.4951 mgc: 28.25027 ustep: 1 
iter: 2  value: 879.9078 mgc: 5.454365 ustep: 1 
iter: 3  value: 879.892 mgc: 0.1428489 ustep: 1 
iter: 4  value: 879.892 mgc: 0.0001681953 ustep: 1 
iter: 5  mgc: 6.832292e-10 
iter: 1  mgc: 6.832292e-10 
outer mgc:  78.81989 
iter: 1  value: 774.9291 mgc: 11.92959 ustep: 1 
iter: 2  value: 771.0162 mgc: 3.13946 ustep: 1 
iter: 3  value: 771.0123 mgc: 0.1873978 ustep: 1 
iter: 4  value: 771.0123 mgc: 0.0007970261 ustep: 1 
iter: 5  value: 771.0123 mgc: 1.458545e-08 ustep: 1 
mgc: 3.996803e-14 
iter: 1  mgc: 3.996803e-14 
outer mgc:  100.8212 
iter: 1  value: 1322.472 mgc: 40.38192 ustep: 1 
iter: 2  value: 897.2388 mgc: 27.67563 ustep: 1 
iter: 3  value: 892.9274 mgc: 2.664983 ustep: 1 
iter: 4  value: 892.9259 mgc: 0.08623105 ustep: 1 
iter: 5  value: 892.9259 mgc: 0.0001123906 ustep: 1 
iter: 6  mgc: 1.855227e-10 
iter: 1  value: 740.8836 mgc: 14.37979 ustep: 1 
iter: 2  value: 738.8089 mgc: 1.675628 ustep: 1 
iter: 3  value: 738.8086 mgc: 0.03190163 ustep: 1 
iter: 4  value: 738.8086 mgc: 1.491254e-05 ustep: 1 
iter: 5  mgc: 3.303136e-12 
iter: 1  mgc: 3.303136e-12 
outer mgc:  53.04571 
iter: 1  value: 707.5651 mgc: 3.616852 ustep: 1 
iter: 2  value: 707.5648 mgc: 0.05130016 ustep: 1 
iter: 3  value: 707.5648 mgc: 2.337647e-05 ustep: 1 
iter: 4  mgc: 6.609546e-12 
iter: 1  value: 692.9367 mgc: 18.38653 ustep: 1 
iter: 2  value: 692.9074 mgc: 0.67022 ustep: 1 
iter: 3  value: 692.9074 mgc: 0.001360811 ustep: 1 
iter: 4  value: 692.9074 mgc: 2.498937e-08 ustep: 1 
mgc: 3.375078e-14 
iter: 1  mgc: 6.609546e-12 
outer mgc:  40.72962 
iter: 1  value: 686.7122 mgc: 5.388347 ustep: 1 
iter: 2  value: 686.708 mgc: 0.09347028 ustep: 1 
iter: 3  value: 686.708 mgc: 5.932803e-05 ustep: 1 
iter: 4  mgc: 2.499512e-11 
iter: 1  mgc: 2.499512e-11 
outer mgc:  60.23925 
iter: 1  value: 695.8545 mgc: 8.411934 ustep: 1 
iter: 2  value: 695.7945 mgc: 0.425405 ustep: 1 
iter: 3  value: 695.7945 mgc: 0.001242842 ustep: 1 
iter: 4  value: 695.7945 mgc: 1.002147e-08 ustep: 1 
mgc: 3.952394e-14 
iter: 1  value: 683.7525 mgc: 4.082597 ustep: 1 
iter: 2  value: 683.7497 mgc: 0.06061187 ustep: 1 
iter: 3  value: 683.7497 mgc: 2.768939e-05 ustep: 1 
iter: 4  mgc: 6.566747e-12 
iter: 1  mgc: 6.566747e-12 
outer mgc:  24.40919 
iter: 1  value: 683.3057 mgc: 1.48672 ustep: 1 
iter: 2  value: 683.3053 mgc: 0.02708032 ustep: 1 
iter: 3  value: 683.3053 mgc: 1.024683e-05 ustep: 1 
iter: 4  mgc: 1.469491e-12 
iter: 1  mgc: 1.469491e-12 
outer mgc:  18.50259 
iter: 1  value: 679.3901 mgc: 1.581478 ustep: 1 
iter: 2  value: 679.3899 mgc: 0.02391562 ustep: 1 
iter: 3  value: 679.3899 mgc: 6.300494e-06 ustep: 1 
iter: 4  mgc: 4.485301e-13 
iter: 1  mgc: 4.485301e-13 
outer mgc:  24.25651 
iter: 1  value: 673.1801 mgc: 4.450797 ustep: 1 
iter: 2  value: 673.1791 mgc: 0.04733194 ustep: 1 
iter: 3  value: 673.1791 mgc: 1.102529e-05 ustep: 1 
iter: 4  mgc: 9.041656e-13 
iter: 1  mgc: 9.041656e-13 
outer mgc:  50.94644 
iter: 1  value: 671.9852 mgc: 3.106837 ustep: 1 
iter: 2  value: 671.9847 mgc: 0.04363664 ustep: 1 
iter: 3  value: 671.9847 mgc: 1.07846e-05 ustep: 1 
iter: 4  mgc: 6.545875e-13 
iter: 1  mgc: 6.545875e-13 
outer mgc:  23.68486 
iter: 1  value: 671.7474 mgc: 1.592857 ustep: 1 
iter: 2  value: 671.7471 mgc: 0.01829438 ustep: 1 
iter: 3  value: 671.7471 mgc: 4.040448e-06 ustep: 1 
iter: 4  mgc: 1.924572e-13 
iter: 1  mgc: 1.924572e-13 
outer mgc:  23.65185 
iter: 1  value: 671.402 mgc: 2.318874 ustep: 1 
iter: 2  value: 671.4019 mgc: 0.02722171 ustep: 1 
iter: 3  value: 671.4019 mgc: 6.501374e-06 ustep: 1 
iter: 4  mgc: 3.623768e-13 
iter: 1  mgc: 3.623768e-13 
outer mgc:  26.15676 
iter: 1  value: 670.2132 mgc: 2.080377 ustep: 1 
iter: 2  value: 670.2131 mgc: 0.02647842 ustep: 1 
iter: 3  value: 670.2131 mgc: 6.262725e-06 ustep: 1 
iter: 4  mgc: 3.481659e-13 
iter: 1  mgc: 3.481659e-13 
outer mgc:  9.548972 
iter: 1  value: 667.4906 mgc: 2.165507 ustep: 1 
iter: 2  value: 667.4906 mgc: 0.01790302 ustep: 1 
iter: 3  value: 667.4906 mgc: 3.228333e-06 ustep: 1 
iter: 4  mgc: 1.012523e-13 
iter: 1  mgc: 1.012523e-13 
outer mgc:  12.73507 
iter: 1  value: 666.7795 mgc: 2.495022 ustep: 1 
iter: 2  value: 666.7793 mgc: 0.02798558 ustep: 1 
iter: 3  value: 666.7793 mgc: 4.125481e-06 ustep: 1 
iter: 4  mgc: 8.737455e-14 
iter: 1  mgc: 8.737455e-14 
outer mgc:  37.14938 
iter: 1  value: 664.0676 mgc: 1.459624 ustep: 1 
iter: 2  value: 664.0675 mgc: 0.007123765 ustep: 1 
iter: 3  value: 664.0675 mgc: 4.900144e-07 ustep: 1 
iter: 4  mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  6.291957 
iter: 1  value: 662.6655 mgc: 0.5943188 ustep: 1 
iter: 2  value: 662.6655 mgc: 0.002538912 ustep: 1 
iter: 3  value: 662.6655 mgc: 6.415698e-08 ustep: 1 
mgc: 3.830269e-14 
iter: 1  value: 661.1005 mgc: 0.9515046 ustep: 1 
iter: 2  value: 661.1005 mgc: 0.003351306 ustep: 1 
iter: 3  value: 661.1005 mgc: 1.245953e-07 ustep: 1 
iter: 4  mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  12.0373 
iter: 1  value: 658.0882 mgc: 2.668533 ustep: 1 
iter: 2  value: 658.0881 mgc: 0.03368483 ustep: 1 
iter: 3  value: 658.0881 mgc: 1.156814e-05 ustep: 1 
iter: 4  mgc: 1.380118e-12 
iter: 1  mgc: 1.380118e-12 
outer mgc:  17.30478 
iter: 1  value: 653.8166 mgc: 1.036176 ustep: 1 
iter: 2  value: 653.8166 mgc: 0.00366546 ustep: 1 
iter: 3  value: 653.8166 mgc: 9.070945e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  value: 649.0001 mgc: 1.361385 ustep: 1 
iter: 2  value: 649.0001 mgc: 0.005684189 ustep: 1 
iter: 3  value: 649.0001 mgc: 1.899396e-07 ustep: 1 
iter: 4  mgc: 3.408385e-14 
iter: 1  mgc: 3.408385e-14 
outer mgc:  8.020617 
iter: 1  value: 657.0214 mgc: 1.506744 ustep: 1 
iter: 2  value: 657.0213 mgc: 0.02292013 ustep: 1 
iter: 3  value: 657.0213 mgc: 5.717037e-06 ustep: 1 
iter: 4  mgc: 4.458656e-13 
iter: 1  value: 652.0772 mgc: 0.8261438 ustep: 1 
iter: 2  value: 652.0772 mgc: 0.003671879 ustep: 1 
iter: 3  value: 652.0772 mgc: 2.139392e-07 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  4.435497 
iter: 1  value: 651.789 mgc: 0.9064059 ustep: 1 
iter: 2  value: 651.789 mgc: 0.004671533 ustep: 1 
iter: 3  value: 651.789 mgc: 1.676784e-07 ustep: 1 
mgc: 3.330669e-14 
iter: 1  value: 651.8839 mgc: 0.364874 ustep: 1 
iter: 2  value: 651.8839 mgc: 0.0003555935 ustep: 1 
iter: 3  mgc: 1.114667e-09 
iter: 1  mgc: 1.114667e-09 
outer mgc:  1.950089 
iter: 1  value: 651.3607 mgc: 0.409151 ustep: 1 
iter: 2  value: 651.3607 mgc: 0.0004863594 ustep: 1 
iter: 3  mgc: 2.382769e-09 
iter: 1  mgc: 2.382769e-09 
outer mgc:  5.132903 
iter: 1  value: 650.9512 mgc: 0.2935195 ustep: 1 
iter: 2  value: 650.9512 mgc: 0.0002450193 ustep: 1 
iter: 3  mgc: 1.742491e-10 
iter: 1  mgc: 1.742491e-10 
outer mgc:  1.752934 
iter: 1  value: 650.6383 mgc: 0.1900215 ustep: 1 
iter: 2  value: 650.6383 mgc: 0.0001274626 ustep: 1 
iter: 3  mgc: 1.279856e-10 
iter: 1  mgc: 1.279856e-10 
outer mgc:  0.6684707 
iter: 1  value: 650.4993 mgc: 0.04527297 ustep: 1 
iter: 2  value: 650.4993 mgc: 5.67291e-06 ustep: 1 
iter: 3  mgc: 1.945111e-13 
iter: 1  value: 650.1333 mgc: 0.1084584 ustep: 1 
iter: 2  value: 650.1333 mgc: 5.190331e-05 ustep: 1 
iter: 3  mgc: 1.42828e-11 
iter: 1  mgc: 1.42828e-11 
outer mgc:  1.232783 
iter: 1  value: 649.9546 mgc: 0.11453 ustep: 1 
iter: 2  value: 649.9546 mgc: 6.821993e-05 ustep: 1 
iter: 3  mgc: 1.550293e-11 
iter: 1  mgc: 1.550293e-11 
outer mgc:  0.4402004 
iter: 1  value: 650.0647 mgc: 0.04432779 ustep: 1 
iter: 2  value: 650.0647 mgc: 7.404135e-06 ustep: 1 
iter: 3  mgc: 4.33209e-13 
iter: 1  mgc: 4.33209e-13 
outer mgc:  0.0821326 
iter: 1  value: 650.1382 mgc: 0.02641567 ustep: 1 
iter: 2  value: 650.1382 mgc: 2.338398e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.07591556 
iter: 1  value: 650.2316 mgc: 0.02849858 ustep: 1 
iter: 2  value: 650.2316 mgc: 2.088481e-06 ustep: 1 
iter: 3  mgc: 3.708145e-14 
iter: 1  mgc: 3.708145e-14 
outer mgc:  0.05014466 
iter: 1  value: 650.2301 mgc: 0.002645404 ustep: 1 
iter: 2  value: 650.2301 mgc: 7.112977e-08 ustep: 1 
iter: 3  mgc: 4.72955e-14 
iter: 1  mgc: 4.72955e-14 
outer mgc:  0.01542005 
iter: 1  value: 650.2296 mgc: 0.0009846629 ustep: 1 
iter: 2  mgc: 6.033566e-09 
iter: 1  mgc: 6.033566e-09 
outer mgc:  0.0007449934 
iter: 1  value: 650.2293 mgc: 0.0001348923 ustep: 1 
iter: 2  mgc: 4.828937e-11 
iter: 1  mgc: 4.828937e-11 
outer mgc:  3.800582e-05 
iter: 1  mgc: 4.828937e-11 
iter: 1  mgc: 4.828937e-11 
outer mgc:  3.800582e-05 
iter: 1  value: 650.2256 mgc: 0.0245532 ustep: 1 
iter: 2  value: 650.2256 mgc: 1.992274e-06 ustep: 1 
iter: 3  mgc: 3.641532e-14 
outer mgc:  0.7885601 
iter: 1  value: 650.2337 mgc: 0.02454358 ustep: 1 
iter: 2  value: 650.2337 mgc: 1.993909e-06 ustep: 1 
iter: 3  mgc: 4.152234e-14 
outer mgc:  0.7884417 
iter: 1  value: 650.2289 mgc: 0.0004301379 ustep: 1 
iter: 2  mgc: 6.296905e-10 
outer mgc:  0.02960998 
iter: 1  value: 650.2297 mgc: 0.0004297116 ustep: 1 
iter: 2  mgc: 6.283849e-10 
outer mgc:  0.02958304 
iter: 1  value: 650.2343 mgc: 0.03183577 ustep: 1 
iter: 2  value: 650.2343 mgc: 2.064639e-06 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  0.8559318 
iter: 1  value: 650.2251 mgc: 0.03183386 ustep: 1 
iter: 2  value: 650.2251 mgc: 2.066109e-06 ustep: 1 
iter: 3  mgc: 3.574918e-14 
outer mgc:  0.8559622 
iter: 1  value: 650.2298 mgc: 0.0004951144 ustep: 1 
iter: 2  mgc: 6.3317e-10 
outer mgc:  0.03253393 
iter: 1  value: 650.2288 mgc: 0.0004956055 ustep: 1 
iter: 2  mgc: 6.343095e-10 
outer mgc:  0.03256351 
iter: 1  value: 650.2083 mgc: 0.00574322 ustep: 1 
iter: 2  value: 650.2083 mgc: 7.671312e-08 ustep: 1 
iter: 3  mgc: 3.569367e-14 
outer mgc:  0.008698695 
iter: 1  value: 650.2503 mgc: 0.00574063 ustep: 1 
iter: 2  value: 650.2503 mgc: 7.676432e-08 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.00863056 
iter: 1  value: 650.271 mgc: 0.02606962 ustep: 1 
iter: 2  value: 650.271 mgc: 3.52503e-06 ustep: 1 
iter: 3  mgc: 9.681145e-14 
outer mgc:  0.2555174 
iter: 1  value: 650.1877 mgc: 0.02613929 ustep: 1 
iter: 2  value: 650.1877 mgc: 3.529422e-06 ustep: 1 
iter: 3  mgc: 9.05942e-14 
outer mgc:  0.2554355 
iter: 1  value: 650.256 mgc: 0.03549041 ustep: 1 
iter: 2  value: 650.256 mgc: 3.712693e-06 ustep: 1 
iter: 3  mgc: 1.385558e-13 
outer mgc:  0.2896619 
iter: 1  value: 650.2028 mgc: 0.0355848 ustep: 1 
iter: 2  value: 650.2028 mgc: 3.722383e-06 ustep: 1 
iter: 3  mgc: 1.412204e-13 
outer mgc:  0.2898955 
[Mon Aug 16 08:32:27 2021]
Finished job 0.
1 of 1 steps (100%) done

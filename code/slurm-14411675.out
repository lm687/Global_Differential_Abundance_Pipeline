Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:52:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4501.014547 
final  value 4153.441224 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1107.333 mgc: 64.80906 ustep: 1 
iter: 2  value: 1084.921 mgc: 21.81998 ustep: 1 
iter: 3  value: 1084.684 mgc: 2.214246 ustep: 1 
iter: 4  value: 1084.683 mgc: 0.04073356 ustep: 1 
iter: 5  value: 1084.683 mgc: 0.0001122856 ustep: 1 
iter: 6  mgc: 7.862486e-10 
iter: 1  mgc: 7.862486e-10 
Matching hessian patterns... Done
outer mgc:  378.012 
iter: 1  value: 782.628 mgc: 24.69264 ustep: 1 
iter: 2  value: 782.4072 mgc: 1.432283 ustep: 1 
iter: 3  value: 782.4072 mgc: 0.01321049 ustep: 1 
iter: 4  value: 782.4072 mgc: 1.691516e-06 ustep: 1 
iter: 5  mgc: 4.646283e-14 
iter: 1  value: 652.3942 mgc: 38.44739 ustep: 1 
iter: 2  value: 650.0394 mgc: 3.882727 ustep: 1 
iter: 3  value: 650.0366 mgc: 0.1900981 ustep: 1 
iter: 4  value: 650.0366 mgc: 0.0005452952 ustep: 1 
iter: 5  mgc: 4.715735e-09 
iter: 1  mgc: 4.715735e-09 
outer mgc:  263.4734 
iter: 1  value: 906.7442 mgc: 70.70372 ustep: 1 
iter: 2  value: 759.5102 mgc: 37.10914 ustep: 1 
iter: 3  value: 757.4891 mgc: 5.109386 ustep: 1 
iter: 4  value: 757.4865 mgc: 0.2432759 ustep: 1 
iter: 5  value: 757.4865 mgc: 0.000664205 ustep: 1 
iter: 6  mgc: 4.988978e-09 
iter: 1  value: 518.4258 mgc: 37.34796 ustep: 1 
iter: 2  value: 513.943 mgc: 5.949054 ustep: 1 
iter: 3  value: 513.9377 mgc: 0.3297575 ustep: 1 
iter: 4  value: 513.9377 mgc: 0.001258513 ustep: 1 
iter: 5  value: 513.9377 mgc: 1.859958e-08 ustep: 1 
mgc: 3.164136e-14 
iter: 1  mgc: 3.164136e-14 
outer mgc:  104.9761 
iter: 1  value: 487.7974 mgc: 23.66169 ustep: 1 
iter: 2  value: 487.246 mgc: 1.954885 ustep: 1 
iter: 3  value: 487.2458 mgc: 0.05079658 ustep: 1 
iter: 4  value: 487.2458 mgc: 3.761054e-05 ustep: 1 
iter: 5  mgc: 2.652789e-11 
iter: 1  mgc: 2.652789e-11 
outer mgc:  110.7361 
iter: 1  value: 547.0292 mgc: 55.11089 ustep: 1 
iter: 2  value: 463.5872 mgc: 27.70877 ustep: 1 
iter: 3  value: 462.6854 mgc: 3.396249 ustep: 1 
iter: 4  value: 462.6848 mgc: 0.1172388 ustep: 1 
iter: 5  value: 462.6848 mgc: 0.0001579108 ustep: 1 
iter: 6  mgc: 2.880057e-10 
iter: 1  mgc: 2.880057e-10 
outer mgc:  81.64755 
iter: 1  value: 441.9762 mgc: 28.61076 ustep: 1 
iter: 2  value: 439.9829 mgc: 4.546042 ustep: 1 
iter: 3  value: 439.9819 mgc: 0.1162547 ustep: 1 
iter: 4  value: 439.9819 mgc: 0.0001385069 ustep: 1 
iter: 5  mgc: 1.97484e-10 
iter: 1  mgc: 1.97484e-10 
outer mgc:  29.75108 
iter: 1  value: 554.62 mgc: 67.12836 ustep: 1 
iter: 2  value: 519.1554 mgc: 21.72 ustep: 1 
iter: 3  value: 519.0857 mgc: 0.9638476 ustep: 1 
iter: 4  value: 519.0857 mgc: 0.006111649 ustep: 1 
iter: 5  value: 519.0857 mgc: 2.595958e-07 ustep: 1 
mgc: 3.508305e-14 
iter: 1  value: 435.1953 mgc: 14.53666 ustep: 1 
iter: 2  value: 435.168 mgc: 0.4269467 ustep: 1 
iter: 3  value: 435.168 mgc: 0.001234127 ustep: 1 
iter: 4  value: 435.168 mgc: 1.506024e-08 ustep: 1 
mgc: 2.198242e-14 
iter: 1  mgc: 2.198242e-14 
outer mgc:  17.38446 
iter: 1  value: 433.5545 mgc: 4.362484 ustep: 1 
iter: 2  value: 433.5512 mgc: 0.172259 ustep: 1 
iter: 3  value: 433.5512 mgc: 0.0005405834 ustep: 1 
iter: 4  mgc: 5.384049e-09 
iter: 1  mgc: 5.384049e-09 
outer mgc:  12.8727 
iter: 1  value: 432.9507 mgc: 11.51787 ustep: 1 
iter: 2  value: 432.9432 mgc: 0.3400973 ustep: 1 
iter: 3  value: 432.9432 mgc: 0.0005450495 ustep: 1 
iter: 4  mgc: 1.381583e-09 
iter: 1  mgc: 1.381583e-09 
outer mgc:  7.786981 
iter: 1  value: 432.4815 mgc: 8.183641 ustep: 1 
iter: 2  value: 432.4742 mgc: 0.2394605 ustep: 1 
iter: 3  value: 432.4742 mgc: 0.000329092 ustep: 1 
iter: 4  mgc: 1.293454e-09 
iter: 1  mgc: 1.293454e-09 
outer mgc:  2.895304 
iter: 1  value: 433.7567 mgc: 2.329469 ustep: 1 
iter: 2  value: 433.7567 mgc: 0.012969 ustep: 1 
iter: 3  value: 433.7567 mgc: 1.720998e-06 ustep: 1 
iter: 4  mgc: 6.17284e-14 
iter: 1  value: 432.4328 mgc: 0.7225443 ustep: 1 
iter: 2  value: 432.4328 mgc: 0.001505299 ustep: 1 
iter: 3  mgc: 8.751493e-09 
iter: 1  mgc: 8.751493e-09 
outer mgc:  2.246374 
iter: 1  value: 432.4332 mgc: 1.913012 ustep: 1 
iter: 2  value: 432.4332 mgc: 0.01220094 ustep: 1 
iter: 3  value: 432.4332 mgc: 9.748794e-07 ustep: 1 
iter: 4  mgc: 3.819167e-14 
iter: 1  value: 432.4126 mgc: 0.8904152 ustep: 1 
iter: 2  value: 432.4126 mgc: 0.002436063 ustep: 1 
iter: 3  value: 432.4126 mgc: 4.702681e-08 ustep: 1 
mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  1.42501 
iter: 1  value: 432.4072 mgc: 0.2594385 ustep: 1 
iter: 2  value: 432.4072 mgc: 0.0001230146 ustep: 1 
iter: 3  mgc: 6.230616e-11 
iter: 1  mgc: 6.230616e-11 
outer mgc:  0.3068877 
iter: 1  value: 432.4093 mgc: 0.3084872 ustep: 1 
iter: 2  value: 432.4093 mgc: 0.0003571488 ustep: 1 
iter: 3  mgc: 1.24851e-09 
iter: 1  mgc: 1.24851e-09 
outer mgc:  0.6537471 
iter: 1  value: 432.4031 mgc: 0.1831067 ustep: 1 
iter: 2  value: 432.4031 mgc: 0.0001070688 ustep: 1 
iter: 3  mgc: 1.070783e-10 
iter: 1  mgc: 1.070783e-10 
outer mgc:  0.1875448 
iter: 1  value: 432.3853 mgc: 0.2316622 ustep: 1 
iter: 2  value: 432.3853 mgc: 0.0001049104 ustep: 1 
iter: 3  mgc: 4.957335e-11 
iter: 1  mgc: 4.957335e-11 
outer mgc:  0.4862364 
iter: 1  value: 432.3873 mgc: 0.1389532 ustep: 1 
iter: 2  value: 432.3873 mgc: 6.209252e-05 ustep: 1 
iter: 3  mgc: 1.788369e-11 
iter: 1  mgc: 1.788369e-11 
outer mgc:  0.2215616 
iter: 1  value: 432.3926 mgc: 0.1148358 ustep: 1 
iter: 2  value: 432.3926 mgc: 9.178622e-05 ustep: 1 
iter: 3  mgc: 1.567622e-10 
iter: 1  mgc: 1.567622e-10 
outer mgc:  0.647633 
iter: 1  value: 432.3941 mgc: 0.2490757 ustep: 1 
iter: 2  value: 432.3941 mgc: 0.0001285058 ustep: 1 
iter: 3  mgc: 1.370546e-10 
iter: 1  mgc: 1.370546e-10 
outer mgc:  0.1251777 
iter: 1  value: 432.3873 mgc: 0.1941169 ustep: 1 
iter: 2  value: 432.3873 mgc: 0.0004029835 ustep: 1 
iter: 3  mgc: 1.056719e-09 
iter: 1  mgc: 1.056719e-09 
outer mgc:  0.1425342 
iter: 1  value: 432.3877 mgc: 0.1257471 ustep: 1 
iter: 2  value: 432.3877 mgc: 7.849611e-05 ustep: 1 
iter: 3  mgc: 2.401057e-11 
iter: 1  mgc: 2.401057e-11 
outer mgc:  0.09124142 
iter: 1  value: 432.396 mgc: 0.1238493 ustep: 1 
iter: 2  value: 432.396 mgc: 4.865423e-05 ustep: 1 
iter: 3  mgc: 2.788414e-11 
iter: 1  value: 432.3896 mgc: 0.06831503 ustep: 1 
iter: 2  value: 432.3896 mgc: 7.541429e-06 ustep: 1 
iter: 3  mgc: 2.535749e-13 
iter: 1  mgc: 2.535749e-13 
outer mgc:  0.09615218 
iter: 1  value: 432.3908 mgc: 0.03271371 ustep: 1 
iter: 2  value: 432.3908 mgc: 3.289128e-06 ustep: 1 
iter: 3  mgc: 8.526513e-14 
iter: 1  mgc: 8.526513e-14 
outer mgc:  0.01754566 
iter: 1  value: 432.3889 mgc: 0.02319433 ustep: 1 
iter: 2  value: 432.3889 mgc: 2.98789e-06 ustep: 1 
iter: 3  mgc: 1.056932e-13 
iter: 1  mgc: 1.056932e-13 
outer mgc:  0.02736236 
iter: 1  value: 432.3895 mgc: 0.007994857 ustep: 1 
iter: 2  value: 432.3895 mgc: 6.738753e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
iter: 1  mgc: 3.28626e-14 
outer mgc:  0.002452769 
iter: 1  value: 432.3895 mgc: 0.002131271 ustep: 1 
iter: 2  value: 432.3895 mgc: 1.8557e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  0.0007432911 
iter: 1  value: 432.3895 mgc: 0.0005620734 ustep: 1 
iter: 2  mgc: 1.419119e-09 
iter: 1  mgc: 1.419119e-09 
outer mgc:  0.0001045911 
iter: 1  mgc: 1.419119e-09 
iter: 1  mgc: 1.419119e-09 
outer mgc:  0.0001045911 
iter: 1  value: 432.3899 mgc: 0.06221383 ustep: 1 
iter: 2  value: 432.3899 mgc: 6.230288e-06 ustep: 1 
iter: 3  mgc: 1.700862e-13 
outer mgc:  0.07834462 
iter: 1  value: 432.3892 mgc: 0.06221711 ustep: 1 
iter: 2  value: 432.3892 mgc: 6.244513e-06 ustep: 1 
iter: 3  mgc: 1.776357e-13 
outer mgc:  0.07837281 
iter: 1  value: 432.3906 mgc: 0.03171076 ustep: 1 
iter: 2  value: 432.3906 mgc: 2.261081e-06 ustep: 1 
iter: 3  mgc: 4.418688e-14 
outer mgc:  0.2361895 
iter: 1  value: 432.3887 mgc: 0.03170963 ustep: 1 
iter: 2  value: 432.3887 mgc: 2.26464e-06 ustep: 1 
iter: 3  mgc: 4.563017e-14 
outer mgc:  0.2360826 
iter: 1  value: 432.3893 mgc: 0.05469302 ustep: 1 
iter: 2  value: 432.3893 mgc: 1.009529e-05 ustep: 1 
iter: 3  mgc: 5.457856e-13 
outer mgc:  0.05527069 
iter: 1  value: 432.3898 mgc: 0.05468855 ustep: 1 
iter: 2  value: 432.3898 mgc: 1.010773e-05 ustep: 1 
iter: 3  mgc: 5.562217e-13 
outer mgc:  0.05524293 
iter: 1  value: 432.39 mgc: 0.02734329 ustep: 1 
iter: 2  value: 432.39 mgc: 3.974e-06 ustep: 1 
iter: 3  mgc: 1.409983e-13 
outer mgc:  0.1837668 
iter: 1  value: 432.3893 mgc: 0.02734535 ustep: 1 
iter: 2  value: 432.3893 mgc: 3.977767e-06 ustep: 1 
iter: 3  mgc: 1.29452e-13 
outer mgc:  0.1839906 
iter: 1  value: 432.3884 mgc: 0.003584464 ustep: 1 
iter: 2  value: 432.3884 mgc: 5.762491e-08 ustep: 1 
mgc: 2.087219e-14 
outer mgc:  0.008167058 
iter: 1  value: 432.3906 mgc: 0.003582303 ustep: 1 
iter: 2  value: 432.3906 mgc: 5.758174e-08 ustep: 1 
mgc: 2.78666e-14 
outer mgc:  0.008182537 
iter: 1  value: 432.3913 mgc: 0.01134841 ustep: 1 
iter: 2  value: 432.3913 mgc: 5.423228e-07 ustep: 1 
iter: 3  mgc: 1.731948e-14 
outer mgc:  0.07252155 
iter: 1  value: 432.3878 mgc: 0.011377 ustep: 1 
iter: 2  value: 432.3878 mgc: 5.458154e-07 ustep: 1 
iter: 3  mgc: 2.708944e-14 
outer mgc:  0.07266823 
iter: 1  value: 432.3912 mgc: 0.008315891 ustep: 1 
iter: 2  value: 432.3912 mgc: 1.244824e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.0735485 
iter: 1  value: 432.3879 mgc: 0.008333926 ustep: 1 
iter: 2  value: 432.3879 mgc: 1.249328e-06 ustep: 1 
iter: 3  mgc: 3.530509e-14 
outer mgc:  0.07365913 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:52:16 2021]
Finished job 0.
1 of 1 steps (100%) done

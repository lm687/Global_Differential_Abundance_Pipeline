Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:58:57 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21961.259650 
iter  10 value 18857.566127
final  value 18857.437979 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 10143.79 mgc: 107.2303 ustep: 1 
iter: 2  value: 10013.55 mgc: 20.69213 ustep: 1 
iter: 3  value: 10007.91 mgc: 2.793635 ustep: 1 
iter: 4  value: 10007.47 mgc: 0.7823917 ustep: 1 
iter: 5  value: 10007.46 mgc: 0.1237571 ustep: 1 
iter: 6  value: 10007.46 mgc: 0.004748662 ustep: 1 
iter: 7  value: 10007.46 mgc: 7.704574e-06 ustep: 1 
iter: 8  mgc: 2.035545e-11 
iter: 1  mgc: 2.035545e-11 
Matching hessian patterns... Done
outer mgc:  3703.893 
iter: 1  value: 6477.792 mgc: 40.1046 ustep: 1 
iter: 2  value: 6466.3 mgc: 11.66237 ustep: 1 
iter: 3  value: 6466.273 mgc: 1.069171 ustep: 1 
iter: 4  value: 6466.273 mgc: 0.01317666 ustep: 1 
iter: 5  value: 6466.273 mgc: 2.106121e-06 ustep: 1 
iter: 6  mgc: 5.906386e-14 
iter: 1  value: 4942.891 mgc: 72.94475 ustep: 1 
iter: 2  value: 4606.017 mgc: 45.69896 ustep: 1 
iter: 3  value: 4605.046 mgc: 3.829957 ustep: 1 
iter: 4  value: 4605.046 mgc: 0.1476464 ustep: 1 
iter: 5  value: 4605.046 mgc: 0.0002573631 ustep: 1 
iter: 6  mgc: 7.868342e-10 
iter: 1  mgc: 7.868342e-10 
outer mgc:  1919.186 
iter: 1  value: 2605.552 mgc: 69.69317 ustep: 1 
iter: 2  value: 2376.446 mgc: 44.03241 ustep: 1 
iter: 3  value: 2376.27 mgc: 2.233663 ustep: 1 
iter: 4  value: 2376.27 mgc: 0.04664036 ustep: 1 
iter: 5  value: 2376.27 mgc: 2.350943e-05 ustep: 1 
iter: 6  mgc: 5.995759e-12 
iter: 1  mgc: 5.995759e-12 
outer mgc:  1003.39 
iter: 1  value: 3349.788 mgc: 66.90254 ustep: 1 
iter: 2  value: 3212.287 mgc: 19.55528 ustep: 1 
iter: 3  value: 3211.879 mgc: 1.851867 ustep: 1 
iter: 4  value: 3211.879 mgc: 0.03761312 ustep: 1 
iter: 5  value: 3211.879 mgc: 1.648733e-05 ustep: 1 
iter: 6  mgc: 3.165024e-12 
iter: 1  value: 2280.876 mgc: 46.54076 ustep: 1 
iter: 2  value: 2226.711 mgc: 13.35469 ustep: 1 
iter: 3  value: 2226.608 mgc: 1.029253 ustep: 1 
iter: 4  value: 2226.608 mgc: 0.01191556 ustep: 1 
iter: 5  value: 2226.608 mgc: 1.668452e-06 ustep: 1 
iter: 6  mgc: 4.399259e-14 
iter: 1  mgc: 4.399259e-14 
outer mgc:  864.1993 
iter: 1  value: 1801.312 mgc: 40.82238 ustep: 1 
iter: 2  value: 1775.728 mgc: 11.24029 ustep: 1 
iter: 3  value: 1775.702 mgc: 0.7152697 ustep: 1 
iter: 4  value: 1775.702 mgc: 0.003816734 ustep: 1 
iter: 5  value: 1775.702 mgc: 1.81631e-07 ustep: 1 
iter: 6  mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  82.50929 
iter: 1  value: 2179.43 mgc: 53.64839 ustep: 1 
iter: 2  value: 2126.063 mgc: 13.12421 ustep: 1 
iter: 3  value: 2125.828 mgc: 1.379225 ustep: 1 
iter: 4  value: 2125.828 mgc: 0.02404813 ustep: 1 
iter: 5  value: 2125.828 mgc: 1.302652e-05 ustep: 1 
iter: 6  mgc: 3.311129e-12 
iter: 1  value: 1773.113 mgc: 10.52774 ustep: 1 
iter: 2  value: 1773.07 mgc: 0.3204517 ustep: 1 
iter: 3  value: 1773.07 mgc: 0.0007741341 ustep: 1 
iter: 4  mgc: 5.464535e-09 
iter: 1  mgc: 5.464535e-09 
outer mgc:  154.3648 
iter: 1  value: 1762.84 mgc: 9.163367 ustep: 1 
iter: 2  value: 1762.826 mgc: 0.2241061 ustep: 1 
iter: 3  value: 1762.826 mgc: 0.000299783 ustep: 1 
iter: 4  mgc: 6.745142e-10 
iter: 1  mgc: 6.745142e-10 
outer mgc:  110.5079 
iter: 1  value: 1753.162 mgc: 3.06004 ustep: 1 
iter: 2  value: 1753.153 mgc: 0.05954859 ustep: 1 
iter: 3  value: 1753.153 mgc: 0.0001209002 ustep: 1 
iter: 4  mgc: 1.405183e-09 
iter: 1  mgc: 1.405183e-09 
outer mgc:  39.95325 
iter: 1  value: 1747.98 mgc: 3.219384 ustep: 1 
iter: 2  value: 1747.974 mgc: 0.04530331 ustep: 1 
iter: 3  value: 1747.974 mgc: 6.88775e-05 ustep: 1 
iter: 4  mgc: 4.673164e-10 
iter: 1  mgc: 4.673164e-10 
outer mgc:  60.65248 
iter: 1  value: 1752.513 mgc: 6.856793 ustep: 1 
iter: 2  value: 1752.297 mgc: 0.4457435 ustep: 1 
iter: 3  value: 1752.297 mgc: 0.0026944 ustep: 1 
iter: 4  value: 1752.297 mgc: 2.171278e-07 ustep: 1 
iter: 5  mgc: 4.973799e-14 
iter: 1  value: 1748.263 mgc: 3.846186 ustep: 1 
iter: 2  value: 1748.26 mgc: 0.07261994 ustep: 1 
iter: 3  value: 1748.26 mgc: 2.350753e-05 ustep: 1 
iter: 4  mgc: 1.75846e-11 
iter: 1  mgc: 1.75846e-11 
outer mgc:  80.40157 
iter: 1  value: 1745.556 mgc: 4.452917 ustep: 1 
iter: 2  value: 1745.555 mgc: 0.06596207 ustep: 1 
iter: 3  value: 1745.555 mgc: 2.777433e-05 ustep: 1 
iter: 4  mgc: 7.215561e-12 
iter: 1  mgc: 7.215561e-12 
outer mgc:  18.57361 
iter: 1  value: 1745.732 mgc: 4.386936 ustep: 1 
iter: 2  value: 1745.731 mgc: 0.04295732 ustep: 1 
iter: 3  value: 1745.731 mgc: 6.071268e-06 ustep: 1 
iter: 4  mgc: 1.945111e-13 
iter: 1  value: 1745.23 mgc: 2.059111 ustep: 1 
iter: 2  value: 1745.229 mgc: 0.009665492 ustep: 1 
iter: 3  value: 1745.229 mgc: 4.482731e-07 ustep: 1 
iter: 4  mgc: 5.218048e-14 
iter: 1  mgc: 5.218048e-14 
outer mgc:  16.69685 
iter: 1  value: 1744.855 mgc: 0.7886287 ustep: 1 
iter: 2  value: 1744.855 mgc: 0.002664106 ustep: 1 
iter: 3  value: 1744.855 mgc: 4.913279e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  20.68669 
iter: 1  value: 1744.581 mgc: 0.4188878 ustep: 1 
iter: 2  value: 1744.581 mgc: 0.0006430461 ustep: 1 
iter: 3  value: 1744.581 mgc: 1.345297e-08 ustep: 1 
mgc: 4.352074e-14 
iter: 1  mgc: 4.352074e-14 
outer mgc:  8.264638 
iter: 1  value: 1744.752 mgc: 0.4060553 ustep: 1 
iter: 2  value: 1744.752 mgc: 0.001170706 ustep: 1 
iter: 3  mgc: 8.346812e-09 
iter: 1  mgc: 8.346812e-09 
outer mgc:  8.643692 
iter: 1  value: 1744.904 mgc: 2.081055 ustep: 1 
iter: 2  value: 1744.904 mgc: 0.01264264 ustep: 1 
iter: 3  value: 1744.904 mgc: 3.874207e-06 ustep: 1 
iter: 4  mgc: 1.417533e-12 
iter: 1  value: 1744.728 mgc: 0.6522388 ustep: 1 
iter: 2  value: 1744.728 mgc: 0.0009552612 ustep: 1 
iter: 3  mgc: 6.685471e-09 
iter: 1  mgc: 6.685471e-09 
outer mgc:  10.25554 
iter: 1  value: 1744.533 mgc: 0.4864703 ustep: 1 
iter: 2  value: 1744.533 mgc: 0.00086886 ustep: 1 
iter: 3  mgc: 5.225104e-09 
iter: 1  mgc: 5.225104e-09 
outer mgc:  2.502394 
iter: 1  value: 1744.449 mgc: 0.4544327 ustep: 1 
iter: 2  value: 1744.449 mgc: 0.000438806 ustep: 1 
iter: 3  mgc: 1.098845e-09 
iter: 1  mgc: 1.098845e-09 
outer mgc:  6.467834 
iter: 1  value: 1744.602 mgc: 0.7015056 ustep: 1 
iter: 2  value: 1744.602 mgc: 0.001769333 ustep: 1 
iter: 3  value: 1744.602 mgc: 2.479261e-08 ustep: 1 
mgc: 4.840572e-14 
iter: 1  mgc: 4.840572e-14 
outer mgc:  2.29032 
iter: 1  value: 1744.555 mgc: 0.6414142 ustep: 1 
iter: 2  value: 1744.555 mgc: 0.001597528 ustep: 1 
iter: 3  value: 1744.555 mgc: 2.07018e-08 ustep: 1 
mgc: 5.206946e-14 
iter: 1  value: 1744.555 mgc: 0.1716521 ustep: 1 
iter: 2  value: 1744.555 mgc: 0.0001140195 ustep: 1 
iter: 3  mgc: 1.058744e-10 
iter: 1  mgc: 1.058744e-10 
outer mgc:  2.263888 
iter: 1  value: 1744.514 mgc: 0.2403347 ustep: 1 
iter: 2  value: 1744.514 mgc: 0.000226379 ustep: 1 
iter: 3  mgc: 4.032357e-10 
iter: 1  mgc: 4.032357e-10 
outer mgc:  3.632291 
iter: 1  value: 1744.482 mgc: 0.1434703 ustep: 1 
iter: 2  value: 1744.482 mgc: 7.342405e-05 ustep: 1 
iter: 3  mgc: 3.685141e-11 
iter: 1  mgc: 3.685141e-11 
outer mgc:  0.574744 
iter: 1  value: 1744.455 mgc: 0.09659633 ustep: 1 
iter: 2  value: 1744.455 mgc: 2.28775e-05 ustep: 1 
iter: 3  mgc: 4.125589e-12 
iter: 1  mgc: 4.125589e-12 
outer mgc:  0.6939207 
iter: 1  value: 1744.447 mgc: 0.04462569 ustep: 1 
iter: 2  value: 1744.447 mgc: 4.546201e-06 ustep: 1 
iter: 3  mgc: 7.81597e-14 
iter: 1  mgc: 7.81597e-14 
outer mgc:  0.5942143 
iter: 1  value: 1744.443 mgc: 0.06151973 ustep: 1 
iter: 2  value: 1744.443 mgc: 1.556573e-05 ustep: 1 
iter: 3  mgc: 1.956657e-12 
iter: 1  value: 1744.449 mgc: 0.03628649 ustep: 1 
iter: 2  value: 1744.449 mgc: 3.760326e-06 ustep: 1 
iter: 3  mgc: 9.325873e-14 
iter: 1  mgc: 9.325873e-14 
outer mgc:  0.3891794 
iter: 1  value: 1744.445 mgc: 0.01753327 ustep: 1 
iter: 2  value: 1744.445 mgc: 7.347791e-07 ustep: 1 
iter: 3  mgc: 4.246603e-14 
iter: 1  mgc: 4.246603e-14 
outer mgc:  0.1126442 
iter: 1  value: 1744.449 mgc: 0.01797112 ustep: 1 
iter: 2  value: 1744.449 mgc: 1.195024e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.1040499 
iter: 1  value: 1744.444 mgc: 0.01711877 ustep: 1 
iter: 2  value: 1744.444 mgc: 7.921021e-07 ustep: 1 
iter: 3  mgc: 4.257705e-14 
iter: 1  mgc: 4.257705e-14 
outer mgc:  0.07592479 
iter: 1  value: 1744.447 mgc: 0.003604238 ustep: 1 
iter: 2  value: 1744.447 mgc: 5.361312e-08 ustep: 1 
iter: 3  mgc: 4.549139e-14 
iter: 1  mgc: 4.549139e-14 
outer mgc:  0.112334 
iter: 1  value: 1744.453 mgc: 0.01327505 ustep: 1 
iter: 2  value: 1744.453 mgc: 8.594214e-07 ustep: 1 
iter: 3  mgc: 4.463097e-14 
iter: 1  value: 1744.447 mgc: 0.007228435 ustep: 1 
iter: 2  value: 1744.447 mgc: 1.566994e-07 ustep: 1 
iter: 3  mgc: 4.596323e-14 
iter: 1  value: 1744.447 mgc: 0.003311398 ustep: 1 
iter: 2  value: 1744.447 mgc: 3.288779e-08 ustep: 1 
mgc: 4.840572e-14 
iter: 1  mgc: 4.840572e-14 
outer mgc:  0.02769215 
iter: 1  value: 1744.447 mgc: 0.003823412 ustep: 1 
iter: 2  value: 1744.447 mgc: 4.35872e-08 ustep: 1 
mgc: 4.496403e-14 
iter: 1  mgc: 4.496403e-14 
outer mgc:  0.02317407 
iter: 1  value: 1744.449 mgc: 0.002383683 ustep: 1 
iter: 2  value: 1744.449 mgc: 3.091376e-08 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.00930346 
iter: 1  value: 1744.448 mgc: 0.0008764451 ustep: 1 
iter: 2  mgc: 8.985285e-09 
iter: 1  mgc: 8.985285e-09 
outer mgc:  0.007075915 
iter: 1  value: 1744.448 mgc: 0.001793852 ustep: 1 
iter: 2  mgc: 8.870734e-09 
iter: 1  mgc: 8.870734e-09 
outer mgc:  0.0199212 
iter: 1  value: 1744.448 mgc: 0.001442806 ustep: 1 
iter: 2  mgc: 8.779887e-09 
iter: 1  mgc: 8.779887e-09 
outer mgc:  0.002995839 
iter: 1  value: 1744.448 mgc: 0.0006612403 ustep: 1 
iter: 2  mgc: 1.336955e-09 
iter: 1  mgc: 8.779887e-09 
iter: 1  mgc: 8.779887e-09 
outer mgc:  0.002995839 
iter: 1  value: 1744.449 mgc: 0.05636117 ustep: 1 
iter: 2  value: 1744.449 mgc: 8.666864e-06 ustep: 1 
iter: 3  mgc: 4.565237e-13 
outer mgc:  0.3969314 
iter: 1  value: 1744.448 mgc: 0.05635972 ustep: 1 
iter: 2  value: 1744.448 mgc: 8.676641e-06 ustep: 1 
iter: 3  mgc: 4.591882e-13 
outer mgc:  0.39489 
iter: 1  value: 1744.448 mgc: 0.02941549 ustep: 1 
iter: 2  value: 1744.448 mgc: 2.74486e-06 ustep: 1 
iter: 3  mgc: 5.329071e-14 
outer mgc:  1.144566 
iter: 1  value: 1744.449 mgc: 0.02941706 ustep: 1 
iter: 2  value: 1744.449 mgc: 2.746869e-06 ustep: 1 
iter: 3  mgc: 6.306067e-14 
outer mgc:  1.141379 
iter: 1  value: 1744.449 mgc: 0.0570881 ustep: 1 
iter: 2  value: 1744.449 mgc: 7.412083e-06 ustep: 1 
iter: 3  mgc: 3.206324e-13 
outer mgc:  0.4448474 
iter: 1  value: 1744.447 mgc: 0.05709637 ustep: 1 
iter: 2  value: 1744.447 mgc: 7.420227e-06 ustep: 1 
iter: 3  mgc: 3.304024e-13 
outer mgc:  0.4461972 
iter: 1  value: 1744.452 mgc: 0.02947655 ustep: 1 
iter: 2  value: 1744.452 mgc: 2.764252e-06 ustep: 1 
iter: 3  mgc: 5.062617e-14 
outer mgc:  1.142338 
iter: 1  value: 1744.445 mgc: 0.02948678 ustep: 1 
iter: 2  value: 1744.445 mgc: 2.766735e-06 ustep: 1 
iter: 3  mgc: 6.683543e-14 
outer mgc:  1.136882 
iter: 1  value: 1744.443 mgc: 0.006410177 ustep: 1 
iter: 2  value: 1744.443 mgc: 2.86202e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
outer mgc:  0.04034934 
iter: 1  value: 1744.453 mgc: 0.006406132 ustep: 1 
iter: 2  value: 1744.453 mgc: 2.859799e-07 ustep: 1 
iter: 3  mgc: 5.906386e-14 
outer mgc:  0.03927016 
iter: 1  value: 1744.457 mgc: 0.01423809 ustep: 1 
iter: 2  value: 1744.457 mgc: 1.53299e-06 ustep: 1 
iter: 3  mgc: 7.860379e-14 
outer mgc:  0.3611347 
iter: 1  value: 1744.44 mgc: 0.01427369 ustep: 1 
iter: 2  value: 1744.44 mgc: 1.537774e-06 ustep: 1 
iter: 3  mgc: 3.552714e-14 
outer mgc:  0.3636047 
iter: 1  value: 1744.461 mgc: 0.01677528 ustep: 1 
iter: 2  value: 1744.461 mgc: 1.952865e-06 ustep: 1 
iter: 3  mgc: 3.552714e-13 
outer mgc:  0.3414394 
iter: 1  value: 1744.435 mgc: 0.01681512 ustep: 1 
iter: 2  value: 1744.435 mgc: 1.964423e-06 ustep: 1 
iter: 3  mgc: 3.144152e-13 
outer mgc:  0.347862 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:58:59 2021]
Finished job 0.
1 of 1 steps (100%) done

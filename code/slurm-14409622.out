Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:51:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.005_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.005_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.005_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.005, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.005_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.005_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.005_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.005_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.005_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22030.472225 
final  value 20688.268250 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 13815.36 mgc: 112.7059 ustep: 1 
iter: 2  value: 6010.781 mgc: 74.79893 ustep: 0.1336527 
iter: 3  value: 3608.335 mgc: 131.7097 ustep: 0.3656489 
iter: 4  value: 3416.596 mgc: 104.9522 ustep: 0.207046 
iter: 5  value: 3023.069 mgc: 152.8008 ustep: 0.07305777 
iter: 6  value: 2782.518 mgc: 65.30294 ustep: 0.07576229 
iter: 7  value: 2769.802 mgc: 28.98579 ustep: 0.275322 
iter: 8  value: 2769.617 mgc: 2.465731 ustep: 0.5247589 
iter: 9  value: 2769.616 mgc: 0.07046271 ustep: 0.72443 
iter: 10  value: 2769.616 mgc: 0.00272635 ustep: 0.8511494 
iter: 11  value: 2769.616 mgc: 4.772799e-05 ustep: 0.9225853 
iter: 12  value: 2769.616 mgc: 4.030058e-07 ustep: 0.960517 
iter: 13  mgc: 1.675055e-09 
iter: 1  mgc: 1.675055e-09 
Matching hessian patterns... Done
outer mgc:  506.6356 
iter: 1  value: 2329.374 mgc: 16.87891 ustep: 1 
iter: 2  value: 2327.977 mgc: 1.815372 ustep: 1 
iter: 3  value: 2327.977 mgc: 0.03430983 ustep: 1 
iter: 4  value: 2327.977 mgc: 2.72807e-05 ustep: 1 
iter: 5  mgc: 1.740907e-11 
iter: 1  mgc: 1.740907e-11 
outer mgc:  184.3517 
iter: 1  value: 2344.702 mgc: 17.09301 ustep: 1 
iter: 2  value: 2343.541 mgc: 1.338615 ustep: 1 
iter: 3  value: 2343.54 mgc: 0.01611203 ustep: 1 
iter: 4  value: 2343.54 mgc: 7.764918e-06 ustep: 1 
iter: 5  mgc: 2.646217e-12 
iter: 1  value: 2276.969 mgc: 8.533843 ustep: 1 
iter: 2  value: 2276.896 mgc: 0.3109688 ustep: 1 
iter: 3  value: 2276.896 mgc: 0.001100435 ustep: 1 
iter: 4  value: 2276.896 mgc: 3.819821e-08 ustep: 1 
mgc: 3.069767e-14 
iter: 1  mgc: 3.069767e-14 
outer mgc:  83.25558 
iter: 1  value: 2278.772 mgc: 13.68297 ustep: 1 
iter: 2  value: 2278.514 mgc: 0.7170387 ustep: 1 
iter: 3  value: 2278.514 mgc: 0.004237927 ustep: 1 
iter: 4  value: 2278.514 mgc: 3.099281e-07 ustep: 1 
iter: 5  mgc: 3.053113e-14 
iter: 1  value: 2258.448 mgc: 6.690452 ustep: 1 
iter: 2  value: 2258.435 mgc: 0.145175 ustep: 1 
iter: 3  value: 2258.435 mgc: 0.0002134492 ustep: 1 
iter: 4  mgc: 8.770824e-10 
iter: 1  mgc: 8.770824e-10 
outer mgc:  67.53336 
iter: 1  value: 2244.101 mgc: 3.482421 ustep: 1 
iter: 2  value: 2244.101 mgc: 0.03640843 ustep: 1 
iter: 3  value: 2244.101 mgc: 2.500485e-05 ustep: 1 
iter: 4  mgc: 1.320011e-11 
iter: 1  mgc: 1.320011e-11 
outer mgc:  77.84509 
iter: 1  value: 2217.806 mgc: 13.09531 ustep: 1 
iter: 2  value: 2217.393 mgc: 0.7870723 ustep: 1 
iter: 3  value: 2217.393 mgc: 0.01198769 ustep: 1 
iter: 4  value: 2217.393 mgc: 5.293066e-06 ustep: 1 
iter: 5  mgc: 1.031175e-12 
iter: 1  mgc: 1.031175e-12 
outer mgc:  105.1139 
iter: 1  value: 2201.291 mgc: 9.733575 ustep: 1 
iter: 2  value: 2201.151 mgc: 0.7467122 ustep: 1 
iter: 3  value: 2201.151 mgc: 0.01341911 ustep: 1 
iter: 4  value: 2201.151 mgc: 4.406598e-06 ustep: 1 
iter: 5  mgc: 4.689582e-13 
iter: 1  mgc: 4.689582e-13 
outer mgc:  68.89105 
iter: 1  value: 2193.272 mgc: 20.26356 ustep: 1 
iter: 2  value: 2191.641 mgc: 1.534583 ustep: 1 
iter: 3  value: 2191.641 mgc: 0.01475413 ustep: 1 
iter: 4  value: 2191.641 mgc: 2.060626e-06 ustep: 1 
iter: 5  mgc: 4.296563e-14 
iter: 1  mgc: 4.296563e-14 
outer mgc:  59.8768 
iter: 1  value: 2186.47 mgc: 20.21179 ustep: 1 
iter: 2  value: 2183.859 mgc: 1.900146 ustep: 1 
iter: 3  value: 2183.859 mgc: 0.02668192 ustep: 1 
iter: 4  value: 2183.859 mgc: 7.710704e-06 ustep: 1 
iter: 5  mgc: 1.007638e-12 
iter: 1  mgc: 1.007638e-12 
outer mgc:  38.05586 
iter: 1  value: 2187.354 mgc: 9.065714 ustep: 1 
iter: 2  value: 2187.271 mgc: 0.4453868 ustep: 1 
iter: 3  value: 2187.271 mgc: 0.001782592 ustep: 1 
iter: 4  value: 2187.271 mgc: 7.622412e-08 ustep: 1 
mgc: 2.575717e-14 
iter: 1  value: 2182.868 mgc: 4.019174 ustep: 1 
iter: 2  value: 2182.866 mgc: 0.0514142 ustep: 1 
iter: 3  value: 2182.866 mgc: 2.170027e-05 ustep: 1 
iter: 4  mgc: 7.384315e-12 
iter: 1  mgc: 7.384315e-12 
outer mgc:  83.04824 
iter: 1  value: 2182.048 mgc: 8.310743 ustep: 1 
iter: 2  value: 2182.01 mgc: 0.225212 ustep: 1 
iter: 3  value: 2182.01 mgc: 0.0004180918 ustep: 1 
iter: 4  mgc: 2.286896e-09 
iter: 1  mgc: 2.286896e-09 
outer mgc:  65.38399 
iter: 1  value: 2177.656 mgc: 4.330953 ustep: 1 
iter: 2  value: 2177.654 mgc: 0.04718467 ustep: 1 
iter: 3  value: 2177.654 mgc: 2.212773e-05 ustep: 1 
iter: 4  mgc: 8.320455e-12 
iter: 1  mgc: 8.320455e-12 
outer mgc:  12.15467 
iter: 1  value: 2181.577 mgc: 2.823133 ustep: 1 
iter: 2  value: 2181.574 mgc: 0.0617888 ustep: 1 
iter: 3  value: 2181.574 mgc: 0.0001120311 ustep: 1 
iter: 4  mgc: 3.654241e-10 
iter: 1  value: 2177.117 mgc: 0.6164668 ustep: 1 
iter: 2  value: 2177.117 mgc: 0.002644006 ustep: 1 
iter: 3  value: 2177.117 mgc: 2.274409e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  10.63314 
iter: 1  value: 2177.263 mgc: 1.645917 ustep: 1 
iter: 2  value: 2177.263 mgc: 0.006592575 ustep: 1 
iter: 3  value: 2177.263 mgc: 4.375254e-07 ustep: 1 
iter: 4  mgc: 2.9865e-14 
iter: 1  value: 2176.972 mgc: 0.6412339 ustep: 1 
iter: 2  value: 2176.972 mgc: 0.0009972763 ustep: 1 
iter: 3  value: 2176.972 mgc: 1.012708e-08 ustep: 1 
mgc: 2.88658e-14 
iter: 1  mgc: 2.88658e-14 
outer mgc:  4.646917 
iter: 1  value: 2176.822 mgc: 0.3305775 ustep: 1 
iter: 2  value: 2176.822 mgc: 0.0003354027 ustep: 1 
iter: 3  mgc: 9.192953e-10 
iter: 1  mgc: 9.192953e-10 
outer mgc:  5.212085 
iter: 1  value: 2176.683 mgc: 0.6084664 ustep: 1 
iter: 2  value: 2176.683 mgc: 0.00110076 ustep: 1 
iter: 3  value: 2176.683 mgc: 1.352539e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  7.616103 
iter: 1  value: 2176.524 mgc: 0.811716 ustep: 1 
iter: 2  value: 2176.524 mgc: 0.002705234 ustep: 1 
iter: 3  value: 2176.524 mgc: 6.168723e-08 ustep: 1 
mgc: 2.864375e-14 
iter: 1  mgc: 2.864375e-14 
outer mgc:  6.261568 
iter: 1  value: 2176.627 mgc: 0.4565324 ustep: 1 
iter: 2  value: 2176.627 mgc: 0.001067171 ustep: 1 
iter: 3  value: 2176.627 mgc: 3.141443e-08 ustep: 1 
mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  10.54497 
iter: 1  value: 2176.726 mgc: 0.7379689 ustep: 1 
iter: 2  value: 2176.726 mgc: 0.003700428 ustep: 1 
iter: 3  value: 2176.726 mgc: 3.295338e-07 ustep: 1 
iter: 4  mgc: 2.375877e-14 
iter: 1  value: 2176.447 mgc: 0.248237 ustep: 1 
iter: 2  value: 2176.447 mgc: 0.0002919851 ustep: 1 
iter: 3  mgc: 1.080228e-09 
iter: 1  mgc: 1.080228e-09 
outer mgc:  4.589546 
iter: 1  value: 2176.434 mgc: 1.002123 ustep: 1 
iter: 2  value: 2176.434 mgc: 0.002651576 ustep: 1 
iter: 3  value: 2176.434 mgc: 6.70501e-08 ustep: 1 
mgc: 2.176037e-14 
iter: 1  value: 2176.417 mgc: 0.5362697 ustep: 1 
iter: 2  value: 2176.417 mgc: 0.0007646254 ustep: 1 
iter: 3  mgc: 5.591487e-09 
iter: 1  mgc: 5.591487e-09 
outer mgc:  4.203227 
iter: 1  value: 2176.37 mgc: 0.200279 ustep: 1 
iter: 2  value: 2176.37 mgc: 0.0002883236 ustep: 1 
iter: 3  mgc: 2.260116e-09 
iter: 1  mgc: 2.260116e-09 
outer mgc:  2.779855 
iter: 1  value: 2176.345 mgc: 0.07444723 ustep: 1 
iter: 2  value: 2176.345 mgc: 3.993429e-05 ustep: 1 
iter: 3  mgc: 1.788614e-11 
iter: 1  mgc: 1.788614e-11 
outer mgc:  1.462137 
iter: 1  value: 2176.321 mgc: 0.2588468 ustep: 1 
iter: 2  value: 2176.321 mgc: 0.0002130354 ustep: 1 
iter: 3  mgc: 3.679335e-10 
iter: 1  mgc: 3.679335e-10 
outer mgc:  2.409833 
iter: 1  value: 2176.314 mgc: 0.2261055 ustep: 1 
iter: 2  value: 2176.314 mgc: 0.0001306183 ustep: 1 
iter: 3  mgc: 1.632403e-10 
iter: 1  mgc: 1.632403e-10 
outer mgc:  2.303729 
iter: 1  value: 2176.347 mgc: 0.1159651 ustep: 1 
iter: 2  value: 2176.347 mgc: 4.495174e-05 ustep: 1 
iter: 3  mgc: 2.886402e-11 
iter: 1  mgc: 2.886402e-11 
outer mgc:  0.4059857 
iter: 1  value: 2176.325 mgc: 0.1434969 ustep: 1 
iter: 2  value: 2176.325 mgc: 6.425694e-05 ustep: 1 
iter: 3  mgc: 3.407374e-11 
iter: 1  mgc: 3.407374e-11 
outer mgc:  0.4994703 
iter: 1  value: 2176.331 mgc: 0.1375282 ustep: 1 
iter: 2  value: 2176.331 mgc: 0.000101132 ustep: 1 
iter: 3  mgc: 1.169398e-10 
iter: 1  mgc: 1.169398e-10 
outer mgc:  0.2258196 
iter: 1  value: 2176.356 mgc: 0.159865 ustep: 1 
iter: 2  value: 2176.356 mgc: 9.398929e-05 ustep: 1 
iter: 3  mgc: 9.299939e-11 
iter: 1  value: 2176.337 mgc: 0.07494926 ustep: 1 
iter: 2  value: 2176.337 mgc: 1.894249e-05 ustep: 1 
iter: 3  mgc: 3.353318e-12 
iter: 1  value: 2176.333 mgc: 0.02595498 ustep: 1 
iter: 2  value: 2176.333 mgc: 2.273081e-06 ustep: 1 
iter: 3  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  0.1508214 
iter: 1  value: 2176.335 mgc: 0.01083331 ustep: 1 
iter: 2  value: 2176.335 mgc: 3.265813e-07 ustep: 1 
iter: 3  mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  0.2270723 
iter: 1  value: 2176.337 mgc: 0.01731806 ustep: 1 
iter: 2  value: 2176.337 mgc: 9.337837e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  0.09352476 
iter: 1  value: 2176.338 mgc: 0.009919185 ustep: 1 
iter: 2  value: 2176.338 mgc: 3.508299e-07 ustep: 1 
iter: 3  mgc: 2.753353e-14 
iter: 1  mgc: 2.753353e-14 
outer mgc:  0.143303 
iter: 1  value: 2176.341 mgc: 0.01882704 ustep: 1 
iter: 2  value: 2176.341 mgc: 1.110776e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.128916 
iter: 1  value: 2176.344 mgc: 0.008077392 ustep: 1 
iter: 2  value: 2176.344 mgc: 1.608004e-06 ustep: 1 
iter: 3  mgc: 6.661338e-14 
iter: 1  mgc: 6.661338e-14 
outer mgc:  0.1790179 
iter: 1  value: 2176.339 mgc: 0.01543074 ustep: 1 
iter: 2  value: 2176.339 mgc: 8.73058e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
iter: 1  mgc: 3.819167e-14 
outer mgc:  0.0443119 
iter: 1  value: 2176.348 mgc: 0.00831531 ustep: 1 
iter: 2  value: 2176.348 mgc: 3.83923e-07 ustep: 1 
iter: 3  mgc: 2.808864e-14 
iter: 1  value: 2176.341 mgc: 0.004198816 ustep: 1 
iter: 2  value: 2176.341 mgc: 7.52126e-08 ustep: 1 
iter: 3  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  0.04968404 
iter: 1  value: 2176.343 mgc: 0.004042246 ustep: 1 
iter: 2  value: 2176.343 mgc: 5.528239e-08 ustep: 1 
mgc: 2.295386e-14 
iter: 1  mgc: 2.295386e-14 
outer mgc:  0.02543866 
iter: 1  value: 2176.342 mgc: 0.004567258 ustep: 1 
iter: 2  value: 2176.342 mgc: 9.913072e-08 ustep: 1 
iter: 3  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  0.02860574 
iter: 1  value: 2176.341 mgc: 0.001036902 ustep: 1 
iter: 2  mgc: 6.66911e-09 
iter: 1  mgc: 6.66911e-09 
outer mgc:  0.02803593 
iter: 1  value: 2176.341 mgc: 0.0006238846 ustep: 1 
iter: 2  mgc: 2.715777e-09 
iter: 1  mgc: 2.715777e-09 
outer mgc:  0.001451933 
iter: 1  value: 2176.341 mgc: 0.0005763236 ustep: 1 
iter: 2  mgc: 1.12125e-09 
iter: 1  mgc: 1.12125e-09 
outer mgc:  0.002394524 
iter: 1  mgc: 1.12125e-09 
iter: 1  mgc: 1.12125e-09 
outer mgc:  0.002394524 
iter: 1  value: 2176.34 mgc: 0.05309833 ustep: 1 
iter: 2  value: 2176.34 mgc: 9.291854e-06 ustep: 1 
iter: 3  mgc: 7.596146e-13 
outer mgc:  0.1943788 
iter: 1  value: 2176.342 mgc: 0.05308807 ustep: 1 
iter: 2  value: 2176.342 mgc: 9.303435e-06 ustep: 1 
iter: 3  mgc: 7.56506e-13 
outer mgc:  0.1971355 
iter: 1  value: 2176.339 mgc: 0.02607351 ustep: 1 
iter: 2  value: 2176.339 mgc: 1.88264e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.7829503 
iter: 1  value: 2176.344 mgc: 0.02606709 ustep: 1 
iter: 2  value: 2176.344 mgc: 1.882207e-06 ustep: 1 
iter: 3  mgc: 4.662937e-14 
outer mgc:  0.7825378 
iter: 1  value: 2176.342 mgc: 0.05547174 ustep: 1 
iter: 2  value: 2176.342 mgc: 9.3252e-06 ustep: 1 
iter: 3  mgc: 6.257217e-13 
outer mgc:  0.2698108 
iter: 1  value: 2176.341 mgc: 0.05547065 ustep: 1 
iter: 2  value: 2176.341 mgc: 9.334893e-06 ustep: 1 
iter: 3  mgc: 6.27054e-13 
outer mgc:  0.2663666 
iter: 1  value: 2176.341 mgc: 0.02903238 ustep: 1 
iter: 2  value: 2176.341 mgc: 2.442601e-06 ustep: 1 
iter: 3  mgc: 5.151435e-14 
outer mgc:  1.014307 
iter: 1  value: 2176.342 mgc: 0.02902551 ustep: 1 
iter: 2  value: 2176.342 mgc: 2.442579e-06 ustep: 1 
iter: 3  mgc: 5.506706e-14 
outer mgc:  1.009463 
iter: 1  value: 2176.335 mgc: 0.004577793 ustep: 1 
iter: 2  value: 2176.335 mgc: 4.118401e-07 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.05891206 
iter: 1  value: 2176.348 mgc: 0.004573421 ustep: 1 
iter: 2  value: 2176.348 mgc: 4.113101e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.05915106 
iter: 1  value: 2176.35 mgc: 0.008275225 ustep: 1 
iter: 2  value: 2176.35 mgc: 1.405914e-06 ustep: 1 
iter: 3  mgc: 6.261658e-14 
outer mgc:  0.2492546 
iter: 1  value: 2176.333 mgc: 0.008295816 ustep: 1 
iter: 2  value: 2176.333 mgc: 1.410474e-06 ustep: 1 
iter: 3  mgc: 6.705747e-14 
outer mgc:  0.2509757 
iter: 1  value: 2176.35 mgc: 0.01114783 ustep: 1 
iter: 2  value: 2176.35 mgc: 3.218619e-06 ustep: 1 
iter: 3  mgc: 2.717826e-13 
outer mgc:  0.2465574 
iter: 1  value: 2176.333 mgc: 0.01117155 ustep: 1 
iter: 2  value: 2176.333 mgc: 3.228069e-06 ustep: 1 
iter: 3  mgc: 2.753353e-13 
outer mgc:  0.2463178 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:51:07 2021]
Finished job 0.
1 of 1 steps (100%) done

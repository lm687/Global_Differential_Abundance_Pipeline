Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 23:29:41 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_100_100_10_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_100_100_10_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_100_100_10_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22049.148634 
final  value 20592.914436 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19450.29 mgc: 3.999174 ustep: 1 
iter: 2  value: 19425.65 mgc: 4.351333 ustep: 0.8994163 
iter: 3  value: 19420.97 mgc: 4.047207 ustep: 0.772724 
iter: 4  value: 19389.96 mgc: 5.253009 ustep: 0.6521695 
iter: 5  value: 19373.48 mgc: 4.579878 ustep: 0.33762 
iter: 6  value: 19373.28 mgc: 0.639062 ustep: 0.5810927 
iter: 7  value: 19373.25 mgc: 0.1644494 ustep: 0.7623181 
iter: 8  value: 19373.25 mgc: 0.03523093 ustep: 0.873121 
iter: 9  value: 19373.25 mgc: 0.005151281 ustep: 0.934416 
iter: 10  value: 19373.25 mgc: 0.0007453796 ustep: 0.9666553 
iter: 11  value: 19373.25 mgc: 6.975008e-05 ustep: 0.983188 
iter: 12  value: 19373.25 mgc: 3.408862e-06 ustep: 0.9915592 
iter: 13  value: 19373.25 mgc: 8.512435e-08 ustep: 0.9957711 
iter: 14  mgc: 1.074085e-09 
iter: 1  mgc: 1.074085e-09 
Matching hessian patterns... Done
outer mgc:  132.2889 
iter: 1  value: 19173.23 mgc: 1.90012 ustep: 1 
iter: 2  value: 19173.05 mgc: 0.1512315 ustep: 1 
iter: 3  value: 19173.05 mgc: 0.00289941 ustep: 1 
iter: 4  value: 19173.05 mgc: 3.418244e-07 ustep: 1 
iter: 5  mgc: 2.231548e-14 
iter: 1  value: 19243.78 mgc: 13.71969 ustep: 1 
iter: 2  value: 19237.49 mgc: 4.125499 ustep: 1 
iter: 3  value: 19237.47 mgc: 0.2933409 ustep: 1 
iter: 4  value: 19237.47 mgc: 0.004107355 ustep: 1 
iter: 5  value: 19237.47 mgc: 6.51817e-07 ustep: 1 
iter: 6  mgc: 1.776357e-14 
iter: 1  mgc: 2.231548e-14 
outer mgc:  73.55031 
iter: 1  value: 19048.1 mgc: 3.418429 ustep: 1 
iter: 2  value: 19047.87 mgc: 0.420509 ustep: 1 
iter: 3  value: 19047.87 mgc: 0.01109086 ustep: 1 
iter: 4  value: 19047.87 mgc: 2.178965e-05 ustep: 1 
iter: 5  mgc: 7.29429e-11 
iter: 1  mgc: 7.29429e-11 
outer mgc:  81.88256 
iter: 1  value: 19130.52 mgc: 7.209151 ustep: 1 
iter: 2  value: 19126.3 mgc: 1.143595 ustep: 1 
iter: 3  value: 19126.3 mgc: 0.05414905 ustep: 1 
iter: 4  value: 19126.3 mgc: 0.0001225717 ustep: 1 
iter: 5  mgc: 1.205194e-09 
iter: 1  value: 19030.84 mgc: 1.851166 ustep: 1 
iter: 2  value: 19030.84 mgc: 0.08208186 ustep: 1 
iter: 3  value: 19030.84 mgc: 0.0002206497 ustep: 1 
iter: 4  mgc: 1.533988e-09 
iter: 1  mgc: 1.533988e-09 
outer mgc:  60.59094 
iter: 1  value: 19012.28 mgc: 1.814311 ustep: 1 
iter: 2  value: 19012.27 mgc: 0.08350024 ustep: 1 
iter: 3  value: 19012.27 mgc: 0.0003765728 ustep: 1 
iter: 4  mgc: 6.545054e-09 
iter: 1  mgc: 6.545054e-09 
outer mgc:  58.25832 
iter: 1  value: 18965.29 mgc: 3.037741 ustep: 1 
iter: 2  value: 18965.06 mgc: 0.1838685 ustep: 1 
iter: 3  value: 18965.06 mgc: 0.003780421 ustep: 1 
iter: 4  value: 18965.06 mgc: 1.35121e-06 ustep: 1 
iter: 5  mgc: 2.371436e-13 
iter: 1  mgc: 2.371436e-13 
outer mgc:  61.80992 
iter: 1  value: 18976.96 mgc: 10.80932 ustep: 1 
iter: 2  value: 18975.08 mgc: 0.9006223 ustep: 1 
iter: 3  value: 18975.08 mgc: 0.02342772 ustep: 1 
iter: 4  value: 18975.08 mgc: 4.149386e-05 ustep: 1 
iter: 5  mgc: 9.665913e-11 
iter: 1  value: 18955.97 mgc: 3.681016 ustep: 1 
iter: 2  value: 18955.89 mgc: 0.1312503 ustep: 1 
iter: 3  value: 18955.89 mgc: 0.0006263735 ustep: 1 
iter: 4  value: 18955.89 mgc: 5.337287e-08 ustep: 1 
iter: 5  mgc: 7.244205e-15 
iter: 1  mgc: 7.244205e-15 
outer mgc:  89.88561 
iter: 1  value: 18933.83 mgc: 3.869651 ustep: 1 
iter: 2  value: 18933.82 mgc: 0.08197579 ustep: 1 
iter: 3  value: 18933.82 mgc: 0.0002002981 ustep: 1 
iter: 4  mgc: 1.910846e-09 
iter: 1  mgc: 1.910846e-09 
outer mgc:  33.3608 
iter: 1  value: 18902.47 mgc: 4.148129 ustep: 1 
iter: 2  value: 18902.47 mgc: 0.05048878 ustep: 1 
iter: 3  value: 18902.47 mgc: 0.0001209349 ustep: 1 
iter: 4  mgc: 5.397403e-10 
iter: 1  mgc: 5.397403e-10 
outer mgc:  22.72335 
iter: 1  value: 18882.24 mgc: 5.220543 ustep: 1 
iter: 2  value: 18882.24 mgc: 0.1067341 ustep: 1 
iter: 3  value: 18882.24 mgc: 0.0001041889 ustep: 1 
iter: 4  mgc: 3.116929e-10 
iter: 1  value: 18895.42 mgc: 2.099495 ustep: 1 
iter: 2  value: 18895.42 mgc: 0.01743581 ustep: 1 
iter: 3  value: 18895.42 mgc: 1.205327e-06 ustep: 1 
iter: 4  mgc: 2.176037e-14 
iter: 1  mgc: 2.176037e-14 
outer mgc:  41.53234 
iter: 1  value: 18894.03 mgc: 1.794029 ustep: 1 
iter: 2  value: 18894.03 mgc: 0.01570931 ustep: 1 
iter: 3  value: 18894.03 mgc: 4.342262e-06 ustep: 1 
iter: 4  mgc: 8.575363e-13 
iter: 1  mgc: 8.575363e-13 
outer mgc:  31.72063 
iter: 1  value: 18893.37 mgc: 1.666249 ustep: 1 
iter: 2  value: 18893.37 mgc: 0.01110874 ustep: 1 
iter: 3  value: 18893.37 mgc: 1.105926e-06 ustep: 1 
iter: 4  mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  11.33546 
iter: 1  value: 18885.3 mgc: 2.399507 ustep: 1 
iter: 2  value: 18885.3 mgc: 0.02810369 ustep: 1 
iter: 3  value: 18885.3 mgc: 4.468361e-05 ustep: 1 
iter: 4  mgc: 9.258905e-11 
iter: 1  mgc: 9.258905e-11 
outer mgc:  9.937136 
iter: 1  value: 18887.89 mgc: 2.681432 ustep: 1 
iter: 2  value: 18887.89 mgc: 0.01773085 ustep: 1 
iter: 3  value: 18887.89 mgc: 1.251893e-05 ustep: 1 
iter: 4  mgc: 3.816503e-12 
iter: 1  value: 18885.45 mgc: 0.330742 ustep: 1 
iter: 2  value: 18885.45 mgc: 0.0004524899 ustep: 1 
iter: 3  mgc: 2.321707e-09 
iter: 1  mgc: 2.321707e-09 
outer mgc:  11.56428 
iter: 1  value: 18885.42 mgc: 0.1684372 ustep: 1 
iter: 2  value: 18885.42 mgc: 6.942801e-05 ustep: 1 
iter: 3  mgc: 1.891844e-10 
iter: 1  mgc: 1.891844e-10 
outer mgc:  2.168582 
iter: 1  value: 18885.44 mgc: 0.1021053 ustep: 1 
iter: 2  value: 18885.44 mgc: 0.0001407756 ustep: 1 
iter: 3  mgc: 3.470921e-10 
iter: 1  mgc: 3.470921e-10 
outer mgc:  1.714287 
iter: 1  value: 18884.98 mgc: 0.1779461 ustep: 1 
iter: 2  value: 18884.98 mgc: 0.0001338463 ustep: 1 
iter: 3  mgc: 1.591953e-10 
iter: 1  mgc: 1.591953e-10 
outer mgc:  4.471077 
iter: 1  value: 18884.83 mgc: 0.09039822 ustep: 1 
iter: 2  value: 18884.83 mgc: 2.269841e-05 ustep: 1 
iter: 3  mgc: 1.115086e-11 
iter: 1  mgc: 1.115086e-11 
outer mgc:  1.392448 
iter: 1  value: 18884.13 mgc: 0.1481163 ustep: 1 
iter: 2  value: 18884.13 mgc: 7.306613e-05 ustep: 1 
iter: 3  mgc: 1.189946e-10 
iter: 1  mgc: 1.189946e-10 
outer mgc:  2.236323 
iter: 1  value: 18883.18 mgc: 0.1968417 ustep: 1 
iter: 2  value: 18883.18 mgc: 0.0001108264 ustep: 1 
iter: 3  mgc: 1.509628e-10 
iter: 1  value: 18882.1 mgc: 0.2183736 ustep: 1 
iter: 2  value: 18882.1 mgc: 0.0001970545 ustep: 1 
iter: 3  mgc: 5.88229e-10 
iter: 1  mgc: 5.88229e-10 
outer mgc:  1.493542 
iter: 1  value: 18879.79 mgc: 0.7253885 ustep: 1 
iter: 2  value: 18879.79 mgc: 0.001806016 ustep: 1 
iter: 3  value: 18879.79 mgc: 3.822736e-08 ustep: 1 
iter: 4  mgc: 8.770762e-15 
iter: 1  value: 18881.59 mgc: 0.1262811 ustep: 1 
iter: 2  value: 18881.59 mgc: 5.790368e-05 ustep: 1 
iter: 3  mgc: 4.085909e-11 
iter: 1  mgc: 4.085909e-11 
outer mgc:  1.991233 
iter: 1  value: 18881.46 mgc: 0.05917353 ustep: 1 
iter: 2  value: 18881.46 mgc: 4.653309e-05 ustep: 1 
iter: 3  mgc: 3.011191e-11 
iter: 1  mgc: 3.011191e-11 
outer mgc:  1.032863 
iter: 1  value: 18881.34 mgc: 0.07171829 ustep: 1 
iter: 2  value: 18881.34 mgc: 9.888603e-05 ustep: 1 
iter: 3  mgc: 3.764469e-10 
iter: 1  value: 18881.33 mgc: 0.08711667 ustep: 1 
iter: 2  value: 18881.33 mgc: 0.0003208688 ustep: 1 
iter: 3  mgc: 4.037129e-09 
iter: 1  value: 18881.35 mgc: 0.1322584 ustep: 1 
iter: 2  value: 18881.35 mgc: 0.0007819472 ustep: 1 
iter: 3  value: 18881.35 mgc: 2.273974e-08 ustep: 1 
iter: 4  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  1.84169 
iter: 1  value: 18876.6 mgc: 0.9516359 ustep: 1 
iter: 2  value: 18876.6 mgc: 0.002899095 ustep: 1 
iter: 3  value: 18876.6 mgc: 6.581395e-08 ustep: 1 
iter: 4  mgc: 9.769963e-15 
iter: 1  mgc: 9.769963e-15 
outer mgc:  2.914942 
iter: 1  value: 18868.08 mgc: 2.115255 ustep: 1 
iter: 2  value: 18868.08 mgc: 0.007173446 ustep: 1 
iter: 3  value: 18868.08 mgc: 1.397756e-06 ustep: 1 
iter: 4  mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  2.895949 
iter: 1  value: 18857.55 mgc: 1.569194 ustep: 1 
iter: 2  value: 18857.55 mgc: 0.004042711 ustep: 1 
iter: 3  value: 18857.55 mgc: 8.176048e-08 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  value: 18865.92 mgc: 0.3907059 ustep: 1 
iter: 2  value: 18865.92 mgc: 0.0002588978 ustep: 1 
iter: 3  mgc: 1.230601e-09 
iter: 1  mgc: 1.230601e-09 
outer mgc:  1.906169 
iter: 1  value: 18866.75 mgc: 0.2527697 ustep: 1 
iter: 2  value: 18866.75 mgc: 0.0005711272 ustep: 1 
iter: 3  mgc: 3.758731e-09 
iter: 1  mgc: 3.758731e-09 
outer mgc:  1.24035 
iter: 1  value: 18869.32 mgc: 0.2515563 ustep: 1 
iter: 2  value: 18869.32 mgc: 0.0006413165 ustep: 1 
iter: 3  mgc: 9.123047e-09 
iter: 1  value: 18867.19 mgc: 0.155631 ustep: 1 
iter: 2  value: 18867.19 mgc: 3.739684e-05 ustep: 1 
iter: 3  mgc: 1.194591e-10 
iter: 1  mgc: 1.194591e-10 
outer mgc:  2.059987 
iter: 1  value: 18866.9 mgc: 0.1105364 ustep: 1 
iter: 2  value: 18866.9 mgc: 2.050994e-05 ustep: 1 
iter: 3  mgc: 3.079981e-12 
iter: 1  mgc: 3.079981e-12 
outer mgc:  0.6143554 
iter: 1  value: 18866.83 mgc: 0.1460545 ustep: 1 
iter: 2  value: 18866.83 mgc: 2.412009e-05 ustep: 1 
iter: 3  mgc: 6.276935e-11 
iter: 1  mgc: 6.276935e-11 
outer mgc:  0.7572252 
iter: 1  value: 18867.15 mgc: 0.06084073 ustep: 1 
iter: 2  value: 18867.15 mgc: 7.533333e-05 ustep: 1 
iter: 3  mgc: 1.191323e-10 
iter: 1  value: 18867.54 mgc: 0.07016986 ustep: 1 
iter: 2  value: 18867.54 mgc: 0.0001089096 ustep: 1 
iter: 3  mgc: 2.554004e-10 
iter: 1  mgc: 2.554004e-10 
outer mgc:  1.300355 
iter: 1  value: 18866.62 mgc: 0.1346056 ustep: 1 
iter: 2  value: 18866.62 mgc: 5.859165e-05 ustep: 1 
iter: 3  mgc: 1.393641e-11 
iter: 1  mgc: 1.393641e-11 
outer mgc:  0.2288832 
iter: 1  value: 18865.6 mgc: 0.1498315 ustep: 1 
iter: 2  value: 18865.6 mgc: 6.060115e-05 ustep: 1 
iter: 3  mgc: 3.6807e-11 
iter: 1  value: 18863.92 mgc: 0.2466956 ustep: 1 
iter: 2  value: 18863.92 mgc: 0.0001548792 ustep: 1 
iter: 3  mgc: 2.281455e-10 
iter: 1  mgc: 2.281455e-10 
outer mgc:  0.4885845 
iter: 1  value: 18861.02 mgc: 0.4391544 ustep: 1 
iter: 2  value: 18861.02 mgc: 0.0003421062 ustep: 1 
iter: 3  mgc: 1.590244e-09 
iter: 1  value: 18862.58 mgc: 0.1990704 ustep: 1 
iter: 2  value: 18862.58 mgc: 7.477936e-05 ustep: 1 
iter: 3  mgc: 7.670398e-11 
iter: 1  mgc: 7.670398e-11 
outer mgc:  0.1321558 
iter: 1  value: 18861.9 mgc: 0.132404 ustep: 1 
iter: 2  value: 18861.9 mgc: 1.343739e-05 ustep: 1 
iter: 3  mgc: 2.633449e-12 
iter: 1  mgc: 2.633449e-12 
outer mgc:  0.04753564 
iter: 1  value: 18861.81 mgc: 0.01624245 ustep: 1 
iter: 2  value: 18861.81 mgc: 3.373217e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  0.004821438 
iter: 1  value: 18861.8 mgc: 0.002736358 ustep: 1 
iter: 2  value: 18861.8 mgc: 2.439142e-08 ustep: 1 
mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.001436554 
iter: 1  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  0.001436554 
iter: 1  value: 18861.8 mgc: 0.006355418 ustep: 1 
iter: 2  value: 18861.8 mgc: 2.154828e-07 ustep: 1 
iter: 3  mgc: 1.487699e-14 
outer mgc:  0.4146054 
iter: 1  value: 18861.79 mgc: 0.006354246 ustep: 1 
iter: 2  value: 18861.79 mgc: 2.152643e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.4171645 
iter: 1  value: 18861.8 mgc: 0.00358105 ustep: 1 
iter: 2  value: 18861.8 mgc: 7.089636e-08 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.2302985 
iter: 1  value: 18861.8 mgc: 0.003580734 ustep: 1 
iter: 2  value: 18861.8 mgc: 7.086776e-08 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.2319444 
iter: 1  value: 18861.81 mgc: 0.006662209 ustep: 1 
iter: 2  value: 18861.81 mgc: 1.489243e-07 ustep: 1 
iter: 3  mgc: 1.265654e-14 
outer mgc:  0.4506807 
iter: 1  value: 18861.79 mgc: 0.006662908 ustep: 1 
iter: 2  value: 18861.79 mgc: 1.491052e-07 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.4479752 
iter: 1  value: 18861.8 mgc: 0.00319825 ustep: 1 
iter: 2  value: 18861.8 mgc: 7.255332e-08 ustep: 1 
iter: 3  mgc: 1.199041e-14 
outer mgc:  0.2560779 
iter: 1  value: 18861.79 mgc: 0.003199508 ustep: 1 
iter: 2  value: 18861.79 mgc: 7.254402e-08 ustep: 1 
iter: 3  mgc: 8.437695e-15 
outer mgc:  0.2554798 
iter: 1  value: 18861.86 mgc: 0.03535195 ustep: 1 
iter: 2  value: 18861.86 mgc: 2.186722e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.07638876 
iter: 1  value: 18861.73 mgc: 0.03545286 ustep: 1 
iter: 2  value: 18861.73 mgc: 2.185222e-06 ustep: 1 
iter: 3  mgc: 3.93019e-14 
outer mgc:  0.07681929 
iter: 1  value: 18861.86 mgc: 0.03555614 ustep: 1 
iter: 2  value: 18861.86 mgc: 1.352682e-06 ustep: 1 
iter: 3  mgc: 1.882938e-13 
outer mgc:  0.07258374 
iter: 1  value: 18861.73 mgc: 0.03565963 ustep: 1 
iter: 2  value: 18861.73 mgc: 1.351094e-06 ustep: 1 
iter: 3  mgc: 1.918465e-13 
outer mgc:  0.07170057 
iter: 1  value: 18861.77 mgc: 0.004181555 ustep: 1 
iter: 2  value: 18861.77 mgc: 3.26824e-08 ustep: 1 
mgc: 8.881784e-15 
outer mgc:  0.002983192 
iter: 1  value: 18861.82 mgc: 0.004179951 ustep: 1 
iter: 2  value: 18861.82 mgc: 3.273049e-08 ustep: 1 
mgc: 1.021405e-14 
outer mgc:  0.00585884 
iter: 1  value: 18861.77 mgc: 0.005576716 ustep: 1 
iter: 2  value: 18861.77 mgc: 3.050885e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.1287729 
iter: 1  value: 18861.82 mgc: 0.005572787 ustep: 1 
iter: 2  value: 18861.82 mgc: 3.047616e-07 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.1316318 
[Sun Aug 15 23:29:45 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:02:14 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4338.419928 
iter  10 value 3907.358507
iter  10 value 3907.358503
final  value 3907.358503 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2423.679 mgc: 76.90558 ustep: 0.2494656 
iter: 2  value: 1545.264 mgc: 72.98454 ustep: 0.1588666 
iter: 3  value: 659.2318 mgc: 122.199 ustep: 0.3986409 
iter: 4  value: 438.7854 mgc: 53.0976 ustep: 0.1172538 
iter: 5  value: 333.8928 mgc: 77.19684 ustep: 0.3424892 
iter: 6  value: 333.5182 mgc: 3.171183 ustep: 0.5852672 
iter: 7  value: 333.5166 mgc: 0.1403714 ustep: 0.7650511 
iter: 8  value: 333.5166 mgc: 0.00430137 ustep: 0.8746845 
iter: 9  value: 333.5166 mgc: 8.226735e-05 ustep: 0.9352522 
iter: 10  value: 333.5166 mgc: 7.600384e-07 ustep: 0.9670877 
iter: 11  mgc: 3.468491e-09 
iter: 1  mgc: 3.468491e-09 
Matching hessian patterns... Done
outer mgc:  101.3997 
iter: 1  value: 320.4304 mgc: 22.74466 ustep: 1 
iter: 2  value: 319.5947 mgc: 2.614743 ustep: 1 
iter: 3  value: 319.5944 mgc: 0.06855357 ustep: 1 
iter: 4  value: 319.5944 mgc: 5.673132e-05 ustep: 1 
iter: 5  mgc: 3.897575e-11 
iter: 1  mgc: 3.897575e-11 
outer mgc:  93.39491 
iter: 1  value: 308.4466 mgc: 26.54812 ustep: 1 
iter: 2  value: 303.97 mgc: 7.577106 ustep: 1 
iter: 3  value: 303.9626 mgc: 0.2546615 ustep: 1 
iter: 4  value: 303.9626 mgc: 0.0006419782 ustep: 1 
iter: 5  mgc: 7.011218e-09 
iter: 1  mgc: 7.011218e-09 
outer mgc:  60.71376 
iter: 1  value: 277.1077 mgc: 13.19667 ustep: 1 
iter: 2  value: 277.0779 mgc: 0.5427598 ustep: 1 
iter: 3  value: 277.0779 mgc: 0.001544308 ustep: 1 
iter: 4  value: 277.0779 mgc: 1.990466e-08 ustep: 1 
mgc: 2.831069e-14 
iter: 1  mgc: 2.831069e-14 
outer mgc:  17.14359 
iter: 1  value: 309.3067 mgc: 20.39901 ustep: 1 
iter: 2  value: 305.2301 mgc: 4.475365 ustep: 1 
iter: 3  value: 305.2232 mgc: 0.172178 ustep: 1 
iter: 4  value: 305.2232 mgc: 0.0004188719 ustep: 1 
iter: 5  mgc: 3.79108e-09 
iter: 1  value: 274.0494 mgc: 5.673918 ustep: 1 
iter: 2  value: 274.0408 mgc: 0.2056893 ustep: 1 
iter: 3  value: 274.0408 mgc: 0.0003716327 ustep: 1 
iter: 4  mgc: 1.833375e-09 
iter: 1  mgc: 1.833375e-09 
outer mgc:  11.86461 
iter: 1  value: 272.1773 mgc: 2.974786 ustep: 1 
iter: 2  value: 272.1723 mgc: 0.2267624 ustep: 1 
iter: 3  value: 272.1723 mgc: 0.001717382 ustep: 1 
iter: 4  value: 272.1723 mgc: 9.999565e-08 ustep: 1 
mgc: 1.326717e-14 
iter: 1  mgc: 1.326717e-14 
outer mgc:  20.22053 
iter: 1  value: 268.4117 mgc: 9.661667 ustep: 1 
iter: 2  value: 268.3738 mgc: 0.5901305 ustep: 1 
iter: 3  value: 268.3738 mgc: 0.001700153 ustep: 1 
iter: 4  value: 268.3738 mgc: 3.709062e-08 ustep: 1 
mgc: 2.031708e-14 
iter: 1  mgc: 2.031708e-14 
outer mgc:  12.21598 
iter: 1  value: 265.4139 mgc: 5.999911 ustep: 1 
iter: 2  value: 265.408 mgc: 0.2065273 ustep: 1 
iter: 3  value: 265.408 mgc: 0.001329869 ustep: 1 
iter: 4  value: 265.408 mgc: 5.265159e-08 ustep: 1 
mgc: 1.677131e-14 
iter: 1  mgc: 1.677131e-14 
outer mgc:  16.61441 
iter: 1  value: 261.2654 mgc: 8.190761 ustep: 1 
iter: 2  value: 261.2442 mgc: 0.382108 ustep: 1 
iter: 3  value: 261.2442 mgc: 0.001035339 ustep: 1 
iter: 4  value: 261.2442 mgc: 1.290167e-08 ustep: 1 
mgc: 2.797762e-14 
iter: 1  mgc: 2.797762e-14 
outer mgc:  8.367922 
iter: 1  value: 254.0478 mgc: 11.12301 ustep: 1 
iter: 2  value: 253.9733 mgc: 0.6254598 ustep: 1 
iter: 3  value: 253.9733 mgc: 0.006478329 ustep: 1 
iter: 4  value: 253.9733 mgc: 9.230829e-07 ustep: 1 
iter: 5  mgc: 2.398082e-14 
iter: 1  value: 245.0403 mgc: 12.5471 ustep: 1 
iter: 2  value: 244.72 mgc: 1.260745 ustep: 1 
iter: 3  value: 244.7199 mgc: 0.01912988 ustep: 1 
iter: 4  value: 244.7199 mgc: 5.43903e-06 ustep: 1 
iter: 5  mgc: 4.359707e-13 
iter: 1  mgc: 4.359707e-13 
outer mgc:  10.74296 
iter: 1  value: 503.9851 mgc: 56.47952 ustep: 1 
iter: 2  value: 501.7185 mgc: 6.140856 ustep: 1 
iter: 3  value: 501.7181 mgc: 0.1009521 ustep: 1 
iter: 4  value: 501.7181 mgc: 9.984026e-05 ustep: 1 
iter: 5  mgc: 3.291483e-10 
iter: 1  value: 245.0626 mgc: 5.048889 ustep: 1 
iter: 2  value: 245.062 mgc: 0.07887794 ustep: 1 
iter: 3  value: 245.062 mgc: 4.905475e-05 ustep: 1 
iter: 4  mgc: 2.294104e-11 
iter: 1  value: 244.3492 mgc: 2.249594 ustep: 1 
iter: 2  value: 244.3492 mgc: 0.01542132 ustep: 1 
iter: 3  value: 244.3492 mgc: 1.927895e-06 ustep: 1 
iter: 4  mgc: 3.008704e-14 
iter: 1  mgc: 3.008704e-14 
outer mgc:  4.826343 
iter: 1  value: 244.2884 mgc: 2.39193 ustep: 1 
iter: 2  value: 244.2883 mgc: 0.01922014 ustep: 1 
iter: 3  value: 244.2883 mgc: 1.194914e-06 ustep: 1 
iter: 4  mgc: 2.065015e-14 
iter: 1  mgc: 2.065015e-14 
outer mgc:  7.846756 
iter: 1  value: 243.9302 mgc: 2.369498 ustep: 1 
iter: 2  value: 243.9302 mgc: 0.01295358 ustep: 1 
iter: 3  value: 243.9302 mgc: 1.170652e-06 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  2.435428 
iter: 1  value: 243.7364 mgc: 0.8890489 ustep: 1 
iter: 2  value: 243.7364 mgc: 0.003805965 ustep: 1 
iter: 3  value: 243.7364 mgc: 6.227917e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  3.796937 
iter: 1  value: 243.2293 mgc: 1.189304 ustep: 1 
iter: 2  value: 243.2293 mgc: 0.006330118 ustep: 1 
iter: 3  value: 243.2293 mgc: 1.920866e-07 ustep: 1 
iter: 4  mgc: 1.598721e-14 
iter: 1  value: 242.8023 mgc: 1.396555 ustep: 1 
iter: 2  value: 242.8023 mgc: 0.006217557 ustep: 1 
iter: 3  value: 242.8023 mgc: 9.533532e-08 ustep: 1 
mgc: 3.463896e-14 
iter: 1  mgc: 3.463896e-14 
outer mgc:  3.761492 
iter: 1  value: 241.9782 mgc: 5.691525 ustep: 1 
iter: 2  value: 241.9781 mgc: 0.06399946 ustep: 1 
iter: 3  value: 241.9781 mgc: 1.133199e-05 ustep: 1 
iter: 4  mgc: 3.390621e-13 
iter: 1  mgc: 3.390621e-13 
outer mgc:  7.554032 
iter: 1  value: 241.0804 mgc: 4.044323 ustep: 1 
iter: 2  value: 241.0804 mgc: 0.03331143 ustep: 1 
iter: 3  value: 241.0804 mgc: 2.909614e-06 ustep: 1 
iter: 4  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  2.82202 
iter: 1  value: 240.0423 mgc: 1.085908 ustep: 1 
iter: 2  value: 240.0423 mgc: 0.002735085 ustep: 1 
iter: 3  value: 240.0423 mgc: 3.422299e-08 ustep: 1 
mgc: 1.509903e-14 
iter: 1  mgc: 1.509903e-14 
outer mgc:  3.058649 
iter: 1  value: 239.1397 mgc: 0.8893934 ustep: 1 
iter: 2  value: 239.1397 mgc: 0.002979499 ustep: 1 
iter: 3  value: 239.1397 mgc: 3.168106e-08 ustep: 1 
mgc: 2.842171e-14 
iter: 1  value: 238.5275 mgc: 2.03289 ustep: 1 
iter: 2  value: 238.5275 mgc: 0.007967373 ustep: 1 
iter: 3  value: 238.5275 mgc: 2.619216e-07 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  3.384362 
iter: 1  value: 239.228 mgc: 3.145289 ustep: 1 
iter: 2  value: 239.228 mgc: 0.02809631 ustep: 1 
iter: 3  value: 239.228 mgc: 5.379916e-06 ustep: 1 
iter: 4  mgc: 2.34035e-13 
iter: 1  value: 239.3393 mgc: 2.681876 ustep: 1 
iter: 2  value: 239.3392 mgc: 0.01300074 ustep: 1 
iter: 3  value: 239.3392 mgc: 1.469607e-06 ustep: 1 
iter: 4  mgc: 2.131628e-14 
iter: 1  value: 239.1858 mgc: 1.568344 ustep: 1 
iter: 2  value: 239.1858 mgc: 0.003049972 ustep: 1 
iter: 3  value: 239.1858 mgc: 1.206603e-07 ustep: 1 
iter: 4  mgc: 3.108624e-14 
iter: 1  value: 239.0976 mgc: 0.6277447 ustep: 1 
iter: 2  value: 239.0976 mgc: 0.0004831463 ustep: 1 
iter: 3  mgc: 3.024986e-09 
iter: 1  mgc: 3.024986e-09 
outer mgc:  1.867953 
iter: 1  value: 239.0799 mgc: 0.7734533 ustep: 1 
iter: 2  value: 239.0799 mgc: 0.0007587181 ustep: 1 
iter: 3  mgc: 1.219839e-09 
iter: 1  mgc: 1.219839e-09 
outer mgc:  1.13447 
iter: 1  value: 239.0728 mgc: 0.2749905 ustep: 1 
iter: 2  value: 239.0728 mgc: 0.0002108315 ustep: 1 
iter: 3  mgc: 3.083303e-10 
iter: 1  value: 239.0598 mgc: 0.1396641 ustep: 1 
iter: 2  value: 239.0598 mgc: 0.0001391935 ustep: 1 
iter: 3  mgc: 2.280225e-10 
iter: 1  value: 239.0415 mgc: 0.4258502 ustep: 1 
iter: 2  value: 239.0415 mgc: 0.00129624 ustep: 1 
iter: 3  value: 239.0415 mgc: 1.998832e-08 ustep: 1 
mgc: 2.126077e-14 
iter: 1  mgc: 2.126077e-14 
outer mgc:  1.354415 
iter: 1  value: 238.3912 mgc: 0.6341818 ustep: 1 
iter: 2  value: 238.3912 mgc: 0.0009786322 ustep: 1 
iter: 3  mgc: 2.686074e-09 
iter: 1  value: 236.7294 mgc: 2.900816 ustep: 1 
iter: 2  value: 236.7294 mgc: 0.008315171 ustep: 1 
iter: 3  value: 236.7294 mgc: 5.037513e-07 ustep: 1 
iter: 4  mgc: 3.56104e-14 
iter: 1  mgc: 3.56104e-14 
outer mgc:  5.860105 
iter: 1  value: 235.3871 mgc: 3.446252 ustep: 1 
iter: 2  value: 235.3869 mgc: 0.03820671 ustep: 1 
iter: 3  value: 235.3869 mgc: 3.332614e-05 ustep: 1 
iter: 4  mgc: 2.947775e-11 
iter: 1  mgc: 2.947775e-11 
outer mgc:  3.848382 
iter: 1  value: 233.0732 mgc: 4.339111 ustep: 1 
iter: 2  value: 233.0732 mgc: 0.03303881 ustep: 1 
iter: 3  value: 233.0732 mgc: 4.479999e-06 ustep: 1 
iter: 4  mgc: 2.147171e-13 
iter: 1  mgc: 2.147171e-13 
outer mgc:  9.021391 
iter: 1  value: 232.0779 mgc: 1.989942 ustep: 1 
iter: 2  value: 232.0779 mgc: 0.01023927 ustep: 1 
iter: 3  value: 232.0779 mgc: 7.638269e-07 ustep: 1 
iter: 4  mgc: 6.461498e-14 
iter: 1  mgc: 6.461498e-14 
outer mgc:  1.598444 
iter: 1  value: 231.2959 mgc: 0.9723164 ustep: 1 
iter: 2  value: 231.2959 mgc: 0.001118299 ustep: 1 
iter: 3  mgc: 1.458032e-09 
iter: 1  mgc: 1.458032e-09 
outer mgc:  0.3715246 
iter: 1  value: 229.545 mgc: 2.061117 ustep: 1 
iter: 2  value: 229.545 mgc: 0.002333708 ustep: 1 
iter: 3  value: 229.545 mgc: 1.0422e-08 ustep: 1 
mgc: 8.704149e-14 
iter: 1  mgc: 8.704149e-14 
outer mgc:  0.905732 
iter: 1  value: 228.0697 mgc: 1.957577 ustep: 1 
iter: 2  value: 228.0697 mgc: 0.001005886 ustep: 1 
iter: 3  mgc: 1.540627e-09 
iter: 1  mgc: 1.540627e-09 
outer mgc:  0.4638415 
iter: 1  value: 226.6611 mgc: 1.821542 ustep: 1 
iter: 2  value: 226.6611 mgc: 0.00127009 ustep: 1 
iter: 3  mgc: 1.888864e-09 
iter: 1  mgc: 1.888864e-09 
outer mgc:  0.1811987 
iter: 1  value: 225.5114 mgc: 1.377305 ustep: 1 
iter: 2  value: 225.5114 mgc: 0.0004398553 ustep: 1 
iter: 3  mgc: 2.809077e-10 
iter: 1  mgc: 2.809077e-10 
outer mgc:  0.08086312 
iter: 1  value: 224.7857 mgc: 0.8598769 ustep: 1 
iter: 2  value: 224.7857 mgc: 0.0001555458 ustep: 1 
iter: 3  mgc: 3.260681e-11 
iter: 1  mgc: 3.260681e-11 
outer mgc:  0.04043381 
iter: 1  value: 224.4431 mgc: 0.3970377 ustep: 1 
iter: 2  value: 224.4431 mgc: 3.228884e-05 ustep: 1 
iter: 3  mgc: 1.33582e-12 
iter: 1  mgc: 1.33582e-12 
outer mgc:  0.01094098 
iter: 1  value: 224.3571 mgc: 0.1010262 ustep: 1 
iter: 2  value: 224.3571 mgc: 1.924879e-06 ustep: 1 
iter: 3  mgc: 8.260059e-14 
iter: 1  mgc: 8.260059e-14 
outer mgc:  0.00429755 
iter: 1  value: 224.3502 mgc: 0.009505925 ustep: 1 
iter: 2  value: 224.3502 mgc: 1.154546e-08 ustep: 1 
mgc: 5.173639e-14 
iter: 1  mgc: 5.173639e-14 
outer mgc:  0.0008077149 
iter: 1  value: 224.3505 mgc: 0.0008394524 ustep: 1 
iter: 2  mgc: 1.533109e-10 
iter: 1  mgc: 1.533109e-10 
outer mgc:  6.515176e-05 
iter: 1  mgc: 1.533109e-10 
iter: 1  mgc: 1.533109e-10 
outer mgc:  6.515176e-05 
iter: 1  value: 224.3501 mgc: 0.04392328 ustep: 1 
iter: 2  value: 224.3501 mgc: 1.132159e-06 ustep: 1 
iter: 3  mgc: 5.395684e-14 
outer mgc:  0.3503779 
iter: 1  value: 224.3512 mgc: 0.04390244 ustep: 1 
iter: 2  value: 224.3512 mgc: 1.131462e-06 ustep: 1 
iter: 3  mgc: 7.606415e-14 
outer mgc:  0.3503249 
iter: 1  value: 224.3503 mgc: 0.02037176 ustep: 1 
iter: 2  value: 224.3503 mgc: 2.730598e-07 ustep: 1 
iter: 3  mgc: 5.662137e-14 
outer mgc:  0.186348 
iter: 1  value: 224.3509 mgc: 0.02036166 ustep: 1 
iter: 2  value: 224.3509 mgc: 2.728171e-07 ustep: 1 
iter: 3  mgc: 6.57252e-14 
outer mgc:  0.186312 
iter: 1  value: 224.3512 mgc: 0.05244818 ustep: 1 
iter: 2  value: 224.3512 mgc: 3.523618e-06 ustep: 1 
iter: 3  mgc: 1.278977e-13 
outer mgc:  0.3824509 
iter: 1  value: 224.3501 mgc: 0.05244115 ustep: 1 
iter: 2  value: 224.3501 mgc: 3.522658e-06 ustep: 1 
iter: 3  mgc: 1.314504e-13 
outer mgc:  0.3825013 
iter: 1  value: 224.3507 mgc: 0.02568494 ustep: 1 
iter: 2  value: 224.3507 mgc: 8.419179e-07 ustep: 1 
iter: 3  mgc: 7.194245e-14 
outer mgc:  0.2945963 
iter: 1  value: 224.3506 mgc: 0.02568043 ustep: 1 
iter: 2  value: 224.3506 mgc: 8.411128e-07 ustep: 1 
iter: 3  mgc: 7.793766e-14 
outer mgc:  0.2944455 
iter: 1  value: 224.3488 mgc: 0.001920425 ustep: 1 
iter: 2  mgc: 6.808367e-10 
outer mgc:  0.0002077177 
iter: 1  value: 224.3522 mgc: 0.001920242 ustep: 1 
iter: 2  mgc: 6.811405e-10 
outer mgc:  0.000170716 
iter: 1  value: 224.3633 mgc: 0.3923246 ustep: 1 
iter: 2  value: 224.3633 mgc: 3.169819e-05 ustep: 1 
iter: 3  mgc: 1.060485e-12 
outer mgc:  0.2963699 
iter: 1  value: 224.338 mgc: 0.3927171 ustep: 1 
iter: 2  value: 224.338 mgc: 3.180184e-05 ustep: 1 
iter: 3  mgc: 1.072031e-12 
outer mgc:  0.2961419 
iter: 1  value: 224.3568 mgc: 0.4023154 ustep: 1 
iter: 2  value: 224.3568 mgc: 2.932497e-05 ustep: 1 
iter: 3  mgc: 5.435652e-13 
outer mgc:  0.3094099 
iter: 1  value: 224.3445 mgc: 0.4035138 ustep: 1 
iter: 2  value: 224.3445 mgc: 2.923545e-05 ustep: 1 
iter: 3  mgc: 6.794565e-13 
outer mgc:  0.3097262 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:02:16 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 16:11:39 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.01_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.01_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.01_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4443.886708 
final  value 4226.335220 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1301.649 mgc: 99.52966 ustep: 1 
iter: 2  value: 1004.02 mgc: 47.44157 ustep: 0.2494656 
iter: 3  value: 854.5864 mgc: 101.6501 ustep: 0.4995153 
iter: 4  value: 853.3035 mgc: 6.665117 ustep: 0.7067933 
iter: 5  value: 853.298 mgc: 0.46482 ustep: 0.8407259 
iter: 6  value: 853.298 mgc: 0.005500749 ustep: 0.9169194 
iter: 7  value: 853.298 mgc: 1.863076e-05 ustep: 0.9575633 
iter: 8  value: 853.298 mgc: 3.258775e-08 ustep: 0.9785538 
mgc: 6.468992e-11 
iter: 1  mgc: 6.468992e-11 
Matching hessian patterns... Done
outer mgc:  377.0576 
iter: 1  value: 569.944 mgc: 30.83436 ustep: 1 
iter: 2  value: 569.3495 mgc: 2.998678 ustep: 1 
iter: 3  value: 569.3493 mgc: 0.04543191 ustep: 1 
iter: 4  value: 569.3493 mgc: 4.133117e-05 ustep: 1 
iter: 5  mgc: 3.276873e-11 
iter: 1  mgc: 3.276873e-11 
outer mgc:  190.9818 
iter: 1  value: 441.1588 mgc: 25.57012 ustep: 1 
iter: 2  value: 440.3486 mgc: 1.896272 ustep: 1 
iter: 3  value: 440.3483 mgc: 0.04851889 ustep: 1 
iter: 4  value: 440.3483 mgc: 7.852423e-05 ustep: 1 
iter: 5  mgc: 2.066224e-10 
iter: 1  mgc: 2.066224e-10 
outer mgc:  74.42689 
iter: 1  value: 409.5078 mgc: 18.44239 ustep: 1 
iter: 2  value: 409.4317 mgc: 0.8448676 ustep: 1 
iter: 3  value: 409.4317 mgc: 0.004202674 ustep: 1 
iter: 4  value: 409.4317 mgc: 2.187915e-07 ustep: 1 
iter: 5  mgc: 1.756928e-14 
iter: 1  mgc: 1.756928e-14 
outer mgc:  46.87896 
iter: 1  value: 413.7276 mgc: 17.63675 ustep: 1 
iter: 2  value: 413.3499 mgc: 1.800714 ustep: 1 
iter: 3  value: 413.3498 mgc: 0.0537027 ustep: 1 
iter: 4  value: 413.3498 mgc: 5.193557e-05 ustep: 1 
iter: 5  mgc: 4.873435e-11 
iter: 1  value: 406.9896 mgc: 11.918 ustep: 1 
iter: 2  value: 406.9349 mgc: 0.6034825 ustep: 1 
iter: 3  value: 406.9349 mgc: 0.001949995 ustep: 1 
iter: 4  value: 406.9349 mgc: 7.407085e-08 ustep: 1 
mgc: 3.140804e-14 
iter: 1  mgc: 3.140804e-14 
outer mgc:  36.04749 
iter: 1  value: 397.1758 mgc: 12.3255 ustep: 1 
iter: 2  value: 397.0986 mgc: 0.7686869 ustep: 1 
iter: 3  value: 397.0986 mgc: 0.006546555 ustep: 1 
iter: 4  value: 397.0986 mgc: 1.062285e-06 ustep: 1 
iter: 5  mgc: 2.908784e-14 
iter: 1  mgc: 2.908784e-14 
outer mgc:  14.09474 
iter: 1  value: 396.9848 mgc: 16.24979 ustep: 1 
iter: 2  value: 396.8066 mgc: 1.034657 ustep: 1 
iter: 3  value: 396.8066 mgc: 0.00752271 ustep: 1 
iter: 4  value: 396.8066 mgc: 7.483045e-07 ustep: 1 
iter: 5  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  24.04978 
iter: 1  value: 392.7421 mgc: 9.179489 ustep: 1 
iter: 2  value: 392.7351 mgc: 0.2421609 ustep: 1 
iter: 3  value: 392.7351 mgc: 0.0004029281 ustep: 1 
iter: 4  mgc: 1.346494e-09 
iter: 1  mgc: 1.346494e-09 
outer mgc:  11.62316 
iter: 1  value: 393.5527 mgc: 7.47918 ustep: 1 
iter: 2  value: 393.5464 mgc: 0.2018508 ustep: 1 
iter: 3  value: 393.5464 mgc: 0.0003118979 ustep: 1 
iter: 4  mgc: 1.89607e-09 
iter: 1  value: 391.8785 mgc: 3.285764 ustep: 1 
iter: 2  value: 391.8782 mgc: 0.03647901 ustep: 1 
iter: 3  value: 391.8782 mgc: 1.098281e-05 ustep: 1 
iter: 4  mgc: 2.400302e-12 
iter: 1  mgc: 2.400302e-12 
outer mgc:  6.697116 
iter: 1  value: 391.062 mgc: 3.224125 ustep: 1 
iter: 2  value: 391.0616 mgc: 0.04206716 ustep: 1 
iter: 3  value: 391.0616 mgc: 1.92525e-05 ustep: 1 
iter: 4  mgc: 5.575096e-12 
iter: 1  mgc: 5.575096e-12 
outer mgc:  7.595528 
iter: 1  value: 389.5704 mgc: 6.997143 ustep: 1 
iter: 2  value: 389.5657 mgc: 0.1776311 ustep: 1 
iter: 3  value: 389.5657 mgc: 0.0003552297 ustep: 1 
iter: 4  mgc: 2.352882e-09 
iter: 1  mgc: 2.352882e-09 
outer mgc:  7.222129 
iter: 1  value: 386.5249 mgc: 12.42075 ustep: 1 
iter: 2  value: 386.4134 mgc: 0.9380413 ustep: 1 
iter: 3  value: 386.4134 mgc: 0.009273922 ustep: 1 
iter: 4  value: 386.4134 mgc: 9.267188e-07 ustep: 1 
iter: 5  mgc: 2.420286e-14 
iter: 1  value: 383.4021 mgc: 17.941 ustep: 1 
iter: 2  value: 382.9091 mgc: 2.259976 ustep: 1 
iter: 3  value: 382.909 mgc: 0.05044971 ustep: 1 
iter: 4  value: 382.909 mgc: 2.70834e-05 ustep: 1 
iter: 5  mgc: 7.757128e-12 
iter: 1  value: 389.6207 mgc: 29.06806 ustep: 1 
iter: 2  value: 384.656 mgc: 7.743624 ustep: 1 
iter: 3  value: 384.6476 mgc: 0.4816293 ustep: 1 
iter: 4  value: 384.6476 mgc: 0.002381014 ustep: 1 
iter: 5  value: 384.6476 mgc: 5.870914e-08 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 7.757128e-12 
outer mgc:  6.342663 
iter: 1  value: 386.3235 mgc: 23.55992 ustep: 1 
iter: 2  value: 384.7531 mgc: 3.19493 ustep: 1 
iter: 3  value: 384.7521 mgc: 0.1134163 ustep: 1 
iter: 4  value: 384.7521 mgc: 0.0002335753 ustep: 1 
iter: 5  mgc: 9.974652e-10 
iter: 1  value: 381.3432 mgc: 6.543784 ustep: 1 
iter: 2  value: 381.3371 mgc: 0.1815463 ustep: 1 
iter: 3  value: 381.3371 mgc: 0.0005608938 ustep: 1 
iter: 4  mgc: 6.945953e-09 
iter: 1  mgc: 6.945953e-09 
outer mgc:  10.80033 
iter: 1  value: 380.0591 mgc: 4.899245 ustep: 1 
iter: 2  value: 380.0563 mgc: 0.1504003 ustep: 1 
iter: 3  value: 380.0563 mgc: 0.0002234156 ustep: 1 
iter: 4  mgc: 5.056866e-10 
iter: 1  mgc: 5.056866e-10 
outer mgc:  7.643688 
iter: 1  value: 380.3933 mgc: 5.220647 ustep: 1 
iter: 2  value: 380.3926 mgc: 0.1218509 ustep: 1 
iter: 3  value: 380.3926 mgc: 5.855737e-05 ustep: 1 
iter: 4  mgc: 1.359224e-11 
iter: 1  mgc: 1.359224e-11 
outer mgc:  6.360773 
iter: 1  value: 380.8981 mgc: 8.486984 ustep: 1 
iter: 2  value: 380.8871 mgc: 0.1905206 ustep: 1 
iter: 3  value: 380.8871 mgc: 0.0003263589 ustep: 1 
iter: 4  mgc: 1.960943e-09 
iter: 1  value: 380.1093 mgc: 3.807082 ustep: 1 
iter: 2  value: 380.1091 mgc: 0.038394 ustep: 1 
iter: 3  value: 380.1091 mgc: 9.700705e-06 ustep: 1 
iter: 4  mgc: 1.097789e-12 
iter: 1  mgc: 1.097789e-12 
outer mgc:  4.708069 
iter: 1  value: 379.9043 mgc: 2.165843 ustep: 1 
iter: 2  value: 379.9043 mgc: 0.02188902 ustep: 1 
iter: 3  value: 379.9043 mgc: 4.948937e-06 ustep: 1 
iter: 4  mgc: 2.494671e-13 
iter: 1  mgc: 2.494671e-13 
outer mgc:  2.491275 
iter: 1  value: 379.7619 mgc: 1.428506 ustep: 1 
iter: 2  value: 379.7619 mgc: 0.006808764 ustep: 1 
iter: 3  value: 379.7619 mgc: 2.586781e-07 ustep: 1 
iter: 4  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  1.96867 
iter: 1  value: 379.8237 mgc: 1.996698 ustep: 1 
iter: 2  value: 379.8237 mgc: 0.01242586 ustep: 1 
iter: 3  value: 379.8237 mgc: 2.404616e-06 ustep: 1 
iter: 4  mgc: 9.947598e-14 
iter: 1  mgc: 9.947598e-14 
outer mgc:  1.870491 
iter: 1  value: 379.8081 mgc: 1.804712 ustep: 1 
iter: 2  value: 379.808 mgc: 0.01061213 ustep: 1 
iter: 3  value: 379.808 mgc: 1.126e-06 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  2.450742 
iter: 1  value: 379.7776 mgc: 0.5100423 ustep: 1 
iter: 2  value: 379.7776 mgc: 0.001006784 ustep: 1 
iter: 3  value: 379.7776 mgc: 1.027225e-08 ustep: 1 
mgc: 2.098322e-14 
iter: 1  mgc: 2.098322e-14 
outer mgc:  0.4107992 
iter: 1  value: 379.7006 mgc: 0.2919984 ustep: 1 
iter: 2  value: 379.7006 mgc: 0.00139474 ustep: 1 
iter: 3  value: 379.7006 mgc: 3.117598e-08 ustep: 1 
mgc: 1.598721e-14 
iter: 1  value: 379.7476 mgc: 0.09769213 ustep: 1 
iter: 2  value: 379.7476 mgc: 0.0001569063 ustep: 1 
iter: 3  mgc: 4.016476e-10 
iter: 1  mgc: 4.016476e-10 
outer mgc:  0.7585168 
iter: 1  value: 379.7157 mgc: 0.1699424 ustep: 1 
iter: 2  value: 379.7157 mgc: 0.0002013625 ustep: 1 
iter: 3  mgc: 9.830652e-10 
iter: 1  mgc: 9.830652e-10 
outer mgc:  0.3365138 
iter: 1  value: 379.7224 mgc: 0.09810153 ustep: 1 
iter: 2  value: 379.7224 mgc: 6.871699e-05 ustep: 1 
iter: 3  mgc: 1.13181e-10 
iter: 1  mgc: 1.13181e-10 
outer mgc:  0.1547158 
iter: 1  value: 379.7322 mgc: 0.2622238 ustep: 1 
iter: 2  value: 379.7322 mgc: 0.0002924057 ustep: 1 
iter: 3  mgc: 1.345424e-09 
iter: 1  mgc: 1.345424e-09 
outer mgc:  0.1378633 
iter: 1  value: 379.732 mgc: 0.1575706 ustep: 1 
iter: 2  value: 379.732 mgc: 7.36305e-05 ustep: 1 
iter: 3  mgc: 5.529732e-11 
iter: 1  mgc: 5.529732e-11 
outer mgc:  0.03799912 
iter: 1  value: 379.7306 mgc: 0.0470378 ustep: 1 
iter: 2  value: 379.7306 mgc: 6.630012e-06 ustep: 1 
iter: 3  mgc: 5.799805e-13 
iter: 1  mgc: 5.799805e-13 
outer mgc:  0.02630961 
iter: 1  value: 379.7308 mgc: 0.02230079 ustep: 1 
iter: 2  value: 379.7308 mgc: 1.548131e-06 ustep: 1 
iter: 3  mgc: 3.197442e-14 
iter: 1  mgc: 3.197442e-14 
outer mgc:  0.00848332 
iter: 1  value: 379.7308 mgc: 0.005598623 ustep: 1 
iter: 2  value: 379.7308 mgc: 1.241909e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  0.002703487 
iter: 1  value: 379.7309 mgc: 0.003230611 ustep: 1 
iter: 2  value: 379.7309 mgc: 3.395393e-08 ustep: 1 
mgc: 2.020606e-14 
iter: 1  mgc: 2.020606e-14 
outer mgc:  0.005343378 
iter: 1  value: 379.7308 mgc: 0.0009055093 ustep: 1 
iter: 2  mgc: 3.16736e-09 
iter: 1  mgc: 3.16736e-09 
outer mgc:  0.0005953268 
iter: 1  value: 379.7309 mgc: 0.0002012427 ustep: 1 
iter: 2  mgc: 2.197793e-10 
iter: 1  mgc: 2.197793e-10 
outer mgc:  5.607151e-05 
iter: 1  mgc: 2.197793e-10 
iter: 1  mgc: 2.197793e-10 
outer mgc:  5.607151e-05 
iter: 1  value: 379.7308 mgc: 0.05040164 ustep: 1 
iter: 2  value: 379.7308 mgc: 8.049043e-06 ustep: 1 
iter: 3  mgc: 6.588063e-13 
outer mgc:  0.03162238 
iter: 1  value: 379.7309 mgc: 0.05039824 ustep: 1 
iter: 2  value: 379.7309 mgc: 8.0571e-06 ustep: 1 
iter: 3  mgc: 6.610268e-13 
outer mgc:  0.03164409 
iter: 1  value: 379.7319 mgc: 0.03040594 ustep: 1 
iter: 2  value: 379.7319 mgc: 4.094775e-06 ustep: 1 
iter: 3  mgc: 1.856293e-13 
outer mgc:  0.1752736 
iter: 1  value: 379.73 mgc: 0.03040425 ustep: 1 
iter: 2  value: 379.73 mgc: 4.097429e-06 ustep: 1 
iter: 3  mgc: 1.807443e-13 
outer mgc:  0.1753222 
iter: 1  value: 379.7308 mgc: 0.05234712 ustep: 1 
iter: 2  value: 379.7308 mgc: 7.599421e-06 ustep: 1 
iter: 3  mgc: 4.671818e-13 
outer mgc:  0.06411721 
iter: 1  value: 379.731 mgc: 0.05233784 ustep: 1 
iter: 2  value: 379.731 mgc: 7.612671e-06 ustep: 1 
iter: 3  mgc: 4.547474e-13 
outer mgc:  0.06417505 
iter: 1  value: 379.7304 mgc: 0.02391534 ustep: 1 
iter: 2  value: 379.7304 mgc: 1.718056e-06 ustep: 1 
iter: 3  mgc: 2.109424e-14 
outer mgc:  0.1882433 
iter: 1  value: 379.7315 mgc: 0.02390597 ustep: 1 
iter: 2  value: 379.7315 mgc: 1.718437e-06 ustep: 1 
iter: 3  mgc: 2.087219e-14 
outer mgc:  0.1882656 
iter: 1  value: 379.7297 mgc: 0.004060788 ustep: 1 
iter: 2  value: 379.7297 mgc: 1.191782e-07 ustep: 1 
iter: 3  mgc: 1.754152e-14 
outer mgc:  0.01393452 
iter: 1  value: 379.732 mgc: 0.004057297 ustep: 1 
iter: 2  value: 379.732 mgc: 1.189093e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.01391104 
iter: 1  value: 379.732 mgc: 0.005739045 ustep: 1 
iter: 2  value: 379.732 mgc: 7.880835e-07 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.04590613 
iter: 1  value: 379.7298 mgc: 0.005750847 ustep: 1 
iter: 2  value: 379.7298 mgc: 7.907561e-07 ustep: 1 
iter: 3  mgc: 2.620126e-14 
outer mgc:  0.04587647 
iter: 1  value: 379.733 mgc: 0.01010003 ustep: 1 
iter: 2  value: 379.733 mgc: 1.64247e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.04024848 
iter: 1  value: 379.7287 mgc: 0.01012195 ustep: 1 
iter: 2  value: 379.7287 mgc: 1.647727e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.04027347 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 16:11:41 2021]
Finished job 0.
1 of 1 steps (100%) done

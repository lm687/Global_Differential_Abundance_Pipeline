Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:45:09 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.05_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.05, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.05_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.05_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22241.405784 
final  value 22040.080964 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 20477.04 mgc: 3.930966 ustep: 0.8994163 
iter: 2  value: 20467.56 mgc: 2.56813 ustep: 0.9483808 
iter: 3  value: 20442.5 mgc: 4.8103 ustep: 0.8382098 
iter: 4  value: 20408.11 mgc: 2.963597 ustep: 0.7093201 
iter: 5  value: 20403.34 mgc: 1.690615 ustep: 0.6027335 
iter: 6  value: 20403.26 mgc: 0.3104951 ustep: 0.7763815 
iter: 7  value: 20403.26 mgc: 0.03403201 ustep: 0.881137 
iter: 8  value: 20403.26 mgc: 0.003191691 ustep: 0.9386951 
iter: 9  value: 20403.26 mgc: 0.0001603728 ustep: 0.9688659 
iter: 10  value: 20403.26 mgc: 4.03046e-06 ustep: 0.9843114 
iter: 11  value: 20403.26 mgc: 5.066083e-08 ustep: 0.9921255 
iter: 12  mgc: 3.185566e-10 
iter: 1  mgc: 3.185566e-10 
Matching hessian patterns... Done
outer mgc:  138.2224 
iter: 1  value: 20195.21 mgc: 0.8932379 ustep: 1 
iter: 2  value: 20195.2 mgc: 0.04927919 ustep: 1 
iter: 3  value: 20195.2 mgc: 0.0001886259 ustep: 1 
iter: 4  mgc: 2.926651e-09 
iter: 1  value: 20007.87 mgc: 5.911571 ustep: 1 
iter: 2  value: 20007.83 mgc: 0.2872405 ustep: 1 
iter: 3  value: 20007.83 mgc: 0.001481998 ustep: 1 
iter: 4  value: 20007.83 mgc: 2.072419e-08 ustep: 1 
mgc: 1.421085e-14 
iter: 1  mgc: 1.421085e-14 
outer mgc:  115.3561 
iter: 1  value: 20033.06 mgc: 30.12163 ustep: 1 
iter: 2  value: 20032.79 mgc: 0.4841468 ustep: 1 
iter: 3  value: 20032.79 mgc: 0.002992445 ustep: 1 
iter: 4  value: 20032.79 mgc: 1.018519e-07 ustep: 1 
iter: 5  mgc: 4.884981e-15 
iter: 1  value: 20003.02 mgc: 3.143684 ustep: 1 
iter: 2  value: 20002.82 mgc: 0.2546273 ustep: 1 
iter: 3  value: 20002.82 mgc: 0.004909009 ustep: 1 
iter: 4  value: 20002.82 mgc: 1.545391e-06 ustep: 1 
iter: 5  mgc: 2.364775e-13 
iter: 1  mgc: 2.364775e-13 
outer mgc:  24.97055 
iter: 1  value: 20032.25 mgc: 10.59836 ustep: 1 
iter: 2  value: 20032.21 mgc: 0.3886893 ustep: 1 
iter: 3  value: 20032.21 mgc: 0.0005249588 ustep: 1 
iter: 4  mgc: 8.91009e-10 
iter: 1  value: 19986.83 mgc: 0.6768605 ustep: 1 
iter: 2  value: 19986.83 mgc: 0.004272691 ustep: 1 
iter: 3  value: 19986.83 mgc: 5.624009e-07 ustep: 1 
iter: 4  mgc: 1.332268e-14 
iter: 1  mgc: 1.332268e-14 
outer mgc:  22.44182 
iter: 1  value: 19975.96 mgc: 1.244113 ustep: 1 
iter: 2  value: 19975.96 mgc: 0.01213568 ustep: 1 
iter: 3  value: 19975.96 mgc: 1.307952e-06 ustep: 1 
iter: 4  mgc: 1.554312e-14 
iter: 1  mgc: 1.554312e-14 
outer mgc:  28.70452 
iter: 1  value: 19965.88 mgc: 1.472459 ustep: 1 
iter: 2  value: 19965.88 mgc: 0.01865181 ustep: 1 
iter: 3  value: 19965.88 mgc: 2.809348e-06 ustep: 1 
iter: 4  mgc: 1.376677e-13 
iter: 1  mgc: 1.376677e-13 
outer mgc:  19.57414 
iter: 1  value: 19954.24 mgc: 2.062813 ustep: 1 
iter: 2  value: 19954.24 mgc: 0.01888739 ustep: 1 
iter: 3  value: 19954.24 mgc: 1.751031e-06 ustep: 1 
iter: 4  mgc: 7.072121e-14 
iter: 1  mgc: 7.072121e-14 
outer mgc:  6.099537 
iter: 1  value: 19944.03 mgc: 2.084047 ustep: 1 
iter: 2  value: 19944.03 mgc: 0.01734553 ustep: 1 
iter: 3  value: 19944.03 mgc: 3.297553e-06 ustep: 1 
iter: 4  mgc: 1.736389e-13 
iter: 1  value: 19949.41 mgc: 0.8568851 ustep: 1 
iter: 2  value: 19949.41 mgc: 0.003200699 ustep: 1 
iter: 3  value: 19949.41 mgc: 8.783911e-08 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  8.587047 
iter: 1  value: 19946.12 mgc: 0.8931094 ustep: 1 
iter: 2  value: 19946.12 mgc: 0.004019086 ustep: 1 
iter: 3  value: 19946.12 mgc: 5.303366e-08 ustep: 1 
iter: 4  mgc: 6.77236e-15 
iter: 1  mgc: 6.77236e-15 
outer mgc:  5.668936 
iter: 1  value: 19941.79 mgc: 1.062273 ustep: 1 
iter: 2  value: 19941.79 mgc: 0.004276431 ustep: 1 
iter: 3  value: 19941.79 mgc: 1.079816e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  3.177379 
iter: 1  value: 19937.82 mgc: 0.7179644 ustep: 1 
iter: 2  value: 19937.82 mgc: 0.002824214 ustep: 1 
iter: 3  value: 19937.82 mgc: 1.025229e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  value: 19940.5 mgc: 0.1905151 ustep: 1 
iter: 2  value: 19940.5 mgc: 0.0002205635 ustep: 1 
iter: 3  mgc: 5.075725e-10 
iter: 1  mgc: 5.075725e-10 
outer mgc:  4.875092 
iter: 1  value: 19939.44 mgc: 0.2450735 ustep: 1 
iter: 2  value: 19939.44 mgc: 0.0002858398 ustep: 1 
iter: 3  mgc: 4.027987e-10 
iter: 1  mgc: 4.027987e-10 
outer mgc:  2.75369 
iter: 1  value: 19938.16 mgc: 0.2356106 ustep: 1 
iter: 2  value: 19938.16 mgc: 0.0002290342 ustep: 1 
iter: 3  mgc: 2.284368e-10 
iter: 1  mgc: 2.284368e-10 
outer mgc:  1.053195 
iter: 1  value: 19936.14 mgc: 0.1964247 ustep: 1 
iter: 2  value: 19936.14 mgc: 0.0001744062 ustep: 1 
iter: 3  mgc: 3.579181e-10 
iter: 1  mgc: 3.579181e-10 
outer mgc:  1.178147 
iter: 1  value: 19935.1 mgc: 0.258486 ustep: 1 
iter: 2  value: 19935.1 mgc: 0.0002189268 ustep: 1 
iter: 3  mgc: 3.371996e-10 
iter: 1  mgc: 3.371996e-10 
outer mgc:  3.131386 
iter: 1  value: 19933.56 mgc: 0.1921255 ustep: 1 
iter: 2  value: 19933.56 mgc: 0.0001133882 ustep: 1 
iter: 3  mgc: 1.180513e-10 
iter: 1  mgc: 1.180513e-10 
outer mgc:  2.102412 
iter: 1  value: 19932.83 mgc: 0.1275084 ustep: 1 
iter: 2  value: 19932.83 mgc: 3.857449e-05 ustep: 1 
iter: 3  mgc: 3.247447e-11 
iter: 1  mgc: 3.247447e-11 
outer mgc:  0.5318696 
iter: 1  value: 19930.95 mgc: 0.1538141 ustep: 1 
iter: 2  value: 19930.95 mgc: 3.185463e-05 ustep: 1 
iter: 3  mgc: 9.01812e-12 
iter: 1  value: 19932.24 mgc: 0.04513199 ustep: 1 
iter: 2  value: 19932.24 mgc: 2.779051e-06 ustep: 1 
iter: 3  mgc: 9.4591e-14 
iter: 1  mgc: 9.4591e-14 
outer mgc:  0.9199629 
iter: 1  value: 19932 mgc: 0.04045208 ustep: 1 
iter: 2  value: 19932 mgc: 3.816466e-06 ustep: 1 
iter: 3  mgc: 1.856293e-13 
iter: 1  mgc: 1.856293e-13 
outer mgc:  0.4851441 
iter: 1  value: 19931.45 mgc: 0.07630262 ustep: 1 
iter: 2  value: 19931.45 mgc: 1.248646e-05 ustep: 1 
iter: 3  mgc: 1.198153e-12 
iter: 1  value: 19930.59 mgc: 0.1164673 ustep: 1 
iter: 2  value: 19930.59 mgc: 4.582374e-05 ustep: 1 
iter: 3  mgc: 1.125056e-11 
iter: 1  value: 19928.74 mgc: 0.2565214 ustep: 1 
iter: 2  value: 19928.74 mgc: 0.0002046137 ustep: 1 
iter: 3  mgc: 2.371427e-10 
iter: 1  mgc: 2.371427e-10 
outer mgc:  1.398481 
iter: 1  value: 19923.61 mgc: 0.5386418 ustep: 1 
iter: 2  value: 19923.61 mgc: 0.0004954132 ustep: 1 
iter: 3  mgc: 3.847468e-09 
iter: 1  mgc: 3.847468e-09 
outer mgc:  0.9549753 
iter: 1  value: 19919.63 mgc: 1.076221 ustep: 1 
iter: 2  value: 19919.63 mgc: 0.001865583 ustep: 1 
iter: 3  value: 19919.63 mgc: 2.122357e-08 ustep: 1 
mgc: 8.65974e-15 
iter: 1  value: 19922.12 mgc: 0.379703 ustep: 1 
iter: 2  value: 19922.12 mgc: 0.0002658194 ustep: 1 
iter: 3  mgc: 4.582252e-10 
iter: 1  mgc: 4.582252e-10 
outer mgc:  0.4293057 
iter: 1  value: 19920.26 mgc: 0.3642894 ustep: 1 
iter: 2  value: 19920.26 mgc: 0.0002047374 ustep: 1 
iter: 3  mgc: 8.036138e-11 
iter: 1  mgc: 8.036138e-11 
outer mgc:  0.6217168 
iter: 1  value: 19919.35 mgc: 0.1576258 ustep: 1 
iter: 2  value: 19919.35 mgc: 2.586911e-05 ustep: 1 
iter: 3  mgc: 9.063417e-12 
iter: 1  mgc: 9.063417e-12 
outer mgc:  0.517399 
iter: 1  value: 19918.26 mgc: 0.1113777 ustep: 1 
iter: 2  value: 19918.26 mgc: 4.665969e-05 ustep: 1 
iter: 3  mgc: 8.326895e-12 
iter: 1  mgc: 8.326895e-12 
outer mgc:  0.6170231 
iter: 1  value: 19916.36 mgc: 0.2507635 ustep: 1 
iter: 2  value: 19916.36 mgc: 9.081063e-05 ustep: 1 
iter: 3  mgc: 2.431966e-11 
iter: 1  mgc: 2.431966e-11 
outer mgc:  0.362639 
iter: 1  value: 19914.51 mgc: 0.2220031 ustep: 1 
iter: 2  value: 19914.51 mgc: 0.0001117114 ustep: 1 
iter: 3  mgc: 8.874412e-11 
iter: 1  mgc: 8.874412e-11 
outer mgc:  1.043659 
iter: 1  value: 19913.13 mgc: 0.1610491 ustep: 1 
iter: 2  value: 19913.13 mgc: 3.847426e-05 ustep: 1 
iter: 3  mgc: 8.351986e-12 
iter: 1  mgc: 8.351986e-12 
outer mgc:  0.3105202 
iter: 1  value: 19912.16 mgc: 0.1223782 ustep: 1 
iter: 2  value: 19912.16 mgc: 1.732186e-05 ustep: 1 
iter: 3  mgc: 2.279399e-12 
iter: 1  value: 19911.02 mgc: 0.1422121 ustep: 1 
iter: 2  value: 19911.02 mgc: 2.30508e-05 ustep: 1 
iter: 3  mgc: 4.025225e-12 
iter: 1  mgc: 4.025225e-12 
outer mgc:  0.2108082 
iter: 1  value: 19906.88 mgc: 0.4338093 ustep: 1 
iter: 2  value: 19906.88 mgc: 0.0002196736 ustep: 1 
iter: 3  mgc: 2.412106e-10 
iter: 1  mgc: 2.412106e-10 
outer mgc:  0.3060345 
iter: 1  value: 19904.7 mgc: 0.260678 ustep: 1 
iter: 2  value: 19904.7 mgc: 7.786742e-05 ustep: 1 
iter: 3  mgc: 1.953016e-11 
iter: 1  mgc: 1.953016e-11 
outer mgc:  0.1566097 
iter: 1  value: 19904.81 mgc: 0.04211104 ustep: 1 
iter: 2  value: 19904.81 mgc: 3.052057e-06 ustep: 1 
iter: 3  mgc: 1.278977e-13 
iter: 1  mgc: 1.278977e-13 
outer mgc:  0.01042613 
iter: 1  value: 19904.73 mgc: 0.009585909 ustep: 1 
iter: 2  value: 19904.73 mgc: 7.319399e-08 ustep: 1 
iter: 3  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  0.003667801 
iter: 1  value: 19904.65 mgc: 0.007855449 ustep: 1 
iter: 2  value: 19904.65 mgc: 5.421692e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  8.82043e-05 
iter: 1  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  8.82043e-05 
iter: 1  value: 19904.65 mgc: 0.00568495 ustep: 1 
iter: 2  value: 19904.65 mgc: 1.811152e-07 ustep: 1 
iter: 3  mgc: 7.882583e-15 
outer mgc:  0.3317174 
iter: 1  value: 19904.65 mgc: 0.005683159 ustep: 1 
iter: 2  value: 19904.65 mgc: 1.81028e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.3317857 
iter: 1  value: 19904.65 mgc: 0.003113152 ustep: 1 
iter: 2  value: 19904.65 mgc: 7.771064e-08 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.20166 
iter: 1  value: 19904.65 mgc: 0.003113316 ustep: 1 
iter: 2  value: 19904.65 mgc: 7.76632e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.2015211 
iter: 1  value: 19904.66 mgc: 0.005646001 ustep: 1 
iter: 2  value: 19904.66 mgc: 8.131756e-08 ustep: 1 
iter: 3  mgc: 1.076916e-14 
outer mgc:  0.3570908 
iter: 1  value: 19904.65 mgc: 0.00564402 ustep: 1 
iter: 2  value: 19904.65 mgc: 8.126339e-08 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.356783 
iter: 1  value: 19904.66 mgc: 0.003115898 ustep: 1 
iter: 2  value: 19904.66 mgc: 2.644977e-08 ustep: 1 
iter: 3  mgc: 6.661338e-15 
outer mgc:  0.184197 
iter: 1  value: 19904.65 mgc: 0.003115043 ustep: 1 
iter: 2  value: 19904.65 mgc: 2.642688e-08 ustep: 1 
iter: 3  mgc: 6.494805e-15 
outer mgc:  0.1840785 
iter: 1  value: 19904.71 mgc: 0.03260786 ustep: 1 
iter: 2  value: 19904.71 mgc: 1.253437e-06 ustep: 1 
iter: 3  mgc: 7.771561e-15 
outer mgc:  0.06085242 
iter: 1  value: 19904.59 mgc: 0.03269703 ustep: 1 
iter: 2  value: 19904.59 mgc: 1.251989e-06 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.0607502 
iter: 1  value: 19904.73 mgc: 0.0290948 ustep: 1 
iter: 2  value: 19904.73 mgc: 7.39406e-07 ustep: 1 
iter: 3  mgc: 6.883383e-15 
outer mgc:  0.037242 
iter: 1  value: 19904.57 mgc: 0.02918363 ustep: 1 
iter: 2  value: 19904.57 mgc: 7.392941e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.0370688 
iter: 1  value: 19904.62 mgc: 0.00335634 ustep: 1 
iter: 2  mgc: 8.789282e-09 
outer mgc:  0.002757209 
iter: 1  value: 19904.68 mgc: 0.003355014 ustep: 1 
iter: 2  mgc: 8.804863e-09 
outer mgc:  0.002582797 
iter: 1  value: 19904.63 mgc: 0.003973126 ustep: 1 
iter: 2  value: 19904.63 mgc: 1.038445e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.1424585 
iter: 1  value: 19904.67 mgc: 0.003970655 ustep: 1 
iter: 2  value: 19904.67 mgc: 1.037823e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.142255 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:45:12 2021]
Finished job 0.
1 of 1 steps (100%) done

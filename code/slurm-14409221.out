Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:38:26 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_10_3_0.8_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=10, d=3, beta_intensity=0.8, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_10_3_0.8_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_10_3_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 10945.474232 
final  value 9277.407108 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 8563.868 mgc: 6.926623 ustep: 0.5218903 
iter: 2  value: 8535.266 mgc: 4.060107 ustep: 0.7224475 
iter: 3  value: 8532.339 mgc: 2.871248 ustep: 0.8499841 
iter: 4  value: 8532.16 mgc: 0.942461 ustep: 0.9219537 
iter: 5  value: 8532.16 mgc: 0.01054078 ustep: 0.9601882 
iter: 6  value: 8532.16 mgc: 0.0002259698 ustep: 0.9798939 
iter: 7  value: 8532.16 mgc: 3.693994e-06 ustep: 0.9898969 
iter: 8  value: 8532.16 mgc: 3.401625e-08 ustep: 0.9949361 
iter: 9  mgc: 1.618279e-10 
iter: 1  mgc: 1.618279e-10 
Matching hessian patterns... Done
outer mgc:  40.31897 
iter: 1  value: 8455.639 mgc: 2.136527 ustep: 1 
iter: 2  value: 8455.465 mgc: 0.4160971 ustep: 1 
iter: 3  value: 8455.465 mgc: 0.01749484 ustep: 1 
iter: 4  value: 8455.465 mgc: 3.477741e-05 ustep: 1 
iter: 5  mgc: 1.372322e-10 
iter: 1  value: 8680.228 mgc: 18.60449 ustep: 0.6827823 
iter: 2  value: 8422.998 mgc: 11.96923 ustep: 0.1279618 
iter: 3  value: 8383.781 mgc: 4.794519 ustep: 0.3577817 
iter: 4  value: 8382.284 mgc: 1.090629 ustep: 0.5981887 
iter: 5  value: 8382.267 mgc: 0.1374621 ustep: 0.7734493 
iter: 6  value: 8382.267 mgc: 0.007018881 ustep: 0.8794717 
iter: 7  value: 8382.267 mgc: 0.0001550741 ustep: 0.9378077 
iter: 8  value: 8382.267 mgc: 1.659025e-06 ustep: 0.9684079 
iter: 9  mgc: 8.793305e-09 
iter: 1  mgc: 8.793305e-09 
outer mgc:  55.01364 
iter: 1  value: 8295.56 mgc: 31.7085 ustep: 1 
iter: 2  value: 8295.382 mgc: 1.606854 ustep: 1 
iter: 3  value: 8295.382 mgc: 0.001671017 ustep: 1 
iter: 4  mgc: 4.679625e-09 
iter: 1  mgc: 4.679625e-09 
outer mgc:  91.48474 
iter: 1  value: 9273.721 mgc: 15.16936 ustep: 1 
iter: 2  value: 9273.721 mgc: 0.02251321 ustep: 1 
iter: 3  value: 9273.721 mgc: 1.601468e-07 ustep: 1 
mgc: 7.105427e-15 
iter: 1  value: 8258.723 mgc: 1.971142 ustep: 1 
iter: 2  value: 8258.723 mgc: 0.00276327 ustep: 1 
iter: 3  mgc: 6.688259e-09 
iter: 1  mgc: 6.688259e-09 
outer mgc:  29.79777 
iter: 1  value: 8241.217 mgc: 1.719573 ustep: 1 
iter: 2  value: 8241.217 mgc: 0.004558583 ustep: 1 
iter: 3  value: 8241.217 mgc: 1.025457e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  27.31215 
iter: 1  value: 8240.31 mgc: 1.672424 ustep: 1 
iter: 2  value: 8240.31 mgc: 0.002101736 ustep: 1 
iter: 3  mgc: 6.272513e-09 
iter: 1  value: 8236.641 mgc: 0.8851253 ustep: 1 
iter: 2  value: 8236.641 mgc: 0.0004114451 ustep: 1 
iter: 3  mgc: 2.196967e-10 
iter: 1  mgc: 2.196967e-10 
outer mgc:  17.14894 
iter: 1  value: 8234.143 mgc: 1.177049 ustep: 1 
iter: 2  value: 8234.143 mgc: 0.001921712 ustep: 1 
iter: 3  mgc: 2.739374e-09 
iter: 1  mgc: 2.739374e-09 
outer mgc:  18.97803 
iter: 1  value: 8233.252 mgc: 0.9613483 ustep: 1 
iter: 2  value: 8233.252 mgc: 0.001212832 ustep: 1 
iter: 3  mgc: 7.19576e-09 
iter: 1  mgc: 7.19576e-09 
outer mgc:  7.914229 
iter: 1  value: 8235.06 mgc: 0.6410013 ustep: 1 
iter: 2  value: 8235.06 mgc: 0.0003330948 ustep: 1 
iter: 3  mgc: 2.830483e-10 
iter: 1  mgc: 2.830483e-10 
outer mgc:  6.346219 
iter: 1  value: 8234.014 mgc: 1.835885 ustep: 1 
iter: 2  value: 8234.014 mgc: 0.00292935 ustep: 1 
iter: 3  value: 8234.014 mgc: 1.693572e-08 ustep: 1 
mgc: 6.428885e-15 
iter: 1  mgc: 6.428885e-15 
outer mgc:  3.244692 
iter: 1  value: 8237.875 mgc: 1.647457 ustep: 1 
iter: 2  value: 8237.875 mgc: 0.002086922 ustep: 1 
iter: 3  value: 8237.875 mgc: 1.337315e-08 ustep: 1 
mgc: 5.107026e-15 
iter: 1  value: 8235.158 mgc: 0.5393355 ustep: 1 
iter: 2  value: 8235.158 mgc: 7.956096e-05 ustep: 1 
iter: 3  mgc: 1.045586e-11 
iter: 1  value: 8234.298 mgc: 0.1972105 ustep: 1 
iter: 2  value: 8234.298 mgc: 1.306856e-05 ustep: 1 
iter: 3  mgc: 1.758593e-13 
iter: 1  mgc: 1.758593e-13 
outer mgc:  1.753021 
iter: 1  value: 8234.622 mgc: 0.2018261 ustep: 1 
iter: 2  value: 8234.622 mgc: 3.044771e-05 ustep: 1 
iter: 3  mgc: 1.420419e-12 
iter: 1  mgc: 1.420419e-12 
outer mgc:  1.793829 
iter: 1  value: 8235.654 mgc: 0.4246854 ustep: 1 
iter: 2  value: 8235.654 mgc: 0.0001845314 ustep: 1 
iter: 3  mgc: 8.869538e-11 
iter: 1  mgc: 8.869538e-11 
outer mgc:  1.740373 
iter: 1  value: 8238.634 mgc: 0.7268807 ustep: 1 
iter: 2  value: 8238.634 mgc: 0.00115623 ustep: 1 
iter: 3  mgc: 1.970821e-09 
iter: 1  value: 8247.838 mgc: 1.759189 ustep: 1 
iter: 2  value: 8247.838 mgc: 0.01595065 ustep: 1 
iter: 3  value: 8247.838 mgc: 4.940116e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  value: 8282.8 mgc: 4.623825 ustep: 1 
iter: 2  value: 8282.65 mgc: 0.7936102 ustep: 1 
iter: 3  value: 8282.65 mgc: 0.01969216 ustep: 1 
iter: 4  value: 8282.65 mgc: 1.278663e-05 ustep: 1 
iter: 5  mgc: 5.710987e-12 
iter: 1  mgc: 7.105427e-15 
outer mgc:  3.678596 
iter: 1  value: 8260.119 mgc: 2.331122 ustep: 1 
iter: 2  value: 8260.119 mgc: 0.04773351 ustep: 1 
iter: 3  value: 8260.119 mgc: 2.48799e-06 ustep: 1 
iter: 4  mgc: 7.460699e-14 
iter: 1  mgc: 7.460699e-14 
outer mgc:  6.441307 
iter: 1  value: 8272.17 mgc: 1.603262 ustep: 1 
iter: 2  value: 8272.17 mgc: 0.05906188 ustep: 1 
iter: 3  value: 8272.17 mgc: 1.094299e-05 ustep: 1 
iter: 4  mgc: 1.929124e-12 
iter: 1  mgc: 1.929124e-12 
outer mgc:  6.929327 
iter: 1  value: 8270.762 mgc: 2.961578 ustep: 1 
iter: 2  value: 8270.762 mgc: 0.01323133 ustep: 1 
iter: 3  value: 8270.762 mgc: 1.80102e-06 ustep: 1 
iter: 4  mgc: 1.64313e-14 
iter: 1  mgc: 1.64313e-14 
outer mgc:  4.845737 
iter: 1  value: 8261.8 mgc: 1.357315 ustep: 1 
iter: 2  value: 8261.8 mgc: 0.0073885 ustep: 1 
iter: 3  value: 8261.8 mgc: 8.453116e-07 ustep: 1 
iter: 4  mgc: 5.495604e-15 
iter: 1  mgc: 5.495604e-15 
outer mgc:  7.844141 
iter: 1  value: 8254.722 mgc: 3.289286 ustep: 1 
iter: 2  value: 8254.722 mgc: 0.003337513 ustep: 1 
iter: 3  value: 8254.722 mgc: 3.625854e-07 ustep: 1 
iter: 4  mgc: 1.24345e-14 
iter: 1  mgc: 1.24345e-14 
outer mgc:  2.165842 
iter: 1  value: 8255.603 mgc: 1.016263 ustep: 1 
iter: 2  value: 8255.603 mgc: 0.003228038 ustep: 1 
iter: 3  value: 8255.603 mgc: 2.054422e-07 ustep: 1 
iter: 4  mgc: 8.65974e-15 
iter: 1  mgc: 8.65974e-15 
outer mgc:  1.426058 
iter: 1  value: 8254.641 mgc: 0.7856816 ustep: 1 
iter: 2  value: 8254.641 mgc: 0.001658725 ustep: 1 
iter: 3  value: 8254.641 mgc: 4.957335e-08 ustep: 1 
iter: 4  mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  0.5584466 
iter: 1  value: 8251.8 mgc: 0.4809113 ustep: 1 
iter: 2  value: 8251.8 mgc: 0.000144039 ustep: 1 
iter: 3  mgc: 1.737916e-10 
iter: 1  value: 8246.629 mgc: 0.9154897 ustep: 1 
iter: 2  value: 8246.629 mgc: 0.000382669 ustep: 1 
iter: 3  mgc: 1.108734e-09 
iter: 1  mgc: 1.108734e-09 
outer mgc:  3.586794 
iter: 1  value: 8239.373 mgc: 3.171723 ustep: 1 
iter: 2  value: 8239.373 mgc: 0.001727753 ustep: 1 
iter: 3  value: 8239.373 mgc: 2.434352e-08 ustep: 1 
mgc: 9.686696e-15 
iter: 1  mgc: 9.686696e-15 
outer mgc:  0.9628999 
iter: 1  value: 8231.805 mgc: 4.55957 ustep: 1 
iter: 2  value: 8231.805 mgc: 0.0007594076 ustep: 1 
iter: 3  mgc: 7.476697e-09 
iter: 1  mgc: 7.476697e-09 
outer mgc:  1.106535 
iter: 1  value: 8224.188 mgc: 1.979763 ustep: 1 
iter: 2  value: 8224.188 mgc: 0.0006060557 ustep: 1 
iter: 3  mgc: 7.089223e-10 
iter: 1  mgc: 7.089223e-10 
outer mgc:  0.7099309 
iter: 1  value: 8214.529 mgc: 1.862957 ustep: 1 
iter: 2  value: 8214.529 mgc: 0.0004246419 ustep: 1 
iter: 3  mgc: 5.37848e-10 
iter: 1  mgc: 5.37848e-10 
outer mgc:  0.3503812 
iter: 1  value: 8205.264 mgc: 3.191415 ustep: 1 
iter: 2  value: 8205.264 mgc: 0.0001992738 ustep: 1 
iter: 3  mgc: 1.269007e-10 
iter: 1  mgc: 1.269007e-10 
outer mgc:  0.3657969 
iter: 1  value: 8197.781 mgc: 1.585214 ustep: 1 
iter: 2  value: 8197.781 mgc: 4.482012e-05 ustep: 1 
iter: 3  mgc: 1.388267e-11 
iter: 1  mgc: 1.388267e-11 
outer mgc:  0.1342532 
iter: 1  value: 8186.474 mgc: 2.087558 ustep: 1 
iter: 2  value: 8186.474 mgc: 1.984129e-05 ustep: 1 
iter: 3  mgc: 1.348255e-12 
iter: 1  mgc: 1.348255e-12 
outer mgc:  0.1157129 
iter: 1  value: 8176.987 mgc: 1.645987 ustep: 1 
iter: 2  value: 8176.987 mgc: 8.15165e-06 ustep: 1 
iter: 3  mgc: 1.099121e-12 
iter: 1  mgc: 1.099121e-12 
outer mgc:  0.08621039 
iter: 1  value: 8169.175 mgc: 1.500497 ustep: 1 
iter: 2  value: 8169.175 mgc: 1.782696e-06 ustep: 1 
iter: 3  mgc: 1.465494e-13 
iter: 1  mgc: 1.465494e-13 
outer mgc:  0.02854304 
iter: 1  value: 8158.434 mgc: 2.223337 ustep: 1 
iter: 2  value: 8158.434 mgc: 1.547971e-06 ustep: 1 
iter: 3  mgc: 3.752554e-13 
iter: 1  mgc: 3.752554e-13 
outer mgc:  0.004947009 
iter: 1  value: 8149.571 mgc: 1.609266 ustep: 1 
iter: 2  value: 8149.571 mgc: 3.478858e-07 ustep: 1 
iter: 3  mgc: 3.33511e-13 
iter: 1  mgc: 3.33511e-13 
outer mgc:  0.005714546 
iter: 1  value: 8139.188 mgc: 1.931522 ustep: 1 
iter: 2  value: 8139.188 mgc: 2.118854e-07 ustep: 1 
iter: 3  mgc: 8.21565e-13 
iter: 1  mgc: 8.21565e-13 
outer mgc:  0.001959992 
iter: 1  value: 8130.592 mgc: 1.538153 ustep: 1 
iter: 2  value: 8130.592 mgc: 6.88128e-08 ustep: 1 
iter: 3  mgc: 8.55982e-13 
iter: 1  mgc: 8.55982e-13 
outer mgc:  0.001798014 
iter: 1  value: 8120.09 mgc: 1.998933 ustep: 1 
iter: 2  value: 8120.09 mgc: 5.087705e-08 ustep: 1 
iter: 3  mgc: 1.552869e-12 
iter: 1  mgc: 1.552869e-12 
outer mgc:  0.0008853688 
iter: 1  value: 8111.414 mgc: 1.587824 ustep: 1 
iter: 2  value: 8111.414 mgc: 1.616422e-08 ustep: 1 
mgc: 3.700151e-12 
iter: 1  mgc: 3.700151e-12 
outer mgc:  0.0008236315 
iter: 1  value: 8100.937 mgc: 1.99504 ustep: 1 
iter: 2  value: 8100.937 mgc: 1.097486e-08 ustep: 1 
mgc: 3.548717e-12 
iter: 1  mgc: 3.548717e-12 
outer mgc:  0.0005155665 
iter: 1  value: 8092.28 mgc: 1.576078 ustep: 1 
iter: 2  mgc: 3.418549e-09 
iter: 1  mgc: 3.418549e-09 
outer mgc:  0.0003911166 
iter: 1  value: 8081.793 mgc: 1.986458 ustep: 1 
iter: 2  mgc: 2.334366e-09 
iter: 1  mgc: 2.334366e-09 
outer mgc:  0.0002464071 
iter: 1  value: 8073.128 mgc: 1.578769 ustep: 1 
iter: 2  mgc: 7.367826e-10 
iter: 1  mgc: 7.367826e-10 
outer mgc:  0.0001751263 
iter: 1  value: 8062.642 mgc: 1.989245 ustep: 1 
iter: 2  mgc: 5.060925e-10 
iter: 1  mgc: 5.060925e-10 
outer mgc:  0.0001165549 
iter: 1  value: 8053.979 mgc: 1.580443 ustep: 1 
iter: 2  mgc: 1.585629e-10 
iter: 1  mgc: 1.585629e-10 
outer mgc:  8.142351e-05 
iter: 1  value: 8043.492 mgc: 1.988876 ustep: 1 
iter: 2  mgc: 1.163309e-10 
iter: 1  mgc: 1.163309e-10 
outer mgc:  5.508954e-05 
iter: 1  value: 8034.828 mgc: 1.580094 ustep: 1 
iter: 2  mgc: 5.507825e-11 
iter: 1  mgc: 5.507825e-11 
outer mgc:  3.780779e-05 
iter: 1  value: 8024.341 mgc: 1.988215 ustep: 1 
iter: 2  mgc: 8.489875e-11 
iter: 1  mgc: 8.489875e-11 
outer mgc:  2.569199e-05 
iter: 1  value: 8015.677 mgc: 1.58029 ustep: 1 
iter: 2  mgc: 1.114635e-10 
iter: 1  mgc: 1.114635e-10 
outer mgc:  1.752278e-05 
iter: 1  mgc: 1.114635e-10 
iter: 1  mgc: 1.114635e-10 
outer mgc:  1.752278e-05 
iter: 1  value: 8015.682 mgc: 0.005448369 ustep: 1 
iter: 2  value: 8015.682 mgc: 2.853401e-07 ustep: 1 
iter: 3  mgc: 1.319274e-10 
outer mgc:  0.196417 
iter: 1  value: 8015.671 mgc: 0.005449188 ustep: 1 
iter: 2  value: 8015.671 mgc: 2.849927e-07 ustep: 1 
iter: 3  mgc: 1.197513e-10 
outer mgc:  0.1964573 
iter: 1  value: 8015.68 mgc: 0.003030422 ustep: 1 
iter: 2  value: 8015.68 mgc: 8.511734e-08 ustep: 1 
iter: 3  mgc: 1.162275e-10 
outer mgc:  0.1072275 
iter: 1  value: 8015.673 mgc: 0.003030349 ustep: 1 
iter: 2  value: 8015.673 mgc: 8.511536e-08 ustep: 1 
iter: 3  mgc: 1.637097e-10 
outer mgc:  0.1072647 
iter: 1  value: 8015.675 mgc: 0.003803571 ustep: 1 
iter: 2  value: 8015.675 mgc: 8.214719e-08 ustep: 1 
iter: 3  mgc: 1.06042e-10 
outer mgc:  0.1101159 
iter: 1  value: 8015.679 mgc: 0.003800754 ustep: 1 
iter: 2  value: 8015.679 mgc: 8.199719e-08 ustep: 1 
iter: 3  mgc: 1.092335e-10 
outer mgc:  0.1100193 
iter: 1  value: 8015.676 mgc: 0.002154378 ustep: 1 
iter: 2  value: 8015.676 mgc: 2.040932e-08 ustep: 1 
mgc: 6.300827e-11 
outer mgc:  0.05491541 
iter: 1  value: 8015.677 mgc: 0.002153037 ustep: 1 
iter: 2  value: 8015.677 mgc: 2.036093e-08 ustep: 1 
mgc: 1.057032e-10 
outer mgc:  0.05485872 
iter: 1  value: 8015.713 mgc: 475.1865 ustep: 1 
iter: 2  value: 8015.713 mgc: 3.224437e-07 ustep: 1 
iter: 3  mgc: 1.128198e-10 
outer mgc:  0.02600433 
iter: 1  value: 8015.641 mgc: 476.6142 ustep: 1 
iter: 2  value: 8015.641 mgc: 3.227072e-07 ustep: 1 
iter: 3  mgc: 9.057244e-11 
outer mgc:  0.02591377 
iter: 1  value: 8015.716 mgc: 475.655 ustep: 1 
iter: 2  value: 8015.716 mgc: 9.993289e-07 ustep: 1 
iter: 3  mgc: 9.945378e-11 
outer mgc:  0.02357774 
iter: 1  value: 8015.637 mgc: 476.1309 ustep: 1 
iter: 2  value: 8015.637 mgc: 9.97237e-07 ustep: 1 
iter: 3  mgc: 9.235002e-11 
outer mgc:  0.02350777 
iter: 1  value: 8015.677 mgc: 2.132712e-05 ustep: 1 
mgc: 1.155818e-10 
outer mgc:  1.752288e-05 
iter: 1  value: 8015.677 mgc: 2.132712e-05 ustep: 1 
mgc: 1.175358e-10 
outer mgc:  1.752334e-05 
iter: 1  value: 8015.668 mgc: 0.004122637 ustep: 1 
iter: 2  value: 8015.668 mgc: 2.234471e-07 ustep: 1 
iter: 3  mgc: 1.45072e-10 
outer mgc:  0.07636361 
iter: 1  value: 8015.686 mgc: 0.004119835 ustep: 1 
iter: 2  value: 8015.686 mgc: 2.232218e-07 ustep: 1 
iter: 3  mgc: 1.681975e-10 
outer mgc:  0.07638046 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:38:29 2021]
Finished job 0.
1 of 1 steps (100%) done

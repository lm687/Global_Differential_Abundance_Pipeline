Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 11:33:02 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_20_100_10_3_0.2_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.2, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_20_100_10_3_0.2_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_20_100_10_3_0.2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4357.096337 
final  value 3269.922950 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3136.046 mgc: 4.209995 ustep: 0.6827823 
iter: 2  value: 3129.376 mgc: 4.660341 ustep: 0.8263238 
iter: 3  value: 3111.805 mgc: 4.301529 ustep: 0.2929644 
iter: 4  value: 3109.032 mgc: 3.226595 ustep: 0.5413077 
iter: 5  value: 3108.764 mgc: 1.047721 ustep: 0.7357626 
iter: 6  value: 3108.76 mgc: 0.04725249 ustep: 0.8577803 
iter: 7  value: 3108.76 mgc: 0.007842944 ustep: 0.9261717 
iter: 8  value: 3108.76 mgc: 0.000669676 ustep: 0.9623819 
iter: 9  value: 3108.76 mgc: 2.863082e-05 ustep: 0.9810125 
iter: 10  value: 3108.76 mgc: 6.102045e-07 ustep: 0.9904617 
iter: 11  mgc: 6.499399e-09 
iter: 1  mgc: 6.499399e-09 
Matching hessian patterns... Done
outer mgc:  19.76209 
iter: 1  value: 3079.696 mgc: 0.8587313 ustep: 1 
iter: 2  value: 3079.681 mgc: 0.1001497 ustep: 1 
iter: 3  value: 3079.681 mgc: 0.00121167 ustep: 1 
iter: 4  value: 3079.681 mgc: 2.552071e-07 ustep: 1 
iter: 5  mgc: 1.312839e-14 
iter: 1  mgc: 1.312839e-14 
outer mgc:  14.60948 
iter: 1  value: 3063.88 mgc: 1.579894 ustep: 1 
iter: 2  value: 3063.835 mgc: 0.319275 ustep: 1 
iter: 3  value: 3063.835 mgc: 0.007362963 ustep: 1 
iter: 4  value: 3063.835 mgc: 5.009372e-06 ustep: 1 
iter: 5  mgc: 2.14051e-12 
iter: 1  mgc: 2.14051e-12 
outer mgc:  29.96242 
iter: 1  value: 3054.767 mgc: 4.209332 ustep: 1 
iter: 2  value: 3047.545 mgc: 2.673323 ustep: 1 
iter: 3  value: 3047.477 mgc: 0.2313811 ustep: 1 
iter: 4  value: 3047.477 mgc: 0.008212023 ustep: 1 
iter: 5  value: 3047.477 mgc: 6.950332e-06 ustep: 1 
iter: 6  mgc: 5.607848e-12 
iter: 1  mgc: 5.607848e-12 
outer mgc:  16.0788 
iter: 1  value: 3034.915 mgc: 3.916295 ustep: 1 
iter: 2  value: 3032.309 mgc: 1.873421 ustep: 1 
iter: 3  value: 3032.297 mgc: 0.09808325 ustep: 1 
iter: 4  value: 3032.297 mgc: 0.001203823 ustep: 1 
iter: 5  value: 3032.297 mgc: 1.093075e-07 ustep: 1 
iter: 6  mgc: 4.801715e-15 
iter: 1  value: 3091.876 mgc: 10.85407 ustep: 1 
iter: 2  value: 3090.256 mgc: 1.365284 ustep: 1 
iter: 3  value: 3090.251 mgc: 0.1180617 ustep: 1 
iter: 4  value: 3090.251 mgc: 0.001541504 ustep: 1 
iter: 5  value: 3090.251 mgc: 2.695121e-07 ustep: 1 
iter: 6  mgc: 7.105427e-15 
iter: 1  mgc: 4.801715e-15 
outer mgc:  14.86576 
iter: 1  value: 2999.358 mgc: 108.1077 ustep: 1 
iter: 2  value: 2999.157 mgc: 1.928493 ustep: 1 
iter: 3  value: 2999.157 mgc: 0.02930965 ustep: 1 
iter: 4  value: 2999.157 mgc: 4.477095e-05 ustep: 1 
iter: 5  mgc: 1.348971e-10 
iter: 1  mgc: 1.348971e-10 
outer mgc:  14.01161 
iter: 1  value: 3169.487 mgc: 46.40064 ustep: 1 
iter: 2  value: 3168.705 mgc: 3.106252 ustep: 1 
iter: 3  value: 3168.704 mgc: 0.04481159 ustep: 1 
iter: 4  value: 3168.704 mgc: 3.738379e-06 ustep: 1 
iter: 5  mgc: 1.421085e-14 
iter: 1  value: 2996.28 mgc: 3.580586 ustep: 1 
iter: 2  value: 2996.279 mgc: 0.07022269 ustep: 1 
iter: 3  value: 2996.279 mgc: 0.0003037118 ustep: 1 
iter: 4  mgc: 5.569232e-09 
iter: 1  mgc: 5.569232e-09 
outer mgc:  8.083396 
iter: 1  value: 2995.556 mgc: 4.658447 ustep: 1 
iter: 2  value: 2995.555 mgc: 0.05864738 ustep: 1 
iter: 3  value: 2995.555 mgc: 0.0001456481 ustep: 1 
iter: 4  mgc: 6.107043e-10 
iter: 1  mgc: 6.107043e-10 
outer mgc:  6.929545 
iter: 1  value: 2994.128 mgc: 3.871475 ustep: 1 
iter: 2  value: 2994.127 mgc: 0.08055138 ustep: 1 
iter: 3  value: 2994.127 mgc: 0.0002612253 ustep: 1 
iter: 4  mgc: 2.242589e-09 
iter: 1  mgc: 2.242589e-09 
outer mgc:  9.608841 
iter: 1  value: 2993.542 mgc: 3.839072 ustep: 1 
iter: 2  value: 2993.542 mgc: 0.03067531 ustep: 1 
iter: 3  value: 2993.542 mgc: 2.255223e-05 ustep: 1 
iter: 4  mgc: 1.4035e-11 
iter: 1  mgc: 1.4035e-11 
outer mgc:  2.354484 
iter: 1  value: 2993.111 mgc: 1.744304 ustep: 1 
iter: 2  value: 2993.111 mgc: 0.01406521 ustep: 1 
iter: 3  value: 2993.111 mgc: 5.929825e-06 ustep: 1 
iter: 4  mgc: 6.847856e-13 
iter: 1  mgc: 6.847856e-13 
outer mgc:  2.596204 
iter: 1  value: 2991.958 mgc: 1.657302 ustep: 1 
iter: 2  value: 2991.958 mgc: 0.0105048 ustep: 1 
iter: 3  value: 2991.958 mgc: 1.418268e-06 ustep: 1 
iter: 4  mgc: 1.110223e-14 
iter: 1  mgc: 1.110223e-14 
outer mgc:  2.168502 
iter: 1  value: 2989.283 mgc: 2.555155 ustep: 1 
iter: 2  value: 2989.283 mgc: 0.009935579 ustep: 1 
iter: 3  value: 2989.283 mgc: 3.996597e-07 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  2.065294 
iter: 1  value: 2984.788 mgc: 2.572807 ustep: 1 
iter: 2  value: 2984.788 mgc: 0.006374534 ustep: 1 
iter: 3  value: 2984.788 mgc: 7.061551e-08 ustep: 1 
iter: 4  mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  1.61982 
iter: 1  value: 2980.876 mgc: 3.298648 ustep: 1 
iter: 2  value: 2980.876 mgc: 0.002282674 ustep: 1 
iter: 3  value: 2980.876 mgc: 2.574649e-08 ustep: 1 
mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  0.7464602 
iter: 1  value: 2978.989 mgc: 1.565894 ustep: 1 
iter: 2  value: 2978.989 mgc: 0.0005382872 ustep: 1 
iter: 3  mgc: 6.328196e-10 
iter: 1  mgc: 6.328196e-10 
outer mgc:  1.683384 
iter: 1  value: 2976.736 mgc: 2.142262 ustep: 1 
iter: 2  value: 2976.736 mgc: 0.0006050376 ustep: 1 
iter: 3  mgc: 1.689857e-10 
iter: 1  value: 2978.286 mgc: 0.651233 ustep: 1 
iter: 2  value: 2978.286 mgc: 0.0001228018 ustep: 1 
iter: 3  mgc: 3.916756e-11 
iter: 1  mgc: 3.916756e-11 
outer mgc:  1.608486 
iter: 1  value: 2978.227 mgc: 0.8925959 ustep: 1 
iter: 2  value: 2978.227 mgc: 0.0005382091 ustep: 1 
iter: 3  mgc: 5.584096e-09 
iter: 1  mgc: 5.584096e-09 
outer mgc:  0.2304341 
iter: 1  value: 2977.598 mgc: 0.9014582 ustep: 1 
iter: 2  value: 2977.598 mgc: 0.0004830382 ustep: 1 
iter: 3  mgc: 4.239629e-09 
iter: 1  mgc: 4.239629e-09 
outer mgc:  0.05884426 
iter: 1  value: 2977.042 mgc: 0.2088209 ustep: 1 
iter: 2  value: 2977.042 mgc: 4.240911e-06 ustep: 1 
iter: 3  mgc: 3.463896e-13 
iter: 1  value: 2976.231 mgc: 0.3116949 ustep: 1 
iter: 2  value: 2976.231 mgc: 7.752623e-06 ustep: 1 
iter: 3  mgc: 1.147527e-12 
iter: 1  mgc: 1.147527e-12 
outer mgc:  0.3697363 
iter: 1  value: 2975.041 mgc: 0.9161713 ustep: 1 
iter: 2  value: 2975.041 mgc: 0.0002082366 ustep: 1 
iter: 3  mgc: 7.795937e-10 
iter: 1  mgc: 7.795937e-10 
outer mgc:  0.344708 
iter: 1  value: 2971.889 mgc: 2.639551 ustep: 1 
iter: 2  value: 2971.889 mgc: 0.0001119279 ustep: 1 
iter: 3  mgc: 1.118581e-10 
iter: 1  mgc: 1.118581e-10 
outer mgc:  0.1745524 
iter: 1  value: 2968.542 mgc: 3.906066 ustep: 1 
iter: 2  value: 2968.542 mgc: 0.0006323409 ustep: 1 
iter: 3  mgc: 6.706413e-10 
iter: 1  mgc: 6.706413e-10 
outer mgc:  0.05076514 
iter: 1  value: 2966.06 mgc: 4.088498 ustep: 1 
iter: 2  value: 2966.06 mgc: 0.0007140253 ustep: 1 
iter: 3  mgc: 3.876197e-10 
iter: 1  mgc: 3.876197e-10 
outer mgc:  0.03165304 
iter: 1  value: 2963.584 mgc: 3.811179 ustep: 1 
iter: 2  value: 2963.584 mgc: 0.0001663009 ustep: 1 
iter: 3  mgc: 7.555734e-11 
iter: 1  mgc: 7.555734e-11 
outer mgc:  0.06628694 
iter: 1  value: 2960.971 mgc: 2.247115 ustep: 1 
iter: 2  value: 2960.971 mgc: 6.359834e-06 ustep: 1 
iter: 3  mgc: 5.062617e-13 
iter: 1  mgc: 5.062617e-13 
outer mgc:  0.06365298 
iter: 1  value: 2956.463 mgc: 2.371133 ustep: 1 
iter: 2  value: 2956.463 mgc: 4.495042e-05 ustep: 1 
iter: 3  mgc: 3.686074e-11 
iter: 1  mgc: 3.686074e-11 
outer mgc:  0.03536312 
iter: 1  value: 2952.674 mgc: 2.295709 ustep: 1 
iter: 2  value: 2952.674 mgc: 3.006219e-05 ustep: 1 
iter: 3  mgc: 1.03535e-11 
iter: 1  mgc: 1.03535e-11 
outer mgc:  0.008566104 
iter: 1  value: 2949.547 mgc: 1.6152 ustep: 1 
iter: 2  value: 2949.547 mgc: 8.660057e-06 ustep: 1 
iter: 3  mgc: 1.034284e-12 
iter: 1  mgc: 1.034284e-12 
outer mgc:  0.007744165 
iter: 1  value: 2945.405 mgc: 2.334868 ustep: 1 
iter: 2  value: 2945.405 mgc: 1.998651e-06 ustep: 1 
iter: 3  mgc: 1.747491e-13 
iter: 1  mgc: 1.747491e-13 
outer mgc:  0.009990919 
iter: 1  value: 2942.062 mgc: 3.562508 ustep: 1 
iter: 2  value: 2942.062 mgc: 1.471386e-06 ustep: 1 
iter: 3  mgc: 2.229328e-13 
iter: 1  mgc: 2.229328e-13 
outer mgc:  0.007242873 
iter: 1  value: 2937.913 mgc: 6.679582 ustep: 1 
iter: 2  value: 2937.913 mgc: 5.20685e-06 ustep: 1 
iter: 3  mgc: 6.914469e-13 
iter: 1  mgc: 6.914469e-13 
outer mgc:  0.001076275 
iter: 1  value: 2934.465 mgc: 5.53323 ustep: 1 
iter: 2  value: 2934.465 mgc: 1.650585e-06 ustep: 1 
iter: 3  mgc: 7.164269e-13 
iter: 1  mgc: 7.164269e-13 
outer mgc:  0.003959559 
iter: 1  value: 2930.453 mgc: 4.36184 ustep: 1 
iter: 2  value: 2930.453 mgc: 2.620223e-07 ustep: 1 
iter: 3  mgc: 1.014744e-12 
iter: 1  mgc: 1.014744e-12 
outer mgc:  0.005054881 
iter: 1  value: 2927.081 mgc: 1.743085 ustep: 1 
iter: 2  value: 2927.081 mgc: 1.083018e-07 ustep: 1 
iter: 3  mgc: 1.229683e-12 
iter: 1  mgc: 1.229683e-12 
outer mgc:  0.003770496 
iter: 1  value: 2922.811 mgc: 4.11977 ustep: 1 
iter: 2  value: 2922.811 mgc: 4.016899e-07 ustep: 1 
iter: 3  mgc: 8.864021e-13 
iter: 1  mgc: 8.864021e-13 
outer mgc:  0.0009710722 
iter: 1  value: 2919.296 mgc: 3.276422 ustep: 1 
iter: 2  value: 2919.296 mgc: 1.549563e-07 ustep: 1 
iter: 3  mgc: 1.417977e-12 
iter: 1  mgc: 1.417977e-12 
outer mgc:  0.0007796176 
iter: 1  value: 2915.176 mgc: 2.553113 ustep: 1 
iter: 2  value: 2915.176 mgc: 1.919311e-08 ustep: 1 
mgc: 3.98348e-12 
iter: 1  mgc: 3.98348e-12 
outer mgc:  0.001321806 
iter: 1  value: 2911.772 mgc: 4.764169 ustep: 1 
iter: 2  value: 2911.772 mgc: 1.021116e-08 ustep: 1 
mgc: 4.409806e-12 
iter: 1  mgc: 4.409806e-12 
outer mgc:  0.0009691969 
iter: 1  value: 2907.556 mgc: 11.30003 ustep: 1 
iter: 2  value: 2907.556 mgc: 5.44473e-08 ustep: 1 
mgc: 7.439382e-12 
iter: 1  mgc: 7.439382e-12 
outer mgc:  0.0002498598 
iter: 1  value: 2904.075 mgc: 10.34574 ustep: 1 
iter: 2  value: 2904.075 mgc: 1.973267e-08 ustep: 1 
mgc: 1.522116e-11 
iter: 1  mgc: 1.522116e-11 
outer mgc:  0.0003170201 
iter: 1  value: 2899.929 mgc: 7.511086 ustep: 1 
iter: 2  mgc: 4.568681e-09 
iter: 1  mgc: 4.568681e-09 
outer mgc:  0.0005080675 
iter: 1  value: 2896.492 mgc: 2.310178 ustep: 1 
iter: 2  mgc: 1.006064e-09 
iter: 1  mgc: 1.006064e-09 
outer mgc:  0.0004095179 
iter: 1  value: 2892.279 mgc: 11.40915 ustep: 1 
iter: 2  mgc: 4.846607e-09 
iter: 1  mgc: 4.846607e-09 
outer mgc:  0.0001249877 
iter: 1  value: 2888.8 mgc: 9.859501 ustep: 1 
iter: 2  mgc: 2.265192e-09 
iter: 1  mgc: 2.265192e-09 
outer mgc:  8.089592e-05 
iter: 1  mgc: 2.265192e-09 
iter: 1  mgc: 2.265192e-09 
outer mgc:  8.089592e-05 
iter: 1  value: 2888.804 mgc: 0.005816191 ustep: 1 
iter: 2  value: 2888.804 mgc: 3.761305e-08 ustep: 1 
mgc: 4.861112e-11 
outer mgc:  0.1008679 
iter: 1  value: 2888.797 mgc: 0.005818632 ustep: 1 
iter: 2  value: 2888.797 mgc: 3.765334e-08 ustep: 1 
mgc: 7.852963e-11 
outer mgc:  0.1009883 
iter: 1  value: 2888.802 mgc: 0.002953274 ustep: 1 
iter: 2  value: 2888.802 mgc: 2.77821e-08 ustep: 1 
mgc: 3.822054e-11 
outer mgc:  0.04750057 
iter: 1  value: 2888.799 mgc: 0.002954804 ustep: 1 
iter: 2  value: 2888.799 mgc: 2.779054e-08 ustep: 1 
mgc: 9.171108e-11 
outer mgc:  0.04757689 
iter: 1  value: 2888.798 mgc: 0.003988935 ustep: 1 
iter: 2  value: 2888.798 mgc: 2.069483e-07 ustep: 1 
iter: 3  mgc: 4.749678e-11 
outer mgc:  0.04505463 
iter: 1  value: 2888.803 mgc: 0.003985543 ustep: 1 
iter: 2  value: 2888.803 mgc: 2.067529e-07 ustep: 1 
iter: 3  mgc: 6.452572e-11 
outer mgc:  0.04486855 
iter: 1  value: 2888.799 mgc: 0.002135665 ustep: 1 
iter: 2  value: 2888.799 mgc: 6.583243e-08 ustep: 1 
iter: 3  mgc: 1.035605e-10 
outer mgc:  0.02374617 
iter: 1  value: 2888.801 mgc: 0.002134214 ustep: 1 
iter: 2  value: 2888.801 mgc: 6.574247e-08 ustep: 1 
iter: 3  mgc: 8.75815e-11 
outer mgc:  0.02363348 
iter: 1  value: 2888.821 mgc: 424.5465 ustep: 1 
iter: 2  value: 2888.821 mgc: 2.158565e-07 ustep: 1 
iter: 3  mgc: 5.059797e-11 
outer mgc:  0.002335453 
iter: 1  value: 2888.78 mgc: 425.822 ustep: 1 
iter: 2  value: 2888.78 mgc: 2.155005e-07 ustep: 1 
iter: 3  mgc: 3.846168e-11 
outer mgc:  0.002217575 
iter: 1  value: 2888.813 mgc: 424.9739 ustep: 1 
iter: 2  value: 2888.813 mgc: 1.581853e-06 ustep: 1 
iter: 3  mgc: 7.134426e-11 
outer mgc:  0.007337009 
iter: 1  value: 2888.788 mgc: 425.3991 ustep: 1 
iter: 2  value: 2888.788 mgc: 1.576995e-06 ustep: 1 
iter: 3  mgc: 6.059597e-11 
outer mgc:  0.007426415 
iter: 1  value: 2888.8 mgc: 5.610727e-05 ustep: 1 
mgc: 8.407897e-11 
outer mgc:  8.089585e-05 
iter: 1  value: 2888.801 mgc: 5.61033e-05 ustep: 1 
mgc: 4.578027e-11 
outer mgc:  8.089604e-05 
iter: 1  value: 2888.798 mgc: 0.004290396 ustep: 1 
iter: 2  value: 2888.798 mgc: 1.417288e-07 ustep: 1 
iter: 3  mgc: 1.047371e-10 
outer mgc:  0.03007964 
iter: 1  value: 2888.803 mgc: 0.004287972 ustep: 1 
iter: 2  value: 2888.803 mgc: 1.413761e-07 ustep: 1 
iter: 3  mgc: 6.07927e-11 
outer mgc:  0.03004453 
[Fri Aug 13 11:33:06 2021]
Finished job 0.
1 of 1 steps (100%) done

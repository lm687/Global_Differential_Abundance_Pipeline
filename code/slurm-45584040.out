Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 20:14:43 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_10_100_80_3_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_10_100_80_3_4_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_10_100_80_3_4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2182.942618 
iter  10 value 1901.334404
iter  10 value 1901.334404
final  value 1901.334404 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1970.124 mgc: 1.461038 ustep: 1 
iter: 2  value: 1970.057 mgc: 0.2187009 ustep: 1 
iter: 3  value: 1970.057 mgc: 0.006736394 ustep: 1 
iter: 4  value: 1970.057 mgc: 7.091901e-06 ustep: 1 
iter: 5  mgc: 9.776291e-12 
iter: 1  mgc: 9.776291e-12 
Matching hessian patterns... Done
outer mgc:  10.01587 
iter: 1  value: 1952.431 mgc: 0.4909791 ustep: 1 
iter: 2  value: 1952.431 mgc: 0.00994394 ustep: 1 
iter: 3  value: 1952.431 mgc: 2.033677e-05 ustep: 1 
iter: 4  mgc: 4.722095e-11 
iter: 1  value: 1907.975 mgc: 14.78497 ustep: 1 
iter: 2  value: 1907.88 mgc: 0.7594259 ustep: 1 
iter: 3  value: 1907.88 mgc: 0.006412215 ustep: 1 
iter: 4  value: 1907.88 mgc: 3.645586e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  mgc: 3.996803e-15 
outer mgc:  19.08435 
iter: 1  value: 1953.845 mgc: 297.121 ustep: 1 
iter: 2  value: 1953.843 mgc: 0.1785745 ustep: 1 
iter: 3  value: 1953.843 mgc: 5.464574e-05 ustep: 1 
iter: 4  mgc: 5.023537e-12 
iter: 1  value: 1901.727 mgc: 4.441883 ustep: 1 
iter: 2  value: 1901.715 mgc: 0.1184037 ustep: 1 
iter: 3  value: 1901.715 mgc: 0.0001965021 ustep: 1 
iter: 4  mgc: 7.757842e-10 
iter: 1  mgc: 7.757842e-10 
outer mgc:  13.43421 
iter: 1  value: 1884.103 mgc: 3.957229 ustep: 1 
iter: 2  value: 1884.103 mgc: 0.01943363 ustep: 1 
iter: 3  value: 1884.103 mgc: 6.204486e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  8.527732 
iter: 1  value: 1871.872 mgc: 6.977597 ustep: 1 
iter: 2  value: 1871.872 mgc: 0.01504625 ustep: 1 
iter: 3  value: 1871.872 mgc: 1.122568e-06 ustep: 1 
iter: 4  mgc: 1.421085e-14 
iter: 1  mgc: 1.421085e-14 
outer mgc:  22.87244 
iter: 1  value: 1862.157 mgc: 13.0989 ustep: 1 
iter: 2  value: 1862.157 mgc: 0.05434869 ustep: 1 
iter: 3  value: 1862.157 mgc: 2.418003e-06 ustep: 1 
iter: 4  mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  22.73932 
iter: 1  value: 1853.261 mgc: 4.029961 ustep: 1 
iter: 2  value: 1853.261 mgc: 0.005947088 ustep: 1 
iter: 3  value: 1853.261 mgc: 2.53343e-08 ustep: 1 
mgc: 2.620126e-14 
iter: 1  mgc: 2.620126e-14 
outer mgc:  4.225537 
iter: 1  value: 1861.448 mgc: 13.03787 ustep: 1 
iter: 2  value: 1861.433 mgc: 1.17266 ustep: 1 
iter: 3  value: 1861.433 mgc: 0.001312547 ustep: 1 
iter: 4  value: 1861.433 mgc: 1.356714e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  value: 1857.576 mgc: 8.067073 ustep: 1 
iter: 2  value: 1857.576 mgc: 0.09274207 ustep: 1 
iter: 3  value: 1857.576 mgc: 1.75457e-05 ustep: 1 
iter: 4  mgc: 1.501022e-12 
iter: 1  value: 1853.783 mgc: 3.198912 ustep: 1 
iter: 2  value: 1853.783 mgc: 0.003165265 ustep: 1 
iter: 3  value: 1853.783 mgc: 2.2124e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  value: 1853.178 mgc: 1.286078 ustep: 1 
iter: 2  value: 1853.178 mgc: 0.0004387736 ustep: 1 
iter: 3  mgc: 4.35425e-10 
iter: 1  mgc: 4.35425e-10 
outer mgc:  4.764979 
iter: 1  value: 1853.123 mgc: 2.20147 ustep: 1 
iter: 2  value: 1853.123 mgc: 0.0004008126 ustep: 1 
iter: 3  mgc: 3.934542e-11 
iter: 1  mgc: 3.934542e-11 
outer mgc:  3.870145 
iter: 1  value: 1853.406 mgc: 3.346934 ustep: 1 
iter: 2  value: 1853.406 mgc: 0.004881099 ustep: 1 
iter: 3  value: 1853.406 mgc: 2.829767e-08 ustep: 1 
mgc: 3.153033e-14 
iter: 1  mgc: 3.153033e-14 
outer mgc:  3.577766 
iter: 1  value: 1854.521 mgc: 6.567059 ustep: 1 
iter: 2  value: 1854.521 mgc: 0.02496323 ustep: 1 
iter: 3  value: 1854.521 mgc: 3.906488e-07 ustep: 1 
iter: 4  mgc: 2.015055e-14 
iter: 1  value: 1857.749 mgc: 9.363796 ustep: 1 
iter: 2  value: 1857.748 mgc: 0.3190456 ustep: 1 
iter: 3  value: 1857.748 mgc: 5.058746e-05 ustep: 1 
iter: 4  mgc: 1.315659e-11 
iter: 1  value: 1888.796 mgc: 8.344716 ustep: 1 
iter: 2  value: 1888.769 mgc: 0.6945842 ustep: 1 
iter: 3  value: 1888.769 mgc: 0.00247525 ustep: 1 
iter: 4  value: 1888.769 mgc: 4.287268e-08 ustep: 1 
mgc: 1.04472e-13 
iter: 1  mgc: 1.315659e-11 
outer mgc:  7.631962 
iter: 1  value: 1860.35 mgc: 5.417844 ustep: 1 
iter: 2  value: 1860.348 mgc: 0.3251975 ustep: 1 
iter: 3  value: 1860.348 mgc: 0.0008662804 ustep: 1 
iter: 4  mgc: 9.039442e-09 
iter: 1  mgc: 9.039442e-09 
outer mgc:  9.729624 
iter: 1  value: 1862.44 mgc: 12.74114 ustep: 1 
iter: 2  value: 1862.437 mgc: 0.1970095 ustep: 1 
iter: 3  value: 1862.437 mgc: 8.656341e-05 ustep: 1 
iter: 4  mgc: 5.500755e-11 
iter: 1  value: 1860.339 mgc: 12.25728 ustep: 1 
iter: 2  value: 1860.338 mgc: 0.1384624 ustep: 1 
iter: 3  value: 1860.338 mgc: 0.0002073931 ustep: 1 
iter: 4  mgc: 2.602815e-10 
iter: 1  mgc: 2.602815e-10 
outer mgc:  13.2417 
iter: 1  value: 1857.333 mgc: 9.679137 ustep: 1 
iter: 2  value: 1857.332 mgc: 0.1212706 ustep: 1 
iter: 3  value: 1857.332 mgc: 5.538119e-05 ustep: 1 
iter: 4  mgc: 4.317879e-12 
iter: 1  mgc: 4.317879e-12 
outer mgc:  14.26998 
iter: 1  value: 1854.119 mgc: 10.1602 ustep: 1 
iter: 2  value: 1854.119 mgc: 0.02998342 ustep: 1 
iter: 3  value: 1854.119 mgc: 4.760655e-06 ustep: 1 
iter: 4  mgc: 1.660894e-13 
iter: 1  mgc: 1.660894e-13 
outer mgc:  7.731083 
iter: 1  value: 1854.124 mgc: 2.143648 ustep: 1 
iter: 2  value: 1854.124 mgc: 0.02265346 ustep: 1 
iter: 3  value: 1854.124 mgc: 1.836391e-06 ustep: 1 
iter: 4  mgc: 1.98952e-13 
iter: 1  mgc: 1.98952e-13 
outer mgc:  6.819974 
iter: 1  value: 1852.562 mgc: 5.700063 ustep: 1 
iter: 2  value: 1852.562 mgc: 0.007464964 ustep: 1 
iter: 3  value: 1852.562 mgc: 4.469242e-07 ustep: 1 
mgc: 2.304823e-13 
iter: 1  mgc: 2.304823e-13 
outer mgc:  10.93267 
iter: 1  value: 1851.517 mgc: 5.73863 ustep: 1 
iter: 2  value: 1851.517 mgc: 0.01653011 ustep: 1 
iter: 3  value: 1851.517 mgc: 1.778343e-07 ustep: 1 
mgc: 1.234568e-13 
iter: 1  value: 1850.982 mgc: 5.482458 ustep: 1 
iter: 2  value: 1850.982 mgc: 0.01591666 ustep: 1 
iter: 3  value: 1850.982 mgc: 2.065265e-07 ustep: 1 
mgc: 2.482459e-13 
iter: 1  mgc: 2.482459e-13 
outer mgc:  7.130505 
iter: 1  value: 1849.542 mgc: 4.539163 ustep: 1 
iter: 2  value: 1849.542 mgc: 0.0202072 ustep: 1 
iter: 3  value: 1849.542 mgc: 8.840356e-07 ustep: 1 
iter: 4  mgc: 3.538281e-13 
iter: 1  mgc: 3.538281e-13 
outer mgc:  3.699608 
iter: 1  value: 1847.694 mgc: 11.39644 ustep: 1 
iter: 2  value: 1847.693 mgc: 0.06232933 ustep: 1 
iter: 3  value: 1847.693 mgc: 9.259878e-06 ustep: 1 
iter: 4  mgc: 5.679901e-13 
iter: 1  value: 1848.578 mgc: 3.94574 ustep: 1 
iter: 2  value: 1848.578 mgc: 0.01208157 ustep: 1 
iter: 3  value: 1848.578 mgc: 3.37286e-07 ustep: 1 
iter: 4  mgc: 4.967138e-13 
iter: 1  mgc: 4.967138e-13 
outer mgc:  4.497128 
iter: 1  value: 1847.813 mgc: 1.204394 ustep: 1 
iter: 2  value: 1847.813 mgc: 0.004540342 ustep: 1 
iter: 3  value: 1847.813 mgc: 8.143358e-08 ustep: 1 
mgc: 4.95326e-13 
iter: 1  value: 1847.131 mgc: 1.887168 ustep: 1 
iter: 2  value: 1847.131 mgc: 0.006456567 ustep: 1 
iter: 3  value: 1847.131 mgc: 1.185317e-07 ustep: 1 
iter: 4  mgc: 6.004086e-13 
iter: 1  mgc: 6.004086e-13 
outer mgc:  3.126205 
iter: 1  value: 1845.082 mgc: 4.881737 ustep: 1 
iter: 2  value: 1845.082 mgc: 0.005462616 ustep: 1 
iter: 3  value: 1845.082 mgc: 3.250099e-08 ustep: 1 
mgc: 2.010836e-12 
iter: 1  mgc: 2.010836e-12 
outer mgc:  6.121156 
iter: 1  value: 1844.951 mgc: 2.22568 ustep: 1 
iter: 2  value: 1844.951 mgc: 0.001071787 ustep: 1 
iter: 3  mgc: 4.532014e-09 
iter: 1  mgc: 4.532014e-09 
outer mgc:  4.258596 
iter: 1  value: 1844.223 mgc: 7.814171 ustep: 1 
iter: 2  value: 1844.223 mgc: 0.008668352 ustep: 1 
iter: 3  value: 1844.223 mgc: 8.809289e-08 ustep: 1 
mgc: 2.515765e-12 
iter: 1  mgc: 2.515765e-12 
outer mgc:  3.348577 
iter: 1  value: 1843.817 mgc: 3.86608 ustep: 1 
iter: 2  value: 1843.817 mgc: 0.001343053 ustep: 1 
iter: 3  mgc: 2.603039e-09 
iter: 1  mgc: 2.603039e-09 
outer mgc:  1.11003 
iter: 1  value: 1843.099 mgc: 2.439334 ustep: 1 
iter: 2  value: 1843.099 mgc: 0.0004395785 ustep: 1 
iter: 3  mgc: 2.560676e-10 
iter: 1  mgc: 2.560676e-10 
outer mgc:  0.2197677 
iter: 1  value: 1841.872 mgc: 3.963701 ustep: 1 
iter: 2  value: 1841.872 mgc: 0.000441 ustep: 1 
iter: 3  mgc: 2.000256e-10 
iter: 1  mgc: 2.000256e-10 
outer mgc:  1.07015 
iter: 1  value: 1840.762 mgc: 3.862696 ustep: 1 
iter: 2  value: 1840.762 mgc: 0.0002016906 ustep: 1 
iter: 3  mgc: 1.376517e-10 
iter: 1  mgc: 1.376517e-10 
outer mgc:  0.9419672 
iter: 1  value: 1838.896 mgc: 7.187805 ustep: 1 
iter: 2  value: 1838.896 mgc: 0.0005168351 ustep: 1 
iter: 3  mgc: 7.076206e-10 
iter: 1  mgc: 7.076206e-10 
outer mgc:  0.3550668 
iter: 1  value: 1837.299 mgc: 6.165617 ustep: 1 
iter: 2  value: 1837.299 mgc: 0.0002430486 ustep: 0.989901 
iter: 3  value: 1837.299 mgc: 5.869239e-08 ustep: 0.9949382 
mgc: 2.537659e-10 
iter: 1  mgc: 2.537659e-10 
outer mgc:  0.3019253 
iter: 1  value: 1835.924 mgc: 5.081078 ustep: 1 
iter: 2  value: 1835.924 mgc: 6.126717e-05 ustep: 1 
iter: 3  mgc: 6.92528e-10 
iter: 1  mgc: 6.92528e-10 
outer mgc:  0.2263926 
iter: 1  value: 1833.846 mgc: 8.393415 ustep: 1 
iter: 2  value: 1833.846 mgc: 5.713629e-05 ustep: 1 
iter: 3  mgc: 5.452637e-09 
iter: 1  mgc: 5.452637e-09 
outer mgc:  0.2335214 
iter: 1  value: 1832.123 mgc: 6.62126 ustep: 1 
iter: 2  value: 1832.123 mgc: 1.089901e-05 ustep: 1 
iter: 3  value: 1832.123 mgc: 6.310802e-08 ustep: 1.706347e-08 
mgc: 6.207836e-08 
iter: 1  value: 1832.123 mgc: 6.207836e-08 ustep: 1.066041e-09 
mgc: 6.20781e-08 
outer mgc:  0.06188827 
iter: 1  value: 1830.142 mgc: 7.948738 ustep: 1 
iter: 2  value: 1830.142 mgc: 8.859121e-06 ustep: 0.8994163 
iter: 3  value: 1830.142 mgc: 1.364543e-06 ustep: 0.005765638 
mgc: 1.331896e-06 
iter: 1  value: 1830.142 mgc: 1.331896e-06 ustep: 1.332151e-10 
mgc: 1.331895e-06 
outer mgc:  0.04736756 
iter: 1  value: 1828.243 mgc: 7.551022 ustep: 1 
iter: 2  value: 1828.241 mgc: 5.047119e-05 ustep: 0.989901 
iter: 3  value: 1828.239 mgc: 2.850848e-05 ustep: 0.0006438489 
iter: 4  value: 1828.239 mgc: 3.101751e-05 ustep: 9.824837e-08 
mgc: 3.269651e-05 
iter: 1  value: 1828.239 mgc: 3.269651e-05 ustep: 1.332151e-10 
mgc: 3.489383e-05 
outer mgc:  0.07748031 
iter: 1  value: 1782.75 mgc: 15.69886 ustep: 4.265015e-09 
iter: 2  value: 1782.75 mgc: 15.72361 ustep: 1.871342e-17 
mgc: 15.68583 
iter: 1  value: 1782.75 mgc: 15.68583 ustep: 1.584401e-17 
mgc: 15.68583 
outer mgc:  0.07899703 
iter: 1  value: 1.055531e+14 mgc: 145.2288 ustep: 0.9999 
iter: 2  value: -1.785607e+15 mgc: 0.0001292933 ustep: 0.99995 
iter: 3  mgc: 3.853155e-09 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853156e-09 
iter: 1  mgc: 3.853155e-09 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  value: -1.882364e+15 mgc: 1.088994e-07 ustep: 0.0005598185 
mgc: 5.41415e-09 
outer mgc:  2.952123e-11 
iter: 1  value: -2.075878e+15 mgc: 1.153906e-07 ustep: 0.01776843 
mgc: 3.694521e-09 
outer mgc:  7.975134e-11 
iter: 1  value: -2.489294e+15 mgc: 1.151601e-07 ustep: 0.4367355 
mgc: 1.672722e-09 
outer mgc:  5.746336e-11 
iter: 1  value: -2.65642e+15 mgc: 1.091174e-07 ustep: 0.4367355 
mgc: 1.675501e-09 
outer mgc:  3.311306e-11 
iter: 1  mgc: 3.853167e-09 
outer mgc:  6.462383e-11 
iter: 1  mgc: 3.853144e-09 
outer mgc:  2.952124e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
iter: 1  mgc: 3.853155e-09 
outer mgc:  3.191051e-11 
[Sun Aug 15 20:14:45 2021]
Finished job 0.
1 of 1 steps (100%) done

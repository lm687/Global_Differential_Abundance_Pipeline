Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:49:56 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_80_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22067.825042 
final  value 21569.017175 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 21329.39 mgc: 4.107311 ustep: 0.6827823 
iter: 2  value: 21315.3 mgc: 1.951763 ustep: 0.8263238 
iter: 3  value: 21314.06 mgc: 1.535603 ustep: 0.9090326 
iter: 4  value: 21314.05 mgc: 0.2060559 ustep: 0.9534367 
iter: 5  value: 21314.05 mgc: 0.006720978 ustep: 0.9764432 
iter: 6  value: 21314.05 mgc: 7.653005e-05 ustep: 0.9881526 
iter: 7  value: 21314.05 mgc: 5.387378e-07 ustep: 0.9940592 
iter: 8  mgc: 2.061612e-09 
iter: 1  mgc: 2.061612e-09 
Matching hessian patterns... Done
outer mgc:  175.2437 
iter: 1  value: 21069.55 mgc: 1.295477 ustep: 1 
iter: 2  value: 21069.53 mgc: 0.1183233 ustep: 1 
iter: 3  value: 21069.53 mgc: 0.001447228 ustep: 1 
iter: 4  value: 21069.53 mgc: 2.422717e-07 ustep: 1 
iter: 5  mgc: 7.577272e-15 
iter: 1  value: 20594.19 mgc: 13.32963 ustep: 1 
iter: 2  value: 20592.64 mgc: 1.765576 ustep: 1 
iter: 3  value: 20592.64 mgc: 0.02196805 ustep: 1 
iter: 4  value: 20592.64 mgc: 1.757915e-06 ustep: 1 
iter: 5  mgc: 1.048051e-13 
iter: 1  mgc: 1.048051e-13 
outer mgc:  118.5005 
iter: 1  value: 23284.42 mgc: 24.54229 ustep: 1 
iter: 2  value: 23283.35 mgc: 1.775261 ustep: 1 
iter: 3  value: 23283.35 mgc: 0.1107487 ustep: 1 
iter: 4  value: 23283.35 mgc: 0.0005170676 ustep: 1 
iter: 5  value: 23283.35 mgc: 1.139586e-08 ustep: 1 
mgc: 4.396483e-14 
iter: 1  value: 20572.57 mgc: 5.430478 ustep: 1 
iter: 2  value: 20572.44 mgc: 0.3152499 ustep: 1 
iter: 3  value: 20572.44 mgc: 0.001280787 ustep: 1 
iter: 4  value: 20572.44 mgc: 1.982331e-08 ustep: 1 
mgc: 6.128431e-14 
iter: 1  mgc: 6.128431e-14 
outer mgc:  102.1697 
iter: 1  value: 20622.79 mgc: 11.93216 ustep: 1 
iter: 2  value: 20622.14 mgc: 0.8461239 ustep: 1 
iter: 3  value: 20622.14 mgc: 0.005435301 ustep: 1 
iter: 4  value: 20622.14 mgc: 3.238021e-07 ustep: 1 
iter: 5  mgc: 5.495604e-14 
iter: 1  value: 20564.42 mgc: 3.297363 ustep: 1 
iter: 2  value: 20564.42 mgc: 0.02759023 ustep: 1 
iter: 3  value: 20564.42 mgc: 1.146158e-05 ustep: 1 
iter: 4  mgc: 5.035083e-12 
iter: 1  mgc: 5.035083e-12 
outer mgc:  19.23661 
iter: 1  value: 20559.92 mgc: 1.244069 ustep: 1 
iter: 2  value: 20559.92 mgc: 0.01617288 ustep: 1 
iter: 3  value: 20559.92 mgc: 2.908163e-06 ustep: 1 
iter: 4  mgc: 9.503509e-14 
iter: 1  mgc: 9.503509e-14 
outer mgc:  36.93478 
iter: 1  value: 20556.05 mgc: 2.123748 ustep: 1 
iter: 2  value: 20556.05 mgc: 0.02558895 ustep: 1 
iter: 3  value: 20556.05 mgc: 6.575398e-06 ustep: 1 
iter: 4  mgc: 4.632822e-13 
iter: 1  mgc: 4.632822e-13 
outer mgc:  38.4255 
iter: 1  value: 20551.79 mgc: 1.966143 ustep: 1 
iter: 2  value: 20551.79 mgc: 0.02024364 ustep: 1 
iter: 3  value: 20551.79 mgc: 2.842559e-06 ustep: 1 
iter: 4  mgc: 6.777912e-14 
iter: 1  mgc: 6.777912e-14 
outer mgc:  24.61668 
iter: 1  value: 20547.36 mgc: 1.334116 ustep: 1 
iter: 2  value: 20547.36 mgc: 0.004706918 ustep: 1 
iter: 3  value: 20547.36 mgc: 2.663702e-07 ustep: 1 
iter: 4  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  17.94862 
iter: 1  value: 20543.71 mgc: 1.503899 ustep: 1 
iter: 2  value: 20543.71 mgc: 0.01479742 ustep: 1 
iter: 3  value: 20543.71 mgc: 2.113612e-06 ustep: 1 
iter: 4  mgc: 6.927792e-14 
iter: 1  mgc: 6.927792e-14 
outer mgc:  19.95002 
iter: 1  value: 20540.39 mgc: 1.841478 ustep: 1 
iter: 2  value: 20540.39 mgc: 0.01629943 ustep: 1 
iter: 3  value: 20540.39 mgc: 4.786988e-06 ustep: 1 
iter: 4  mgc: 4.121148e-13 
iter: 1  mgc: 4.121148e-13 
outer mgc:  26.74479 
iter: 1  value: 20538.35 mgc: 1.983255 ustep: 1 
iter: 2  value: 20538.35 mgc: 0.008797202 ustep: 1 
iter: 3  value: 20538.35 mgc: 7.565889e-07 ustep: 1 
iter: 4  mgc: 6.217249e-14 
iter: 1  mgc: 6.217249e-14 
outer mgc:  29.84919 
iter: 1  value: 20536.13 mgc: 3.1269 ustep: 1 
iter: 2  value: 20536.13 mgc: 0.02640636 ustep: 1 
iter: 3  value: 20536.13 mgc: 6.033463e-06 ustep: 1 
iter: 4  mgc: 5.000445e-13 
iter: 1  mgc: 5.000445e-13 
outer mgc:  25.15093 
iter: 1  value: 20534.22 mgc: 1.060225 ustep: 1 
iter: 2  value: 20534.22 mgc: 0.009124304 ustep: 1 
iter: 3  value: 20534.22 mgc: 5.932583e-07 ustep: 1 
iter: 4  mgc: 6.306067e-14 
iter: 1  mgc: 6.306067e-14 
outer mgc:  14.13559 
iter: 1  value: 20531.26 mgc: 1.557348 ustep: 1 
iter: 2  value: 20531.26 mgc: 0.01227613 ustep: 1 
iter: 3  value: 20531.26 mgc: 1.97959e-06 ustep: 1 
iter: 4  mgc: 6.480927e-14 
iter: 1  mgc: 6.480927e-14 
outer mgc:  27.69678 
iter: 1  value: 20529.07 mgc: 1.512024 ustep: 1 
iter: 2  value: 20529.07 mgc: 0.00583713 ustep: 1 
iter: 3  value: 20529.07 mgc: 4.135125e-07 ustep: 1 
iter: 4  mgc: 8.881784e-14 
iter: 1  mgc: 8.881784e-14 
outer mgc:  36.96283 
iter: 1  value: 20527.81 mgc: 1.116491 ustep: 1 
iter: 2  value: 20527.81 mgc: 0.002735246 ustep: 1 
iter: 3  value: 20527.81 mgc: 8.23301e-08 ustep: 1 
iter: 4  mgc: 9.947598e-14 
iter: 1  mgc: 9.947598e-14 
outer mgc:  12.01799 
iter: 1  value: 20527.31 mgc: 0.4448211 ustep: 1 
iter: 2  value: 20527.31 mgc: 0.0008515657 ustep: 1 
iter: 3  mgc: 9.791661e-09 
iter: 1  mgc: 9.791661e-09 
outer mgc:  18.9531 
iter: 1  value: 20526.23 mgc: 0.7632049 ustep: 1 
iter: 2  value: 20526.23 mgc: 0.0009613584 ustep: 1 
iter: 3  value: 20526.23 mgc: 1.031961e-08 ustep: 1 
mgc: 1.014744e-13 
iter: 1  mgc: 1.014744e-13 
outer mgc:  7.520743 
iter: 1  value: 20525.14 mgc: 0.420317 ustep: 1 
iter: 2  value: 20525.14 mgc: 0.0005247799 ustep: 1 
iter: 3  mgc: 2.050633e-09 
iter: 1  value: 20523.84 mgc: 0.2581013 ustep: 1 
iter: 2  value: 20523.84 mgc: 0.000317658 ustep: 1 
iter: 3  mgc: 8.431038e-10 
iter: 1  value: 20521.42 mgc: 0.5219133 ustep: 1 
iter: 2  value: 20521.42 mgc: 0.001243633 ustep: 1 
iter: 3  value: 20521.42 mgc: 1.256007e-08 ustep: 1 
mgc: 6.261658e-14 
iter: 1  mgc: 6.261658e-14 
outer mgc:  12.51384 
iter: 1  value: 20514.42 mgc: 3.147868 ustep: 1 
iter: 2  value: 20514.42 mgc: 0.02610666 ustep: 1 
iter: 3  value: 20514.42 mgc: 7.710345e-06 ustep: 1 
iter: 4  mgc: 8.881784e-13 
iter: 1  mgc: 8.881784e-13 
outer mgc:  16.77926 
iter: 1  value: 20516.47 mgc: 2.464619 ustep: 1 
iter: 2  value: 20516.46 mgc: 0.03667155 ustep: 1 
iter: 3  value: 20516.46 mgc: 4.827351e-05 ustep: 1 
iter: 4  mgc: 5.778666e-11 
iter: 1  value: 20514.99 mgc: 1.733559 ustep: 1 
iter: 2  value: 20514.99 mgc: 0.01406227 ustep: 1 
iter: 3  value: 20514.99 mgc: 4.189597e-06 ustep: 1 
iter: 4  mgc: 3.712586e-13 
iter: 1  mgc: 3.712586e-13 
outer mgc:  15.06414 
iter: 1  value: 20514.63 mgc: 1.270813 ustep: 1 
iter: 2  value: 20514.63 mgc: 0.01087058 ustep: 1 
iter: 3  value: 20514.63 mgc: 1.810553e-06 ustep: 1 
iter: 4  mgc: 7.149836e-14 
iter: 1  mgc: 7.149836e-14 
outer mgc:  9.043852 
iter: 1  value: 20508.56 mgc: 3.54807 ustep: 1 
iter: 2  value: 20508.56 mgc: 0.02702248 ustep: 1 
iter: 3  value: 20508.56 mgc: 7.115195e-07 ustep: 1 
iter: 4  mgc: 9.237056e-14 
iter: 1  value: 20513.83 mgc: 0.9750623 ustep: 1 
iter: 2  value: 20513.83 mgc: 0.001911359 ustep: 1 
iter: 3  value: 20513.83 mgc: 3.080919e-08 ustep: 1 
mgc: 7.283063e-14 
iter: 1  mgc: 7.283063e-14 
outer mgc:  11.97578 
iter: 1  value: 20512.22 mgc: 0.8754291 ustep: 1 
iter: 2  value: 20512.22 mgc: 0.0008974453 ustep: 1 
iter: 3  mgc: 4.587319e-09 
iter: 1  mgc: 4.587319e-09 
outer mgc:  14.90414 
iter: 1  value: 20511.96 mgc: 0.5864316 ustep: 1 
iter: 2  value: 20511.96 mgc: 0.0013919 ustep: 1 
iter: 3  value: 20511.96 mgc: 2.339208e-08 ustep: 1 
mgc: 7.260859e-14 
iter: 1  mgc: 7.260859e-14 
outer mgc:  2.011587 
iter: 1  value: 20510.86 mgc: 0.3832726 ustep: 1 
iter: 2  value: 20510.86 mgc: 0.0004121462 ustep: 1 
iter: 3  mgc: 2.977814e-10 
iter: 1  value: 20508.95 mgc: 0.8297323 ustep: 1 
iter: 2  value: 20508.95 mgc: 0.001544817 ustep: 1 
iter: 3  mgc: 2.004857e-09 
iter: 1  mgc: 2.004857e-09 
outer mgc:  6.255522 
iter: 1  value: 20507.65 mgc: 0.9362735 ustep: 1 
iter: 2  value: 20507.65 mgc: 0.001159298 ustep: 1 
iter: 3  value: 20507.65 mgc: 1.14092e-08 ustep: 1 
mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  6.813549 
iter: 1  value: 20505.59 mgc: 0.5576113 ustep: 1 
iter: 2  value: 20505.59 mgc: 0.0006469352 ustep: 1 
iter: 3  mgc: 3.40421e-09 
iter: 1  mgc: 3.40421e-09 
outer mgc:  2.451745 
iter: 1  value: 20504.06 mgc: 0.6837879 ustep: 1 
iter: 2  value: 20504.06 mgc: 0.000915164 ustep: 1 
iter: 3  mgc: 8.602068e-09 
iter: 1  mgc: 8.602068e-09 
outer mgc:  5.350787 
iter: 1  value: 20502.1 mgc: 0.7666676 ustep: 1 
iter: 2  value: 20502.1 mgc: 0.001253297 ustep: 1 
iter: 3  mgc: 8.834318e-09 
iter: 1  mgc: 8.834318e-09 
outer mgc:  5.835548 
iter: 1  value: 20501.6 mgc: 0.619344 ustep: 1 
iter: 2  value: 20501.6 mgc: 0.0004199494 ustep: 1 
iter: 3  mgc: 6.791301e-10 
iter: 1  mgc: 6.791301e-10 
outer mgc:  2.879106 
iter: 1  value: 20497.01 mgc: 0.9541301 ustep: 1 
iter: 2  value: 20497.01 mgc: 0.001031316 ustep: 1 
iter: 3  mgc: 5.073247e-09 
iter: 1  mgc: 5.073247e-09 
outer mgc:  6.555222 
iter: 1  value: 20494.46 mgc: 1.185847 ustep: 1 
iter: 2  value: 20494.46 mgc: 0.001759146 ustep: 1 
iter: 3  mgc: 7.860387e-09 
iter: 1  mgc: 7.860387e-09 
outer mgc:  5.615639 
iter: 1  value: 20491.44 mgc: 1.523206 ustep: 1 
iter: 2  value: 20491.44 mgc: 0.00289056 ustep: 1 
iter: 3  value: 20491.44 mgc: 4.398266e-08 ustep: 1 
iter: 4  mgc: 7.993606e-14 
iter: 1  value: 20493.12 mgc: 0.6938141 ustep: 1 
iter: 2  value: 20493.12 mgc: 0.0006941052 ustep: 1 
iter: 3  mgc: 2.664997e-09 
iter: 1  mgc: 2.664997e-09 
outer mgc:  6.053284 
iter: 1  value: 20492.98 mgc: 0.2293219 ustep: 1 
iter: 2  value: 20492.98 mgc: 1.987338e-05 ustep: 1 
iter: 3  mgc: 6.991741e-12 
iter: 1  mgc: 6.991741e-12 
outer mgc:  0.3714418 
iter: 1  value: 20492.72 mgc: 0.1093875 ustep: 1 
iter: 2  value: 20492.72 mgc: 5.993699e-06 ustep: 1 
iter: 3  mgc: 3.321787e-13 
iter: 1  mgc: 3.321787e-13 
outer mgc:  0.1140219 
iter: 1  value: 20492.51 mgc: 0.05403095 ustep: 1 
iter: 2  value: 20492.51 mgc: 2.783747e-06 ustep: 1 
iter: 3  mgc: 6.483702e-14 
iter: 1  value: 20492.29 mgc: 0.05450195 ustep: 1 
iter: 2  value: 20492.29 mgc: 2.826738e-06 ustep: 1 
iter: 3  mgc: 9.681145e-14 
iter: 1  mgc: 9.681145e-14 
outer mgc:  0.04360421 
iter: 1  value: 20492.23 mgc: 0.02033019 ustep: 1 
iter: 2  value: 20492.23 mgc: 3.12078e-07 ustep: 1 
iter: 3  mgc: 1.226241e-13 
iter: 1  mgc: 1.226241e-13 
outer mgc:  0.003601794 
iter: 1  value: 20492.23 mgc: 0.0005460878 ustep: 1 
iter: 2  mgc: 6.779821e-10 
iter: 1  mgc: 6.779821e-10 
outer mgc:  9.252252e-05 
iter: 1  mgc: 6.779821e-10 
iter: 1  mgc: 6.779821e-10 
outer mgc:  9.252252e-05 
iter: 1  value: 20492.23 mgc: 0.02806422 ustep: 1 
iter: 2  value: 20492.23 mgc: 2.053893e-06 ustep: 1 
iter: 3  mgc: 1.225686e-13 
outer mgc:  1.098437 
iter: 1  value: 20492.23 mgc: 0.02806314 ustep: 1 
iter: 2  value: 20492.23 mgc: 2.054525e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  1.098423 
iter: 1  value: 20492.23 mgc: 0.01408272 ustep: 1 
iter: 2  value: 20492.23 mgc: 5.817353e-07 ustep: 1 
iter: 3  mgc: 9.148238e-14 
outer mgc:  0.8316889 
iter: 1  value: 20492.23 mgc: 0.014078 ustep: 1 
iter: 2  value: 20492.23 mgc: 5.81747e-07 ustep: 1 
iter: 3  mgc: 7.81597e-14 
outer mgc:  0.8313868 
iter: 1  value: 20492.23 mgc: 0.02432549 ustep: 1 
iter: 2  value: 20492.23 mgc: 1.164935e-06 ustep: 1 
iter: 3  mgc: 8.082424e-14 
outer mgc:  1.221605 
iter: 1  value: 20492.23 mgc: 0.02431188 ustep: 1 
iter: 2  value: 20492.23 mgc: 1.164305e-06 ustep: 1 
iter: 3  mgc: 8.149037e-14 
outer mgc:  1.221503 
iter: 1  value: 20492.23 mgc: 0.01222152 ustep: 1 
iter: 2  value: 20492.23 mgc: 3.426641e-07 ustep: 1 
iter: 3  mgc: 6.300516e-14 
outer mgc:  0.7652577 
iter: 1  value: 20492.23 mgc: 0.01221471 ustep: 1 
iter: 2  value: 20492.23 mgc: 3.423335e-07 ustep: 1 
iter: 3  mgc: 6.67244e-14 
outer mgc:  0.7649765 
iter: 1  value: 20492.27 mgc: 0.08348517 ustep: 1 
iter: 2  value: 20492.27 mgc: 5.243372e-06 ustep: 1 
iter: 3  mgc: 4.8761e-13 
outer mgc:  0.476264 
iter: 1  value: 20492.2 mgc: 0.08372481 ustep: 1 
iter: 2  value: 20492.2 mgc: 5.254196e-06 ustep: 1 
iter: 3  mgc: 4.37872e-13 
outer mgc:  0.4764983 
iter: 1  value: 20492.29 mgc: 0.08063685 ustep: 1 
iter: 2  value: 20492.29 mgc: 7.643373e-06 ustep: 1 
iter: 3  mgc: 2.597922e-13 
outer mgc:  0.4326074 
iter: 1  value: 20492.18 mgc: 0.08086181 ustep: 1 
iter: 2  value: 20492.18 mgc: 7.649452e-06 ustep: 1 
iter: 3  mgc: 2.557954e-13 
outer mgc:  0.4325 
iter: 1  value: 20492.22 mgc: 0.00446245 ustep: 1 
iter: 2  value: 20492.22 mgc: 1.509575e-08 ustep: 1 
mgc: 7.521761e-14 
outer mgc:  0.001799404 
iter: 1  value: 20492.25 mgc: 0.004461467 ustep: 1 
iter: 2  value: 20492.25 mgc: 1.510846e-08 ustep: 1 
mgc: 8.104628e-14 
outer mgc:  0.001724426 
iter: 1  value: 20492.21 mgc: 0.005292734 ustep: 1 
iter: 2  value: 20492.21 mgc: 6.842894e-08 ustep: 1 
mgc: 6.972201e-14 
outer mgc:  0.03006639 
iter: 1  value: 20492.26 mgc: 0.00529307 ustep: 1 
iter: 2  value: 20492.26 mgc: 6.847662e-08 ustep: 1 
mgc: 7.260859e-14 
outer mgc:  0.03002729 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:49:59 2021]
Finished job 0.
1 of 1 steps (100%) done

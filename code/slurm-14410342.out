Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:11:53 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_80_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2257.648253 
final  value 1984.227064 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1334.147 mgc: 109.4731 ustep: 0.4367355 
iter: 2  value: 1255.104 mgc: 90.63181 ustep: 0.1263996 
iter: 3  value: 1103.39 mgc: 128.9474 ustep: 0.1040152 
iter: 4  value: 585.4908 mgc: 94.27725 ustep: 0.09275755 
iter: 5  value: 530.5181 mgc: 108.3752 ustep: 0.3046308 
iter: 6  value: 393.5772 mgc: 85.03056 ustep: 0.09546134 
iter: 7  value: 287.8291 mgc: 102.2943 ustep: 0.3090373 
iter: 8  value: 268.1968 mgc: 72.67427 ustep: 0.1836484 
iter: 9  value: 196.8029 mgc: 93.41358 ustep: 0.4285994 
iter: 10  value: 163.739 mgc: 53.2678 ustep: 0.6547095 
iter: 11  value: 154.387 mgc: 30.84041 ustep: 0.8091603 
iter: 12  value: 154.3732 mgc: 0.7747891 ustep: 0.8995434 
iter: 13  value: 154.3732 mgc: 0.01280795 ustep: 0.9484478 
iter: 14  value: 154.3732 mgc: 3.304666e-05 ustep: 0.9738855 
iter: 15  value: 154.3732 mgc: 4.23414e-08 ustep: 0.9868577 
mgc: 2.820022e-11 
iter: 1  mgc: 2.820022e-11 
Matching hessian patterns... Done
outer mgc:  40.89322 
iter: 1  value: 159.811 mgc: 19.31063 ustep: 1 
iter: 2  value: 159.7163 mgc: 0.9578224 ustep: 1 
iter: 3  value: 159.7163 mgc: 0.007707484 ustep: 1 
iter: 4  value: 159.7163 mgc: 4.279358e-07 ustep: 1 
iter: 5  mgc: 2.980949e-14 
iter: 1  value: 144.6639 mgc: 9.159668 ustep: 1 
iter: 2  value: 144.6595 mgc: 0.1955295 ustep: 1 
iter: 3  value: 144.6595 mgc: 0.0003756485 ustep: 1 
iter: 4  mgc: 1.053161e-09 
iter: 1  mgc: 1.053161e-09 
outer mgc:  18.67427 
iter: 1  value: 141.5398 mgc: 12.85358 ustep: 1 
iter: 2  value: 141.214 mgc: 1.730604 ustep: 1 
iter: 3  value: 141.2139 mgc: 0.03472665 ustep: 1 
iter: 4  value: 141.2139 mgc: 1.498423e-05 ustep: 1 
iter: 5  mgc: 2.911782e-12 
iter: 1  mgc: 2.911782e-12 
outer mgc:  23.29122 
iter: 1  value: 135.8167 mgc: 2.361304 ustep: 1 
iter: 2  value: 135.8162 mgc: 0.06989222 ustep: 1 
iter: 3  value: 135.8162 mgc: 5.000108e-05 ustep: 1 
iter: 4  mgc: 7.200268e-11 
iter: 1  mgc: 7.200268e-11 
outer mgc:  13.73645 
iter: 1  value: 130.9537 mgc: 14.921 ustep: 1 
iter: 2  value: 130.8484 mgc: 1.046684 ustep: 1 
iter: 3  value: 130.8483 mgc: 0.01141079 ustep: 1 
iter: 4  value: 130.8483 mgc: 2.05216e-06 ustep: 1 
iter: 5  mgc: 7.860379e-14 
iter: 1  mgc: 7.860379e-14 
outer mgc:  7.95574 
iter: 1  value: 124.7953 mgc: 10.54684 ustep: 1 
iter: 2  value: 124.583 mgc: 1.362604 ustep: 1 
iter: 3  value: 124.583 mgc: 0.02359618 ustep: 1 
iter: 4  value: 124.583 mgc: 8.579803e-06 ustep: 1 
iter: 5  mgc: 1.139977e-12 
iter: 1  mgc: 1.139977e-12 
outer mgc:  7.518191 
iter: 1  value: 125.0315 mgc: 22.14051 ustep: 1 
iter: 2  value: 118.6034 mgc: 7.691693 ustep: 1 
iter: 3  value: 118.5834 mgc: 0.4232041 ustep: 1 
iter: 4  value: 118.5834 mgc: 0.001543893 ustep: 1 
iter: 5  value: 118.5834 mgc: 2.915668e-08 ustep: 1 
mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  15.96333 
iter: 1  value: 113.329 mgc: 22.2982 ustep: 1 
iter: 2  value: 113.0273 mgc: 2.965241 ustep: 1 
iter: 3  value: 113.0272 mgc: 0.03948799 ustep: 1 
iter: 4  value: 113.0272 mgc: 6.856915e-06 ustep: 1 
iter: 5  mgc: 2.060574e-13 
iter: 1  mgc: 2.060574e-13 
outer mgc:  13.61787 
iter: 1  value: 146.979 mgc: 37.5036 ustep: 1 
iter: 2  value: 146.5841 mgc: 1.923087 ustep: 1 
iter: 3  value: 146.5841 mgc: 0.04432727 ustep: 1 
iter: 4  value: 146.5841 mgc: 2.090681e-05 ustep: 1 
iter: 5  mgc: 4.659384e-12 
iter: 1  value: 111.0697 mgc: 6.238167 ustep: 1 
iter: 2  value: 111.0694 mgc: 0.07977495 ustep: 1 
iter: 3  value: 111.0694 mgc: 3.736181e-05 ustep: 1 
iter: 4  mgc: 7.492673e-12 
iter: 1  mgc: 7.492673e-12 
outer mgc:  8.865928 
iter: 1  value: 110.5712 mgc: 6.122864 ustep: 1 
iter: 2  value: 110.5708 mgc: 0.1135301 ustep: 1 
iter: 3  value: 110.5708 mgc: 6.149083e-05 ustep: 1 
iter: 4  mgc: 1.805001e-11 
iter: 1  mgc: 1.805001e-11 
outer mgc:  11.71277 
iter: 1  value: 109.3499 mgc: 8.593725 ustep: 1 
iter: 2  value: 109.3489 mgc: 0.1403744 ustep: 1 
iter: 3  value: 109.3489 mgc: 6.749915e-05 ustep: 1 
iter: 4  mgc: 4.51772e-11 
iter: 1  mgc: 4.51772e-11 
outer mgc:  6.865033 
iter: 1  value: 108.7341 mgc: 2.587032 ustep: 1 
iter: 2  value: 108.734 mgc: 0.04792961 ustep: 1 
iter: 3  value: 108.734 mgc: 3.39621e-06 ustep: 1 
iter: 4  mgc: 6.417089e-14 
iter: 1  mgc: 6.417089e-14 
outer mgc:  2.251749 
iter: 1  value: 108.2083 mgc: 1.736247 ustep: 1 
iter: 2  value: 108.2083 mgc: 0.006750126 ustep: 1 
iter: 3  value: 108.2083 mgc: 1.946603e-07 ustep: 1 
mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  2.797534 
iter: 1  value: 107.8486 mgc: 1.216937 ustep: 1 
iter: 2  value: 107.8486 mgc: 0.005742398 ustep: 1 
iter: 3  value: 107.8486 mgc: 1.382458e-07 ustep: 1 
mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  3.329583 
iter: 1  value: 107.4235 mgc: 1.46511 ustep: 1 
iter: 2  value: 107.4235 mgc: 0.004619247 ustep: 1 
iter: 3  value: 107.4235 mgc: 8.180666e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  2.411671 
iter: 1  value: 107.1245 mgc: 1.541698 ustep: 1 
iter: 2  value: 107.1245 mgc: 0.001941237 ustep: 1 
iter: 3  value: 107.1245 mgc: 3.740854e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  1.864724 
iter: 1  value: 106.8685 mgc: 2.363011 ustep: 1 
iter: 2  value: 106.8685 mgc: 0.01278429 ustep: 1 
iter: 3  value: 106.8685 mgc: 5.700219e-07 ustep: 1 
iter: 4  mgc: 2.109424e-14 
iter: 1  mgc: 2.109424e-14 
outer mgc:  0.7787387 
iter: 1  value: 106.5302 mgc: 0.8487202 ustep: 1 
iter: 2  value: 106.5302 mgc: 0.001071182 ustep: 1 
iter: 3  mgc: 3.511105e-09 
iter: 1  value: 106.1282 mgc: 0.9536405 ustep: 1 
iter: 2  value: 106.1282 mgc: 0.000919126 ustep: 1 
iter: 3  mgc: 2.19655e-09 
iter: 1  mgc: 2.19655e-09 
outer mgc:  2.484573 
iter: 1  value: 105.3434 mgc: 2.062059 ustep: 1 
iter: 2  value: 105.3434 mgc: 0.004049079 ustep: 1 
iter: 3  value: 105.3434 mgc: 4.532585e-08 ustep: 1 
mgc: 1.953993e-14 
iter: 1  mgc: 1.953993e-14 
outer mgc:  0.9555794 
iter: 1  value: 104.6614 mgc: 1.607152 ustep: 1 
iter: 2  value: 104.6614 mgc: 0.003873164 ustep: 1 
iter: 3  value: 104.6614 mgc: 3.014481e-08 ustep: 1 
mgc: 3.175238e-14 
iter: 1  mgc: 3.175238e-14 
outer mgc:  0.7467523 
iter: 1  value: 104.1286 mgc: 1.132822 ustep: 1 
iter: 2  value: 104.1286 mgc: 0.002645814 ustep: 1 
iter: 3  value: 104.1286 mgc: 1.907082e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  value: 103.6056 mgc: 1.205501 ustep: 1 
iter: 2  value: 103.6056 mgc: 0.002854012 ustep: 1 
iter: 3  value: 103.6056 mgc: 2.842141e-08 ustep: 1 
mgc: 2.597922e-14 
iter: 1  mgc: 2.597922e-14 
outer mgc:  0.6623261 
iter: 1  value: 102.4845 mgc: 2.319658 ustep: 1 
iter: 2  value: 102.4845 mgc: 0.003870315 ustep: 1 
iter: 3  value: 102.4845 mgc: 1.050145e-08 ustep: 1 
mgc: 3.619327e-14 
iter: 1  mgc: 3.619327e-14 
outer mgc:  0.2949506 
iter: 1  value: 101.8714 mgc: 1.550156 ustep: 1 
iter: 2  value: 101.8714 mgc: 0.0008903528 ustep: 1 
iter: 3  mgc: 6.062915e-10 
iter: 1  mgc: 6.062915e-10 
outer mgc:  0.3274294 
iter: 1  value: 101.2054 mgc: 1.370563 ustep: 1 
iter: 2  value: 101.2054 mgc: 0.0005209408 ustep: 1 
iter: 3  mgc: 4.104219e-10 
iter: 1  mgc: 4.104219e-10 
outer mgc:  0.168659 
iter: 1  value: 100.7011 mgc: 0.9881834 ustep: 1 
iter: 2  value: 100.7011 mgc: 0.0002179164 ustep: 1 
iter: 3  mgc: 2.232525e-11 
iter: 1  mgc: 2.232525e-11 
outer mgc:  0.05315747 
iter: 1  value: 100.4215 mgc: 0.5436752 ustep: 1 
iter: 2  value: 100.4215 mgc: 6.592643e-05 ustep: 1 
iter: 3  mgc: 6.142642e-12 
iter: 1  mgc: 6.142642e-12 
outer mgc:  0.01022695 
iter: 1  value: 100.316 mgc: 0.1739404 ustep: 1 
iter: 2  value: 100.316 mgc: 7.398159e-06 ustep: 1 
iter: 3  mgc: 5.77316e-14 
iter: 1  mgc: 5.77316e-14 
outer mgc:  0.003721221 
iter: 1  value: 100.2958 mgc: 0.03879968 ustep: 1 
iter: 2  value: 100.2958 mgc: 2.326819e-07 ustep: 1 
mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.001376816 
iter: 1  value: 100.2949 mgc: 0.001927515 ustep: 1 
iter: 2  mgc: 8.031211e-10 
iter: 1  mgc: 8.031211e-10 
outer mgc:  0.0001959375 
iter: 1  mgc: 8.031211e-10 
iter: 1  mgc: 8.031211e-10 
outer mgc:  0.0001959375 
iter: 1  value: 100.2946 mgc: 0.02877208 ustep: 1 
iter: 2  value: 100.2946 mgc: 7.576623e-07 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.1906968 
iter: 1  value: 100.2954 mgc: 0.02875271 ustep: 1 
iter: 2  value: 100.2954 mgc: 7.565808e-07 ustep: 1 
iter: 3  mgc: 4.019007e-14 
outer mgc:  0.1910054 
iter: 1  value: 100.2947 mgc: 0.01448345 ustep: 1 
iter: 2  value: 100.2947 mgc: 2.140201e-07 ustep: 1 
mgc: 5.506706e-14 
outer mgc:  0.1007789 
iter: 1  value: 100.2952 mgc: 0.01447312 ustep: 1 
iter: 2  value: 100.2952 mgc: 2.136953e-07 ustep: 1 
mgc: 4.884981e-14 
outer mgc:  0.1007852 
iter: 1  value: 100.2955 mgc: 0.05351927 ustep: 1 
iter: 2  value: 100.2955 mgc: 3.712946e-06 ustep: 1 
iter: 3  mgc: 1.523226e-13 
outer mgc:  0.224587 
iter: 1  value: 100.2944 mgc: 0.05352235 ustep: 1 
iter: 2  value: 100.2944 mgc: 3.705063e-06 ustep: 1 
iter: 3  mgc: 1.671996e-13 
outer mgc:  0.2242808 
iter: 1  value: 100.2952 mgc: 0.02872449 ustep: 1 
iter: 2  value: 100.2952 mgc: 1.286165e-06 ustep: 1 
iter: 3  mgc: 6.528111e-14 
outer mgc:  0.1762662 
iter: 1  value: 100.2948 mgc: 0.02872534 ustep: 1 
iter: 2  value: 100.2948 mgc: 1.284792e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.1762379 
iter: 1  value: 100.2937 mgc: 0.002118322 ustep: 1 
iter: 2  mgc: 9.611254e-10 
outer mgc:  0.0002666715 
iter: 1  value: 100.2961 mgc: 0.002118033 ustep: 1 
iter: 2  mgc: 9.617676e-10 
outer mgc:  0.0001579436 
iter: 1  value: 100.3017 mgc: 0.1752195 ustep: 1 
iter: 2  value: 100.3017 mgc: 5.317435e-06 ustep: 1 
iter: 3  mgc: 2.398082e-14 
outer mgc:  0.05614463 
iter: 1  value: 100.2881 mgc: 0.1753948 ustep: 1 
iter: 2  value: 100.2881 mgc: 5.319681e-06 ustep: 1 
iter: 3  mgc: 4.13003e-14 
outer mgc:  0.05622954 
iter: 1  value: 100.2976 mgc: 0.1786087 ustep: 1 
iter: 2  value: 100.2976 mgc: 4.245391e-06 ustep: 1 
iter: 3  mgc: 4.52971e-14 
outer mgc:  0.06548453 
iter: 1  value: 100.2922 mgc: 0.1791418 ustep: 1 
iter: 2  value: 100.2922 mgc: 4.243403e-06 ustep: 1 
iter: 3  mgc: 4.418688e-14 
outer mgc:  0.06539535 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:11:55 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Mon Aug 16 07:47:26 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_2_diagREDM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm2_20_100_80_3_2_ModeldiagREDM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm2, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=diagREDM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm2_20_100_80_3_2_diagREDM_NA_NA_NA_dataset0.RDS --model diagREDM --optimiser nlminb
Model: diagREDM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm2_20_100_80_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4363.688011 
iter  10 value 3482.723640
iter  10 value 3482.723634
final  value 3482.723634 
converged
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6480.085 mgc: 124.5847 ustep: 1 
iter: 2  value: 5307.512 mgc: 89.54417 ustep: 0.03416477 
iter: 3  value: 5005.374 mgc: 64.98944 ustep: 0.0496189 
iter: 4  value: 4768.606 mgc: 78.60851 ustep: 0.04249836 
iter: 5  value: 4636.352 mgc: 21.91177 ustep: 0.1090518 
iter: 6  value: 4504.898 mgc: 25.69427 ustep: 0.05202443 
iter: 7  value: 4351.899 mgc: 49.86346 ustep: 0.05013969 
iter: 8  value: 4288.174 mgc: 23.04544 ustep: 0.1190775 
iter: 9  value: 4284.742 mgc: 11.871 ustep: 0.3451416 
iter: 10  value: 4284.691 mgc: 1.478259 ustep: 0.5875288 
iter: 11  value: 4284.691 mgc: 0.07520334 ustep: 0.7665276 
iter: 12  value: 4284.691 mgc: 0.001173171 ustep: 0.8755281 
iter: 13  value: 4284.691 mgc: 8.433035e-06 ustep: 0.935703 
iter: 14  value: 4284.691 mgc: 3.169367e-08 ustep: 0.9673207 
mgc: 1.41562e-10 
iter: 1  mgc: 1.41562e-10 
Matching hessian patterns... Done
outer mgc:  572.1244 
iter: 1  value: 3815.63 mgc: 29.81213 ustep: 1 
iter: 2  value: 3809.435 mgc: 9.0781 ustep: 1 
iter: 3  value: 3809.422 mgc: 0.4141755 ustep: 1 
iter: 4  value: 3809.422 mgc: 0.002347541 ustep: 1 
iter: 5  value: 3809.422 mgc: 7.921497e-08 ustep: 1 
mgc: 6.06859e-12 
iter: 1  value: 3574.195 mgc: 40.21687 ustep: 1 
iter: 2  value: 3557.166 mgc: 12.94094 ustep: 1 
iter: 3  value: 3557.136 mgc: 0.6682938 ustep: 1 
iter: 4  value: 3557.136 mgc: 0.003854354 ustep: 1 
iter: 5  value: 3557.136 mgc: 2.125853e-07 ustep: 1 
iter: 6  mgc: 4.774625e-12 
iter: 1  mgc: 4.774625e-12 
outer mgc:  175.756 
iter: 1  value: 3552.62 mgc: 59.7458 ustep: 1 
iter: 2  value: 3538.568 mgc: 7.40849 ustep: 1 
iter: 3  value: 3538.485 mgc: 0.7370971 ustep: 1 
iter: 4  value: 3538.485 mgc: 0.0125034 ustep: 1 
iter: 5  value: 3538.485 mgc: 3.795918e-06 ustep: 1 
iter: 6  mgc: 7.654544e-12 
iter: 1  mgc: 7.654544e-12 
outer mgc:  241.1968 
iter: 1  value: 3540.808 mgc: 34.23566 ustep: 1 
iter: 2  value: 3381.3 mgc: 34.35612 ustep: 1 
iter: 3  value: 3376.315 mgc: 5.574175 ustep: 1 
iter: 4  value: 3376.293 mgc: 0.4678732 ustep: 1 
iter: 5  value: 3376.293 mgc: 0.004348418 ustep: 1 
iter: 6  value: 3376.293 mgc: 3.865387e-07 ustep: 1 
iter: 7  mgc: 5.143774e-12 
iter: 1  mgc: 5.143774e-12 
outer mgc:  38.71908 
iter: 1  value: 3361.973 mgc: 16.16696 ustep: 1 
iter: 2  value: 3358.688 mgc: 4.11763 ustep: 1 
iter: 3  value: 3358.685 mgc: 0.129339 ustep: 1 
iter: 4  value: 3358.685 mgc: 0.0002658506 ustep: 1 
iter: 5  mgc: 1.417112e-09 
iter: 1  mgc: 1.417112e-09 
outer mgc:  6.486475 
iter: 1  value: 3350.446 mgc: 16.42659 ustep: 1 
iter: 2  value: 3348.823 mgc: 2.870382 ustep: 1 
iter: 3  value: 3348.822 mgc: 0.112427 ustep: 1 
iter: 4  value: 3348.822 mgc: 0.0001987094 ustep: 1 
iter: 5  mgc: 6.532173e-10 
iter: 1  mgc: 6.532173e-10 
outer mgc:  21.46347 
iter: 1  value: 3346.634 mgc: 20.09543 ustep: 1 
iter: 2  value: 3339.284 mgc: 5.764024 ustep: 1 
iter: 3  value: 3339.263 mgc: 0.3224537 ustep: 1 
iter: 4  value: 3339.263 mgc: 0.001602619 ustep: 1 
iter: 5  value: 3339.263 mgc: 4.749415e-08 ustep: 1 
mgc: 5.624834e-12 
iter: 1  mgc: 5.624834e-12 
outer mgc:  8.572785 
iter: 1  value: 3346.77 mgc: 6.169517 ustep: 1 
iter: 2  value: 3346.757 mgc: 0.3275406 ustep: 1 
iter: 3  value: 3346.757 mgc: 0.001766259 ustep: 1 
iter: 4  value: 3346.757 mgc: 5.293523e-08 ustep: 1 
mgc: 6.574297e-12 
iter: 1  value: 3339.528 mgc: 2.457954 ustep: 1 
iter: 2  value: 3339.527 mgc: 0.05942193 ustep: 1 
iter: 3  value: 3339.527 mgc: 8.031453e-05 ustep: 1 
iter: 4  mgc: 1.478182e-10 
iter: 1  value: 3339.47 mgc: 2.802279 ustep: 1 
iter: 2  value: 3339.469 mgc: 0.03305395 ustep: 1 
iter: 3  value: 3339.469 mgc: 1.413553e-05 ustep: 1 
iter: 4  mgc: 7.505996e-12 
iter: 1  value: 3338.9 mgc: 1.309052 ustep: 1 
iter: 2  value: 3338.9 mgc: 0.00711514 ustep: 1 
iter: 3  value: 3338.9 mgc: 6.777625e-07 ustep: 1 
iter: 4  mgc: 4.791167e-12 
iter: 1  mgc: 4.791167e-12 
outer mgc:  4.064529 
iter: 1  value: 3338.575 mgc: 2.174303 ustep: 1 
iter: 2  value: 3338.574 mgc: 0.03339057 ustep: 1 
iter: 3  value: 3338.574 mgc: 1.235669e-05 ustep: 1 
iter: 4  mgc: 5.165313e-12 
iter: 1  mgc: 5.165313e-12 
outer mgc:  4.012168 
iter: 1  value: 3338.126 mgc: 1.620009 ustep: 1 
iter: 2  value: 3338.126 mgc: 0.01253756 ustep: 1 
iter: 3  value: 3338.126 mgc: 1.754032e-06 ustep: 1 
iter: 4  mgc: 9.79794e-12 
iter: 1  mgc: 9.79794e-12 
outer mgc:  5.359712 
iter: 1  value: 3337.394 mgc: 3.606079 ustep: 1 
iter: 2  value: 3337.394 mgc: 0.05781828 ustep: 1 
iter: 3  value: 3337.394 mgc: 6.034121e-05 ustep: 1 
iter: 4  mgc: 7.861178e-11 
iter: 1  mgc: 7.861178e-11 
outer mgc:  4.730887 
iter: 1  value: 3337.598 mgc: 12.0428 ustep: 1 
iter: 2  value: 3337.464 mgc: 0.7562209 ustep: 1 
iter: 3  value: 3337.464 mgc: 0.006919015 ustep: 1 
iter: 4  value: 3337.464 mgc: 6.547176e-07 ustep: 1 
iter: 5  mgc: 7.154499e-12 
iter: 1  value: 3337.02 mgc: 4.938866 ustep: 1 
iter: 2  value: 3337.015 mgc: 0.156904 ustep: 1 
iter: 3  value: 3337.015 mgc: 0.000280571 ustep: 1 
iter: 4  mgc: 1.093481e-09 
iter: 1  mgc: 1.093481e-09 
outer mgc:  5.709995 
iter: 1  value: 3336.648 mgc: 1.447645 ustep: 1 
iter: 2  value: 3336.648 mgc: 0.00774673 ustep: 1 
iter: 3  value: 3336.648 mgc: 8.891119e-07 ustep: 1 
iter: 4  mgc: 6.514816e-12 
iter: 1  mgc: 6.514816e-12 
outer mgc:  1.72563 
iter: 1  value: 3336.398 mgc: 3.40975 ustep: 1 
iter: 2  value: 3336.398 mgc: 0.04355894 ustep: 1 
iter: 3  value: 3336.398 mgc: 2.151421e-05 ustep: 1 
iter: 4  mgc: 9.78595e-12 
iter: 1  mgc: 9.78595e-12 
outer mgc:  3.127521 
iter: 1  value: 3336.246 mgc: 1.159787 ustep: 1 
iter: 2  value: 3336.246 mgc: 0.01926928 ustep: 1 
iter: 3  value: 3336.246 mgc: 7.305918e-06 ustep: 1 
iter: 4  mgc: 6.986967e-12 
iter: 1  mgc: 6.986967e-12 
outer mgc:  3.553242 
iter: 1  value: 3336.066 mgc: 0.9265661 ustep: 1 
iter: 2  value: 3336.066 mgc: 0.008319479 ustep: 1 
iter: 3  value: 3336.066 mgc: 2.404633e-07 ustep: 1 
iter: 4  mgc: 4.728662e-12 
iter: 1  mgc: 4.728662e-12 
outer mgc:  0.754679 
iter: 1  value: 3336.107 mgc: 0.1326034 ustep: 1 
iter: 2  value: 3336.107 mgc: 0.000348086 ustep: 1 
iter: 3  mgc: 1.716876e-09 
iter: 1  mgc: 1.716876e-09 
outer mgc:  1.522355 
iter: 1  value: 3336.085 mgc: 0.3437692 ustep: 1 
iter: 2  value: 3336.085 mgc: 0.0006175445 ustep: 1 
iter: 3  mgc: 4.224355e-09 
iter: 1  value: 3336.083 mgc: 0.4514178 ustep: 1 
iter: 2  value: 3336.083 mgc: 0.001063537 ustep: 1 
iter: 3  value: 3336.083 mgc: 1.2393e-08 ustep: 1 
mgc: 2.903067e-12 
iter: 1  mgc: 2.903067e-12 
outer mgc:  1.419565 
iter: 1  value: 3336.127 mgc: 0.2023985 ustep: 1 
iter: 2  value: 3336.127 mgc: 0.0002209854 ustep: 1 
iter: 3  mgc: 1.981205e-10 
iter: 1  value: 3336.227 mgc: 0.3148681 ustep: 1 
iter: 2  value: 3336.227 mgc: 0.000582708 ustep: 1 
iter: 3  mgc: 1.38221e-09 
iter: 1  mgc: 1.38221e-09 
outer mgc:  2.316787 
iter: 1  value: 3337.752 mgc: 1.743973 ustep: 1 
iter: 2  value: 3337.751 mgc: 0.02489971 ustep: 1 
iter: 3  value: 3337.751 mgc: 4.427631e-06 ustep: 1 
iter: 4  mgc: 3.942957e-13 
iter: 1  value: 3473.216 mgc: 3.210651 ustep: 1 
iter: 2  value: 3472.978 mgc: 0.6622138 ustep: 1 
iter: 3  value: 3472.978 mgc: 0.02327098 ustep: 1 
iter: 4  value: 3472.978 mgc: 3.236386e-05 ustep: 1 
iter: 5  mgc: 6.515962e-11 
iter: 1  mgc: 3.942957e-13 
outer mgc:  6.283411 
iter: 1  value: 3393.517 mgc: 3.118872 ustep: 1 
iter: 2  value: 3393.407 mgc: 0.712084 ustep: 1 
iter: 3  value: 3393.407 mgc: 0.02673951 ustep: 1 
iter: 4  value: 3393.407 mgc: 4.319927e-05 ustep: 1 
iter: 5  mgc: 1.136415e-10 
iter: 1  value: 3338.531 mgc: 0.6104153 ustep: 1 
iter: 2  value: 3338.531 mgc: 0.002261147 ustep: 1 
iter: 3  value: 3338.531 mgc: 1.202739e-07 ustep: 1 
iter: 4  mgc: 3.248513e-13 
iter: 1  mgc: 3.248513e-13 
outer mgc:  6.297184 
iter: 1  value: 3363.159 mgc: 10.36451 ustep: 1 
iter: 2  value: 3361.946 mgc: 2.869427 ustep: 1 
iter: 3  value: 3361.944 mgc: 0.1472497 ustep: 1 
iter: 4  value: 3361.944 mgc: 0.0004696764 ustep: 1 
iter: 5  mgc: 4.846627e-09 
iter: 1  value: 3338.009 mgc: 1.548615 ustep: 1 
iter: 2  value: 3338.009 mgc: 0.0346099 ustep: 1 
iter: 3  value: 3338.009 mgc: 2.179078e-05 ustep: 1 
iter: 4  mgc: 8.475443e-12 
iter: 1  mgc: 8.475443e-12 
outer mgc:  6.250705 
iter: 1  value: 3338.039 mgc: 0.8953561 ustep: 1 
iter: 2  value: 3338.039 mgc: 0.007537014 ustep: 1 
iter: 3  value: 3338.039 mgc: 8.422303e-07 ustep: 1 
iter: 4  mgc: 1.754152e-13 
iter: 1  mgc: 1.754152e-13 
outer mgc:  1.203605 
iter: 1  value: 3338.326 mgc: 1.309766 ustep: 1 
iter: 2  value: 3338.326 mgc: 0.008625621 ustep: 1 
iter: 3  value: 3338.326 mgc: 6.754365e-07 ustep: 1 
iter: 4  mgc: 1.671996e-13 
iter: 1  mgc: 1.671996e-13 
outer mgc:  1.487719 
iter: 1  value: 3340.017 mgc: 0.9733889 ustep: 1 
iter: 2  value: 3340.017 mgc: 0.01245985 ustep: 1 
iter: 3  value: 3340.017 mgc: 3.157141e-06 ustep: 1 
iter: 4  mgc: 1.583178e-13 
iter: 1  mgc: 1.583178e-13 
outer mgc:  1.231946 
iter: 1  value: 3339.45 mgc: 1.730292 ustep: 1 
iter: 2  value: 3339.449 mgc: 0.02994212 ustep: 1 
iter: 3  value: 3339.449 mgc: 1.363224e-05 ustep: 1 
iter: 4  mgc: 4.047429e-12 
iter: 1  mgc: 4.047429e-12 
outer mgc:  3.672066 
iter: 1  value: 3340.671 mgc: 1.467333 ustep: 1 
iter: 2  value: 3340.671 mgc: 0.03319166 ustep: 1 
iter: 3  value: 3340.671 mgc: 3.518038e-05 ustep: 1 
iter: 4  mgc: 3.962919e-11 
iter: 1  mgc: 3.962919e-11 
outer mgc:  1.781765 
iter: 1  value: 3341.435 mgc: 0.9572976 ustep: 1 
iter: 2  value: 3341.434 mgc: 0.01296169 ustep: 1 
iter: 3  value: 3341.434 mgc: 4.365284e-06 ustep: 1 
iter: 4  mgc: 4.783396e-13 
iter: 1  mgc: 4.783396e-13 
outer mgc:  0.5267522 
iter: 1  value: 3340.962 mgc: 0.2051456 ustep: 1 
iter: 2  value: 3340.962 mgc: 0.0008959277 ustep: 1 
iter: 3  value: 3340.962 mgc: 2.369498e-08 ustep: 1 
mgc: 6.683543e-14 
iter: 1  mgc: 6.683543e-14 
outer mgc:  0.1148911 
iter: 1  value: 3341.153 mgc: 0.1572758 ustep: 1 
iter: 2  value: 3341.153 mgc: 0.0002940328 ustep: 1 
iter: 3  mgc: 2.715381e-09 
iter: 1  mgc: 2.715381e-09 
outer mgc:  0.02188909 
iter: 1  value: 3341.138 mgc: 0.03495952 ustep: 1 
iter: 2  value: 3341.138 mgc: 7.927468e-06 ustep: 1 
iter: 3  mgc: 1.668221e-12 
iter: 1  mgc: 1.668221e-12 
outer mgc:  0.005265723 
iter: 1  value: 3341.139 mgc: 0.004769575 ustep: 1 
iter: 2  value: 3341.139 mgc: 1.424194e-07 ustep: 1 
iter: 3  mgc: 5.317968e-14 
iter: 1  mgc: 5.317968e-14 
outer mgc:  0.0006692183 
iter: 1  value: 3341.139 mgc: 0.0004446955 ustep: 1 
iter: 2  mgc: 2.60617e-09 
iter: 1  mgc: 2.60617e-09 
outer mgc:  8.540843e-05 
iter: 1  mgc: 2.60617e-09 
iter: 1  mgc: 2.60617e-09 
outer mgc:  8.540843e-05 
iter: 1  value: 3341.138 mgc: 0.01864226 ustep: 1 
iter: 2  value: 3341.138 mgc: 6.086736e-06 ustep: 1 
iter: 3  mgc: 7.338574e-13 
outer mgc:  0.04272053 
iter: 1  value: 3341.14 mgc: 0.0186276 ustep: 1 
iter: 2  value: 3341.14 mgc: 6.096769e-06 ustep: 1 
iter: 3  mgc: 7.56728e-13 
outer mgc:  0.04274806 
iter: 1  value: 3341.138 mgc: 0.009422827 ustep: 1 
iter: 2  value: 3341.138 mgc: 1.708633e-06 ustep: 1 
iter: 3  mgc: 7.543965e-14 
outer mgc:  0.07572063 
iter: 1  value: 3341.139 mgc: 0.009415737 ustep: 1 
iter: 2  value: 3341.139 mgc: 1.709059e-06 ustep: 1 
iter: 3  mgc: 9.825474e-14 
outer mgc:  0.07581743 
iter: 1  value: 3341.139 mgc: 0.02570498 ustep: 1 
iter: 2  value: 3341.139 mgc: 5.43143e-06 ustep: 1 
iter: 3  mgc: 4.636291e-13 
outer mgc:  0.0465159 
iter: 1  value: 3341.138 mgc: 0.02571301 ustep: 1 
iter: 2  value: 3341.138 mgc: 5.418536e-06 ustep: 1 
iter: 3  mgc: 5.072609e-13 
outer mgc:  0.04634542 
iter: 1  value: 3341.14 mgc: 0.01195339 ustep: 1 
iter: 2  value: 3341.14 mgc: 1.406519e-06 ustep: 1 
iter: 3  mgc: 1.112443e-13 
outer mgc:  0.1095466 
iter: 1  value: 3341.137 mgc: 0.01195811 ustep: 1 
iter: 2  value: 3341.137 mgc: 1.405409e-06 ustep: 1 
iter: 3  mgc: 9.05942e-14 
outer mgc:  0.1097162 
iter: 1  value: 3341.141 mgc: 0.002502623 ustep: 1 
iter: 2  value: 3341.141 mgc: 1.684249e-07 ustep: 1 
iter: 3  mgc: 5.917489e-14 
outer mgc:  0.005853749 
iter: 1  value: 3341.136 mgc: 0.002505121 ustep: 1 
iter: 2  value: 3341.136 mgc: 1.686049e-07 ustep: 1 
iter: 3  mgc: 6.794565e-14 
outer mgc:  0.005822882 
iter: 1  value: 3341.14 mgc: 0.003302058 ustep: 1 
iter: 2  value: 3341.14 mgc: 5.789516e-08 ustep: 1 
mgc: 6.616929e-14 
outer mgc:  0.007440348 
iter: 1  value: 3341.137 mgc: 0.003305363 ustep: 1 
iter: 2  value: 3341.137 mgc: 5.797102e-08 ustep: 1 
mgc: 7.482903e-14 
outer mgc:  0.007443885 
iter: 1  value: 3341.135 mgc: 0.00309285 ustep: 1 
iter: 2  value: 3341.135 mgc: 6.487226e-08 ustep: 1 
mgc: 6.633583e-14 
outer mgc:  0.001118572 
iter: 1  value: 3341.143 mgc: 0.003093197 ustep: 1 
iter: 2  value: 3341.143 mgc: 6.489767e-08 ustep: 1 
mgc: 5.329071e-14 
outer mgc:  0.001136389 
iter: 1  value: 3341.136 mgc: 0.002506031 ustep: 1 
iter: 2  value: 3341.136 mgc: 8.690382e-08 ustep: 1 
mgc: 5.062617e-14 
outer mgc:  0.002174963 
iter: 1  value: 3341.142 mgc: 0.002506441 ustep: 1 
iter: 2  value: 3341.142 mgc: 8.698064e-08 ustep: 1 
mgc: 7.782663e-14 
outer mgc:  0.002140043 
[Mon Aug 16 07:47:28 2021]
Finished job 0.
1 of 1 steps (100%) done

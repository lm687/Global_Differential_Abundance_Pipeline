Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Fri Aug 13 12:27:33 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationInoRE_100_100_10_3_0.01_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationInoRE, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationInoRE_100_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationInoRE_100_100_10_3_0.01_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21776.692786 
final  value 20916.376670 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 19990.93 mgc: 3.105818 ustep: 1 
iter: 2  value: 19977.69 mgc: 1.91022 ustep: 1 
iter: 3  value: 19973.7 mgc: 2.662059 ustep: 0.6827823 
iter: 4  value: 19973.53 mgc: 0.4584647 ustep: 0.8263238 
iter: 5  value: 19973.53 mgc: 0.06285243 ustep: 0.9090326 
iter: 6  value: 19973.53 mgc: 0.005124555 ustep: 0.9534367 
iter: 7  value: 19973.53 mgc: 0.0002030066 ustep: 0.9764432 
iter: 8  value: 19973.53 mgc: 4.006975e-06 ustep: 0.9881526 
iter: 9  value: 19973.53 mgc: 3.958293e-08 ustep: 0.9940592 
iter: 10  mgc: 1.956914e-10 
iter: 1  mgc: 1.956914e-10 
Matching hessian patterns... Done
outer mgc:  89.42016 
iter: 1  value: 19783.45 mgc: 0.3734794 ustep: 1 
iter: 2  value: 19783.45 mgc: 0.01339442 ustep: 1 
iter: 3  value: 19783.45 mgc: 1.577635e-05 ustep: 1 
iter: 4  mgc: 1.284995e-11 
iter: 1  value: 19559.73 mgc: 18.60761 ustep: 1 
iter: 2  value: 19559.06 mgc: 0.8240893 ustep: 1 
iter: 3  value: 19559.06 mgc: 0.01193829 ustep: 1 
iter: 4  value: 19559.06 mgc: 4.178344e-06 ustep: 1 
iter: 5  mgc: 4.845013e-13 
iter: 1  mgc: 4.845013e-13 
outer mgc:  275.9333 
iter: 1  value: 21495.55 mgc: 137.1693 ustep: 1 
iter: 2  value: 21495.53 mgc: 0.4773586 ustep: 1 
iter: 3  value: 21495.53 mgc: 0.0001523136 ustep: 1 
iter: 4  mgc: 1.467981e-11 
iter: 1  value: 19461.33 mgc: 5.724713 ustep: 1 
iter: 2  value: 19461.32 mgc: 0.08719034 ustep: 1 
iter: 3  value: 19461.32 mgc: 4.679524e-05 ustep: 1 
iter: 4  mgc: 6.521672e-11 
iter: 1  mgc: 6.521672e-11 
outer mgc:  136.2122 
iter: 1  value: 19449.71 mgc: 4.24746 ustep: 1 
iter: 2  value: 19449.71 mgc: 0.04756379 ustep: 1 
iter: 3  value: 19449.71 mgc: 8.711057e-05 ustep: 1 
iter: 4  mgc: 1.956844e-10 
iter: 1  mgc: 1.956844e-10 
outer mgc:  134.5209 
iter: 1  value: 19399.09 mgc: 5.70327 ustep: 1 
iter: 2  value: 19399.09 mgc: 0.04314237 ustep: 1 
iter: 3  value: 19399.09 mgc: 2.039312e-05 ustep: 1 
iter: 4  mgc: 1.437545e-11 
iter: 1  mgc: 1.437545e-11 
outer mgc:  79.61464 
iter: 1  value: 19331.42 mgc: 3.701773 ustep: 1 
iter: 2  value: 19331.42 mgc: 0.01994905 ustep: 1 
iter: 3  value: 19331.42 mgc: 5.351214e-06 ustep: 1 
iter: 4  mgc: 3.523848e-13 
iter: 1  mgc: 3.523848e-13 
outer mgc:  21.29244 
iter: 1  value: 19299.75 mgc: 3.789351 ustep: 1 
iter: 2  value: 19299.75 mgc: 0.02563305 ustep: 1 
iter: 3  value: 19299.75 mgc: 2.100613e-06 ustep: 1 
iter: 4  mgc: 4.780898e-14 
iter: 1  value: 19323 mgc: 1.105728 ustep: 1 
iter: 2  value: 19323 mgc: 0.003639477 ustep: 1 
iter: 3  value: 19323 mgc: 5.770965e-08 ustep: 1 
iter: 4  mgc: 7.327472e-15 
iter: 1  value: 19328.12 mgc: 0.5577312 ustep: 1 
iter: 2  value: 19328.12 mgc: 0.0007786661 ustep: 1 
iter: 3  mgc: 3.055191e-09 
iter: 1  mgc: 3.055191e-09 
outer mgc:  27.09919 
iter: 1  value: 19322.12 mgc: 0.7214656 ustep: 1 
iter: 2  value: 19322.12 mgc: 0.0004221371 ustep: 1 
iter: 3  mgc: 6.176452e-10 
iter: 1  mgc: 6.176452e-10 
outer mgc:  12.9708 
iter: 1  value: 19312.92 mgc: 0.6832685 ustep: 1 
iter: 2  value: 19312.92 mgc: 0.0008964812 ustep: 1 
iter: 3  mgc: 4.842616e-09 
iter: 1  mgc: 4.842616e-09 
outer mgc:  14.37199 
iter: 1  value: 19293.13 mgc: 1.687155 ustep: 1 
iter: 2  value: 19293.13 mgc: 0.004231586 ustep: 1 
iter: 3  value: 19293.13 mgc: 1.430402e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  11.89434 
iter: 1  value: 19273.96 mgc: 1.355399 ustep: 1 
iter: 2  value: 19273.96 mgc: 0.002411043 ustep: 1 
iter: 3  mgc: 5.429263e-09 
iter: 1  mgc: 5.429263e-09 
outer mgc:  8.649692 
iter: 1  value: 19267.1 mgc: 0.9882149 ustep: 1 
iter: 2  value: 19267.1 mgc: 0.001872012 ustep: 1 
iter: 3  value: 19267.1 mgc: 1.842701e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  value: 19271.23 mgc: 0.3634153 ustep: 1 
iter: 2  value: 19271.23 mgc: 0.000352834 ustep: 1 
iter: 3  mgc: 6.842781e-10 
iter: 1  mgc: 6.842781e-10 
outer mgc:  5.629895 
iter: 1  value: 19268.83 mgc: 0.6994802 ustep: 1 
iter: 2  value: 19268.83 mgc: 0.0002052281 ustep: 1 
iter: 3  mgc: 5.502221e-11 
iter: 1  value: 19270.43 mgc: 0.1485754 ustep: 1 
iter: 2  value: 19270.43 mgc: 9.739229e-06 ustep: 1 
iter: 3  mgc: 1.04361e-13 
iter: 1  mgc: 1.04361e-13 
outer mgc:  3.499429 
iter: 1  value: 19269.22 mgc: 0.1413121 ustep: 1 
iter: 2  value: 19269.22 mgc: 1.599679e-05 ustep: 1 
iter: 3  mgc: 1.140532e-12 
iter: 1  mgc: 1.140532e-12 
outer mgc:  3.236554 
iter: 1  value: 19265.72 mgc: 0.3865871 ustep: 1 
iter: 2  value: 19265.72 mgc: 4.816128e-05 ustep: 1 
iter: 3  mgc: 1.048961e-11 
iter: 1  mgc: 1.048961e-11 
outer mgc:  4.425419 
iter: 1  value: 19258.18 mgc: 0.6669456 ustep: 1 
iter: 2  value: 19258.18 mgc: 0.0001975427 ustep: 1 
iter: 3  mgc: 2.660407e-10 
iter: 1  mgc: 2.660407e-10 
outer mgc:  2.801411 
iter: 1  value: 19245.84 mgc: 1.576461 ustep: 1 
iter: 2  value: 19245.84 mgc: 0.0004291356 ustep: 1 
iter: 3  mgc: 7.256884e-10 
iter: 1  mgc: 7.256884e-10 
outer mgc:  4.987539 
iter: 1  value: 19235.78 mgc: 1.203286 ustep: 1 
iter: 2  value: 19235.78 mgc: 0.0002986503 ustep: 1 
iter: 3  mgc: 4.103322e-10 
iter: 1  mgc: 4.103322e-10 
outer mgc:  12.45846 
iter: 1  value: 19221.38 mgc: 2.197242 ustep: 1 
iter: 2  value: 19221.38 mgc: 0.000337407 ustep: 1 
iter: 3  mgc: 3.239181e-10 
iter: 1  mgc: 3.239181e-10 
outer mgc:  3.814885 
iter: 1  value: 19205.88 mgc: 1.818491 ustep: 1 
iter: 2  value: 19205.88 mgc: 0.0002454544 ustep: 1 
iter: 3  mgc: 1.6766e-10 
iter: 1  mgc: 1.6766e-10 
outer mgc:  4.298087 
iter: 1  value: 19191.27 mgc: 1.665757 ustep: 1 
iter: 2  value: 19191.27 mgc: 0.0004984362 ustep: 1 
iter: 3  mgc: 3.465925e-10 
iter: 1  mgc: 3.465925e-10 
outer mgc:  3.454703 
iter: 1  value: 19178.74 mgc: 3.2457 ustep: 1 
iter: 2  value: 19178.74 mgc: 0.0001340663 ustep: 1 
iter: 3  mgc: 2.274225e-11 
iter: 1  mgc: 2.274225e-11 
outer mgc:  9.174919 
iter: 1  value: 19165.07 mgc: 3.893615 ustep: 1 
iter: 2  value: 19165.07 mgc: 8.148065e-05 ustep: 1 
iter: 3  mgc: 5.135448e-12 
iter: 1  mgc: 5.135448e-12 
outer mgc:  2.955872 
iter: 1  value: 19150.25 mgc: 3.627639 ustep: 1 
iter: 2  value: 19150.25 mgc: 0.0001033443 ustep: 1 
iter: 3  mgc: 1.510481e-11 
iter: 1  value: 19127.35 mgc: 6.826078 ustep: 1 
iter: 2  value: 19127.35 mgc: 0.0002136751 ustep: 1 
iter: 3  mgc: 3.526027e-11 
iter: 1  mgc: 3.526027e-11 
outer mgc:  3.850245 
iter: 1  value: 19090.05 mgc: 19.07178 ustep: 1 
iter: 2  value: 19090.05 mgc: 0.000347067 ustep: 1 
iter: 3  mgc: 5.558271e-11 
iter: 1  mgc: 5.558271e-11 
outer mgc:  1.866394 
iter: 1  value: 19056.23 mgc: 29.18377 ustep: 1 
iter: 2  value: 19056.23 mgc: 0.0001077409 ustep: 1 
iter: 3  mgc: 3.906209e-12 
iter: 1  mgc: 3.906209e-12 
outer mgc:  7.101004 
iter: 1  value: 19021.53 mgc: 38.78674 ustep: 1 
iter: 2  value: 19021.53 mgc: 5.737774e-05 ustep: 1 
iter: 3  mgc: 9.010293e-13 
iter: 1  mgc: 9.010293e-13 
outer mgc:  2.747187 
iter: 1  value: 18965.1 mgc: 150.0519 ustep: 1 
iter: 2  value: 18965.1 mgc: 0.0001323299 ustep: 1 
iter: 3  mgc: 1.687539e-12 
iter: 1  mgc: 1.687539e-12 
outer mgc:  0.7768972 
iter: 1  value: 18917.73 mgc: 189.2426 ustep: 1 
iter: 2  value: 18917.73 mgc: 3.284373e-05 ustep: 1 
iter: 3  mgc: 1.003642e-13 
iter: 1  mgc: 1.003642e-13 
outer mgc:  0.9689582 
iter: 1  value: 18871.09 mgc: 302.5131 ustep: 1 
iter: 2  value: 18871.09 mgc: 1.953361e-05 ustep: 1 
iter: 3  mgc: 8.593126e-14 
iter: 1  mgc: 8.593126e-14 
outer mgc:  0.6115533 
iter: 1  value: 18798.74 mgc: 1108.774 ustep: 1 
iter: 2  value: 18798.74 mgc: 1.457609e-05 ustep: 1 
iter: 3  mgc: 2.066125e-13 
iter: 1  mgc: 2.066125e-13 
outer mgc:  0.2753895 
iter: 1  value: 18736.02 mgc: 1704.455 ustep: 1 
iter: 2  value: 18736.02 mgc: 3.514145e-06 ustep: 1 
iter: 3  mgc: 5.313527e-13 
iter: 1  mgc: 5.313527e-13 
outer mgc:  0.2707386 
iter: 1  value: 18673.22 mgc: 3158.956 ustep: 1 
iter: 2  value: 18673.22 mgc: 7.552903e-07 ustep: 1 
iter: 3  mgc: 8.331114e-13 
iter: 1  mgc: 8.331114e-13 
outer mgc:  0.1120527 
iter: 1  value: 18610.44 mgc: 5872.957 ustep: 1 
iter: 2  value: 18610.44 mgc: 1.846671e-07 ustep: 1 
mgc: 9.987566e-13 
iter: 1  mgc: 9.987566e-13 
outer mgc:  0.03367631 
iter: 1  value: 18547.72 mgc: 10897.38 ustep: 1 
iter: 2  value: 18547.72 mgc: 8.340107e-08 ustep: 1 
mgc: 2.362555e-12 
iter: 1  mgc: 2.362555e-12 
outer mgc:  0.03515502 
iter: 1  value: 18484.99 mgc: 20224.7 ustep: 1 
iter: 2  value: 18484.99 mgc: 1.641899e-08 ustep: 1 
mgc: 4.853895e-12 
iter: 1  mgc: 4.853895e-12 
outer mgc:  0.01943108 
iter: 1  value: 18422.28 mgc: 37526.2 ustep: 1 
iter: 2  mgc: 6.50988e-09 
iter: 1  mgc: 6.50988e-09 
outer mgc:  0.007163983 
iter: 1  value: 18359.56 mgc: 69621.23 ustep: 1 
iter: 2  mgc: 1.46953e-09 
iter: 1  mgc: 1.46953e-09 
outer mgc:  0.002525598 
iter: 1  value: 18296.85 mgc: 129145.4 ustep: 1 
iter: 2  mgc: 5.25505e-10 
iter: 1  mgc: 5.25505e-10 
outer mgc:  0.002974077 
iter: 1  value: 18234.14 mgc: 239530.3 ustep: 1 
iter: 2  mgc: 1.244738e-10 
iter: 1  mgc: 1.244738e-10 
outer mgc:  0.001389884 
iter: 1  value: 18171.44 mgc: 444208 ustep: 1 
iter: 2  mgc: 1.514917e-10 
iter: 1  mgc: 1.514917e-10 
outer mgc:  0.0001984882 
iter: 1  value: 18108.74 mgc: 823681.3 ustep: 1 
iter: 2  mgc: 2.990679e-10 
iter: 1  mgc: 2.990679e-10 
outer mgc:  0.0003707731 
iter: 1  value: 18046.04 mgc: 1527140 ustep: 1 
iter: 2  mgc: 6.522667e-10 
iter: 1  mgc: 6.522667e-10 
outer mgc:  0.0002387361 
iter: 1  value: 17983.35 mgc: 2831032 ustep: 1 
iter: 2  mgc: 1.688358e-09 
iter: 1  mgc: 1.688358e-09 
outer mgc:  4.538159e-05 
iter: 1  value: 17912.93 mgc: 6644642 ustep: 1 
iter: 2  mgc: 1.738434e-09 
iter: 1  mgc: 1.738434e-09 
outer mgc:  4.593648e-05 
iter: 1  mgc: 1.738434e-09 
iter: 1  mgc: 1.738434e-09 
outer mgc:  4.593648e-05 
iter: 1  value: 17912.92 mgc: 0.005824465 ustep: 1 
iter: 2  value: 17912.92 mgc: 1.459509e-08 ustep: 1 
mgc: 1.037195e-09 
outer mgc:  0.4162095 
iter: 1  value: 17912.93 mgc: 0.005823153 ustep: 1 
iter: 2  value: 17912.93 mgc: 1.464028e-08 ustep: 1 
mgc: 1.220896e-09 
outer mgc:  0.4161091 
iter: 1  value: 17912.93 mgc: 0.002743883 ustep: 1 
iter: 2  mgc: 4.838973e-09 
outer mgc:  0.2473646 
iter: 1  value: 17912.93 mgc: 0.002744803 ustep: 1 
iter: 2  mgc: 4.842567e-09 
outer mgc:  0.2473656 
iter: 1  value: 17912.93 mgc: 0.005739459 ustep: 1 
iter: 2  mgc: 7.295792e-09 
outer mgc:  0.4488326 
iter: 1  value: 17912.93 mgc: 0.005738486 ustep: 1 
iter: 2  mgc: 7.274713e-09 
outer mgc:  0.4485322 
iter: 1  value: 17912.93 mgc: 0.003156427 ustep: 1 
iter: 2  mgc: 2.300018e-09 
outer mgc:  0.2014427 
iter: 1  value: 17912.93 mgc: 0.003155817 ustep: 1 
iter: 2  mgc: 2.295262e-09 
outer mgc:  0.2012354 
iter: 1  value: 17913.02 mgc: 6355.444 ustep: 1 
iter: 2  value: 17913.02 mgc: 8.419008e-08 ustep: 1 
mgc: 2.110432e-09 
outer mgc:  0.008198561 
iter: 1  value: 17912.84 mgc: 6361.803 ustep: 1 
iter: 2  value: 17912.84 mgc: 8.391327e-08 ustep: 1 
mgc: 9.063899e-10 
outer mgc:  0.008223612 
iter: 1  value: 17913.03 mgc: 6349.091 ustep: 1 
mgc: 1.238242e-09 
outer mgc:  4.59363e-05 
iter: 1  value: 17912.83 mgc: 6368.167 ustep: 1 
mgc: 1.39032e-09 
outer mgc:  4.593667e-05 
iter: 1  value: 17912.88 mgc: 1120.913 ustep: 1 
mgc: 2.014108e-09 
outer mgc:  4.593645e-05 
iter: 1  value: 17912.97 mgc: 1120.409 ustep: 1 
mgc: 1.89741e-09 
outer mgc:  4.593651e-05 
iter: 1  value: 17912.92 mgc: 0.004942997 ustep: 1 
iter: 2  value: 17912.92 mgc: 1.679934e-08 ustep: 1 
mgc: 1.357669e-09 
outer mgc:  0.1744495 
iter: 1  value: 17912.93 mgc: 0.004939422 ustep: 1 
iter: 2  value: 17912.93 mgc: 1.675196e-08 ustep: 1 
mgc: 8.549366e-10 
outer mgc:  0.1743491 
[Fri Aug 13 12:27:40 2021]
Finished job 0.
1 of 1 steps (100%) done

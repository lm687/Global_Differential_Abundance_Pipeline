Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:10:15 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4265.911517 
final  value 4088.738615 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3757.574 mgc: 5.680061 ustep: 0.8994163 
iter: 2  value: 3742.143 mgc: 2.214408 ustep: 0.772724 
iter: 3  value: 3740.148 mgc: 1.943414 ustep: 0.8790593 
iter: 4  value: 3739.072 mgc: 1.162623 ustep: 0.9375879 
iter: 5  value: 3739.051 mgc: 0.2876073 ustep: 0.9682944 
iter: 6  value: 3739.051 mgc: 0.009867636 ustep: 0.9840211 
iter: 7  value: 3739.051 mgc: 7.71164e-05 ustep: 0.9919792 
iter: 8  value: 3739.051 mgc: 3.231199e-07 ustep: 0.9959819 
iter: 9  mgc: 8.139732e-10 
iter: 1  mgc: 8.139732e-10 
Matching hessian patterns... Done
outer mgc:  25.66193 
iter: 1  value: 3699.475 mgc: 1.529573 ustep: 1 
iter: 2  value: 3699.452 mgc: 0.1417328 ustep: 1 
iter: 3  value: 3699.452 mgc: 0.001966506 ustep: 1 
iter: 4  value: 3699.452 mgc: 4.278567e-07 ustep: 1 
iter: 5  mgc: 2.069178e-14 
iter: 1  value: 3666.77 mgc: 9.944563 ustep: 1 
iter: 2  value: 3666.368 mgc: 2.100566 ustep: 1 
iter: 3  value: 3666.368 mgc: 0.07074121 ustep: 1 
iter: 4  value: 3666.368 mgc: 8.412602e-05 ustep: 1 
iter: 5  mgc: 1.283789e-10 
iter: 1  mgc: 1.283789e-10 
outer mgc:  26.78643 
iter: 1  value: 3637.055 mgc: 1573.048 ustep: 1 
iter: 2  value: 3635.782 mgc: 3.243239 ustep: 1 
iter: 3  value: 3635.769 mgc: 0.2948591 ustep: 1 
iter: 4  value: 3635.769 mgc: 0.002148689 ustep: 1 
iter: 5  value: 3635.769 mgc: 6.579876e-07 ustep: 1 
iter: 6  mgc: 6.228351e-14 
iter: 1  value: 3671.24 mgc: 10.18606 ustep: 1 
iter: 2  value: 3670.937 mgc: 0.9536234 ustep: 1 
iter: 3  value: 3670.937 mgc: 0.0314984 ustep: 1 
iter: 4  value: 3670.937 mgc: 4.992864e-05 ustep: 1 
iter: 5  mgc: 2.284974e-10 
iter: 1  mgc: 2.284974e-10 
outer mgc:  32.1719 
iter: 1  value: 3706.547 mgc: 6.573401 ustep: 1 
iter: 2  value: 3705.735 mgc: 0.9674528 ustep: 1 
iter: 3  value: 3705.733 mgc: 0.06701013 ustep: 1 
iter: 4  value: 3705.733 mgc: 0.0004125432 ustep: 1 
iter: 5  value: 3705.733 mgc: 1.677644e-08 ustep: 1 
mgc: 3.996803e-15 
iter: 1  value: 3662.289 mgc: 3.936567 ustep: 1 
iter: 2  value: 3662.24 mgc: 0.2389608 ustep: 1 
iter: 3  value: 3662.24 mgc: 0.003181503 ustep: 1 
iter: 4  value: 3662.24 mgc: 5.05428e-07 ustep: 1 
iter: 5  mgc: 1.39333e-14 
iter: 1  mgc: 1.39333e-14 
outer mgc:  10.29274 
iter: 1  value: 3656.029 mgc: 4.998503 ustep: 1 
iter: 2  value: 3656.02 mgc: 0.1745907 ustep: 1 
iter: 3  value: 3656.02 mgc: 0.0006381924 ustep: 1 
iter: 4  value: 3656.02 mgc: 1.969963e-08 ustep: 1 
mgc: 3.552714e-15 
iter: 1  mgc: 3.552714e-15 
outer mgc:  12.19721 
iter: 1  value: 3655.925 mgc: 4.786369 ustep: 1 
iter: 2  value: 3655.921 mgc: 0.163902 ustep: 1 
iter: 3  value: 3655.921 mgc: 0.0002574454 ustep: 1 
iter: 4  mgc: 2.256137e-10 
iter: 1  value: 3654.992 mgc: 1.375142 ustep: 1 
iter: 2  value: 3654.992 mgc: 0.01008005 ustep: 1 
iter: 3  value: 3654.992 mgc: 3.993536e-06 ustep: 1 
iter: 4  mgc: 4.207745e-14 
iter: 1  mgc: 4.207745e-14 
outer mgc:  2.568146 
iter: 1  value: 3652.83 mgc: 2.072197 ustep: 1 
iter: 2  value: 3652.83 mgc: 0.01572708 ustep: 1 
iter: 3  value: 3652.83 mgc: 9.339878e-06 ustep: 1 
iter: 4  mgc: 6.166179e-13 
iter: 1  mgc: 6.166179e-13 
outer mgc:  1.826857 
iter: 1  value: 3650.968 mgc: 1.06831 ustep: 1 
iter: 2  value: 3650.968 mgc: 0.01360329 ustep: 1 
iter: 3  value: 3650.968 mgc: 2.496067e-06 ustep: 1 
iter: 4  mgc: 7.194245e-14 
iter: 1  mgc: 7.194245e-14 
outer mgc:  2.011696 
iter: 1  value: 3649.8 mgc: 1.208045 ustep: 1 
iter: 2  value: 3649.8 mgc: 0.01024258 ustep: 1 
iter: 3  value: 3649.8 mgc: 1.993405e-06 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.9676232 
iter: 1  value: 3648.438 mgc: 1.063801 ustep: 1 
iter: 2  value: 3648.438 mgc: 0.009559896 ustep: 1 
iter: 3  value: 3648.438 mgc: 1.418389e-06 ustep: 1 
iter: 4  mgc: 2.517431e-14 
iter: 1  mgc: 2.517431e-14 
outer mgc:  1.274481 
iter: 1  value: 3648.677 mgc: 1.641431 ustep: 1 
iter: 2  value: 3648.677 mgc: 0.008095043 ustep: 1 
iter: 3  value: 3648.677 mgc: 1.55654e-06 ustep: 1 
iter: 4  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  1.215882 
iter: 1  value: 3647.311 mgc: 0.7504043 ustep: 1 
iter: 2  value: 3647.311 mgc: 0.002712761 ustep: 1 
iter: 3  value: 3647.311 mgc: 3.567489e-07 ustep: 1 
iter: 4  mgc: 4.218847e-15 
iter: 1  mgc: 4.218847e-15 
outer mgc:  1.287404 
iter: 1  value: 3647.391 mgc: 1.776961 ustep: 1 
iter: 2  value: 3647.391 mgc: 0.02076427 ustep: 1 
iter: 3  value: 3647.391 mgc: 3.180919e-06 ustep: 1 
iter: 4  mgc: 1.169065e-13 
iter: 1  value: 3647.39 mgc: 0.712872 ustep: 1 
iter: 2  value: 3647.39 mgc: 0.00524378 ustep: 1 
iter: 3  value: 3647.39 mgc: 1.633261e-07 ustep: 1 
iter: 4  mgc: 1.065814e-14 
iter: 1  mgc: 1.065814e-14 
outer mgc:  1.875697 
iter: 1  value: 3647.497 mgc: 0.7698869 ustep: 1 
iter: 2  value: 3647.497 mgc: 0.002627186 ustep: 1 
iter: 3  value: 3647.497 mgc: 9.68097e-08 ustep: 1 
iter: 4  mgc: 5.107026e-15 
iter: 1  value: 3647.479 mgc: 0.3118257 ustep: 1 
iter: 2  value: 3647.479 mgc: 0.0002955062 ustep: 1 
iter: 3  mgc: 4.668279e-09 
iter: 1  mgc: 4.668279e-09 
outer mgc:  1.635515 
iter: 1  value: 3647.372 mgc: 0.1281961 ustep: 1 
iter: 2  value: 3647.372 mgc: 4.226537e-05 ustep: 1 
iter: 3  mgc: 1.136504e-10 
iter: 1  mgc: 1.136504e-10 
outer mgc:  0.241118 
iter: 1  value: 3647.054 mgc: 0.1967039 ustep: 1 
iter: 2  value: 3647.054 mgc: 0.0004593734 ustep: 1 
iter: 3  mgc: 1.096844e-09 
iter: 1  mgc: 1.096844e-09 
outer mgc:  0.3395636 
iter: 1  value: 3646.672 mgc: 0.2625665 ustep: 1 
iter: 2  value: 3646.672 mgc: 0.0001899332 ustep: 1 
iter: 3  mgc: 6.995542e-10 
iter: 1  value: 3645.573 mgc: 0.8289383 ustep: 1 
iter: 2  value: 3645.573 mgc: 0.001452832 ustep: 1 
iter: 3  value: 3645.573 mgc: 3.425972e-08 ustep: 1 
mgc: 8.21565e-15 
iter: 1  mgc: 8.21565e-15 
outer mgc:  0.5811805 
iter: 1  value: 3643.919 mgc: 1.239733 ustep: 1 
iter: 2  value: 3643.919 mgc: 0.001577502 ustep: 1 
iter: 3  value: 3643.919 mgc: 5.261019e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  0.5022155 
iter: 1  value: 3641.833 mgc: 1.47151 ustep: 1 
iter: 2  value: 3641.833 mgc: 0.0009048263 ustep: 1 
iter: 3  value: 3641.833 mgc: 1.027234e-08 ustep: 1 
mgc: 1.332268e-14 
iter: 1  mgc: 1.332268e-14 
outer mgc:  0.9627607 
iter: 1  value: 3640.293 mgc: 0.9291317 ustep: 1 
iter: 2  value: 3640.293 mgc: 0.00102624 ustep: 1 
iter: 3  value: 3640.293 mgc: 2.004568e-08 ustep: 1 
mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  0.369677 
iter: 1  value: 3639.506 mgc: 0.4796542 ustep: 1 
iter: 2  value: 3639.506 mgc: 0.001344765 ustep: 1 
iter: 3  mgc: 5.032155e-09 
iter: 1  mgc: 5.032155e-09 
outer mgc:  0.5288715 
iter: 1  value: 3637.992 mgc: 0.751797 ustep: 1 
iter: 2  value: 3637.992 mgc: 0.0002916524 ustep: 1 
iter: 3  mgc: 1.987981e-09 
iter: 1  mgc: 1.987981e-09 
outer mgc:  0.3366581 
iter: 1  value: 3635.441 mgc: 1.42382 ustep: 1 
iter: 2  value: 3635.441 mgc: 0.0005066605 ustep: 1 
iter: 3  mgc: 5.756982e-09 
iter: 1  mgc: 5.756982e-09 
outer mgc:  0.1120171 
iter: 1  value: 3633.255 mgc: 1.168439 ustep: 1 
iter: 2  value: 3633.255 mgc: 0.0002172036 ustep: 1 
iter: 3  mgc: 1.068463e-09 
iter: 1  mgc: 1.068463e-09 
outer mgc:  0.07332187 
iter: 1  value: 3629.851 mgc: 1.967304 ustep: 1 
iter: 2  value: 3629.851 mgc: 0.0002927213 ustep: 1 
iter: 3  mgc: 1.904966e-09 
iter: 1  mgc: 1.904966e-09 
outer mgc:  0.05174338 
iter: 1  value: 3626.939 mgc: 1.621366 ustep: 1 
iter: 2  value: 3626.939 mgc: 0.0001117993 ustep: 1 
iter: 3  mgc: 2.714815e-10 
iter: 1  mgc: 2.714815e-10 
outer mgc:  0.02519457 
iter: 1  value: 3623.519 mgc: 1.950548 ustep: 1 
iter: 2  value: 3623.519 mgc: 7.789593e-05 ustep: 1 
iter: 3  mgc: 1.301856e-10 
iter: 1  mgc: 1.301856e-10 
outer mgc:  0.0310767 
iter: 1  value: 3620.61 mgc: 1.598796 ustep: 1 
iter: 2  value: 3620.61 mgc: 3.329276e-05 ustep: 1 
iter: 3  mgc: 2.282885e-11 
iter: 1  mgc: 2.282885e-11 
outer mgc:  0.02108968 
iter: 1  value: 3616.792 mgc: 2.198875 ustep: 1 
iter: 2  value: 3616.792 mgc: 2.627704e-05 ustep: 1 
iter: 3  mgc: 1.435563e-11 
iter: 1  mgc: 1.435563e-11 
outer mgc:  0.01841353 
iter: 1  value: 3613.621 mgc: 1.75762 ustep: 1 
iter: 2  value: 3613.621 mgc: 1.035556e-05 ustep: 1 
iter: 3  mgc: 2.13074e-12 
iter: 1  mgc: 2.13074e-12 
outer mgc:  0.01026549 
iter: 1  value: 3609.646 mgc: 2.303637 ustep: 1 
iter: 2  value: 3609.646 mgc: 6.501794e-06 ustep: 1 
iter: 3  mgc: 8.757439e-13 
iter: 1  mgc: 8.757439e-13 
outer mgc:  0.01013576 
iter: 1  value: 3606.355 mgc: 1.832436 ustep: 1 
iter: 2  value: 3606.355 mgc: 2.647362e-06 ustep: 1 
iter: 3  mgc: 2.629008e-13 
iter: 1  mgc: 2.629008e-13 
outer mgc:  0.005753603 
iter: 1  value: 3602.277 mgc: 2.372252 ustep: 1 
iter: 2  value: 3602.277 mgc: 1.592236e-06 ustep: 1 
iter: 3  mgc: 4.556355e-13 
iter: 1  mgc: 4.556355e-13 
outer mgc:  0.005203598 
iter: 1  value: 3598.9 mgc: 1.884988 ustep: 1 
iter: 2  value: 3598.9 mgc: 6.274493e-07 ustep: 1 
iter: 3  mgc: 6.545875e-13 
iter: 1  mgc: 6.545875e-13 
outer mgc:  0.003045744 
iter: 1  value: 3594.769 mgc: 2.404359 ustep: 1 
iter: 2  value: 3594.769 mgc: 3.815748e-07 ustep: 1 
iter: 3  mgc: 5.844214e-13 
iter: 1  mgc: 5.844214e-13 
outer mgc:  0.002494272 
iter: 1  value: 3591.35 mgc: 1.912035 ustep: 1 
iter: 2  value: 3591.35 mgc: 1.389875e-07 ustep: 1 
iter: 3  mgc: 6.463718e-13 
iter: 1  mgc: 6.463718e-13 
outer mgc:  0.001499742 
iter: 1  value: 3587.187 mgc: 2.426467 ustep: 1 
iter: 2  value: 3587.187 mgc: 8.679686e-08 ustep: 1 
iter: 3  mgc: 1.632472e-12 
iter: 1  mgc: 1.632472e-12 
outer mgc:  0.001176043 
iter: 1  value: 3583.744 mgc: 1.929107 ustep: 1 
iter: 2  value: 3583.744 mgc: 3.003751e-08 ustep: 1 
mgc: 2.4869e-12 
iter: 1  mgc: 2.4869e-12 
outer mgc:  0.00072192 
iter: 1  value: 3579.564 mgc: 2.437501 ustep: 1 
iter: 2  value: 3579.564 mgc: 1.929078e-08 ustep: 1 
mgc: 4.437783e-12 
iter: 1  mgc: 4.437783e-12 
outer mgc:  0.0005551756 
iter: 1  value: 3576.109 mgc: 1.936746 ustep: 1 
iter: 2  mgc: 6.501737e-09 
iter: 1  mgc: 6.501737e-09 
outer mgc:  0.0003420055 
iter: 1  value: 3571.922 mgc: 2.441983 ustep: 1 
iter: 2  mgc: 4.257578e-09 
iter: 1  mgc: 4.257578e-09 
outer mgc:  0.0002605061 
iter: 1  value: 3568.461 mgc: 1.94037 ustep: 1 
iter: 2  mgc: 1.404264e-09 
iter: 1  mgc: 1.404264e-09 
outer mgc:  0.0001591911 
iter: 1  value: 3564.269 mgc: 2.444505 ustep: 1 
iter: 2  mgc: 9.276913e-10 
iter: 1  mgc: 9.276913e-10 
outer mgc:  0.0001221314 
iter: 1  value: 3560.806 mgc: 1.942587 ustep: 1 
iter: 2  mgc: 3.019616e-10 
iter: 1  mgc: 3.019616e-10 
outer mgc:  7.368084e-05 
iter: 1  mgc: 3.019616e-10 
iter: 1  mgc: 3.019616e-10 
outer mgc:  7.368084e-05 
iter: 1  value: 3560.809 mgc: 0.005560482 ustep: 1 
iter: 2  value: 3560.809 mgc: 3.143004e-07 ustep: 1 
iter: 3  mgc: 1.300959e-11 
outer mgc:  0.08703199 
iter: 1  value: 3560.803 mgc: 0.005559249 ustep: 1 
iter: 2  value: 3560.803 mgc: 3.136213e-07 ustep: 1 
iter: 3  mgc: 1.800338e-11 
outer mgc:  0.08700886 
iter: 1  value: 3560.807 mgc: 0.002855942 ustep: 1 
iter: 2  value: 3560.807 mgc: 1.562047e-07 ustep: 1 
iter: 3  mgc: 3.408229e-11 
outer mgc:  0.04526988 
iter: 1  value: 3560.805 mgc: 0.002855395 ustep: 1 
iter: 2  value: 3560.805 mgc: 1.561111e-07 ustep: 1 
iter: 3  mgc: 1.651557e-11 
outer mgc:  0.04524612 
iter: 1  value: 3560.805 mgc: 0.004733752 ustep: 1 
iter: 2  value: 3560.805 mgc: 2.587499e-07 ustep: 1 
iter: 3  mgc: 2.307354e-11 
outer mgc:  0.05204604 
iter: 1  value: 3560.807 mgc: 0.004730867 ustep: 1 
iter: 2  value: 3560.807 mgc: 2.585345e-07 ustep: 1 
iter: 3  mgc: 2.389999e-11 
outer mgc:  0.05203148 
iter: 1  value: 3560.805 mgc: 0.002534211 ustep: 1 
iter: 2  value: 3560.805 mgc: 7.534788e-08 ustep: 1 
iter: 3  mgc: 2.415423e-11 
outer mgc:  0.02668809 
iter: 1  value: 3560.807 mgc: 0.002532709 ustep: 1 
iter: 2  value: 3560.807 mgc: 7.524256e-08 ustep: 1 
iter: 3  mgc: 2.499645e-11 
outer mgc:  0.02669404 
iter: 1  value: 3560.821 mgc: 118.6891 ustep: 1 
iter: 2  value: 3560.821 mgc: 5.936207e-07 ustep: 1 
iter: 3  mgc: 1.135736e-11 
outer mgc:  0.01495367 
iter: 1  value: 3560.791 mgc: 119.0457 ustep: 1 
iter: 2  value: 3560.791 mgc: 5.941707e-07 ustep: 1 
iter: 3  mgc: 1.722089e-11 
outer mgc:  0.01494438 
iter: 1  value: 3560.818 mgc: 118.8044 ustep: 1 
iter: 2  value: 3560.818 mgc: 1.436899e-06 ustep: 1 
iter: 3  mgc: 2.646905e-11 
outer mgc:  0.01930128 
iter: 1  value: 3560.794 mgc: 118.9232 ustep: 1 
iter: 2  value: 3560.794 mgc: 1.435663e-06 ustep: 1 
iter: 3  mgc: 1.847633e-11 
outer mgc:  0.01923439 
iter: 1  value: 3560.806 mgc: 4.825194e-05 ustep: 1 
mgc: 2.402656e-11 
outer mgc:  7.36786e-05 
iter: 1  value: 3560.806 mgc: 4.825142e-05 ustep: 1 
mgc: 1.595657e-11 
outer mgc:  7.368309e-05 
iter: 1  value: 3560.802 mgc: 0.003803216 ustep: 1 
iter: 2  value: 3560.802 mgc: 1.698909e-07 ustep: 1 
iter: 3  mgc: 2.063238e-11 
outer mgc:  0.02869662 
iter: 1  value: 3560.81 mgc: 0.003800301 ustep: 1 
iter: 2  value: 3560.81 mgc: 1.697283e-07 ustep: 1 
iter: 3  mgc: 2.82947e-11 
outer mgc:  0.02883544 
[Sun Aug 15 21:10:17 2021]
Finished job 0.
1 of 1 steps (100%) done

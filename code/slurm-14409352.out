Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:42:21 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4622.960511 
final  value 4356.508293 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 542.1137 mgc: 92.1517 ustep: 1 
iter: 2  value: 523.9558 mgc: 12.89551 ustep: 1 
iter: 3  value: 522.8974 mgc: 3.245493 ustep: 1 
iter: 4  value: 522.8663 mgc: 0.4357659 ustep: 1 
iter: 5  value: 522.8662 mgc: 0.02110184 ustep: 1 
iter: 6  value: 522.8662 mgc: 5.489742e-05 ustep: 1 
iter: 7  mgc: 3.747042e-10 
iter: 1  mgc: 3.747042e-10 
Matching hessian patterns... Done
outer mgc:  203.0614 
iter: 1  value: 410.8568 mgc: 39.12696 ustep: 1 
iter: 2  value: 409.1973 mgc: 5.001614 ustep: 1 
iter: 3  value: 409.1967 mgc: 0.0932982 ustep: 1 
iter: 4  value: 409.1967 mgc: 5.735606e-05 ustep: 1 
iter: 5  mgc: 2.962214e-11 
iter: 1  mgc: 2.962214e-11 
outer mgc:  60.16006 
iter: 1  value: 395.5788 mgc: 27.182 ustep: 1 
iter: 2  value: 394.8552 mgc: 3.357171 ustep: 1 
iter: 3  value: 394.8548 mgc: 0.09367017 ustep: 1 
iter: 4  value: 394.8548 mgc: 0.0001747978 ustep: 1 
iter: 5  mgc: 2.192772e-09 
iter: 1  mgc: 2.192772e-09 
outer mgc:  31.91754 
iter: 1  value: 388.2077 mgc: 16.44955 ustep: 1 
iter: 2  value: 387.6993 mgc: 2.571037 ustep: 1 
iter: 3  value: 387.6991 mgc: 0.07263388 ustep: 1 
iter: 4  value: 387.6991 mgc: 6.311926e-05 ustep: 1 
iter: 5  mgc: 7.506923e-11 
iter: 1  mgc: 7.506923e-11 
outer mgc:  45.30292 
iter: 1  value: 425.7974 mgc: 24.95573 ustep: 1 
iter: 2  value: 425.1881 mgc: 2.330514 ustep: 1 
iter: 3  value: 425.1879 mgc: 0.05610865 ustep: 1 
iter: 4  value: 425.1879 mgc: 5.082583e-05 ustep: 1 
iter: 5  mgc: 7.608492e-11 
iter: 1  value: 379.3172 mgc: 8.528452 ustep: 1 
iter: 2  value: 379.301 mgc: 0.4075755 ustep: 1 
iter: 3  value: 379.301 mgc: 0.002349902 ustep: 1 
iter: 4  value: 379.301 mgc: 7.94429e-08 ustep: 1 
mgc: 3.641532e-14 
iter: 1  mgc: 3.641532e-14 
outer mgc:  23.50446 
iter: 1  value: 384.1543 mgc: 18.20177 ustep: 1 
iter: 2  value: 384.0198 mgc: 1.502161 ustep: 1 
iter: 3  value: 384.0198 mgc: 0.01636161 ustep: 1 
iter: 4  value: 384.0198 mgc: 2.206116e-06 ustep: 1 
iter: 5  mgc: 5.262457e-14 
iter: 1  value: 377.7609 mgc: 6.24066 ustep: 1 
iter: 2  value: 377.7596 mgc: 0.1484174 ustep: 1 
iter: 3  value: 377.7596 mgc: 0.0001635399 ustep: 1 
iter: 4  mgc: 2.153515e-10 
iter: 1  mgc: 2.153515e-10 
outer mgc:  10.10864 
iter: 1  value: 376.8674 mgc: 2.731718 ustep: 1 
iter: 2  value: 376.8673 mgc: 0.02281016 ustep: 1 
iter: 3  value: 376.8673 mgc: 7.442304e-06 ustep: 1 
iter: 4  mgc: 5.393463e-13 
iter: 1  mgc: 5.393463e-13 
outer mgc:  12.25511 
iter: 1  value: 375.009 mgc: 12.10449 ustep: 1 
iter: 2  value: 374.9927 mgc: 0.6131771 ustep: 1 
iter: 3  value: 374.9927 mgc: 0.002590774 ustep: 1 
iter: 4  value: 374.9927 mgc: 4.709028e-08 ustep: 1 
mgc: 2.708944e-14 
iter: 1  mgc: 2.708944e-14 
outer mgc:  12.99927 
iter: 1  value: 371.4372 mgc: 13.24175 ustep: 1 
iter: 2  value: 371.379 mgc: 0.4309264 ustep: 1 
iter: 3  value: 371.379 mgc: 0.003344138 ustep: 1 
iter: 4  value: 371.379 mgc: 6.572141e-07 ustep: 1 
iter: 5  mgc: 2.842171e-14 
iter: 1  mgc: 2.842171e-14 
outer mgc:  8.991859 
iter: 1  value: 369.8085 mgc: 15.46122 ustep: 1 
iter: 2  value: 369.5749 mgc: 0.8159643 ustep: 1 
iter: 3  value: 369.5749 mgc: 0.0087878 ustep: 1 
iter: 4  value: 369.5749 mgc: 1.481883e-06 ustep: 1 
iter: 5  mgc: 9.836576e-14 
iter: 1  mgc: 9.836576e-14 
outer mgc:  9.811428 
iter: 1  value: 368.8056 mgc: 11.58776 ustep: 1 
iter: 2  value: 368.7656 mgc: 0.5134615 ustep: 1 
iter: 3  value: 368.7656 mgc: 0.001252495 ustep: 1 
iter: 4  value: 368.7656 mgc: 2.145236e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  15.47743 
iter: 1  value: 369.0853 mgc: 15.45402 ustep: 1 
iter: 2  value: 369.0467 mgc: 1.252499 ustep: 1 
iter: 3  value: 369.0467 mgc: 0.009925105 ustep: 1 
iter: 4  value: 369.0467 mgc: 1.342735e-06 ustep: 1 
iter: 5  mgc: 7.283063e-14 
iter: 1  value: 368.003 mgc: 10.59191 ustep: 1 
iter: 2  value: 367.9935 mgc: 0.483345 ustep: 1 
iter: 3  value: 367.9935 mgc: 0.001412904 ustep: 1 
iter: 4  value: 367.9935 mgc: 1.237717e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 3.68594e-14 
outer mgc:  14.20349 
iter: 1  value: 368.2419 mgc: 1.55154 ustep: 1 
iter: 2  value: 368.2419 mgc: 0.0136217 ustep: 1 
iter: 3  value: 368.2419 mgc: 2.752241e-06 ustep: 1 
iter: 4  mgc: 1.110223e-13 
iter: 1  mgc: 1.110223e-13 
outer mgc:  10.07376 
iter: 1  value: 368.3954 mgc: 8.946264 ustep: 1 
iter: 2  value: 368.3915 mgc: 0.2849126 ustep: 1 
iter: 3  value: 368.3915 mgc: 0.0005634693 ustep: 1 
iter: 4  mgc: 2.34701e-09 
iter: 1  value: 367.7616 mgc: 1.865303 ustep: 1 
iter: 2  value: 367.7616 mgc: 0.01398501 ustep: 1 
iter: 3  value: 367.7616 mgc: 1.332447e-06 ustep: 1 
iter: 4  mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  1.532602 
iter: 1  value: 367.6776 mgc: 3.661269 ustep: 1 
iter: 2  value: 367.6774 mgc: 0.0431202 ustep: 1 
iter: 3  value: 367.6774 mgc: 1.350463e-05 ustep: 1 
iter: 4  mgc: 1.329936e-12 
iter: 1  value: 367.6792 mgc: 1.422712 ustep: 1 
iter: 2  value: 367.6792 mgc: 0.006787218 ustep: 1 
iter: 3  value: 367.6792 mgc: 3.398029e-07 ustep: 1 
iter: 4  mgc: 4.507505e-14 
iter: 1  mgc: 4.507505e-14 
outer mgc:  0.8584814 
iter: 1  value: 367.6215 mgc: 0.9319771 ustep: 1 
iter: 2  value: 367.6215 mgc: 0.003592543 ustep: 1 
iter: 3  value: 367.6215 mgc: 1.398724e-07 ustep: 1 
iter: 4  mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  1.478033 
iter: 1  value: 367.5982 mgc: 0.5304886 ustep: 1 
iter: 2  value: 367.5982 mgc: 0.001624447 ustep: 1 
iter: 3  value: 367.5982 mgc: 2.64824e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.6797967 
iter: 1  value: 367.5893 mgc: 0.3282711 ustep: 1 
iter: 2  value: 367.5893 mgc: 0.0004676164 ustep: 1 
iter: 3  mgc: 3.932595e-09 
iter: 1  mgc: 3.932595e-09 
outer mgc:  0.7593802 
iter: 1  value: 367.6157 mgc: 0.3222825 ustep: 1 
iter: 2  value: 367.6157 mgc: 0.0006046908 ustep: 1 
iter: 3  value: 367.6157 mgc: 2.17812e-08 ustep: 1 
mgc: 2.953193e-14 
iter: 1  value: 367.5976 mgc: 0.1268782 ustep: 1 
iter: 2  value: 367.5976 mgc: 9.968049e-05 ustep: 1 
iter: 3  mgc: 2.824301e-10 
iter: 1  mgc: 2.824301e-10 
outer mgc:  0.5186195 
iter: 1  value: 367.6008 mgc: 0.08451951 ustep: 1 
iter: 2  value: 367.6008 mgc: 3.912989e-05 ustep: 1 
iter: 3  mgc: 1.614531e-11 
iter: 1  mgc: 1.614531e-11 
outer mgc:  0.1911824 
iter: 1  value: 367.6072 mgc: 0.09063853 ustep: 1 
iter: 2  value: 367.6072 mgc: 3.962597e-05 ustep: 1 
iter: 3  mgc: 1.222755e-11 
iter: 1  value: 367.6032 mgc: 0.05973738 ustep: 1 
iter: 2  value: 367.6032 mgc: 1.498212e-05 ustep: 1 
iter: 3  mgc: 1.427303e-12 
iter: 1  mgc: 1.427303e-12 
outer mgc:  0.156222 
iter: 1  value: 367.6034 mgc: 0.0308172 ustep: 1 
iter: 2  value: 367.6034 mgc: 2.489831e-06 ustep: 1 
iter: 3  mgc: 6.439294e-14 
iter: 1  mgc: 6.439294e-14 
outer mgc:  0.02312877 
iter: 1  value: 367.6039 mgc: 0.005987053 ustep: 1 
iter: 2  value: 367.6039 mgc: 5.46348e-07 ustep: 1 
iter: 3  mgc: 6.439294e-14 
iter: 1  value: 367.6044 mgc: 0.006196733 ustep: 1 
iter: 2  value: 367.6044 mgc: 5.859535e-07 ustep: 1 
iter: 3  mgc: 3.062134e-14 
iter: 1  mgc: 3.062134e-14 
outer mgc:  0.02227707 
iter: 1  value: 367.6053 mgc: 0.00632198 ustep: 1 
iter: 2  value: 367.6053 mgc: 1.914743e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
iter: 1  mgc: 2.575717e-14 
outer mgc:  0.01779618 
iter: 1  value: 367.6053 mgc: 0.004930563 ustep: 1 
iter: 2  value: 367.6053 mgc: 1.538078e-07 ustep: 1 
mgc: 2.403633e-14 
iter: 1  mgc: 2.403633e-14 
outer mgc:  0.014682 
iter: 1  value: 367.6048 mgc: 0.002927392 ustep: 1 
iter: 2  value: 367.6048 mgc: 3.028086e-08 ustep: 1 
mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  0.005219892 
iter: 1  value: 367.605 mgc: 0.002076256 ustep: 1 
iter: 2  value: 367.605 mgc: 3.135925e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  0.0005947049 
iter: 1  value: 367.605 mgc: 0.0004706367 ustep: 1 
iter: 2  mgc: 8.479275e-10 
iter: 1  mgc: 8.479275e-10 
outer mgc:  0.0001823579 
iter: 1  mgc: 8.479275e-10 
iter: 1  mgc: 8.479275e-10 
outer mgc:  0.0001823579 
iter: 1  value: 367.6053 mgc: 0.05769517 ustep: 1 
iter: 2  value: 367.6053 mgc: 8.916609e-06 ustep: 1 
iter: 3  mgc: 4.8761e-13 
outer mgc:  0.06065603 
iter: 1  value: 367.6047 mgc: 0.05769861 ustep: 1 
iter: 2  value: 367.6047 mgc: 8.928295e-06 ustep: 1 
iter: 3  mgc: 4.685141e-13 
outer mgc:  0.06048224 
iter: 1  value: 367.605 mgc: 0.03084474 ustep: 1 
iter: 2  value: 367.605 mgc: 2.793729e-06 ustep: 1 
iter: 3  mgc: 6.794565e-14 
outer mgc:  0.2551491 
iter: 1  value: 367.6052 mgc: 0.03084825 ustep: 1 
iter: 2  value: 367.6052 mgc: 2.792878e-06 ustep: 1 
iter: 3  mgc: 5.040413e-14 
outer mgc:  0.2549511 
iter: 1  value: 367.6049 mgc: 0.04978551 ustep: 1 
iter: 2  value: 367.6049 mgc: 8.648263e-06 ustep: 1 
iter: 3  mgc: 5.060397e-13 
outer mgc:  0.07242667 
iter: 1  value: 367.6051 mgc: 0.04978097 ustep: 1 
iter: 2  value: 367.6051 mgc: 8.657611e-06 ustep: 1 
iter: 3  mgc: 5.07594e-13 
outer mgc:  0.07265851 
iter: 1  value: 367.6055 mgc: 0.02963215 ustep: 1 
iter: 2  value: 367.6055 mgc: 3.213527e-06 ustep: 1 
iter: 3  mgc: 7.41629e-14 
outer mgc:  0.2124076 
iter: 1  value: 367.6047 mgc: 0.0296254 ustep: 1 
iter: 2  value: 367.6047 mgc: 3.214446e-06 ustep: 1 
iter: 3  mgc: 9.503509e-14 
outer mgc:  0.2127795 
iter: 1  value: 367.6039 mgc: 0.003908836 ustep: 1 
iter: 2  value: 367.6039 mgc: 2.088306e-07 ustep: 1 
mgc: 2.664535e-14 
outer mgc:  0.009264166 
iter: 1  value: 367.606 mgc: 0.003905802 ustep: 1 
iter: 2  value: 367.606 mgc: 2.086395e-07 ustep: 1 
mgc: 2.553513e-14 
outer mgc:  0.009281094 
iter: 1  value: 367.6062 mgc: 0.01119784 ustep: 1 
iter: 2  value: 367.6062 mgc: 1.096302e-06 ustep: 1 
iter: 3  mgc: 4.662937e-14 
outer mgc:  0.06585162 
iter: 1  value: 367.6038 mgc: 0.01122496 ustep: 1 
iter: 2  value: 367.6038 mgc: 1.102966e-06 ustep: 1 
iter: 3  mgc: 5.195844e-14 
outer mgc:  0.06593302 
iter: 1  value: 367.6074 mgc: 0.01083619 ustep: 1 
iter: 2  value: 367.6074 mgc: 1.64137e-06 ustep: 1 
iter: 3  mgc: 3.952394e-14 
outer mgc:  0.06112195 
iter: 1  value: 367.6026 mgc: 0.01085962 ustep: 1 
iter: 2  value: 367.6026 mgc: 1.646419e-06 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.06127408 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:42:23 2021]
Finished job 0.
1 of 1 steps (100%) done

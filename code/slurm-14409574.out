Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:49:37 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.6_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_10_3_0.6_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0.6, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.6_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_10_3_0.6_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.6_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.6_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_10_3_0.6_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4402.139441 
final  value 4127.710156 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3729.883 mgc: 3.603977 ustep: 1 
iter: 2  value: 3724.041 mgc: 2.496485 ustep: 1 
iter: 3  value: 3722.636 mgc: 2.243035 ustep: 1 
iter: 4  value: 3722.624 mgc: 0.2113326 ustep: 1 
iter: 5  value: 3722.624 mgc: 0.001343217 ustep: 1 
iter: 6  value: 3722.624 mgc: 1.244813e-06 ustep: 1 
iter: 7  mgc: 5.02709e-13 
iter: 1  mgc: 5.02709e-13 
Matching hessian patterns... Done
outer mgc:  21.50032 
iter: 1  value: 3686.352 mgc: 0.8352914 ustep: 1 
iter: 2  value: 3686.351 mgc: 0.02822175 ustep: 1 
iter: 3  value: 3686.351 mgc: 0.0001287587 ustep: 1 
iter: 4  mgc: 1.11671e-09 
iter: 1  value: 3655.729 mgc: 5.424042 ustep: 1 
iter: 2  value: 3655.718 mgc: 0.2841427 ustep: 1 
iter: 3  value: 3655.718 mgc: 0.001669529 ustep: 1 
iter: 4  value: 3655.718 mgc: 7.16216e-08 ustep: 1 
iter: 5  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  27.58628 
iter: 1  value: 3871.04 mgc: 55.68244 ustep: 0.3763225 
iter: 2  value: 3744.886 mgc: 9.367717 ustep: 0.2280509 
iter: 3  value: 3708.126 mgc: 6.993631 ustep: 0.2771991 
iter: 4  value: 3703.836 mgc: 7.463909 ustep: 0.5265444 
iter: 5  value: 3701.099 mgc: 6.379357 ustep: 0.4761788 
iter: 6  value: 3699.133 mgc: 5.052244 ustep: 0.6900881 
iter: 7  value: 3699.09 mgc: 0.7931105 ustep: 0.8307323 
iter: 8  value: 3699.09 mgc: 0.01479115 ustep: 0.911454 
iter: 9  value: 3699.09 mgc: 0.0002025117 ustep: 0.9547056 
iter: 10  value: 3699.09 mgc: 1.366855e-06 ustep: 0.9770926 
iter: 11  mgc: 4.571792e-09 
iter: 1  value: 3656.348 mgc: 4.211392 ustep: 1 
iter: 2  value: 3655.658 mgc: 1.120873 ustep: 1 
iter: 3  value: 3655.657 mgc: 0.05059678 ustep: 1 
iter: 4  value: 3655.657 mgc: 0.0001545183 ustep: 1 
iter: 5  mgc: 1.460471e-09 
iter: 1  mgc: 1.460471e-09 
outer mgc:  22.87439 
iter: 1  value: 3651.209 mgc: 3.648637 ustep: 1 
iter: 2  value: 3651.201 mgc: 0.1752766 ustep: 1 
iter: 3  value: 3651.201 mgc: 0.0006373996 ustep: 1 
iter: 4  value: 3651.201 mgc: 1.287604e-08 ustep: 1 
mgc: 4.218847e-15 
iter: 1  mgc: 4.218847e-15 
outer mgc:  11.94231 
iter: 1  value: 3641.482 mgc: 8.816444 ustep: 1 
iter: 2  value: 3641.081 mgc: 1.468476 ustep: 1 
iter: 3  value: 3641.08 mgc: 0.01268946 ustep: 1 
iter: 4  value: 3641.08 mgc: 1.207381e-05 ustep: 1 
iter: 5  mgc: 8.329337e-12 
iter: 1  mgc: 8.329337e-12 
outer mgc:  13.88164 
iter: 1  value: 3631.36 mgc: 11.32532 ustep: 1 
iter: 2  value: 3631.352 mgc: 0.34066 ustep: 1 
iter: 3  value: 3631.352 mgc: 0.0004317832 ustep: 1 
iter: 4  mgc: 8.443795e-10 
iter: 1  value: 3637.223 mgc: 3.570453 ustep: 1 
iter: 2  value: 3637.22 mgc: 0.05932509 ustep: 1 
iter: 3  value: 3637.22 mgc: 0.0001266835 ustep: 1 
iter: 4  mgc: 4.23849e-10 
iter: 1  mgc: 4.23849e-10 
outer mgc:  12.27128 
iter: 1  value: 3632.591 mgc: 4.468245 ustep: 1 
iter: 2  value: 3632.585 mgc: 0.09379482 ustep: 1 
iter: 3  value: 3632.585 mgc: 0.0003693645 ustep: 1 
iter: 4  mgc: 1.639067e-09 
iter: 1  mgc: 1.639067e-09 
outer mgc:  5.705106 
iter: 1  value: 3632.506 mgc: 4.640778 ustep: 1 
iter: 2  value: 3632.501 mgc: 0.199209 ustep: 1 
iter: 3  value: 3632.501 mgc: 0.0003230321 ustep: 1 
iter: 4  mgc: 8.155208e-10 
iter: 1  mgc: 8.155208e-10 
outer mgc:  4.871752 
iter: 1  value: 3631.015 mgc: 2.353222 ustep: 1 
iter: 2  value: 3631.015 mgc: 0.02212956 ustep: 1 
iter: 3  value: 3631.015 mgc: 4.294101e-06 ustep: 1 
iter: 4  mgc: 1.767475e-13 
iter: 1  mgc: 1.767475e-13 
outer mgc:  7.174273 
iter: 1  value: 3628.242 mgc: 1.748007 ustep: 1 
iter: 2  value: 3628.242 mgc: 0.02004504 ustep: 1 
iter: 3  value: 3628.242 mgc: 5.392797e-06 ustep: 1 
iter: 4  mgc: 2.609024e-13 
iter: 1  mgc: 2.609024e-13 
outer mgc:  3.880276 
iter: 1  value: 3632.294 mgc: 3.733078 ustep: 1 
iter: 2  value: 3632.293 mgc: 0.06650474 ustep: 1 
iter: 3  value: 3632.293 mgc: 1.978478e-05 ustep: 1 
iter: 4  mgc: 2.008615e-11 
iter: 1  value: 3628.375 mgc: 0.8402676 ustep: 1 
iter: 2  value: 3628.375 mgc: 0.002551938 ustep: 1 
iter: 3  value: 3628.375 mgc: 2.74646e-08 ustep: 1 
iter: 4  mgc: 6.439294e-15 
iter: 1  mgc: 6.439294e-15 
outer mgc:  3.207404 
iter: 1  value: 3628.275 mgc: 0.3676912 ustep: 1 
iter: 2  value: 3628.275 mgc: 0.0007556828 ustep: 1 
iter: 3  value: 3628.275 mgc: 5.314337e-08 ustep: 1 
iter: 4  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  1.351076 
iter: 1  value: 3628.154 mgc: 0.5121901 ustep: 1 
iter: 2  value: 3628.154 mgc: 0.0008988545 ustep: 1 
iter: 3  value: 3628.154 mgc: 3.006076e-08 ustep: 1 
iter: 4  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  1.20501 
iter: 1  value: 3627.035 mgc: 0.7114426 ustep: 1 
iter: 2  value: 3627.035 mgc: 0.001715545 ustep: 1 
iter: 3  value: 3627.035 mgc: 1.257597e-08 ustep: 1 
mgc: 6.883383e-15 
iter: 1  mgc: 6.883383e-15 
outer mgc:  0.580076 
iter: 1  value: 3626.497 mgc: 0.3778315 ustep: 1 
iter: 2  value: 3626.497 mgc: 0.0004490096 ustep: 1 
iter: 3  mgc: 1.963834e-09 
iter: 1  value: 3625.808 mgc: 0.5475637 ustep: 1 
iter: 2  value: 3625.808 mgc: 0.0007974153 ustep: 1 
iter: 3  mgc: 3.719767e-09 
iter: 1  mgc: 3.719767e-09 
outer mgc:  0.9100853 
iter: 1  value: 3624.236 mgc: 1.15794 ustep: 1 
iter: 2  value: 3624.236 mgc: 0.003284567 ustep: 1 
iter: 3  value: 3624.236 mgc: 1.230555e-07 ustep: 1 
iter: 4  mgc: 6.217249e-15 
iter: 1  mgc: 6.217249e-15 
outer mgc:  1.108539 
iter: 1  value: 3622.683 mgc: 0.7652099 ustep: 1 
iter: 2  value: 3622.683 mgc: 0.0005995946 ustep: 1 
iter: 3  mgc: 3.416512e-09 
iter: 1  mgc: 3.416512e-09 
outer mgc:  1.041723 
iter: 1  value: 3621.562 mgc: 0.4467006 ustep: 1 
iter: 2  value: 3621.562 mgc: 0.003261331 ustep: 1 
iter: 3  value: 3621.562 mgc: 1.068595e-06 ustep: 1 
iter: 4  mgc: 1.247891e-13 
iter: 1  mgc: 1.247891e-13 
outer mgc:  0.5265272 
iter: 1  value: 3620.51 mgc: 0.4556279 ustep: 1 
iter: 2  value: 3620.51 mgc: 0.000482169 ustep: 1 
iter: 3  mgc: 9.617211e-10 
iter: 1  value: 3618.656 mgc: 0.9388421 ustep: 1 
iter: 2  value: 3618.656 mgc: 0.001756507 ustep: 1 
iter: 3  value: 3618.656 mgc: 1.746925e-08 ustep: 1 
iter: 4  mgc: 1.354472e-14 
iter: 1  mgc: 1.354472e-14 
outer mgc:  0.6907242 
iter: 1  value: 3613.369 mgc: 6.200156 ustep: 1 
iter: 2  value: 3613.369 mgc: 0.01224822 ustep: 1 
iter: 3  value: 3613.369 mgc: 1.563916e-06 ustep: 1 
iter: 4  mgc: 8.748557e-14 
iter: 1  mgc: 8.748557e-14 
outer mgc:  1.569908 
iter: 1  value: 3611.854 mgc: 5.478154 ustep: 1 
iter: 2  value: 3611.854 mgc: 0.005873014 ustep: 1 
iter: 3  value: 3611.854 mgc: 2.050043e-07 ustep: 1 
iter: 4  mgc: 2.275957e-14 
iter: 1  mgc: 2.275957e-14 
outer mgc:  1.41045 
iter: 1  value: 3610.265 mgc: 1.304619 ustep: 1 
iter: 2  value: 3610.265 mgc: 0.003850762 ustep: 1 
iter: 3  value: 3610.265 mgc: 5.381019e-07 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.4181969 
iter: 1  value: 3608.198 mgc: 1.47176 ustep: 1 
iter: 2  value: 3608.198 mgc: 0.0003471399 ustep: 1 
iter: 3  mgc: 2.820072e-09 
iter: 1  mgc: 2.820072e-09 
outer mgc:  0.1739626 
iter: 1  value: 3603.709 mgc: 2.751812 ustep: 1 
iter: 2  value: 3603.709 mgc: 0.0003988973 ustep: 1 
iter: 3  mgc: 3.066642e-09 
iter: 1  mgc: 3.066642e-09 
outer mgc:  0.1020816 
iter: 1  value: 3600.197 mgc: 1.649598 ustep: 1 
iter: 2  value: 3600.197 mgc: 2.662922e-05 ustep: 1 
iter: 3  mgc: 3.52598e-11 
iter: 1  mgc: 3.52598e-11 
outer mgc:  0.0886904 
iter: 1  value: 3596.161 mgc: 2.103718 ustep: 1 
iter: 2  value: 3596.161 mgc: 4.297939e-05 ustep: 1 
iter: 3  mgc: 3.488099e-12 
iter: 1  mgc: 3.488099e-12 
outer mgc:  0.02683027 
iter: 1  value: 3592.778 mgc: 1.410519 ustep: 1 
iter: 2  value: 3592.778 mgc: 1.306278e-05 ustep: 1 
iter: 3  mgc: 1.871392e-12 
iter: 1  mgc: 1.871392e-12 
outer mgc:  0.01815509 
iter: 1  value: 3588.617 mgc: 1.860642 ustep: 1 
iter: 2  value: 3588.617 mgc: 5.358085e-06 ustep: 1 
iter: 3  mgc: 4.733991e-13 
iter: 1  mgc: 4.733991e-13 
outer mgc:  0.01870518 
iter: 1  value: 3585.162 mgc: 1.95028 ustep: 1 
iter: 2  value: 3585.162 mgc: 1.891306e-06 ustep: 1 
iter: 3  mgc: 3.755884e-13 
iter: 1  mgc: 3.755884e-13 
outer mgc:  0.01170512 
iter: 1  value: 3580.979 mgc: 1.936717 ustep: 1 
iter: 2  value: 3580.979 mgc: 1.059973e-06 ustep: 1 
iter: 3  mgc: 4.396483e-13 
iter: 1  mgc: 4.396483e-13 
outer mgc:  0.007376329 
iter: 1  value: 3577.522 mgc: 2.108064 ustep: 1 
iter: 2  value: 3577.522 mgc: 3.04807e-07 ustep: 1 
iter: 3  mgc: 7.704948e-13 
iter: 1  mgc: 7.704948e-13 
outer mgc:  0.008303761 
iter: 1  value: 3573.331 mgc: 2.504246 ustep: 1 
iter: 2  value: 3573.331 mgc: 3.911753e-07 ustep: 1 
iter: 3  mgc: 1.551592e-12 
iter: 1  mgc: 1.551592e-12 
outer mgc:  0.005872195 
iter: 1  value: 3569.867 mgc: 2.521876 ustep: 1 
iter: 2  value: 3569.867 mgc: 1.018035e-07 ustep: 1 
iter: 3  mgc: 1.739275e-12 
iter: 1  mgc: 1.739275e-12 
outer mgc:  0.005308568 
iter: 1  value: 3565.672 mgc: 3.010763 ustep: 1 
iter: 2  value: 3565.672 mgc: 1.108433e-07 ustep: 1 
iter: 3  mgc: 3.451461e-12 
iter: 1  mgc: 3.451461e-12 
outer mgc:  0.004613263 
iter: 1  value: 3562.204 mgc: 3.283169 ustep: 1 
iter: 2  value: 3562.204 mgc: 5.287992e-08 ustep: 1 
iter: 3  mgc: 2.356337e-12 
iter: 1  mgc: 2.356337e-12 
outer mgc:  0.003551319 
iter: 1  value: 3558.006 mgc: 3.920566 ustep: 1 
iter: 2  value: 3558.006 mgc: 5.002965e-08 ustep: 1 
iter: 3  mgc: 7.050915e-12 
iter: 1  mgc: 7.050915e-12 
outer mgc:  0.003322575 
iter: 1  value: 3554.537 mgc: 4.208069 ustep: 1 
iter: 2  value: 3554.537 mgc: 2.729336e-08 ustep: 1 
mgc: 6.471712e-12 
iter: 1  mgc: 6.471712e-12 
outer mgc:  0.002309573 
iter: 1  value: 3550.338 mgc: 5.581123 ustep: 1 
iter: 2  value: 3550.338 mgc: 2.173596e-08 ustep: 1 
mgc: 2.098477e-11 
iter: 1  mgc: 2.098477e-11 
outer mgc:  0.00230858 
iter: 1  value: 3546.869 mgc: 5.727757 ustep: 1 
iter: 2  value: 3546.869 mgc: 1.201618e-08 ustep: 1 
mgc: 2.673972e-11 
iter: 1  mgc: 2.673972e-11 
outer mgc:  0.001407196 
iter: 1  value: 3542.671 mgc: 7.335148 ustep: 1 
iter: 2  mgc: 8.049834e-09 
iter: 1  mgc: 8.049834e-09 
outer mgc:  0.001461972 
iter: 1  value: 3539.202 mgc: 7.588362 ustep: 1 
iter: 2  mgc: 4.526201e-09 
iter: 1  mgc: 4.526201e-09 
outer mgc:  0.0008102707 
iter: 1  value: 3535.004 mgc: 9.084956 ustep: 1 
iter: 2  mgc: 2.709119e-09 
iter: 1  mgc: 2.709119e-09 
outer mgc:  0.0008575777 
iter: 1  value: 3531.536 mgc: 9.414217 ustep: 1 
iter: 2  mgc: 1.54479e-09 
iter: 1  mgc: 1.54479e-09 
outer mgc:  0.0004444786 
iter: 1  value: 3527.339 mgc: 10.74416 ustep: 1 
iter: 2  mgc: 7.957386e-10 
iter: 1  mgc: 7.957386e-10 
outer mgc:  0.0004765758 
iter: 1  value: 3523.872 mgc: 11.11956 ustep: 1 
iter: 2  mgc: 6.983993e-10 
iter: 1  mgc: 6.983993e-10 
outer mgc:  0.000235345 
iter: 1  mgc: 6.983993e-10 
iter: 1  mgc: 6.983993e-10 
outer mgc:  0.000235345 
iter: 1  value: 3523.872 mgc: 0.006445771 ustep: 1 
iter: 2  value: 3523.872 mgc: 5.079029e-07 ustep: 1 
iter: 3  mgc: 3.884911e-10 
outer mgc:  0.06871972 
iter: 1  value: 3523.873 mgc: 0.006446414 ustep: 1 
iter: 2  value: 3523.873 mgc: 5.061623e-07 ustep: 1 
iter: 3  mgc: 1.849119e-10 
outer mgc:  0.06859451 
iter: 1  value: 3523.872 mgc: 0.003541926 ustep: 1 
iter: 2  value: 3523.872 mgc: 1.219331e-07 ustep: 1 
iter: 3  mgc: 2.177875e-10 
outer mgc:  0.04820368 
iter: 1  value: 3523.873 mgc: 0.003542076 ustep: 1 
iter: 2  value: 3523.873 mgc: 1.217599e-07 ustep: 1 
iter: 3  mgc: 2.586278e-10 
outer mgc:  0.04811945 
iter: 1  value: 3523.874 mgc: 0.005704864 ustep: 1 
iter: 2  value: 3523.874 mgc: 1.198447e-07 ustep: 1 
iter: 3  mgc: 1.458775e-10 
outer mgc:  0.0818054 
iter: 1  value: 3523.87 mgc: 0.005701893 ustep: 1 
iter: 2  value: 3523.87 mgc: 1.192571e-07 ustep: 1 
iter: 3  mgc: 2.22004e-10 
outer mgc:  0.08188463 
iter: 1  value: 3523.874 mgc: 0.003660221 ustep: 1 
iter: 2  value: 3523.874 mgc: 3.099533e-08 ustep: 1 
iter: 3  mgc: 1.017306e-10 
outer mgc:  0.04802074 
iter: 1  value: 3523.871 mgc: 0.003659476 ustep: 1 
iter: 2  value: 3523.871 mgc: 3.080937e-08 ustep: 1 
iter: 3  mgc: 1.72387e-10 
outer mgc:  0.04804391 
iter: 1  value: 3523.88 mgc: 844.7155 ustep: 1 
iter: 2  value: 3523.88 mgc: 2.361059e-06 ustep: 1 
iter: 3  mgc: 1.526785e-10 
outer mgc:  0.05978346 
iter: 1  value: 3523.865 mgc: 845.5607 ustep: 1 
iter: 2  value: 3523.865 mgc: 2.357908e-06 ustep: 1 
iter: 3  mgc: 2.013847e-10 
outer mgc:  0.05931986 
iter: 1  value: 3523.89 mgc: 843.8715 ustep: 1 
iter: 2  value: 3523.89 mgc: 2.63803e-06 ustep: 1 
iter: 3  mgc: 2.754905e-10 
outer mgc:  0.04335323 
iter: 1  value: 3523.855 mgc: 846.4069 ustep: 1 
iter: 2  value: 3523.855 mgc: 2.633689e-06 ustep: 1 
iter: 3  mgc: 1.626014e-10 
outer mgc:  0.04357129 
iter: 1  value: 3523.872 mgc: 1.085083e-05 ustep: 1 
mgc: 2.771933e-10 
outer mgc:  0.0002353456 
iter: 1  value: 3523.872 mgc: 1.085109e-05 ustep: 1 
mgc: 1.992382e-10 
outer mgc:  0.0002353454 
iter: 1  value: 3523.867 mgc: 0.003722338 ustep: 1 
iter: 2  value: 3523.867 mgc: 1.763895e-07 ustep: 1 
iter: 3  mgc: 3.078899e-10 
outer mgc:  0.02580425 
iter: 1  value: 3523.877 mgc: 0.003720076 ustep: 1 
iter: 2  value: 3523.877 mgc: 1.763609e-07 ustep: 1 
iter: 3  mgc: 1.569924e-10 
outer mgc:  0.02580158 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:49:39 2021]
Finished job 0.
1 of 1 steps (100%) done

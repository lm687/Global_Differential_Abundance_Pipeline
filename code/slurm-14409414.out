Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:44:28 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.02_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.02, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.02_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.02_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22159.009862 
iter  10 value 18568.041410
iter  10 value 18568.041409
final  value 18568.041409 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 17495.44 mgc: 6.899804 ustep: 0.6827823 
iter: 2  value: 17444.55 mgc: 4.731509 ustep: 0.8263238 
iter: 3  value: 17420.37 mgc: 4.279272 ustep: 0.2486515 
iter: 4  value: 17418.47 mgc: 1.761578 ustep: 0.4986998 
iter: 5  value: 17418.3 mgc: 0.3953774 ustep: 0.7062162 
iter: 6  value: 17418.28 mgc: 0.07056039 ustep: 0.8403827 
iter: 7  value: 17418.28 mgc: 0.01044825 ustep: 0.9167322 
iter: 8  value: 17418.28 mgc: 0.001074199 ustep: 0.9574656 
iter: 9  value: 17418.28 mgc: 5.438548e-05 ustep: 0.9785039 
iter: 10  value: 17418.28 mgc: 1.467207e-06 ustep: 0.9891946 
iter: 11  value: 17418.28 mgc: 1.978914e-08 ustep: 0.9945832 
iter: 12  mgc: 1.336883e-10 
iter: 1  mgc: 1.336883e-10 
Matching hessian patterns... Done
outer mgc:  114.9262 
iter: 1  value: 17255.28 mgc: 2.332575 ustep: 1 
iter: 2  value: 17240.02 mgc: 1.526269 ustep: 1 
iter: 3  value: 17239.92 mgc: 0.1377 ustep: 1 
iter: 4  value: 17239.92 mgc: 0.002316358 ustep: 1 
iter: 5  value: 17239.92 mgc: 9.672535e-07 ustep: 1 
iter: 6  mgc: 2.063905e-13 
iter: 1  value: 17322.06 mgc: 11.61674 ustep: 0.4665496 
iter: 2  value: 17274.17 mgc: 10.24717 ustep: 0.683076 
iter: 3  value: 17270.82 mgc: 3.972933 ustep: 0.8265015 
iter: 4  value: 17270.73 mgc: 0.4756432 ustep: 0.9091304 
iter: 5  value: 17270.73 mgc: 0.05360938 ustep: 0.9534879 
iter: 6  value: 17270.73 mgc: 0.001973425 ustep: 0.9764694 
iter: 7  value: 17270.73 mgc: 2.866712e-05 ustep: 0.9881659 
iter: 8  value: 17270.73 mgc: 2.198539e-07 ustep: 0.9940659 
iter: 9  mgc: 8.596247e-10 
iter: 1  mgc: 2.063905e-13 
outer mgc:  76.01657 
iter: 1  value: 17074.09 mgc: 2.427683 ustep: 1 
iter: 2  value: 17070.62 mgc: 1.722408 ustep: 1 
iter: 3  value: 17070.6 mgc: 0.2429951 ustep: 1 
iter: 4  value: 17070.6 mgc: 0.009209722 ustep: 1 
iter: 5  value: 17070.6 mgc: 1.505275e-05 ustep: 1 
iter: 6  mgc: 4.041395e-11 
iter: 1  value: 17171.93 mgc: 30.35966 ustep: 1 
iter: 2  value: 17164.13 mgc: 7.664493 ustep: 1 
iter: 3  value: 17164.08 mgc: 1.042705 ustep: 1 
iter: 4  value: 17164.08 mgc: 0.02308476 ustep: 1 
iter: 5  value: 17164.08 mgc: 2.268114e-05 ustep: 1 
iter: 6  mgc: 2.077272e-11 
iter: 1  mgc: 4.041395e-11 
outer mgc:  65.98656 
iter: 1  value: 16938.43 mgc: 3.17086 ustep: 1 
iter: 2  value: 16937.86 mgc: 0.6580672 ustep: 1 
iter: 3  value: 16937.86 mgc: 0.0221192 ustep: 1 
iter: 4  value: 16937.86 mgc: 2.934411e-05 ustep: 1 
iter: 5  mgc: 5.098261e-11 
iter: 1  value: 16854.16 mgc: 14.95769 ustep: 1 
iter: 2  value: 16854.02 mgc: 0.9205969 ustep: 1 
iter: 3  value: 16854.02 mgc: 0.003140011 ustep: 1 
iter: 4  value: 16854.02 mgc: 3.151997e-08 ustep: 1 
mgc: 9.381385e-15 
iter: 1  mgc: 9.381385e-15 
outer mgc:  101.9342 
iter: 1  value: 17496.09 mgc: 48.98365 ustep: 1 
iter: 2  value: 17495.71 mgc: 1.499684 ustep: 1 
iter: 3  value: 17495.71 mgc: 0.001341398 ustep: 1 
iter: 4  mgc: 1.889829e-09 
iter: 1  value: 16830.73 mgc: 2.149506 ustep: 1 
iter: 2  value: 16830.72 mgc: 0.0274748 ustep: 1 
iter: 3  value: 16830.72 mgc: 2.815664e-05 ustep: 1 
iter: 4  mgc: 3.656164e-11 
iter: 1  mgc: 3.656164e-11 
outer mgc:  44.70574 
iter: 1  value: 16827.72 mgc: 1.51019 ustep: 1 
iter: 2  value: 16827.72 mgc: 0.007268364 ustep: 1 
iter: 3  value: 16827.72 mgc: 2.818468e-06 ustep: 1 
iter: 4  mgc: 9.85878e-14 
iter: 1  mgc: 9.85878e-14 
outer mgc:  23.12283 
iter: 1  value: 16813.62 mgc: 4.476351 ustep: 1 
iter: 2  value: 16813.62 mgc: 0.02714741 ustep: 1 
iter: 3  value: 16813.62 mgc: 2.970862e-05 ustep: 1 
iter: 4  mgc: 1.302158e-11 
iter: 1  mgc: 1.302158e-11 
outer mgc:  25.473 
iter: 1  value: 16812.17 mgc: 1.681175 ustep: 1 
iter: 2  value: 16812.17 mgc: 0.03118533 ustep: 1 
iter: 3  value: 16812.17 mgc: 1.72265e-05 ustep: 1 
iter: 4  mgc: 7.470025e-12 
iter: 1  mgc: 7.470025e-12 
outer mgc:  18.30774 
iter: 1  value: 16808.78 mgc: 0.8558298 ustep: 1 
iter: 2  value: 16808.78 mgc: 0.002953496 ustep: 1 
iter: 3  value: 16808.78 mgc: 3.607736e-07 ustep: 1 
iter: 4  mgc: 8.576473e-15 
iter: 1  mgc: 8.576473e-15 
outer mgc:  9.700367 
iter: 1  value: 16810.65 mgc: 0.7072815 ustep: 1 
iter: 2  value: 16810.65 mgc: 0.001395624 ustep: 1 
iter: 3  mgc: 7.340584e-09 
iter: 1  value: 16808.97 mgc: 0.2097689 ustep: 1 
iter: 2  value: 16808.97 mgc: 0.0001120466 ustep: 1 
iter: 3  mgc: 8.1541e-11 
iter: 1  mgc: 8.1541e-11 
outer mgc:  9.101672 
iter: 1  value: 16808.18 mgc: 0.2356055 ustep: 1 
iter: 2  value: 16808.18 mgc: 0.0003229806 ustep: 1 
iter: 3  mgc: 4.135499e-09 
iter: 1  mgc: 4.135499e-09 
outer mgc:  5.324485 
iter: 1  value: 16807.64 mgc: 0.2020185 ustep: 1 
iter: 2  value: 16807.64 mgc: 8.953536e-05 ustep: 1 
iter: 3  mgc: 6.648548e-11 
iter: 1  mgc: 6.648548e-11 
outer mgc:  2.771343 
iter: 1  value: 16806.71 mgc: 0.2260209 ustep: 1 
iter: 2  value: 16806.71 mgc: 0.0001119232 ustep: 1 
iter: 3  mgc: 3.97133e-10 
iter: 1  mgc: 3.97133e-10 
outer mgc:  0.8057991 
iter: 1  value: 16806.22 mgc: 0.1149695 ustep: 1 
iter: 2  value: 16806.22 mgc: 0.0001091508 ustep: 1 
iter: 3  mgc: 1.168802e-10 
iter: 1  mgc: 1.168802e-10 
outer mgc:  0.4975115 
iter: 1  value: 16805.22 mgc: 0.3746507 ustep: 1 
iter: 2  value: 16805.22 mgc: 0.0003113834 ustep: 1 
iter: 3  mgc: 5.64931e-10 
iter: 1  mgc: 5.64931e-10 
outer mgc:  1.187736 
iter: 1  value: 16803.92 mgc: 0.2596691 ustep: 1 
iter: 2  value: 16803.92 mgc: 7.414339e-05 ustep: 1 
iter: 3  mgc: 3.399414e-11 
iter: 1  mgc: 3.399414e-11 
outer mgc:  3.055643 
iter: 1  value: 16802 mgc: 0.236227 ustep: 1 
iter: 2  value: 16802 mgc: 8.020287e-05 ustep: 1 
iter: 3  mgc: 2.188916e-11 
iter: 1  mgc: 2.188916e-11 
outer mgc:  0.5571857 
iter: 1  value: 16800.96 mgc: 0.1380744 ustep: 1 
iter: 2  value: 16800.96 mgc: 6.246909e-05 ustep: 1 
iter: 3  mgc: 2.371792e-11 
iter: 1  mgc: 2.371792e-11 
outer mgc:  0.8819661 
iter: 1  value: 16799.61 mgc: 0.1567839 ustep: 1 
iter: 2  value: 16799.61 mgc: 6.671847e-05 ustep: 1 
iter: 3  mgc: 2.559464e-11 
iter: 1  value: 16795.73 mgc: 0.4899032 ustep: 1 
iter: 2  value: 16795.73 mgc: 0.0004798903 ustep: 1 
iter: 3  mgc: 1.158419e-09 
iter: 1  mgc: 1.158419e-09 
outer mgc:  1.868582 
iter: 1  value: 16786.17 mgc: 0.9825463 ustep: 1 
iter: 2  value: 16786.17 mgc: 0.001917062 ustep: 1 
iter: 3  value: 16786.17 mgc: 1.547437e-08 ustep: 1 
mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  1.261464 
iter: 1  value: 16782.92 mgc: 0.5465486 ustep: 1 
iter: 2  value: 16782.92 mgc: 0.0002955565 ustep: 1 
iter: 3  mgc: 9.781411e-10 
iter: 1  mgc: 9.781411e-10 
outer mgc:  0.5624718 
iter: 1  value: 16779.63 mgc: 0.5779748 ustep: 1 
iter: 2  value: 16779.63 mgc: 0.0004062988 ustep: 1 
iter: 3  mgc: 3.791975e-09 
iter: 1  mgc: 3.791975e-09 
outer mgc:  0.610138 
iter: 1  value: 16774.96 mgc: 0.5801111 ustep: 1 
iter: 2  value: 16774.96 mgc: 0.0003158723 ustep: 1 
iter: 3  mgc: 3.692326e-10 
iter: 1  mgc: 3.692326e-10 
outer mgc:  0.5828313 
iter: 1  value: 16770.55 mgc: 0.4860841 ustep: 1 
iter: 2  value: 16770.55 mgc: 0.0002156097 ustep: 1 
iter: 3  mgc: 1.745564e-10 
iter: 1  mgc: 1.745564e-10 
outer mgc:  0.5187 
iter: 1  value: 16768.75 mgc: 0.2408628 ustep: 1 
iter: 2  value: 16768.75 mgc: 2.571895e-05 ustep: 1 
iter: 3  mgc: 2.182521e-11 
iter: 1  mgc: 2.182521e-11 
outer mgc:  0.2019079 
iter: 1  value: 16766.93 mgc: 0.3775851 ustep: 1 
iter: 2  value: 16766.93 mgc: 8.188642e-05 ustep: 1 
iter: 3  mgc: 7.990053e-12 
iter: 1  mgc: 7.990053e-12 
outer mgc:  0.09526749 
iter: 1  value: 16765.64 mgc: 0.1384853 ustep: 1 
iter: 2  value: 16765.64 mgc: 1.232886e-05 ustep: 1 
iter: 3  mgc: 5.080381e-13 
iter: 1  mgc: 5.080381e-13 
outer mgc:  0.02666408 
iter: 1  value: 16764.3 mgc: 0.1407331 ustep: 1 
iter: 2  value: 16764.3 mgc: 1.293732e-05 ustep: 1 
iter: 3  mgc: 5.915268e-13 
iter: 1  mgc: 5.915268e-13 
outer mgc:  0.002618168 
iter: 1  value: 16763.88 mgc: 0.04436784 ustep: 1 
iter: 2  value: 16763.88 mgc: 1.315445e-06 ustep: 1 
iter: 3  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  0.0006973614 
iter: 1  value: 16763.83 mgc: 0.004620283 ustep: 1 
iter: 2  value: 16763.83 mgc: 1.468052e-08 ustep: 1 
mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  5.465498e-05 
iter: 1  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  5.465498e-05 
iter: 1  value: 16763.83 mgc: 0.004876325 ustep: 1 
iter: 2  value: 16763.83 mgc: 6.858762e-08 ustep: 1 
iter: 3  mgc: 8.770762e-15 
outer mgc:  0.2771761 
iter: 1  value: 16763.83 mgc: 0.004874388 ustep: 1 
iter: 2  value: 16763.83 mgc: 6.849116e-08 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.2769029 
iter: 1  value: 16763.83 mgc: 0.001791383 ustep: 1 
iter: 2  mgc: 5.950541e-09 
outer mgc:  0.09899903 
iter: 1  value: 16763.83 mgc: 0.001790069 ustep: 1 
iter: 2  mgc: 5.939974e-09 
outer mgc:  0.09899963 
iter: 1  value: 16763.84 mgc: 0.006251761 ustep: 1 
iter: 2  value: 16763.84 mgc: 2.75283e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.3580888 
iter: 1  value: 16763.82 mgc: 0.00625145 ustep: 1 
iter: 2  value: 16763.82 mgc: 2.746292e-07 ustep: 1 
iter: 3  mgc: 7.71605e-15 
outer mgc:  0.35818 
iter: 1  value: 16763.84 mgc: 0.003251269 ustep: 1 
iter: 2  value: 16763.84 mgc: 1.091576e-07 ustep: 1 
iter: 3  mgc: 1.065814e-14 
outer mgc:  0.1989375 
iter: 1  value: 16763.83 mgc: 0.003252256 ustep: 1 
iter: 2  value: 16763.83 mgc: 1.090957e-07 ustep: 1 
iter: 3  mgc: 1.421085e-14 
outer mgc:  0.1990559 
iter: 1  value: 16763.92 mgc: 0.03661633 ustep: 1 
iter: 2  value: 16763.92 mgc: 7.979196e-07 ustep: 1 
iter: 3  mgc: 1.154632e-14 
outer mgc:  0.03011938 
iter: 1  value: 16763.75 mgc: 0.03671741 ustep: 1 
iter: 2  value: 16763.75 mgc: 7.975213e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.02999261 
iter: 1  value: 16763.89 mgc: 0.03692419 ustep: 1 
iter: 2  value: 16763.89 mgc: 6.719882e-07 ustep: 1 
iter: 3  mgc: 9.769963e-15 
outer mgc:  0.05393705 
iter: 1  value: 16763.77 mgc: 0.03702907 ustep: 1 
iter: 2  value: 16763.77 mgc: 6.714569e-07 ustep: 1 
iter: 3  mgc: 9.325873e-15 
outer mgc:  0.05389758 
iter: 1  value: 16763.8 mgc: 0.003041078 ustep: 1 
iter: 2  mgc: 5.728736e-09 
outer mgc:  0.00149743 
iter: 1  value: 16763.86 mgc: 0.003040048 ustep: 1 
iter: 2  mgc: 5.738962e-09 
outer mgc:  0.001389199 
iter: 1  value: 16763.81 mgc: 0.005501191 ustep: 1 
iter: 2  value: 16763.81 mgc: 1.245284e-07 ustep: 1 
iter: 3  mgc: 1.110223e-14 
outer mgc:  0.1382236 
iter: 1  value: 16763.85 mgc: 0.005497475 ustep: 1 
iter: 2  value: 16763.85 mgc: 1.244014e-07 ustep: 1 
iter: 3  mgc: 7.876187e-15 
outer mgc:  0.1380955 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:44:31 2021]
Finished job 0.
1 of 1 steps (100%) done

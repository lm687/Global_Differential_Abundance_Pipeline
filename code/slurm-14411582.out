Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:49:24 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_0.1_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=0.1, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_0.1_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_0.1_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4394.449155 
final  value 4167.471734 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 4164.837 mgc: 2.483543 ustep: 0.6827823 
iter: 2  value: 4157.541 mgc: 2.052924 ustep: 0.8263238 
iter: 3  value: 4155.86 mgc: 1.951102 ustep: 0.9090326 
iter: 4  value: 4155.78 mgc: 0.4144429 ustep: 0.9534367 
iter: 5  value: 4155.78 mgc: 0.02091086 ustep: 0.9764432 
iter: 6  value: 4155.78 mgc: 0.0001646439 ustep: 0.9881526 
iter: 7  value: 4155.78 mgc: 1.048823e-06 ustep: 0.9940592 
iter: 8  mgc: 3.888375e-09 
iter: 1  mgc: 3.888375e-09 
Matching hessian patterns... Done
outer mgc:  29.50878 
iter: 1  value: 4110.872 mgc: 0.5816236 ustep: 1 
iter: 2  value: 4110.871 mgc: 0.02258528 ustep: 1 
iter: 3  value: 4110.871 mgc: 2.790027e-05 ustep: 1 
iter: 4  mgc: 6.856155e-11 
iter: 1  value: 4047.946 mgc: 8.156041 ustep: 1 
iter: 2  value: 4047.918 mgc: 0.7590821 ustep: 1 
iter: 3  value: 4047.918 mgc: 0.005095449 ustep: 1 
iter: 4  value: 4047.918 mgc: 2.2655e-07 ustep: 1 
iter: 5  mgc: 2.4869e-14 
iter: 1  mgc: 2.4869e-14 
outer mgc:  82.60809 
iter: 1  value: 4862.925 mgc: 871.3566 ustep: 0.0692153 
iter: 2  value: 4727.632 mgc: 129.2128 ustep: 0.07349008 
iter: 3  value: 4581.058 mgc: 70.03482 ustep: 0.07601519 
iter: 4  value: 4564.891 mgc: 63.9598 ustep: 0.2757809 
iter: 5  value: 4564.81 mgc: 2.992186 ustep: 0.525196 
iter: 6  value: 4564.81 mgc: 0.07628693 ustep: 0.7247316 
iter: 7  value: 4564.81 mgc: 0.003463667 ustep: 0.8513266 
iter: 8  value: 4564.81 mgc: 7.01801e-05 ustep: 0.9226813 
iter: 9  value: 4564.81 mgc: 7.736231e-07 ustep: 0.960567 
iter: 10  mgc: 4.456421e-09 
iter: 1  value: 4033.674 mgc: 10.95933 ustep: 1 
iter: 2  value: 4033.282 mgc: 1.52468 ustep: 1 
iter: 3  value: 4033.282 mgc: 0.01024564 ustep: 1 
iter: 4  value: 4033.282 mgc: 1.231735e-06 ustep: 1 
iter: 5  mgc: 2.153833e-14 
iter: 1  mgc: 2.153833e-14 
outer mgc:  66.56648 
iter: 1  value: 4013.831 mgc: 7.270375 ustep: 1 
iter: 2  value: 4013.738 mgc: 0.8214372 ustep: 1 
iter: 3  value: 4013.738 mgc: 0.005858052 ustep: 1 
iter: 4  value: 4013.738 mgc: 3.19073e-07 ustep: 1 
iter: 5  mgc: 1.831868e-14 
iter: 1  mgc: 1.831868e-14 
outer mgc:  22.78855 
iter: 1  value: 4003.885 mgc: 10.14172 ustep: 1 
iter: 2  value: 4003.675 mgc: 1.083273 ustep: 1 
iter: 3  value: 4003.675 mgc: 0.01521919 ustep: 1 
iter: 4  value: 4003.675 mgc: 3.396603e-06 ustep: 1 
iter: 5  mgc: 1.751203e-13 
iter: 1  mgc: 1.751203e-13 
outer mgc:  29.28319 
iter: 1  value: 3998.458 mgc: 8.402144 ustep: 1 
iter: 2  value: 3998.452 mgc: 0.2467002 ustep: 1 
iter: 3  value: 3998.452 mgc: 0.0003155039 ustep: 1 
iter: 4  mgc: 7.999992e-10 
iter: 1  value: 3999.62 mgc: 5.592695 ustep: 1 
iter: 2  value: 3999.616 mgc: 0.08436539 ustep: 1 
iter: 3  value: 3999.616 mgc: 9.436942e-05 ustep: 1 
iter: 4  mgc: 5.758216e-11 
iter: 1  mgc: 5.758216e-11 
outer mgc:  18.00106 
iter: 1  value: 3999.476 mgc: 4.143182 ustep: 1 
iter: 2  value: 3999.475 mgc: 0.0726649 ustep: 1 
iter: 3  value: 3999.475 mgc: 0.0001577561 ustep: 1 
iter: 4  mgc: 6.405716e-10 
iter: 1  mgc: 6.405716e-10 
outer mgc:  4.893501 
iter: 1  value: 3998.026 mgc: 4.003774 ustep: 1 
iter: 2  value: 3998.026 mgc: 0.07234249 ustep: 1 
iter: 3  value: 3998.026 mgc: 6.836961e-05 ustep: 1 
iter: 4  mgc: 6.344347e-11 
iter: 1  mgc: 6.344347e-11 
outer mgc:  7.891659 
iter: 1  value: 3997.294 mgc: 2.660683 ustep: 1 
iter: 2  value: 3997.294 mgc: 0.01926735 ustep: 1 
iter: 3  value: 3997.294 mgc: 4.815989e-06 ustep: 1 
iter: 4  mgc: 8.171241e-14 
iter: 1  mgc: 8.171241e-14 
outer mgc:  9.098743 
iter: 1  value: 3995.794 mgc: 2.424921 ustep: 1 
iter: 2  value: 3995.794 mgc: 0.02387178 ustep: 1 
iter: 3  value: 3995.794 mgc: 4.684343e-06 ustep: 1 
iter: 4  mgc: 2.762235e-13 
iter: 1  mgc: 2.762235e-13 
outer mgc:  11.01066 
iter: 1  value: 3995.094 mgc: 1.748012 ustep: 1 
iter: 2  value: 3995.094 mgc: 0.006912754 ustep: 1 
iter: 3  value: 3995.094 mgc: 2.452712e-07 ustep: 1 
iter: 4  mgc: 5.084821e-14 
iter: 1  mgc: 5.084821e-14 
outer mgc:  1.296522 
iter: 1  value: 3994.922 mgc: 0.6874496 ustep: 1 
iter: 2  value: 3994.922 mgc: 0.003236128 ustep: 1 
iter: 3  value: 3994.922 mgc: 1.170983e-07 ustep: 1 
mgc: 5.662137e-14 
iter: 1  mgc: 5.662137e-14 
outer mgc:  0.9950947 
iter: 1  value: 3994.425 mgc: 0.5199425 ustep: 1 
iter: 2  value: 3994.425 mgc: 0.002306138 ustep: 1 
iter: 3  value: 3994.425 mgc: 6.154764e-08 ustep: 1 
mgc: 6.37268e-14 
iter: 1  mgc: 6.37268e-14 
outer mgc:  1.036311 
iter: 1  value: 3993.745 mgc: 0.7586283 ustep: 1 
iter: 2  value: 3993.745 mgc: 0.004283418 ustep: 1 
iter: 3  value: 3993.745 mgc: 1.941591e-07 ustep: 1 
iter: 4  mgc: 5.351275e-14 
iter: 1  mgc: 5.351275e-14 
outer mgc:  0.7539108 
iter: 1  value: 3993.858 mgc: 0.421508 ustep: 1 
iter: 2  value: 3993.858 mgc: 0.001533248 ustep: 1 
iter: 3  value: 3993.858 mgc: 3.441354e-08 ustep: 1 
mgc: 5.506706e-14 
iter: 1  mgc: 5.506706e-14 
outer mgc:  0.7052561 
iter: 1  value: 3993.887 mgc: 0.6834232 ustep: 1 
iter: 2  value: 3993.887 mgc: 0.00150862 ustep: 1 
iter: 3  value: 3993.887 mgc: 2.249444e-08 ustep: 1 
mgc: 3.597123e-14 
iter: 1  value: 3993.926 mgc: 0.4990653 ustep: 1 
iter: 2  value: 3993.926 mgc: 0.0005036325 ustep: 1 
iter: 3  mgc: 2.912565e-09 
iter: 1  value: 3993.861 mgc: 0.09405298 ustep: 1 
iter: 2  value: 3993.861 mgc: 1.812602e-05 ustep: 1 
iter: 3  mgc: 3.557599e-12 
iter: 1  mgc: 3.557599e-12 
outer mgc:  0.4086239 
iter: 1  value: 3993.858 mgc: 0.04643272 ustep: 1 
iter: 2  value: 3993.858 mgc: 6.882438e-06 ustep: 1 
iter: 3  mgc: 8.686385e-13 
iter: 1  mgc: 8.686385e-13 
outer mgc:  0.4083282 
iter: 1  value: 3993.855 mgc: 0.08343862 ustep: 1 
iter: 2  value: 3993.855 mgc: 2.18578e-05 ustep: 1 
iter: 3  mgc: 4.962253e-12 
iter: 1  mgc: 4.962253e-12 
outer mgc:  0.4168771 
iter: 1  value: 3993.818 mgc: 0.122733 ustep: 1 
iter: 2  value: 3993.818 mgc: 4.767162e-05 ustep: 1 
iter: 3  mgc: 8.42082e-12 
iter: 1  value: 3993.751 mgc: 0.1384297 ustep: 1 
iter: 2  value: 3993.751 mgc: 7.922464e-05 ustep: 1 
iter: 3  mgc: 2.726974e-11 
iter: 1  value: 3993.52 mgc: 0.5043947 ustep: 1 
iter: 2  value: 3993.52 mgc: 0.0009635285 ustep: 1 
iter: 3  mgc: 3.72374e-09 
iter: 1  mgc: 3.72374e-09 
outer mgc:  0.8020679 
iter: 1  value: 3992.724 mgc: 1.342418 ustep: 1 
iter: 2  value: 3992.724 mgc: 0.003024643 ustep: 1 
iter: 3  value: 3992.724 mgc: 6.01458e-08 ustep: 1 
mgc: 5.973e-14 
iter: 1  mgc: 5.973e-14 
outer mgc:  0.6734046 
iter: 1  value: 3992.261 mgc: 2.158837 ustep: 1 
iter: 2  value: 3992.261 mgc: 0.009609754 ustep: 1 
iter: 3  value: 3992.261 mgc: 1.46464e-06 ustep: 1 
iter: 4  mgc: 6.394885e-14 
iter: 1  value: 3992.642 mgc: 0.8084312 ustep: 1 
iter: 2  value: 3992.642 mgc: 0.001291627 ustep: 1 
iter: 3  value: 3992.642 mgc: 3.178466e-08 ustep: 1 
mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  0.7686618 
iter: 1  value: 3992.572 mgc: 0.1748903 ustep: 1 
iter: 2  value: 3992.572 mgc: 0.00022663 ustep: 1 
iter: 3  mgc: 3.0865e-10 
iter: 1  mgc: 3.0865e-10 
outer mgc:  0.6573423 
iter: 1  value: 3992.483 mgc: 0.2483357 ustep: 1 
iter: 2  value: 3992.483 mgc: 0.0001816793 ustep: 1 
iter: 3  mgc: 1.819069e-10 
iter: 1  mgc: 1.819069e-10 
outer mgc:  0.3911695 
iter: 1  value: 3992.298 mgc: 0.2579346 ustep: 1 
iter: 2  value: 3992.298 mgc: 0.0001070125 ustep: 1 
iter: 3  mgc: 8.202505e-11 
iter: 1  value: 3992.049 mgc: 0.3719429 ustep: 1 
iter: 2  value: 3992.049 mgc: 0.0001879823 ustep: 1 
iter: 3  mgc: 2.450138e-10 
iter: 1  mgc: 2.450138e-10 
outer mgc:  0.574411 
iter: 1  value: 3991.86 mgc: 0.3747902 ustep: 1 
iter: 2  value: 3991.86 mgc: 0.0002766108 ustep: 1 
iter: 3  mgc: 2.635971e-10 
iter: 1  mgc: 2.635971e-10 
outer mgc:  0.1024988 
iter: 1  value: 3991.81 mgc: 0.1426831 ustep: 1 
iter: 2  value: 3991.81 mgc: 0.0001060476 ustep: 1 
iter: 3  mgc: 4.226486e-11 
iter: 1  value: 3991.846 mgc: 0.04831612 ustep: 1 
iter: 2  value: 3991.846 mgc: 8.791436e-06 ustep: 1 
iter: 3  mgc: 7.571721e-13 
iter: 1  mgc: 7.571721e-13 
outer mgc:  0.07275323 
iter: 1  value: 3991.817 mgc: 0.03406152 ustep: 1 
iter: 2  value: 3991.817 mgc: 3.423427e-06 ustep: 1 
iter: 3  mgc: 1.327827e-13 
iter: 1  mgc: 1.327827e-13 
outer mgc:  0.03598745 
iter: 1  value: 3991.823 mgc: 0.008042866 ustep: 1 
iter: 2  value: 3991.823 mgc: 2.24202e-07 ustep: 1 
iter: 3  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  0.01522537 
iter: 1  value: 3991.825 mgc: 0.006537516 ustep: 1 
iter: 2  value: 3991.825 mgc: 1.67685e-07 ustep: 1 
iter: 3  mgc: 4.607426e-14 
iter: 1  mgc: 4.607426e-14 
outer mgc:  0.004016164 
iter: 1  value: 3991.823 mgc: 0.002050399 ustep: 1 
iter: 2  value: 3991.823 mgc: 2.218894e-08 ustep: 1 
mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.0002978267 
iter: 1  mgc: 5.595524e-14 
iter: 1  mgc: 5.595524e-14 
outer mgc:  0.0002978267 
iter: 1  value: 3991.823 mgc: 0.0192016 ustep: 1 
iter: 2  value: 3991.823 mgc: 1.699043e-06 ustep: 1 
iter: 3  mgc: 4.22995e-14 
outer mgc:  0.1641119 
iter: 1  value: 3991.824 mgc: 0.01918855 ustep: 1 
iter: 2  value: 3991.824 mgc: 1.700478e-06 ustep: 1 
iter: 3  mgc: 3.419487e-14 
outer mgc:  0.164687 
iter: 1  value: 3991.823 mgc: 0.007980964 ustep: 1 
iter: 2  value: 3991.823 mgc: 3.070558e-07 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.1027005 
iter: 1  value: 3991.824 mgc: 0.007974399 ustep: 1 
iter: 2  value: 3991.824 mgc: 3.066759e-07 ustep: 1 
iter: 3  mgc: 5.151435e-14 
outer mgc:  0.1029323 
iter: 1  value: 3991.824 mgc: 0.02224726 ustep: 1 
iter: 2  value: 3991.824 mgc: 1.655747e-06 ustep: 1 
iter: 3  mgc: 4.618528e-14 
outer mgc:  0.1950959 
iter: 1  value: 3991.823 mgc: 0.02223804 ustep: 1 
iter: 2  value: 3991.823 mgc: 1.655404e-06 ustep: 1 
iter: 3  mgc: 5.839773e-14 
outer mgc:  0.1953284 
iter: 1  value: 3991.824 mgc: 0.01258031 ustep: 1 
iter: 2  value: 3991.824 mgc: 5.524373e-07 ustep: 1 
iter: 3  mgc: 6.838974e-14 
outer mgc:  0.150322 
iter: 1  value: 3991.823 mgc: 0.01257828 ustep: 1 
iter: 2  value: 3991.823 mgc: 5.5202e-07 ustep: 1 
iter: 3  mgc: 5.995204e-14 
outer mgc:  0.1500443 
iter: 1  value: 3991.832 mgc: 0.037672 ustep: 1 
iter: 2  value: 3991.832 mgc: 4.047362e-06 ustep: 1 
iter: 3  mgc: 1.878497e-13 
outer mgc:  0.04684273 
iter: 1  value: 3991.815 mgc: 0.03777887 ustep: 1 
iter: 2  value: 3991.815 mgc: 4.053796e-06 ustep: 1 
iter: 3  mgc: 2.069456e-13 
outer mgc:  0.04721748 
iter: 1  value: 3991.831 mgc: 0.03804126 ustep: 1 
iter: 2  value: 3991.831 mgc: 2.813239e-06 ustep: 1 
iter: 3  mgc: 1.112443e-13 
outer mgc:  0.04905152 
iter: 1  value: 3991.815 mgc: 0.03814934 ustep: 1 
iter: 2  value: 3991.815 mgc: 2.818841e-06 ustep: 1 
iter: 3  mgc: 1.34226e-13 
outer mgc:  0.04935576 
iter: 1  value: 3991.819 mgc: 0.004656333 ustep: 1 
iter: 2  value: 3991.819 mgc: 3.227598e-08 ustep: 1 
mgc: 4.013456e-14 
outer mgc:  0.000839404 
iter: 1  value: 3991.828 mgc: 0.004654649 ustep: 1 
iter: 2  value: 3991.828 mgc: 3.230855e-08 ustep: 1 
mgc: 3.907985e-14 
outer mgc:  0.0006746995 
iter: 1  value: 3991.818 mgc: 0.004302015 ustep: 1 
iter: 2  value: 3991.818 mgc: 5.729538e-08 ustep: 1 
mgc: 4.32987e-14 
outer mgc:  0.006554599 
iter: 1  value: 3991.829 mgc: 0.004301923 ustep: 1 
iter: 2  value: 3991.829 mgc: 5.733792e-08 ustep: 1 
mgc: 5.018208e-14 
outer mgc:  0.006571362 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:49:26 2021]
Finished job 0.
1 of 1 steps (100%) done

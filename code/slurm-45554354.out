Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sat Aug 14 12:17:38 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_100_100_10_3_0_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_100_100_10_3_0_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_100_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22126.051494 
iter  10 value 20000.854206
iter  10 value 20000.854205
final  value 20000.854205 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 18589.19 mgc: 7.542443 ustep: 0.5579279 
iter: 2  value: 18542.12 mgc: 4.983589 ustep: 0.746971 
iter: 3  value: 18528.04 mgc: 6.448732 ustep: 0.4495365 
iter: 4  value: 18524.12 mgc: 3.728633 ustep: 0.6705078 
iter: 5  value: 18523.4 mgc: 1.742065 ustep: 0.8188635 
iter: 6  value: 18523.38 mgc: 0.144919 ustep: 0.9049203 
iter: 7  value: 18523.38 mgc: 0.008223362 ustep: 0.9512779 
iter: 8  value: 18523.38 mgc: 0.0004122631 ustep: 0.9753372 
iter: 9  value: 18523.38 mgc: 9.852784e-06 ustep: 0.9875929 
iter: 10  value: 18523.38 mgc: 1.183184e-07 ustep: 0.9937777 
iter: 11  mgc: 7.138843e-10 
iter: 1  mgc: 7.138843e-10 
Matching hessian patterns... Done
outer mgc:  119.1209 
iter: 1  value: 18346.94 mgc: 2.033918 ustep: 1 
iter: 2  value: 18346.68 mgc: 0.2630532 ustep: 1 
iter: 3  value: 18346.68 mgc: 0.008933436 ustep: 1 
iter: 4  value: 18346.68 mgc: 1.198932e-05 ustep: 1 
iter: 5  mgc: 2.154038e-11 
iter: 1  value: 18226.37 mgc: 10.22996 ustep: 1 
iter: 2  value: 18217.72 mgc: 3.11077 ustep: 1 
iter: 3  value: 18217.71 mgc: 0.1928125 ustep: 1 
iter: 4  value: 18217.71 mgc: 0.0008644056 ustep: 1 
iter: 5  value: 18217.71 mgc: 5.539181e-08 ustep: 1 
iter: 6  mgc: 1.765255e-14 
iter: 1  mgc: 1.765255e-14 
outer mgc:  144.9209 
iter: 1  value: 18173.62 mgc: 38.16408 ustep: 1 
iter: 2  value: 18172.67 mgc: 2.103708 ustep: 1 
iter: 3  value: 18172.67 mgc: 0.00964146 ustep: 1 
iter: 4  value: 18172.67 mgc: 8.04333e-07 ustep: 1 
iter: 5  mgc: 7.993606e-15 
iter: 1  mgc: 7.993606e-15 
outer mgc:  180.765 
iter: 1  value: 18164.36 mgc: 4.092398 ustep: 1 
iter: 2  value: 18164.35 mgc: 0.1406283 ustep: 1 
iter: 3  value: 18164.35 mgc: 7.859941e-05 ustep: 1 
iter: 4  mgc: 4.549e-11 
iter: 1  mgc: 4.549e-11 
outer mgc:  196.3164 
iter: 1  value: 18199.79 mgc: 6.217389 ustep: 1 
iter: 2  value: 18199.71 mgc: 0.2739148 ustep: 1 
iter: 3  value: 18199.71 mgc: 0.0005282697 ustep: 1 
iter: 4  mgc: 1.645307e-09 
iter: 1  value: 18072.8 mgc: 3.324413 ustep: 1 
iter: 2  value: 18072.8 mgc: 0.02797032 ustep: 1 
iter: 3  value: 18072.8 mgc: 1.277954e-05 ustep: 1 
iter: 4  mgc: 7.125411e-13 
iter: 1  mgc: 7.125411e-13 
outer mgc:  45.30183 
iter: 1  value: 18058.88 mgc: 3.157903 ustep: 1 
iter: 2  value: 18058.88 mgc: 0.05713628 ustep: 1 
iter: 3  value: 18058.88 mgc: 5.617889e-05 ustep: 1 
iter: 4  mgc: 2.348699e-11 
iter: 1  mgc: 2.348699e-11 
outer mgc:  81.74369 
iter: 1  value: 18077.42 mgc: 4.084839 ustep: 1 
iter: 2  value: 18077.42 mgc: 0.07821197 ustep: 1 
iter: 3  value: 18077.42 mgc: 1.967834e-05 ustep: 1 
iter: 4  mgc: 3.957723e-12 
iter: 1  value: 18045.19 mgc: 1.713872 ustep: 1 
iter: 2  value: 18045.19 mgc: 0.00462505 ustep: 1 
iter: 3  value: 18045.19 mgc: 4.913079e-07 ustep: 1 
iter: 4  mgc: 7.105427e-15 
iter: 1  mgc: 7.105427e-15 
outer mgc:  26.38045 
iter: 1  value: 18048.21 mgc: 3.181369 ustep: 1 
iter: 2  value: 18048.21 mgc: 0.02205314 ustep: 1 
iter: 3  value: 18048.21 mgc: 1.005535e-05 ustep: 1 
iter: 4  mgc: 6.163958e-13 
iter: 1  mgc: 6.163958e-13 
outer mgc:  3.542511 
iter: 1  value: 18044.05 mgc: 0.8293113 ustep: 1 
iter: 2  value: 18044.05 mgc: 0.008756449 ustep: 1 
iter: 3  value: 18044.05 mgc: 3.628268e-07 ustep: 1 
iter: 4  mgc: 8.104628e-15 
iter: 1  value: 18046.61 mgc: 0.1713186 ustep: 1 
iter: 2  value: 18046.61 mgc: 0.0003678018 ustep: 1 
iter: 3  mgc: 4.467915e-10 
iter: 1  mgc: 4.467915e-10 
outer mgc:  2.686479 
iter: 1  value: 18045.64 mgc: 0.4052107 ustep: 1 
iter: 2  value: 18045.64 mgc: 0.001083903 ustep: 1 
iter: 3  mgc: 9.247946e-09 
iter: 1  value: 18046.3 mgc: 0.1730651 ustep: 1 
iter: 2  value: 18046.3 mgc: 9.106944e-05 ustep: 1 
iter: 3  mgc: 8.083401e-11 
iter: 1  value: 18046.45 mgc: 0.07473973 ustep: 1 
iter: 2  value: 18046.45 mgc: 1.696478e-05 ustep: 1 
iter: 3  mgc: 2.767564e-12 
iter: 1  mgc: 2.767564e-12 
outer mgc:  1.254096 
iter: 1  value: 18046.42 mgc: 0.06422205 ustep: 1 
iter: 2  value: 18046.42 mgc: 1.675527e-05 ustep: 1 
iter: 3  mgc: 2.860379e-12 
iter: 1  mgc: 2.860379e-12 
outer mgc:  1.222213 
iter: 1  value: 18046.22 mgc: 0.1148248 ustep: 1 
iter: 2  value: 18046.22 mgc: 8.602922e-05 ustep: 1 
iter: 3  mgc: 5.751777e-11 
iter: 1  mgc: 5.751777e-11 
outer mgc:  1.621059 
iter: 1  value: 18046.14 mgc: 0.1334547 ustep: 1 
iter: 2  value: 18046.14 mgc: 9.28101e-05 ustep: 1 
iter: 3  mgc: 6.453071e-11 
iter: 1  mgc: 6.453071e-11 
outer mgc:  1.046712 
iter: 1  value: 18045.6 mgc: 0.15573 ustep: 1 
iter: 2  value: 18045.6 mgc: 0.0001868939 ustep: 1 
iter: 3  mgc: 1.928075e-10 
iter: 1  mgc: 1.928075e-10 
outer mgc:  1.455365 
iter: 1  value: 18044.25 mgc: 0.2024903 ustep: 1 
iter: 2  value: 18044.25 mgc: 0.0001163983 ustep: 1 
iter: 3  mgc: 1.45711e-10 
iter: 1  mgc: 1.45711e-10 
outer mgc:  1.304504 
iter: 1  value: 18043.94 mgc: 0.1872852 ustep: 1 
iter: 2  value: 18043.94 mgc: 7.746798e-05 ustep: 1 
iter: 3  mgc: 6.53575e-11 
iter: 1  value: 18044.2 mgc: 0.1041545 ustep: 1 
iter: 2  value: 18044.2 mgc: 1.409086e-05 ustep: 1 
iter: 3  mgc: 7.564505e-12 
iter: 1  value: 18044.23 mgc: 0.03448995 ustep: 1 
iter: 2  value: 18044.23 mgc: 1.528856e-06 ustep: 1 
iter: 3  mgc: 9.414691e-14 
iter: 1  mgc: 9.414691e-14 
outer mgc:  0.7946083 
iter: 1  value: 18044.28 mgc: 0.03167585 ustep: 1 
iter: 2  value: 18044.28 mgc: 1.5572e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  0.8275056 
iter: 1  value: 18044.14 mgc: 0.05192194 ustep: 1 
iter: 2  value: 18044.14 mgc: 6.924578e-06 ustep: 1 
iter: 3  mgc: 5.346834e-13 
iter: 1  mgc: 5.346834e-13 
outer mgc:  0.7915664 
iter: 1  value: 18043.46 mgc: 0.089045 ustep: 1 
iter: 2  value: 18043.46 mgc: 3.629558e-05 ustep: 1 
iter: 3  mgc: 1.137712e-11 
iter: 1  value: 18042.5 mgc: 0.09326306 ustep: 1 
iter: 2  value: 18042.5 mgc: 6.482049e-05 ustep: 1 
iter: 3  mgc: 3.812017e-11 
iter: 1  mgc: 3.812017e-11 
outer mgc:  0.9491378 
iter: 1  value: 18042.67 mgc: 0.2067092 ustep: 1 
iter: 2  value: 18042.67 mgc: 8.752571e-05 ustep: 1 
iter: 3  mgc: 8.717116e-11 
iter: 1  value: 18042.96 mgc: 0.08355982 ustep: 1 
iter: 2  value: 18042.96 mgc: 1.17188e-05 ustep: 1 
iter: 3  mgc: 1.81366e-12 
iter: 1  mgc: 1.81366e-12 
outer mgc:  1.27058 
iter: 1  value: 18042.2 mgc: 0.09048599 ustep: 1 
iter: 2  value: 18042.2 mgc: 3.271755e-05 ustep: 1 
iter: 3  mgc: 1.087397e-11 
iter: 1  mgc: 1.087397e-11 
outer mgc:  0.7037787 
iter: 1  value: 18041.54 mgc: 0.0957803 ustep: 1 
iter: 2  value: 18041.54 mgc: 3.381519e-05 ustep: 1 
iter: 3  mgc: 1.229683e-11 
iter: 1  mgc: 1.229683e-11 
outer mgc:  0.7934709 
iter: 1  value: 18040.71 mgc: 0.08238829 ustep: 1 
iter: 2  value: 18040.71 mgc: 4.080612e-05 ustep: 1 
iter: 3  mgc: 1.502931e-11 
iter: 1  mgc: 1.502931e-11 
outer mgc:  0.7200708 
iter: 1  value: 18040.03 mgc: 0.1356243 ustep: 1 
iter: 2  value: 18040.03 mgc: 6.439584e-05 ustep: 1 
iter: 3  mgc: 4.048051e-11 
iter: 1  mgc: 4.048051e-11 
outer mgc:  0.4331062 
iter: 1  value: 18039.72 mgc: 0.06094113 ustep: 1 
iter: 2  value: 18039.72 mgc: 1.74965e-05 ustep: 1 
iter: 3  mgc: 4.822143e-12 
iter: 1  value: 18039.12 mgc: 0.1476241 ustep: 1 
iter: 2  value: 18039.12 mgc: 6.785665e-05 ustep: 1 
iter: 3  mgc: 3.044054e-11 
iter: 1  mgc: 3.044054e-11 
outer mgc:  1.400661 
iter: 1  value: 18037.53 mgc: 0.2441252 ustep: 1 
iter: 2  value: 18037.53 mgc: 0.0001821864 ustep: 1 
iter: 3  mgc: 3.088436e-10 
iter: 1  mgc: 3.088436e-10 
outer mgc:  0.8840255 
iter: 1  value: 18033.33 mgc: 0.3992588 ustep: 1 
iter: 2  value: 18033.33 mgc: 0.0007748771 ustep: 1 
iter: 3  mgc: 4.024607e-09 
iter: 1  mgc: 4.024607e-09 
outer mgc:  1.07309 
iter: 1  value: 18033.21 mgc: 0.1723567 ustep: 1 
iter: 2  value: 18033.21 mgc: 0.0002913949 ustep: 1 
iter: 3  mgc: 9.818113e-11 
iter: 1  mgc: 9.818113e-11 
outer mgc:  0.5845869 
iter: 1  value: 18030.55 mgc: 0.3873332 ustep: 1 
iter: 2  value: 18030.55 mgc: 0.0001541746 ustep: 1 
iter: 3  mgc: 1.48269e-10 
iter: 1  mgc: 1.48269e-10 
outer mgc:  0.8720643 
iter: 1  value: 18030.88 mgc: 0.071958 ustep: 1 
iter: 2  value: 18030.88 mgc: 7.98679e-05 ustep: 1 
iter: 3  mgc: 2.160139e-11 
iter: 1  mgc: 2.160139e-11 
outer mgc:  0.2127666 
iter: 1  value: 18030.11 mgc: 0.1734034 ustep: 1 
iter: 2  value: 18030.11 mgc: 8.010712e-05 ustep: 1 
iter: 3  mgc: 4.015899e-11 
iter: 1  value: 18030.57 mgc: 0.07108479 ustep: 1 
iter: 2  value: 18030.57 mgc: 1.341538e-05 ustep: 1 
iter: 3  mgc: 1.161404e-12 
iter: 1  mgc: 1.161404e-12 
outer mgc:  0.02761421 
iter: 1  value: 18030.1 mgc: 0.04413394 ustep: 1 
iter: 2  value: 18030.1 mgc: 5.475945e-06 ustep: 1 
iter: 3  mgc: 1.811884e-13 
iter: 1  mgc: 1.811884e-13 
outer mgc:  0.009408375 
iter: 1  value: 18029.98 mgc: 0.01297329 ustep: 1 
iter: 2  value: 18029.98 mgc: 3.92115e-07 ustep: 1 
iter: 3  mgc: 5.77316e-15 
iter: 1  mgc: 5.77316e-15 
outer mgc:  0.001641858 
iter: 1  value: 18029.97 mgc: 0.001415234 ustep: 1 
iter: 2  mgc: 5.879625e-09 
iter: 1  mgc: 5.879625e-09 
outer mgc:  0.0003561932 
iter: 1  mgc: 5.879625e-09 
iter: 1  mgc: 5.879625e-09 
outer mgc:  0.0003561932 
iter: 1  value: 18029.98 mgc: 0.00554045 ustep: 1 
iter: 2  value: 18029.98 mgc: 1.366332e-07 ustep: 1 
iter: 3  mgc: 8.881784e-15 
outer mgc:  0.3571002 
iter: 1  value: 18029.96 mgc: 0.005539999 ustep: 1 
iter: 2  value: 18029.96 mgc: 1.357899e-07 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.3563934 
iter: 1  value: 18029.98 mgc: 0.003082199 ustep: 1 
iter: 2  value: 18029.98 mgc: 5.781584e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.2098914 
iter: 1  value: 18029.97 mgc: 0.00308257 ustep: 1 
iter: 2  value: 18029.97 mgc: 5.769211e-08 ustep: 1 
iter: 3  mgc: 8.21565e-15 
outer mgc:  0.209923 
iter: 1  value: 18029.97 mgc: 0.004312981 ustep: 1 
iter: 2  value: 18029.97 mgc: 9.553927e-08 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.2283856 
iter: 1  value: 18029.98 mgc: 0.004309976 ustep: 1 
iter: 2  value: 18029.98 mgc: 9.541133e-08 ustep: 1 
iter: 3  mgc: 6.883383e-15 
outer mgc:  0.2282095 
iter: 1  value: 18029.97 mgc: 0.00230292 ustep: 1 
iter: 2  value: 18029.97 mgc: 3.278026e-08 ustep: 1 
mgc: 7.327472e-15 
outer mgc:  0.1246138 
iter: 1  value: 18029.97 mgc: 0.002301582 ustep: 1 
iter: 2  value: 18029.97 mgc: 3.273611e-08 ustep: 1 
mgc: 6.550316e-15 
outer mgc:  0.124127 
iter: 1  value: 18030.04 mgc: 0.02000242 ustep: 1 
iter: 2  value: 18030.04 mgc: 2.77936e-07 ustep: 1 
iter: 3  mgc: 6.744605e-15 
outer mgc:  0.03825767 
iter: 1  value: 18029.91 mgc: 0.02005418 ustep: 1 
iter: 2  value: 18029.91 mgc: 2.782158e-07 ustep: 1 
iter: 3  mgc: 5.551115e-15 
outer mgc:  0.03795397 
iter: 1  value: 18030.05 mgc: 0.01589557 ustep: 1 
iter: 2  value: 18030.05 mgc: 9.548565e-07 ustep: 1 
iter: 3  mgc: 7.105427e-15 
outer mgc:  0.02411629 
iter: 1  value: 18029.89 mgc: 0.01593508 ustep: 1 
iter: 2  value: 18029.89 mgc: 9.529918e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.02408038 
iter: 1  value: 18029.93 mgc: 0.00461045 ustep: 1 
iter: 2  value: 18029.93 mgc: 5.520475e-08 ustep: 1 
iter: 3  mgc: 6.217249e-15 
outer mgc:  0.003907068 
iter: 1  value: 18030.01 mgc: 0.004607564 ustep: 1 
iter: 2  value: 18030.01 mgc: 5.534248e-08 ustep: 1 
iter: 3  mgc: 7.993606e-15 
outer mgc:  0.004441252 
iter: 1  value: 18029.95 mgc: 0.004141796 ustep: 1 
iter: 2  value: 18029.95 mgc: 1.307298e-07 ustep: 1 
iter: 3  mgc: 7.327472e-15 
outer mgc:  0.1421398 
iter: 1  value: 18029.99 mgc: 0.004138559 ustep: 1 
iter: 2  value: 18029.99 mgc: 1.306457e-07 ustep: 1 
iter: 3  mgc: 5.329071e-15 
outer mgc:  0.1426521 
[Sat Aug 14 12:17:42 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 21:10:16 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_20_100_10_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=20, nlambda=100, lmbda=10, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_20_100_10_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_20_100_10_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4349.406051 
final  value 4091.600088 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1047.909 mgc: 125.1838 ustep: 1 
iter: 2  value: 742.2324 mgc: 55.85606 ustep: 0.2494656 
iter: 3  value: 525.9181 mgc: 74.06606 ustep: 0.4995153 
iter: 4  value: 521.7353 mgc: 9.394179 ustep: 0.7067933 
iter: 5  value: 521.7012 mgc: 0.9644923 ustep: 0.8407259 
iter: 6  value: 521.7012 mgc: 0.02007007 ustep: 0.9169194 
iter: 7  value: 521.7012 mgc: 8.27286e-05 ustep: 0.9575633 
iter: 8  value: 521.7012 mgc: 1.590339e-07 ustep: 0.9785538 
iter: 9  mgc: 1.582308e-10 
iter: 1  mgc: 1.582308e-10 
Matching hessian patterns... Done
outer mgc:  135.3292 
iter: 1  value: 489.6774 mgc: 25.01128 ustep: 1 
iter: 2  value: 488.4645 mgc: 3.111115 ustep: 1 
iter: 3  value: 488.4642 mgc: 0.06229406 ustep: 1 
iter: 4  value: 488.4642 mgc: 6.930378e-05 ustep: 1 
iter: 5  mgc: 8.613568e-11 
iter: 1  mgc: 8.613568e-11 
outer mgc:  66.28469 
iter: 1  value: 505.939 mgc: 40.78242 ustep: 1 
iter: 2  value: 471.8917 mgc: 17.47448 ustep: 1 
iter: 3  value: 471.5479 mgc: 1.671917 ustep: 1 
iter: 4  value: 471.5479 mgc: 0.02864962 ustep: 1 
iter: 5  value: 471.5479 mgc: 1.25761e-05 ustep: 1 
iter: 6  mgc: 2.426059e-12 
iter: 1  mgc: 2.426059e-12 
outer mgc:  49.90177 
iter: 1  value: 452.1636 mgc: 25.49372 ustep: 1 
iter: 2  value: 451.8258 mgc: 1.55601 ustep: 1 
iter: 3  value: 451.8258 mgc: 0.01503088 ustep: 1 
iter: 4  value: 451.8258 mgc: 2.616232e-06 ustep: 1 
iter: 5  mgc: 7.860379e-14 
iter: 1  mgc: 7.860379e-14 
outer mgc:  21.90196 
iter: 1  value: 444.0375 mgc: 22.64534 ustep: 1 
iter: 2  value: 441.2324 mgc: 4.101293 ustep: 1 
iter: 3  value: 441.2288 mgc: 0.2117212 ustep: 1 
iter: 4  value: 441.2288 mgc: 0.0006533382 ustep: 1 
iter: 5  mgc: 6.279794e-09 
iter: 1  mgc: 6.279794e-09 
outer mgc:  17.95502 
iter: 1  value: 464.0283 mgc: 36.78314 ustep: 1 
iter: 2  value: 455.6323 mgc: 7.561608 ustep: 1 
iter: 3  value: 455.6133 mgc: 0.3165171 ustep: 1 
iter: 4  value: 455.6133 mgc: 0.001151288 ustep: 1 
iter: 5  value: 455.6133 mgc: 1.734159e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  value: 439.4051 mgc: 5.867679 ustep: 1 
iter: 2  value: 439.4048 mgc: 0.05734571 ustep: 1 
iter: 3  value: 439.4048 mgc: 2.165469e-05 ustep: 1 
iter: 4  mgc: 2.139267e-11 
iter: 1  mgc: 2.139267e-11 
outer mgc:  11.58883 
iter: 1  value: 441.5486 mgc: 15.02995 ustep: 1 
iter: 2  value: 441.4958 mgc: 0.6075612 ustep: 1 
iter: 3  value: 441.4958 mgc: 0.002329503 ustep: 1 
iter: 4  value: 441.4958 mgc: 3.744744e-08 ustep: 1 
mgc: 2.065015e-14 
iter: 1  value: 438.7511 mgc: 5.308567 ustep: 1 
iter: 2  value: 438.7505 mgc: 0.06616589 ustep: 1 
iter: 3  value: 438.7505 mgc: 2.742402e-05 ustep: 1 
iter: 4  mgc: 4.916068e-12 
iter: 1  mgc: 4.916068e-12 
outer mgc:  6.814621 
iter: 1  value: 438.5032 mgc: 3.516088 ustep: 1 
iter: 2  value: 438.5029 mgc: 0.04259376 ustep: 1 
iter: 3  value: 438.5029 mgc: 1.72545e-05 ustep: 1 
iter: 4  mgc: 3.405993e-12 
iter: 1  mgc: 3.405993e-12 
outer mgc:  8.238209 
iter: 1  value: 437.9898 mgc: 3.587505 ustep: 1 
iter: 2  value: 437.9895 mgc: 0.03863542 ustep: 1 
iter: 3  value: 437.9895 mgc: 1.319186e-05 ustep: 1 
iter: 4  mgc: 1.879719e-12 
iter: 1  mgc: 1.879719e-12 
outer mgc:  3.664851 
iter: 1  value: 437.6936 mgc: 4.071405 ustep: 1 
iter: 2  value: 437.693 mgc: 0.05053743 ustep: 1 
iter: 3  value: 437.693 mgc: 2.874744e-05 ustep: 1 
iter: 4  mgc: 1.044098e-11 
iter: 1  mgc: 1.044098e-11 
outer mgc:  3.841662 
iter: 1  value: 437.5395 mgc: 7.20966 ustep: 1 
iter: 2  value: 437.535 mgc: 0.1876736 ustep: 1 
iter: 3  value: 437.535 mgc: 0.0003162478 ustep: 1 
iter: 4  mgc: 1.030589e-09 
iter: 1  mgc: 1.030589e-09 
outer mgc:  4.764922 
iter: 1  value: 437.3279 mgc: 4.810534 ustep: 1 
iter: 2  value: 437.3267 mgc: 0.08225708 ustep: 1 
iter: 3  value: 437.3267 mgc: 5.241516e-05 ustep: 1 
iter: 4  mgc: 3.374101e-11 
iter: 1  mgc: 3.374101e-11 
outer mgc:  2.792267 
iter: 1  value: 437.5738 mgc: 3.129046 ustep: 1 
iter: 2  value: 437.5737 mgc: 0.02858274 ustep: 1 
iter: 3  value: 437.5737 mgc: 6.207491e-06 ustep: 1 
iter: 4  mgc: 4.224399e-13 
iter: 1  value: 437.3359 mgc: 1.367006 ustep: 1 
iter: 2  value: 437.3359 mgc: 0.005282883 ustep: 1 
iter: 3  value: 437.3359 mgc: 2.143183e-07 ustep: 1 
iter: 4  mgc: 1.421085e-14 
iter: 1  mgc: 1.421085e-14 
outer mgc:  3.160199 
iter: 1  value: 437.3102 mgc: 0.5820264 ustep: 1 
iter: 2  value: 437.3102 mgc: 0.001335944 ustep: 1 
iter: 3  value: 437.3102 mgc: 1.375919e-08 ustep: 1 
mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  0.2871723 
iter: 1  value: 437.3637 mgc: 0.8082841 ustep: 1 
iter: 2  value: 437.3637 mgc: 0.001750318 ustep: 1 
iter: 3  value: 437.3637 mgc: 3.681296e-08 ustep: 1 
mgc: 2.14273e-14 
iter: 1  mgc: 2.14273e-14 
outer mgc:  0.4358631 
iter: 1  value: 437.3422 mgc: 1.110983 ustep: 1 
iter: 2  value: 437.3422 mgc: 0.003794757 ustep: 1 
iter: 3  value: 437.3422 mgc: 1.906662e-07 ustep: 1 
iter: 4  mgc: 1.876277e-14 
iter: 1  mgc: 1.876277e-14 
outer mgc:  0.3307018 
iter: 1  value: 437.3377 mgc: 0.4887303 ustep: 1 
iter: 2  value: 437.3377 mgc: 0.0007815491 ustep: 1 
iter: 3  mgc: 5.678613e-09 
iter: 1  value: 437.3388 mgc: 0.245525 ustep: 1 
iter: 2  value: 437.3388 mgc: 0.0001854399 ustep: 1 
iter: 3  mgc: 3.932641e-10 
iter: 1  mgc: 3.932641e-10 
outer mgc:  0.1517748 
iter: 1  value: 437.3363 mgc: 0.1700944 ustep: 1 
iter: 2  value: 437.3363 mgc: 7.640895e-05 ustep: 1 
iter: 3  mgc: 5.988354e-11 
iter: 1  mgc: 5.988354e-11 
outer mgc:  0.2751138 
iter: 1  value: 437.3354 mgc: 0.1874259 ustep: 1 
iter: 2  value: 437.3354 mgc: 0.0001081985 ustep: 1 
iter: 3  mgc: 1.490457e-10 
iter: 1  mgc: 1.490457e-10 
outer mgc:  0.1417441 
iter: 1  value: 437.3354 mgc: 0.1609945 ustep: 1 
iter: 2  value: 437.3354 mgc: 0.0001111015 ustep: 1 
iter: 3  mgc: 1.329304e-10 
iter: 1  mgc: 1.329304e-10 
outer mgc:  0.1140872 
iter: 1  value: 437.3363 mgc: 0.1236779 ustep: 1 
iter: 2  value: 437.3363 mgc: 5.385107e-05 ustep: 1 
iter: 3  mgc: 2.801448e-11 
iter: 1  mgc: 2.801448e-11 
outer mgc:  0.06359703 
iter: 1  value: 437.3313 mgc: 0.06586776 ustep: 1 
iter: 2  value: 437.3313 mgc: 1.208931e-05 ustep: 1 
iter: 3  mgc: 3.845813e-13 
iter: 1  mgc: 3.845813e-13 
outer mgc:  0.05748067 
iter: 1  value: 437.3308 mgc: 0.05614868 ustep: 1 
iter: 2  value: 437.3308 mgc: 7.59204e-06 ustep: 1 
iter: 3  mgc: 2.908784e-13 
iter: 1  mgc: 2.908784e-13 
outer mgc:  0.04986371 
iter: 1  value: 437.3315 mgc: 0.0229859 ustep: 1 
iter: 2  value: 437.3315 mgc: 1.595904e-06 ustep: 1 
iter: 3  mgc: 3.863576e-14 
iter: 1  mgc: 3.863576e-14 
outer mgc:  0.01449527 
iter: 1  value: 437.333 mgc: 0.01691896 ustep: 1 
iter: 2  value: 437.333 mgc: 1.351391e-06 ustep: 1 
iter: 3  mgc: 2.131628e-14 
iter: 1  value: 437.3318 mgc: 0.009296307 ustep: 1 
iter: 2  value: 437.3318 mgc: 2.050368e-07 ustep: 1 
iter: 3  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  0.003636609 
iter: 1  value: 437.3321 mgc: 0.00124589 ustep: 1 
iter: 2  value: 437.3321 mgc: 1.213412e-08 ustep: 1 
mgc: 2.076117e-14 
iter: 1  mgc: 2.076117e-14 
outer mgc:  0.002361911 
iter: 1  value: 437.3323 mgc: 0.0006971097 ustep: 1 
iter: 2  mgc: 4.29768e-09 
iter: 1  mgc: 4.29768e-09 
outer mgc:  0.00439551 
iter: 1  value: 437.3323 mgc: 0.001098084 ustep: 1 
iter: 2  mgc: 3.790544e-09 
iter: 1  mgc: 3.790544e-09 
outer mgc:  0.0002840096 
iter: 1  value: 437.3322 mgc: 0.0002134839 ustep: 1 
iter: 2  mgc: 3.746168e-10 
iter: 1  mgc: 3.746168e-10 
outer mgc:  0.000251501 
iter: 1  mgc: 3.746168e-10 
iter: 1  mgc: 3.746168e-10 
outer mgc:  0.000251501 
iter: 1  value: 437.3325 mgc: 0.05156552 ustep: 1 
iter: 2  value: 437.3325 mgc: 8.809932e-06 ustep: 1 
iter: 3  mgc: 5.191403e-13 
outer mgc:  0.06950294 
iter: 1  value: 437.3321 mgc: 0.0515708 ustep: 1 
iter: 2  value: 437.3321 mgc: 8.817586e-06 ustep: 1 
iter: 3  mgc: 5.293543e-13 
outer mgc:  0.06947363 
iter: 1  value: 437.3322 mgc: 0.02623849 ustep: 1 
iter: 2  value: 437.3322 mgc: 1.961407e-06 ustep: 1 
iter: 3  mgc: 2.553513e-14 
outer mgc:  0.2114078 
iter: 1  value: 437.3325 mgc: 0.02623903 ustep: 1 
iter: 2  value: 437.3325 mgc: 1.961037e-06 ustep: 1 
iter: 3  mgc: 2.831069e-14 
outer mgc:  0.2116661 
iter: 1  value: 437.332 mgc: 0.0537778 ustep: 1 
iter: 2  value: 437.332 mgc: 8.445542e-06 ustep: 1 
iter: 3  mgc: 6.71796e-13 
outer mgc:  0.04641024 
iter: 1  value: 437.3325 mgc: 0.0537655 ustep: 1 
iter: 2  value: 437.3325 mgc: 8.45331e-06 ustep: 1 
iter: 3  mgc: 6.72018e-13 
outer mgc:  0.04651817 
iter: 1  value: 437.3324 mgc: 0.02619884 ustep: 1 
iter: 2  value: 437.3324 mgc: 3.034642e-06 ustep: 1 
iter: 3  mgc: 7.827072e-14 
outer mgc:  0.1551914 
iter: 1  value: 437.3322 mgc: 0.02619507 ustep: 1 
iter: 2  value: 437.3322 mgc: 3.035701e-06 ustep: 1 
iter: 3  mgc: 7.771561e-14 
outer mgc:  0.154941 
iter: 1  value: 437.3308 mgc: 0.00407814 ustep: 1 
iter: 2  value: 437.3308 mgc: 1.072926e-07 ustep: 1 
mgc: 1.24345e-14 
outer mgc:  0.01010123 
iter: 1  value: 437.3337 mgc: 0.004075038 ustep: 1 
iter: 2  value: 437.3337 mgc: 1.071749e-07 ustep: 1 
mgc: 1.321165e-14 
outer mgc:  0.009977705 
iter: 1  value: 437.3342 mgc: 0.007848556 ustep: 1 
iter: 2  value: 437.3342 mgc: 6.113069e-07 ustep: 1 
iter: 3  mgc: 1.953993e-14 
outer mgc:  0.05766868 
iter: 1  value: 437.3304 mgc: 0.007865964 ustep: 1 
iter: 2  value: 437.3304 mgc: 6.13422e-07 ustep: 1 
iter: 3  mgc: 1.421085e-14 
outer mgc:  0.05826823 
iter: 1  value: 437.3342 mgc: 0.01003215 ustep: 1 
iter: 2  value: 437.3342 mgc: 6.227063e-07 ustep: 1 
iter: 3  mgc: 1.998401e-14 
outer mgc:  0.05945225 
iter: 1  value: 437.3303 mgc: 0.01005684 ustep: 1 
iter: 2  value: 437.3303 mgc: 6.251585e-07 ustep: 1 
iter: 3  mgc: 1.287859e-14 
outer mgc:  0.05988798 
[Sun Aug 15 21:10:17 2021]
Finished job 0.
1 of 1 steps (100%) done

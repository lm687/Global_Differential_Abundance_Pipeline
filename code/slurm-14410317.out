Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:11:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_80_3_0.4_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=80, d=3, beta_intensity=0.4, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_80_3_0.4_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_80_3_0.4_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 21862.384544 
final  value 19369.638793 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2963.572 mgc: 117.7244 ustep: 1 
iter: 2  value: 2161.62 mgc: 59.44067 ustep: 1 
iter: 3  value: 2156.162 mgc: 117.2917 ustep: 0.2494656 
iter: 4  value: 1855.565 mgc: 67.52939 ustep: 0.08285847 
iter: 5  value: 1838.132 mgc: 33.69234 ustep: 0.2879227 
iter: 6  value: 1836.017 mgc: 11.99765 ustep: 0.5366306 
iter: 7  value: 1835.991 mgc: 1.24561 ustep: 0.7325775 
iter: 8  value: 1835.991 mgc: 0.02977904 ustep: 0.8559218 
iter: 9  value: 1835.991 mgc: 0.0001846676 ustep: 0.9251679 
iter: 10  value: 1835.991 mgc: 9.80207e-07 ustep: 0.9618603 
iter: 11  value: 1835.991 mgc: 1.089485e-08 ustep: 0.9807467 
mgc: 6.027573e-11 
iter: 1  mgc: 6.027573e-11 
Matching hessian patterns... Done
outer mgc:  806.0463 
iter: 1  value: 1736.02 mgc: 33.23673 ustep: 1 
iter: 2  value: 1714.895 mgc: 7.055963 ustep: 1 
iter: 3  value: 1714.879 mgc: 0.2268278 ustep: 1 
iter: 4  value: 1714.879 mgc: 0.0004236599 ustep: 1 
iter: 5  mgc: 1.49368e-09 
iter: 1  mgc: 1.49368e-09 
outer mgc:  569.6633 
iter: 1  value: 1499.903 mgc: 11.86968 ustep: 1 
iter: 2  value: 1499.636 mgc: 0.6947335 ustep: 1 
iter: 3  value: 1499.636 mgc: 0.0040394 ustep: 1 
iter: 4  value: 1499.636 mgc: 1.888216e-07 ustep: 1 
iter: 5  mgc: 5.051515e-14 
iter: 1  mgc: 5.051515e-14 
outer mgc:  202.1522 
iter: 1  value: 1709.313 mgc: 41.00443 ustep: 1 
iter: 2  value: 1366.147 mgc: 22.07889 ustep: 1 
iter: 3  value: 1363.294 mgc: 2.167612 ustep: 1 
iter: 4  value: 1363.293 mgc: 0.03610997 ustep: 1 
iter: 5  value: 1363.293 mgc: 1.606825e-05 ustep: 1 
iter: 6  mgc: 3.421485e-12 
iter: 1  value: 5187.845 mgc: 68.62898 ustep: 1 
iter: 2  value: 2101.564 mgc: 83.2594 ustep: 1 
iter: 3  value: 2051.558 mgc: 9.245418 ustep: 1 
iter: 4  value: 2051.421 mgc: 0.5586909 ustep: 1 
iter: 5  value: 2051.421 mgc: 0.00311768 ustep: 1 
iter: 6  value: 2051.421 mgc: 1.302064e-07 ustep: 1 
iter: 7  mgc: 3.907985e-14 
iter: 1  mgc: 3.421485e-12 
outer mgc:  80.19055 
iter: 1  value: 1282.927 mgc: 19.97429 ustep: 1 
iter: 2  value: 1279.904 mgc: 2.410008 ustep: 1 
iter: 3  value: 1279.904 mgc: 0.03581977 ustep: 1 
iter: 4  value: 1279.904 mgc: 1.390378e-05 ustep: 1 
iter: 5  mgc: 2.278178e-12 
iter: 1  mgc: 2.278178e-12 
outer mgc:  185.3039 
iter: 1  value: 1478.921 mgc: 19.75912 ustep: 1 
iter: 2  value: 1478.241 mgc: 1.780517 ustep: 1 
iter: 3  value: 1478.241 mgc: 0.01176372 ustep: 1 
iter: 4  value: 1478.241 mgc: 9.43798e-07 ustep: 1 
iter: 5  mgc: 4.174439e-14 
iter: 1  value: 1262.982 mgc: 5.20175 ustep: 1 
iter: 2  value: 1262.974 mgc: 0.1040346 ustep: 1 
iter: 3  value: 1262.974 mgc: 7.773663e-05 ustep: 1 
iter: 4  mgc: 5.481682e-11 
iter: 1  mgc: 5.481682e-11 
outer mgc:  119.8422 
iter: 1  value: 1244.366 mgc: 12.53188 ustep: 1 
iter: 2  value: 1244.327 mgc: 0.3425151 ustep: 1 
iter: 3  value: 1244.327 mgc: 0.0005838688 ustep: 1 
iter: 4  mgc: 1.852123e-09 
iter: 1  mgc: 1.852123e-09 
outer mgc:  90.94239 
iter: 1  value: 1228.498 mgc: 5.70562 ustep: 1 
iter: 2  value: 1228.475 mgc: 0.2272065 ustep: 1 
iter: 3  value: 1228.475 mgc: 0.0003410242 ustep: 1 
iter: 4  mgc: 7.697443e-10 
iter: 1  mgc: 7.697443e-10 
outer mgc:  48.69282 
iter: 1  value: 1221.617 mgc: 9.058162 ustep: 1 
iter: 2  value: 1221.615 mgc: 0.1370555 ustep: 1 
iter: 3  value: 1221.615 mgc: 2.742237e-05 ustep: 1 
iter: 4  mgc: 4.190648e-12 
iter: 1  mgc: 4.190648e-12 
outer mgc:  56.6537 
iter: 1  value: 1212.423 mgc: 6.13396 ustep: 1 
iter: 2  value: 1212.418 mgc: 0.171243 ustep: 1 
iter: 3  value: 1212.418 mgc: 0.0001360569 ustep: 1 
iter: 4  mgc: 8.641088e-11 
iter: 1  mgc: 8.641088e-11 
outer mgc:  48.23989 
iter: 1  value: 1214.268 mgc: 3.500731 ustep: 1 
iter: 2  value: 1214.268 mgc: 0.02638629 ustep: 1 
iter: 3  value: 1214.268 mgc: 4.778069e-06 ustep: 1 
iter: 4  mgc: 7.296386e-13 
iter: 1  value: 1210.455 mgc: 3.708582 ustep: 1 
iter: 2  value: 1210.455 mgc: 0.02603103 ustep: 1 
iter: 3  value: 1210.455 mgc: 3.097905e-06 ustep: 1 
iter: 4  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  41.71793 
iter: 1  value: 1212.306 mgc: 4.840263 ustep: 1 
iter: 2  value: 1212.305 mgc: 0.06885547 ustep: 1 
iter: 3  value: 1212.305 mgc: 1.434989e-05 ustep: 1 
iter: 4  mgc: 7.71827e-13 
iter: 1  value: 1210.674 mgc: 3.203768 ustep: 1 
iter: 2  value: 1210.674 mgc: 0.02477167 ustep: 1 
iter: 3  value: 1210.674 mgc: 2.077472e-06 ustep: 1 
iter: 4  mgc: 4.973799e-14 
iter: 1  mgc: 4.973799e-14 
outer mgc:  43.7453 
iter: 1  value: 1209.557 mgc: 1.503559 ustep: 1 
iter: 2  value: 1209.557 mgc: 0.00447726 ustep: 1 
iter: 3  value: 1209.557 mgc: 6.609233e-08 ustep: 1 
mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  13.32067 
iter: 1  value: 1209.224 mgc: 0.2932042 ustep: 1 
iter: 2  value: 1209.224 mgc: 0.0003025354 ustep: 1 
iter: 3  mgc: 3.39873e-10 
iter: 1  value: 1208.665 mgc: 0.8942911 ustep: 1 
iter: 2  value: 1208.665 mgc: 0.002768513 ustep: 1 
iter: 3  value: 1208.665 mgc: 2.710872e-08 ustep: 1 
mgc: 3.210626e-14 
iter: 1  mgc: 3.210626e-14 
outer mgc:  14.87356 
iter: 1  value: 1207.093 mgc: 1.244878 ustep: 1 
iter: 2  value: 1207.093 mgc: 0.003545992 ustep: 1 
iter: 3  value: 1207.093 mgc: 7.146156e-08 ustep: 1 
iter: 4  mgc: 6.816769e-14 
iter: 1  mgc: 6.816769e-14 
outer mgc:  13.45966 
iter: 1  value: 1205.445 mgc: 0.7512321 ustep: 1 
iter: 2  value: 1205.445 mgc: 0.001663323 ustep: 1 
iter: 3  mgc: 5.055239e-09 
iter: 1  mgc: 5.055239e-09 
outer mgc:  28.91316 
iter: 1  value: 1204.453 mgc: 1.477504 ustep: 1 
iter: 2  value: 1204.453 mgc: 0.00632678 ustep: 1 
iter: 3  value: 1204.453 mgc: 1.284137e-07 ustep: 1 
iter: 4  mgc: 3.808065e-14 
iter: 1  mgc: 3.808065e-14 
outer mgc:  9.480973 
iter: 1  value: 1202.368 mgc: 1.62035 ustep: 1 
iter: 2  value: 1202.367 mgc: 0.01535978 ustep: 1 
iter: 3  value: 1202.367 mgc: 1.52398e-06 ustep: 1 
iter: 4  mgc: 4.618528e-14 
iter: 1  mgc: 4.618528e-14 
outer mgc:  12.18041 
iter: 1  value: 1200.59 mgc: 1.981791 ustep: 1 
iter: 2  value: 1200.59 mgc: 0.01106052 ustep: 1 
iter: 3  value: 1200.59 mgc: 5.080622e-07 ustep: 1 
iter: 4  mgc: 3.497203e-14 
iter: 1  mgc: 3.497203e-14 
outer mgc:  29.09132 
iter: 1  value: 1198.968 mgc: 3.653339 ustep: 1 
iter: 2  value: 1198.968 mgc: 0.01728994 ustep: 1 
iter: 3  value: 1198.968 mgc: 3.414285e-06 ustep: 1 
iter: 4  mgc: 2.753353e-13 
iter: 1  mgc: 2.753353e-13 
outer mgc:  34.64929 
iter: 1  value: 1199.187 mgc: 1.592848 ustep: 1 
iter: 2  value: 1199.187 mgc: 0.007806572 ustep: 1 
iter: 3  value: 1199.187 mgc: 1.432771e-06 ustep: 1 
iter: 4  mgc: 6.750156e-14 
iter: 1  mgc: 6.750156e-14 
outer mgc:  12.85035 
iter: 1  value: 1198.657 mgc: 1.206156 ustep: 1 
iter: 2  value: 1198.657 mgc: 0.006176252 ustep: 1 
iter: 3  value: 1198.657 mgc: 3.491274e-07 ustep: 1 
iter: 4  mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  21.77835 
iter: 1  value: 1196.389 mgc: 3.226306 ustep: 1 
iter: 2  value: 1196.389 mgc: 0.02237276 ustep: 1 
iter: 3  value: 1196.389 mgc: 6.876245e-07 ustep: 1 
iter: 4  mgc: 3.463896e-14 
iter: 1  value: 1198.528 mgc: 2.013694 ustep: 1 
iter: 2  value: 1198.528 mgc: 0.008439021 ustep: 1 
iter: 3  value: 1198.528 mgc: 1.668895e-07 ustep: 1 
mgc: 4.574119e-14 
iter: 1  value: 1198.308 mgc: 0.6912653 ustep: 1 
iter: 2  value: 1198.308 mgc: 0.001028104 ustep: 1 
iter: 3  mgc: 2.505962e-09 
iter: 1  mgc: 2.505962e-09 
outer mgc:  10.61879 
iter: 1  value: 1198.08 mgc: 0.573701 ustep: 1 
iter: 2  value: 1198.08 mgc: 0.0003634325 ustep: 1 
iter: 3  mgc: 6.774854e-10 
iter: 1  mgc: 6.774854e-10 
outer mgc:  12.82297 
iter: 1  value: 1197.284 mgc: 0.7209671 ustep: 1 
iter: 2  value: 1197.284 mgc: 0.001121749 ustep: 1 
iter: 3  mgc: 2.73465e-09 
iter: 1  mgc: 2.73465e-09 
outer mgc:  11.28758 
iter: 1  value: 1196.073 mgc: 0.6992826 ustep: 1 
iter: 2  value: 1196.073 mgc: 0.0007086619 ustep: 1 
iter: 3  mgc: 1.790942e-09 
iter: 1  mgc: 1.790942e-09 
outer mgc:  8.60286 
iter: 1  value: 1196.071 mgc: 0.6225145 ustep: 1 
iter: 2  value: 1196.071 mgc: 0.001034457 ustep: 1 
iter: 3  value: 1196.071 mgc: 2.657375e-08 ustep: 1 
mgc: 4.440892e-14 
iter: 1  mgc: 4.440892e-14 
outer mgc:  5.007816 
iter: 1  value: 1195.448 mgc: 0.8658232 ustep: 1 
iter: 2  value: 1195.448 mgc: 0.0008080808 ustep: 1 
iter: 3  value: 1195.448 mgc: 1.101352e-08 ustep: 1 
mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  6.953932 
iter: 1  value: 1194.661 mgc: 0.7591612 ustep: 1 
iter: 2  value: 1194.661 mgc: 0.001391157 ustep: 1 
iter: 3  mgc: 4.512961e-09 
iter: 1  mgc: 4.512961e-09 
outer mgc:  12.19311 
iter: 1  value: 1193.712 mgc: 0.5333048 ustep: 1 
iter: 2  value: 1193.712 mgc: 0.0005182321 ustep: 1 
iter: 3  mgc: 5.725682e-10 
iter: 1  value: 1192.67 mgc: 0.4296646 ustep: 1 
iter: 2  value: 1192.67 mgc: 0.00039549 ustep: 1 
iter: 3  mgc: 4.126726e-10 
iter: 1  value: 1189.832 mgc: 1.251314 ustep: 1 
iter: 2  value: 1189.832 mgc: 0.00306617 ustep: 1 
iter: 3  value: 1189.832 mgc: 2.392521e-08 ustep: 1 
mgc: 4.274359e-14 
iter: 1  mgc: 4.274359e-14 
outer mgc:  8.722179 
iter: 1  value: 1189.028 mgc: 0.4592561 ustep: 1 
iter: 2  value: 1189.028 mgc: 0.00383346 ustep: 1 
iter: 3  value: 1189.028 mgc: 4.320761e-07 ustep: 1 
iter: 4  mgc: 3.019807e-14 
iter: 1  mgc: 3.019807e-14 
outer mgc:  7.673812 
iter: 1  value: 1184.1 mgc: 3.176449 ustep: 1 
iter: 2  value: 1184.099 mgc: 0.04800835 ustep: 1 
iter: 3  value: 1184.099 mgc: 1.115131e-05 ustep: 1 
iter: 4  mgc: 1.795009e-12 
iter: 1  value: 1186.533 mgc: 1.465532 ustep: 1 
iter: 2  value: 1186.533 mgc: 0.009954017 ustep: 1 
iter: 3  value: 1186.533 mgc: 4.901332e-07 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  8.866712 
iter: 1  value: 1185.316 mgc: 0.8170426 ustep: 1 
iter: 2  value: 1185.316 mgc: 0.001188699 ustep: 1 
iter: 3  mgc: 3.674478e-09 
iter: 1  mgc: 3.674478e-09 
outer mgc:  5.500513 
iter: 1  value: 1183.932 mgc: 1.100604 ustep: 1 
iter: 2  value: 1183.932 mgc: 0.001703864 ustep: 1 
iter: 3  value: 1183.932 mgc: 2.369165e-08 ustep: 1 
mgc: 3.108624e-14 
iter: 1  mgc: 3.108624e-14 
outer mgc:  5.420453 
iter: 1  value: 1182.794 mgc: 0.5790365 ustep: 1 
iter: 2  value: 1182.794 mgc: 0.0003962108 ustep: 1 
iter: 3  mgc: 5.417462e-10 
iter: 1  value: 1180.667 mgc: 1.189033 ustep: 1 
iter: 2  value: 1180.667 mgc: 0.001482578 ustep: 1 
iter: 3  mgc: 7.605061e-09 
iter: 1  mgc: 7.605061e-09 
outer mgc:  7.526003 
iter: 1  value: 1178.162 mgc: 1.197766 ustep: 1 
iter: 2  value: 1178.162 mgc: 0.002296199 ustep: 1 
iter: 3  mgc: 6.864592e-09 
iter: 1  mgc: 6.864592e-09 
outer mgc:  7.49359 
iter: 1  value: 1177.872 mgc: 0.2444633 ustep: 1 
iter: 2  value: 1177.872 mgc: 0.0002970873 ustep: 1 
iter: 3  mgc: 4.030305e-10 
iter: 1  mgc: 4.030305e-10 
outer mgc:  0.3779905 
iter: 1  value: 1177.735 mgc: 0.07037331 ustep: 1 
iter: 2  value: 1177.735 mgc: 6.429747e-06 ustep: 1 
iter: 3  mgc: 8.881784e-14 
iter: 1  mgc: 8.881784e-14 
outer mgc:  0.134405 
iter: 1  value: 1177.681 mgc: 0.02118576 ustep: 1 
iter: 2  value: 1177.681 mgc: 4.926486e-07 ustep: 1 
iter: 3  mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  0.02608661 
iter: 1  value: 1177.684 mgc: 0.002613943 ustep: 1 
iter: 2  mgc: 4.729883e-09 
iter: 1  mgc: 4.729883e-09 
outer mgc:  0.001391987 
iter: 1  value: 1177.684 mgc: 0.0001424272 ustep: 1 
iter: 2  mgc: 5.98197e-11 
iter: 1  mgc: 5.98197e-11 
outer mgc:  0.0001652677 
iter: 1  mgc: 5.98197e-11 
iter: 1  mgc: 5.98197e-11 
outer mgc:  0.0001652677 
iter: 1  value: 1177.681 mgc: 0.04180286 ustep: 1 
iter: 2  value: 1177.681 mgc: 2.31781e-06 ustep: 1 
iter: 3  mgc: 3.907985e-14 
outer mgc:  1.895349 
iter: 1  value: 1177.689 mgc: 0.0417821 ustep: 1 
iter: 2  value: 1177.689 mgc: 2.318752e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  1.894675 
iter: 1  value: 1177.683 mgc: 0.0233734 ustep: 1 
iter: 2  value: 1177.683 mgc: 6.78635e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  1.334479 
iter: 1  value: 1177.686 mgc: 0.02336241 ustep: 1 
iter: 2  value: 1177.686 mgc: 6.785644e-07 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  1.333889 
iter: 1  value: 1177.691 mgc: 0.0556253 ustep: 1 
iter: 2  value: 1177.691 mgc: 3.507312e-06 ustep: 1 
iter: 3  mgc: 1.669775e-13 
outer mgc:  1.843504 
iter: 1  value: 1177.679 mgc: 0.05562147 ustep: 1 
iter: 2  value: 1177.679 mgc: 3.498447e-06 ustep: 1 
iter: 3  mgc: 1.652012e-13 
outer mgc:  1.844005 
iter: 1  value: 1177.689 mgc: 0.02903464 ustep: 1 
iter: 2  value: 1177.689 mgc: 7.650081e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
outer mgc:  1.668669 
iter: 1  value: 1177.681 mgc: 0.02904046 ustep: 1 
iter: 2  value: 1177.681 mgc: 7.647406e-07 ustep: 1 
iter: 3  mgc: 4.352074e-14 
outer mgc:  1.668995 
iter: 1  value: 1177.67 mgc: 0.005845487 ustep: 1 
iter: 2  value: 1177.67 mgc: 3.975501e-08 ustep: 1 
mgc: 3.197442e-14 
outer mgc:  0.005491399 
iter: 1  value: 1177.698 mgc: 0.005844026 ustep: 1 
iter: 2  value: 1177.698 mgc: 3.978173e-08 ustep: 1 
mgc: 4.352074e-14 
outer mgc:  0.005351734 
iter: 1  value: 1177.734 mgc: 0.06147319 ustep: 1 
iter: 2  value: 1177.734 mgc: 5.044752e-06 ustep: 1 
iter: 3  mgc: 5.595524e-14 
outer mgc:  0.62153 
iter: 1  value: 1177.634 mgc: 0.06165769 ustep: 1 
iter: 2  value: 1177.634 mgc: 5.052379e-06 ustep: 1 
iter: 3  mgc: 5.846712e-14 
outer mgc:  0.6211358 
iter: 1  value: 1177.704 mgc: 0.06582248 ustep: 1 
iter: 2  value: 1177.704 mgc: 4.60823e-06 ustep: 1 
iter: 3  mgc: 4.707346e-14 
outer mgc:  0.6990445 
iter: 1  value: 1177.664 mgc: 0.0660066 ustep: 1 
iter: 2  value: 1177.664 mgc: 4.615893e-06 ustep: 1 
iter: 3  mgc: 4.218847e-14 
outer mgc:  0.7000939 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:11:07 2021]
Finished job 0.
1 of 1 steps (100%) done

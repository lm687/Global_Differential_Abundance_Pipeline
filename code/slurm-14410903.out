Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:28:54 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_4_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_4_4_ModelfullREDMsinglelambda_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=4, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_4_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_4_fullREDMsinglelambda_NA_NA_NA_dataset0.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_4_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_4_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_4_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2714.364359 
iter  10 value 2168.954226
iter  20 value 2162.707281
final  value 2162.620835 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2243.724 mgc: 4.429136 ustep: 1 
iter: 2  value: 2238.014 mgc: 2.579495 ustep: 1 
iter: 3  value: 2237.746 mgc: 0.8778934 ustep: 1 
iter: 4  value: 2237.745 mgc: 0.05802743 ustep: 1 
iter: 5  value: 2237.745 mgc: 0.0003510799 ustep: 1 
iter: 6  value: 2237.745 mgc: 2.475419e-08 ustep: 1 
iter: 7  mgc: 1.082467e-15 
iter: 1  mgc: 1.082467e-15 
Matching hessian patterns... Done
outer mgc:  10.00017 
iter: 1  value: 2221.051 mgc: 1.304243 ustep: 1 
iter: 2  value: 2221.01 mgc: 0.2230148 ustep: 1 
iter: 3  value: 2221.01 mgc: 0.0042814 ustep: 1 
iter: 4  value: 2221.01 mgc: 2.19773e-06 ustep: 1 
iter: 5  mgc: 5.790368e-13 
iter: 1  value: 2205.622 mgc: 3.248275 ustep: 1 
iter: 2  value: 2205.604 mgc: 0.175006 ustep: 1 
iter: 3  value: 2205.604 mgc: 0.001387574 ustep: 1 
iter: 4  value: 2205.604 mgc: 8.284732e-08 ustep: 1 
iter: 5  mgc: 1.110223e-15 
iter: 1  mgc: 1.110223e-15 
outer mgc:  19.54537 
iter: 1  value: 2179.54 mgc: 6.427406 ustep: 1 
iter: 2  value: 2179.537 mgc: 0.08930242 ustep: 1 
iter: 3  value: 2179.537 mgc: 0.0001375798 ustep: 1 
iter: 4  mgc: 5.317398e-10 
iter: 1  mgc: 5.317398e-10 
outer mgc:  39.36488 
iter: 1  value: 2136.468 mgc: 10.67696 ustep: 1 
iter: 2  value: 2136.467 mgc: 0.05227185 ustep: 1 
iter: 3  value: 2136.467 mgc: 2.342323e-05 ustep: 1 
iter: 4  mgc: 9.98801e-12 
iter: 1  mgc: 9.98801e-12 
outer mgc:  10.00837 
iter: 1  value: 2109.059 mgc: 2.850969 ustep: 1 
iter: 2  value: 2109.059 mgc: 0.004068637 ustep: 1 
iter: 3  value: 2109.059 mgc: 2.36184e-08 ustep: 1 
mgc: 1.998401e-15 
iter: 1  mgc: 1.998401e-15 
outer mgc:  10.04005 
iter: 1  value: 2073.93 mgc: 2.230464 ustep: 1 
iter: 2  value: 2073.93 mgc: 0.0006227432 ustep: 1 
iter: 3  mgc: 1.413884e-09 
iter: 1  value: 2027.24 mgc: 7.634434 ustep: 1 
iter: 2  value: 2027.24 mgc: 0.0001650467 ustep: 1 
iter: 3  mgc: 2.396527e-12 
iter: 1  value: 2197.424 mgc: 34.95696 ustep: 1 
iter: 2  value: 2197.424 mgc: 0.0002145461 ustep: 1 
iter: 3  mgc: 9.85878e-14 
iter: 1  mgc: 2.396527e-12 
outer mgc:  16.66037 
iter: 1  value: 2208.388 mgc: 22.71045 ustep: 1 
iter: 2  value: 2208.388 mgc: 0.003385876 ustep: 1 
iter: 3  mgc: 1.158218e-09 
iter: 1  value: 2010.368 mgc: 2.496006 ustep: 1 
iter: 2  value: 2010.368 mgc: 1.996543e-05 ustep: 1 
iter: 3  mgc: 2.04281e-14 
iter: 1  mgc: 2.04281e-14 
outer mgc:  9.676208 
iter: 1  value: 2004.606 mgc: 2.867859 ustep: 1 
iter: 2  value: 2004.606 mgc: 4.379669e-05 ustep: 1 
iter: 3  mgc: 8.775203e-13 
iter: 1  mgc: 8.775203e-13 
outer mgc:  8.330888 
iter: 1  value: 2001.674 mgc: 2.668506 ustep: 1 
iter: 2  value: 2001.674 mgc: 0.0001043351 ustep: 1 
iter: 3  mgc: 6.659118e-13 
iter: 1  mgc: 6.659118e-13 
outer mgc:  14.18612 
iter: 1  value: 1994.863 mgc: 1.732313 ustep: 1 
iter: 2  value: 1994.863 mgc: 0.000120639 ustep: 1 
iter: 3  mgc: 4.858336e-13 
iter: 1  mgc: 4.858336e-13 
outer mgc:  4.4477 
iter: 1  value: 1996.122 mgc: 2.215805 ustep: 1 
iter: 2  value: 1996.122 mgc: 9.278099e-05 ustep: 1 
iter: 3  mgc: 4.760636e-13 
iter: 1  value: 1994.58 mgc: 1.25951 ustep: 1 
iter: 2  value: 1994.58 mgc: 1.826424e-05 ustep: 1 
iter: 3  mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  9.982651 
iter: 1  value: 1992.332 mgc: 1.233605 ustep: 1 
iter: 2  value: 1992.332 mgc: 2.346475e-05 ustep: 1 
iter: 3  mgc: 1.565414e-14 
iter: 1  mgc: 1.565414e-14 
outer mgc:  2.072835 
iter: 1  value: 1991.457 mgc: 0.8894737 ustep: 1 
iter: 2  value: 1991.457 mgc: 8.708912e-06 ustep: 1 
iter: 3  mgc: 8.992806e-15 
iter: 1  mgc: 8.992806e-15 
outer mgc:  5.949756 
iter: 1  value: 1988.293 mgc: 1.400041 ustep: 1 
iter: 2  value: 1988.293 mgc: 2.976481e-05 ustep: 1 
iter: 3  mgc: 8.171241e-14 
iter: 1  value: 1985.028 mgc: 1.085845 ustep: 1 
iter: 2  value: 1985.028 mgc: 2.454951e-05 ustep: 1 
iter: 3  mgc: 2.433609e-13 
iter: 1  mgc: 2.433609e-13 
outer mgc:  5.054354 
iter: 1  value: 1981.949 mgc: 2.687153 ustep: 1 
iter: 2  value: 1981.949 mgc: 4.675742e-05 ustep: 1 
iter: 3  mgc: 5.853651e-14 
iter: 1  mgc: 5.853651e-14 
outer mgc:  6.317559 
iter: 1  value: 1978.142 mgc: 9.611401 ustep: 1 
iter: 2  value: 1978.142 mgc: 6.219239e-05 ustep: 1 
iter: 3  mgc: 2.78888e-13 
iter: 1  mgc: 2.78888e-13 
outer mgc:  1.820804 
iter: 1  value: 1978.027 mgc: 19.28423 ustep: 1 
iter: 2  value: 1978.027 mgc: 0.001772696 ustep: 1 
iter: 3  mgc: 1.035767e-09 
iter: 1  value: 1977.218 mgc: 5.865067 ustep: 1 
iter: 2  value: 1977.218 mgc: 0.0001835997 ustep: 1 
iter: 3  mgc: 4.648726e-12 
iter: 1  mgc: 4.648726e-12 
outer mgc:  1.862414 
iter: 1  value: 1976.528 mgc: 5.821187 ustep: 1 
iter: 2  value: 1976.528 mgc: 0.0003956205 ustep: 1 
iter: 3  mgc: 5.173062e-11 
iter: 1  mgc: 5.173062e-11 
outer mgc:  1.052181 
iter: 1  value: 1976.86 mgc: 33.72501 ustep: 1 
iter: 2  value: 1976.86 mgc: 0.02900005 ustep: 1 
iter: 3  value: 1976.86 mgc: 4.317455e-06 ustep: 1 
iter: 4  mgc: 1.376677e-13 
iter: 1  mgc: 1.376677e-13 
outer mgc:  1.222518 
iter: 1  value: 1983.61 mgc: 394.3149 ustep: 1 
iter: 2  value: 1982.889 mgc: 1.529788 ustep: 1 
iter: 3  value: 1982.881 mgc: 0.1391926 ustep: 1 
iter: 4  value: 1982.881 mgc: 0.002175689 ustep: 1 
iter: 5  value: 1982.881 mgc: 1.914348e-06 ustep: 1 
iter: 6  mgc: 1.486922e-12 
iter: 1  value: 1977.284 mgc: 27.03072 ustep: 1 
iter: 2  value: 1977.284 mgc: 0.01807611 ustep: 1 
iter: 3  value: 1977.284 mgc: 6.732623e-06 ustep: 1 
iter: 4  mgc: 9.243717e-13 
iter: 1  mgc: 9.243717e-13 
outer mgc:  0.7181094 
iter: 1  value: 1977.442 mgc: 39.55499 ustep: 1 
iter: 2  value: 1977.441 mgc: 0.01159939 ustep: 1 
iter: 3  value: 1977.441 mgc: 4.215682e-06 ustep: 1 
iter: 4  mgc: 5.557776e-13 
iter: 1  value: 1977.564 mgc: 52.31737 ustep: 1 
iter: 2  value: 1977.564 mgc: 0.02106561 ustep: 1 
iter: 3  value: 1977.564 mgc: 2.10311e-05 ustep: 1 
iter: 4  mgc: 2.10032e-11 
iter: 1  mgc: 2.10032e-11 
outer mgc:  0.8307247 
iter: 1  value: 1977.07 mgc: 84.18976 ustep: 1 
iter: 2  value: 1977.07 mgc: 0.01268902 ustep: 1 
iter: 3  value: 1977.07 mgc: 5.349914e-06 ustep: 1 
iter: 4  mgc: 8.772982e-13 
iter: 1  mgc: 8.772982e-13 
outer mgc:  2.016673 
iter: 1  value: 1978.073 mgc: 110.8192 ustep: 1 
iter: 2  value: 1978.073 mgc: 0.002450368 ustep: 1 
iter: 3  value: 1978.073 mgc: 9.434601e-08 ustep: 1 
iter: 4  mgc: 3.141931e-14 
iter: 1  mgc: 3.141931e-14 
outer mgc:  0.5835241 
iter: 1  value: 1977.858 mgc: 76.97116 ustep: 1 
iter: 2  value: 1977.858 mgc: 0.006415509 ustep: 1 
iter: 3  value: 1977.858 mgc: 9.965587e-07 ustep: 1 
iter: 4  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  0.3368377 
iter: 1  value: 1976.412 mgc: 25.50679 ustep: 1 
iter: 2  value: 1976.412 mgc: 0.002350031 ustep: 1 
iter: 3  value: 1976.412 mgc: 2.02999e-07 ustep: 1 
iter: 4  mgc: 3.907985e-14 
iter: 1  mgc: 3.907985e-14 
outer mgc:  0.6256402 
iter: 1  value: 1975.196 mgc: 31.20747 ustep: 1 
iter: 2  value: 1975.196 mgc: 0.000248723 ustep: 1 
iter: 3  mgc: 1.444194e-09 
iter: 1  mgc: 1.444194e-09 
outer mgc:  0.2543963 
iter: 1  value: 1972.312 mgc: 26.54045 ustep: 1 
iter: 2  value: 1972.312 mgc: 0.001580503 ustep: 1 
iter: 3  value: 1972.312 mgc: 7.756899e-08 ustep: 1 
iter: 4  mgc: 5.684342e-14 
iter: 1  mgc: 5.684342e-14 
outer mgc:  0.09677107 
iter: 1  value: 1970.487 mgc: 26.4983 ustep: 1 
iter: 2  value: 1970.487 mgc: 8.466877e-05 ustep: 1 
iter: 3  mgc: 2.222742e-10 
iter: 1  mgc: 2.222742e-10 
outer mgc:  0.08231502 
iter: 1  value: 1968.382 mgc: 37.89215 ustep: 1 
iter: 2  value: 1968.382 mgc: 2.626171e-05 ustep: 1 
iter: 3  mgc: 1.14595e-11 
iter: 1  mgc: 1.14595e-11 
outer mgc:  0.03640654 
iter: 1  value: 1966.808 mgc: 34.592 ustep: 1 
iter: 2  value: 1966.808 mgc: 1.440028e-05 ustep: 1 
iter: 3  mgc: 5.14544e-12 
iter: 1  mgc: 5.14544e-12 
outer mgc:  0.03383475 
iter: 1  value: 1965.251 mgc: 42.20192 ustep: 1 
iter: 2  value: 1965.251 mgc: 1.016769e-05 ustep: 1 
iter: 3  mgc: 2.235323e-12 
iter: 1  mgc: 2.235323e-12 
outer mgc:  0.05831818 
iter: 1  value: 1961.444 mgc: 159.0554 ustep: 1 
iter: 2  value: 1961.444 mgc: 4.507746e-05 ustep: 1 
iter: 3  mgc: 4.453771e-11 
iter: 1  mgc: 4.453771e-11 
outer mgc:  0.1027766 
iter: 1  value: 1957.935 mgc: 193.6045 ustep: 1 
iter: 2  value: 1957.935 mgc: 2.232287e-05 ustep: 1 
iter: 3  mgc: 8.475221e-12 
iter: 1  mgc: 8.475221e-12 
outer mgc:  0.09554117 
iter: 1  value: 1953.044 mgc: 393.4634 ustep: 1 
iter: 2  value: 1953.044 mgc: 3.189217e-05 ustep: 1 
iter: 3  mgc: 2.193046e-11 
iter: 1  mgc: 2.193046e-11 
outer mgc:  0.05145568 
iter: 1  value: 1948.514 mgc: 464.6291 ustep: 1 
iter: 2  value: 1948.514 mgc: 1.944601e-05 ustep: 1 
iter: 3  mgc: 8.024026e-12 
iter: 1  mgc: 8.024026e-12 
outer mgc:  0.01266406 
iter: 1  value: 1943.609 mgc: 657.5085 ustep: 1 
iter: 2  value: 1943.609 mgc: 9.066352e-06 ustep: 1 
iter: 3  mgc: 1.76692e-12 
iter: 1  mgc: 1.76692e-12 
outer mgc:  0.02418558 
iter: 1  value: 1938.949 mgc: 796.904 ustep: 1 
iter: 2  value: 1938.949 mgc: 2.057421e-06 ustep: 1 
iter: 3  mgc: 1.101119e-12 
iter: 1  mgc: 1.101119e-12 
outer mgc:  0.0213991 
iter: 1  value: 1934.45 mgc: 1011.482 ustep: 1 
iter: 2  value: 1934.45 mgc: 1.603328e-06 ustep: 1 
iter: 3  mgc: 1.612044e-12 
iter: 1  mgc: 1.612044e-12 
outer mgc:  0.01101999 
iter: 1  value: 1930.066 mgc: 1365.021 ustep: 1 
iter: 2  value: 1930.066 mgc: 9.75367e-07 ustep: 1 
iter: 3  mgc: 5.915823e-13 
iter: 1  mgc: 5.915823e-13 
outer mgc:  0.001853617 
iter: 1  value: 1925.758 mgc: 1956.856 ustep: 1 
iter: 2  value: 1925.758 mgc: 1.993889e-07 ustep: 1 
iter: 3  mgc: 2.351008e-12 
iter: 1  mgc: 2.351008e-12 
outer mgc:  0.002324732 
iter: 1  value: 1921.507 mgc: 2932.619 ustep: 1 
iter: 2  value: 1921.507 mgc: 5.717693e-08 ustep: 1 
iter: 3  mgc: 3.682388e-12 
iter: 1  mgc: 3.682388e-12 
outer mgc:  0.002670205 
iter: 1  value: 1917.299 mgc: 4478.902 ustep: 1 
iter: 2  value: 1917.299 mgc: 5.439778e-08 ustep: 1 
iter: 3  mgc: 6.925127e-12 
iter: 1  mgc: 6.925127e-12 
outer mgc:  0.001405564 
iter: 1  value: 1913.123 mgc: 6889.353 ustep: 1 
iter: 2  value: 1913.123 mgc: 3.560225e-08 ustep: 1 
mgc: 1.977174e-11 
iter: 1  mgc: 1.977174e-11 
outer mgc:  0.003242087 
iter: 1  value: 1904.948 mgc: 37960.41 ustep: 1 
iter: 2  value: 1904.948 mgc: 5.606538e-08 ustep: 1 
iter: 3  mgc: 3.575806e-11 
iter: 1  mgc: 3.575806e-11 
outer mgc:  0.006000081 
iter: 1  value: 1893.69 mgc: 199319.5 ustep: 1 
iter: 2  value: 1893.69 mgc: 2.470613e-08 ustep: 1 
mgc: 2.682978e-10 
iter: 1  mgc: 2.682978e-10 
outer mgc:  0.007139257 
iter: 1  value: 1877.701 mgc: 1949145 ustep: 1 
iter: 2  value: 1877.701 mgc: 3.621972e-08 ustep: 1 
mgc: 1.733723e-09 
iter: 1  mgc: 1.733723e-09 
outer mgc:  0.005774947 
iter: 1  value: 1858.742 mgc: 19620908 ustep: 1 
iter: 2  value: 1858.742 mgc: 7.799855e-08 ustep: 1 
iter: 3  value: 1858.742 mgc: 1.029521e-08 ustep: 1 
mgc: 1.389104e-08 
iter: 1  value: 1858.742 mgc: 1.389104e-08 ustep: 1 
mgc: 6.31845e-09 
outer mgc:  0.002728202 
iter: 1  value: 1835.58 mgc: 329102727 ustep: 1 
iter: 2  value: 1835.58 mgc: 1.593827e-07 ustep: 1 
iter: 3  value: 1835.58 mgc: 7.19596e-08 ustep: 1 
mgc: 7.851157e-08 
iter: 1  value: 1835.58 mgc: 7.851157e-08 ustep: 1 
mgc: 6.795655e-08 
outer mgc:  0.0009186205 
iter: 1  value: 1806.836 mgc: 10553842754 ustep: 1 
iter: 2  value: 1806.836 mgc: 4.807268e-06 ustep: 1 
mgc: 2.723049e-06 
iter: 1  value: 1806.836 mgc: 2.723049e-06 ustep: 1 
mgc: 1.669389e-06 
outer mgc:  0.002150193 
iter: 1  value: 1770.794 mgc: 789944526750 ustep: 1 
iter: 2  value: 1770.794 mgc: 0.0001390088 ustep: 1 
mgc: 6.885365e-05 
iter: 1  value: 1770.794 mgc: 6.885365e-05 ustep: 1 
mgc: 0.0001010732 
outer mgc:  0.001949781 
iter: 1  value: 1725.973 mgc: 1.565355e+14 ustep: 1 
iter: 2  value: 1725.973 mgc: 0.02590625 ustep: 1 
mgc: 0.0101574 
iter: 1  value: 1725.973 mgc: 0.0101574 ustep: 1 
mgc: 0.02029797 
outer mgc:  0.0005998164 
iter: 1  value: 1670.543 mgc: 1.024961e+17 ustep: 1 
iter: 2  value: 1670.543 mgc: 38.65766 ustep: 1 
mgc: 4.061256 
iter: 1  value: 1670.543 mgc: 4.061256 ustep: 1 
mgc: 2.414853 
outer mgc:  0.000975296 
iter: 1  value: 1601.92 mgc: 3.088917e+20 ustep: 1 
iter: 2  value: 1601.92 mgc: 88095.18 ustep: 1 
mgc: 3600.552 
iter: 1  value: 1601.92 mgc: 3600.552 ustep: 1 
mgc: 3596.669 
outer mgc:  0.001570358 
iter: 1  value: 1516.547 mgc: 6.64768e+24 ustep: 1 
iter: 2  value: 1516.547 mgc: 1569072458 ustep: 1 
mgc: 24645115 
iter: 1  value: 1516.547 mgc: 24645115 ustep: 1 
mgc: 24645113 
outer mgc:  0.001208848 
iter: 1  value: 1409.811 mgc: 1.725971e+30 ustep: 1 
iter: 2  value: 1409.811 mgc: 3.532244e+14 ustep: 1 
mgc: 637589221444 
iter: 1  value: 1409.811 mgc: 637589221444 ustep: 1 
mgc: 637589221450 
outer mgc:  0.0004425517 
iter: 1  value: 1275.341 mgc: 1.047997e+37 ustep: 1 
iter: 2  value: 1275.341 mgc: 2.187051e+21 ustep: 1 
iter: 3  value: 1275.341 mgc: 7.538956e+17 ustep: 1 
mgc: 3.769478e+17 
iter: 1  value: 1275.341 mgc: 3.769478e+17 ustep: 1 
mgc: 7.538956e+17 
outer mgc:  0.0002048952 
iter: 1  value: 1104.212 mgc: 5.73091e+44 ustep: 1 
iter: 2  value: 1104.212 mgc: 1.151656e+29 ustep: 1 
iter: 3  value: 1104.212 mgc: 3.001059e+25 ustep: 1 
mgc: 3.001059e+25 
iter: 1  value: 1104.212 mgc: 3.001059e+25 ustep: 1 
mgc: 3.001059e+25 
outer mgc:  NaN 
Error in nlminb(start = obj$par, obj = obj$fn, gr = obj$gr, iter.max = iter.max) : 
  NA/NaN gradient evaluation
In addition: Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:28:56 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:41:49 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_20_100_80_3_2_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=20, nlambda=100, lmbda=80, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_20_100_80_3_2_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_20_100_80_3_2_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 4404.336665 
iter  10 value 3284.108968
iter  10 value 3284.108952
final  value 3284.108952 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 3014.702 mgc: 143.4834 ustep: 1 
iter: 2  value: 2682.329 mgc: 95.04144 ustep: 1 
iter: 3  value: 1852.467 mgc: 82.44379 ustep: 0.1336527 
iter: 4  value: 1798.371 mgc: 57.07392 ustep: 0.3656489 
iter: 5  value: 1797.785 mgc: 4.500711 ustep: 0.6047286 
iter: 6  value: 1797.784 mgc: 0.114088 ustep: 0.7776652 
iter: 7  value: 1797.784 mgc: 0.003835283 ustep: 0.8818651 
iter: 8  value: 1797.784 mgc: 0.000147614 ustep: 0.9390828 
iter: 9  value: 1797.784 mgc: 2.74815e-06 ustep: 0.969066 
iter: 10  value: 1797.784 mgc: 2.524275e-08 ustep: 0.984413 
iter: 11  mgc: 1.15441e-10 
iter: 1  mgc: 1.15441e-10 
Matching hessian patterns... Done
outer mgc:  741.0435 
iter: 1  value: 1146.178 mgc: 31.24117 ustep: 1 
iter: 2  value: 1134.675 mgc: 10.68781 ustep: 1 
iter: 3  value: 1134.63 mgc: 0.7391483 ustep: 1 
iter: 4  value: 1134.63 mgc: 0.007025094 ustep: 1 
iter: 5  value: 1134.63 mgc: 8.845686e-07 ustep: 1 
iter: 6  mgc: 3.530509e-14 
iter: 1  value: 773.845 mgc: 60.2935 ustep: 1 
iter: 2  value: 572.4704 mgc: 39.24353 ustep: 1 
iter: 3  value: 571.1886 mgc: 2.97349 ustep: 1 
iter: 4  value: 571.1877 mgc: 0.1001037 ustep: 1 
iter: 5  value: 571.1877 mgc: 0.0001689821 ustep: 1 
iter: 6  mgc: 4.855385e-10 
iter: 1  mgc: 4.855385e-10 
outer mgc:  214.1604 
iter: 1  value: 435.327 mgc: 64.31383 ustep: 1 
iter: 2  value: 415.2678 mgc: 9.715405 ustep: 1 
iter: 3  value: 415.1219 mgc: 1.135539 ustep: 1 
iter: 4  value: 415.1219 mgc: 0.02340065 ustep: 1 
iter: 5  value: 415.1219 mgc: 1.061549e-05 ustep: 1 
iter: 6  mgc: 2.181588e-12 
iter: 1  mgc: 2.181588e-12 
outer mgc:  162.9809 
iter: 1  value: 1372.367 mgc: 196.4362 ustep: 0.1336527 
iter: 2  value: 1181.857 mgc: 88.30561 ustep: 0.3656489 
iter: 3  value: 1170.701 mgc: 14.58961 ustep: 0.6047286 
iter: 4  value: 1170.392 mgc: 2.054273 ustep: 0.7776652 
iter: 5  value: 1170.391 mgc: 0.1269802 ustep: 0.8818651 
iter: 6  value: 1170.391 mgc: 0.001562381 ustep: 0.9390828 
iter: 7  value: 1170.391 mgc: 7.176942e-06 ustep: 0.969066 
iter: 8  value: 1170.391 mgc: 1.654571e-08 ustep: 0.984413 
mgc: 1.899836e-11 
iter: 1  value: 323.2035 mgc: 20.6757 ustep: 1 
iter: 2  value: 311.3293 mgc: 7.054686 ustep: 1 
iter: 3  value: 311.2743 mgc: 0.5206037 ustep: 1 
iter: 4  value: 311.2743 mgc: 0.005476258 ustep: 1 
iter: 5  value: 311.2743 mgc: 6.254827e-07 ustep: 1 
iter: 6  mgc: 2.969847e-14 
iter: 1  mgc: 2.969847e-14 
outer mgc:  62.09826 
iter: 1  value: 292.8341 mgc: 14.21388 ustep: 1 
iter: 2  value: 290.7609 mgc: 2.98783 ustep: 1 
iter: 3  value: 290.7588 mgc: 0.1086765 ustep: 1 
iter: 4  value: 290.7588 mgc: 0.000236218 ustep: 1 
iter: 5  mgc: 1.123258e-09 
iter: 1  mgc: 1.123258e-09 
outer mgc:  32.35258 
iter: 1  value: 287.481 mgc: 9.041864 ustep: 1 
iter: 2  value: 287.2915 mgc: 1.053809 ustep: 1 
iter: 3  value: 287.2915 mgc: 0.01299091 ustep: 1 
iter: 4  value: 287.2915 mgc: 2.062988e-06 ustep: 1 
iter: 5  mgc: 6.450396e-14 
iter: 1  mgc: 6.450396e-14 
outer mgc:  38.4955 
iter: 1  value: 280.7261 mgc: 12.08228 ustep: 1 
iter: 2  value: 280.632 mgc: 0.5296956 ustep: 1 
iter: 3  value: 280.632 mgc: 0.01166784 ustep: 1 
iter: 4  value: 280.632 mgc: 8.818371e-06 ustep: 1 
iter: 5  mgc: 4.885869e-12 
iter: 1  mgc: 4.885869e-12 
outer mgc:  35.15665 
iter: 1  value: 292.6398 mgc: 22.96652 ustep: 1 
iter: 2  value: 272.4458 mgc: 10.10889 ustep: 1 
iter: 3  value: 272.3251 mgc: 0.73809 ustep: 1 
iter: 4  value: 272.3251 mgc: 0.006099043 ustep: 1 
iter: 5  value: 272.3251 mgc: 6.693692e-07 ustep: 1 
iter: 6  mgc: 3.988476e-14 
iter: 1  mgc: 3.988476e-14 
outer mgc:  27.98783 
iter: 1  value: 263.0943 mgc: 6.953145 ustep: 1 
iter: 2  value: 263.0416 mgc: 0.5843705 ustep: 1 
iter: 3  value: 263.0416 mgc: 0.001702947 ustep: 1 
iter: 4  value: 263.0416 mgc: 4.839188e-08 ustep: 1 
mgc: 4.507505e-14 
iter: 1  mgc: 4.507505e-14 
outer mgc:  18.76348 
iter: 1  value: 266.0452 mgc: 25.49553 ustep: 1 
iter: 2  value: 265.7105 mgc: 2.096798 ustep: 1 
iter: 3  value: 265.7105 mgc: 0.0300811 ustep: 1 
iter: 4  value: 265.7105 mgc: 6.570548e-06 ustep: 1 
iter: 5  mgc: 3.121947e-13 
iter: 1  value: 257.9598 mgc: 9.857131 ustep: 1 
iter: 2  value: 257.9429 mgc: 0.4169031 ustep: 1 
iter: 3  value: 257.9429 mgc: 0.001478149 ustep: 1 
iter: 4  value: 257.9429 mgc: 1.880371e-08 ustep: 1 
mgc: 3.264056e-14 
iter: 1  mgc: 3.264056e-14 
outer mgc:  13.53992 
iter: 1  value: 256.9604 mgc: 5.027647 ustep: 1 
iter: 2  value: 256.9553 mgc: 0.2031005 ustep: 1 
iter: 3  value: 256.9553 mgc: 0.000329992 ustep: 1 
iter: 4  mgc: 9.360852e-10 
iter: 1  mgc: 9.360852e-10 
outer mgc:  23.74131 
iter: 1  value: 253.5763 mgc: 13.99491 ustep: 1 
iter: 2  value: 253.5654 mgc: 0.3013929 ustep: 1 
iter: 3  value: 253.5654 mgc: 0.0005335574 ustep: 1 
iter: 4  mgc: 2.052201e-09 
iter: 1  mgc: 2.052201e-09 
outer mgc:  16.27248 
iter: 1  value: 251.0554 mgc: 6.761657 ustep: 1 
iter: 2  value: 251.041 mgc: 0.4057888 ustep: 1 
iter: 3  value: 251.041 mgc: 0.001298652 ustep: 1 
iter: 4  value: 251.041 mgc: 1.33435e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  13.06443 
iter: 1  value: 249.6451 mgc: 7.176805 ustep: 1 
iter: 2  value: 249.6436 mgc: 0.103381 ustep: 1 
iter: 3  value: 249.6436 mgc: 0.0001249943 ustep: 1 
iter: 4  mgc: 3.166551e-10 
iter: 1  mgc: 3.166551e-10 
outer mgc:  8.427852 
iter: 1  value: 248.7058 mgc: 6.899076 ustep: 1 
iter: 2  value: 248.7051 mgc: 0.1208633 ustep: 1 
iter: 3  value: 248.7051 mgc: 6.619099e-05 ustep: 1 
iter: 4  mgc: 2.200373e-11 
iter: 1  value: 249.5614 mgc: 4.963293 ustep: 1 
iter: 2  value: 249.5607 mgc: 0.120743 ustep: 1 
iter: 3  value: 249.5607 mgc: 8.315068e-05 ustep: 1 
iter: 4  mgc: 3.957634e-11 
iter: 1  value: 249.078 mgc: 2.022401 ustep: 1 
iter: 2  value: 249.0779 mgc: 0.02032624 ustep: 1 
iter: 3  value: 249.0779 mgc: 2.455067e-06 ustep: 1 
iter: 4  mgc: 4.996004e-14 
iter: 1  mgc: 4.996004e-14 
outer mgc:  4.371739 
iter: 1  value: 249.0023 mgc: 2.150346 ustep: 1 
iter: 2  value: 249.0023 mgc: 0.01773526 ustep: 1 
iter: 3  value: 249.0023 mgc: 2.410808e-06 ustep: 1 
iter: 4  mgc: 4.174439e-14 
iter: 1  mgc: 4.174439e-14 
outer mgc:  6.852329 
iter: 1  value: 248.7624 mgc: 1.302022 ustep: 1 
iter: 2  value: 248.7624 mgc: 0.006026767 ustep: 1 
iter: 3  value: 248.7624 mgc: 1.789079e-07 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  1.862066 
iter: 1  value: 248.5747 mgc: 0.2638981 ustep: 1 
iter: 2  value: 248.5747 mgc: 0.0005234948 ustep: 1 
iter: 3  mgc: 1.985829e-09 
iter: 1  value: 248.0826 mgc: 0.8145844 ustep: 1 
iter: 2  value: 248.0826 mgc: 0.004632159 ustep: 1 
iter: 3  value: 248.0826 mgc: 1.427782e-07 ustep: 1 
mgc: 3.708145e-14 
iter: 1  mgc: 3.708145e-14 
outer mgc:  3.531608 
iter: 1  value: 247.5795 mgc: 0.8412256 ustep: 1 
iter: 2  value: 247.5795 mgc: 0.003509369 ustep: 1 
iter: 3  value: 247.5795 mgc: 7.29129e-08 ustep: 1 
iter: 4  mgc: 3.708145e-14 
iter: 1  value: 247.0974 mgc: 1.093124 ustep: 1 
iter: 2  value: 247.0974 mgc: 0.002965292 ustep: 1 
iter: 3  value: 247.0974 mgc: 2.100429e-07 ustep: 1 
iter: 4  mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  5.226646 
iter: 1  value: 245.3394 mgc: 7.878 ustep: 1 
iter: 2  value: 245.3326 mgc: 0.2038837 ustep: 1 
iter: 3  value: 245.3326 mgc: 0.0004150845 ustep: 1 
iter: 4  mgc: 5.958809e-09 
iter: 1  value: 246.3766 mgc: 1.765716 ustep: 1 
iter: 2  value: 246.3765 mgc: 0.01460516 ustep: 1 
iter: 3  value: 246.3765 mgc: 9.231294e-07 ustep: 1 
iter: 4  mgc: 4.085621e-14 
iter: 1  mgc: 4.085621e-14 
outer mgc:  2.724816 
iter: 1  value: 246.1478 mgc: 2.074807 ustep: 1 
iter: 2  value: 246.1477 mgc: 0.01675033 ustep: 1 
iter: 3  value: 246.1477 mgc: 4.645503e-06 ustep: 1 
iter: 4  mgc: 5.315748e-13 
iter: 1  mgc: 5.315748e-13 
outer mgc:  4.311091 
iter: 1  value: 245.8993 mgc: 1.286322 ustep: 1 
iter: 2  value: 245.8993 mgc: 0.003287143 ustep: 1 
iter: 3  value: 245.8993 mgc: 3.798222e-08 ustep: 1 
mgc: 2.531308e-14 
iter: 1  mgc: 2.531308e-14 
outer mgc:  2.017629 
iter: 1  value: 245.3968 mgc: 0.8739629 ustep: 1 
iter: 2  value: 245.3968 mgc: 0.002911642 ustep: 1 
iter: 3  value: 245.3968 mgc: 3.739836e-08 ustep: 1 
mgc: 4.263256e-14 
iter: 1  mgc: 4.263256e-14 
outer mgc:  1.567172 
iter: 1  value: 245.0885 mgc: 0.8641084 ustep: 1 
iter: 2  value: 245.0885 mgc: 0.002475596 ustep: 1 
iter: 3  value: 245.0885 mgc: 2.403113e-08 ustep: 1 
mgc: 2.664535e-14 
iter: 1  mgc: 2.664535e-14 
outer mgc:  1.19939 
iter: 1  value: 244.7493 mgc: 0.786333 ustep: 1 
iter: 2  value: 244.7493 mgc: 0.001362578 ustep: 1 
iter: 3  mgc: 6.419091e-09 
iter: 1  value: 244.9471 mgc: 0.2232032 ustep: 1 
iter: 2  value: 244.9471 mgc: 9.178436e-05 ustep: 1 
iter: 3  mgc: 3.287237e-11 
iter: 1  mgc: 3.287237e-11 
outer mgc:  0.4965244 
iter: 1  value: 244.8904 mgc: 0.3280279 ustep: 1 
iter: 2  value: 244.8904 mgc: 0.0003450882 ustep: 1 
iter: 3  mgc: 3.87733e-10 
iter: 1  value: 244.9221 mgc: 0.1340281 ustep: 1 
iter: 2  value: 244.9221 mgc: 5.785999e-05 ustep: 1 
iter: 3  mgc: 1.098721e-11 
iter: 1  mgc: 1.098721e-11 
outer mgc:  0.4338303 
iter: 1  value: 244.8923 mgc: 0.08243698 ustep: 1 
iter: 2  value: 244.8923 mgc: 2.620751e-05 ustep: 1 
iter: 3  mgc: 2.775558e-12 
iter: 1  mgc: 2.775558e-12 
outer mgc:  0.1031683 
iter: 1  value: 244.8588 mgc: 0.06285018 ustep: 1 
iter: 2  value: 244.8588 mgc: 6.767235e-06 ustep: 1 
iter: 3  mgc: 2.561285e-13 
iter: 1  mgc: 2.561285e-13 
outer mgc:  0.03968066 
iter: 1  value: 244.8361 mgc: 0.04288594 ustep: 1 
iter: 2  value: 244.8361 mgc: 2.881471e-06 ustep: 1 
iter: 3  mgc: 4.884981e-14 
iter: 1  mgc: 4.884981e-14 
outer mgc:  0.0003254442 
iter: 1  value: 244.8356 mgc: 0.0006942513 ustep: 1 
iter: 2  mgc: 1.582088e-09 
iter: 1  mgc: 1.582088e-09 
outer mgc:  3.438609e-05 
iter: 1  mgc: 1.582088e-09 
iter: 1  mgc: 1.582088e-09 
outer mgc:  3.438609e-05 
iter: 1  value: 244.8342 mgc: 0.03076502 ustep: 1 
iter: 2  value: 244.8342 mgc: 2.902423e-06 ustep: 1 
iter: 3  mgc: 4.085621e-14 
outer mgc:  0.2417236 
iter: 1  value: 244.8371 mgc: 0.03074602 ustep: 1 
iter: 2  value: 244.8371 mgc: 2.902246e-06 ustep: 1 
iter: 3  mgc: 3.730349e-14 
outer mgc:  0.2416845 
iter: 1  value: 244.8349 mgc: 0.01693642 ustep: 1 
iter: 2  value: 244.8349 mgc: 9.160293e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.1926057 
iter: 1  value: 244.8364 mgc: 0.01692592 ustep: 1 
iter: 2  value: 244.8364 mgc: 9.154285e-07 ustep: 1 
iter: 3  mgc: 3.397282e-14 
outer mgc:  0.192531 
iter: 1  value: 244.8373 mgc: 0.04725943 ustep: 1 
iter: 2  value: 244.8373 mgc: 3.80725e-06 ustep: 1 
iter: 3  mgc: 1.056932e-13 
outer mgc:  0.2434149 
iter: 1  value: 244.8341 mgc: 0.04726476 ustep: 1 
iter: 2  value: 244.8341 mgc: 3.801887e-06 ustep: 1 
iter: 3  mgc: 1.185718e-13 
outer mgc:  0.2434783 
iter: 1  value: 244.8375 mgc: 0.02170837 ustep: 1 
iter: 2  value: 244.8375 mgc: 7.188313e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
outer mgc:  0.247893 
iter: 1  value: 244.8339 mgc: 0.02171911 ustep: 1 
iter: 2  value: 244.8339 mgc: 7.191538e-07 ustep: 1 
iter: 3  mgc: 3.985701e-14 
outer mgc:  0.2479461 
iter: 1  value: 244.8328 mgc: 0.00386005 ustep: 1 
iter: 2  value: 244.8328 mgc: 4.532917e-08 ustep: 1 
mgc: 4.751755e-14 
outer mgc:  0.001817557 
iter: 1  value: 244.8383 mgc: 0.003858955 ustep: 1 
iter: 2  value: 244.8383 mgc: 4.535534e-08 ustep: 1 
mgc: 4.796163e-14 
outer mgc:  0.001867585 
iter: 1  value: 244.8447 mgc: 0.04199387 ustep: 1 
iter: 2  value: 244.8447 mgc: 5.688708e-06 ustep: 1 
iter: 3  mgc: 1.048051e-13 
outer mgc:  0.1214159 
iter: 1  value: 244.8265 mgc: 0.0421153 ustep: 1 
iter: 2  value: 244.8265 mgc: 5.695402e-06 ustep: 1 
iter: 3  mgc: 1.132427e-13 
outer mgc:  0.1213079 
iter: 1  value: 244.8386 mgc: 0.03860637 ustep: 1 
iter: 2  value: 244.8386 mgc: 4.363664e-06 ustep: 1 
iter: 3  mgc: 5.995204e-14 
outer mgc:  0.1384058 
iter: 1  value: 244.8326 mgc: 0.0387211 ustep: 1 
iter: 2  value: 244.8326 mgc: 4.366438e-06 ustep: 1 
iter: 3  mgc: 6.661338e-14 
outer mgc:  0.1385696 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:41:50 2021]
Finished job 0.
1 of 1 steps (100%) done

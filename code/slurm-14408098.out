Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 80
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 13:32:12 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_100_100_10_3_0.01_ModelfullREDMsinglelambda_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=100, nlambda=100, lmbda=10, d=3, beta_intensity=0.01, model=fullREDMsinglelambda, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_100_100_10_3_0.01_fullREDMsinglelambda_NA_NA_NA_dataset1.RDS --model fullREDMsinglelambda --optimiser nlminb
Model: fullREDMsinglelambda 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_100_100_10_3_0.01_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 22094.191737 
final  value 21657.551666 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE" "log_lambda"
Not matching template order:
[1] "beta"       "logs_sd_RE" "cov_par_RE" "log_lambda" "u_large"   
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 20347.86 mgc: 4.474754 ustep: 0.6827823 
iter: 2  value: 20336.93 mgc: 1.494755 ustep: 0.8263238 
iter: 3  value: 20336.8 mgc: 0.3538999 ustep: 0.9090326 
iter: 4  value: 20336.8 mgc: 0.02681589 ustep: 0.9534367 
iter: 5  value: 20336.8 mgc: 0.000729693 ustep: 0.9764432 
iter: 6  value: 20336.8 mgc: 1.007524e-05 ustep: 0.9881526 
iter: 7  value: 20336.8 mgc: 7.856985e-08 ustep: 0.9940592 
iter: 8  mgc: 3.308055e-10 
iter: 1  mgc: 3.308055e-10 
Matching hessian patterns... Done
outer mgc:  141.6584 
iter: 1  value: 20127.76 mgc: 0.8787608 ustep: 1 
iter: 2  value: 20127.75 mgc: 0.06349545 ustep: 1 
iter: 3  value: 20127.75 mgc: 0.0006036954 ustep: 1 
iter: 4  value: 20127.75 mgc: 9.011007e-08 ustep: 1 
iter: 5  mgc: 4.32987e-15 
iter: 1  value: 19935.42 mgc: 3.687714 ustep: 1 
iter: 2  value: 19935.4 mgc: 0.2695926 ustep: 1 
iter: 3  value: 19935.4 mgc: 0.00119455 ustep: 1 
iter: 4  value: 19935.4 mgc: 2.831768e-08 ustep: 1 
mgc: 1.199041e-14 
iter: 1  mgc: 1.199041e-14 
outer mgc:  130.8431 
iter: 1  value: 20871.56 mgc: 21.13758 ustep: 1 
iter: 2  value: 20870.09 mgc: 1.277033 ustep: 1 
iter: 3  value: 20870.09 mgc: 0.04016934 ustep: 1 
iter: 4  value: 20870.09 mgc: 3.95929e-05 ustep: 1 
iter: 5  mgc: 3.919842e-11 
iter: 1  value: 19912.8 mgc: 5.398534 ustep: 1 
iter: 2  value: 19911.92 mgc: 0.6741787 ustep: 1 
iter: 3  value: 19911.92 mgc: 0.009057021 ustep: 1 
iter: 4  value: 19911.92 mgc: 1.346168e-06 ustep: 1 
iter: 5  mgc: 4.574119e-14 
iter: 1  mgc: 4.574119e-14 
outer mgc:  129.5007 
iter: 1  value: 19896.39 mgc: 4.757944 ustep: 1 
iter: 2  value: 19896.2 mgc: 0.3165317 ustep: 1 
iter: 3  value: 19896.2 mgc: 0.00195382 ustep: 1 
iter: 4  value: 19896.2 mgc: 9.778421e-08 ustep: 1 
iter: 5  mgc: 1.021405e-14 
iter: 1  mgc: 1.021405e-14 
outer mgc:  80.98804 
iter: 1  value: 19886.47 mgc: 6.315164 ustep: 1 
iter: 2  value: 19886.38 mgc: 0.4114941 ustep: 1 
iter: 3  value: 19886.38 mgc: 0.00152578 ustep: 1 
iter: 4  value: 19886.38 mgc: 2.519462e-08 ustep: 1 
mgc: 7.549517e-15 
iter: 1  mgc: 7.549517e-15 
outer mgc:  71.15066 
iter: 1  value: 19848.18 mgc: 9.470116 ustep: 1 
iter: 2  value: 19848.15 mgc: 0.303436 ustep: 1 
iter: 3  value: 19848.15 mgc: 0.0006972858 ustep: 1 
iter: 4  mgc: 3.178129e-09 
iter: 1  mgc: 3.178129e-09 
outer mgc:  13.27284 
iter: 1  value: 19828.53 mgc: 8.95458 ustep: 1 
iter: 2  value: 19828.51 mgc: 0.3320276 ustep: 1 
iter: 3  value: 19828.51 mgc: 0.0005541239 ustep: 1 
iter: 4  mgc: 4.521294e-09 
iter: 1  value: 19841.31 mgc: 2.82285 ustep: 1 
iter: 2  value: 19841.31 mgc: 0.02475751 ustep: 1 
iter: 3  value: 19841.31 mgc: 4.001934e-06 ustep: 1 
iter: 4  mgc: 1.403322e-13 
iter: 1  mgc: 1.403322e-13 
outer mgc:  18.27106 
iter: 1  value: 19845.32 mgc: 2.07958 ustep: 1 
iter: 2  value: 19845.32 mgc: 0.01569747 ustep: 1 
iter: 3  value: 19845.32 mgc: 1.500741e-06 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  value: 19840.59 mgc: 0.377453 ustep: 1 
iter: 2  value: 19840.59 mgc: 0.0003133952 ustep: 1 
iter: 3  mgc: 1.361128e-09 
iter: 1  mgc: 1.361128e-09 
outer mgc:  4.911871 
iter: 1  value: 19840.45 mgc: 0.4192977 ustep: 1 
iter: 2  value: 19840.45 mgc: 0.0005432405 ustep: 1 
iter: 3  mgc: 3.970698e-09 
iter: 1  mgc: 3.970698e-09 
outer mgc:  7.237533 
iter: 1  value: 19840.26 mgc: 0.3641691 ustep: 1 
iter: 2  value: 19840.26 mgc: 0.001067786 ustep: 1 
iter: 3  value: 19840.26 mgc: 2.657741e-08 ustep: 1 
mgc: 6.661338e-15 
iter: 1  mgc: 6.661338e-15 
outer mgc:  5.941723 
iter: 1  value: 19840.08 mgc: 0.3743168 ustep: 1 
iter: 2  value: 19840.08 mgc: 0.000785533 ustep: 1 
iter: 3  mgc: 4.957429e-09 
iter: 1  mgc: 4.957429e-09 
outer mgc:  3.494425 
iter: 1  value: 19836.74 mgc: 0.3945727 ustep: 1 
iter: 2  value: 19836.74 mgc: 0.0006448392 ustep: 1 
iter: 3  mgc: 6.669811e-09 
iter: 1  mgc: 6.669811e-09 
outer mgc:  1.877353 
iter: 1  value: 19836.79 mgc: 0.4433033 ustep: 1 
iter: 2  value: 19836.79 mgc: 0.00138158 ustep: 1 
iter: 3  value: 19836.79 mgc: 1.25326e-08 ustep: 1 
mgc: 9.325873e-15 
iter: 1  mgc: 9.325873e-15 
outer mgc:  3.73734 
iter: 1  value: 19833.28 mgc: 0.9064738 ustep: 1 
iter: 2  value: 19833.28 mgc: 0.002278648 ustep: 1 
iter: 3  value: 19833.28 mgc: 4.201246e-08 ustep: 1 
iter: 4  mgc: 8.104628e-15 
iter: 1  value: 19835.57 mgc: 0.3595913 ustep: 1 
iter: 2  value: 19835.57 mgc: 0.0003247834 ustep: 1 
iter: 3  mgc: 3.592458e-09 
iter: 1  value: 19836.28 mgc: 0.1293623 ustep: 1 
iter: 2  value: 19836.28 mgc: 4.20753e-05 ustep: 1 
iter: 3  mgc: 6.521494e-11 
iter: 1  mgc: 6.521494e-11 
outer mgc:  1.988747 
iter: 1  value: 19835.83 mgc: 0.1044619 ustep: 1 
iter: 2  value: 19835.83 mgc: 4.874124e-05 ustep: 1 
iter: 3  mgc: 1.963452e-11 
iter: 1  mgc: 1.963452e-11 
outer mgc:  2.662645 
iter: 1  value: 19834.76 mgc: 0.2566818 ustep: 1 
iter: 2  value: 19834.76 mgc: 0.0001945156 ustep: 1 
iter: 3  mgc: 3.520859e-10 
iter: 1  mgc: 3.520859e-10 
outer mgc:  2.176919 
iter: 1  value: 19834.03 mgc: 0.1284586 ustep: 1 
iter: 2  value: 19834.03 mgc: 5.155885e-05 ustep: 1 
iter: 3  mgc: 2.092815e-11 
iter: 1  mgc: 2.092815e-11 
outer mgc:  1.586533 
iter: 1  value: 19832.85 mgc: 0.2354521 ustep: 1 
iter: 2  value: 19832.85 mgc: 0.0002835968 ustep: 1 
iter: 3  mgc: 9.035346e-10 
iter: 1  mgc: 9.035346e-10 
outer mgc:  3.441013 
iter: 1  value: 19831.5 mgc: 0.2112979 ustep: 1 
iter: 2  value: 19831.5 mgc: 0.0001059282 ustep: 1 
iter: 3  mgc: 2.063638e-10 
iter: 1  mgc: 2.063638e-10 
outer mgc:  1.350183 
iter: 1  value: 19829.76 mgc: 0.2855281 ustep: 1 
iter: 2  value: 19829.76 mgc: 0.0002121233 ustep: 1 
iter: 3  mgc: 8.358931e-10 
iter: 1  mgc: 8.358931e-10 
outer mgc:  3.224014 
iter: 1  value: 19828.64 mgc: 0.3022105 ustep: 1 
iter: 2  value: 19828.64 mgc: 0.0001541235 ustep: 1 
iter: 3  mgc: 3.686735e-10 
iter: 1  mgc: 3.686735e-10 
outer mgc:  1.891267 
iter: 1  value: 19827.54 mgc: 0.2047034 ustep: 1 
iter: 2  value: 19827.54 mgc: 5.492342e-05 ustep: 1 
iter: 3  mgc: 3.648459e-11 
iter: 1  mgc: 3.648459e-11 
outer mgc:  3.122004 
iter: 1  value: 19826.58 mgc: 0.195657 ustep: 1 
iter: 2  value: 19826.58 mgc: 8.773118e-05 ustep: 1 
iter: 3  mgc: 8.572076e-11 
iter: 1  mgc: 8.572076e-11 
outer mgc:  0.9758821 
iter: 1  value: 19824.55 mgc: 0.2791783 ustep: 1 
iter: 2  value: 19824.55 mgc: 0.0003279944 ustep: 1 
iter: 3  mgc: 9.051009e-10 
iter: 1  value: 19822.33 mgc: 0.320707 ustep: 1 
iter: 2  value: 19822.33 mgc: 0.000274671 ustep: 1 
iter: 3  mgc: 5.311582e-10 
iter: 1  mgc: 5.311582e-10 
outer mgc:  1.504526 
iter: 1  value: 19820.78 mgc: 0.5868788 ustep: 1 
iter: 2  value: 19820.78 mgc: 0.0008145838 ustep: 1 
iter: 3  value: 19820.78 mgc: 1.066797e-08 ustep: 1 
mgc: 8.945102e-15 
iter: 1  mgc: 8.945102e-15 
outer mgc:  2.639991 
iter: 1  value: 19820.03 mgc: 0.5517601 ustep: 1 
iter: 2  value: 19820.03 mgc: 0.001010784 ustep: 1 
iter: 3  mgc: 6.060831e-09 
iter: 1  mgc: 6.060831e-09 
outer mgc:  1.467346 
iter: 1  value: 19816.08 mgc: 0.553238 ustep: 1 
iter: 2  value: 19816.08 mgc: 0.001089951 ustep: 1 
iter: 3  mgc: 4.903846e-09 
iter: 1  mgc: 4.903846e-09 
outer mgc:  2.974706 
iter: 1  value: 19813.14 mgc: 0.4679013 ustep: 1 
iter: 2  value: 19813.14 mgc: 0.0005788572 ustep: 1 
iter: 3  mgc: 2.590816e-09 
iter: 1  value: 19810.13 mgc: 0.4602693 ustep: 1 
iter: 2  value: 19810.13 mgc: 0.00053064 ustep: 1 
iter: 3  mgc: 1.705739e-09 
iter: 1  mgc: 1.705739e-09 
outer mgc:  1.659699 
iter: 1  value: 19803.28 mgc: 0.7310212 ustep: 1 
iter: 2  value: 19803.28 mgc: 0.0004715218 ustep: 1 
iter: 3  mgc: 2.664576e-09 
iter: 1  mgc: 2.664576e-09 
outer mgc:  1.631345 
iter: 1  value: 19798.96 mgc: 0.7497636 ustep: 1 
iter: 2  value: 19798.96 mgc: 0.0006669015 ustep: 1 
iter: 3  mgc: 3.902533e-09 
iter: 1  mgc: 3.902533e-09 
outer mgc:  0.9739581 
iter: 1  value: 19793.25 mgc: 0.6341362 ustep: 1 
iter: 2  value: 19793.25 mgc: 0.0006553165 ustep: 1 
iter: 3  mgc: 2.690591e-09 
iter: 1  value: 19796.11 mgc: 0.3174091 ustep: 1 
iter: 2  value: 19796.11 mgc: 0.0001790843 ustep: 1 
iter: 3  mgc: 2.198792e-10 
iter: 1  mgc: 2.198792e-10 
outer mgc:  1.308872 
iter: 1  value: 19793.33 mgc: 0.3810362 ustep: 1 
iter: 2  value: 19793.33 mgc: 0.0001331154 ustep: 1 
iter: 3  mgc: 6.443202e-11 
iter: 1  mgc: 6.443202e-11 
outer mgc:  0.3284919 
iter: 1  value: 19791.17 mgc: 0.3394173 ustep: 1 
iter: 2  value: 19791.17 mgc: 0.0001216316 ustep: 1 
iter: 3  mgc: 9.940937e-11 
iter: 1  value: 19787.11 mgc: 0.6609194 ustep: 1 
iter: 2  value: 19787.11 mgc: 0.0003933321 ustep: 1 
iter: 3  mgc: 9.67745e-10 
iter: 1  mgc: 9.67745e-10 
outer mgc:  0.9354062 
iter: 1  value: 19779.83 mgc: 0.8254178 ustep: 1 
iter: 2  value: 19779.83 mgc: 0.0003714495 ustep: 1 
iter: 3  mgc: 9.378542e-10 
iter: 1  value: 19772.55 mgc: 0.8425913 ustep: 1 
iter: 2  value: 19772.55 mgc: 0.0002685406 ustep: 1 
iter: 3  mgc: 4.515943e-10 
iter: 1  mgc: 4.515943e-10 
outer mgc:  1.145633 
iter: 1  value: 19765.7 mgc: 0.950094 ustep: 1 
iter: 2  value: 19765.7 mgc: 0.0003515362 ustep: 1 
iter: 3  mgc: 6.333183e-10 
iter: 1  mgc: 6.333183e-10 
outer mgc:  0.3736033 
iter: 1  value: 19759.26 mgc: 0.8277477 ustep: 1 
iter: 2  value: 19759.26 mgc: 0.0001954817 ustep: 1 
iter: 3  mgc: 2.029656e-10 
iter: 1  mgc: 2.029656e-10 
outer mgc:  0.1656639 
iter: 1  value: 19750.45 mgc: 1.099748 ustep: 1 
iter: 2  value: 19750.45 mgc: 0.000239968 ustep: 1 
iter: 3  mgc: 2.944072e-10 
iter: 1  mgc: 2.944072e-10 
outer mgc:  0.07531524 
iter: 1  value: 19743.97 mgc: 0.760927 ustep: 1 
iter: 2  value: 19743.97 mgc: 8.413138e-05 ustep: 1 
iter: 3  mgc: 3.759659e-11 
iter: 1  mgc: 3.759659e-11 
outer mgc:  0.03548364 
iter: 1  value: 19738.86 mgc: 0.6000503 ustep: 1 
iter: 2  value: 19738.86 mgc: 4.491634e-05 ustep: 1 
iter: 3  mgc: 9.732659e-12 
iter: 1  mgc: 9.732659e-12 
outer mgc:  0.03001407 
iter: 1  value: 19735.82 mgc: 0.3520391 ustep: 1 
iter: 2  value: 19735.82 mgc: 1.338334e-05 ustep: 1 
iter: 3  mgc: 8.952838e-13 
iter: 1  mgc: 8.952838e-13 
outer mgc:  0.005284838 
iter: 1  value: 19734.5 mgc: 0.1516448 ustep: 1 
iter: 2  value: 19734.5 mgc: 2.442144e-06 ustep: 1 
iter: 3  mgc: 4.238276e-14 
iter: 1  mgc: 4.238276e-14 
outer mgc:  0.003255609 
iter: 1  value: 19734.21 mgc: 0.03209519 ustep: 1 
iter: 2  value: 19734.21 mgc: 1.002841e-07 ustep: 1 
iter: 3  mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  0.0004808755 
iter: 1  mgc: 3.952394e-14 
iter: 1  mgc: 3.952394e-14 
outer mgc:  0.0004808755 
iter: 1  value: 19734.22 mgc: 0.006359488 ustep: 1 
iter: 2  value: 19734.22 mgc: 1.462232e-07 ustep: 1 
iter: 3  mgc: 4.396483e-14 
outer mgc:  0.392644 
iter: 1  value: 19734.21 mgc: 0.006356583 ustep: 1 
iter: 2  value: 19734.21 mgc: 1.461271e-07 ustep: 1 
iter: 3  mgc: 4.440892e-14 
outer mgc:  0.3920083 
iter: 1  value: 19734.21 mgc: 0.003512343 ustep: 1 
iter: 2  value: 19734.21 mgc: 4.864207e-08 ustep: 1 
iter: 3  mgc: 4.019007e-14 
outer mgc:  0.1993587 
iter: 1  value: 19734.22 mgc: 0.00351126 ustep: 1 
iter: 2  value: 19734.22 mgc: 4.860314e-08 ustep: 1 
iter: 3  mgc: 3.58602e-14 
outer mgc:  0.1990244 
iter: 1  value: 19734.22 mgc: 0.006523404 ustep: 1 
iter: 2  value: 19734.22 mgc: 2.906605e-07 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.4450721 
iter: 1  value: 19734.21 mgc: 0.00652329 ustep: 1 
iter: 2  value: 19734.21 mgc: 2.896359e-07 ustep: 1 
iter: 3  mgc: 4.884981e-14 
outer mgc:  0.445279 
iter: 1  value: 19734.22 mgc: 0.003522073 ustep: 1 
iter: 2  value: 19734.22 mgc: 9.747722e-08 ustep: 1 
iter: 3  mgc: 5.395684e-14 
outer mgc:  0.2419542 
iter: 1  value: 19734.21 mgc: 0.003521153 ustep: 1 
iter: 2  value: 19734.21 mgc: 9.7271e-08 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.2421406 
iter: 1  value: 19734.29 mgc: 0.1499138 ustep: 1 
iter: 2  value: 19734.29 mgc: 2.143082e-06 ustep: 1 
iter: 3  mgc: 2.953193e-14 
outer mgc:  0.07981719 
iter: 1  value: 19734.14 mgc: 0.1500638 ustep: 1 
iter: 2  value: 19734.14 mgc: 2.136029e-06 ustep: 1 
iter: 3  mgc: 7.149836e-14 
outer mgc:  0.07955963 
iter: 1  value: 19734.28 mgc: 0.1520359 ustep: 1 
iter: 2  value: 19734.28 mgc: 1.244758e-06 ustep: 1 
iter: 3  mgc: 4.307665e-14 
outer mgc:  0.09018115 
iter: 1  value: 19734.15 mgc: 0.1524905 ustep: 1 
iter: 2  value: 19734.15 mgc: 1.243916e-06 ustep: 1 
iter: 3  mgc: 4.107825e-14 
outer mgc:  0.08995101 
iter: 1  value: 19734.2 mgc: 0.001605824 ustep: 1 
iter: 2  mgc: 2.274598e-10 
outer mgc:  0.0008224333 
iter: 1  value: 19734.23 mgc: 0.00160558 ustep: 1 
iter: 2  mgc: 2.276543e-10 
outer mgc:  0.0002243359 
iter: 1  value: 19734.19 mgc: 0.005238919 ustep: 1 
iter: 2  value: 19734.19 mgc: 1.488078e-07 ustep: 1 
iter: 3  mgc: 4.185541e-14 
outer mgc:  0.1336313 
iter: 1  value: 19734.24 mgc: 0.005234894 ustep: 1 
iter: 2  value: 19734.24 mgc: 1.486703e-07 ustep: 1 
iter: 3  mgc: 5.22915e-14 
outer mgc:  0.1326385 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 13:32:17 2021]
Finished job 0.
1 of 1 steps (100%) done

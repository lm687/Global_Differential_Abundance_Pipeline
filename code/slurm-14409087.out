Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:34:48 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_2_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_3_2_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=3, beta_intensity=2, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_2_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_3_2_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_2_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_2_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_3_2_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 2226.887109 
iter  10 value 1470.838789
iter  10 value 1470.838789
final  value 1470.838789 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 2184.009 mgc: 163.7869 ustep: 1 
iter: 2  value: 1160.832 mgc: 66.74289 ustep: 0.0692153 
iter: 3  value: 568.312 mgc: 111.9246 ustep: 0.2631617 
iter: 4  value: 536.0991 mgc: 22.89268 ustep: 0.5130416 
iter: 5  value: 535.4817 mgc: 3.323952 ustep: 0.7162976 
iter: 6  value: 535.441 mgc: 0.1306527 ustep: 0.846359 
iter: 7  value: 535.438 mgc: 0.03951265 ustep: 0.9199857 
iter: 8  value: 535.4379 mgc: 0.00578098 ustep: 0.959163 
iter: 9  value: 535.4379 mgc: 0.0004623514 ustep: 0.9793707 
iter: 10  value: 535.4379 mgc: 2.051381e-05 ustep: 0.9896326 
iter: 11  value: 535.4379 mgc: 4.759669e-07 ustep: 0.9948033 
iter: 12  mgc: 5.600864e-09 
iter: 1  mgc: 5.600864e-09 
Matching hessian patterns... Done
outer mgc:  254.2412 
iter: 1  value: 315.1096 mgc: 29.82185 ustep: 1 
iter: 2  value: 291.4813 mgc: 18.73787 ustep: 1 
iter: 3  value: 291.2733 mgc: 1.873583 ustep: 1 
iter: 4  value: 291.2732 mgc: 0.03269301 ustep: 1 
iter: 5  value: 291.2732 mgc: 1.614261e-05 ustep: 1 
iter: 6  mgc: 3.93463e-12 
iter: 1  value: 217.3493 mgc: 30.2611 ustep: 1 
iter: 2  value: 204.6095 mgc: 13.08811 ustep: 1 
iter: 3  value: 204.5575 mgc: 0.8889339 ustep: 1 
iter: 4  value: 204.5575 mgc: 0.006748129 ustep: 1 
iter: 5  value: 204.5575 mgc: 4.009758e-07 ustep: 1 
iter: 6  mgc: 5.515033e-14 
iter: 1  mgc: 5.515033e-14 
outer mgc:  50.65094 
iter: 1  value: 159.9829 mgc: 15.64755 ustep: 1 
iter: 2  value: 158.9145 mgc: 2.641143 ustep: 1 
iter: 3  value: 158.9102 mgc: 0.1025036 ustep: 1 
iter: 4  value: 158.9102 mgc: 0.001143312 ustep: 1 
iter: 5  value: 158.9102 mgc: 4.100503e-07 ustep: 1 
iter: 6  mgc: 4.415912e-14 
iter: 1  mgc: 4.415912e-14 
outer mgc:  27.78543 
iter: 1  value: 293.9231 mgc: 40.00338 ustep: 1 
iter: 2  value: 245.4872 mgc: 38.77012 ustep: 1 
iter: 3  value: 241.5573 mgc: 7.94131 ustep: 1 
iter: 4  value: 241.4502 mgc: 1.350585 ustep: 1 
iter: 5  value: 241.4501 mgc: 0.04982583 ustep: 1 
iter: 6  value: 241.4501 mgc: 8.24247e-05 ustep: 1 
iter: 7  mgc: 2.211014e-10 
iter: 1  value: 155.8359 mgc: 8.52301 ustep: 1 
iter: 2  value: 155.8037 mgc: 0.5791157 ustep: 1 
iter: 3  value: 155.8037 mgc: 0.002869509 ustep: 1 
iter: 4  value: 155.8037 mgc: 7.942079e-08 ustep: 1 
mgc: 3.987088e-14 
iter: 1  mgc: 3.987088e-14 
outer mgc:  16.50126 
iter: 1  value: 152.447 mgc: 1.339179 ustep: 1 
iter: 2  value: 152.4469 mgc: 0.01817116 ustep: 1 
iter: 3  value: 152.4469 mgc: 1.521994e-05 ustep: 1 
iter: 4  mgc: 9.435482e-11 
iter: 1  mgc: 9.435482e-11 
outer mgc:  5.522379 
iter: 1  value: 151.3069 mgc: 14.29194 ustep: 1 
iter: 2  value: 151.022 mgc: 1.640936 ustep: 1 
iter: 3  value: 151.0219 mgc: 0.02291473 ustep: 1 
iter: 4  value: 151.0219 mgc: 7.816517e-06 ustep: 1 
iter: 5  mgc: 9.334755e-13 
iter: 1  mgc: 9.334755e-13 
outer mgc:  12.41142 
iter: 1  value: 153.6884 mgc: 27.01107 ustep: 1 
iter: 2  value: 146.2167 mgc: 8.842067 ustep: 1 
iter: 3  value: 146.1927 mgc: 0.6628994 ustep: 1 
iter: 4  value: 146.1927 mgc: 0.00650727 ustep: 1 
iter: 5  value: 146.1927 mgc: 7.157737e-07 ustep: 1 
iter: 6  mgc: 2.881029e-14 
iter: 1  value: 255.4682 mgc: 42.83307 ustep: 1 
iter: 2  value: 158.8683 mgc: 35.33243 ustep: 1 
iter: 3  value: 157.0626 mgc: 5.654231 ustep: 1 
iter: 4  value: 157.0489 mgc: 0.4664206 ustep: 1 
iter: 5  value: 157.0488 mgc: 0.007925099 ustep: 1 
iter: 6  value: 157.0488 mgc: 4.926654e-06 ustep: 1 
iter: 7  mgc: 2.439826e-12 
iter: 1  mgc: 2.881029e-14 
outer mgc:  8.534947 
iter: 1  value: 159.2026 mgc: 7.919461 ustep: 1 
iter: 2  value: 159.1858 mgc: 0.4461398 ustep: 1 
iter: 3  value: 159.1858 mgc: 0.003871884 ustep: 1 
iter: 4  value: 159.1858 mgc: 3.343714e-06 ustep: 1 
iter: 5  mgc: 2.498002e-12 
iter: 1  value: 145.3587 mgc: 1.46217 ustep: 1 
iter: 2  value: 145.3586 mgc: 0.01774051 ustep: 1 
iter: 3  value: 145.3586 mgc: 2.049605e-05 ustep: 1 
iter: 4  mgc: 1.210716e-10 
iter: 1  mgc: 1.210716e-10 
outer mgc:  5.108833 
iter: 1  value: 144.7788 mgc: 5.365168 ustep: 1 
iter: 2  value: 144.7758 mgc: 0.1776849 ustep: 1 
iter: 3  value: 144.7758 mgc: 0.0002650057 ustep: 1 
iter: 4  mgc: 9.865229e-10 
iter: 1  mgc: 9.865229e-10 
outer mgc:  6.285496 
iter: 1  value: 142.9415 mgc: 8.276063 ustep: 1 
iter: 2  value: 142.9242 mgc: 0.464843 ustep: 1 
iter: 3  value: 142.9242 mgc: 0.002920541 ustep: 1 
iter: 4  value: 142.9242 mgc: 1.177549e-07 ustep: 1 
mgc: 3.130829e-14 
iter: 1  value: 141.0333 mgc: 13.95961 ustep: 1 
iter: 2  value: 140.8525 mgc: 1.452867 ustep: 1 
iter: 3  value: 140.8525 mgc: 0.02181484 ustep: 1 
iter: 4  value: 140.8525 mgc: 6.271966e-06 ustep: 1 
iter: 5  mgc: 5.223877e-13 
iter: 1  value: 262.9732 mgc: 47.70379 ustep: 1 
iter: 2  value: 157.6754 mgc: 41.27779 ustep: 1 
iter: 3  value: 155.779 mgc: 6.189453 ustep: 1 
iter: 4  value: 155.7751 mgc: 0.3836992 ustep: 1 
iter: 5  value: 155.7751 mgc: 0.00178965 ustep: 1 
iter: 6  value: 155.7751 mgc: 4.007414e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  mgc: 5.223877e-13 
outer mgc:  3.828922 
iter: 1  value: 139.1796 mgc: 16.72941 ustep: 1 
iter: 2  value: 139.014 mgc: 1.269844 ustep: 1 
iter: 3  value: 139.0139 mgc: 0.01791664 ustep: 1 
iter: 4  value: 139.0139 mgc: 1.479813e-05 ustep: 1 
iter: 5  mgc: 3.674638e-11 
iter: 1  mgc: 3.674638e-11 
outer mgc:  16.48176 
iter: 1  value: 134.4615 mgc: 6.93664 ustep: 1 
iter: 2  value: 134.4318 mgc: 0.4691345 ustep: 1 
iter: 3  value: 134.4318 mgc: 0.00186622 ustep: 1 
iter: 4  value: 134.4318 mgc: 4.806919e-07 ustep: 1 
iter: 5  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  5.198591 
iter: 1  value: 132.4253 mgc: 8.735414 ustep: 1 
iter: 2  value: 132.38 mgc: 0.46648 ustep: 1 
iter: 3  value: 132.38 mgc: 0.00391823 ustep: 1 
iter: 4  value: 132.38 mgc: 2.117119e-06 ustep: 1 
iter: 5  mgc: 6.603607e-13 
iter: 1  mgc: 6.603607e-13 
outer mgc:  7.757333 
iter: 1  value: 133.0778 mgc: 14.69044 ustep: 1 
iter: 2  value: 132.908 mgc: 1.001985 ustep: 1 
iter: 3  value: 132.908 mgc: 0.01258861 ustep: 1 
iter: 4  value: 132.908 mgc: 4.880368e-06 ustep: 1 
iter: 5  mgc: 1.884368e-12 
iter: 1  value: 132.5788 mgc: 9.859135 ustep: 1 
iter: 2  value: 132.5633 mgc: 0.5693845 ustep: 1 
iter: 3  value: 132.5633 mgc: 0.002619815 ustep: 1 
iter: 4  value: 132.5633 mgc: 1.037661e-07 ustep: 1 
iter: 5  mgc: 4.041212e-14 
iter: 1  mgc: 4.041212e-14 
outer mgc:  9.431497 
iter: 1  value: 131.5383 mgc: 4.051282 ustep: 1 
iter: 2  value: 131.5363 mgc: 0.08684966 ustep: 1 
iter: 3  value: 131.5363 mgc: 0.000209943 ustep: 1 
iter: 4  mgc: 2.839035e-09 
iter: 1  mgc: 2.839035e-09 
outer mgc:  4.036328 
iter: 1  value: 131.6131 mgc: 6.308441 ustep: 1 
iter: 2  value: 131.6117 mgc: 0.1066987 ustep: 1 
iter: 3  value: 131.6117 mgc: 0.0002306256 ustep: 1 
iter: 4  value: 131.6117 mgc: 1.109935e-08 ustep: 1 
iter: 5  mgc: 1.998401e-14 
iter: 1  mgc: 1.998401e-14 
outer mgc:  5.716379 
iter: 1  value: 130.807 mgc: 4.487641 ustep: 1 
iter: 2  value: 130.8065 mgc: 0.04818691 ustep: 1 
iter: 3  value: 130.8065 mgc: 5.762203e-05 ustep: 1 
iter: 4  mgc: 7.287344e-10 
iter: 1  mgc: 7.287344e-10 
outer mgc:  2.133803 
iter: 1  value: 130.1217 mgc: 3.099789 ustep: 1 
iter: 2  value: 130.1208 mgc: 0.06342915 ustep: 1 
iter: 3  value: 130.1208 mgc: 9.818525e-05 ustep: 1 
iter: 4  mgc: 3.708625e-10 
iter: 1  value: 129.6046 mgc: 3.637589 ustep: 1 
iter: 2  value: 129.6023 mgc: 0.101171 ustep: 1 
iter: 3  value: 129.6023 mgc: 0.000238145 ustep: 1 
iter: 4  mgc: 2.19319e-09 
iter: 1  mgc: 2.19319e-09 
outer mgc:  5.082396 
iter: 1  value: 130.0175 mgc: 1.490664 ustep: 1 
iter: 2  value: 130.0143 mgc: 0.07335961 ustep: 1 
iter: 3  value: 130.0143 mgc: 0.00148423 ustep: 1 
iter: 4  value: 130.0143 mgc: 7.472769e-07 ustep: 1 
iter: 5  mgc: 2.158274e-13 
iter: 1  mgc: 2.158274e-13 
outer mgc:  3.792426 
iter: 1  value: 128.399 mgc: 13.79327 ustep: 1 
iter: 2  value: 128.3901 mgc: 0.3579384 ustep: 1 
iter: 3  value: 128.3901 mgc: 0.002900838 ustep: 1 
iter: 4  value: 128.3901 mgc: 1.132149e-06 ustep: 1 
iter: 5  mgc: 2.069456e-13 
iter: 1  value: 129.1569 mgc: 4.160227 ustep: 1 
iter: 2  value: 129.1568 mgc: 0.04768934 ustep: 1 
iter: 3  value: 129.1568 mgc: 4.014765e-05 ustep: 1 
iter: 4  mgc: 3.021343e-10 
iter: 1  mgc: 3.021343e-10 
outer mgc:  7.275952 
iter: 1  value: 128.626 mgc: 3.57854 ustep: 1 
iter: 2  value: 128.6259 mgc: 0.04658545 ustep: 1 
iter: 3  value: 128.6259 mgc: 1.927188e-05 ustep: 1 
iter: 4  mgc: 1.004219e-10 
iter: 1  mgc: 1.004219e-10 
outer mgc:  3.979184 
iter: 1  value: 128.4536 mgc: 1.50107 ustep: 1 
iter: 2  value: 128.4536 mgc: 0.00377606 ustep: 1 
iter: 3  value: 128.4536 mgc: 2.609424e-06 ustep: 1 
iter: 4  mgc: 1.731948e-12 
iter: 1  mgc: 1.731948e-12 
outer mgc:  0.8444483 
iter: 1  value: 128.4416 mgc: 0.7718582 ustep: 1 
iter: 2  value: 128.4416 mgc: 0.00515353 ustep: 1 
iter: 3  value: 128.4416 mgc: 5.662039e-07 ustep: 1 
iter: 4  mgc: 5.062617e-14 
iter: 1  mgc: 5.062617e-14 
outer mgc:  0.8086386 
iter: 1  value: 128.3227 mgc: 0.4550968 ustep: 1 
iter: 2  value: 128.3227 mgc: 0.0006687311 ustep: 1 
iter: 3  value: 128.3227 mgc: 2.773696e-08 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  0.530033 
iter: 1  value: 128.1487 mgc: 0.6688527 ustep: 1 
iter: 2  value: 128.1487 mgc: 0.001073226 ustep: 1 
iter: 3  value: 128.1487 mgc: 4.305398e-08 ustep: 1 
iter: 4  mgc: 2.398082e-14 
iter: 1  mgc: 2.398082e-14 
outer mgc:  0.01696526 
iter: 1  value: 128.1035 mgc: 0.1861823 ustep: 1 
iter: 2  value: 128.1035 mgc: 6.946571e-05 ustep: 1 
iter: 3  mgc: 1.313447e-10 
iter: 1  mgc: 1.313447e-10 
outer mgc:  0.01447861 
iter: 1  value: 128.0977 mgc: 0.02221918 ustep: 1 
iter: 2  value: 128.0977 mgc: 1.232918e-06 ustep: 1 
iter: 3  mgc: 5.151435e-14 
iter: 1  mgc: 5.151435e-14 
outer mgc:  0.002690266 
iter: 1  value: 128.0975 mgc: 0.001759475 ustep: 1 
iter: 2  mgc: 7.476766e-09 
iter: 1  mgc: 7.476766e-09 
outer mgc:  0.0004744241 
iter: 1  value: 128.0975 mgc: 0.0002144919 ustep: 1 
iter: 2  mgc: 1.2224e-10 
iter: 1  mgc: 1.2224e-10 
outer mgc:  1.309212e-05 
iter: 1  value: 128.0975 mgc: 6.486666e-06 ustep: 1 
iter: 2  mgc: 2.23821e-13 
iter: 1  mgc: 2.23821e-13 
outer mgc:  1.591947e-06 
iter: 1  value: 128.0975 mgc: 2.669809e-06 ustep: 1 
iter: 2  mgc: 6.683543e-14 
iter: 1  mgc: 6.683543e-14 
outer mgc:  1.803191e-07 
iter: 1  value: 128.0975 mgc: 1.389283e-06 ustep: 1 
iter: 2  mgc: 4.707346e-14 
iter: 1  mgc: 4.707346e-14 
outer mgc:  8.159028e-08 
iter: 1  value: 128.0975 mgc: 1.252792e-07 ustep: 1 
iter: 2  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  8.167886e-09 
iter: 1  mgc: 7.247562e-09 
iter: 1  mgc: 3.552714e-14 
iter: 1  mgc: 3.552714e-14 
outer mgc:  8.167886e-09 
iter: 1  value: 128.0981 mgc: 0.03787557 ustep: 1 
iter: 2  value: 128.0981 mgc: 3.114213e-06 ustep: 1 
iter: 3  mgc: 8.171241e-14 
outer mgc:  0.152876 
iter: 1  value: 128.097 mgc: 0.03785746 ustep: 1 
iter: 2  value: 128.097 mgc: 3.116144e-06 ustep: 1 
iter: 3  mgc: 8.970602e-14 
outer mgc:  0.1528586 
iter: 1  value: 128.0976 mgc: 0.0159007 ustep: 1 
iter: 2  value: 128.0976 mgc: 5.777452e-07 ustep: 1 
iter: 3  mgc: 3.93019e-14 
outer mgc:  0.1061461 
iter: 1  value: 128.0975 mgc: 0.01589079 ustep: 1 
iter: 2  value: 128.0975 mgc: 5.772382e-07 ustep: 1 
iter: 3  mgc: 2.409184e-14 
outer mgc:  0.1061059 
iter: 1  value: 128.0973 mgc: 0.04462814 ustep: 1 
iter: 2  value: 128.0973 mgc: 4.393232e-06 ustep: 1 
iter: 3  mgc: 3.259615e-13 
outer mgc:  0.139436 
iter: 1  value: 128.0978 mgc: 0.0446293 ustep: 1 
iter: 2  value: 128.0978 mgc: 4.390089e-06 ustep: 1 
iter: 3  mgc: 2.922107e-13 
outer mgc:  0.1394514 
iter: 1  value: 128.0977 mgc: 0.01883266 ustep: 1 
iter: 2  value: 128.0977 mgc: 6.204375e-07 ustep: 1 
iter: 3  mgc: 2.4869e-14 
outer mgc:  0.1138433 
iter: 1  value: 128.0974 mgc: 0.01884068 ustep: 1 
iter: 2  value: 128.0974 mgc: 6.209879e-07 ustep: 1 
iter: 3  mgc: 4.618528e-14 
outer mgc:  0.1138822 
iter: 1  value: 128.0969 mgc: 0.00209352 ustep: 1 
iter: 2  mgc: 8.925067e-09 
outer mgc:  0.0009834217 
iter: 1  value: 128.0981 mgc: 0.002093278 ustep: 1 
iter: 2  mgc: 8.926763e-09 
outer mgc:  0.0009834558 
iter: 1  value: 128.1062 mgc: 0.07321141 ustep: 1 
iter: 2  value: 128.1062 mgc: 2.511688e-05 ustep: 1 
iter: 3  mgc: 1.088178e-10 
outer mgc:  0.2859363 
iter: 1  value: 128.089 mgc: 0.07344354 ustep: 1 
iter: 2  value: 128.089 mgc: 2.521725e-05 ustep: 1 
iter: 3  mgc: 1.092832e-10 
outer mgc:  0.28555 
iter: 1  value: 128.0957 mgc: 0.08543869 ustep: 1 
iter: 2  value: 128.0957 mgc: 2.845189e-05 ustep: 1 
iter: 3  mgc: 4.985168e-11 
outer mgc:  0.3095069 
iter: 1  value: 128.0996 mgc: 0.08552417 ustep: 1 
iter: 2  value: 128.0996 mgc: 2.868351e-05 ustep: 1 
iter: 3  mgc: 4.967582e-11 
outer mgc:  0.3100451 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:34:50 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 14:53:05 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0_NA_NA_NA_dataset1.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_50_100_80_3_0_ModelfullREM_NA_NA_NA_dataset1.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=50, nlambda=100, lmbda=80, d=3, beta_intensity=0, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=1

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0_NA_NA_NA_dataset1.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_50_100_80_3_0_fullREM_NA_NA_NA_dataset1.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0_NA_NA_NA_dataset1.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0_NA_NA_NA_dataset1.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_50_100_80_3_0_NA_NA_NA_dataset1.RDS 
Loading required package: nnet
# weights:  9 (4 variable)
initial  value 11039.954889 
final  value 9447.684507 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 6065.297 mgc: 127.5742 ustep: 1 
iter: 2  value: 5355.15 mgc: 103.118 ustep: 0.1336527 
iter: 3  value: 1311.731 mgc: 128.669 ustep: 0.05528862 
iter: 4  value: 951.2865 mgc: 67.12062 ustep: 0.2352118 
iter: 5  value: 881.7213 mgc: 96.29666 ustep: 0.4850379 
iter: 6  value: 772.7876 mgc: 94.24532 ustep: 0.696477 
iter: 7  value: 767.9208 mgc: 13.62589 ustep: 0.8345685 
iter: 8  value: 767.6088 mgc: 2.825769 ustep: 0.9135559 
iter: 9  value: 767.606 mgc: 0.2480289 ustep: 0.9558056 
iter: 10  value: 767.606 mgc: 0.003268242 ustep: 0.9776553 
iter: 11  value: 767.606 mgc: 7.136926e-06 ustep: 0.9887657 
iter: 12  value: 767.606 mgc: 1.851063e-08 ustep: 0.9943675 
iter: 13  mgc: 1.327373e-10 
iter: 1  mgc: 1.327373e-10 
Matching hessian patterns... Done
outer mgc:  37.44724 
iter: 1  value: 755.1081 mgc: 31.80208 ustep: 1 
iter: 2  value: 737.3229 mgc: 7.705673 ustep: 1 
iter: 3  value: 737.2728 mgc: 0.5649548 ustep: 1 
iter: 4  value: 737.2728 mgc: 0.004627505 ustep: 1 
iter: 5  value: 737.2728 mgc: 7.661479e-07 ustep: 1 
iter: 6  mgc: 7.527312e-14 
iter: 1  mgc: 7.527312e-14 
outer mgc:  53.8916 
iter: 1  value: 745.4307 mgc: 12.71358 ustep: 1 
iter: 2  value: 742.5059 mgc: 2.216565 ustep: 1 
iter: 3  value: 742.5042 mgc: 0.05144144 ustep: 1 
iter: 4  value: 742.5042 mgc: 5.990072e-05 ustep: 1 
iter: 5  mgc: 1.052418e-10 
iter: 1  value: 721.974 mgc: 4.067634 ustep: 1 
iter: 2  value: 721.9587 mgc: 0.1920839 ustep: 1 
iter: 3  value: 721.9587 mgc: 0.0004804961 ustep: 1 
iter: 4  mgc: 9.322752e-09 
iter: 1  mgc: 9.322752e-09 
outer mgc:  87.25262 
iter: 1  value: 721.5485 mgc: 18.84619 ustep: 1 
iter: 2  value: 718.3708 mgc: 2.779825 ustep: 1 
iter: 3  value: 718.3689 mgc: 0.07718293 ustep: 1 
iter: 4  value: 718.3689 mgc: 0.0001150618 ustep: 1 
iter: 5  mgc: 2.567307e-10 
iter: 1  mgc: 2.567307e-10 
outer mgc:  118.6479 
iter: 1  value: 688.2235 mgc: 6.565302 ustep: 1 
iter: 2  value: 688.1931 mgc: 0.3175087 ustep: 1 
iter: 3  value: 688.1931 mgc: 0.001228588 ustep: 1 
iter: 4  value: 688.1931 mgc: 3.118219e-08 ustep: 1 
mgc: 4.585221e-14 
iter: 1  mgc: 4.585221e-14 
outer mgc:  31.23408 
iter: 1  value: 678.1269 mgc: 11.67296 ustep: 1 
iter: 2  value: 676.8184 mgc: 1.457563 ustep: 1 
iter: 3  value: 676.8181 mgc: 0.02671709 ustep: 1 
iter: 4  value: 676.8181 mgc: 2.527286e-05 ustep: 1 
iter: 5  mgc: 2.268452e-11 
iter: 1  mgc: 2.268452e-11 
outer mgc:  74.75905 
iter: 1  value: 674.8333 mgc: 20.73777 ustep: 1 
iter: 2  value: 653.7886 mgc: 6.788522 ustep: 1 
iter: 3  value: 653.739 mgc: 0.3540844 ustep: 1 
iter: 4  value: 653.739 mgc: 0.001328611 ustep: 1 
iter: 5  value: 653.739 mgc: 3.089705e-08 ustep: 1 
mgc: 3.08642e-14 
iter: 1  mgc: 3.08642e-14 
outer mgc:  61.00099 
iter: 1  value: 815.2262 mgc: 56.51872 ustep: 1 
iter: 2  value: 798.5615 mgc: 6.664377 ustep: 1 
iter: 3  value: 798.5473 mgc: 0.2260469 ustep: 1 
iter: 4  value: 798.5473 mgc: 0.0004668073 ustep: 1 
iter: 5  mgc: 2.009045e-09 
iter: 1  value: 644.2721 mgc: 9.800642 ustep: 1 
iter: 2  value: 644.228 mgc: 0.3423808 ustep: 1 
iter: 3  value: 644.228 mgc: 0.001012449 ustep: 1 
iter: 4  value: 644.228 mgc: 1.161068e-08 ustep: 1 
mgc: 3.297362e-14 
iter: 1  mgc: 3.297362e-14 
outer mgc:  42.43572 
iter: 1  value: 640.5289 mgc: 1.306683 ustep: 1 
iter: 2  value: 640.5289 mgc: 0.009684116 ustep: 1 
iter: 3  value: 640.5289 mgc: 1.52278e-06 ustep: 1 
iter: 4  mgc: 4.390932e-14 
iter: 1  mgc: 4.390932e-14 
outer mgc:  37.87946 
iter: 1  value: 636.2413 mgc: 8.761218 ustep: 1 
iter: 2  value: 636.2357 mgc: 0.1632618 ustep: 1 
iter: 3  value: 636.2357 mgc: 0.0002354064 ustep: 1 
iter: 4  mgc: 4.874847e-10 
iter: 1  mgc: 4.874847e-10 
outer mgc:  38.97154 
iter: 1  value: 631.0799 mgc: 2.715643 ustep: 1 
iter: 2  value: 631.078 mgc: 0.07148838 ustep: 1 
iter: 3  value: 631.078 mgc: 3.441331e-05 ustep: 1 
iter: 4  mgc: 1.64313e-11 
iter: 1  mgc: 1.64313e-11 
outer mgc:  13.8459 
iter: 1  value: 625.2487 mgc: 11.30471 ustep: 1 
iter: 2  value: 625.1951 mgc: 0.3597703 ustep: 1 
iter: 3  value: 625.1951 mgc: 0.00115018 ustep: 1 
iter: 4  value: 625.1951 mgc: 1.920173e-08 ustep: 1 
mgc: 4.490852e-14 
iter: 1  mgc: 4.490852e-14 
outer mgc:  32.8002 
iter: 1  value: 627.8053 mgc: 6.661946 ustep: 1 
iter: 2  value: 627.7973 mgc: 0.2705969 ustep: 1 
iter: 3  value: 627.7973 mgc: 0.0005602988 ustep: 1 
iter: 4  mgc: 2.411488e-09 
iter: 1  value: 624.6046 mgc: 5.47989 ustep: 1 
iter: 2  value: 624.6015 mgc: 0.1332268 ustep: 1 
iter: 3  value: 624.6015 mgc: 0.0001385684 ustep: 1 
iter: 4  mgc: 1.5251e-10 
iter: 1  mgc: 1.5251e-10 
outer mgc:  28.39592 
iter: 1  value: 624.0005 mgc: 3.381944 ustep: 1 
iter: 2  value: 623.9997 mgc: 0.05017771 ustep: 1 
iter: 3  value: 623.9997 mgc: 4.300773e-05 ustep: 1 
iter: 4  mgc: 2.84448e-11 
iter: 1  mgc: 2.84448e-11 
outer mgc:  16.24237 
iter: 1  value: 622.1989 mgc: 2.259368 ustep: 1 
iter: 2  value: 622.1987 mgc: 0.04286056 ustep: 1 
iter: 3  value: 622.1987 mgc: 2.525466e-05 ustep: 1 
iter: 4  mgc: 8.213263e-12 
iter: 1  mgc: 8.213263e-12 
outer mgc:  7.611393 
iter: 1  value: 620.5005 mgc: 1.486831 ustep: 1 
iter: 2  value: 620.5005 mgc: 0.01355319 ustep: 1 
iter: 3  value: 620.5005 mgc: 2.323665e-06 ustep: 1 
iter: 4  mgc: 6.605827e-14 
iter: 1  mgc: 6.605827e-14 
outer mgc:  7.844142 
iter: 1  value: 620.0688 mgc: 2.191724 ustep: 1 
iter: 2  value: 620.0688 mgc: 0.01316399 ustep: 1 
iter: 3  value: 620.0688 mgc: 1.354131e-06 ustep: 1 
iter: 4  mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  18.10243 
iter: 1  value: 619.6978 mgc: 3.219265 ustep: 1 
iter: 2  value: 619.6976 mgc: 0.02353897 ustep: 1 
iter: 3  value: 619.6976 mgc: 1.892775e-05 ustep: 1 
iter: 4  mgc: 2.328404e-11 
iter: 1  mgc: 2.328404e-11 
outer mgc:  12.91017 
iter: 1  value: 620.662 mgc: 1.159256 ustep: 1 
iter: 2  value: 620.662 mgc: 0.01031626 ustep: 1 
iter: 3  value: 620.662 mgc: 6.35586e-07 ustep: 1 
iter: 4  mgc: 3.375078e-14 
iter: 1  value: 619.6002 mgc: 1.014412 ustep: 1 
iter: 2  value: 619.6002 mgc: 0.005414519 ustep: 1 
iter: 3  value: 619.6002 mgc: 1.940995e-07 ustep: 1 
iter: 4  mgc: 4.518608e-14 
iter: 1  mgc: 4.518608e-14 
outer mgc:  12.23667 
iter: 1  value: 618.7992 mgc: 1.160904 ustep: 1 
iter: 2  value: 618.7992 mgc: 0.005810641 ustep: 1 
iter: 3  value: 618.7992 mgc: 1.629952e-07 ustep: 1 
iter: 4  mgc: 3.130829e-14 
iter: 1  mgc: 3.130829e-14 
outer mgc:  6.304153 
iter: 1  value: 618.2838 mgc: 1.08017 ustep: 1 
iter: 2  value: 618.2838 mgc: 0.002733802 ustep: 1 
iter: 3  value: 618.2838 mgc: 4.112608e-08 ustep: 1 
mgc: 3.574918e-14 
iter: 1  mgc: 3.574918e-14 
outer mgc:  5.073804 
iter: 1  value: 618.0839 mgc: 0.8775469 ustep: 1 
iter: 2  value: 618.0839 mgc: 0.00159208 ustep: 1 
iter: 3  value: 618.0839 mgc: 2.240309e-08 ustep: 1 
mgc: 3.674838e-14 
iter: 1  mgc: 3.674838e-14 
outer mgc:  4.243688 
iter: 1  value: 617.8581 mgc: 0.3468701 ustep: 1 
iter: 2  value: 617.8581 mgc: 0.0005401227 ustep: 1 
iter: 3  mgc: 1.919208e-09 
iter: 1  mgc: 1.919208e-09 
outer mgc:  4.336376 
iter: 1  value: 617.429 mgc: 0.5093146 ustep: 1 
iter: 2  value: 617.429 mgc: 0.001101848 ustep: 1 
iter: 3  mgc: 5.921922e-09 
iter: 1  mgc: 5.921922e-09 
outer mgc:  3.258986 
iter: 1  value: 617.2549 mgc: 0.5796083 ustep: 1 
iter: 2  value: 617.2549 mgc: 0.001970741 ustep: 1 
iter: 3  value: 617.2549 mgc: 2.261162e-08 ustep: 1 
mgc: 3.419487e-14 
iter: 1  mgc: 3.419487e-14 
outer mgc:  2.354653 
iter: 1  value: 616.6957 mgc: 0.5873224 ustep: 1 
iter: 2  value: 616.6957 mgc: 0.0008617465 ustep: 1 
iter: 3  mgc: 3.69182e-09 
iter: 1  value: 616.071 mgc: 0.7180795 ustep: 1 
iter: 2  value: 616.071 mgc: 0.0009388325 ustep: 1 
iter: 3  mgc: 3.691594e-09 
iter: 1  value: 614.8555 mgc: 1.019966 ustep: 1 
iter: 2  value: 614.8555 mgc: 0.003308962 ustep: 1 
iter: 3  value: 614.8555 mgc: 5.159836e-08 ustep: 1 
mgc: 2.264855e-14 
iter: 1  mgc: 2.264855e-14 
outer mgc:  15.54675 
iter: 1  value: 613.9798 mgc: 2.088034 ustep: 1 
iter: 2  value: 613.9798 mgc: 0.01248644 ustep: 1 
iter: 3  value: 613.9798 mgc: 1.104641e-05 ustep: 1 
iter: 4  mgc: 8.629542e-12 
iter: 1  mgc: 8.629542e-12 
outer mgc:  8.065374 
iter: 1  value: 613.359 mgc: 2.16251 ustep: 1 
iter: 2  value: 613.359 mgc: 0.01901625 ustep: 1 
iter: 3  value: 613.359 mgc: 2.022578e-06 ustep: 1 
iter: 4  mgc: 5.240253e-14 
iter: 1  value: 613.6773 mgc: 0.91514 ustep: 1 
iter: 2  value: 613.6773 mgc: 0.00209021 ustep: 1 
iter: 3  value: 613.6773 mgc: 2.544664e-08 ustep: 1 
mgc: 3.008704e-14 
iter: 1  mgc: 3.008704e-14 
outer mgc:  5.659721 
iter: 1  value: 612.765 mgc: 1.152261 ustep: 1 
iter: 2  value: 612.765 mgc: 0.007085655 ustep: 1 
iter: 3  value: 612.765 mgc: 9.024963e-07 ustep: 1 
iter: 4  mgc: 3.730349e-14 
iter: 1  mgc: 3.730349e-14 
outer mgc:  5.123722 
iter: 1  value: 612.348 mgc: 0.8316545 ustep: 1 
iter: 2  value: 612.348 mgc: 0.001049506 ustep: 1 
iter: 3  value: 612.348 mgc: 1.596826e-08 ustep: 1 
mgc: 2.725598e-14 
iter: 1  mgc: 2.725598e-14 
outer mgc:  1.85517 
iter: 1  value: 612.2275 mgc: 0.1996367 ustep: 1 
iter: 2  value: 612.2275 mgc: 0.000433315 ustep: 1 
iter: 3  mgc: 6.431339e-09 
iter: 1  mgc: 6.431339e-09 
outer mgc:  2.121912 
iter: 1  value: 611.8075 mgc: 0.3654019 ustep: 1 
iter: 2  value: 611.8075 mgc: 0.0005677766 ustep: 1 
iter: 3  mgc: 1.479354e-09 
iter: 1  mgc: 1.479354e-09 
outer mgc:  1.206237 
iter: 1  value: 611.3257 mgc: 0.617895 ustep: 1 
iter: 2  value: 611.3257 mgc: 0.001014098 ustep: 1 
iter: 3  mgc: 2.444266e-09 
iter: 1  mgc: 2.444266e-09 
outer mgc:  1.956892 
iter: 1  value: 611.0189 mgc: 0.7138219 ustep: 1 
iter: 2  value: 611.0189 mgc: 0.002031889 ustep: 1 
iter: 3  value: 611.0189 mgc: 3.089069e-08 ustep: 1 
mgc: 2.953193e-14 
iter: 1  mgc: 2.953193e-14 
outer mgc:  0.5006208 
iter: 1  value: 611.0718 mgc: 0.4083387 ustep: 1 
iter: 2  value: 611.0718 mgc: 0.0008221515 ustep: 1 
iter: 3  mgc: 5.709915e-09 
iter: 1  value: 611.0476 mgc: 0.1585512 ustep: 1 
iter: 2  value: 611.0476 mgc: 0.00017498 ustep: 1 
iter: 3  mgc: 2.2807e-10 
iter: 1  mgc: 2.2807e-10 
outer mgc:  0.458859 
iter: 1  value: 611.1506 mgc: 0.1892869 ustep: 1 
iter: 2  value: 611.1506 mgc: 0.0001072379 ustep: 1 
iter: 3  mgc: 7.558887e-11 
iter: 1  mgc: 7.558887e-11 
outer mgc:  0.1897851 
iter: 1  value: 611.1611 mgc: 0.04641423 ustep: 1 
iter: 2  value: 611.1611 mgc: 5.799069e-06 ustep: 1 
iter: 3  mgc: 2.23821e-13 
iter: 1  mgc: 2.23821e-13 
outer mgc:  0.0838753 
iter: 1  value: 611.1638 mgc: 0.006432005 ustep: 1 
iter: 2  value: 611.1638 mgc: 9.860619e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  0.00823609 
iter: 1  value: 611.1627 mgc: 0.001503984 ustep: 1 
iter: 2  mgc: 9.383181e-09 
iter: 1  mgc: 9.383181e-09 
outer mgc:  0.0003080023 
iter: 1  value: 611.1628 mgc: 0.0001725509 ustep: 1 
iter: 2  mgc: 8.914913e-11 
iter: 1  mgc: 8.914913e-11 
outer mgc:  2.148531e-05 
iter: 1  value: 611.1628 mgc: 3.597077e-06 ustep: 1 
iter: 2  mgc: 4.796163e-14 
iter: 1  mgc: 4.796163e-14 
outer mgc:  7.038619e-07 
iter: 1  value: 611.1628 mgc: 9.452274e-08 ustep: 1 
mgc: 3.68594e-14 
iter: 1  mgc: 4.796163e-14 
iter: 1  mgc: 4.796163e-14 
outer mgc:  7.038619e-07 
iter: 1  value: 611.1597 mgc: 0.03151384 ustep: 1 
iter: 2  value: 611.1597 mgc: 3.557075e-06 ustep: 1 
iter: 3  mgc: 5.462297e-14 
outer mgc:  0.5692574 
iter: 1  value: 611.1665 mgc: 0.03149401 ustep: 1 
iter: 2  value: 611.1665 mgc: 3.555641e-06 ustep: 1 
iter: 3  mgc: 5.284662e-14 
outer mgc:  0.5691682 
iter: 1  value: 611.1613 mgc: 0.01788012 ustep: 1 
iter: 2  value: 611.1613 mgc: 1.111276e-06 ustep: 1 
iter: 3  mgc: 3.463896e-14 
outer mgc:  0.4608566 
iter: 1  value: 611.1648 mgc: 0.0178689 ustep: 1 
iter: 2  value: 611.1648 mgc: 1.110678e-06 ustep: 1 
iter: 3  mgc: 3.064216e-14 
outer mgc:  0.4606994 
iter: 1  value: 611.1668 mgc: 0.05919927 ustep: 1 
iter: 2  value: 611.1668 mgc: 5.470887e-06 ustep: 1 
iter: 3  mgc: 3.046452e-13 
outer mgc:  0.5611144 
iter: 1  value: 611.1594 mgc: 0.05921183 ustep: 1 
iter: 2  value: 611.1594 mgc: 5.462644e-06 ustep: 1 
iter: 3  mgc: 3.312906e-13 
outer mgc:  0.5611844 
iter: 1  value: 611.1651 mgc: 0.0296402 ustep: 1 
iter: 2  value: 611.1651 mgc: 1.567016e-06 ustep: 1 
iter: 3  mgc: 3.719247e-14 
outer mgc:  0.718796 
iter: 1  value: 611.1613 mgc: 0.02964344 ustep: 1 
iter: 2  value: 611.1613 mgc: 1.566495e-06 ustep: 1 
iter: 3  mgc: 3.819167e-14 
outer mgc:  0.7188463 
iter: 1  value: 611.1565 mgc: 0.005114052 ustep: 1 
iter: 2  value: 611.1565 mgc: 7.838501e-08 ustep: 1 
mgc: 3.28626e-14 
outer mgc:  0.00448332 
iter: 1  value: 611.1691 mgc: 0.005112677 ustep: 1 
iter: 2  value: 611.1691 mgc: 7.841609e-08 ustep: 1 
mgc: 3.108624e-14 
outer mgc:  0.004484627 
iter: 1  value: 611.1848 mgc: 0.05040791 ustep: 1 
iter: 2  value: 611.1848 mgc: 9.549193e-06 ustep: 1 
iter: 3  mgc: 3.350653e-13 
outer mgc:  0.3266756 
iter: 1  value: 611.1411 mgc: 0.05056132 ustep: 1 
iter: 2  value: 611.1411 mgc: 9.565653e-06 ustep: 1 
iter: 3  mgc: 3.543832e-13 
outer mgc:  0.3266415 
iter: 1  value: 611.1695 mgc: 0.05722675 ustep: 1 
iter: 2  value: 611.1695 mgc: 1.191738e-05 ustep: 1 
iter: 3  mgc: 5.799805e-13 
outer mgc:  0.3664504 
iter: 1  value: 611.1565 mgc: 0.05738968 ustep: 1 
iter: 2  value: 611.1565 mgc: 1.195514e-05 ustep: 1 
iter: 3  mgc: 6.048495e-13 
outer mgc:  0.3669945 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 14:53:07 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1

[Sun Aug 15 07:49:12 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_0.02_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_4_0.02_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationJnorm3_10_100_10_4_0.02_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationJnorm3, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=0.02, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_0.02_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationJnorm3_10_100_10_4_0.02_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_0.02_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_0.02_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationJnorm3_10_100_10_4_0.02_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2706.046593 
iter  10 value 2416.128235
iter  10 value 2416.128213
iter  10 value 2416.128213
final  value 2416.128213 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 1501.37 mgc: 118.0477 ustep: 1 
iter: 2  value: 939.0869 mgc: 78.82998 ustep: 0.1336527 
iter: 3  value: 605.9899 mgc: 147.9654 ustep: 0.05528862 
iter: 4  value: 567.9379 mgc: 83.88967 ustep: 0.1254658 
iter: 5  value: 454.7043 mgc: 112.7334 ustep: 0.354276 
iter: 6  value: 426.2557 mgc: 44.73316 ustep: 0.5952514 
iter: 7  value: 422.6667 mgc: 18.90437 ustep: 0.7715482 
iter: 8  value: 422.6612 mgc: 0.5512235 ustep: 0.8783903 
iter: 9  value: 422.6612 mgc: 0.002588499 ustep: 0.9372311 
iter: 10  value: 422.6612 mgc: 0.0001117239 ustep: 0.9681101 
iter: 11  value: 422.6612 mgc: 2.585228e-06 ustep: 0.9839275 
iter: 12  value: 422.6612 mgc: 3.055443e-08 ustep: 0.991932 
iter: 13  mgc: 1.814213e-10 
iter: 1  mgc: 1.814213e-10 
Matching hessian patterns... Done
outer mgc:  68.03244 
iter: 1  value: 399.0344 mgc: 32.3894 ustep: 1 
iter: 2  value: 395.5603 mgc: 6.149129 ustep: 1 
iter: 3  value: 395.5501 mgc: 0.3557815 ustep: 1 
iter: 4  value: 395.5501 mgc: 0.002050452 ustep: 1 
iter: 5  value: 395.5501 mgc: 6.938956e-08 ustep: 1 
mgc: 3.508305e-14 
iter: 1  mgc: 3.508305e-14 
outer mgc:  40.75786 
iter: 1  value: 395.4837 mgc: 16.19483 ustep: 1 
iter: 2  value: 395.403 mgc: 1.02337 ustep: 1 
iter: 3  value: 395.403 mgc: 0.005583677 ustep: 1 
iter: 4  value: 395.403 mgc: 3.822895e-07 ustep: 1 
iter: 5  mgc: 2.420286e-14 
iter: 1  value: 386.465 mgc: 10.30558 ustep: 1 
iter: 2  value: 386.4552 mgc: 0.4498506 ustep: 1 
iter: 3  value: 386.4552 mgc: 0.001104151 ustep: 1 
iter: 4  mgc: 8.171631e-09 
iter: 1  mgc: 8.171631e-09 
outer mgc:  15.71725 
iter: 1  value: 381.6742 mgc: 19.80351 ustep: 1 
iter: 2  value: 381.5713 mgc: 1.011308 ustep: 1 
iter: 3  value: 381.5713 mgc: 0.01484312 ustep: 1 
iter: 4  value: 381.5713 mgc: 4.304535e-06 ustep: 1 
iter: 5  mgc: 6.599166e-13 
iter: 1  mgc: 6.599166e-13 
outer mgc:  21.33373 
iter: 1  value: 373.3048 mgc: 22.31168 ustep: 1 
iter: 2  value: 372.7096 mgc: 2.476397 ustep: 1 
iter: 3  value: 372.7088 mgc: 0.08714361 ustep: 1 
iter: 4  value: 372.7088 mgc: 0.0003508548 ustep: 1 
iter: 5  value: 372.7088 mgc: 1.154832e-08 ustep: 1 
mgc: 4.141132e-14 
iter: 1  mgc: 4.141132e-14 
outer mgc:  11.62848 
iter: 1  value: 371.123 mgc: 35.82493 ustep: 1 
iter: 2  value: 369.0545 mgc: 5.058783 ustep: 1 
iter: 3  value: 369.0504 mgc: 0.2432599 ustep: 1 
iter: 4  value: 369.0504 mgc: 0.0009467183 ustep: 1 
iter: 5  value: 369.0504 mgc: 3.694941e-08 ustep: 1 
mgc: 3.397282e-14 
iter: 1  mgc: 3.397282e-14 
outer mgc:  14.77647 
iter: 1  value: 378.6742 mgc: 22.63436 ustep: 1 
iter: 2  value: 377.6419 mgc: 4.66387 ustep: 1 
iter: 3  value: 377.6408 mgc: 0.1567793 ustep: 1 
iter: 4  value: 377.6408 mgc: 0.0004304841 ustep: 1 
iter: 5  mgc: 3.252166e-09 
iter: 1  value: 366.0909 mgc: 9.039249 ustep: 1 
iter: 2  value: 366.0866 mgc: 0.2745276 ustep: 1 
iter: 3  value: 366.0866 mgc: 0.0003600234 ustep: 1 
iter: 4  mgc: 7.349708e-10 
iter: 1  mgc: 7.349708e-10 
outer mgc:  3.189203 
iter: 1  value: 365.7535 mgc: 7.806057 ustep: 1 
iter: 2  value: 365.7482 mgc: 0.2496694 ustep: 1 
iter: 3  value: 365.7482 mgc: 0.0004985121 ustep: 1 
iter: 4  mgc: 8.753014e-09 
iter: 1  mgc: 8.753014e-09 
outer mgc:  6.968096 
iter: 1  value: 364.861 mgc: 4.454109 ustep: 1 
iter: 2  value: 364.8601 mgc: 0.1091151 ustep: 1 
iter: 3  value: 364.8601 mgc: 0.0001429846 ustep: 1 
iter: 4  mgc: 3.733958e-10 
iter: 1  mgc: 3.733958e-10 
outer mgc:  3.247925 
iter: 1  value: 365.399 mgc: 2.196175 ustep: 1 
iter: 2  value: 365.3984 mgc: 0.1097445 ustep: 1 
iter: 3  value: 365.3984 mgc: 0.0002381817 ustep: 1 
iter: 4  mgc: 1.137112e-09 
iter: 1  value: 364.7599 mgc: 1.839102 ustep: 1 
iter: 2  value: 364.7599 mgc: 0.008017131 ustep: 1 
iter: 3  value: 364.7599 mgc: 4.999579e-07 ustep: 1 
iter: 4  mgc: 5.973e-14 
iter: 1  mgc: 5.973e-14 
outer mgc:  3.124214 
iter: 1  value: 364.7253 mgc: 3.037989 ustep: 1 
iter: 2  value: 364.7253 mgc: 0.03077368 ustep: 1 
iter: 3  value: 364.7253 mgc: 1.087668e-05 ustep: 1 
iter: 4  mgc: 1.428635e-12 
iter: 1  mgc: 1.428635e-12 
outer mgc:  3.064133 
iter: 1  value: 364.6636 mgc: 1.544211 ustep: 1 
iter: 2  value: 364.6636 mgc: 0.009564816 ustep: 1 
iter: 3  value: 364.6636 mgc: 1.651549e-06 ustep: 1 
iter: 4  mgc: 5.817569e-14 
iter: 1  mgc: 5.817569e-14 
outer mgc:  0.5437181 
iter: 1  value: 364.5689 mgc: 1.254803 ustep: 1 
iter: 2  value: 364.5688 mgc: 0.005865 ustep: 1 
iter: 3  value: 364.5688 mgc: 8.767797e-07 ustep: 1 
iter: 4  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  1.368283 
iter: 1  value: 364.5383 mgc: 2.02093 ustep: 1 
iter: 2  value: 364.5383 mgc: 0.01432986 ustep: 1 
iter: 3  value: 364.5383 mgc: 2.59649e-06 ustep: 1 
iter: 4  mgc: 1.24567e-13 
iter: 1  mgc: 1.24567e-13 
outer mgc:  0.5901364 
iter: 1  value: 364.6388 mgc: 1.221716 ustep: 1 
iter: 2  value: 364.6388 mgc: 0.0106177 ustep: 1 
iter: 3  value: 364.6388 mgc: 1.499596e-06 ustep: 1 
iter: 4  mgc: 8.748557e-14 
iter: 1  mgc: 8.748557e-14 
outer mgc:  0.4599623 
iter: 1  value: 364.7076 mgc: 1.878445 ustep: 1 
iter: 2  value: 364.7076 mgc: 0.01200347 ustep: 1 
iter: 3  value: 364.7076 mgc: 2.120301e-06 ustep: 1 
iter: 4  mgc: 8.124057e-14 
iter: 1  value: 364.619 mgc: 0.1196819 ustep: 1 
iter: 2  value: 364.619 mgc: 0.0001503448 ustep: 1 
iter: 3  mgc: 3.06375e-10 
iter: 1  mgc: 3.06375e-10 
outer mgc:  0.2284737 
iter: 1  value: 364.5953 mgc: 0.4612739 ustep: 1 
iter: 2  value: 364.5953 mgc: 0.0008934838 ustep: 1 
iter: 3  mgc: 5.960894e-09 
iter: 1  mgc: 5.960894e-09 
outer mgc:  0.728359 
iter: 1  value: 364.5777 mgc: 0.2807066 ustep: 1 
iter: 2  value: 364.5777 mgc: 0.0003651781 ustep: 1 
iter: 3  mgc: 1.544036e-09 
iter: 1  mgc: 1.544036e-09 
outer mgc:  0.1124359 
iter: 1  value: 364.5659 mgc: 0.4702628 ustep: 1 
iter: 2  value: 364.5659 mgc: 0.001119805 ustep: 1 
iter: 3  mgc: 9.628456e-09 
iter: 1  value: 364.5724 mgc: 0.18159 ustep: 1 
iter: 2  value: 364.5724 mgc: 0.0001682959 ustep: 1 
iter: 3  mgc: 2.171127e-10 
iter: 1  mgc: 2.171127e-10 
outer mgc:  0.0526192 
iter: 1  value: 364.571 mgc: 0.1895804 ustep: 1 
iter: 2  value: 364.571 mgc: 0.00011008 ustep: 1 
iter: 3  mgc: 1.720678e-10 
iter: 1  mgc: 1.720678e-10 
outer mgc:  0.03663745 
iter: 1  value: 364.5694 mgc: 0.1275918 ustep: 1 
iter: 2  value: 364.5694 mgc: 6.172113e-05 ustep: 1 
iter: 3  mgc: 5.435485e-11 
iter: 1  value: 364.5702 mgc: 0.05428668 ustep: 1 
iter: 2  value: 364.5702 mgc: 9.066773e-06 ustep: 1 
iter: 3  mgc: 8.83793e-13 
iter: 1  mgc: 8.83793e-13 
outer mgc:  0.0212977 
iter: 1  value: 364.5692 mgc: 0.07254685 ustep: 1 
iter: 2  value: 364.5692 mgc: 1.284511e-05 ustep: 1 
iter: 3  mgc: 2.351286e-12 
iter: 1  mgc: 2.351286e-12 
outer mgc:  0.01768174 
iter: 1  value: 364.5717 mgc: 0.03640708 ustep: 1 
iter: 2  value: 364.5717 mgc: 8.52506e-06 ustep: 1 
iter: 3  mgc: 7.949197e-13 
iter: 1  value: 364.5702 mgc: 0.0169454 ustep: 1 
iter: 2  value: 364.5702 mgc: 1.294372e-06 ustep: 1 
iter: 3  mgc: 2.975398e-14 
iter: 1  mgc: 2.975398e-14 
outer mgc:  0.01538715 
iter: 1  value: 364.5713 mgc: 0.02074486 ustep: 1 
iter: 2  value: 364.5713 mgc: 4.301728e-06 ustep: 1 
iter: 3  mgc: 2.109424e-13 
iter: 1  value: 364.5703 mgc: 0.007023776 ustep: 1 
iter: 2  value: 364.5703 mgc: 1.91816e-07 ustep: 1 
iter: 3  mgc: 2.442491e-14 
iter: 1  mgc: 2.442491e-14 
outer mgc:  0.01199442 
iter: 1  value: 364.5707 mgc: 0.01153038 ustep: 1 
iter: 2  value: 364.5707 mgc: 4.297287e-07 ustep: 1 
iter: 3  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  0.002761436 
iter: 1  value: 364.5704 mgc: 0.007371127 ustep: 1 
iter: 2  value: 364.5704 mgc: 3.315691e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
iter: 1  value: 364.5706 mgc: 0.005853809 ustep: 1 
iter: 2  value: 364.5706 mgc: 1.346849e-07 ustep: 1 
iter: 3  mgc: 2.88658e-14 
iter: 1  value: 364.5707 mgc: 0.003245671 ustep: 1 
iter: 2  value: 364.5707 mgc: 3.724324e-08 ustep: 1 
mgc: 2.131628e-14 
iter: 1  mgc: 2.131628e-14 
outer mgc:  0.001459879 
iter: 1  value: 364.5707 mgc: 0.00154233 ustep: 1 
iter: 2  value: 364.5707 mgc: 1.202144e-08 ustep: 1 
mgc: 2.109424e-14 
iter: 1  mgc: 2.109424e-14 
outer mgc:  0.0005493869 
iter: 1  value: 364.5707 mgc: 0.00488541 ustep: 1 
iter: 2  value: 364.5707 mgc: 7.305071e-08 ustep: 1 
mgc: 6.838974e-14 
iter: 1  mgc: 6.838974e-14 
outer mgc:  0.0006573633 
iter: 1  value: 364.5707 mgc: 0.002867785 ustep: 1 
iter: 2  value: 364.5707 mgc: 4.810479e-08 ustep: 1 
iter: 3  mgc: 2.398082e-14 
iter: 1  value: 364.5707 mgc: 0.001310792 ustep: 1 
iter: 2  mgc: 9.972562e-09 
iter: 1  mgc: 9.972562e-09 
outer mgc:  0.0002385563 
iter: 1  value: 364.5707 mgc: 0.001355376 ustep: 1 
iter: 2  mgc: 7.13368e-09 
iter: 1  mgc: 9.972562e-09 
iter: 1  mgc: 9.972562e-09 
outer mgc:  0.0002385563 
iter: 1  value: 364.5705 mgc: 0.04157458 ustep: 1 
iter: 2  value: 364.5705 mgc: 8.890097e-06 ustep: 1 
iter: 3  mgc: 6.342704e-13 
outer mgc:  0.02418618 
iter: 1  value: 364.571 mgc: 0.04155423 ustep: 1 
iter: 2  value: 364.571 mgc: 8.901118e-06 ustep: 1 
iter: 3  mgc: 6.3205e-13 
outer mgc:  0.02429572 
iter: 1  value: 364.5705 mgc: 0.0201512 ustep: 1 
iter: 2  value: 364.5705 mgc: 2.079742e-06 ustep: 1 
iter: 3  mgc: 3.330669e-14 
outer mgc:  0.05322605 
iter: 1  value: 364.5709 mgc: 0.02014041 ustep: 1 
iter: 2  value: 364.5709 mgc: 2.079675e-06 ustep: 1 
iter: 3  mgc: 2.819966e-14 
outer mgc:  0.05352581 
iter: 1  value: 364.5707 mgc: 0.05047667 ustep: 1 
iter: 2  value: 364.5707 mgc: 9.218786e-06 ustep: 1 
iter: 3  mgc: 9.389156e-13 
outer mgc:  0.009407482 
iter: 1  value: 364.5707 mgc: 0.05046393 ustep: 1 
iter: 2  value: 364.5707 mgc: 9.226678e-06 ustep: 1 
iter: 3  mgc: 9.349188e-13 
outer mgc:  0.009528981 
iter: 1  value: 364.5705 mgc: 0.02422747 ustep: 1 
iter: 2  value: 364.5705 mgc: 1.402173e-06 ustep: 1 
iter: 3  mgc: 2.997602e-14 
outer mgc:  0.06614301 
iter: 1  value: 364.571 mgc: 0.02421833 ustep: 1 
iter: 2  value: 364.571 mgc: 1.403034e-06 ustep: 1 
iter: 3  mgc: 5.195844e-14 
outer mgc:  0.06641204 
iter: 1  value: 364.571 mgc: 0.05279621 ustep: 1 
iter: 2  value: 364.571 mgc: 8.040269e-06 ustep: 1 
iter: 3  mgc: 5.806466e-13 
outer mgc:  0.01962033 
iter: 1  value: 364.5704 mgc: 0.05278104 ustep: 1 
iter: 2  value: 364.5704 mgc: 8.031777e-06 ustep: 1 
iter: 3  mgc: 5.671019e-13 
outer mgc:  0.01942348 
iter: 1  value: 364.5711 mgc: 0.02762117 ustep: 1 
iter: 2  value: 364.5711 mgc: 2.307338e-06 ustep: 1 
iter: 3  mgc: 4.596323e-14 
outer mgc:  0.1065519 
iter: 1  value: 364.5704 mgc: 0.02761515 ustep: 1 
iter: 2  value: 364.5704 mgc: 2.310195e-06 ustep: 1 
iter: 3  mgc: 2.731149e-14 
outer mgc:  0.1060821 
iter: 1  value: 364.5699 mgc: 0.002288295 ustep: 1 
iter: 2  value: 364.5699 mgc: 1.817029e-07 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.007104854 
iter: 1  value: 364.5715 mgc: 0.002286134 ustep: 1 
iter: 2  value: 364.5715 mgc: 1.814118e-07 ustep: 1 
iter: 3  mgc: 2.464695e-14 
outer mgc:  0.007094931 
iter: 1  value: 364.57 mgc: 0.002470228 ustep: 1 
iter: 2  value: 364.57 mgc: 9.559871e-08 ustep: 1 
mgc: 2.309264e-14 
outer mgc:  0.005014167 
iter: 1  value: 364.5714 mgc: 0.002468522 ustep: 1 
iter: 2  value: 364.5714 mgc: 9.548197e-08 ustep: 1 
mgc: 1.887379e-14 
outer mgc:  0.005062615 
iter: 1  value: 364.5713 mgc: 0.002503962 ustep: 1 
iter: 2  value: 364.5713 mgc: 1.206952e-07 ustep: 1 
iter: 3  mgc: 2.353673e-14 
outer mgc:  0.007882493 
iter: 1  value: 364.5701 mgc: 0.002503637 ustep: 1 
iter: 2  value: 364.5701 mgc: 1.208032e-07 ustep: 1 
iter: 3  mgc: 2.731149e-14 
outer mgc:  0.007652194 
iter: 1  value: 364.5723 mgc: 0.008022217 ustep: 1 
iter: 2  value: 364.5723 mgc: 7.342479e-07 ustep: 1 
iter: 3  mgc: 1.881828e-14 
outer mgc:  0.03650179 
iter: 1  value: 364.5692 mgc: 0.008042019 ustep: 1 
iter: 2  value: 364.5692 mgc: 7.372279e-07 ustep: 1 
iter: 3  mgc: 2.575717e-14 
outer mgc:  0.03665695 
iter: 1  value: 364.572 mgc: 0.003999835 ustep: 1 
iter: 2  value: 364.572 mgc: 1.423723e-06 ustep: 1 
iter: 3  mgc: 1.998401e-13 
outer mgc:  0.01878049 
iter: 1  value: 364.5694 mgc: 0.004008653 ustep: 1 
iter: 2  value: 364.5694 mgc: 1.427524e-06 ustep: 1 
iter: 3  mgc: 2.011724e-13 
outer mgc:  0.01849093 
iter: 1  value: 364.5715 mgc: 0.006835867 ustep: 1 
iter: 2  value: 364.5715 mgc: 9.030406e-07 ustep: 1 
iter: 3  mgc: 3.28626e-14 
outer mgc:  0.03036436 
iter: 1  value: 364.57 mgc: 0.006852387 ustep: 1 
iter: 2  value: 364.57 mgc: 9.07222e-07 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.03035859 
[Sun Aug 15 07:49:14 2021]
Finished job 0.
1 of 1 steps (100%) done

Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	inference_simulation_TMB_multiple
	1
Select jobs to execute...

[Sun Aug 15 15:15:11 2021]
rule inference_simulation_TMB_multiple:
    input: ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.8_NA_NA_NA_dataset0.RDS
    output: ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_0.8_fullREM_NA_NA_NA_dataset0.RDS
    log: logs/inference/nlminb/simulation_GenerationCnorm_10_100_10_4_0.8_ModelfullREM_NA_NA_NA_dataset0.log
    jobid: 0
    wildcards: optimiser=nlminb, datasetgeneration=GenerationCnorm, n=10, nlambda=100, lmbda=10, d=4, beta_intensity=0.8, model=fullREM, fixed_beta_intercept=NA, fixed_beta_slope=NA, sdRE_input=NA, itnum=0

Rscript 2_inference_TMB/run_TMB.R --input ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.8_NA_NA_NA_dataset0.RDS --output ../data/assessing_models_simulation/inference_results/TMB/nlminb/multiple_GenerationCnorm_10_100_10_4_0.8_fullREM_NA_NA_NA_dataset0.RDS --model fullREM --optimiser nlminb
Model: fullREM 
Feature type: signatures 
Using nlminb: TRUE 
Simulation boolean: TRUE 
make: Nothing to be done for 'all'.
../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.8_NA_NA_NA_dataset0.RDS[1] "../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.8_NA_NA_NA_dataset0.RDS"
Reading file ../data/assessing_models_simulation/datasets/multiple_GenerationCnorm_10_100_10_4_0.8_NA_NA_NA_dataset0.RDS 
Loading required package: nnet
# weights:  12 (6 variable)
initial  value 2710.205476 
iter  10 value 2612.541476
final  value 2612.541439 
converged
Order of parameters:
[1] "beta"       "u_large"    "logs_sd_RE" "cov_par_RE"
Not matching template order:
[1] "beta"       "u_large"    "cov_par_RE" "logs_sd_RE"
Your parameter list has been re-ordered.
(Disable this warning with checkParameterOrder=FALSE)
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Constructing atomic invpd
Constructing atomic D_lgamma
Constructing atomic matmul
Optimizing tape... Done
iter: 1  value: 697.1842 mgc: 58.8598 ustep: 1 
iter: 2  value: 618.8524 mgc: 24.70086 ustep: 1 
iter: 3  value: 596.5017 mgc: 25.93058 ustep: 1 
iter: 4  value: 596.4331 mgc: 0.7821885 ustep: 1 
iter: 5  value: 596.4331 mgc: 0.02096538 ustep: 1 
iter: 6  value: 596.4331 mgc: 3.258178e-05 ustep: 1 
iter: 7  mgc: 7.900969e-11 
iter: 1  mgc: 7.900969e-11 
Matching hessian patterns... Done
outer mgc:  142.6214 
iter: 1  value: 472.6501 mgc: 20.9068 ustep: 1 
iter: 2  value: 472.4586 mgc: 1.884404 ustep: 1 
iter: 3  value: 472.4586 mgc: 0.01331382 ustep: 1 
iter: 4  value: 472.4586 mgc: 2.685145e-06 ustep: 1 
iter: 5  mgc: 1.131595e-13 
iter: 1  value: 425.7838 mgc: 22.82077 ustep: 1 
iter: 2  value: 425.4687 mgc: 2.189786 ustep: 1 
iter: 3  value: 425.4686 mgc: 0.03764614 ustep: 1 
iter: 4  value: 425.4686 mgc: 2.033641e-05 ustep: 1 
iter: 5  mgc: 5.950573e-12 
iter: 1  mgc: 5.950573e-12 
outer mgc:  53.04533 
iter: 1  value: 409.4639 mgc: 36.43635 ustep: 1 
iter: 2  value: 405.2105 mgc: 11.06383 ustep: 1 
iter: 3  value: 405.195 mgc: 0.9175586 ustep: 1 
iter: 4  value: 405.195 mgc: 0.009032877 ustep: 1 
iter: 5  value: 405.195 mgc: 9.119546e-07 ustep: 1 
iter: 6  mgc: 1.082467e-14 
iter: 1  mgc: 1.082467e-14 
outer mgc:  90.97537 
iter: 1  value: 457.3705 mgc: 58.58896 ustep: 1 
iter: 2  value: 432.8285 mgc: 20.24305 ustep: 1 
iter: 3  value: 432.6963 mgc: 1.245937 ustep: 1 
iter: 4  value: 432.6963 mgc: 0.01758913 ustep: 1 
iter: 5  value: 432.6963 mgc: 3.670036e-06 ustep: 1 
iter: 6  mgc: 2.78666e-13 
iter: 1  value: 360.0212 mgc: 29.95283 ustep: 1 
iter: 2  value: 359.3792 mgc: 2.297066 ustep: 1 
iter: 3  value: 359.379 mgc: 0.03962771 ustep: 1 
iter: 4  value: 359.379 mgc: 1.6297e-05 ustep: 1 
iter: 5  mgc: 2.78233e-12 
iter: 1  mgc: 2.78233e-12 
outer mgc:  8.093598 
iter: 1  value: 359.5539 mgc: 9.833573 ustep: 1 
iter: 2  value: 359.5298 mgc: 0.6879437 ustep: 1 
iter: 3  value: 359.5298 mgc: 0.004394163 ustep: 1 
iter: 4  value: 359.5298 mgc: 1.842819e-07 ustep: 1 
mgc: 2.331468e-14 
iter: 1  value: 356.2475 mgc: 4.666531 ustep: 1 
iter: 2  value: 356.2465 mgc: 0.1358557 ustep: 1 
iter: 3  value: 356.2465 mgc: 0.0001858486 ustep: 1 
iter: 4  mgc: 3.509799e-10 
iter: 1  mgc: 3.509799e-10 
outer mgc:  12.51414 
iter: 1  value: 353.5494 mgc: 10.56849 ustep: 1 
iter: 2  value: 353.5133 mgc: 0.6148126 ustep: 1 
iter: 3  value: 353.5133 mgc: 0.002902545 ustep: 1 
iter: 4  value: 353.5133 mgc: 1.271679e-07 ustep: 1 
iter: 5  mgc: 1.946186e-14 
iter: 1  mgc: 1.946186e-14 
outer mgc:  10.77236 
iter: 1  value: 349.6189 mgc: 9.218867 ustep: 1 
iter: 2  value: 349.6114 mgc: 0.4182071 ustep: 1 
iter: 3  value: 349.6114 mgc: 0.0006702144 ustep: 1 
iter: 4  mgc: 2.694299e-09 
iter: 1  mgc: 2.694299e-09 
outer mgc:  5.754731 
iter: 1  value: 348.0997 mgc: 14.32291 ustep: 1 
iter: 2  value: 348.0278 mgc: 0.9124079 ustep: 1 
iter: 3  value: 348.0278 mgc: 0.005324286 ustep: 1 
iter: 4  value: 348.0278 mgc: 3.098114e-07 ustep: 1 
iter: 5  mgc: 2.353673e-14 
iter: 1  mgc: 2.353673e-14 
outer mgc:  7.640049 
iter: 1  value: 346.6117 mgc: 10.08562 ustep: 1 
iter: 2  value: 346.5955 mgc: 0.4322854 ustep: 1 
iter: 3  value: 346.5955 mgc: 0.001324836 ustep: 1 
iter: 4  value: 346.5955 mgc: 1.273948e-08 ustep: 1 
mgc: 2.930989e-14 
iter: 1  mgc: 2.930989e-14 
outer mgc:  12.35978 
iter: 1  value: 344.0379 mgc: 12.46162 ustep: 1 
iter: 2  value: 343.9677 mgc: 0.8536885 ustep: 1 
iter: 3  value: 343.9676 mgc: 0.006647613 ustep: 1 
iter: 4  value: 343.9676 mgc: 4.239124e-07 ustep: 1 
iter: 5  mgc: 1.676437e-14 
iter: 1  mgc: 1.676437e-14 
outer mgc:  5.099498 
iter: 1  value: 342.8919 mgc: 11.31823 ustep: 1 
iter: 2  value: 342.8247 mgc: 0.7981175 ustep: 1 
iter: 3  value: 342.8247 mgc: 0.006350626 ustep: 1 
iter: 4  value: 342.8247 mgc: 7.944276e-07 ustep: 1 
iter: 5  mgc: 2.220446e-14 
iter: 1  mgc: 2.220446e-14 
outer mgc:  5.388698 
iter: 1  value: 341.4956 mgc: 4.430031 ustep: 1 
iter: 2  value: 341.4891 mgc: 0.1629391 ustep: 1 
iter: 3  value: 341.4891 mgc: 0.0003128907 ustep: 1 
iter: 4  mgc: 4.375853e-09 
iter: 1  mgc: 4.375853e-09 
outer mgc:  3.696989 
iter: 1  value: 341.207 mgc: 6.478307 ustep: 1 
iter: 2  value: 341.2038 mgc: 0.1866332 ustep: 1 
iter: 3  value: 341.2038 mgc: 0.0005351153 ustep: 1 
iter: 4  mgc: 4.106457e-09 
iter: 1  mgc: 4.106457e-09 
outer mgc:  4.115651 
iter: 1  value: 341.426 mgc: 4.976916 ustep: 1 
iter: 2  value: 341.424 mgc: 0.133829 ustep: 1 
iter: 3  value: 341.424 mgc: 0.0002822005 ustep: 1 
iter: 4  mgc: 1.324056e-09 
iter: 1  value: 340.9907 mgc: 3.561656 ustep: 1 
iter: 2  value: 340.9904 mgc: 0.04666718 ustep: 1 
iter: 3  value: 340.9904 mgc: 1.798589e-05 ustep: 1 
iter: 4  mgc: 4.96117e-12 
iter: 1  mgc: 4.96117e-12 
outer mgc:  3.208359 
iter: 1  value: 340.6428 mgc: 2.089892 ustep: 1 
iter: 2  value: 340.6427 mgc: 0.0169535 ustep: 1 
iter: 3  value: 340.6427 mgc: 2.708234e-06 ustep: 1 
iter: 4  mgc: 3.623768e-13 
iter: 1  mgc: 3.623768e-13 
outer mgc:  1.907759 
iter: 1  value: 340.7223 mgc: 1.032128 ustep: 1 
iter: 2  value: 340.7223 mgc: 0.006633053 ustep: 1 
iter: 3  value: 340.7223 mgc: 1.871359e-06 ustep: 1 
iter: 4  mgc: 1.59428e-13 
iter: 1  value: 340.6489 mgc: 0.9563967 ustep: 1 
iter: 2  value: 340.6489 mgc: 0.005227494 ustep: 1 
iter: 3  value: 340.6489 mgc: 1.557021e-07 ustep: 1 
iter: 4  mgc: 1.820766e-14 
iter: 1  mgc: 1.820766e-14 
outer mgc:  1.257148 
iter: 1  value: 340.6526 mgc: 1.455567 ustep: 1 
iter: 2  value: 340.6526 mgc: 0.007367565 ustep: 1 
iter: 3  value: 340.6526 mgc: 6.273955e-07 ustep: 1 
iter: 4  mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  1.593367 
iter: 1  value: 340.7086 mgc: 2.20246 ustep: 1 
iter: 2  value: 340.7086 mgc: 0.01324834 ustep: 1 
iter: 3  value: 340.7086 mgc: 8.633663e-07 ustep: 1 
iter: 4  mgc: 1.731948e-14 
iter: 1  value: 340.6698 mgc: 1.766104 ustep: 1 
iter: 2  value: 340.6698 mgc: 0.007384605 ustep: 1 
iter: 3  value: 340.6698 mgc: 2.632218e-07 ustep: 1 
iter: 4  mgc: 2.309264e-14 
iter: 1  mgc: 2.309264e-14 
outer mgc:  1.709953 
iter: 1  value: 340.6599 mgc: 0.7954027 ustep: 1 
iter: 2  value: 340.6599 mgc: 0.001167059 ustep: 1 
iter: 3  mgc: 6.864874e-09 
iter: 1  mgc: 6.864874e-09 
outer mgc:  0.5089555 
iter: 1  value: 340.7035 mgc: 1.268753 ustep: 1 
iter: 2  value: 340.7035 mgc: 0.005965988 ustep: 1 
iter: 3  value: 340.7035 mgc: 2.502424e-07 ustep: 1 
iter: 4  mgc: 2.14273e-14 
iter: 1  value: 340.6608 mgc: 0.3110445 ustep: 1 
iter: 2  value: 340.6608 mgc: 0.0003521422 ustep: 1 
iter: 3  mgc: 8.834781e-10 
iter: 1  mgc: 8.834781e-10 
outer mgc:  0.1844891 
iter: 1  value: 340.6597 mgc: 0.2510207 ustep: 1 
iter: 2  value: 340.6597 mgc: 0.0001899997 ustep: 1 
iter: 3  mgc: 2.164358e-10 
iter: 1  mgc: 2.164358e-10 
outer mgc:  0.3924732 
iter: 1  value: 340.6611 mgc: 0.1992678 ustep: 1 
iter: 2  value: 340.6611 mgc: 0.0001325305 ustep: 1 
iter: 3  mgc: 1.060911e-10 
iter: 1  mgc: 1.060911e-10 
outer mgc:  0.1548355 
iter: 1  value: 340.6617 mgc: 0.09755897 ustep: 1 
iter: 2  value: 340.6617 mgc: 3.50122e-05 ustep: 1 
iter: 3  mgc: 1.033795e-11 
iter: 1  mgc: 1.033795e-11 
outer mgc:  0.1323214 
iter: 1  value: 340.6682 mgc: 0.07320098 ustep: 1 
iter: 2  value: 340.6682 mgc: 2.438755e-05 ustep: 1 
iter: 3  mgc: 3.388401e-12 
iter: 1  value: 340.6786 mgc: 0.06746092 ustep: 1 
iter: 2  value: 340.6786 mgc: 2.04366e-05 ustep: 1 
iter: 3  mgc: 6.127765e-12 
iter: 1  mgc: 6.127765e-12 
outer mgc:  0.1491522 
iter: 1  value: 340.6608 mgc: 0.2455275 ustep: 1 
iter: 2  value: 340.6608 mgc: 0.0003465116 ustep: 1 
iter: 3  mgc: 3.663133e-09 
iter: 1  value: 340.6725 mgc: 0.1188582 ustep: 1 
iter: 2  value: 340.6725 mgc: 5.149421e-05 ustep: 1 
iter: 3  mgc: 6.314149e-11 
iter: 1  mgc: 6.314149e-11 
outer mgc:  0.05635719 
iter: 1  value: 340.68 mgc: 0.4127619 ustep: 1 
iter: 2  value: 340.68 mgc: 0.0005995162 ustep: 1 
iter: 3  mgc: 3.473622e-09 
iter: 1  value: 340.6745 mgc: 0.1212873 ustep: 1 
iter: 2  value: 340.6745 mgc: 5.041927e-05 ustep: 1 
iter: 3  mgc: 2.495137e-11 
iter: 1  mgc: 2.495137e-11 
outer mgc:  0.03382264 
iter: 1  value: 340.6743 mgc: 0.03298822 ustep: 1 
iter: 2  value: 340.6743 mgc: 5.547339e-06 ustep: 1 
iter: 3  mgc: 2.144951e-13 
iter: 1  mgc: 2.144951e-13 
outer mgc:  0.01568398 
iter: 1  value: 340.6743 mgc: 0.03154399 ustep: 1 
iter: 2  value: 340.6743 mgc: 3.433304e-06 ustep: 1 
iter: 3  mgc: 1.634248e-13 
iter: 1  value: 340.6746 mgc: 0.0381113 ustep: 1 
iter: 2  value: 340.6746 mgc: 3.858196e-06 ustep: 1 
iter: 3  mgc: 9.30922e-14 
iter: 1  mgc: 9.30922e-14 
outer mgc:  0.0246473 
iter: 1  value: 340.6747 mgc: 0.01600847 ustep: 1 
iter: 2  value: 340.6747 mgc: 7.214931e-07 ustep: 1 
iter: 3  mgc: 2.642331e-14 
iter: 1  mgc: 2.642331e-14 
outer mgc:  0.007762836 
iter: 1  value: 340.6742 mgc: 0.01166622 ustep: 1 
iter: 2  value: 340.6742 mgc: 5.663941e-07 ustep: 1 
iter: 3  mgc: 1.199041e-14 
iter: 1  value: 340.6746 mgc: 0.005199617 ustep: 1 
iter: 2  value: 340.6746 mgc: 1.122002e-07 ustep: 1 
iter: 3  mgc: 1.476597e-14 
iter: 1  mgc: 1.476597e-14 
outer mgc:  0.001800271 
iter: 1  value: 340.6752 mgc: 0.003570779 ustep: 1 
iter: 2  value: 340.6752 mgc: 4.123475e-08 ustep: 1 
mgc: 1.998401e-14 
iter: 1  value: 340.6748 mgc: 0.001475007 ustep: 1 
iter: 2  mgc: 5.29594e-09 
iter: 1  mgc: 5.29594e-09 
outer mgc:  0.001051031 
iter: 1  value: 340.6748 mgc: 0.001968766 ustep: 1 
iter: 2  value: 340.6748 mgc: 1.828015e-08 ustep: 1 
mgc: 2.087219e-14 
iter: 1  mgc: 2.087219e-14 
outer mgc:  0.0006206005 
iter: 1  value: 340.6749 mgc: 0.002608525 ustep: 1 
iter: 2  value: 340.6749 mgc: 4.09776e-08 ustep: 1 
mgc: 1.332268e-14 
iter: 1  value: 340.6748 mgc: 0.0006934854 ustep: 1 
iter: 2  mgc: 3.157039e-09 
iter: 1  mgc: 3.157039e-09 
outer mgc:  0.0003579634 
iter: 1  value: 340.6748 mgc: 0.0003723317 ustep: 1 
iter: 2  mgc: 1.696391e-09 
iter: 1  mgc: 3.157039e-09 
iter: 1  mgc: 3.157039e-09 
outer mgc:  0.0003579634 
iter: 1  value: 340.6751 mgc: 0.04482357 ustep: 1 
iter: 2  value: 340.6751 mgc: 5.769258e-06 ustep: 1 
iter: 3  mgc: 1.909584e-13 
outer mgc:  0.06221431 
iter: 1  value: 340.6747 mgc: 0.04481539 ustep: 1 
iter: 2  value: 340.6747 mgc: 5.777477e-06 ustep: 1 
iter: 3  mgc: 1.882938e-13 
outer mgc:  0.06170172 
iter: 1  value: 340.6754 mgc: 0.02808759 ustep: 1 
iter: 2  value: 340.6754 mgc: 2.463727e-06 ustep: 1 
iter: 3  mgc: 2.930989e-14 
outer mgc:  0.1090305 
iter: 1  value: 340.6744 mgc: 0.02808095 ustep: 1 
iter: 2  value: 340.6744 mgc: 2.466935e-06 ustep: 1 
iter: 3  mgc: 2.792211e-14 
outer mgc:  0.1091535 
iter: 1  value: 340.6747 mgc: 0.04621731 ustep: 1 
iter: 2  value: 340.6747 mgc: 8.804599e-06 ustep: 1 
iter: 3  mgc: 8.456569e-13 
outer mgc:  0.0136625 
iter: 1  value: 340.675 mgc: 0.04620325 ustep: 1 
iter: 2  value: 340.675 mgc: 8.816476e-06 ustep: 1 
iter: 3  mgc: 8.258394e-13 
outer mgc:  0.01340438 
iter: 1  value: 340.6747 mgc: 0.02062506 ustep: 1 
iter: 2  value: 340.6747 mgc: 1.763986e-06 ustep: 1 
iter: 3  mgc: 4.041212e-14 
outer mgc:  0.06857826 
iter: 1  value: 340.6751 mgc: 0.02061685 ustep: 1 
iter: 2  value: 340.6751 mgc: 1.76374e-06 ustep: 1 
iter: 3  mgc: 3.108624e-14 
outer mgc:  0.06882381 
iter: 1  value: 340.6747 mgc: 0.05005741 ustep: 1 
iter: 2  value: 340.6747 mgc: 8.001624e-06 ustep: 1 
iter: 3  mgc: 3.738676e-13 
outer mgc:  0.04172257 
iter: 1  value: 340.675 mgc: 0.05004315 ustep: 1 
iter: 2  value: 340.675 mgc: 8.009335e-06 ustep: 1 
iter: 3  mgc: 3.776701e-13 
outer mgc:  0.04189396 
iter: 1  value: 340.6749 mgc: 0.02760597 ustep: 1 
iter: 2  value: 340.6749 mgc: 1.858875e-06 ustep: 1 
iter: 3  mgc: 2.922662e-14 
outer mgc:  0.09341682 
iter: 1  value: 340.6749 mgc: 0.02759855 ustep: 1 
iter: 2  value: 340.6749 mgc: 1.858722e-06 ustep: 1 
iter: 3  mgc: 3.241851e-14 
outer mgc:  0.09269243 
iter: 1  value: 340.6743 mgc: 0.004198654 ustep: 1 
iter: 2  value: 340.6743 mgc: 1.453397e-07 ustep: 1 
iter: 3  mgc: 1.376677e-14 
outer mgc:  0.007476039 
iter: 1  value: 340.6754 mgc: 0.00419495 ustep: 1 
iter: 2  value: 340.6754 mgc: 1.448211e-07 ustep: 1 
iter: 3  mgc: 1.598721e-14 
outer mgc:  0.007599388 
iter: 1  value: 340.6738 mgc: 0.00410817 ustep: 1 
iter: 2  value: 340.6738 mgc: 9.357355e-08 ustep: 1 
mgc: 1.998401e-14 
outer mgc:  0.004647419 
iter: 1  value: 340.6759 mgc: 0.004105045 ustep: 1 
iter: 2  value: 340.6759 mgc: 9.351809e-08 ustep: 1 
mgc: 1.887379e-14 
outer mgc:  0.004814493 
iter: 1  value: 340.6751 mgc: 0.004531846 ustep: 1 
iter: 2  value: 340.6751 mgc: 9.787079e-08 ustep: 1 
mgc: 1.509903e-14 
outer mgc:  0.007905621 
iter: 1  value: 340.6745 mgc: 0.004530276 ustep: 1 
iter: 2  value: 340.6745 mgc: 9.799169e-08 ustep: 1 
mgc: 2.176037e-14 
outer mgc:  0.008040638 
iter: 1  value: 340.6766 mgc: 0.01182334 ustep: 1 
iter: 2  value: 340.6766 mgc: 9.337206e-07 ustep: 1 
iter: 3  mgc: 2.020606e-14 
outer mgc:  0.02340394 
iter: 1  value: 340.6731 mgc: 0.01185379 ustep: 1 
iter: 2  value: 340.6731 mgc: 9.369156e-07 ustep: 1 
iter: 3  mgc: 1.398881e-14 
outer mgc:  0.02330905 
iter: 1  value: 340.6758 mgc: 0.005049746 ustep: 1 
iter: 2  value: 340.6758 mgc: 1.253114e-06 ustep: 1 
iter: 3  mgc: 7.949197e-14 
outer mgc:  0.01754213 
iter: 1  value: 340.6739 mgc: 0.005060049 ustep: 1 
iter: 2  value: 340.6739 mgc: 1.256776e-06 ustep: 1 
iter: 3  mgc: 7.860379e-14 
outer mgc:  0.01734884 
iter: 1  value: 340.6762 mgc: 0.00922972 ustep: 1 
iter: 2  value: 340.6762 mgc: 1.143861e-06 ustep: 1 
iter: 3  mgc: 1.909584e-14 
outer mgc:  0.02203194 
iter: 1  value: 340.6735 mgc: 0.009253447 ustep: 1 
iter: 2  value: 340.6735 mgc: 1.147874e-06 ustep: 1 
iter: 3  mgc: 3.08642e-14 
outer mgc:  0.02196969 
Warning message:
package ‘nnet’ was built under R version 3.6.3 
[Sun Aug 15 15:15:13 2021]
Finished job 0.
1 of 1 steps (100%) done
